/ru-auth/local/home/xwu05/.local/lib/python3.9/site-packages/pandas/core/computation/expressions.py:21: UserWarning: Pandas requires version '2.8.0' or newer of 'numexpr' (version '2.7.3' currently installed).
  from pandas.core.computation.check import NUMEXPR_INSTALLED
/ru-auth/local/home/xwu05/.local/lib/python3.9/site-packages/pandas/core/arrays/masked.py:62: UserWarning: Pandas requires version '1.3.4' or newer of 'bottleneck' (version '1.3.2' currently installed).
  from pandas.core import (
[22;0t]0;IPython: detect_peaks_scripts/run_modelMEMORY 13.429866496
On task head
Computing windowed sums on original
Generating null dist
peak(mu)= -2.38053685049696e-06
Computing threshold
Subsampling!
For increasing = True , the minimum IR precision was 0.4266081831644932 occurring at 0.0 implying a frac_neg of 0.7440081470274584
To be conservative, adjusted frac neg is 0.95
For increasing = False , the minimum IR precision was 0.44653245709235345 occurring at -1.7213311664932007e-08 implying a frac_neg of 0.8067906832377042
To be conservative, adjusted frac neg is 0.95
Thresholds from null dist were -0.895836974450372  and  0.6530460150662414 with frac passing 0.049241
Final raw thresholds are -0.895836974450372  and  0.6530460150662414
Final transformed thresholds are -0.9638169824592119  and  0.9292749622919388
saving plot to figures/scoredist_0.png
Got 215535 coords
On task testis
Computing windowed sums on original
Generating null dist
peak(mu)= 8.686860455385699e-06
Computing threshold
Subsampling!
For increasing = True , the minimum IR precision was 0.4486743900701476 occurring at 0.0 implying a frac_neg of 0.8138101731338663
To be conservative, adjusted frac neg is 0.95
For increasing = False , the minimum IR precision was 0.44181638185870803 occurring at -2.0738966099997924e-12 implying a frac_neg of 0.7915251675244828
To be conservative, adjusted frac neg is 0.95
Thresholds from null dist were -1.314917669817567  and  1.0103476088667849 with frac passing 0.028526
Passing windows frac was 0.028526 , which is below  0.03 ; adjusting
Final raw thresholds are -1.139941841827444  and  1.139941841827444
Final transformed thresholds are -0.9697883800699005  and  0.9697883800699005
saving plot to figures/scoredist_1.png
Got 140106 coords
After resolving overlaps, got 244962 seqlets
Across all tasks, the weakest transformed threshold used was: 0.9291749622919389
MEMORY 15.798714368
244962 identified in total
min_metacluster_size_frac * len(seqlets) = 2449 is more than min_metacluster_size=100.
Using it as a new min_metacluster_size
6 activity patterns with support >= 2449 out of 8 possible patterns
Metacluster sizes:  [105959, 99028, 16072, 11868, 6340, 5695]
Idx to activities:  {0: '1,1', 1: '-1,-1', 2: '1,0', 3: '-1,0', 4: '0,1', 5: '0,-1'}
MEMORY 15.79872256
On metacluster 5
Metacluster size 5695
Relevant tasks:  ('testis',)
Relevant signs:  (-1,)
TfModiscoSeqletsToPatternsFactory: seed=1234
(Round 1) num seqlets: 5695
(Round 1) Computing coarse affmat
2024-03-16 17:37:21.814038 MEMORY 15.797420032
Beginning embedding computation
MEMORY 15.797420032
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
At the beginning of embedding call
2024-03-16 17:37:21.814268 MEMORY 15.797420032
before computing embeddings fwd
2024-03-16 17:37:21.823279 MEMORY 15.797456896
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    5.8s
[Parallel(n_jobs=24)]: Done 152 tasks      | elapsed:    7.7s
[Parallel(n_jobs=24)]: Done 402 tasks      | elapsed:   11.1s
[Parallel(n_jobs=24)]: Done 752 tasks      | elapsed:   15.8s
[Parallel(n_jobs=24)]: Done 1202 tasks      | elapsed:   21.8s
[Parallel(n_jobs=24)]: Done 1752 tasks      | elapsed:   29.0s
[Parallel(n_jobs=24)]: Done 2402 tasks      | elapsed:   37.6s
[Parallel(n_jobs=24)]: Done 3152 tasks      | elapsed:   47.5s
[Parallel(n_jobs=24)]: Done 4002 tasks      | elapsed:   58.7s
[Parallel(n_jobs=24)]: Done 4952 tasks      | elapsed:  1.2min
[Parallel(n_jobs=24)]: Done 5695 out of 5695 | elapsed:  1.3min finished
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 152 tasks      | elapsed:    2.2s
[Parallel(n_jobs=24)]: Done 402 tasks      | elapsed:    5.5s
[Parallel(n_jobs=24)]: Done 752 tasks      | elapsed:   10.1s
[Parallel(n_jobs=24)]: Done 1202 tasks      | elapsed:   16.0s
[Parallel(n_jobs=24)]: Done 1752 tasks      | elapsed:   23.3s
[Parallel(n_jobs=24)]: Done 2402 tasks      | elapsed:   31.9s
[Parallel(n_jobs=24)]: Done 3152 tasks      | elapsed:   41.9s
[Parallel(n_jobs=24)]: Done 4002 tasks      | elapsed:   53.2s
[Parallel(n_jobs=24)]: Done 4952 tasks      | elapsed:  1.1min
[Parallel(n_jobs=24)]: Done 5695 out of 5695 | elapsed:  1.3min finished
after computing embeddings fwd
2024-03-16 17:38:43.063570 MEMORY 16.006340608
after computing embeddings rev
2024-03-16 17:39:58.750578 MEMORY 16.238383104
before computing sparse embeddings fwd
2024-03-16 17:39:58.750720 MEMORY 16.238383104
Constructing csr matrix...
csr matrix made in 0.7585513591766357 s
after computing sparse embeddings fwd
2024-03-16 17:39:59.899728 MEMORY 16.239091712
before computing sparse embeddings rev
2024-03-16 17:39:59.899829 MEMORY 16.239091712
Constructing csr matrix...
csr matrix made in 0.6717534065246582 s
after computing sparse embeddings rev
2024-03-16 17:40:00.891964 MEMORY 16.239095808
Finished embedding computation in 160.69 s
MEMORY 15.988441088
Starting affinity matrix computations
MEMORY 15.988441088
Batching in slices of size 5695
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:06<00:00,  6.19s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:06<00:00,  6.19s/it]
Finished affinity matrix computations in 6.22 s
MEMORY 15.988723712
(Round 1) Computed coarse affmat
2024-03-16 17:40:09.941469 MEMORY 15.988723712
(Round 1) Computing affinity matrix on nearest neighbors
2024-03-16 17:40:09.941614 MEMORY 15.988723712
Launching nearest neighbors affmat calculation job
MEMORY 15.988805632
Parallel runs completed
MEMORY 16.13119488
Job completed in: 19.65 s
MEMORY 16.13111296
Launching nearest neighbors affmat calculation job
MEMORY 16.131014656
Parallel runs completed
MEMORY 16.220790784
Job completed in: 19.11 s
MEMORY 16.2210816
(Round 1) Computed affinity matrix on nearest neighbors in 40.78 s
2024-03-16 17:40:50.718064 MEMORY 16.221483008
Filtered down to 5462 of 5695
(Round 1) Retained 5462 rows out of 5695 after filtering
2024-03-16 17:40:53.855292 MEMORY 16.223895552
(Round 1) Computing density adapted affmat
2024-03-16 17:40:56.142945 MEMORY 16.273465344
Symmetrizing nearest neighbors
Computing betas for density adaptation
Computing normalizing denominators
(Round 1) Computing clustering
2024-03-16 17:41:51.794141 MEMORY 16.229740544
Beginning preprocessing + Leiden
2024-03-16 17:41:51.802480 MEMORY 16.229740544
Affmat transformed
2024-03-16 17:41:51.802684 MEMORY 16.229740544
sources, targets, weights extracted
2024-03-16 17:41:52.108058 MEMORY 16.229773312
About to launch parallel Leiden runs
2024-03-16 17:41:52.161542 MEMORY 16.229781504
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:   21.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:  1.3min finished
Parallel Leiden runs finished
2024-03-16 17:43:12.601422 MEMORY 16.231256064
Quality: 0.398237544693366
Quality: 0.398237981510647
Quality: 0.3982401865341816
Quality: 0.3982402060216926
Got 4 clusters after round 1
Counts:
{3: 1018, 2: 1309, 0: 1595, 1: 1540}
2024-03-16 17:43:12.622035 MEMORY 16.231292928
(Round 1) Aggregating seqlets in each cluster
2024-03-16 17:43:12.622164 MEMORY 16.231292928
Aggregating for cluster 0 with 1595 seqlets
2024-03-16 17:43:12.629820 MEMORY 16.231292928
Skipped 2 due to duplicates
Trimming eliminated 0 seqlets out of 1593
Aggregating for cluster 1 with 1540 seqlets
2024-03-16 17:43:17.109749 MEMORY 16.23238656
Skipped 1 due to duplicates
Trimming eliminated 0 seqlets out of 1539
Aggregating for cluster 2 with 1309 seqlets
2024-03-16 17:43:20.932944 MEMORY 16.232656896
Skipped 1 due to duplicates
Trimming eliminated 0 seqlets out of 1308
Aggregating for cluster 3 with 1018 seqlets
2024-03-16 17:43:25.400336 MEMORY 16.232747008
Skipped 1 due to duplicates
Trimming eliminated 0 seqlets out of 1017
(Round 2) num seqlets: 5457
(Round 2) Computing coarse affmat
2024-03-16 17:43:29.301486 MEMORY 16.232767488
Beginning embedding computation
MEMORY 16.232767488
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 368 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done 1368 tasks      | elapsed:    2.1s
[Parallel(n_jobs=24)]: Done 2768 tasks      | elapsed:    4.2s
[Parallel(n_jobs=24)]: Done 4568 tasks      | elapsed:    6.9s
[Parallel(n_jobs=24)]: Done 5457 out of 5457 | elapsed:    8.2s finished
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 368 tasks      | elapsed:    0.8s
[Parallel(n_jobs=24)]: Done 1368 tasks      | elapsed:    2.3s
[Parallel(n_jobs=24)]: Done 2768 tasks      | elapsed:    4.4s
[Parallel(n_jobs=24)]: Done 4568 tasks      | elapsed:    7.2s
[Parallel(n_jobs=24)]: Done 5410 out of 5457 | elapsed:    8.5s remaining:    0.1s
[Parallel(n_jobs=24)]: Done 5457 out of 5457 | elapsed:    8.6s finished
At the beginning of embedding call
2024-03-16 17:43:29.301749 MEMORY 16.232767488
before computing embeddings fwd
2024-03-16 17:43:29.311022 MEMORY 16.233603072
after computing embeddings fwd
2024-03-16 17:43:37.524705 MEMORY 16.457822208
after computing embeddings rev
2024-03-16 17:43:46.091046 MEMORY 16.680759296
before computing sparse embeddings fwd
2024-03-16 17:43:46.091140 MEMORY 16.680759296
Constructing csr matrix...
csr matrix made in 0.6283166408538818 s
after computing sparse embeddings fwd
2024-03-16 17:43:47.097616 MEMORY 16.685121536
before computing sparse embeddings rev
2024-03-16 17:43:47.097701 MEMORY 16.685121536
Constructing csr matrix...
csr matrix made in 0.615955114364624 s
after computing sparse embeddings rev
2024-03-16 17:43:47.963084 MEMORY 16.728600576
Finished embedding computation in 20.26 s
MEMORY 16.526249984
Starting affinity matrix computations
MEMORY 16.525725696
Batching in slices of size 5457
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:06<00:00,  6.15s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:06<00:00,  6.15s/it]
Finished affinity matrix computations in 6.18 s
MEMORY 16.525811712
(Round 2) Computed coarse affmat
2024-03-16 17:43:56.875377 MEMORY 16.416571392
(Round 2) Computing affinity matrix on nearest neighbors
2024-03-16 17:43:56.875521 MEMORY 16.416571392
Launching nearest neighbors affmat calculation job
MEMORY 16.416571392
Parallel runs completed
MEMORY 16.439468032
Job completed in: 9.88 s
MEMORY 16.439271424
Launching nearest neighbors affmat calculation job
MEMORY 16.439074816
Parallel runs completed
MEMORY 16.458235904
Job completed in: 8.91 s
MEMORY 16.457965568
(Round 2) Computed affinity matrix on nearest neighbors in 20.72 s
2024-03-16 17:44:17.595157 MEMORY 16.457940992
Not applying filtering for rounds above first round
2024-03-16 17:44:17.595996 MEMORY 16.457940992
(Round 2) Computing density adapted affmat
2024-03-16 17:44:19.656602 MEMORY 16.480743424
Symmetrizing nearest neighbors
Computing betas for density adaptation
Computing normalizing denominators
(Round 2) Computing clustering
2024-03-16 17:45:07.141816 MEMORY 16.55134208
Beginning preprocessing + Leiden
2024-03-16 17:45:07.150418 MEMORY 16.55134208
Affmat transformed
2024-03-16 17:45:07.150589 MEMORY 16.55134208
sources, targets, weights extracted
2024-03-16 17:45:07.346392 MEMORY 16.55134208
About to launch parallel Leiden runs
2024-03-16 17:45:07.399831 MEMORY 16.551354368
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:   14.6s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   51.8s finished
Parallel Leiden runs finished
2024-03-16 17:45:59.205282 MEMORY 16.55136256
Quality: 0.4921457212228485
Quality: 0.4921460105567811
Quality: 0.49214621691409355
Got 4 clusters after round 2
Counts:
{1: 1500, 2: 1328, 0: 1560, 3: 1069}
2024-03-16 17:45:59.222109 MEMORY 16.55136256
(Round 2) Aggregating seqlets in each cluster
2024-03-16 17:45:59.222215 MEMORY 16.55136256
Aggregating for cluster 0 with 1560 seqlets
2024-03-16 17:45:59.225480 MEMORY 16.55136256
Skipped 2 due to duplicates
Trimming eliminated 0 seqlets out of 1558
Aggregating for cluster 1 with 1500 seqlets
2024-03-16 17:46:01.967874 MEMORY 16.551370752
Skipped 1 due to duplicates
Trimming eliminated 0 seqlets out of 1499
Aggregating for cluster 2 with 1328 seqlets
2024-03-16 17:46:04.408393 MEMORY 16.551370752
Skipped 2 due to duplicates
Trimming eliminated 0 seqlets out of 1326
Aggregating for cluster 3 with 1069 seqlets
2024-03-16 17:46:07.912663 MEMORY 16.551370752
Skipped 2 due to duplicates
Trimming eliminated 0 seqlets out of 1067
Got 4 clusters
Splitting into subclusters...
2024-03-16 17:46:09.778688 MEMORY 16.551370752
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 1558 out of 1558 | elapsed:    0.6s finished
Inspecting pattern 0 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 1558
[t-SNE] Computed conditional probabilities for sample 1558 / 1558
[t-SNE] Mean sigma: 0.299362
Beginning preprocessing + Leiden
2024-03-16 17:46:12.029572 MEMORY 16.553209856
Affmat transformed
2024-03-16 17:46:12.049547 MEMORY 16.553222144
sources, targets, weights extracted
2024-03-16 17:46:12.062548 MEMORY 16.553222144
About to launch parallel Leiden runs
2024-03-16 17:46:12.070914 MEMORY 16.553222144
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    5.6s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   16.8s finished
Parallel Leiden runs finished
2024-03-16 17:46:28.829836 MEMORY 16.553259008
Quality: 0.4756573560195362
Quality: 0.47575511148751604
Quality: 0.4761220323905468
Quality: 0.4763407781185937
Quality: 0.4767992812739506
Got subclusters: Counter({0: 331, 1: 312, 2: 250, 3: 231, 4: 222, 5: 158, 6: 54})
On merging iteration 1
Numbers for each pattern pre-subsample: [331, 312, 250, 231, 222, 158, 54]
Numbers after subsampling: [300, 300, 250, 231, 222, 158, 54]
Computing sims for pattern 0
Computed sims for pattern 0 in 1.9851219654083252 s
Computing sims for pattern 1
Computed sims for pattern 1 in 2.0102734565734863 s
Computing sims for pattern 2
Computed sims for pattern 2 in 1.562572717666626 s
Computing sims for pattern 3
Computed sims for pattern 3 in 1.8468925952911377 s
Computing sims for pattern 4
Computed sims for pattern 4 in 1.7739076614379883 s
Computing sims for pattern 5
Computed sims for pattern 5 in 1.1550099849700928 s
Computing sims for pattern 6
Computed sims for pattern 6 in 0.49622178077697754 s
Cluster sizes
[331 312 250 231 222 158  54]
Cross-contamination matrix:
[[1.   0.56 0.47 0.59 0.69 0.57 1.  ]
 [0.6  1.   0.64 0.58 0.59 0.51 0.99]
 [0.29 0.71 1.   0.23 0.77 0.53 0.96]
 [0.82 0.77 0.53 1.   0.62 0.72 1.  ]
 [0.71 0.57 0.67 0.46 1.   0.41 0.99]
 [0.75 0.64 0.6  0.67 0.53 1.   1.  ]
 [0.5  0.44 0.37 0.36 0.46 0.37 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.82 0.73 0.83 0.85 0.79 0.92]
 [0.82 1.   0.81 0.83 0.76 0.72 0.92]
 [0.73 0.81 1.   0.68 0.85 0.72 0.83]
 [0.83 0.83 0.68 1.   0.8  0.82 0.88]
 [0.85 0.76 0.85 0.8  1.   0.77 0.85]
 [0.79 0.72 0.72 0.82 0.77 1.   0.85]
 [0.92 0.92 0.83 0.88 0.85 0.85 1.  ]]
Collapsing 1 & 6 with crosscontam 0.4378341716201799 and sim 0.9175944803643046
Collapsing 0 & 6 with crosscontam 0.5030206269369506 and sim 0.9170356714222546
Trimming eliminated 0 seqlets out of 366
Trimming eliminated 0 seqlets out of 697
Unmerged patterns remapping: OrderedDict([(2, 1), (3, 2), (4, 3), (5, 4)])
Time spent on merging iteration: 2.164412021636963
On merging iteration 2
Numbers for each pattern pre-subsample: [697, 250, 231, 222, 158]
Numbers after subsampling: [300, 250, 231, 222, 158]
Computing sims for pattern 0
Computed sims for pattern 0 in 1.392812967300415 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.2864067554473877 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.33378028869628906 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.3073709011077881 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.20404744148254395 s
Cluster sizes
[697 250 231 222 158]
Cross-contamination matrix:
[[1.   0.8  0.82 0.84 0.54]
 [0.64 1.   0.23 0.77 0.53]
 [0.77 0.53 1.   0.62 0.72]
 [0.61 0.67 0.46 1.   0.41]
 [0.54 0.6  0.67 0.53 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.81 0.87 0.8  0.79]
 [0.81 1.   0.68 0.85 0.72]
 [0.87 0.68 1.   0.8  0.82]
 [0.8  0.85 0.8  1.   0.77]
 [0.79 0.72 0.82 0.77 1.  ]]
Collapsing 0 & 2 with crosscontam 0.7741689929085216 and sim 0.8690206848625599
Trimming eliminated 0 seqlets out of 928
Unmerged patterns remapping: OrderedDict([(1, 1), (3, 2), (4, 3)])
Time spent on merging iteration: 2.1465938091278076
On merging iteration 3
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 1499 out of 1499 | elapsed:    0.5s finished
Numbers for each pattern pre-subsample: [928, 250, 222, 158]
Numbers after subsampling: [300, 250, 222, 158]
Computing sims for pattern 0
Computed sims for pattern 0 in 1.107085943222046 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.30159497261047363 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.32727670669555664 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.21905946731567383 s
Cluster sizes
[928 250 222 158]
Cross-contamination matrix:
[[1.   0.79 0.85 0.61]
 [0.58 1.   0.77 0.53]
 [0.55 0.67 1.   0.41]
 [0.56 0.6  0.53 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.78 0.79 0.81]
 [0.78 1.   0.85 0.72]
 [0.79 0.85 1.   0.77]
 [0.81 0.72 0.77 1.  ]]
Inspecting pattern 1 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 1499
[t-SNE] Computed conditional probabilities for sample 1499 / 1499
[t-SNE] Mean sigma: 0.304558
Beginning preprocessing + Leiden
2024-03-16 17:46:50.336488 MEMORY 16.553627648
Affmat transformed
2024-03-16 17:46:50.354534 MEMORY 16.553627648
sources, targets, weights extracted
2024-03-16 17:46:50.366233 MEMORY 16.553627648
About to launch parallel Leiden runs
2024-03-16 17:46:50.374874 MEMORY 16.553627648
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    4.9s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   17.9s finished
Parallel Leiden runs finished
2024-03-16 17:47:08.274165 MEMORY 16.553627648
Quality: 0.4567775545042462
Quality: 0.4574058961922907
Quality: 0.45838527022418574
Got subclusters: Counter({0: 277, 1: 253, 2: 242, 3: 217, 4: 194, 6: 139, 5: 139, 7: 38})
On merging iteration 1
Numbers for each pattern pre-subsample: [277, 253, 242, 217, 194, 139, 139, 38]
Numbers after subsampling: [277, 253, 242, 217, 194, 139, 139, 38]
Computing sims for pattern 0
Computed sims for pattern 0 in 2.0368587970733643 s
Computing sims for pattern 1
Computed sims for pattern 1 in 1.8397014141082764 s
Computing sims for pattern 2
Computed sims for pattern 2 in 1.7597901821136475 s
Computing sims for pattern 3
Computed sims for pattern 3 in 2.0046281814575195 s
Computing sims for pattern 4
Computed sims for pattern 4 in 1.6526174545288086 s
Computing sims for pattern 5
Computed sims for pattern 5 in 1.2727549076080322 s
Computing sims for pattern 6
Computed sims for pattern 6 in 1.205648422241211 s
Computing sims for pattern 7
Computed sims for pattern 7 in 0.4137003421783447 s
Cluster sizes
[277 253 242 217 194 139 139  38]
Cross-contamination matrix:
[[1.   0.57 0.42 0.45 0.66 0.71 0.38 0.5 ]
 [0.75 1.   0.61 0.64 0.77 0.7  0.48 0.47]
 [0.76 0.8  1.   0.81 0.74 0.76 0.49 0.62]
 [0.51 0.54 0.52 1.   0.67 0.83 0.34 0.28]
 [0.8  0.73 0.53 0.74 1.   0.8  0.51 0.54]
 [0.56 0.41 0.31 0.6  0.53 1.   0.3  0.34]
 [0.72 0.69 0.53 0.64 0.75 0.75 1.   0.54]
 [0.52 0.34 0.31 0.34 0.42 0.46 0.24 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.91 0.83 0.77 0.93 0.85 0.8  0.82]
 [0.91 1.   0.89 0.84 0.92 0.86 0.83 0.77]
 [0.83 0.89 1.   0.86 0.84 0.8  0.83 0.72]
 [0.77 0.84 0.86 1.   0.86 0.86 0.79 0.61]
 [0.93 0.92 0.84 0.86 1.   0.86 0.84 0.7 ]
 [0.85 0.86 0.8  0.86 0.86 1.   0.81 0.69]
 [0.8  0.83 0.83 0.79 0.84 0.81 1.   0.65]
 [0.82 0.77 0.72 0.61 0.7  0.69 0.65 1.  ]]
Collapsing 0 & 4 with crosscontam 0.6637549597666919 and sim 0.9306362985927363
Collapsing 1 & 4 with crosscontam 0.7276712287963045 and sim 0.9236630918580975
Collapsing 0 & 1 with crosscontam 0.5743811590982599 and sim 0.9112591133665181
Collapsing 1 & 2 with crosscontam 0.6102674501758494 and sim 0.8861387287590892
Collapsing 3 & 5 with crosscontam 0.6041131421541528 and sim 0.8588956427183733
Collapsing 4 & 5 with crosscontam 0.5293821202532345 and sim 0.8568330943906838
Collapsing 2 & 3 with crosscontam 0.5218980830732185 and sim 0.8560377348154126
Collapsing 3 & 4 with crosscontam 0.6745975452092121 and sim 0.8556516262556704
Collapsing 0 & 5 with crosscontam 0.5619496123451162 and sim 0.8522498633543546
Trimming eliminated 0 seqlets out of 471
Trimming eliminated 0 seqlets out of 724
Removed 1 duplicate seqlets
Trimming eliminated 0 seqlets out of 965
Trimming eliminated 0 seqlets out of 356
Trimming eliminated 0 seqlets out of 1321
Unmerged patterns remapping: OrderedDict([(6, 1), (7, 2)])
Time spent on merging iteration: 7.281583786010742
On merging iteration 2
Numbers for each pattern pre-subsample: [1321, 139, 38]
Numbers after subsampling: [300, 139, 38]
Computing sims for pattern 0
Computed sims for pattern 0 in 0.5740292072296143 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.20109248161315918 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.06865620613098145 s
Cluster sizes
[1321  139   38]
Cross-contamination matrix:
[[1.   0.69 0.58]
 [0.68 1.   0.54]
 [0.27 0.24 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.85 0.76]
 [0.85 1.   0.65]
 [0.76 0.65 1.  ]]
Collapsing 0 & 1 with crosscontam 0.6760404410801881 and sim 0.8534536397324257
Removed 1 duplicate seqlets
Trimming eliminated 0 seqlets out of 1459
Unmerged patterns remapping: OrderedDict([(2, 1)])
Time spent on merging iteration: 2.0581555366516113
On merging iteration 3
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 1326 out of 1326 | elapsed:    0.7s finished
Numbers for each pattern pre-subsample: [1459, 38]
Numbers after subsampling: [300, 38]
Computing sims for pattern 0
Computed sims for pattern 0 in 0.26723265647888184 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.07347893714904785 s
Cluster sizes
[1459   38]
Cross-contamination matrix:
[[1.   0.67]
 [0.29 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.76]
 [0.76 1.  ]]
Inspecting pattern 2 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 1326
[t-SNE] Computed conditional probabilities for sample 1326 / 1326
[t-SNE] Mean sigma: 0.295933
Beginning preprocessing + Leiden
2024-03-16 17:47:32.972157 MEMORY 16.553627648
Affmat transformed
2024-03-16 17:47:32.989426 MEMORY 16.553627648
sources, targets, weights extracted
2024-03-16 17:47:33.001413 MEMORY 16.553627648
About to launch parallel Leiden runs
2024-03-16 17:47:33.010205 MEMORY 16.553627648
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    4.6s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   15.6s finished
Parallel Leiden runs finished
2024-03-16 17:47:48.570417 MEMORY 16.553627648
Quality: 0.45400033579351673
Quality: 0.45764945913296123
Quality: 0.4576504237269597
Quality: 0.45768438831344044
Got subclusters: Counter({0: 367, 1: 245, 2: 226, 3: 187, 4: 118, 5: 111, 6: 51, 7: 16, 8: 5})
On merging iteration 1
Numbers for each pattern pre-subsample: [367, 245, 226, 187, 118, 111, 51, 16, 5]
Numbers after subsampling: [300, 245, 226, 187, 118, 111, 51, 16, 5]
Computing sims for pattern 0
Computed sims for pattern 0 in 2.3793745040893555 s
Computing sims for pattern 1
Computed sims for pattern 1 in 1.7527596950531006 s
Computing sims for pattern 2
Computed sims for pattern 2 in 2.125343084335327 s
Computing sims for pattern 3
Computed sims for pattern 3 in 1.6253297328948975 s
Computing sims for pattern 4
Computed sims for pattern 4 in 1.0739455223083496 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.9772260189056396 s
Computing sims for pattern 6
Computed sims for pattern 6 in 0.519338846206665 s
Computing sims for pattern 7
Computed sims for pattern 7 in 0.25019311904907227 s
Computing sims for pattern 8
Computed sims for pattern 8 in 0.16572952270507812 s
Cluster sizes
[367 245 226 187 118 111  51  16   5]
Cross-contamination matrix:
[[1.   0.45 0.41 0.77 0.65 0.43 0.53 0.47 0.04]
 [0.78 1.   0.78 0.8  0.88 0.44 0.67 0.67 0.1 ]
 [0.76 0.85 1.   0.86 0.83 0.5  0.72 0.71 0.14]
 [0.81 0.49 0.5  1.   0.76 0.42 0.56 0.38 0.04]
 [0.63 0.48 0.41 0.71 1.   0.28 0.42 0.28 0.03]
 [0.89 0.54 0.56 0.84 0.74 1.   0.55 0.47 0.13]
 [0.69 0.47 0.48 0.69 0.59 0.3  1.   0.34 0.07]
 [0.75 0.59 0.56 0.59 0.53 0.29 0.43 1.   0.05]
 [0.64 0.48 0.49 0.61 0.54 0.51 0.59 0.54 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.77 0.74 0.88 0.83 0.78 0.87 0.79 0.4 ]
 [0.77 1.   0.93 0.84 0.85 0.66 0.8  0.85 0.29]
 [0.74 0.93 1.   0.85 0.83 0.64 0.77 0.84 0.33]
 [0.88 0.84 0.85 1.   0.9  0.77 0.86 0.73 0.39]
 [0.83 0.85 0.83 0.9  1.   0.74 0.8  0.71 0.23]
 [0.78 0.66 0.64 0.77 0.74 1.   0.64 0.5  0.26]
 [0.87 0.8  0.77 0.86 0.8  0.64 1.   0.77 0.38]
 [0.79 0.85 0.84 0.73 0.71 0.5  0.77 1.   0.29]
 [0.4  0.29 0.33 0.39 0.23 0.26 0.38 0.29 1.  ]]
Collapsing 1 & 2 with crosscontam 0.775184187372413 and sim 0.9325662995546481
Collapsing 3 & 4 with crosscontam 0.7058887191550105 and sim 0.9031074183110513
Collapsing 0 & 3 with crosscontam 0.7700695068330363 and sim 0.8836419222633438
Collapsing 0 & 6 with crosscontam 0.5332009818445895 and sim 0.8656257860865456
Collapsing 3 & 6 with crosscontam 0.5629467593000099 and sim 0.8584845353424152
Collapsing 1 & 7 with crosscontam 0.5900470344387756 and sim 0.8502817327152848
Trimming eliminated 0 seqlets out of 471
Trimming eliminated 0 seqlets out of 305
Trimming eliminated 0 seqlets out of 672
Trimming eliminated 0 seqlets out of 723
Trimming eliminated 0 seqlets out of 487
Unmerged patterns remapping: OrderedDict([(5, 2), (8, 3)])
Time spent on merging iteration: 4.229432106018066
On merging iteration 2
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 930 tasks      | elapsed:    0.5s
[Parallel(n_jobs=24)]: Done 1067 out of 1067 | elapsed:    0.7s finished
Numbers for each pattern pre-subsample: [723, 487, 111, 5]
Numbers after subsampling: [300, 300, 111, 5]
Computing sims for pattern 0
Computed sims for pattern 0 in 0.918508768081665 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.9010705947875977 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.3103909492492676 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.06383609771728516 s
Cluster sizes
[723 487 111   5]
Cross-contamination matrix:
[[1.   0.6  0.57 0.09]
 [0.92 1.   0.6  0.17]
 [0.81 0.53 1.   0.13]
 [0.61 0.49 0.51 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.85 0.79 0.38]
 [0.85 1.   0.66 0.31]
 [0.79 0.66 1.   0.26]
 [0.38 0.31 0.26 1.  ]]
Inspecting pattern 3 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 1067
[t-SNE] Computed conditional probabilities for sample 1067 / 1067
[t-SNE] Mean sigma: 0.297226
Beginning preprocessing + Leiden
2024-03-16 17:48:07.873956 MEMORY 16.553627648
Affmat transformed
2024-03-16 17:48:07.887546 MEMORY 16.553627648
sources, targets, weights extracted
2024-03-16 17:48:07.896775 MEMORY 16.553627648
About to launch parallel Leiden runs
2024-03-16 17:48:07.906822 MEMORY 16.553627648
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    3.6s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   11.4s finished
Parallel Leiden runs finished
2024-03-16 17:48:19.333312 MEMORY 16.553627648
Quality: 0.42178924718476124
Quality: 0.4220732618930874
Quality: 0.42351787372215044
Quality: 0.42371156885480843
Quality: 0.42376161715405464
Quality: 0.42380662245340534
Got subclusters: Counter({0: 192, 1: 191, 2: 162, 3: 139, 4: 139, 5: 91, 6: 87, 7: 50, 8: 16})
On merging iteration 1
Numbers for each pattern pre-subsample: [192, 191, 162, 139, 139, 91, 87, 50, 16]
Numbers after subsampling: [192, 191, 162, 139, 139, 91, 87, 50, 16]
Computing sims for pattern 0
Computed sims for pattern 0 in 1.5782806873321533 s
Computing sims for pattern 1
Computed sims for pattern 1 in 1.5994846820831299 s
Computing sims for pattern 2
Computed sims for pattern 2 in 1.2830233573913574 s
Computing sims for pattern 3
Computed sims for pattern 3 in 1.2248752117156982 s
Computing sims for pattern 4
Computed sims for pattern 4 in 1.2423577308654785 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.861264705657959 s
Computing sims for pattern 6
Computed sims for pattern 6 in 0.8041419982910156 s
Computing sims for pattern 7
Computed sims for pattern 7 in 0.48314666748046875 s
Computing sims for pattern 8
Computed sims for pattern 8 in 0.2288815975189209 s
Cluster sizes
[192 191 162 139 139  91  87  50  16]
Cross-contamination matrix:
[[1.   0.46 0.69 0.65 0.54 0.72 0.55 0.43 0.75]
 [0.59 1.   0.75 0.71 0.57 0.78 0.46 0.27 0.89]
 [0.86 0.63 1.   0.69 0.58 0.87 0.5  0.38 0.76]
 [0.79 0.56 0.61 1.   0.5  0.61 0.53 0.34 0.67]
 [0.72 0.5  0.61 0.54 1.   0.8  0.51 0.32 0.69]
 [0.75 0.52 0.73 0.61 0.62 1.   0.47 0.33 0.77]
 [0.88 0.51 0.64 0.73 0.63 0.75 1.   0.9  0.68]
 [0.71 0.28 0.47 0.48 0.41 0.5  0.85 1.   0.48]
 [0.55 0.36 0.46 0.39 0.29 0.51 0.22 0.1  1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.82 0.92 0.94 0.94 0.94 0.86 0.75 0.92]
 [0.82 1.   0.88 0.84 0.79 0.86 0.77 0.59 0.84]
 [0.92 0.88 1.   0.9  0.86 0.93 0.77 0.62 0.88]
 [0.94 0.84 0.9  1.   0.88 0.9  0.78 0.66 0.88]
 [0.94 0.79 0.86 0.88 1.   0.9  0.82 0.7  0.88]
 [0.94 0.86 0.93 0.9  0.9  1.   0.83 0.68 0.91]
 [0.86 0.77 0.77 0.78 0.82 0.83 1.   0.93 0.72]
 [0.75 0.59 0.62 0.66 0.7  0.68 0.93 1.   0.58]
 [0.92 0.84 0.88 0.88 0.88 0.91 0.72 0.58 1.  ]]
Collapsing 0 & 4 with crosscontam 0.5414436395219762 and sim 0.9392699845314523
Collapsing 0 & 5 with crosscontam 0.7164133248117623 and sim 0.9388652339239596
Collapsing 0 & 3 with crosscontam 0.6452136183305959 and sim 0.9353792706898287
Collapsing 2 & 5 with crosscontam 0.7289447572022141 and sim 0.9332057216041763
Collapsing 6 & 7 with crosscontam 0.8498070804597702 and sim 0.9278928305664098
Collapsing 0 & 2 with crosscontam 0.6853648579496741 and sim 0.9234079811864976
Collapsing 0 & 8 with crosscontam 0.5541585286458333 and sim 0.921936762287993
Collapsing 5 & 8 with crosscontam 0.5095939217032968 and sim 0.9133117518114688
Collapsing 3 & 5 with crosscontam 0.6074704126498172 and sim 0.9025005444717931
Collapsing 4 & 5 with crosscontam 0.618150267337668 and sim 0.8996422970394085
Collapsing 2 & 3 with crosscontam 0.6085306705322675 and sim 0.8992263262033741
Collapsing 3 & 4 with crosscontam 0.5002153422872453 and sim 0.8843099741233972
Collapsing 1 & 2 with crosscontam 0.6295070694435443 and sim 0.8788267251214653
Collapsing 2 & 4 with crosscontam 0.5797550244110965 and sim 0.8611966850467782
Collapsing 1 & 5 with crosscontam 0.5193431086907037 and sim 0.8586054779266519
Collapsing 0 & 6 with crosscontam 0.5482738782315115 and sim 0.8551803894101713
Aborting collapse as 1 & 7 have cross-contam 0.27578027120192095 and sim 0.5923068457345714
Aborting collapse as 4 & 7 have cross-contam 0.3687899804879248 and sim 0.6951250813583989
Aborting collapse as 7 & 8 have cross-contam 0.29013690625 and sim 0.5814424016844776
Trimming eliminated 0 seqlets out of 331
Trimming eliminated 0 seqlets out of 422
Trimming eliminated 0 seqlets out of 561
Trimming eliminated 0 seqlets out of 723
Trimming eliminated 0 seqlets out of 137
Trimming eliminated 0 seqlets out of 739
Trimming eliminated 0 seqlets out of 930
Unmerged patterns remapping: OrderedDict()
Time spent on merging iteration: 4.985378265380859
On merging iteration 2
Numbers for each pattern pre-subsample: [930, 137]
Numbers after subsampling: [300, 137]
Computing sims for pattern 0
Computed sims for pattern 0 in 0.32456040382385254 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.197401762008667 s
Cluster sizes
[930 137]
Cross-contamination matrix:
[[1.   0.79]
 [0.71 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.83]
 [0.83 1.  ]]
Merging on 12 clusters
2024-03-16 17:48:34.190723 MEMORY 16.553627648
On merging iteration 1
Numbers for each pattern pre-subsample: [928, 250, 222, 158, 1459, 38, 723, 487, 111, 5, 930, 137]
Numbers after subsampling: [300, 250, 222, 158, 300, 38, 300, 300, 111, 5, 300, 137]
Computing sims for pattern 0
Computed sims for pattern 0 in 3.6458637714385986 s
Computing sims for pattern 1
Computed sims for pattern 1 in 2.697134256362915 s
Computing sims for pattern 2
Computed sims for pattern 2 in 3.09263014793396 s
Computing sims for pattern 3
Computed sims for pattern 3 in 2.0108604431152344 s
Computing sims for pattern 4
Computed sims for pattern 4 in 3.7335398197174072 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.656085729598999 s
Computing sims for pattern 6
Computed sims for pattern 6 in 3.6688005924224854 s
Computing sims for pattern 7
Computed sims for pattern 7 in 4.982791185379028 s
Computing sims for pattern 8
Computed sims for pattern 8 in 1.5027263164520264 s
Computing sims for pattern 9
Computed sims for pattern 9 in 0.2831408977508545 s
Computing sims for pattern 10
Computed sims for pattern 10 in 3.701190710067749 s
Computing sims for pattern 11
Computed sims for pattern 11 in 1.9069528579711914 s
Cluster sizes
[ 928  250  222  158 1459   38  723  487  111    5  930  137]
Cross-contamination matrix:
[[1.   0.79 0.85 0.61 0.7  0.58 0.27 0.08 0.27 0.04 0.18 0.09]
 [0.58 1.   0.77 0.53 0.31 0.15 0.1  0.05 0.08 0.01 0.34 0.13]
 [0.55 0.67 1.   0.41 0.42 0.42 0.07 0.02 0.08 0.   0.15 0.05]
 [0.56 0.6  0.53 1.   0.48 0.62 0.3  0.11 0.16 0.03 0.27 0.13]
 [0.79 0.55 0.78 0.63 1.   0.67 0.44 0.12 0.4  0.03 0.21 0.11]
 [0.32 0.15 0.39 0.45 0.29 1.   0.32 0.09 0.1  0.   0.29 0.13]
 [0.22 0.15 0.13 0.29 0.29 0.49 1.   0.6  0.57 0.09 0.21 0.4 ]
 [0.15 0.17 0.11 0.24 0.11 0.42 0.92 1.   0.6  0.17 0.46 0.89]
 [0.35 0.2  0.24 0.28 0.44 0.37 0.81 0.53 1.   0.13 0.16 0.32]
 [0.38 0.37 0.38 0.44 0.42 0.56 0.61 0.49 0.51 1.   0.47 0.47]
 [0.21 0.56 0.36 0.38 0.24 0.62 0.32 0.36 0.14 0.07 1.   0.79]
 [0.09 0.25 0.14 0.18 0.12 0.35 0.48 0.67 0.23 0.12 0.71 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.78 0.79 0.81 0.88 0.76 0.57 0.26 0.61 0.06 0.4  0.27]
 [0.78 1.   0.85 0.72 0.72 0.58 0.41 0.23 0.37 0.02 0.67 0.41]
 [0.79 0.85 1.   0.77 0.79 0.75 0.52 0.26 0.49 0.06 0.52 0.27]
 [0.81 0.72 0.77 1.   0.73 0.79 0.57 0.28 0.53 0.1  0.58 0.35]
 [0.88 0.72 0.79 0.73 1.   0.76 0.63 0.27 0.64 0.08 0.42 0.28]
 [0.76 0.58 0.75 0.79 0.76 1.   0.73 0.48 0.5  0.26 0.76 0.57]
 [0.57 0.41 0.52 0.57 0.63 0.73 1.   0.85 0.79 0.38 0.55 0.72]
 [0.26 0.23 0.26 0.28 0.27 0.48 0.85 1.   0.66 0.31 0.56 0.87]
 [0.61 0.37 0.49 0.53 0.64 0.5  0.79 0.66 1.   0.26 0.35 0.47]
 [0.06 0.02 0.06 0.1  0.08 0.26 0.38 0.31 0.26 1.   0.21 0.31]
 [0.4  0.67 0.52 0.58 0.42 0.76 0.55 0.56 0.35 0.21 1.   0.83]
 [0.27 0.41 0.27 0.35 0.28 0.57 0.72 0.87 0.47 0.31 0.83 1.  ]]
Collapsing 0 & 4 with crosscontam 0.6983940844444445 and sim 0.8826564754675472
Collapsing 7 & 11 with crosscontam 0.668802642033202 and sim 0.8727221822386666
Trimming eliminated 0 seqlets out of 2387
Trimming eliminated 0 seqlets out of 624
Unmerged patterns remapping: OrderedDict([(1, 4), (2, 5), (3, 6), (5, 8), (6, 2), (8, 7), (9, 9), (10, 1)])
Time spent on merging iteration: 7.514525651931763
On merging iteration 2
Numbers for each pattern pre-subsample: [2387, 930, 723, 624, 250, 222, 158, 111, 38, 5]
Numbers after subsampling: [300, 300, 300, 300, 250, 222, 158, 111, 38, 5]
Computing sims for pattern 0
Computed sims for pattern 0 in 2.983187198638916 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.7150492668151855 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.7425529956817627 s
Computing sims for pattern 3
Computed sims for pattern 3 in 3.0044033527374268 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.5628659725189209 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.641453742980957 s
Computing sims for pattern 6
Computed sims for pattern 6 in 0.41765713691711426 s
Computing sims for pattern 7
Computed sims for pattern 7 in 0.30738329887390137 s
Computing sims for pattern 8
Computed sims for pattern 8 in 0.13812565803527832 s
Computing sims for pattern 9
Computed sims for pattern 9 in 0.06538867950439453 s
Cluster sizes
[2387  930  723  624  250  222  158  111   38    5]
Cross-contamination matrix:
[[1.   0.29 0.44 0.16 0.65 0.89 0.82 0.44 0.82 0.05]
 [0.25 1.   0.32 0.46 0.56 0.36 0.38 0.14 0.62 0.07]
 [0.28 0.21 1.   0.56 0.15 0.13 0.29 0.57 0.49 0.09]
 [0.2  0.57 0.89 1.   0.23 0.11 0.26 0.55 0.45 0.16]
 [0.35 0.34 0.1  0.07 1.   0.77 0.53 0.08 0.15 0.01]
 [0.45 0.15 0.07 0.02 0.67 1.   0.41 0.08 0.42 0.  ]
 [0.46 0.27 0.3  0.12 0.6  0.53 1.   0.16 0.62 0.03]
 [0.42 0.16 0.81 0.48 0.2  0.24 0.28 1.   0.37 0.13]
 [0.36 0.29 0.32 0.1  0.15 0.39 0.45 0.1  1.   0.  ]
 [0.42 0.47 0.61 0.49 0.37 0.38 0.44 0.51 0.56 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.45 0.62 0.29 0.66 0.82 0.77 0.65 0.75 0.08]
 [0.45 1.   0.55 0.63 0.67 0.52 0.58 0.35 0.76 0.21]
 [0.62 0.55 1.   0.84 0.41 0.52 0.57 0.79 0.73 0.38]
 [0.29 0.63 0.84 1.   0.27 0.26 0.3  0.63 0.51 0.3 ]
 [0.66 0.67 0.41 0.27 1.   0.85 0.72 0.37 0.58 0.02]
 [0.82 0.52 0.52 0.26 0.85 1.   0.77 0.49 0.75 0.06]
 [0.77 0.58 0.57 0.3  0.72 0.77 1.   0.53 0.79 0.1 ]
 [0.65 0.35 0.79 0.63 0.37 0.49 0.53 1.   0.5  0.26]
 [0.75 0.76 0.73 0.51 0.58 0.75 0.79 0.5  1.   0.26]
 [0.08 0.21 0.38 0.3  0.02 0.06 0.1  0.26 0.26 1.  ]]
Got 10 patterns after merging
2024-03-16 17:49:22.151208 MEMORY 16.553627648
Performing filtering
2024-03-16 17:49:22.151396 MEMORY 16.553627648
Got 9 patterns after filtering
2024-03-16 17:49:22.958846 MEMORY 16.553627648
Total time taken is 722.12s
2024-03-16 17:49:22.959038 MEMORY 16.553627648
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 2387 out of 2387 | elapsed:    0.5s finished
/ru-auth/local/home/lzhao/anaconda3/envs/jupyter-ml-clone/lib/python3.9/site-packages/sklearn/manifold/_t_sne.py:691: FutureWarning: 'square_distances' has been introduced in 0.24 to help phase out legacy squaring behavior. The 'legacy' setting will be removed in 1.1 (renaming of 0.26), and the default setting will be changed to True. In 1.3, 'square_distances' will be removed altogether, and distances will be squared by default. Set 'square_distances'=True to silence this warning.
  warnings.warn(
/ru-auth/local/home/lzhao/anaconda3/envs/jupyter-ml-clone/lib/python3.9/site-packages/sklearn/neighbors/_base.py:175: EfficiencyWarning: Precomputed sparse input was not sorted by data.
  warnings.warn('Precomputed sparse input was not sorted by data.',
Applying subclustering to the final motifs
On pattern 0
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 2387 samples in 0.021s...
[t-SNE] Computed neighbors for 2387 samples in 0.002s...
[t-SNE] Computed conditional probabilities for sample 1000 / 2387
[t-SNE] Computed conditional probabilities for sample 2000 / 2387
[t-SNE] Computed conditional probabilities for sample 2387 / 2387
[t-SNE] Mean sigma: 0.293723
[t-SNE] Computed conditional probabilities in 0.167s
[t-SNE] Iteration 50: error = 72.7002945, gradient norm = 0.0643629 (50 iterations in 2.405s)
[t-SNE] Iteration 100: error = 72.6784210, gradient norm = 0.0425068 (50 iterations in 2.226s)
[t-SNE] Iteration 150: error = 72.6805038, gradient norm = 0.0460009 (50 iterations in 2.223s)
[t-SNE] Iteration 200: error = 73.0216217, gradient norm = 0.0373973 (50 iterations in 2.211s)
[t-SNE] Iteration 250: error = 73.1255264, gradient norm = 0.0472860 (50 iterations in 2.214s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 73.125526
[t-SNE] Iteration 300: error = 2.3821723, gradient norm = 0.0012507 (50 iterations in 2.199s)
[t-SNE] Iteration 350: error = 2.2740793, gradient norm = 0.0004206 (50 iterations in 2.230s)
[t-SNE] Iteration 400: error = 2.2276366, gradient norm = 0.0002305 (50 iterations in 2.865s)
[t-SNE] Iteration 450: error = 2.2033539, gradient norm = 0.0001579 (50 iterations in 2.968s)
[t-SNE] Iteration 500: error = 2.1898959, gradient norm = 0.0001484 (50 iterations in 2.322s)
[t-SNE] Iteration 550: error = 2.1834655, gradient norm = 0.0000904 (50 iterations in 2.210s)
[t-SNE] Iteration 600: error = 2.1791239, gradient norm = 0.0000837 (50 iterations in 2.209s)
[t-SNE] Iteration 650: error = 2.1756732, gradient norm = 0.0000679 (50 iterations in 2.186s)
[t-SNE] Iteration 700: error = 2.1730804, gradient norm = 0.0000553 (50 iterations in 2.195s)
[t-SNE] Iteration 750: error = 2.1708744, gradient norm = 0.0000498 (50 iterations in 2.226s)
[t-SNE] Iteration 800: error = 2.1691344, gradient norm = 0.0000475 (50 iterations in 2.200s)
[t-SNE] Iteration 850: error = 2.1679180, gradient norm = 0.0000485 (50 iterations in 2.189s)
[t-SNE] Iteration 900: error = 2.1669214, gradient norm = 0.0000540 (50 iterations in 2.191s)
[t-SNE] Iteration 950: error = 2.1661258, gradient norm = 0.0000432 (50 iterations in 2.199s)
[t-SNE] Iteration 1000: error = 2.1654155, gradient norm = 0.0000349 (50 iterations in 2.215s)
[t-SNE] KL divergence after 1000 iterations: 2.165416
[t-SNE] Computed conditional probabilities for sample 1000 / 2387
[t-SNE] Computed conditional probabilities for sample 2000 / 2387
[t-SNE] Computed conditional probabilities for sample 2387 / 2387
[t-SNE] Mean sigma: 0.293723
Beginning preprocessing + Leiden
2024-03-16 17:50:12.163549 MEMORY 16.570650624
Affmat transformed
2024-03-16 17:50:12.194436 MEMORY 16.570650624
sources, targets, weights extracted
2024-03-16 17:50:12.214091 MEMORY 16.570650624
About to launch parallel Leiden runs
2024-03-16 17:50:12.226153 MEMORY 16.570650624
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    8.6s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   29.3s finished
Parallel Leiden runs finished
2024-03-16 17:50:41.543708 MEMORY 16.570650624
Quality: 0.4788679082263071
Quality: 0.48311449438171533
Quality: 0.48339276209477466
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 930 out of 930 | elapsed:    0.5s finished
Got subclusters: Counter({0: 439, 1: 394, 2: 299, 3: 255, 4: 245, 5: 236, 6: 221, 7: 162, 8: 136})
On pattern 1
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 930 samples in 0.007s...
[t-SNE] Computed neighbors for 930 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 930 / 930
[t-SNE] Mean sigma: 0.299969
[t-SNE] Computed conditional probabilities in 0.068s
[t-SNE] Iteration 50: error = 66.9213104, gradient norm = 0.3474533 (50 iterations in 2.151s)
[t-SNE] Iteration 100: error = 68.2744370, gradient norm = 0.3248117 (50 iterations in 2.151s)
[t-SNE] Iteration 150: error = 69.2639313, gradient norm = 0.2949944 (50 iterations in 2.178s)
[t-SNE] Iteration 200: error = 68.5862122, gradient norm = 0.3170456 (50 iterations in 2.157s)
[t-SNE] Iteration 250: error = 68.5946045, gradient norm = 0.3264433 (50 iterations in 2.170s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 68.594604
[t-SNE] Iteration 300: error = 1.7899371, gradient norm = 0.0022130 (50 iterations in 2.161s)
[t-SNE] Iteration 350: error = 1.7030053, gradient norm = 0.0010446 (50 iterations in 2.149s)
[t-SNE] Iteration 400: error = 1.6818326, gradient norm = 0.0003615 (50 iterations in 2.149s)
[t-SNE] Iteration 450: error = 1.6651425, gradient norm = 0.0004663 (50 iterations in 2.166s)
[t-SNE] Iteration 500: error = 1.6545134, gradient norm = 0.0003573 (50 iterations in 2.160s)
[t-SNE] Iteration 550: error = 1.6497470, gradient norm = 0.0002359 (50 iterations in 2.165s)
[t-SNE] Iteration 600: error = 1.6381067, gradient norm = 0.0003052 (50 iterations in 2.152s)
[t-SNE] Iteration 650: error = 1.6346812, gradient norm = 0.0001690 (50 iterations in 2.158s)
[t-SNE] Iteration 700: error = 1.6338896, gradient norm = 0.0001158 (50 iterations in 2.169s)
[t-SNE] Iteration 750: error = 1.6327758, gradient norm = 0.0001038 (50 iterations in 2.162s)
[t-SNE] Iteration 800: error = 1.6320527, gradient norm = 0.0000721 (50 iterations in 2.158s)
[t-SNE] Iteration 850: error = 1.6309004, gradient norm = 0.0001357 (50 iterations in 2.171s)
[t-SNE] Iteration 900: error = 1.6300898, gradient norm = 0.0000936 (50 iterations in 2.139s)
[t-SNE] Iteration 950: error = 1.6284555, gradient norm = 0.0001219 (50 iterations in 2.145s)
[t-SNE] Iteration 1000: error = 1.6271085, gradient norm = 0.0000887 (50 iterations in 2.168s)
[t-SNE] KL divergence after 1000 iterations: 1.627108
[t-SNE] Computed conditional probabilities for sample 930 / 930
[t-SNE] Mean sigma: 0.299969
Beginning preprocessing + Leiden
2024-03-16 17:51:26.549370 MEMORY 16.57065472
Affmat transformed
2024-03-16 17:51:26.561790 MEMORY 16.57065472
sources, targets, weights extracted
2024-03-16 17:51:26.569457 MEMORY 16.57065472
About to launch parallel Leiden runs
2024-03-16 17:51:26.581951 MEMORY 16.57065472
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    3.1s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    9.3s finished
Parallel Leiden runs finished
2024-03-16 17:51:35.912275 MEMORY 16.57065472
Quality: 0.4298668415123138
Quality: 0.4307878771643792
Quality: 0.43151427274089693
Quality: 0.43234223652041004
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 723 out of 723 | elapsed:    0.2s finished
Got subclusters: Counter({0: 194, 1: 186, 2: 150, 3: 134, 4: 133, 5: 123, 6: 10})
On pattern 2
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 723 samples in 0.005s...
[t-SNE] Computed neighbors for 723 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 723 / 723
[t-SNE] Mean sigma: 0.292400
[t-SNE] Computed conditional probabilities in 0.052s
[t-SNE] Iteration 50: error = 69.4359436, gradient norm = 0.3740048 (50 iterations in 2.129s)
[t-SNE] Iteration 100: error = 70.7943268, gradient norm = 0.3587769 (50 iterations in 2.139s)
[t-SNE] Iteration 150: error = 71.4084625, gradient norm = 0.3592755 (50 iterations in 2.159s)
[t-SNE] Iteration 200: error = 72.7749252, gradient norm = 0.3494126 (50 iterations in 2.155s)
[t-SNE] Iteration 250: error = 71.3880310, gradient norm = 0.3611501 (50 iterations in 2.166s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 71.388031
[t-SNE] Iteration 300: error = 1.6299047, gradient norm = 0.0035234 (50 iterations in 2.160s)
[t-SNE] Iteration 350: error = 1.5327396, gradient norm = 0.0011282 (50 iterations in 2.143s)
[t-SNE] Iteration 400: error = 1.5124493, gradient norm = 0.0004799 (50 iterations in 2.157s)
[t-SNE] Iteration 450: error = 1.4964828, gradient norm = 0.0006260 (50 iterations in 2.157s)
[t-SNE] Iteration 500: error = 1.4883084, gradient norm = 0.0002859 (50 iterations in 2.147s)
[t-SNE] Iteration 550: error = 1.4840286, gradient norm = 0.0003242 (50 iterations in 2.168s)
[t-SNE] Iteration 600: error = 1.4647914, gradient norm = 0.0003000 (50 iterations in 2.147s)
[t-SNE] Iteration 650: error = 1.4613080, gradient norm = 0.0002314 (50 iterations in 2.146s)
[t-SNE] Iteration 700: error = 1.4569664, gradient norm = 0.0002377 (50 iterations in 2.168s)
[t-SNE] Iteration 750: error = 1.4561645, gradient norm = 0.0001281 (50 iterations in 2.161s)
[t-SNE] Iteration 800: error = 1.4556636, gradient norm = 0.0000589 (50 iterations in 2.139s)
[t-SNE] Iteration 850: error = 1.4553502, gradient norm = 0.0000567 (50 iterations in 2.145s)
[t-SNE] Iteration 900: error = 1.4546549, gradient norm = 0.0001271 (50 iterations in 2.165s)
[t-SNE] Iteration 950: error = 1.4530835, gradient norm = 0.0001119 (50 iterations in 2.149s)
[t-SNE] Iteration 1000: error = 1.4515165, gradient norm = 0.0001845 (50 iterations in 2.167s)
[t-SNE] KL divergence after 1000 iterations: 1.451517
[t-SNE] Computed conditional probabilities for sample 723 / 723
[t-SNE] Mean sigma: 0.292400
Beginning preprocessing + Leiden
2024-03-16 17:52:20.128291 MEMORY 16.57065472
Affmat transformed
2024-03-16 17:52:20.138921 MEMORY 16.57065472
sources, targets, weights extracted
2024-03-16 17:52:20.145595 MEMORY 16.57065472
About to launch parallel Leiden runs
2024-03-16 17:52:20.161063 MEMORY 16.57065472
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    2.3s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    7.5s finished
Parallel Leiden runs finished
2024-03-16 17:52:27.670365 MEMORY 16.57065472
Quality: 0.41244679417609775
Quality: 0.41268587512306415
Quality: 0.4130414570804413
Quality: 0.41307562541744774
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 624 out of 624 | elapsed:    0.2s finished
Got subclusters: Counter({0: 158, 1: 137, 2: 111, 3: 109, 4: 98, 6: 55, 5: 55})
On pattern 3
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 624 samples in 0.005s...
[t-SNE] Computed neighbors for 624 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 624 / 624
[t-SNE] Mean sigma: 0.328338
[t-SNE] Computed conditional probabilities in 0.044s
[t-SNE] Iteration 50: error = 68.8423386, gradient norm = 0.4098510 (50 iterations in 2.160s)
[t-SNE] Iteration 100: error = 71.3299026, gradient norm = 0.3896789 (50 iterations in 2.159s)
[t-SNE] Iteration 150: error = 70.8378448, gradient norm = 0.3929588 (50 iterations in 2.158s)
[t-SNE] Iteration 200: error = 72.6071625, gradient norm = 0.3699791 (50 iterations in 2.159s)
[t-SNE] Iteration 250: error = 69.9961166, gradient norm = 0.4067873 (50 iterations in 2.135s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 69.996117
[t-SNE] Iteration 300: error = 1.4918214, gradient norm = 0.0027168 (50 iterations in 2.161s)
[t-SNE] Iteration 350: error = 1.4284496, gradient norm = 0.0011116 (50 iterations in 2.151s)
[t-SNE] Iteration 400: error = 1.4120264, gradient norm = 0.0004129 (50 iterations in 2.162s)
[t-SNE] Iteration 450: error = 1.4079106, gradient norm = 0.0001678 (50 iterations in 2.172s)
[t-SNE] Iteration 500: error = 1.4047763, gradient norm = 0.0001572 (50 iterations in 2.154s)
[t-SNE] Iteration 550: error = 1.3993423, gradient norm = 0.0003915 (50 iterations in 2.143s)
[t-SNE] Iteration 600: error = 1.3960047, gradient norm = 0.0002016 (50 iterations in 2.137s)
[t-SNE] Iteration 650: error = 1.3951272, gradient norm = 0.0001195 (50 iterations in 2.144s)
[t-SNE] Iteration 700: error = 1.3943408, gradient norm = 0.0001012 (50 iterations in 2.153s)
[t-SNE] Iteration 750: error = 1.3917105, gradient norm = 0.0002558 (50 iterations in 2.160s)
[t-SNE] Iteration 800: error = 1.3912309, gradient norm = 0.0002578 (50 iterations in 2.158s)
[t-SNE] Iteration 850: error = 1.3881642, gradient norm = 0.0002121 (50 iterations in 2.151s)
[t-SNE] Iteration 900: error = 1.3881902, gradient norm = 0.0000559 (50 iterations in 2.169s)
[t-SNE] Iteration 950: error = 1.3871716, gradient norm = 0.0001821 (50 iterations in 2.133s)
[t-SNE] Iteration 1000: error = 1.3869427, gradient norm = 0.0000579 (50 iterations in 2.201s)
[t-SNE] KL divergence after 1000 iterations: 1.386943
[t-SNE] Computed conditional probabilities for sample 624 / 624
[t-SNE] Mean sigma: 0.328338
Beginning preprocessing + Leiden
2024-03-16 17:53:11.894258 MEMORY 16.57065472
Affmat transformed
2024-03-16 17:53:11.903830 MEMORY 16.57065472
sources, targets, weights extracted
2024-03-16 17:53:11.908691 MEMORY 16.57065472
About to launch parallel Leiden runs
2024-03-16 17:53:11.914234 MEMORY 16.57065472
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    2.0s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    6.2s finished
Parallel Leiden runs finished
2024-03-16 17:53:18.101220 MEMORY 16.57065472
Quality: 0.421236542758865
Quality: 0.4212557723424044
Quality: 0.4227278491835979
Quality: 0.42276691289407275
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 250 out of 250 | elapsed:    0.1s finished
Got subclusters: Counter({0: 157, 1: 130, 2: 121, 3: 94, 4: 77, 5: 45})
On pattern 4
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 250 samples in 0.003s...
[t-SNE] Computed neighbors for 250 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 250 / 250
[t-SNE] Mean sigma: 0.352296
[t-SNE] Computed conditional probabilities in 0.018s
[t-SNE] Iteration 50: error = 61.8627968, gradient norm = 0.5004901 (50 iterations in 2.124s)
[t-SNE] Iteration 100: error = 63.0671959, gradient norm = 0.5142650 (50 iterations in 2.161s)
[t-SNE] Iteration 150: error = 61.2464752, gradient norm = 0.5169473 (50 iterations in 2.130s)
[t-SNE] Iteration 200: error = 65.0153046, gradient norm = 0.4813415 (50 iterations in 2.126s)
[t-SNE] Iteration 250: error = 62.2760506, gradient norm = 0.5182359 (50 iterations in 2.121s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 62.276051
[t-SNE] Iteration 300: error = 1.0381913, gradient norm = 0.0042951 (50 iterations in 2.109s)
[t-SNE] Iteration 350: error = 0.9575992, gradient norm = 0.0027552 (50 iterations in 2.120s)
[t-SNE] Iteration 400: error = 0.9050851, gradient norm = 0.0027567 (50 iterations in 2.110s)
[t-SNE] Iteration 450: error = 0.8942695, gradient norm = 0.0003269 (50 iterations in 2.120s)
[t-SNE] Iteration 500: error = 0.8914315, gradient norm = 0.0006850 (50 iterations in 2.129s)
[t-SNE] Iteration 550: error = 0.8507524, gradient norm = 0.0013502 (50 iterations in 2.111s)
[t-SNE] Iteration 600: error = 0.8266639, gradient norm = 0.0011854 (50 iterations in 2.107s)
[t-SNE] Iteration 650: error = 0.8234898, gradient norm = 0.0002077 (50 iterations in 2.103s)
[t-SNE] Iteration 700: error = 0.8235044, gradient norm = 0.0001216 (50 iterations in 2.117s)
[t-SNE] Iteration 750: error = 0.8234474, gradient norm = 0.0000819 (50 iterations in 2.126s)
[t-SNE] Iteration 800: error = 0.8234901, gradient norm = 0.0001561 (50 iterations in 2.109s)
[t-SNE] Iteration 850: error = 0.8234577, gradient norm = 0.0000719 (50 iterations in 2.118s)
[t-SNE] Iteration 900: error = 0.8234705, gradient norm = 0.0000857 (50 iterations in 2.115s)
[t-SNE] Iteration 950: error = 0.8234993, gradient norm = 0.0000331 (50 iterations in 2.101s)
[t-SNE] Iteration 1000: error = 0.8234733, gradient norm = 0.0000564 (50 iterations in 2.095s)
[t-SNE] KL divergence after 1000 iterations: 0.823473
[t-SNE] Computed conditional probabilities for sample 250 / 250
[t-SNE] Mean sigma: 0.352296
Beginning preprocessing + Leiden
2024-03-16 17:54:00.905734 MEMORY 16.57065472
Affmat transformed
2024-03-16 17:54:00.909974 MEMORY 16.57065472
sources, targets, weights extracted
2024-03-16 17:54:00.911631 MEMORY 16.57065472
About to launch parallel Leiden runs
2024-03-16 17:54:00.916330 MEMORY 16.57065472
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.0s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.7s finished
Parallel Leiden runs finished
2024-03-16 17:54:03.632744 MEMORY 16.57065472
Quality: 0.34546571950083116
Quality: 0.3457544611629194
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 222 out of 222 | elapsed:    0.1s finished
Got subclusters: Counter({0: 62, 1: 57, 2: 50, 3: 42, 4: 35, 5: 2, 6: 2})
On pattern 5
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 222 samples in 0.002s...
[t-SNE] Computed neighbors for 222 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 222 / 222
[t-SNE] Mean sigma: 0.349484
[t-SNE] Computed conditional probabilities in 0.016s
[t-SNE] Iteration 50: error = 61.5211868, gradient norm = 0.5064521 (50 iterations in 2.071s)
[t-SNE] Iteration 100: error = 61.7728577, gradient norm = 0.5101773 (50 iterations in 2.089s)
[t-SNE] Iteration 150: error = 64.8358154, gradient norm = 0.4898359 (50 iterations in 2.101s)
[t-SNE] Iteration 200: error = 61.8424606, gradient norm = 0.5190895 (50 iterations in 2.104s)
[t-SNE] Iteration 250: error = 62.3065453, gradient norm = 0.5219848 (50 iterations in 2.094s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 62.306545
[t-SNE] Iteration 300: error = 1.0903603, gradient norm = 0.0056809 (50 iterations in 2.127s)
[t-SNE] Iteration 350: error = 0.8220989, gradient norm = 0.0036058 (50 iterations in 2.096s)
[t-SNE] Iteration 400: error = 0.7207157, gradient norm = 0.0044999 (50 iterations in 2.093s)
[t-SNE] Iteration 450: error = 0.6620420, gradient norm = 0.0009736 (50 iterations in 2.125s)
[t-SNE] Iteration 500: error = 0.6539491, gradient norm = 0.0006384 (50 iterations in 2.095s)
[t-SNE] Iteration 550: error = 0.6533291, gradient norm = 0.0002307 (50 iterations in 2.081s)
[t-SNE] Iteration 600: error = 0.6535418, gradient norm = 0.0001570 (50 iterations in 2.083s)
[t-SNE] Iteration 650: error = 0.6536277, gradient norm = 0.0002065 (50 iterations in 2.089s)
[t-SNE] Iteration 700: error = 0.6536110, gradient norm = 0.0001450 (50 iterations in 2.086s)
[t-SNE] Iteration 750: error = 0.6535175, gradient norm = 0.0001918 (50 iterations in 2.095s)
[t-SNE] Iteration 800: error = 0.6535644, gradient norm = 0.0001481 (50 iterations in 2.098s)
[t-SNE] Iteration 850: error = 0.6536616, gradient norm = 0.0001884 (50 iterations in 2.101s)
[t-SNE] Iteration 900: error = 0.6537395, gradient norm = 0.0001535 (50 iterations in 2.105s)
[t-SNE] Iteration 900: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 900 iterations: 0.653739
[t-SNE] Computed conditional probabilities for sample 222 / 222
[t-SNE] Mean sigma: 0.349485
Beginning preprocessing + Leiden
2024-03-16 17:54:41.773685 MEMORY 16.57065472
Affmat transformed
2024-03-16 17:54:41.778912 MEMORY 16.57065472
sources, targets, weights extracted
2024-03-16 17:54:41.780391 MEMORY 16.57065472
About to launch parallel Leiden runs
2024-03-16 17:54:41.784831 MEMORY 16.57065472
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.0s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.8s finished
Parallel Leiden runs finished
2024-03-16 17:54:44.568584 MEMORY 16.57065472
Quality: 0.3585890565597932
Quality: 0.3587494045892054
Quality: 0.3592571460622056
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 158 out of 158 | elapsed:    0.1s finished
Got subclusters: Counter({0: 70, 1: 68, 2: 49, 3: 35})
On pattern 6
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 158 samples in 0.002s...
[t-SNE] Computed neighbors for 158 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 158 / 158
[t-SNE] Mean sigma: 0.402670
[t-SNE] Computed conditional probabilities in 0.011s
[t-SNE] Iteration 50: error = 59.5044708, gradient norm = 0.4729560 (50 iterations in 2.093s)
[t-SNE] Iteration 100: error = 59.3208122, gradient norm = 0.4359795 (50 iterations in 2.082s)
[t-SNE] Iteration 150: error = 56.0138397, gradient norm = 0.5779462 (50 iterations in 2.094s)
[t-SNE] Iteration 200: error = 60.4802780, gradient norm = 0.5038114 (50 iterations in 2.075s)
[t-SNE] Iteration 250: error = 58.7675667, gradient norm = 0.5080343 (50 iterations in 2.092s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 58.767567
[t-SNE] Iteration 300: error = 0.7917563, gradient norm = 0.0092204 (50 iterations in 2.097s)
[t-SNE] Iteration 350: error = 0.4892368, gradient norm = 0.0057209 (50 iterations in 2.086s)
[t-SNE] Iteration 400: error = 0.4772219, gradient norm = 0.0007994 (50 iterations in 2.090s)
[t-SNE] Iteration 450: error = 0.4770939, gradient norm = 0.0002936 (50 iterations in 2.085s)
[t-SNE] Iteration 500: error = 0.4772485, gradient norm = 0.0004471 (50 iterations in 2.069s)
[t-SNE] Iteration 550: error = 0.4771318, gradient norm = 0.0003746 (50 iterations in 2.068s)
[t-SNE] Iteration 600: error = 0.4770323, gradient norm = 0.0003270 (50 iterations in 2.071s)
[t-SNE] Iteration 650: error = 0.4769521, gradient norm = 0.0003723 (50 iterations in 2.074s)
[t-SNE] Iteration 700: error = 0.4769911, gradient norm = 0.0003325 (50 iterations in 2.058s)
[t-SNE] Iteration 750: error = 0.4770392, gradient norm = 0.0004103 (50 iterations in 2.065s)
[t-SNE] Iteration 800: error = 0.4774406, gradient norm = 0.0003904 (50 iterations in 2.080s)
[t-SNE] Iteration 850: error = 0.4772298, gradient norm = 0.0004281 (50 iterations in 2.071s)
[t-SNE] Iteration 900: error = 0.4768738, gradient norm = 0.0004104 (50 iterations in 2.060s)
[t-SNE] Iteration 950: error = 0.4771217, gradient norm = 0.0004738 (50 iterations in 2.048s)
[t-SNE] Iteration 1000: error = 0.4769574, gradient norm = 0.0004001 (50 iterations in 2.052s)
[t-SNE] KL divergence after 1000 iterations: 0.476957
[t-SNE] Computed conditional probabilities for sample 158 / 158
[t-SNE] Mean sigma: 0.402670
Beginning preprocessing + Leiden
2024-03-16 17:55:26.377417 MEMORY 16.57065472
Affmat transformed
2024-03-16 17:55:26.381010 MEMORY 16.57065472
sources, targets, weights extracted
2024-03-16 17:55:26.382252 MEMORY 16.57065472
About to launch parallel Leiden runs
2024-03-16 17:55:26.392516 MEMORY 16.57065472
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.8s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.2s finished
Parallel Leiden runs finished
2024-03-16 17:55:28.557827 MEMORY 16.57065472
Quality: 0.31766462374093274
Quality: 0.31774401282714176
Quality: 0.31793262749611034
Quality: 0.3184944841287987
Quality: 0.3186096643102318
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  64 out of 111 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=24)]: Done 111 out of 111 | elapsed:    0.0s finished
Got subclusters: Counter({0: 57, 1: 38, 2: 30, 3: 29, 4: 4})
On pattern 7
[t-SNE] Computing 110 nearest neighbors...
[t-SNE] Indexed 111 samples in 0.001s...
[t-SNE] Computed neighbors for 111 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 111 / 111
[t-SNE] Mean sigma: 0.469654
[t-SNE] Computed conditional probabilities in 0.006s
[t-SNE] Iteration 50: error = 51.2836380, gradient norm = 0.5148191 (50 iterations in 2.035s)
[t-SNE] Iteration 100: error = 52.8606339, gradient norm = 0.5739010 (50 iterations in 2.047s)
[t-SNE] Iteration 150: error = 52.4071350, gradient norm = 0.5826306 (50 iterations in 2.060s)
[t-SNE] Iteration 200: error = 57.0617943, gradient norm = 0.4915373 (50 iterations in 2.053s)
[t-SNE] Iteration 250: error = 51.5018311, gradient norm = 0.5750418 (50 iterations in 2.051s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 51.501831
[t-SNE] Iteration 300: error = 0.6426996, gradient norm = 0.0155402 (50 iterations in 2.043s)
[t-SNE] Iteration 350: error = 0.3280346, gradient norm = 0.0030754 (50 iterations in 2.052s)
[t-SNE] Iteration 400: error = 0.3249274, gradient norm = 0.0006471 (50 iterations in 2.045s)
[t-SNE] Iteration 450: error = 0.3252935, gradient norm = 0.0005301 (50 iterations in 2.049s)
[t-SNE] Iteration 500: error = 0.3252468, gradient norm = 0.0003634 (50 iterations in 2.053s)
[t-SNE] Iteration 550: error = 0.3252525, gradient norm = 0.0001913 (50 iterations in 2.042s)
[t-SNE] Iteration 600: error = 0.3252567, gradient norm = 0.0002284 (50 iterations in 2.038s)
[t-SNE] Iteration 650: error = 0.3252496, gradient norm = 0.0002091 (50 iterations in 2.039s)
[t-SNE] Iteration 700: error = 0.3252458, gradient norm = 0.0003291 (50 iterations in 2.052s)
[t-SNE] Iteration 750: error = 0.3252553, gradient norm = 0.0004847 (50 iterations in 2.035s)
[t-SNE] Iteration 750: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 750 iterations: 0.325255
[t-SNE] Computed conditional probabilities for sample 111 / 111
[t-SNE] Mean sigma: 0.469654
Beginning preprocessing + Leiden
2024-03-16 17:55:59.449989 MEMORY 16.57065472
Affmat transformed
2024-03-16 17:55:59.451937 MEMORY 16.57065472
sources, targets, weights extracted
2024-03-16 17:55:59.452575 MEMORY 16.57065472
About to launch parallel Leiden runs
2024-03-16 17:55:59.458384 MEMORY 16.57065472
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.0s finished
Parallel Leiden runs finished
2024-03-16 17:56:01.438226 MEMORY 16.57065472
Quality: 0.25612546219447174
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done  30 out of  38 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=24)]: Done  38 out of  38 | elapsed:    0.0s finished
Got subclusters: Counter({0: 45, 1: 35, 2: 25, 3: 6})
On pattern 8
[t-SNE] Computing 37 nearest neighbors...
[t-SNE] Indexed 38 samples in 0.000s...
[t-SNE] Computed neighbors for 38 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 38 / 38
[t-SNE] Mean sigma: 8.219219
[t-SNE] Computed conditional probabilities in 0.001s
[t-SNE] Iteration 50: error = 45.1735344, gradient norm = 0.3916970 (50 iterations in 2.036s)
[t-SNE] Iteration 100: error = 44.2063293, gradient norm = 0.4005793 (50 iterations in 2.036s)
[t-SNE] Iteration 150: error = 49.1944389, gradient norm = 0.5627005 (50 iterations in 2.042s)
[t-SNE] Iteration 200: error = 43.1827698, gradient norm = 0.5433578 (50 iterations in 2.040s)
[t-SNE] Iteration 250: error = 42.5015068, gradient norm = 0.4041998 (50 iterations in 2.045s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 42.501507
[t-SNE] Iteration 300: error = 0.7060404, gradient norm = 0.0009434 (50 iterations in 2.034s)
[t-SNE] Iteration 350: error = 0.6233103, gradient norm = 0.0003758 (50 iterations in 2.034s)
[t-SNE] Iteration 400: error = 0.5571674, gradient norm = 0.0001188 (50 iterations in 2.033s)
[t-SNE] Iteration 450: error = 0.5535464, gradient norm = 0.0000546 (50 iterations in 2.033s)
[t-SNE] Iteration 500: error = 0.5532411, gradient norm = 0.0000293 (50 iterations in 2.032s)
[t-SNE] Iteration 550: error = 0.5529684, gradient norm = 0.0000196 (50 iterations in 2.039s)
[t-SNE] Iteration 600: error = 0.5528048, gradient norm = 0.0000207 (50 iterations in 2.047s)
[t-SNE] Iteration 650: error = 0.5526140, gradient norm = 0.0000211 (50 iterations in 2.044s)
[t-SNE] Iteration 700: error = 0.5526757, gradient norm = 0.0000185 (50 iterations in 2.032s)
[t-SNE] Iteration 750: error = 0.5526525, gradient norm = 0.0000182 (50 iterations in 2.031s)
[t-SNE] Iteration 800: error = 0.5526001, gradient norm = 0.0000197 (50 iterations in 2.040s)
[t-SNE] Iteration 850: error = 0.5524993, gradient norm = 0.0000229 (50 iterations in 2.041s)
[t-SNE] Iteration 900: error = 0.5522437, gradient norm = 0.0000373 (50 iterations in 2.031s)
[t-SNE] Iteration 950: error = 0.5512998, gradient norm = 0.0000867 (50 iterations in 2.029s)
[t-SNE] Iteration 1000: error = 0.5466753, gradient norm = 0.0005222 (50 iterations in 2.031s)
[t-SNE] KL divergence after 1000 iterations: 0.546675
[t-SNE] Computed conditional probabilities for sample 38 / 38
[t-SNE] Mean sigma: 1125899906842624.000000
Beginning preprocessing + Leiden
2024-03-16 17:56:42.245324 MEMORY 16.57065472
Affmat transformed
2024-03-16 17:56:42.246384 MEMORY 16.57065472
sources, targets, weights extracted
2024-03-16 17:56:42.246820 MEMORY 16.57065472
About to launch parallel Leiden runs
2024-03-16 17:56:42.252770 MEMORY 16.57065472
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.6s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.8s finished
Parallel Leiden runs finished
2024-03-16 17:56:44.010386 MEMORY 16.57065472
Quality: -1.4643841694806183e-13
Got subclusters: Counter({0: 38})
On metacluster 4
Metacluster size 6340
Relevant tasks:  ('testis',)
Relevant signs:  (1,)
TfModiscoSeqletsToPatternsFactory: seed=1234
(Round 1) num seqlets: 6340
(Round 1) Computing coarse affmat
2024-03-16 17:56:46.092110 MEMORY 16.569872384
Beginning embedding computation
MEMORY 16.569872384
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 152 tasks      | elapsed:    1.9s
[Parallel(n_jobs=24)]: Done 402 tasks      | elapsed:    4.8s
[Parallel(n_jobs=24)]: Done 752 tasks      | elapsed:    8.6s
[Parallel(n_jobs=24)]: Done 1202 tasks      | elapsed:   13.5s
[Parallel(n_jobs=24)]: Done 1752 tasks      | elapsed:   19.5s
[Parallel(n_jobs=24)]: Done 2402 tasks      | elapsed:   26.5s
[Parallel(n_jobs=24)]: Done 3152 tasks      | elapsed:   34.8s
[Parallel(n_jobs=24)]: Done 4002 tasks      | elapsed:   43.9s
[Parallel(n_jobs=24)]: Done 4952 tasks      | elapsed:   54.3s
[Parallel(n_jobs=24)]: Done 6002 tasks      | elapsed:  1.1min
[Parallel(n_jobs=24)]: Done 6340 out of 6340 | elapsed:  1.2min finished
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 152 tasks      | elapsed:    1.9s
[Parallel(n_jobs=24)]: Done 402 tasks      | elapsed:    4.6s
[Parallel(n_jobs=24)]: Done 752 tasks      | elapsed:    8.4s
[Parallel(n_jobs=24)]: Done 1202 tasks      | elapsed:   13.4s
[Parallel(n_jobs=24)]: Done 1752 tasks      | elapsed:   19.3s
[Parallel(n_jobs=24)]: Done 2402 tasks      | elapsed:   26.4s
[Parallel(n_jobs=24)]: Done 3152 tasks      | elapsed:   34.5s
[Parallel(n_jobs=24)]: Done 4002 tasks      | elapsed:   43.8s
[Parallel(n_jobs=24)]: Done 4952 tasks      | elapsed:   54.0s
[Parallel(n_jobs=24)]: Done 6002 tasks      | elapsed:  1.1min
[Parallel(n_jobs=24)]: Done 6340 out of 6340 | elapsed:  1.1min finished
At the beginning of embedding call
2024-03-16 17:56:46.092408 MEMORY 16.569872384
before computing embeddings fwd
2024-03-16 17:56:46.101230 MEMORY 16.569872384
after computing embeddings fwd
2024-03-16 17:57:55.370669 MEMORY 16.569872384
after computing embeddings rev
2024-03-16 17:59:04.352384 MEMORY 16.75218944
before computing sparse embeddings fwd
2024-03-16 17:59:04.352483 MEMORY 16.75218944
Constructing csr matrix...
csr matrix made in 0.8175561428070068 s
after computing sparse embeddings fwd
2024-03-16 17:59:05.527490 MEMORY 16.822706176
before computing sparse embeddings rev
2024-03-16 17:59:05.527574 MEMORY 16.822706176
Constructing csr matrix...
csr matrix made in 0.7134208679199219 s
after computing sparse embeddings rev
2024-03-16 17:59:06.503915 MEMORY 16.873385984
Finished embedding computation in 141.92 s
MEMORY 16.729772032
Starting affinity matrix computations
MEMORY 16.729247744
Batching in slices of size 6340
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:05<00:00,  5.16s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:05<00:00,  5.16s/it]
Finished affinity matrix computations in 5.19 s
MEMORY 16.729247744
(Round 1) Computed coarse affmat
2024-03-16 17:59:14.489206 MEMORY 16.577138688
(Round 1) Computing affinity matrix on nearest neighbors
2024-03-16 17:59:14.489384 MEMORY 16.577138688
Launching nearest neighbors affmat calculation job
MEMORY 16.577138688
Parallel runs completed
MEMORY 16.7257088
Job completed in: 21.22 s
MEMORY 16.726069248
Launching nearest neighbors affmat calculation job
MEMORY 16.724262912
Parallel runs completed
MEMORY 16.821039104
Job completed in: 20.46 s
MEMORY 16.821366784
(Round 1) Computed affinity matrix on nearest neighbors in 44.41 s
2024-03-16 17:59:58.907852 MEMORY 16.82192384
Filtered down to 6180 of 6340
(Round 1) Retained 6180 rows out of 6340 after filtering
2024-03-16 18:00:02.361192 MEMORY 16.82208768
(Round 1) Computing density adapted affmat
2024-03-16 18:00:05.634748 MEMORY 16.820875264
Symmetrizing nearest neighbors
Computing betas for density adaptation
Computing normalizing denominators
(Round 1) Computing clustering
2024-03-16 18:01:00.252273 MEMORY 16.852545536
Beginning preprocessing + Leiden
2024-03-16 18:01:00.261188 MEMORY 16.85256192
Affmat transformed
2024-03-16 18:01:00.261381 MEMORY 16.85256192
sources, targets, weights extracted
2024-03-16 18:01:00.477161 MEMORY 16.886444032
About to launch parallel Leiden runs
2024-03-16 18:01:00.533085 MEMORY 16.818839552
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:   34.3s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:  2.1min finished
Parallel Leiden runs finished
2024-03-16 18:03:06.632618 MEMORY 16.81688576
Quality: 0.2847087180785703
Quality: 0.28475118017396506
Quality: 0.28656303563911234
Quality: 0.2865712229510984
Quality: 0.28658007313239103
Got 6 clusters after round 1
Counts:
{5: 420, 1: 1609, 3: 808, 0: 1649, 4: 695, 2: 999}
2024-03-16 18:03:06.651101 MEMORY 16.783089664
(Round 1) Aggregating seqlets in each cluster
2024-03-16 18:03:06.651238 MEMORY 16.783089664
Aggregating for cluster 0 with 1649 seqlets
2024-03-16 18:03:06.656665 MEMORY 16.783314944
Skipped 2 due to duplicates
Trimming eliminated 0 seqlets out of 1647
Aggregating for cluster 1 with 1609 seqlets
2024-03-16 18:03:10.370192 MEMORY 16.783982592
Skipped 2 due to duplicates
Trimming eliminated 0 seqlets out of 1607
Aggregating for cluster 2 with 999 seqlets
2024-03-16 18:03:14.102665 MEMORY 16.783982592
Trimming eliminated 0 seqlets out of 999
Aggregating for cluster 3 with 808 seqlets
2024-03-16 18:03:18.796861 MEMORY 16.78405632
Skipped 4 due to duplicates
Trimming eliminated 0 seqlets out of 804
Aggregating for cluster 4 with 695 seqlets
2024-03-16 18:03:20.982059 MEMORY 16.78405632
Skipped 2 due to duplicates
Trimming eliminated 0 seqlets out of 693
Aggregating for cluster 5 with 420 seqlets
2024-03-16 18:03:22.893858 MEMORY 16.78405632
Trimming eliminated 0 seqlets out of 420
(Round 2) num seqlets: 6170
(Round 2) Computing coarse affmat
2024-03-16 18:03:25.990478 MEMORY 16.78405632
Beginning embedding computation
MEMORY 16.78405632
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 256 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done 1968 tasks      | elapsed:    2.8s
[Parallel(n_jobs=24)]: Done 4768 tasks      | elapsed:    6.1s
[Parallel(n_jobs=24)]: Done 6170 out of 6170 | elapsed:    8.0s finished
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 256 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done 936 tasks      | elapsed:    2.1s
[Parallel(n_jobs=24)]: Done 2336 tasks      | elapsed:    4.3s
[Parallel(n_jobs=24)]: Done 4136 tasks      | elapsed:    7.2s
[Parallel(n_jobs=24)]: Done 6170 out of 6170 | elapsed:   10.2s finished
At the beginning of embedding call
2024-03-16 18:03:25.990704 MEMORY 16.78405632
before computing embeddings fwd
2024-03-16 18:03:26.000107 MEMORY 16.784060416
after computing embeddings fwd
2024-03-16 18:03:33.962926 MEMORY 16.878030848
after computing embeddings rev
2024-03-16 18:03:44.208793 MEMORY 17.129934848
before computing sparse embeddings fwd
2024-03-16 18:03:44.208885 MEMORY 17.129934848
Constructing csr matrix...
csr matrix made in 0.8501095771789551 s
after computing sparse embeddings fwd
2024-03-16 18:03:45.442399 MEMORY 17.2920832
before computing sparse embeddings rev
2024-03-16 18:03:45.442526 MEMORY 17.2920832
Constructing csr matrix...
csr matrix made in 0.7036705017089844 s
after computing sparse embeddings rev
2024-03-16 18:03:46.408012 MEMORY 17.329860608
Finished embedding computation in 22.51 s
MEMORY 17.11980544
Starting affinity matrix computations
MEMORY 17.119543296
Batching in slices of size 6170
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:05<00:00,  5.98s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:05<00:00,  5.98s/it]
Finished affinity matrix computations in 6.03 s
MEMORY 17.119674368
(Round 2) Computed coarse affmat
2024-03-16 18:03:56.011993 MEMORY 16.919580672
(Round 2) Computing affinity matrix on nearest neighbors
2024-03-16 18:03:56.012136 MEMORY 16.919580672
Launching nearest neighbors affmat calculation job
MEMORY 16.919580672
Parallel runs completed
MEMORY 16.920129536
Job completed in: 11.33 s
MEMORY 16.919908352
Launching nearest neighbors affmat calculation job
MEMORY 16.919760896
Parallel runs completed
MEMORY 16.938614784
Job completed in: 11.41 s
MEMORY 16.9383936
(Round 2) Computed affinity matrix on nearest neighbors in 24.91 s
2024-03-16 18:04:20.924379 MEMORY 16.938319872
Not applying filtering for rounds above first round
2024-03-16 18:04:20.925365 MEMORY 16.938319872
(Round 2) Computing density adapted affmat
2024-03-16 18:04:23.289364 MEMORY 16.94304256
Symmetrizing nearest neighbors
Computing betas for density adaptation
Computing normalizing denominators
(Round 2) Computing clustering
2024-03-16 18:05:16.687969 MEMORY 17.053323264
Beginning preprocessing + Leiden
2024-03-16 18:05:16.697483 MEMORY 17.053323264
Affmat transformed
2024-03-16 18:05:16.697655 MEMORY 17.053323264
sources, targets, weights extracted
2024-03-16 18:05:16.908082 MEMORY 17.087021056
About to launch parallel Leiden runs
2024-03-16 18:05:16.966175 MEMORY 17.00292608
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:   23.9s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:  1.4min finished
Parallel Leiden runs finished
2024-03-16 18:06:42.645807 MEMORY 16.996069376
Quality: 0.3336663708309315
Quality: 0.3368849765400318
Quality: 0.33688571389169236
Quality: 0.3368874130669708
Quality: 0.3368876900058388
Quality: 0.33688817841679586
Got 6 clusters after round 2
Counts:
{1: 1338, 3: 893, 0: 1666, 4: 878, 2: 953, 5: 442}
2024-03-16 18:06:42.665191 MEMORY 16.962379776
(Round 2) Aggregating seqlets in each cluster
2024-03-16 18:06:42.665323 MEMORY 16.962379776
Aggregating for cluster 0 with 1666 seqlets
2024-03-16 18:06:42.669664 MEMORY 16.962379776
Skipped 2 due to duplicates
Trimming eliminated 0 seqlets out of 1664
Aggregating for cluster 1 with 1338 seqlets
2024-03-16 18:06:45.516479 MEMORY 16.962379776
Skipped 1 due to duplicates
Trimming eliminated 0 seqlets out of 1337
Aggregating for cluster 2 with 953 seqlets
2024-03-16 18:06:48.078235 MEMORY 16.962379776
Skipped 2 due to duplicates
Trimming eliminated 0 seqlets out of 951
Aggregating for cluster 3 with 893 seqlets
2024-03-16 18:06:49.617265 MEMORY 16.962379776
Skipped 2 due to duplicates
Trimming eliminated 0 seqlets out of 891
Aggregating for cluster 4 with 878 seqlets
2024-03-16 18:06:52.720598 MEMORY 16.962121728
Skipped 2 due to duplicates
Trimming eliminated 0 seqlets out of 876
Aggregating for cluster 5 with 442 seqlets
2024-03-16 18:06:54.210475 MEMORY 16.962121728
Trimming eliminated 0 seqlets out of 442
Got 6 clusters
Splitting into subclusters...
2024-03-16 18:06:55.039599 MEMORY 16.962121728
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 408 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 1664 out of 1664 | elapsed:    0.3s finished
Inspecting pattern 0 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 1664
[t-SNE] Computed conditional probabilities for sample 1664 / 1664
[t-SNE] Mean sigma: 0.327663
Beginning preprocessing + Leiden
2024-03-16 18:06:57.204077 MEMORY 16.962297856
Affmat transformed
2024-03-16 18:06:57.228432 MEMORY 16.96231424
sources, targets, weights extracted
2024-03-16 18:06:57.243802 MEMORY 16.96231424
About to launch parallel Leiden runs
2024-03-16 18:06:57.252270 MEMORY 16.96231424
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    5.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   19.0s finished
Parallel Leiden runs finished
2024-03-16 18:07:16.278696 MEMORY 16.962318336
Quality: 0.45680644766102285
Quality: 0.4574881562441047
Got subclusters: Counter({0: 277, 1: 274, 2: 216, 3: 209, 4: 202, 5: 197, 6: 150, 7: 139})
On merging iteration 1
Numbers for each pattern pre-subsample: [277, 274, 216, 209, 202, 197, 150, 139]
Numbers after subsampling: [277, 274, 216, 209, 202, 197, 150, 139]
Computing sims for pattern 0
Computed sims for pattern 0 in 2.0717687606811523 s
Computing sims for pattern 1
Computed sims for pattern 1 in 2.147400379180908 s
Computing sims for pattern 2
Computed sims for pattern 2 in 2.086249351501465 s
Computing sims for pattern 3
Computed sims for pattern 3 in 2.0956826210021973 s
Computing sims for pattern 4
Computed sims for pattern 4 in 1.9265387058258057 s
Computing sims for pattern 5
Computed sims for pattern 5 in 1.7887530326843262 s
Computing sims for pattern 6
Computed sims for pattern 6 in 1.2857060432434082 s
Computing sims for pattern 7
Computed sims for pattern 7 in 1.336707353591919 s
Cluster sizes
[277 274 216 209 202 197 150 139]
Cross-contamination matrix:
[[1.   0.61 0.79 0.76 0.67 0.75 0.59 0.76]
 [0.51 1.   0.71 0.71 0.66 0.45 0.57 0.71]
 [0.59 0.6  1.   0.64 0.49 0.63 0.67 0.69]
 [0.5  0.55 0.58 1.   0.49 0.75 0.44 0.7 ]
 [0.63 0.72 0.6  0.69 1.   0.75 0.43 0.68]
 [0.59 0.41 0.67 0.83 0.63 1.   0.45 0.68]
 [0.48 0.55 0.76 0.57 0.37 0.47 1.   0.62]
 [0.37 0.42 0.46 0.57 0.29 0.45 0.36 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.72 0.79 0.76 0.76 0.77 0.77 0.66]
 [0.72 1.   0.73 0.74 0.8  0.59 0.81 0.7 ]
 [0.79 0.73 1.   0.74 0.62 0.73 0.91 0.68]
 [0.76 0.74 0.74 1.   0.7  0.88 0.75 0.75]
 [0.76 0.8  0.62 0.7  1.   0.75 0.67 0.65]
 [0.77 0.59 0.73 0.88 0.75 1.   0.7  0.68]
 [0.77 0.81 0.91 0.75 0.67 0.7  1.   0.73]
 [0.66 0.7  0.68 0.75 0.65 0.68 0.73 1.  ]]
Collapsing 2 & 6 with crosscontam 0.6651544638774576 and sim 0.9073375622768237
Collapsing 3 & 5 with crosscontam 0.7532348023467108 and sim 0.8765110543904602
Trimming eliminated 0 seqlets out of 366
Skipped 1 due to duplicates
Trimming eliminated 0 seqlets out of 405
Unmerged patterns remapping: OrderedDict([(0, 2), (1, 3), (4, 4), (7, 5)])
Time spent on merging iteration: 2.656724691390991
On merging iteration 2
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 1290 tasks      | elapsed:    0.6s
[Parallel(n_jobs=24)]: Done 1337 out of 1337 | elapsed:    0.7s finished
Numbers for each pattern pre-subsample: [405, 366, 277, 274, 202, 139]
Numbers after subsampling: [300, 300, 277, 274, 202, 139]
Computing sims for pattern 0
Computed sims for pattern 0 in 1.8800616264343262 s
Computing sims for pattern 1
Computed sims for pattern 1 in 1.8513767719268799 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.6783096790313721 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.6557226181030273 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.5688662528991699 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.42226743698120117 s
Cluster sizes
[405 366 277 274 202 139]
Cross-contamination matrix:
[[1.   0.65 0.57 0.65 0.69 0.87]
 [0.68 1.   0.69 0.72 0.53 0.8 ]
 [0.65 0.72 1.   0.61 0.67 0.76]
 [0.61 0.64 0.51 1.   0.66 0.71]
 [0.67 0.51 0.63 0.72 1.   0.68]
 [0.52 0.44 0.37 0.42 0.29 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.72 0.7  0.67 0.72 0.81]
 [0.72 1.   0.79 0.77 0.63 0.69]
 [0.7  0.79 1.   0.72 0.76 0.66]
 [0.67 0.77 0.72 1.   0.8  0.7 ]
 [0.72 0.63 0.76 0.8  1.   0.65]
 [0.81 0.69 0.66 0.7  0.65 1.  ]]
Inspecting pattern 1 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 1337
[t-SNE] Computed conditional probabilities for sample 1337 / 1337
[t-SNE] Mean sigma: 0.338848
Beginning preprocessing + Leiden
2024-03-16 18:07:40.946852 MEMORY 16.96272384
Affmat transformed
2024-03-16 18:07:40.963515 MEMORY 16.96272384
sources, targets, weights extracted
2024-03-16 18:07:40.973698 MEMORY 16.96272384
About to launch parallel Leiden runs
2024-03-16 18:07:40.981577 MEMORY 16.96272384
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    4.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   16.9s finished
Parallel Leiden runs finished
2024-03-16 18:07:57.836192 MEMORY 16.96272384
Quality: 0.4226505926294103
Quality: 0.4240913912019009
Quality: 0.42432167997303066
Quality: 0.42481053725314816
Quality: 0.42551941422189504
Quality: 0.42680148653614325
Got subclusters: Counter({0: 320, 1: 302, 2: 236, 3: 176, 4: 135, 5: 103, 6: 65})
On merging iteration 1
Numbers for each pattern pre-subsample: [320, 302, 236, 176, 135, 103, 65]
Numbers after subsampling: [300, 300, 236, 176, 135, 103, 65]
Computing sims for pattern 0
Computed sims for pattern 0 in 1.9858598709106445 s
Computing sims for pattern 1
Computed sims for pattern 1 in 2.009556770324707 s
Computing sims for pattern 2
Computed sims for pattern 2 in 1.9331448078155518 s
Computing sims for pattern 3
Computed sims for pattern 3 in 1.3202593326568604 s
Computing sims for pattern 4
Computed sims for pattern 4 in 1.0517733097076416 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.7755658626556396 s
Computing sims for pattern 6
Computed sims for pattern 6 in 0.5326550006866455 s
Cluster sizes
[320 302 236 176 135 103  65]
Cross-contamination matrix:
[[1.   0.59 0.47 0.74 0.74 0.82 0.61]
 [0.6  1.   0.68 0.68 0.71 0.65 0.63]
 [0.61 0.72 1.   0.85 0.63 0.74 0.67]
 [0.61 0.54 0.66 1.   0.51 0.63 0.45]
 [0.74 0.7  0.59 0.64 1.   0.83 0.44]
 [0.59 0.44 0.46 0.55 0.61 1.   0.42]
 [0.58 0.59 0.59 0.54 0.41 0.61 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.7  0.61 0.71 0.69 0.76 0.75]
 [0.7  1.   0.88 0.75 0.81 0.68 0.83]
 [0.61 0.88 1.   0.81 0.67 0.63 0.78]
 [0.71 0.75 0.81 1.   0.6  0.63 0.69]
 [0.69 0.81 0.67 0.6  1.   0.87 0.63]
 [0.76 0.68 0.63 0.63 0.87 1.   0.65]
 [0.75 0.83 0.78 0.69 0.63 0.65 1.  ]]
Collapsing 1 & 2 with crosscontam 0.6775944902699309 and sim 0.8774288555299862
Collapsing 4 & 5 with crosscontam 0.6093104004256562 and sim 0.8717862222001573
Trimming eliminated 0 seqlets out of 538
Trimming eliminated 0 seqlets out of 238
Unmerged patterns remapping: OrderedDict([(0, 1), (3, 3), (6, 4)])
Time spent on merging iteration: 1.981874704360962
On merging iteration 2
Numbers for each pattern pre-subsample: [538, 320, 238, 176, 65]
Numbers after subsampling: [300, 300, 238, 176, 65]
Computing sims for pattern 0
Computed sims for pattern 0 in 1.3292396068572998 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.732189416885376 s
Computing sims for pattern 2
Computed sims for pattern 2 in 1.2716364860534668 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.4689059257507324 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.19800639152526855 s
Cluster sizes
[538 320 238 176  65]
Cross-contamination matrix:
[[1.   0.67 0.85 0.85 0.83]
 [0.54 1.   0.67 0.74 0.61]
 [0.78 0.79 1.   0.78 0.55]
 [0.53 0.61 0.53 1.   0.45]
 [0.54 0.58 0.4  0.54 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.67 0.88 0.76 0.81]
 [0.67 1.   0.7  0.71 0.75]
 [0.88 0.7  1.   0.66 0.64]
 [0.76 0.71 0.66 1.   0.69]
 [0.81 0.75 0.64 0.69 1.  ]]
Collapsing 0 & 2 with crosscontam 0.7782192481540318 and sim 0.8784556839488189
Skipped 1 due to duplicates
Trimming eliminated 0 seqlets out of 775
Unmerged patterns remapping: OrderedDict([(1, 1), (3, 2), (4, 3)])
Time spent on merging iteration: 1.4938807487487793
On merging iteration 3
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 951 out of 951 | elapsed:    2.2s finished
Numbers for each pattern pre-subsample: [775, 320, 176, 65]
Numbers after subsampling: [300, 300, 176, 65]
Computing sims for pattern 0
Computed sims for pattern 0 in 0.9908955097198486 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.39054226875305176 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.24300742149353027 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.10256648063659668 s
Cluster sizes
[775 320 176  65]
Cross-contamination matrix:
[[1.   0.8  0.89 0.79]
 [0.59 1.   0.74 0.61]
 [0.54 0.61 1.   0.45]
 [0.54 0.58 0.54 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.7  0.77 0.81]
 [0.7  1.   0.71 0.75]
 [0.77 0.71 1.   0.69]
 [0.81 0.75 0.69 1.  ]]
Inspecting pattern 2 for spurious merging
[t-SNE] Computed conditional probabilities for sample 951 / 951
[t-SNE] Mean sigma: 0.317766
Beginning preprocessing + Leiden
2024-03-16 18:08:19.674102 MEMORY 16.96272384
Affmat transformed
2024-03-16 18:08:19.685984 MEMORY 16.96272384
sources, targets, weights extracted
2024-03-16 18:08:19.694359 MEMORY 16.96272384
About to launch parallel Leiden runs
2024-03-16 18:08:19.702557 MEMORY 16.96272384
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    3.1s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   11.4s finished
Parallel Leiden runs finished
2024-03-16 18:08:31.124720 MEMORY 16.96272384
Quality: 0.38350336134288326
Quality: 0.38625061672109806
Quality: 0.3898456562707831
Got subclusters: Counter({0: 224, 1: 202, 2: 163, 3: 124, 4: 86, 5: 83, 6: 67, 7: 2})
On merging iteration 1
Numbers for each pattern pre-subsample: [224, 202, 163, 124, 86, 83, 67, 2]
Numbers after subsampling: [224, 202, 163, 124, 86, 83, 67, 2]
Computing sims for pattern 0
Computed sims for pattern 0 in 1.7484447956085205 s
Computing sims for pattern 1
Computed sims for pattern 1 in 1.5684709548950195 s
Computing sims for pattern 2
Computed sims for pattern 2 in 1.1640992164611816 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.9543132781982422 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.7032580375671387 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.6613404750823975 s
Computing sims for pattern 6
Computed sims for pattern 6 in 0.5543735027313232 s
Computing sims for pattern 7
Computed sims for pattern 7 in 0.1222541332244873 s
Cluster sizes
[224 202 163 124  86  83  67   2]
Cross-contamination matrix:
[[1.   0.68 0.69 0.56 0.58 0.66 0.68 0.35]
 [0.69 1.   0.78 0.72 0.71 0.62 0.81 0.53]
 [0.65 0.64 1.   0.61 0.46 0.6  0.74 0.42]
 [0.73 0.87 0.81 1.   0.67 0.7  0.85 0.7 ]
 [0.6  0.72 0.71 0.52 1.   0.54 0.67 0.53]
 [0.76 0.71 0.74 0.63 0.64 1.   0.85 0.7 ]
 [0.56 0.73 0.67 0.61 0.56 0.59 1.   0.36]
 [0.   0.   0.   0.   0.   0.   0.   1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.78 0.77 0.79 0.79 0.86 0.79 0.56]
 [0.78 1.   0.83 0.87 0.87 0.84 0.84 0.62]
 [0.77 0.83 1.   0.8  0.81 0.83 0.85 0.59]
 [0.79 0.87 0.8  1.   0.74 0.88 0.83 0.64]
 [0.79 0.87 0.81 0.74 1.   0.82 0.86 0.66]
 [0.86 0.84 0.83 0.88 0.82 1.   0.85 0.71]
 [0.79 0.84 0.85 0.83 0.86 0.85 1.   0.61]
 [0.56 0.62 0.59 0.64 0.66 0.71 0.61 1.  ]]
Collapsing 3 & 5 with crosscontam 0.6309601979577664 and sim 0.8786248568898872
Collapsing 1 & 3 with crosscontam 0.7154861000375994 and sim 0.870605665912596
Collapsing 1 & 4 with crosscontam 0.7137241593634085 and sim 0.8685781585086957
Collapsing 4 & 6 with crosscontam 0.5601862673453231 and sim 0.8613777383304995
Collapsing 0 & 5 with crosscontam 0.6600419063622383 and sim 0.8589464780948173
Collapsing 2 & 6 with crosscontam 0.671342531711117 and sim 0.8543972224435381
Collapsing 5 & 6 with crosscontam 0.5935466379504111 and sim 0.8525138659940645
Trimming eliminated 0 seqlets out of 207
Trimming eliminated 0 seqlets out of 409
Trimming eliminated 0 seqlets out of 495
Trimming eliminated 0 seqlets out of 562
Trimming eliminated 0 seqlets out of 786
Trimming eliminated 0 seqlets out of 949
Unmerged patterns remapping: OrderedDict([(7, 1)])
Time spent on merging iteration: 4.677790880203247
On merging iteration 2
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 891 out of 891 | elapsed:    0.4s finished
Numbers for each pattern pre-subsample: [949, 2]
Numbers after subsampling: [300, 2]
Computing sims for pattern 0
Computed sims for pattern 0 in 0.2524302005767822 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.02817082405090332 s
Cluster sizes
[949   2]
Cross-contamination matrix:
[[1.   0.66]
 [0.   1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.66]
 [0.66 1.  ]]
Inspecting pattern 3 for spurious merging
[t-SNE] Computed conditional probabilities for sample 891 / 891
[t-SNE] Mean sigma: 0.351792
Beginning preprocessing + Leiden
2024-03-16 18:08:45.066535 MEMORY 16.96272384
Affmat transformed
2024-03-16 18:08:45.078238 MEMORY 16.96272384
sources, targets, weights extracted
2024-03-16 18:08:45.084795 MEMORY 16.96272384
About to launch parallel Leiden runs
2024-03-16 18:08:45.091986 MEMORY 16.96272384
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    2.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    8.9s finished
Parallel Leiden runs finished
2024-03-16 18:08:53.947560 MEMORY 16.96272384
Quality: 0.4129467294206029
Quality: 0.41400428141335543
Quality: 0.4144774604931437
Quality: 0.4152695760482906
Got subclusters: Counter({0: 191, 1: 179, 2: 155, 3: 130, 4: 123, 5: 83, 6: 30})
On merging iteration 1
Numbers for each pattern pre-subsample: [191, 179, 155, 130, 123, 83, 30]
Numbers after subsampling: [191, 179, 155, 130, 123, 83, 30]
Computing sims for pattern 0
Computed sims for pattern 0 in 1.3075447082519531 s
Computing sims for pattern 1
Computed sims for pattern 1 in 1.1676583290100098 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.991884708404541 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.8869273662567139 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.8554255962371826 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.6155948638916016 s
Computing sims for pattern 6
Computed sims for pattern 6 in 0.27770519256591797 s
Cluster sizes
[191 179 155 130 123  83  30]
Cross-contamination matrix:
[[1.   0.7  0.55 0.62 0.55 0.71 0.65]
 [0.5  1.   0.43 0.54 0.49 0.63 0.49]
 [0.7  0.75 1.   0.71 0.75 0.72 0.51]
 [0.71 0.73 0.55 1.   0.6  0.67 0.43]
 [0.64 0.75 0.69 0.7  1.   0.75 0.48]
 [0.68 0.82 0.55 0.65 0.62 1.   0.57]
 [0.67 0.69 0.51 0.48 0.46 0.63 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.74 0.77 0.75 0.77 0.83 0.74]
 [0.74 1.   0.7  0.66 0.8  0.8  0.7 ]
 [0.77 0.7  1.   0.71 0.83 0.77 0.58]
 [0.75 0.66 0.71 1.   0.75 0.75 0.48]
 [0.77 0.8  0.83 0.75 1.   0.87 0.58]
 [0.83 0.8  0.77 0.75 0.87 1.   0.7 ]
 [0.74 0.7  0.58 0.48 0.58 0.7  1.  ]]
Collapsing 4 & 5 with crosscontam 0.6218859626803153 and sim 0.8653466421167761
Trimming eliminated 0 seqlets out of 206
Unmerged patterns remapping: OrderedDict([(0, 1), (1, 2), (2, 3), (3, 4), (6, 5)])
Time spent on merging iteration: 0.5998871326446533
On merging iteration 2
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 876 out of 876 | elapsed:    0.4s finished
Numbers for each pattern pre-subsample: [206, 191, 179, 155, 130, 30]
Numbers after subsampling: [206, 191, 179, 155, 130, 30]
Computing sims for pattern 0
Computed sims for pattern 0 in 1.2365131378173828 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.24078917503356934 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.21620845794677734 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.18403196334838867 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.17111849784851074 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.05480170249938965 s
Cluster sizes
[206 191 179 155 130  30]
Cross-contamination matrix:
[[1.   0.81 0.94 0.8  0.84 0.65]
 [0.59 1.   0.7  0.55 0.62 0.65]
 [0.45 0.5  1.   0.43 0.54 0.49]
 [0.73 0.7  0.75 1.   0.71 0.51]
 [0.62 0.71 0.73 0.55 1.   0.43]
 [0.51 0.67 0.69 0.51 0.48 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.82 0.8  0.84 0.77 0.64]
 [0.82 1.   0.74 0.77 0.75 0.74]
 [0.8  0.74 1.   0.7  0.66 0.7 ]
 [0.84 0.77 0.7  1.   0.71 0.58]
 [0.77 0.75 0.66 0.71 1.   0.48]
 [0.64 0.74 0.7  0.58 0.48 1.  ]]
Inspecting pattern 4 for spurious merging
[t-SNE] Computed conditional probabilities for sample 876 / 876
[t-SNE] Mean sigma: 0.363694
Beginning preprocessing + Leiden
2024-03-16 18:09:04.015547 MEMORY 16.96272384
Affmat transformed
2024-03-16 18:09:04.027136 MEMORY 16.96272384
sources, targets, weights extracted
2024-03-16 18:09:04.033628 MEMORY 16.96272384
About to launch parallel Leiden runs
2024-03-16 18:09:04.040413 MEMORY 16.96272384
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    2.5s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    8.2s finished
Parallel Leiden runs finished
2024-03-16 18:09:12.210146 MEMORY 16.96272384
Quality: 0.45463037381644655
Quality: 0.4555327922389441
Quality: 0.455758725728731
Quality: 0.45578596338001315
Quality: 0.4560303076442991
Got subclusters: Counter({0: 220, 1: 192, 2: 161, 3: 158, 4: 131, 5: 14})
On merging iteration 1
Numbers for each pattern pre-subsample: [220, 192, 161, 158, 131, 14]
Numbers after subsampling: [220, 192, 161, 158, 131, 14]
Computing sims for pattern 0
Computed sims for pattern 0 in 1.3527958393096924 s
Computing sims for pattern 1
Computed sims for pattern 1 in 1.0984761714935303 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.8846609592437744 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.862213134765625 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.7746334075927734 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.15486812591552734 s
Cluster sizes
[220 192 161 158 131  14]
Cross-contamination matrix:
[[1.   0.38 0.88 0.58 0.61 0.33]
 [0.65 1.   0.94 0.9  0.54 0.34]
 [0.28 0.18 1.   0.39 0.37 0.08]
 [0.51 0.64 0.88 1.   0.6  0.14]
 [0.54 0.41 0.94 0.73 1.   0.2 ]
 [0.75 0.62 0.77 0.55 0.53 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.7  0.75 0.69 0.68 0.42]
 [0.7  1.   0.79 0.88 0.74 0.43]
 [0.75 0.79 1.   0.87 0.8  0.42]
 [0.69 0.88 0.87 1.   0.81 0.36]
 [0.68 0.74 0.8  0.81 1.   0.38]
 [0.42 0.43 0.42 0.36 0.38 1.  ]]
Collapsing 1 & 3 with crosscontam 0.6370991210465433 and sim 0.8777907638177778
Trimming eliminated 0 seqlets out of 350
Unmerged patterns remapping: OrderedDict([(0, 1), (2, 2), (4, 3), (5, 4)])
Time spent on merging iteration: 0.7208652496337891
On merging iteration 2
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 344 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 442 out of 442 | elapsed:    0.2s finished
Numbers for each pattern pre-subsample: [350, 220, 161, 131, 14]
Numbers after subsampling: [300, 220, 161, 131, 14]
Computing sims for pattern 0
Computed sims for pattern 0 in 1.2894375324249268 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.30841970443725586 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.21259260177612305 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.1936795711517334 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.042172908782958984 s
Cluster sizes
[350 220 161 131  14]
Cross-contamination matrix:
[[1.   0.57 0.91 0.59 0.24]
 [0.42 1.   0.88 0.61 0.33]
 [0.25 0.28 1.   0.37 0.08]
 [0.5  0.54 0.94 1.   0.2 ]
 [0.61 0.75 0.77 0.53 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.58 0.77 0.6  0.3 ]
 [0.58 1.   0.75 0.68 0.42]
 [0.77 0.75 1.   0.8  0.42]
 [0.6  0.68 0.8  1.   0.38]
 [0.3  0.42 0.42 0.38 1.  ]]
Inspecting pattern 5 for spurious merging
[t-SNE] Computed conditional probabilities for sample 442 / 442
[t-SNE] Mean sigma: 0.442376
Beginning preprocessing + Leiden
2024-03-16 18:09:20.838724 MEMORY 16.96272384
Affmat transformed
2024-03-16 18:09:20.844736 MEMORY 16.96272384
sources, targets, weights extracted
2024-03-16 18:09:20.847385 MEMORY 16.96272384
About to launch parallel Leiden runs
2024-03-16 18:09:20.852237 MEMORY 16.96272384
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.5s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    4.3s finished
Parallel Leiden runs finished
2024-03-16 18:09:25.115684 MEMORY 16.96272384
Quality: 0.4265630131714573
Quality: 0.4272293122235457
Got subclusters: Counter({0: 115, 1: 113, 2: 83, 3: 79, 4: 35, 5: 17})
On merging iteration 1
Numbers for each pattern pre-subsample: [115, 113, 83, 79, 35, 17]
Numbers after subsampling: [115, 113, 83, 79, 35, 17]
Computing sims for pattern 0
Computed sims for pattern 0 in 0.5522041320800781 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.5243806838989258 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.4284543991088867 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.39454126358032227 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.19489264488220215 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.12216997146606445 s
Cluster sizes
[115 113  83  79  35  17]
Cross-contamination matrix:
[[1.   0.73 0.57 0.49 0.47 0.62]
 [0.91 1.   0.71 0.43 0.41 0.73]
 [0.49 0.45 1.   0.62 0.35 0.52]
 [0.42 0.26 0.65 1.   0.44 0.34]
 [0.46 0.3  0.41 0.4  1.   0.34]
 [0.57 0.54 0.55 0.4  0.26 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.83 0.58 0.57 0.5  0.65]
 [0.83 1.   0.66 0.51 0.32 0.62]
 [0.58 0.66 1.   0.66 0.32 0.65]
 [0.57 0.51 0.66 1.   0.23 0.6 ]
 [0.5  0.32 0.32 0.23 1.   0.33]
 [0.65 0.62 0.65 0.6  0.33 1.  ]]
Merging on 29 clusters
2024-03-16 18:09:27.437558 MEMORY 16.96272384
On merging iteration 1
Numbers for each pattern pre-subsample: [405, 366, 277, 274, 202, 139, 775, 320, 176, 65, 949, 2, 206, 191, 179, 155, 130, 30, 350, 220, 161, 131, 14, 115, 113, 83, 79, 35, 17]
Numbers after subsampling: [300, 300, 277, 274, 202, 139, 300, 300, 176, 65, 300, 2, 206, 191, 179, 155, 130, 30, 300, 220, 161, 131, 14, 115, 113, 83, 79, 35, 17]
Computing sims for pattern 0
Computed sims for pattern 0 in 9.048703670501709 s
Computing sims for pattern 1
Computed sims for pattern 1 in 10.891898393630981 s
Computing sims for pattern 2
Computed sims for pattern 2 in 8.046704053878784 s
Computing sims for pattern 3
Computed sims for pattern 3 in 8.146674156188965 s
Computing sims for pattern 4
Computed sims for pattern 4 in 6.869889736175537 s
Computing sims for pattern 5
Computed sims for pattern 5 in 4.776863098144531 s
Computing sims for pattern 6
Computed sims for pattern 6 in 9.19729995727539 s
Computing sims for pattern 7
Computed sims for pattern 7 in 9.20408821105957 s
Computing sims for pattern 8
Computed sims for pattern 8 in 5.562995195388794 s
Computing sims for pattern 9
Computed sims for pattern 9 in 2.339186429977417 s
Computing sims for pattern 10
Computed sims for pattern 10 in 9.184629917144775 s
Computing sims for pattern 11
Computed sims for pattern 11 in 0.5334055423736572 s
Computing sims for pattern 12
Computed sims for pattern 12 in 6.818068027496338 s
Computing sims for pattern 13
Computed sims for pattern 13 in 7.911817312240601 s
Computing sims for pattern 14
Computed sims for pattern 14 in 5.798348665237427 s
Computing sims for pattern 15
Computed sims for pattern 15 in 4.7860846519470215 s
Computing sims for pattern 16
Computed sims for pattern 16 in 4.4039506912231445 s
Computing sims for pattern 17
Computed sims for pattern 17 in 1.3488237857818604 s
Computing sims for pattern 18
Computed sims for pattern 18 in 9.027479648590088 s
Computing sims for pattern 19
Computed sims for pattern 19 in 7.606320858001709 s
Computing sims for pattern 20
Computed sims for pattern 20 in 4.930034637451172 s
Computing sims for pattern 21
Computed sims for pattern 21 in 4.450598955154419 s
Computing sims for pattern 22
Computed sims for pattern 22 in 0.8141434192657471 s
Computing sims for pattern 23
Computed sims for pattern 23 in 3.773559808731079 s
Computing sims for pattern 24
Computed sims for pattern 24 in 3.758849859237671 s
Computing sims for pattern 25
Computed sims for pattern 25 in 2.8869316577911377 s
Computing sims for pattern 26
Computed sims for pattern 26 in 2.761462450027466 s
Computing sims for pattern 27
Computed sims for pattern 27 in 1.4236185550689697 s
Computing sims for pattern 28
Computed sims for pattern 28 in 0.9265604019165039 s
Cluster sizes
[405 366 277 274 202 139 775 320 176  65 949   2 206 191 179 155 130  30
 350 220 161 131  14 115 113  83  79  35  17]
Cross-contamination matrix:
[[1.   0.65 0.57 0.65 0.69 0.87 0.35 0.66 0.47 0.44 0.67 0.6  0.54 0.34
  0.73 0.4  0.46 0.33 0.2  0.14 0.15 0.27 0.14 0.24 0.14 0.2  0.07 0.08
  0.12]
 [0.68 1.   0.69 0.72 0.53 0.8  0.6  0.73 0.56 0.66 0.61 1.   0.32 0.24
  0.48 0.39 0.23 0.26 0.21 0.09 0.15 0.29 0.13 0.27 0.18 0.1  0.04 0.07
  0.13]
 [0.65 0.72 1.   0.61 0.67 0.76 0.43 0.51 0.57 0.45 0.5  0.49 0.44 0.28
  0.6  0.51 0.41 0.27 0.21 0.09 0.2  0.37 0.09 0.36 0.28 0.19 0.05 0.05
  0.18]
 [0.61 0.64 0.51 1.   0.66 0.71 0.46 0.52 0.37 0.44 0.39 0.47 0.36 0.27
  0.3  0.35 0.34 0.15 0.2  0.1  0.15 0.35 0.15 0.24 0.17 0.07 0.03 0.04
  0.1 ]
 [0.67 0.51 0.63 0.72 1.   0.68 0.29 0.45 0.2  0.28 0.38 0.65 0.5  0.29
  0.53 0.39 0.38 0.29 0.19 0.13 0.19 0.36 0.13 0.26 0.14 0.12 0.03 0.05
  0.11]
 [0.52 0.44 0.37 0.42 0.29 1.   0.21 0.38 0.25 0.23 0.31 0.26 0.2  0.1
  0.2  0.13 0.16 0.06 0.05 0.04 0.04 0.13 0.03 0.1  0.11 0.04 0.01 0.01
  0.03]
 [0.55 0.84 0.67 0.81 0.53 0.69 1.   0.8  0.89 0.79 0.7  0.75 0.46 0.39
  0.44 0.5  0.41 0.35 0.32 0.32 0.31 0.45 0.24 0.38 0.3  0.15 0.05 0.14
  0.16]
 [0.73 0.74 0.54 0.62 0.53 0.79 0.59 1.   0.74 0.61 0.69 0.45 0.4  0.2
  0.52 0.31 0.41 0.38 0.2  0.23 0.2  0.32 0.1  0.26 0.23 0.1  0.05 0.07
  0.1 ]
 [0.41 0.44 0.47 0.35 0.16 0.39 0.54 0.61 1.   0.45 0.41 0.25 0.21 0.11
  0.23 0.23 0.19 0.23 0.13 0.17 0.13 0.14 0.05 0.19 0.18 0.08 0.04 0.06
  0.08]
 [0.46 0.68 0.5  0.54 0.29 0.54 0.54 0.58 0.54 1.   0.45 0.53 0.22 0.19
  0.34 0.26 0.13 0.33 0.14 0.17 0.16 0.27 0.09 0.2  0.15 0.04 0.02 0.04
  0.15]
 [0.73 0.63 0.52 0.5  0.52 0.66 0.5  0.68 0.52 0.48 1.   0.66 0.49 0.28
  0.64 0.39 0.41 0.54 0.13 0.16 0.17 0.37 0.16 0.33 0.24 0.12 0.04 0.08
  0.17]
 [0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   1.   0.   0.
  0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.
  0.  ]
 [0.75 0.5  0.65 0.63 0.75 0.7  0.43 0.53 0.42 0.39 0.62 0.52 1.   0.81
  0.94 0.8  0.84 0.65 0.4  0.39 0.47 0.55 0.22 0.24 0.2  0.14 0.03 0.11
  0.13]
 [0.33 0.25 0.29 0.35 0.33 0.33 0.24 0.17 0.16 0.22 0.26 0.16 0.59 1.
  0.7  0.55 0.62 0.65 0.39 0.29 0.38 0.47 0.23 0.1  0.1  0.06 0.01 0.04
  0.07]
 [0.56 0.33 0.41 0.28 0.41 0.44 0.18 0.32 0.27 0.23 0.42 0.28 0.45 0.5
  1.   0.43 0.54 0.49 0.16 0.14 0.27 0.44 0.08 0.11 0.08 0.08 0.02 0.03
  0.04]
 [0.5  0.5  0.62 0.6  0.55 0.54 0.47 0.41 0.38 0.44 0.44 0.33 0.73 0.7
  0.75 1.   0.71 0.51 0.22 0.2  0.2  0.41 0.16 0.3  0.26 0.07 0.03 0.05
  0.19]
 [0.45 0.26 0.42 0.42 0.43 0.44 0.2  0.38 0.26 0.21 0.36 0.22 0.62 0.71
  0.73 0.55 1.   0.43 0.44 0.24 0.38 0.34 0.17 0.16 0.16 0.12 0.02 0.06
  0.06]
 [0.38 0.34 0.35 0.26 0.37 0.3  0.29 0.41 0.36 0.37 0.54 0.4  0.51 0.67
  0.69 0.51 0.48 1.   0.22 0.26 0.27 0.31 0.51 0.2  0.22 0.06 0.02 0.05
  0.1 ]
 [0.4  0.45 0.44 0.49 0.46 0.4  0.39 0.36 0.34 0.45 0.27 0.36 0.52 0.69
  0.49 0.37 0.76 0.3  1.   0.57 0.91 0.59 0.24 0.19 0.17 0.37 0.11 0.31
  0.34]
 [0.21 0.15 0.18 0.22 0.25 0.22 0.23 0.28 0.29 0.26 0.22 0.19 0.37 0.41
  0.35 0.2  0.35 0.3  0.42 1.   0.88 0.61 0.33 0.22 0.16 0.1  0.04 0.2
  0.12]
 [0.05 0.05 0.07 0.09 0.08 0.06 0.04 0.06 0.04 0.04 0.03 0.02 0.11 0.16
  0.15 0.04 0.14 0.06 0.25 0.28 1.   0.37 0.08 0.06 0.02 0.03 0.01 0.05
  0.01]
 [0.55 0.48 0.55 0.62 0.61 0.62 0.31 0.44 0.33 0.4  0.54 0.63 0.59 0.65
  0.82 0.51 0.46 0.39 0.5  0.54 0.94 1.   0.2  0.34 0.22 0.14 0.06 0.17
  0.16]
 [0.65 0.67 0.6  0.79 0.73 0.71 0.65 0.58 0.55 0.61 0.65 0.67 0.66 0.77
  0.7  0.63 0.71 0.87 0.61 0.75 0.77 0.53 1.   0.53 0.6  0.48 0.45 0.51
  0.55]
 [0.46 0.55 0.68 0.54 0.56 0.58 0.45 0.44 0.48 0.41 0.55 0.49 0.29 0.25
  0.29 0.45 0.3  0.34 0.22 0.29 0.32 0.36 0.24 1.   0.73 0.57 0.49 0.47
  0.62]
 [0.41 0.55 0.75 0.59 0.54 0.74 0.5  0.59 0.59 0.43 0.59 0.68 0.45 0.39
  0.4  0.57 0.51 0.48 0.28 0.38 0.35 0.41 0.38 0.91 1.   0.71 0.43 0.41
  0.73]
 [0.34 0.17 0.33 0.16 0.27 0.25 0.1  0.17 0.21 0.09 0.14 0.09 0.18 0.13
  0.24 0.11 0.19 0.07 0.26 0.11 0.19 0.14 0.13 0.49 0.45 1.   0.62 0.35
  0.52]
 [0.12 0.1  0.15 0.11 0.09 0.14 0.05 0.07 0.12 0.07 0.06 0.09 0.04 0.03
  0.05 0.02 0.04 0.04 0.09 0.04 0.08 0.05 0.07 0.42 0.26 0.65 1.   0.44
  0.34]
 [0.21 0.22 0.2  0.18 0.24 0.2  0.23 0.23 0.28 0.14 0.26 0.72 0.22 0.15
  0.19 0.14 0.19 0.18 0.32 0.35 0.36 0.24 0.16 0.46 0.3  0.41 0.4  1.
  0.34]
 [0.27 0.28 0.33 0.28 0.27 0.3  0.23 0.22 0.25 0.32 0.35 0.28 0.19 0.18
  0.17 0.17 0.17 0.21 0.34 0.17 0.12 0.17 0.29 0.57 0.54 0.55 0.4  0.26
  1.  ]]
Pattern-to-pattern sim matrix:
[[ 1.    0.72  0.7   0.67  0.72  0.81  0.54  0.79  0.56  0.6   0.84  0.64
   0.79  0.54  0.86  0.59  0.6   0.58  0.41  0.28  0.36  0.59  0.22  0.37
   0.26  0.3   0.02  0.26  0.16]
 [ 0.72  1.    0.79  0.77  0.63  0.69  0.86  0.85  0.69  0.85  0.79  0.74
   0.63  0.54  0.65  0.65  0.48  0.54  0.55  0.3   0.39  0.6   0.44  0.43
   0.31  0.1  -0.06  0.35  0.18]
 [ 0.7   0.79  1.    0.72  0.76  0.66  0.74  0.66  0.66  0.66  0.72  0.64
   0.77  0.62  0.7   0.75  0.63  0.5   0.56  0.36  0.47  0.72  0.4   0.56
   0.46  0.42  0.17  0.38  0.24]
 [ 0.67  0.77  0.72  1.    0.8   0.7   0.78  0.59  0.51  0.67  0.66  0.56
   0.68  0.53  0.5   0.63  0.64  0.4   0.61  0.37  0.44  0.71  0.51  0.38
   0.29  0.19  0.03  0.35  0.14]
 [ 0.72  0.63  0.76  0.8   1.    0.65  0.62  0.65  0.45  0.47  0.61  0.64
   0.81  0.62  0.67  0.69  0.62  0.56  0.55  0.36  0.43  0.69  0.43  0.4
   0.28  0.28 -0.03  0.39  0.15]
 [ 0.81  0.69  0.66  0.7   0.65  1.    0.63  0.72  0.56  0.63  0.72  0.55
   0.72  0.53  0.62  0.58  0.66  0.4   0.45  0.22  0.35  0.65  0.34  0.39
   0.44  0.17  0.04  0.29  0.16]
 [ 0.54  0.86  0.74  0.78  0.62  0.63  1.    0.7   0.77  0.81  0.72  0.55
   0.69  0.55  0.5   0.69  0.46  0.46  0.53  0.47  0.5   0.64  0.44  0.53
   0.47  0.   -0.07  0.43  0.19]
 [ 0.79  0.85  0.66  0.59  0.65  0.72  0.7   1.    0.71  0.75  0.82  0.56
   0.66  0.43  0.67  0.52  0.51  0.62  0.44  0.41  0.4   0.66  0.3   0.37
   0.29  0.12 -0.09  0.4   0.18]
 [ 0.56  0.69  0.66  0.51  0.45  0.56  0.77  0.71  1.    0.69  0.62  0.41
   0.53  0.32  0.52  0.48  0.33  0.48  0.32  0.38  0.36  0.5   0.24  0.4
   0.4   0.18  0.08  0.3   0.16]
 [ 0.6   0.85  0.66  0.67  0.47  0.63  0.81  0.75  0.69  1.    0.7   0.49
   0.49  0.4   0.51  0.5   0.34  0.51  0.47  0.4   0.36  0.51  0.37  0.42
   0.28  0.06 -0.03  0.25  0.32]
 [ 0.84  0.79  0.72  0.66  0.61  0.72  0.72  0.82  0.62  0.7   1.    0.66
   0.72  0.51  0.76  0.62  0.55  0.7   0.33  0.39  0.41  0.61  0.43  0.5
   0.44  0.1  -0.    0.4   0.25]
 [ 0.64  0.74  0.64  0.56  0.64  0.55  0.55  0.56  0.41  0.49  0.66  1.
   0.54  0.41  0.49  0.45  0.39  0.51  0.26  0.38  0.31  0.53  0.46  0.5
   0.3   0.05  0.    0.54  0.21]
 [ 0.79  0.63  0.77  0.68  0.81  0.72  0.69  0.66  0.53  0.49  0.72  0.54
   1.    0.82  0.8   0.84  0.77  0.64  0.6   0.53  0.53  0.67  0.39  0.39
   0.28  0.13 -0.16  0.47  0.21]
 [ 0.54  0.54  0.62  0.53  0.62  0.53  0.55  0.43  0.32  0.4   0.51  0.41
   0.82  1.    0.74  0.77  0.75  0.74  0.61  0.45  0.51  0.56  0.59  0.28
   0.19  0.08 -0.17  0.32  0.11]
 [ 0.86  0.65  0.7   0.5   0.67  0.62  0.5   0.67  0.52  0.51  0.76  0.49
   0.8   0.74  1.    0.7   0.66  0.7   0.43  0.37  0.49  0.71  0.38  0.29
   0.15  0.19 -0.12  0.27  0.1 ]
 [ 0.59  0.65  0.75  0.63  0.69  0.58  0.69  0.52  0.48  0.5   0.62  0.45
   0.84  0.77  0.7   1.    0.71  0.58  0.39  0.41  0.38  0.56  0.43  0.41
   0.31  0.03 -0.14  0.35  0.18]
 [ 0.6   0.48  0.63  0.64  0.62  0.66  0.46  0.51  0.33  0.34  0.55  0.39
   0.77  0.75  0.66  0.71  1.    0.48  0.74  0.48  0.6   0.49  0.4   0.38
   0.2   0.15 -0.16  0.24  0.15]
 [ 0.58  0.54  0.5   0.4   0.56  0.4   0.46  0.62  0.48  0.51  0.7   0.51
   0.64  0.74  0.7   0.58  0.48  1.    0.32  0.32  0.35  0.49  0.7   0.27
   0.28  0.04  0.02  0.26  0.1 ]
 [ 0.41  0.55  0.56  0.61  0.55  0.45  0.53  0.44  0.32  0.47  0.33  0.26
   0.6   0.61  0.43  0.39  0.74  0.32  1.    0.58  0.77  0.6   0.3   0.26
   0.2   0.26 -0.04  0.39  0.18]
 [ 0.28  0.3   0.36  0.37  0.36  0.22  0.47  0.41  0.38  0.4   0.39  0.38
   0.53  0.45  0.37  0.41  0.48  0.32  0.58  1.    0.75  0.68  0.42  0.34
   0.19  0.02 -0.14  0.51  0.09]
 [ 0.36  0.39  0.47  0.44  0.43  0.35  0.5   0.4   0.36  0.36  0.41  0.31
   0.53  0.51  0.49  0.38  0.6   0.35  0.77  0.75  1.    0.8   0.42  0.42
   0.21  0.07 -0.02  0.39  0.04]
 [ 0.59  0.6   0.72  0.71  0.69  0.65  0.64  0.66  0.5   0.51  0.61  0.53
   0.67  0.56  0.71  0.56  0.49  0.49  0.6   0.68  0.8   1.    0.38  0.58
   0.24  0.05 -0.05  0.42  0.14]
 [ 0.22  0.44  0.4   0.51  0.43  0.34  0.44  0.3   0.24  0.37  0.43  0.46
   0.39  0.59  0.38  0.43  0.4   0.7   0.3   0.42  0.42  0.38  1.    0.24
   0.21  0.11  0.09  0.14  0.25]
 [ 0.37  0.43  0.56  0.38  0.4   0.39  0.53  0.37  0.4   0.42  0.5   0.5
   0.39  0.28  0.29  0.41  0.38  0.27  0.26  0.34  0.42  0.58  0.24  1.
   0.83  0.58  0.57  0.5   0.65]
 [ 0.26  0.31  0.46  0.29  0.28  0.44  0.47  0.29  0.4   0.28  0.44  0.3
   0.28  0.19  0.15  0.31  0.2   0.28  0.2   0.19  0.21  0.24  0.21  0.83
   1.    0.66  0.51  0.32  0.62]
 [ 0.3   0.1   0.42  0.19  0.28  0.17  0.    0.12  0.18  0.06  0.1   0.05
   0.13  0.08  0.19  0.03  0.15  0.04  0.26  0.02  0.07  0.05  0.11  0.58
   0.66  1.    0.66  0.32  0.65]
 [ 0.02 -0.06  0.17  0.03 -0.03  0.04 -0.07 -0.09  0.08 -0.03 -0.    0.
  -0.16 -0.17 -0.12 -0.14 -0.16  0.02 -0.04 -0.14 -0.02 -0.05  0.09  0.57
   0.51  0.66  1.    0.23  0.6 ]
 [ 0.26  0.35  0.38  0.35  0.39  0.29  0.43  0.4   0.3   0.25  0.4   0.54
   0.47  0.32  0.27  0.35  0.24  0.26  0.39  0.51  0.39  0.42  0.14  0.5
   0.32  0.32  0.23  1.    0.33]
 [ 0.16  0.18  0.24  0.14  0.15  0.16  0.19  0.18  0.16  0.32  0.25  0.21
   0.21  0.11  0.1   0.18  0.15  0.1   0.18  0.09  0.04  0.14  0.25  0.65
   0.62  0.65  0.6   0.33  1.  ]]
Collapsing 0 & 14 with crosscontam 0.5586012125874338 and sim 0.8567371983588286
Collapsing 1 & 6 with crosscontam 0.5988567901234567 and sim 0.8557488415144588
Collapsing 1 & 7 with crosscontam 0.7343800582716047 and sim 0.8531820894545633
Trimming eliminated 0 seqlets out of 584
Trimming eliminated 0 seqlets out of 1141
Trimming eliminated 0 seqlets out of 1461
Unmerged patterns remapping: OrderedDict([(2, 4), (3, 5), (4, 8), (5, 13), (8, 10), (9, 20), (10, 1), (11, 25), (12, 7), (13, 9), (15, 12), (16, 15), (17, 22), (18, 3), (19, 6), (20, 11), (21, 14), (22, 24), (23, 16), (24, 17), (25, 18), (26, 19), (27, 21), (28, 23)])
Time spent on merging iteration: 7.485246181488037
On merging iteration 2
Numbers for each pattern pre-subsample: [1461, 949, 584, 350, 277, 274, 220, 206, 202, 191, 176, 161, 155, 139, 131, 130, 115, 113, 83, 79, 65, 35, 30, 17, 14, 2]
Numbers after subsampling: [300, 300, 300, 300, 277, 274, 220, 206, 202, 191, 176, 161, 155, 139, 131, 130, 115, 113, 83, 79, 65, 35, 30, 17, 14, 2]
Computing sims for pattern 0
Computed sims for pattern 0 in 7.819951057434082 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.7531564235687256 s
Computing sims for pattern 2
Computed sims for pattern 2 in 7.8791093826293945 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.76552414894104 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.6638374328613281 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.6335172653198242 s
Computing sims for pattern 6
Computed sims for pattern 6 in 0.6258358955383301 s
Computing sims for pattern 7
Computed sims for pattern 7 in 0.5960884094238281 s
Computing sims for pattern 8
Computed sims for pattern 8 in 0.5742518901824951 s
Computing sims for pattern 9
Computed sims for pattern 9 in 0.5259613990783691 s
Computing sims for pattern 10
Computed sims for pattern 10 in 0.47719311714172363 s
Computing sims for pattern 11
Computed sims for pattern 11 in 0.41536664962768555 s
Computing sims for pattern 12
Computed sims for pattern 12 in 0.4022254943847656 s
Computing sims for pattern 13
Computed sims for pattern 13 in 0.402360200881958 s
Computing sims for pattern 14
Computed sims for pattern 14 in 0.37441158294677734 s
Computing sims for pattern 15
Computed sims for pattern 15 in 0.3805267810821533 s
Computing sims for pattern 16
Computed sims for pattern 16 in 0.32256269454956055 s
Computing sims for pattern 17
Computed sims for pattern 17 in 0.3294665813446045 s
Computing sims for pattern 18
Computed sims for pattern 18 in 0.2598598003387451 s
Computing sims for pattern 19
Computed sims for pattern 19 in 0.24389362335205078 s
Computing sims for pattern 20
Computed sims for pattern 20 in 0.21178627014160156 s
Computing sims for pattern 21
Computed sims for pattern 21 in 0.13398194313049316 s
Computing sims for pattern 22
Computed sims for pattern 22 in 0.12624597549438477 s
Computing sims for pattern 23
Computed sims for pattern 23 in 0.09231233596801758 s
Computing sims for pattern 24
Computed sims for pattern 24 in 0.08401012420654297 s
Computing sims for pattern 25
Computed sims for pattern 25 in 0.0568852424621582 s
Cluster sizes
[1461  949  584  350  277  274  220  206  202  191  176  161  155  139
  131  130  115  113   83   79   65   35   30   17   14    2]
Cross-contamination matrix:
[[1.   0.85 0.7  0.41 0.84 0.93 0.41 0.55 0.69 0.45 0.96 0.42 0.61 0.93
  0.59 0.42 0.46 0.37 0.17 0.08 0.93 0.19 0.5  0.23 0.35 0.96]
 [0.53 1.   0.7  0.13 0.52 0.5  0.16 0.49 0.52 0.28 0.52 0.17 0.39 0.66
  0.37 0.41 0.33 0.24 0.12 0.04 0.48 0.08 0.54 0.17 0.16 0.66]
 [0.49 0.78 1.   0.26 0.72 0.7  0.2  0.68 0.76 0.46 0.54 0.27 0.51 0.89
  0.45 0.6  0.27 0.18 0.24 0.08 0.52 0.1  0.49 0.15 0.19 0.71]
 [0.38 0.27 0.41 1.   0.44 0.49 0.57 0.52 0.46 0.69 0.34 0.91 0.37 0.4
  0.59 0.76 0.19 0.17 0.37 0.11 0.45 0.31 0.3  0.34 0.24 0.36]
 [0.5  0.5  0.59 0.21 1.   0.61 0.09 0.44 0.67 0.28 0.57 0.2  0.51 0.76
  0.37 0.41 0.36 0.28 0.19 0.05 0.45 0.05 0.27 0.18 0.09 0.49]
 [0.48 0.39 0.52 0.2  0.51 1.   0.1  0.36 0.66 0.27 0.37 0.15 0.35 0.71
  0.35 0.34 0.24 0.17 0.07 0.03 0.44 0.04 0.15 0.1  0.15 0.47]
 [0.21 0.22 0.21 0.42 0.18 0.22 1.   0.37 0.25 0.41 0.29 0.88 0.2  0.22
  0.61 0.35 0.22 0.16 0.1  0.04 0.26 0.2  0.3  0.12 0.33 0.19]
 [0.45 0.62 0.77 0.4  0.65 0.63 0.39 1.   0.75 0.81 0.42 0.47 0.8  0.7
  0.55 0.84 0.24 0.2  0.14 0.03 0.39 0.11 0.65 0.13 0.22 0.52]
 [0.35 0.38 0.6  0.19 0.63 0.72 0.13 0.5  1.   0.29 0.2  0.19 0.39 0.68
  0.36 0.38 0.26 0.14 0.12 0.03 0.28 0.05 0.29 0.11 0.13 0.65]
 [0.23 0.26 0.35 0.39 0.29 0.35 0.29 0.59 0.33 1.   0.16 0.38 0.55 0.33
  0.47 0.62 0.1  0.1  0.06 0.01 0.22 0.04 0.65 0.07 0.23 0.16]
 [0.51 0.41 0.36 0.13 0.47 0.35 0.17 0.21 0.16 0.11 1.   0.13 0.23 0.39
  0.14 0.19 0.19 0.18 0.08 0.04 0.45 0.06 0.23 0.08 0.05 0.25]
 [0.04 0.03 0.06 0.25 0.07 0.09 0.28 0.11 0.08 0.16 0.04 1.   0.04 0.06
  0.37 0.14 0.06 0.02 0.03 0.01 0.04 0.05 0.06 0.01 0.08 0.02]
 [0.47 0.44 0.51 0.22 0.62 0.6  0.2  0.73 0.55 0.7  0.38 0.2  1.   0.54
  0.41 0.71 0.3  0.26 0.07 0.03 0.44 0.05 0.51 0.19 0.16 0.33]
 [0.27 0.31 0.42 0.05 0.37 0.42 0.04 0.2  0.29 0.1  0.25 0.04 0.13 1.
  0.13 0.16 0.1  0.11 0.04 0.01 0.23 0.01 0.06 0.03 0.03 0.26]
 [0.35 0.54 0.57 0.5  0.55 0.62 0.54 0.59 0.61 0.65 0.33 0.94 0.51 0.62
  1.   0.46 0.34 0.22 0.14 0.06 0.4  0.17 0.39 0.16 0.2  0.63]
 [0.22 0.36 0.46 0.44 0.42 0.42 0.24 0.62 0.43 0.71 0.26 0.38 0.55 0.44
  0.34 1.   0.16 0.16 0.12 0.02 0.21 0.06 0.43 0.06 0.17 0.22]
 [0.48 0.55 0.42 0.22 0.68 0.54 0.29 0.29 0.56 0.25 0.48 0.32 0.45 0.58
  0.36 0.3  1.   0.73 0.57 0.49 0.41 0.47 0.34 0.62 0.24 0.49]
 [0.53 0.59 0.41 0.28 0.75 0.59 0.38 0.45 0.54 0.39 0.59 0.35 0.57 0.74
  0.41 0.51 0.91 1.   0.71 0.43 0.43 0.41 0.48 0.73 0.38 0.68]
 [0.13 0.14 0.29 0.26 0.33 0.16 0.11 0.18 0.27 0.13 0.21 0.19 0.11 0.25
  0.14 0.19 0.49 0.45 1.   0.62 0.09 0.35 0.07 0.52 0.13 0.09]
 [0.05 0.06 0.1  0.09 0.15 0.11 0.04 0.04 0.09 0.03 0.12 0.08 0.02 0.14
  0.05 0.04 0.42 0.26 0.65 1.   0.07 0.44 0.04 0.34 0.07 0.09]
 [0.53 0.45 0.42 0.14 0.5  0.54 0.17 0.22 0.29 0.19 0.54 0.16 0.26 0.54
  0.27 0.13 0.2  0.15 0.04 0.02 1.   0.04 0.33 0.15 0.09 0.53]
 [0.22 0.26 0.21 0.32 0.2  0.18 0.35 0.22 0.24 0.15 0.28 0.36 0.14 0.2
  0.24 0.19 0.46 0.3  0.41 0.4  0.14 1.   0.18 0.34 0.16 0.72]
 [0.29 0.54 0.44 0.22 0.35 0.26 0.26 0.51 0.37 0.67 0.36 0.27 0.51 0.3
  0.31 0.48 0.2  0.22 0.06 0.02 0.37 0.05 1.   0.1  0.51 0.4 ]
 [0.19 0.35 0.25 0.34 0.33 0.28 0.17 0.19 0.27 0.18 0.25 0.12 0.17 0.3
  0.17 0.17 0.57 0.54 0.55 0.4  0.32 0.26 0.21 1.   0.29 0.28]
 [0.63 0.65 0.66 0.61 0.6  0.79 0.75 0.66 0.73 0.77 0.55 0.77 0.63 0.71
  0.53 0.71 0.53 0.6  0.48 0.45 0.61 0.51 0.87 0.55 1.   0.67]
 [0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.
  0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   1.  ]]
Pattern-to-pattern sim matrix:
[[ 1.    0.78  0.62  0.5   0.78  0.8   0.43  0.7   0.65  0.56  0.78  0.44
   0.71  0.68  0.66  0.48  0.47  0.42 -0.04 -0.07  0.84  0.43  0.49  0.2
   0.45  0.64]
 [ 0.78  1.    0.86  0.33  0.72  0.66  0.39  0.72  0.61  0.51  0.62  0.41
   0.62  0.72  0.61  0.55  0.5   0.44  0.1  -0.    0.7   0.4   0.7   0.25
   0.43  0.66]
 [ 0.62  0.86  1.    0.44  0.69  0.67  0.26  0.82  0.72  0.56  0.54  0.31
   0.6   0.73  0.59  0.71  0.3   0.22  0.27 -0.01  0.58  0.28  0.63  0.12
   0.24  0.56]
 [ 0.5   0.33  0.44  1.    0.56  0.61  0.58  0.6   0.55  0.61  0.32  0.77
   0.39  0.45  0.6   0.74  0.26  0.2   0.26 -0.04  0.47  0.39  0.32  0.18
   0.3   0.26]
 [ 0.78  0.72  0.69  0.56  1.    0.72  0.36  0.77  0.76  0.62  0.66  0.47
   0.75  0.66  0.72  0.63  0.56  0.46  0.42  0.17  0.66  0.38  0.5   0.24
   0.4   0.64]
 [ 0.8   0.66  0.67  0.61  0.72  1.    0.37  0.68  0.8   0.53  0.51  0.44
   0.63  0.7   0.71  0.64  0.38  0.29  0.19  0.03  0.67  0.35  0.4   0.14
   0.51  0.56]
 [ 0.43  0.39  0.26  0.58  0.36  0.37  1.    0.53  0.36  0.45  0.38  0.75
   0.41  0.22  0.68  0.48  0.34  0.19  0.02 -0.14  0.4   0.51  0.32  0.09
   0.42  0.38]
 [ 0.7   0.72  0.82  0.6   0.77  0.68  0.53  1.    0.81  0.82  0.53  0.53
   0.84  0.72  0.67  0.77  0.39  0.28  0.13 -0.16  0.49  0.47  0.64  0.21
   0.39  0.54]
 [ 0.65  0.61  0.72  0.55  0.76  0.8   0.36  0.81  1.    0.62  0.45  0.43
   0.69  0.65  0.69  0.62  0.4   0.28  0.28 -0.03  0.47  0.39  0.56  0.15
   0.43  0.64]
 [ 0.56  0.51  0.56  0.61  0.62  0.53  0.45  0.82  0.62  1.    0.32  0.51
   0.77  0.53  0.56  0.75  0.28  0.19  0.08 -0.17  0.4   0.32  0.74  0.11
   0.59  0.41]
 [ 0.78  0.62  0.54  0.32  0.66  0.51  0.38  0.53  0.45  0.32  1.    0.36
   0.48  0.56  0.5   0.33  0.4   0.4   0.18  0.08  0.69  0.3   0.48  0.16
   0.24  0.41]
 [ 0.44  0.41  0.31  0.77  0.47  0.44  0.75  0.53  0.43  0.51  0.36  1.
   0.38  0.35  0.8   0.6   0.42  0.21  0.07 -0.02  0.36  0.39  0.35  0.04
   0.42  0.31]
 [ 0.71  0.62  0.6   0.39  0.75  0.63  0.41  0.84  0.69  0.77  0.48  0.38
   1.    0.58  0.56  0.71  0.41  0.31  0.03 -0.14  0.5   0.35  0.58  0.18
   0.43  0.45]
 [ 0.68  0.72  0.73  0.45  0.66  0.7   0.22  0.72  0.65  0.53  0.56  0.35
   0.58  1.    0.65  0.66  0.39  0.44  0.17  0.04  0.63  0.29  0.4   0.16
   0.34  0.55]
 [ 0.66  0.61  0.59  0.6   0.72  0.71  0.68  0.67  0.69  0.56  0.5   0.8
   0.56  0.65  1.    0.49  0.58  0.24  0.05 -0.05  0.51  0.42  0.49  0.14
   0.38  0.53]
 [ 0.48  0.55  0.71  0.74  0.63  0.64  0.48  0.77  0.62  0.75  0.33  0.6
   0.71  0.66  0.49  1.    0.38  0.2   0.15 -0.16  0.34  0.24  0.48  0.15
   0.4   0.39]
 [ 0.47  0.5   0.3   0.26  0.56  0.38  0.34  0.39  0.4   0.28  0.4   0.42
   0.41  0.39  0.58  0.38  1.    0.83  0.58  0.57  0.42  0.5   0.27  0.65
   0.24  0.5 ]
 [ 0.42  0.44  0.22  0.2   0.46  0.29  0.19  0.28  0.28  0.19  0.4   0.21
   0.31  0.44  0.24  0.2   0.83  1.    0.66  0.51  0.28  0.32  0.28  0.62
   0.21  0.3 ]
 [-0.04  0.1   0.27  0.26  0.42  0.19  0.02  0.13  0.28  0.08  0.18  0.07
   0.03  0.17  0.05  0.15  0.58  0.66  1.    0.66  0.06  0.32  0.04  0.65
   0.11  0.05]
 [-0.07 -0.   -0.01 -0.04  0.17  0.03 -0.14 -0.16 -0.03 -0.17  0.08 -0.02
  -0.14  0.04 -0.05 -0.16  0.57  0.51  0.66  1.   -0.03  0.23  0.02  0.6
   0.09  0.  ]
 [ 0.84  0.7   0.58  0.47  0.66  0.67  0.4   0.49  0.47  0.4   0.69  0.36
   0.5   0.63  0.51  0.34  0.42  0.28  0.06 -0.03  1.    0.25  0.51  0.32
   0.37  0.49]
 [ 0.43  0.4   0.28  0.39  0.38  0.35  0.51  0.47  0.39  0.32  0.3   0.39
   0.35  0.29  0.42  0.24  0.5   0.32  0.32  0.23  0.25  1.    0.26  0.33
   0.14  0.54]
 [ 0.49  0.7   0.63  0.32  0.5   0.4   0.32  0.64  0.56  0.74  0.48  0.35
   0.58  0.4   0.49  0.48  0.27  0.28  0.04  0.02  0.51  0.26  1.    0.1
   0.7   0.51]
 [ 0.2   0.25  0.12  0.18  0.24  0.14  0.09  0.21  0.15  0.11  0.16  0.04
   0.18  0.16  0.14  0.15  0.65  0.62  0.65  0.6   0.32  0.33  0.1   1.
   0.25  0.21]
 [ 0.45  0.43  0.24  0.3   0.4   0.51  0.42  0.39  0.43  0.59  0.24  0.42
   0.43  0.34  0.38  0.4   0.24  0.21  0.11  0.09  0.37  0.14  0.7   0.25
   1.    0.46]
 [ 0.64  0.66  0.56  0.26  0.64  0.56  0.38  0.54  0.64  0.41  0.41  0.31
   0.45  0.55  0.53  0.39  0.5   0.3   0.05  0.    0.49  0.54  0.51  0.21
   0.46  1.  ]]
Collapsing 1 & 2 with crosscontam 0.7018609014814814 and sim 0.8570403347416721
Skipped 2 due to duplicates
Trimming eliminated 0 seqlets out of 1531
Unmerged patterns remapping: OrderedDict([(0, 1), (3, 2), (4, 3), (5, 4), (6, 5), (7, 6), (8, 7), (9, 8), (10, 9), (11, 10), (12, 11), (13, 12), (14, 13), (15, 14), (16, 15), (17, 16), (18, 17), (19, 18), (20, 19), (21, 20), (22, 21), (23, 22), (24, 23), (25, 24)])
Time spent on merging iteration: 2.6701886653900146
On merging iteration 3
Numbers for each pattern pre-subsample: [1531, 1461, 350, 277, 274, 220, 206, 202, 191, 176, 161, 155, 139, 131, 130, 115, 113, 83, 79, 65, 35, 30, 17, 14, 2]
Numbers after subsampling: [300, 300, 300, 277, 274, 220, 206, 202, 191, 176, 161, 155, 139, 131, 130, 115, 113, 83, 79, 65, 35, 30, 17, 14, 2]
Computing sims for pattern 0
Computed sims for pattern 0 in 7.634079456329346 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.3872561454772949 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.37416696548461914 s
Computing sims for pattern 3
Computed sims for pattern 3 in 1.9464187622070312 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.32326626777648926 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.31493282318115234 s
Computing sims for pattern 6
Computed sims for pattern 6 in 0.2944514751434326 s
Computing sims for pattern 7
Computed sims for pattern 7 in 0.28331971168518066 s
Computing sims for pattern 8
Computed sims for pattern 8 in 0.2699575424194336 s
Computing sims for pattern 9
Computed sims for pattern 9 in 0.2461864948272705 s
Computing sims for pattern 10
Computed sims for pattern 10 in 0.22046470642089844 s
Computing sims for pattern 11
Computed sims for pattern 11 in 0.20772337913513184 s
Computing sims for pattern 12
Computed sims for pattern 12 in 0.21039843559265137 s
Computing sims for pattern 13
Computed sims for pattern 13 in 0.19011616706848145 s
Computing sims for pattern 14
Computed sims for pattern 14 in 0.19250988960266113 s
Computing sims for pattern 15
Computed sims for pattern 15 in 0.1636676788330078 s
Computing sims for pattern 16
Computed sims for pattern 16 in 0.16338276863098145 s
Computing sims for pattern 17
Computed sims for pattern 17 in 0.13451457023620605 s
Computing sims for pattern 18
Computed sims for pattern 18 in 0.12010884284973145 s
Computing sims for pattern 19
Computed sims for pattern 19 in 0.10413050651550293 s
Computing sims for pattern 20
Computed sims for pattern 20 in 0.07030487060546875 s
Computing sims for pattern 21
Computed sims for pattern 21 in 0.06146240234375 s
Computing sims for pattern 22
Computed sims for pattern 22 in 0.04740309715270996 s
Computing sims for pattern 23
Computed sims for pattern 23 in 0.04132699966430664 s
Computing sims for pattern 24
Computed sims for pattern 24 in 0.02889871597290039 s
Cluster sizes
[1531 1461  350  277  274  220  206  202  191  176  161  155  139  131
  130  115  113   83   79   65   35   30   17   14    2]
Cross-contamination matrix:
[[1.   0.66 0.22 0.72 0.71 0.22 0.65 0.74 0.39 0.66 0.25 0.54 0.89 0.52
  0.59 0.38 0.29 0.15 0.05 0.64 0.12 0.65 0.21 0.22 1.  ]
 [0.8  1.   0.41 0.84 0.93 0.41 0.55 0.69 0.45 0.96 0.42 0.61 0.93 0.59
  0.42 0.46 0.37 0.17 0.08 0.93 0.19 0.5  0.23 0.35 0.96]
 [0.3  0.38 1.   0.44 0.49 0.57 0.52 0.46 0.69 0.34 0.91 0.37 0.4  0.59
  0.76 0.19 0.17 0.37 0.11 0.45 0.31 0.3  0.34 0.24 0.36]
 [0.54 0.5  0.21 1.   0.61 0.09 0.44 0.67 0.28 0.57 0.2  0.51 0.76 0.37
  0.41 0.36 0.28 0.19 0.05 0.45 0.05 0.27 0.18 0.09 0.49]
 [0.42 0.48 0.2  0.51 1.   0.1  0.36 0.66 0.27 0.37 0.15 0.35 0.71 0.35
  0.34 0.24 0.17 0.07 0.03 0.44 0.04 0.15 0.1  0.15 0.47]
 [0.2  0.21 0.42 0.18 0.22 1.   0.37 0.25 0.41 0.29 0.88 0.2  0.22 0.61
  0.35 0.22 0.16 0.1  0.04 0.26 0.2  0.3  0.12 0.33 0.19]
 [0.64 0.45 0.4  0.65 0.63 0.39 1.   0.75 0.81 0.42 0.47 0.8  0.7  0.55
  0.84 0.24 0.2  0.14 0.03 0.39 0.11 0.65 0.13 0.22 0.52]
 [0.51 0.35 0.19 0.63 0.72 0.13 0.5  1.   0.29 0.2  0.19 0.39 0.68 0.36
  0.38 0.26 0.14 0.12 0.03 0.28 0.05 0.29 0.11 0.13 0.65]
 [0.28 0.23 0.39 0.29 0.35 0.29 0.59 0.33 1.   0.16 0.38 0.55 0.33 0.47
  0.62 0.1  0.1  0.06 0.01 0.22 0.04 0.65 0.07 0.23 0.16]
 [0.38 0.51 0.13 0.47 0.35 0.17 0.21 0.16 0.11 1.   0.13 0.23 0.39 0.14
  0.19 0.19 0.18 0.08 0.04 0.45 0.06 0.23 0.08 0.05 0.25]
 [0.04 0.04 0.25 0.07 0.09 0.28 0.11 0.08 0.16 0.04 1.   0.04 0.06 0.37
  0.14 0.06 0.02 0.03 0.01 0.04 0.05 0.06 0.01 0.08 0.02]
 [0.45 0.47 0.22 0.62 0.6  0.2  0.73 0.55 0.7  0.38 0.2  1.   0.54 0.41
  0.71 0.3  0.26 0.07 0.03 0.44 0.05 0.51 0.19 0.16 0.33]
 [0.33 0.27 0.05 0.37 0.42 0.04 0.2  0.29 0.1  0.25 0.04 0.13 1.   0.13
  0.16 0.1  0.11 0.04 0.01 0.23 0.01 0.06 0.03 0.03 0.26]
 [0.56 0.35 0.5  0.55 0.62 0.54 0.59 0.61 0.65 0.33 0.94 0.51 0.62 1.
  0.46 0.34 0.22 0.14 0.06 0.4  0.17 0.39 0.16 0.2  0.63]
 [0.38 0.22 0.44 0.42 0.42 0.24 0.62 0.43 0.71 0.26 0.38 0.55 0.44 0.34
  1.   0.16 0.16 0.12 0.02 0.21 0.06 0.43 0.06 0.17 0.22]
 [0.5  0.48 0.22 0.68 0.54 0.29 0.29 0.56 0.25 0.48 0.32 0.45 0.58 0.36
  0.3  1.   0.73 0.57 0.49 0.41 0.47 0.34 0.62 0.24 0.49]
 [0.54 0.53 0.28 0.75 0.59 0.38 0.45 0.54 0.39 0.59 0.35 0.57 0.74 0.41
  0.51 0.91 1.   0.71 0.43 0.43 0.41 0.48 0.73 0.38 0.68]
 [0.15 0.13 0.26 0.33 0.16 0.11 0.18 0.27 0.13 0.21 0.19 0.11 0.25 0.14
  0.19 0.49 0.45 1.   0.62 0.09 0.35 0.07 0.52 0.13 0.09]
 [0.05 0.05 0.09 0.15 0.11 0.04 0.04 0.09 0.03 0.12 0.08 0.02 0.14 0.05
  0.04 0.42 0.26 0.65 1.   0.07 0.44 0.04 0.34 0.07 0.09]
 [0.43 0.53 0.14 0.5  0.54 0.17 0.22 0.29 0.19 0.54 0.16 0.26 0.54 0.27
  0.13 0.2  0.15 0.04 0.02 1.   0.04 0.33 0.15 0.09 0.53]
 [0.24 0.22 0.32 0.2  0.18 0.35 0.22 0.24 0.15 0.28 0.36 0.14 0.2  0.24
  0.19 0.46 0.3  0.41 0.4  0.14 1.   0.18 0.34 0.16 0.72]
 [0.5  0.29 0.22 0.35 0.26 0.26 0.51 0.37 0.67 0.36 0.27 0.51 0.3  0.31
  0.48 0.2  0.22 0.06 0.02 0.37 0.05 1.   0.1  0.51 0.4 ]
 [0.29 0.19 0.34 0.33 0.28 0.17 0.19 0.27 0.18 0.25 0.12 0.17 0.3  0.17
  0.17 0.57 0.54 0.55 0.4  0.32 0.26 0.21 1.   0.29 0.28]
 [0.63 0.63 0.61 0.6  0.79 0.75 0.66 0.73 0.77 0.55 0.77 0.63 0.71 0.53
  0.71 0.53 0.6  0.48 0.45 0.61 0.51 0.87 0.55 1.   0.67]
 [0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.
  0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   1.  ]]
Pattern-to-pattern sim matrix:
[[ 1.    0.78  0.35  0.75  0.69  0.33  0.74  0.67  0.52  0.62  0.35  0.63
   0.72  0.63  0.65  0.42  0.37  0.06 -0.09  0.7   0.39  0.71  0.19  0.39
   0.66]
 [ 0.78  1.    0.5   0.78  0.8   0.43  0.7   0.65  0.56  0.78  0.44  0.71
   0.68  0.66  0.48  0.47  0.42 -0.04 -0.07  0.84  0.43  0.49  0.2   0.45
   0.64]
 [ 0.35  0.5   1.    0.56  0.61  0.58  0.6   0.55  0.61  0.32  0.77  0.39
   0.45  0.6   0.74  0.26  0.2   0.26 -0.04  0.47  0.39  0.32  0.18  0.3
   0.26]
 [ 0.75  0.78  0.56  1.    0.72  0.36  0.77  0.76  0.62  0.66  0.47  0.75
   0.66  0.72  0.63  0.56  0.46  0.42  0.17  0.66  0.38  0.5   0.24  0.4
   0.64]
 [ 0.69  0.8   0.61  0.72  1.    0.37  0.68  0.8   0.53  0.51  0.44  0.63
   0.7   0.71  0.64  0.38  0.29  0.19  0.03  0.67  0.35  0.4   0.14  0.51
   0.56]
 [ 0.33  0.43  0.58  0.36  0.37  1.    0.53  0.36  0.45  0.38  0.75  0.41
   0.22  0.68  0.48  0.34  0.19  0.02 -0.14  0.4   0.51  0.32  0.09  0.42
   0.38]
 [ 0.74  0.7   0.6   0.77  0.68  0.53  1.    0.81  0.82  0.53  0.53  0.84
   0.72  0.67  0.77  0.39  0.28  0.13 -0.16  0.49  0.47  0.64  0.21  0.39
   0.54]
 [ 0.67  0.65  0.55  0.76  0.8   0.36  0.81  1.    0.62  0.45  0.43  0.69
   0.65  0.69  0.62  0.4   0.28  0.28 -0.03  0.47  0.39  0.56  0.15  0.43
   0.64]
 [ 0.52  0.56  0.61  0.62  0.53  0.45  0.82  0.62  1.    0.32  0.51  0.77
   0.53  0.56  0.75  0.28  0.19  0.08 -0.17  0.4   0.32  0.74  0.11  0.59
   0.41]
 [ 0.62  0.78  0.32  0.66  0.51  0.38  0.53  0.45  0.32  1.    0.36  0.48
   0.56  0.5   0.33  0.4   0.4   0.18  0.08  0.69  0.3   0.48  0.16  0.24
   0.41]
 [ 0.35  0.44  0.77  0.47  0.44  0.75  0.53  0.43  0.51  0.36  1.    0.38
   0.35  0.8   0.6   0.42  0.21  0.07 -0.02  0.36  0.39  0.35  0.04  0.42
   0.31]
 [ 0.63  0.71  0.39  0.75  0.63  0.41  0.84  0.69  0.77  0.48  0.38  1.
   0.58  0.56  0.71  0.41  0.31  0.03 -0.14  0.5   0.35  0.58  0.18  0.43
   0.45]
 [ 0.72  0.68  0.45  0.66  0.7   0.22  0.72  0.65  0.53  0.56  0.35  0.58
   1.    0.65  0.66  0.39  0.44  0.17  0.04  0.63  0.29  0.4   0.16  0.34
   0.55]
 [ 0.63  0.66  0.6   0.72  0.71  0.68  0.67  0.69  0.56  0.5   0.8   0.56
   0.65  1.    0.49  0.58  0.24  0.05 -0.05  0.51  0.42  0.49  0.14  0.38
   0.53]
 [ 0.65  0.48  0.74  0.63  0.64  0.48  0.77  0.62  0.75  0.33  0.6   0.71
   0.66  0.49  1.    0.38  0.2   0.15 -0.16  0.34  0.24  0.48  0.15  0.4
   0.39]
 [ 0.42  0.47  0.26  0.56  0.38  0.34  0.39  0.4   0.28  0.4   0.42  0.41
   0.39  0.58  0.38  1.    0.83  0.58  0.57  0.42  0.5   0.27  0.65  0.24
   0.5 ]
 [ 0.37  0.42  0.2   0.46  0.29  0.19  0.28  0.28  0.19  0.4   0.21  0.31
   0.44  0.24  0.2   0.83  1.    0.66  0.51  0.28  0.32  0.28  0.62  0.21
   0.3 ]
 [ 0.06 -0.04  0.26  0.42  0.19  0.02  0.13  0.28  0.08  0.18  0.07  0.03
   0.17  0.05  0.15  0.58  0.66  1.    0.66  0.06  0.32  0.04  0.65  0.11
   0.05]
 [-0.09 -0.07 -0.04  0.17  0.03 -0.14 -0.16 -0.03 -0.17  0.08 -0.02 -0.14
   0.04 -0.05 -0.16  0.57  0.51  0.66  1.   -0.03  0.23  0.02  0.6   0.09
   0.  ]
 [ 0.7   0.84  0.47  0.66  0.67  0.4   0.49  0.47  0.4   0.69  0.36  0.5
   0.63  0.51  0.34  0.42  0.28  0.06 -0.03  1.    0.25  0.51  0.32  0.37
   0.49]
 [ 0.39  0.43  0.39  0.38  0.35  0.51  0.47  0.39  0.32  0.3   0.39  0.35
   0.29  0.42  0.24  0.5   0.32  0.32  0.23  0.25  1.    0.26  0.33  0.14
   0.54]
 [ 0.71  0.49  0.32  0.5   0.4   0.32  0.64  0.56  0.74  0.48  0.35  0.58
   0.4   0.49  0.48  0.27  0.28  0.04  0.02  0.51  0.26  1.    0.1   0.7
   0.51]
 [ 0.19  0.2   0.18  0.24  0.14  0.09  0.21  0.15  0.11  0.16  0.04  0.18
   0.16  0.14  0.15  0.65  0.62  0.65  0.6   0.32  0.33  0.1   1.    0.25
   0.21]
 [ 0.39  0.45  0.3   0.4   0.51  0.42  0.39  0.43  0.59  0.24  0.42  0.43
   0.34  0.38  0.4   0.24  0.21  0.11  0.09  0.37  0.14  0.7   0.25  1.
   0.46]
 [ 0.66  0.64  0.26  0.64  0.56  0.38  0.54  0.64  0.41  0.41  0.31  0.45
   0.55  0.53  0.39  0.5   0.3   0.05  0.    0.49  0.54  0.51  0.21  0.46
   1.  ]]
Got 25 patterns after merging
2024-03-16 18:12:54.135485 MEMORY 16.962736128
Performing filtering
2024-03-16 18:12:54.135686 MEMORY 16.962736128
Got 22 patterns after filtering
2024-03-16 18:12:55.005856 MEMORY 16.962736128
Total time taken is 970.2s
2024-03-16 18:12:55.006023 MEMORY 16.962736128
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 1531 out of 1531 | elapsed:    0.5s finished
/ru-auth/local/home/lzhao/anaconda3/envs/jupyter-ml-clone/lib/python3.9/site-packages/sklearn/manifold/_t_sne.py:691: FutureWarning: 'square_distances' has been introduced in 0.24 to help phase out legacy squaring behavior. The 'legacy' setting will be removed in 1.1 (renaming of 0.26), and the default setting will be changed to True. In 1.3, 'square_distances' will be removed altogether, and distances will be squared by default. Set 'square_distances'=True to silence this warning.
  warnings.warn(
/ru-auth/local/home/lzhao/anaconda3/envs/jupyter-ml-clone/lib/python3.9/site-packages/sklearn/neighbors/_base.py:175: EfficiencyWarning: Precomputed sparse input was not sorted by data.
  warnings.warn('Precomputed sparse input was not sorted by data.',
Applying subclustering to the final motifs
On pattern 0
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 1531 samples in 0.012s...
[t-SNE] Computed neighbors for 1531 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 1000 / 1531
[t-SNE] Computed conditional probabilities for sample 1531 / 1531
[t-SNE] Mean sigma: 0.322091
[t-SNE] Computed conditional probabilities in 0.108s
[t-SNE] Iteration 50: error = 68.7446518, gradient norm = 0.1501196 (50 iterations in 2.217s)
[t-SNE] Iteration 100: error = 68.4629822, gradient norm = 0.1478632 (50 iterations in 2.186s)
[t-SNE] Iteration 150: error = 68.3737335, gradient norm = 0.1415699 (50 iterations in 2.188s)
[t-SNE] Iteration 200: error = 68.6162415, gradient norm = 0.1670652 (50 iterations in 2.184s)
[t-SNE] Iteration 250: error = 69.0537872, gradient norm = 0.1533780 (50 iterations in 2.176s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 69.053787
[t-SNE] Iteration 300: error = 1.9814444, gradient norm = 0.0013923 (50 iterations in 2.235s)
[t-SNE] Iteration 350: error = 1.9106467, gradient norm = 0.0003318 (50 iterations in 2.506s)
[t-SNE] Iteration 400: error = 1.8854691, gradient norm = 0.0001966 (50 iterations in 2.191s)
[t-SNE] Iteration 450: error = 1.8755740, gradient norm = 0.0001267 (50 iterations in 2.184s)
[t-SNE] Iteration 500: error = 1.8718506, gradient norm = 0.0000942 (50 iterations in 2.154s)
[t-SNE] Iteration 550: error = 1.8682662, gradient norm = 0.0000671 (50 iterations in 2.163s)
[t-SNE] Iteration 600: error = 1.8656348, gradient norm = 0.0001092 (50 iterations in 2.175s)
[t-SNE] Iteration 650: error = 1.8649436, gradient norm = 0.0000562 (50 iterations in 2.384s)
[t-SNE] Iteration 700: error = 1.8638952, gradient norm = 0.0000538 (50 iterations in 2.368s)
[t-SNE] Iteration 750: error = 1.8635147, gradient norm = 0.0000753 (50 iterations in 2.525s)
[t-SNE] Iteration 800: error = 1.8630002, gradient norm = 0.0000450 (50 iterations in 2.218s)
[t-SNE] Iteration 850: error = 1.8623260, gradient norm = 0.0000375 (50 iterations in 2.178s)
[t-SNE] Iteration 900: error = 1.8615022, gradient norm = 0.0000407 (50 iterations in 2.211s)
[t-SNE] Iteration 950: error = 1.8608999, gradient norm = 0.0000335 (50 iterations in 2.167s)
[t-SNE] Iteration 1000: error = 1.8603855, gradient norm = 0.0000354 (50 iterations in 2.164s)
[t-SNE] KL divergence after 1000 iterations: 1.860386
[t-SNE] Computed conditional probabilities for sample 1000 / 1531
[t-SNE] Computed conditional probabilities for sample 1531 / 1531
[t-SNE] Mean sigma: 0.322091
Beginning preprocessing + Leiden
2024-03-16 18:13:42.047256 MEMORY 16.963063808
Affmat transformed
2024-03-16 18:13:42.068144 MEMORY 16.963063808
sources, targets, weights extracted
2024-03-16 18:13:42.080408 MEMORY 16.963063808
About to launch parallel Leiden runs
2024-03-16 18:13:42.098309 MEMORY 16.963063808
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    4.8s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   16.2s finished
Parallel Leiden runs finished
2024-03-16 18:13:58.338960 MEMORY 16.963063808
Quality: 0.47764371331886846
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 1290 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done 1461 out of 1461 | elapsed:    0.9s finished
Got subclusters: Counter({0: 390, 1: 365, 2: 284, 3: 153, 4: 143, 5: 105, 6: 89, 7: 2})
On pattern 1
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 1461 samples in 0.011s...
[t-SNE] Computed neighbors for 1461 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 1000 / 1461
[t-SNE] Computed conditional probabilities for sample 1461 / 1461
[t-SNE] Mean sigma: 0.342061
[t-SNE] Computed conditional probabilities in 0.101s
[t-SNE] Iteration 50: error = 68.1141434, gradient norm = 0.1597378 (50 iterations in 2.171s)
[t-SNE] Iteration 100: error = 68.3283386, gradient norm = 0.1625932 (50 iterations in 2.175s)
[t-SNE] Iteration 150: error = 69.1772690, gradient norm = 0.1395091 (50 iterations in 2.173s)
[t-SNE] Iteration 200: error = 68.9197845, gradient norm = 0.1310869 (50 iterations in 2.171s)
[t-SNE] Iteration 250: error = 68.5147934, gradient norm = 0.1580630 (50 iterations in 2.190s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 68.514793
[t-SNE] Iteration 300: error = 2.1218078, gradient norm = 0.0013680 (50 iterations in 2.171s)
[t-SNE] Iteration 350: error = 2.0533304, gradient norm = 0.0004245 (50 iterations in 2.159s)
[t-SNE] Iteration 400: error = 2.0217769, gradient norm = 0.0001943 (50 iterations in 2.158s)
[t-SNE] Iteration 450: error = 2.0082746, gradient norm = 0.0001906 (50 iterations in 2.224s)
[t-SNE] Iteration 500: error = 2.0027266, gradient norm = 0.0001285 (50 iterations in 2.678s)
[t-SNE] Iteration 550: error = 1.9999182, gradient norm = 0.0001137 (50 iterations in 2.274s)
[t-SNE] Iteration 600: error = 1.9972193, gradient norm = 0.0001289 (50 iterations in 2.170s)
[t-SNE] Iteration 650: error = 1.9955690, gradient norm = 0.0000769 (50 iterations in 2.178s)
[t-SNE] Iteration 700: error = 1.9942168, gradient norm = 0.0000899 (50 iterations in 2.191s)
[t-SNE] Iteration 750: error = 1.9936672, gradient norm = 0.0000744 (50 iterations in 2.167s)
[t-SNE] Iteration 800: error = 1.9927312, gradient norm = 0.0000640 (50 iterations in 2.176s)
[t-SNE] Iteration 850: error = 1.9919541, gradient norm = 0.0000728 (50 iterations in 2.184s)
[t-SNE] Iteration 900: error = 1.9910004, gradient norm = 0.0000631 (50 iterations in 2.179s)
[t-SNE] Iteration 950: error = 1.9895122, gradient norm = 0.0000729 (50 iterations in 2.205s)
[t-SNE] Iteration 1000: error = 1.9886756, gradient norm = 0.0000674 (50 iterations in 2.157s)
[t-SNE] KL divergence after 1000 iterations: 1.988676
[t-SNE] Computed conditional probabilities for sample 1000 / 1461
[t-SNE] Computed conditional probabilities for sample 1461 / 1461
[t-SNE] Mean sigma: 0.342061
Beginning preprocessing + Leiden
2024-03-16 18:14:45.261984 MEMORY 16.963063808
Affmat transformed
2024-03-16 18:14:45.282035 MEMORY 16.963063808
sources, targets, weights extracted
2024-03-16 18:14:45.292954 MEMORY 16.963063808
About to launch parallel Leiden runs
2024-03-16 18:14:45.302062 MEMORY 16.963063808
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    4.5s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   14.7s finished
Parallel Leiden runs finished
2024-03-16 18:14:59.966917 MEMORY 16.963063808
Quality: 0.45461634587692173
Quality: 0.4548417740525914
Quality: 0.4558462725483751
Quality: 0.45603026895466553
Quality: 0.4561648802736816
Quality: 0.45623445453113837
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 350 out of 350 | elapsed:    0.1s finished
Got subclusters: Counter({0: 269, 1: 223, 2: 201, 3: 198, 4: 163, 5: 148, 6: 146, 7: 113})
On pattern 2
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 350 samples in 0.003s...
[t-SNE] Computed neighbors for 350 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 350 / 350
[t-SNE] Mean sigma: 0.394414
[t-SNE] Computed conditional probabilities in 0.024s
[t-SNE] Iteration 50: error = 63.3838348, gradient norm = 0.5039799 (50 iterations in 2.120s)
[t-SNE] Iteration 100: error = 65.6403732, gradient norm = 0.4909652 (50 iterations in 2.132s)
[t-SNE] Iteration 150: error = 64.9561920, gradient norm = 0.5115141 (50 iterations in 2.136s)
[t-SNE] Iteration 200: error = 68.3304749, gradient norm = 0.4627091 (50 iterations in 2.115s)
[t-SNE] Iteration 250: error = 68.5458450, gradient norm = 0.4708272 (50 iterations in 2.134s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 68.545845
[t-SNE] Iteration 300: error = 1.4312091, gradient norm = 0.0055766 (50 iterations in 2.170s)
[t-SNE] Iteration 350: error = 1.3154348, gradient norm = 0.0031347 (50 iterations in 2.125s)
[t-SNE] Iteration 400: error = 1.2514249, gradient norm = 0.0018504 (50 iterations in 2.123s)
[t-SNE] Iteration 450: error = 1.2127131, gradient norm = 0.0020861 (50 iterations in 2.151s)
[t-SNE] Iteration 500: error = 1.1806595, gradient norm = 0.0020604 (50 iterations in 2.123s)
[t-SNE] Iteration 550: error = 1.1667311, gradient norm = 0.0007935 (50 iterations in 2.152s)
[t-SNE] Iteration 600: error = 1.1633271, gradient norm = 0.0005599 (50 iterations in 2.137s)
[t-SNE] Iteration 650: error = 1.1624486, gradient norm = 0.0001246 (50 iterations in 2.158s)
[t-SNE] Iteration 700: error = 1.1621248, gradient norm = 0.0000967 (50 iterations in 2.126s)
[t-SNE] Iteration 750: error = 1.1613972, gradient norm = 0.0001919 (50 iterations in 2.136s)
[t-SNE] Iteration 800: error = 1.1595161, gradient norm = 0.0003339 (50 iterations in 2.134s)
[t-SNE] Iteration 850: error = 1.1592902, gradient norm = 0.0000678 (50 iterations in 2.126s)
[t-SNE] Iteration 900: error = 1.1590514, gradient norm = 0.0000725 (50 iterations in 2.139s)
[t-SNE] Iteration 950: error = 1.1589988, gradient norm = 0.0000607 (50 iterations in 2.133s)
[t-SNE] Iteration 1000: error = 1.1589407, gradient norm = 0.0000386 (50 iterations in 2.146s)
[t-SNE] KL divergence after 1000 iterations: 1.158941
[t-SNE] Computed conditional probabilities for sample 350 / 350
[t-SNE] Mean sigma: 0.394414
Beginning preprocessing + Leiden
2024-03-16 18:15:43.355800 MEMORY 16.963063808
Affmat transformed
2024-03-16 18:15:43.361505 MEMORY 16.963063808
sources, targets, weights extracted
2024-03-16 18:15:43.364005 MEMORY 16.963063808
About to launch parallel Leiden runs
2024-03-16 18:15:43.389851 MEMORY 16.963063808
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.3s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    3.8s finished
Parallel Leiden runs finished
2024-03-16 18:15:47.158103 MEMORY 16.963063808
Quality: 0.33643347758047404
Quality: 0.3380891726523823
Quality: 0.3386960086848044
Quality: 0.33878335642290436
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 277 out of 277 | elapsed:    0.1s finished
Got subclusters: Counter({0: 83, 1: 80, 2: 60, 3: 51, 4: 41, 5: 35})
On pattern 3
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 277 samples in 0.003s...
[t-SNE] Computed neighbors for 277 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 277 / 277
[t-SNE] Mean sigma: 0.388406
[t-SNE] Computed conditional probabilities in 0.019s
[t-SNE] Iteration 50: error = 61.0025635, gradient norm = 0.5187719 (50 iterations in 2.111s)
[t-SNE] Iteration 100: error = 62.5936813, gradient norm = 0.4808765 (50 iterations in 2.126s)
[t-SNE] Iteration 150: error = 59.9739037, gradient norm = 0.5731967 (50 iterations in 2.126s)
[t-SNE] Iteration 200: error = 62.4662094, gradient norm = 0.4817121 (50 iterations in 2.137s)
[t-SNE] Iteration 250: error = 63.5301857, gradient norm = 0.4970722 (50 iterations in 2.135s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 63.530186
[t-SNE] Iteration 300: error = 1.2044917, gradient norm = 0.0048113 (50 iterations in 2.137s)
[t-SNE] Iteration 350: error = 1.0773382, gradient norm = 0.0034858 (50 iterations in 2.139s)
[t-SNE] Iteration 400: error = 0.9942611, gradient norm = 0.0019128 (50 iterations in 2.141s)
[t-SNE] Iteration 450: error = 0.9720689, gradient norm = 0.0014821 (50 iterations in 2.127s)
[t-SNE] Iteration 500: error = 0.9633904, gradient norm = 0.0004549 (50 iterations in 2.131s)
[t-SNE] Iteration 550: error = 0.9453775, gradient norm = 0.0016724 (50 iterations in 2.116s)
[t-SNE] Iteration 600: error = 0.9379533, gradient norm = 0.0003482 (50 iterations in 2.140s)
[t-SNE] Iteration 650: error = 0.9381763, gradient norm = 0.0000673 (50 iterations in 2.126s)
[t-SNE] Iteration 700: error = 0.9382899, gradient norm = 0.0000487 (50 iterations in 2.139s)
[t-SNE] Iteration 750: error = 0.9383134, gradient norm = 0.0000520 (50 iterations in 2.135s)
[t-SNE] Iteration 800: error = 0.9383320, gradient norm = 0.0001009 (50 iterations in 2.131s)
[t-SNE] Iteration 850: error = 0.9385731, gradient norm = 0.0001374 (50 iterations in 2.149s)
[t-SNE] Iteration 900: error = 0.9387954, gradient norm = 0.0000613 (50 iterations in 2.151s)
[t-SNE] Iteration 950: error = 0.9387766, gradient norm = 0.0001568 (50 iterations in 2.134s)
[t-SNE] Iteration 950: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 950 iterations: 0.938777
[t-SNE] Computed conditional probabilities for sample 277 / 277
[t-SNE] Mean sigma: 0.388406
Beginning preprocessing + Leiden
2024-03-16 18:16:28.146990 MEMORY 16.963063808
Affmat transformed
2024-03-16 18:16:28.152146 MEMORY 16.963063808
sources, targets, weights extracted
2024-03-16 18:16:28.154026 MEMORY 16.963063808
About to launch parallel Leiden runs
2024-03-16 18:16:28.164589 MEMORY 16.963063808
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.2s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    3.5s finished
Parallel Leiden runs finished
2024-03-16 18:16:31.642803 MEMORY 16.963063808
Quality: 0.3379707343990011
Quality: 0.33820778759201764
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 274 out of 274 | elapsed:    0.1s finished
Got subclusters: Counter({0: 58, 1: 56, 2: 48, 3: 44, 4: 42, 5: 29})
On pattern 4
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 274 samples in 0.002s...
[t-SNE] Computed neighbors for 274 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 274 / 274
[t-SNE] Mean sigma: 0.377737
[t-SNE] Computed conditional probabilities in 0.019s
[t-SNE] Iteration 50: error = 60.2365150, gradient norm = 0.5334629 (50 iterations in 2.135s)
[t-SNE] Iteration 100: error = 64.2184448, gradient norm = 0.4980736 (50 iterations in 2.133s)
[t-SNE] Iteration 150: error = 63.6185112, gradient norm = 0.4897028 (50 iterations in 2.140s)
[t-SNE] Iteration 200: error = 62.9729614, gradient norm = 0.5134422 (50 iterations in 2.145s)
[t-SNE] Iteration 250: error = 62.6757355, gradient norm = 0.4966713 (50 iterations in 2.150s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 62.675735
[t-SNE] Iteration 300: error = 1.2370727, gradient norm = 0.0045183 (50 iterations in 2.149s)
[t-SNE] Iteration 350: error = 1.1296920, gradient norm = 0.0064392 (50 iterations in 2.123s)
[t-SNE] Iteration 400: error = 1.0246859, gradient norm = 0.0024106 (50 iterations in 2.135s)
[t-SNE] Iteration 450: error = 1.0168732, gradient norm = 0.0003855 (50 iterations in 2.127s)
[t-SNE] Iteration 500: error = 1.0097042, gradient norm = 0.0007941 (50 iterations in 2.126s)
[t-SNE] Iteration 550: error = 0.9820349, gradient norm = 0.0014211 (50 iterations in 2.124s)
[t-SNE] Iteration 600: error = 0.9723816, gradient norm = 0.0010536 (50 iterations in 2.169s)
[t-SNE] Iteration 650: error = 0.9622264, gradient norm = 0.0005609 (50 iterations in 2.137s)
[t-SNE] Iteration 700: error = 0.9586141, gradient norm = 0.0003046 (50 iterations in 2.153s)
[t-SNE] Iteration 750: error = 0.9584846, gradient norm = 0.0002121 (50 iterations in 2.155s)
[t-SNE] Iteration 800: error = 0.9584334, gradient norm = 0.0001042 (50 iterations in 2.135s)
[t-SNE] Iteration 850: error = 0.9583886, gradient norm = 0.0000652 (50 iterations in 2.150s)
[t-SNE] Iteration 900: error = 0.9583958, gradient norm = 0.0001078 (50 iterations in 2.125s)
[t-SNE] Iteration 950: error = 0.9584058, gradient norm = 0.0000946 (50 iterations in 2.158s)
[t-SNE] Iteration 1000: error = 0.9584665, gradient norm = 0.0001396 (50 iterations in 2.127s)
[t-SNE] KL divergence after 1000 iterations: 0.958466
[t-SNE] Computed conditional probabilities for sample 274 / 274
[t-SNE] Mean sigma: 0.377737
Beginning preprocessing + Leiden
2024-03-16 18:17:14.902850 MEMORY 16.963063808
Affmat transformed
2024-03-16 18:17:14.907963 MEMORY 16.963063808
sources, targets, weights extracted
2024-03-16 18:17:14.909871 MEMORY 16.963063808
About to launch parallel Leiden runs
2024-03-16 18:17:14.920694 MEMORY 16.963063808
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.2s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    3.3s finished
Parallel Leiden runs finished
2024-03-16 18:17:18.272797 MEMORY 16.963063808
Quality: 0.32213552148263946
Quality: 0.32575140367388766
Quality: 0.3261379279111594
Quality: 0.32650719696886604
Quality: 0.3265123368157126
Quality: 0.32652708577509076
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 220 out of 220 | elapsed:    0.1s finished
Got subclusters: Counter({0: 56, 1: 50, 2: 45, 3: 44, 5: 34, 4: 34, 6: 11})
On pattern 5
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 220 samples in 0.002s...
[t-SNE] Computed neighbors for 220 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 220 / 220
[t-SNE] Mean sigma: 0.414732
[t-SNE] Computed conditional probabilities in 0.016s
[t-SNE] Iteration 50: error = 62.7444191, gradient norm = 0.4558841 (50 iterations in 2.122s)
[t-SNE] Iteration 100: error = 60.7908592, gradient norm = 0.4904307 (50 iterations in 2.126s)
[t-SNE] Iteration 150: error = 59.8180084, gradient norm = 0.5132716 (50 iterations in 2.134s)
[t-SNE] Iteration 200: error = 61.0517769, gradient norm = 0.4976957 (50 iterations in 2.138s)
[t-SNE] Iteration 250: error = 59.9984398, gradient norm = 0.5367566 (50 iterations in 2.127s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 59.998440
[t-SNE] Iteration 300: error = 1.0128605, gradient norm = 0.0048647 (50 iterations in 2.131s)
[t-SNE] Iteration 350: error = 0.8524876, gradient norm = 0.0037560 (50 iterations in 2.109s)
[t-SNE] Iteration 400: error = 0.8087209, gradient norm = 0.0014914 (50 iterations in 2.123s)
[t-SNE] Iteration 450: error = 0.7803692, gradient norm = 0.0034352 (50 iterations in 2.127s)
[t-SNE] Iteration 500: error = 0.7500327, gradient norm = 0.0006409 (50 iterations in 2.137s)
[t-SNE] Iteration 550: error = 0.7434298, gradient norm = 0.0003725 (50 iterations in 2.120s)
[t-SNE] Iteration 600: error = 0.7432369, gradient norm = 0.0001314 (50 iterations in 2.158s)
[t-SNE] Iteration 650: error = 0.7432595, gradient norm = 0.0001136 (50 iterations in 2.120s)
[t-SNE] Iteration 700: error = 0.7432582, gradient norm = 0.0001245 (50 iterations in 2.139s)
[t-SNE] Iteration 750: error = 0.7431807, gradient norm = 0.0001205 (50 iterations in 2.106s)
[t-SNE] Iteration 800: error = 0.7432057, gradient norm = 0.0001279 (50 iterations in 2.102s)
[t-SNE] Iteration 850: error = 0.7431533, gradient norm = 0.0000807 (50 iterations in 2.088s)
[t-SNE] Iteration 900: error = 0.7432389, gradient norm = 0.0001161 (50 iterations in 2.117s)
[t-SNE] Iteration 950: error = 0.7431836, gradient norm = 0.0001331 (50 iterations in 2.086s)
[t-SNE] Iteration 1000: error = 0.7431530, gradient norm = 0.0001147 (50 iterations in 2.093s)
[t-SNE] KL divergence after 1000 iterations: 0.743153
[t-SNE] Computed conditional probabilities for sample 220 / 220
[t-SNE] Mean sigma: 0.414732
Beginning preprocessing + Leiden
2024-03-16 18:18:01.066004 MEMORY 16.963063808
Affmat transformed
2024-03-16 18:18:01.069764 MEMORY 16.963063808
sources, targets, weights extracted
2024-03-16 18:18:01.071200 MEMORY 16.963063808
About to launch parallel Leiden runs
2024-03-16 18:18:01.093932 MEMORY 16.963063808
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.0s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.7s finished
Parallel Leiden runs finished
2024-03-16 18:18:03.789093 MEMORY 16.963063808
Quality: 0.319958984978247
Quality: 0.3203532927127669
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 206 out of 206 | elapsed:    0.1s finished
Got subclusters: Counter({0: 45, 1: 44, 2: 42, 3: 38, 4: 33, 5: 18})
On pattern 6
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 206 samples in 0.002s...
[t-SNE] Computed neighbors for 206 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 206 / 206
[t-SNE] Mean sigma: 0.434656
[t-SNE] Computed conditional probabilities in 0.014s
[t-SNE] Iteration 50: error = 60.7244034, gradient norm = 0.4929117 (50 iterations in 2.059s)
[t-SNE] Iteration 100: error = 59.8206825, gradient norm = 0.5088162 (50 iterations in 2.065s)
[t-SNE] Iteration 150: error = 61.5504189, gradient norm = 0.4946518 (50 iterations in 2.085s)
[t-SNE] Iteration 200: error = 59.2239990, gradient norm = 0.5156333 (50 iterations in 2.067s)
[t-SNE] Iteration 250: error = 59.0367889, gradient norm = 0.5038911 (50 iterations in 2.061s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 59.036789
[t-SNE] Iteration 300: error = 0.9487758, gradient norm = 0.0057733 (50 iterations in 2.077s)
[t-SNE] Iteration 350: error = 0.8171239, gradient norm = 0.0032094 (50 iterations in 2.063s)
[t-SNE] Iteration 400: error = 0.7788906, gradient norm = 0.0012418 (50 iterations in 2.061s)
[t-SNE] Iteration 450: error = 0.7775380, gradient norm = 0.0001314 (50 iterations in 2.060s)
[t-SNE] Iteration 500: error = 0.7776628, gradient norm = 0.0001971 (50 iterations in 2.060s)
[t-SNE] Iteration 550: error = 0.7775654, gradient norm = 0.0002033 (50 iterations in 2.062s)
[t-SNE] Iteration 600: error = 0.7774848, gradient norm = 0.0002184 (50 iterations in 2.055s)
[t-SNE] Iteration 650: error = 0.7775444, gradient norm = 0.0002141 (50 iterations in 2.061s)
[t-SNE] Iteration 700: error = 0.7774928, gradient norm = 0.0002125 (50 iterations in 2.059s)
[t-SNE] Iteration 750: error = 0.7776367, gradient norm = 0.0002372 (50 iterations in 2.066s)
[t-SNE] Iteration 800: error = 0.7776117, gradient norm = 0.0001978 (50 iterations in 2.059s)
[t-SNE] Iteration 850: error = 0.7776331, gradient norm = 0.0002021 (50 iterations in 2.050s)
[t-SNE] Iteration 900: error = 0.7775630, gradient norm = 0.0001933 (50 iterations in 2.037s)
[t-SNE] Iteration 950: error = 0.7775112, gradient norm = 0.0001886 (50 iterations in 2.034s)
[t-SNE] Iteration 950: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 950 iterations: 0.777511
[t-SNE] Computed conditional probabilities for sample 206 / 206
[t-SNE] Mean sigma: 0.434656
Beginning preprocessing + Leiden
2024-03-16 18:18:43.278287 MEMORY 16.963067904
Affmat transformed
2024-03-16 18:18:43.281974 MEMORY 16.963067904
sources, targets, weights extracted
2024-03-16 18:18:43.283401 MEMORY 16.963067904
About to launch parallel Leiden runs
2024-03-16 18:18:43.287803 MEMORY 16.963067904
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.8s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.4s finished
Parallel Leiden runs finished
2024-03-16 18:18:45.709000 MEMORY 16.963067904
Quality: 0.3392992055539942
Quality: 0.33939533214161355
Quality: 0.3395711774647709
Quality: 0.3396181301530442
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 202 out of 202 | elapsed:    0.1s finished
Got subclusters: Counter({0: 64, 1: 39, 2: 38, 3: 32, 4: 17, 5: 16})
On pattern 7
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 202 samples in 0.003s...
[t-SNE] Computed neighbors for 202 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 202 / 202
[t-SNE] Mean sigma: 0.409622
[t-SNE] Computed conditional probabilities in 0.014s
[t-SNE] Iteration 50: error = 59.1480103, gradient norm = 0.4860908 (50 iterations in 2.037s)
[t-SNE] Iteration 100: error = 57.6961594, gradient norm = 0.5807511 (50 iterations in 2.037s)
[t-SNE] Iteration 150: error = 59.6924019, gradient norm = 0.5204750 (50 iterations in 2.038s)
[t-SNE] Iteration 200: error = 58.1311417, gradient norm = 0.4773359 (50 iterations in 2.038s)
[t-SNE] Iteration 250: error = 59.3003578, gradient norm = 0.5053595 (50 iterations in 2.042s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 59.300358
[t-SNE] Iteration 300: error = 0.9591873, gradient norm = 0.0075880 (50 iterations in 2.030s)
[t-SNE] Iteration 350: error = 0.6930722, gradient norm = 0.0030328 (50 iterations in 2.032s)
[t-SNE] Iteration 400: error = 0.6658592, gradient norm = 0.0013564 (50 iterations in 2.029s)
[t-SNE] Iteration 450: error = 0.6653442, gradient norm = 0.0001581 (50 iterations in 2.025s)
[t-SNE] Iteration 500: error = 0.6649883, gradient norm = 0.0001726 (50 iterations in 1.024s)
[t-SNE] Iteration 550: error = 0.6651434, gradient norm = 0.0001322 (50 iterations in 0.593s)
[t-SNE] Iteration 600: error = 0.6651962, gradient norm = 0.0001133 (50 iterations in 0.617s)
[t-SNE] Iteration 650: error = 0.6652326, gradient norm = 0.0001508 (50 iterations in 0.791s)
[t-SNE] Iteration 700: error = 0.6651635, gradient norm = 0.0001509 (50 iterations in 2.033s)
[t-SNE] Iteration 750: error = 0.6652169, gradient norm = 0.0001164 (50 iterations in 2.032s)
[t-SNE] Iteration 800: error = 0.6651635, gradient norm = 0.0000908 (50 iterations in 1.265s)
[t-SNE] Iteration 850: error = 0.6651800, gradient norm = 0.0001048 (50 iterations in 1.983s)
[t-SNE] Iteration 850: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 850 iterations: 0.665180
[t-SNE] Computed conditional probabilities for sample 202 / 202
[t-SNE] Mean sigma: 0.409622
Beginning preprocessing + Leiden
2024-03-16 18:19:14.694138 MEMORY 16.963067904
Affmat transformed
2024-03-16 18:19:14.698364 MEMORY 16.963067904
sources, targets, weights extracted
2024-03-16 18:19:14.700226 MEMORY 16.963067904
About to launch parallel Leiden runs
2024-03-16 18:19:14.705125 MEMORY 16.963067904
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.8s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.2s finished
Parallel Leiden runs finished
2024-03-16 18:19:16.950179 MEMORY 16.963067904
Quality: 0.33166903929492314
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 191 out of 191 | elapsed:    0.1s finished
Got subclusters: Counter({0: 62, 1: 51, 2: 45, 3: 25, 4: 19})
On pattern 8
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 191 samples in 0.002s...
[t-SNE] Computed neighbors for 191 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 191 / 191
[t-SNE] Mean sigma: 0.410186
[t-SNE] Computed conditional probabilities in 0.013s
[t-SNE] Iteration 50: error = 61.1188660, gradient norm = 0.4830244 (50 iterations in 2.024s)
[t-SNE] Iteration 100: error = 60.5097961, gradient norm = 0.5043108 (50 iterations in 2.034s)
[t-SNE] Iteration 150: error = 61.0700073, gradient norm = 0.5024392 (50 iterations in 2.031s)
[t-SNE] Iteration 200: error = 57.6873093, gradient norm = 0.5848922 (50 iterations in 2.024s)
[t-SNE] Iteration 250: error = 59.2659760, gradient norm = 0.4808917 (50 iterations in 2.031s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 59.265976
[t-SNE] Iteration 300: error = 1.0394225, gradient norm = 0.0064677 (50 iterations in 2.035s)
[t-SNE] Iteration 350: error = 0.7975300, gradient norm = 0.0061813 (50 iterations in 1.793s)
[t-SNE] Iteration 400: error = 0.7426572, gradient norm = 0.0016342 (50 iterations in 1.551s)
[t-SNE] Iteration 450: error = 0.7290504, gradient norm = 0.0035103 (50 iterations in 2.033s)
[t-SNE] Iteration 500: error = 0.7149606, gradient norm = 0.0024119 (50 iterations in 1.049s)
[t-SNE] Iteration 550: error = 0.7121899, gradient norm = 0.0002768 (50 iterations in 2.030s)
[t-SNE] Iteration 600: error = 0.7123858, gradient norm = 0.0001332 (50 iterations in 2.036s)
[t-SNE] Iteration 650: error = 0.7119989, gradient norm = 0.0001604 (50 iterations in 2.027s)
[t-SNE] Iteration 700: error = 0.7119271, gradient norm = 0.0001022 (50 iterations in 2.025s)
[t-SNE] Iteration 750: error = 0.7119046, gradient norm = 0.0000467 (50 iterations in 2.029s)
[t-SNE] Iteration 800: error = 0.7118710, gradient norm = 0.0000757 (50 iterations in 2.035s)
[t-SNE] Iteration 850: error = 0.7118384, gradient norm = 0.0001065 (50 iterations in 1.850s)
[t-SNE] Iteration 900: error = 0.7118999, gradient norm = 0.0000559 (50 iterations in 0.030s)
[t-SNE] Iteration 950: error = 0.7118680, gradient norm = 0.0000687 (50 iterations in 0.329s)
[t-SNE] Iteration 1000: error = 0.7119098, gradient norm = 0.0001261 (50 iterations in 2.029s)
[t-SNE] KL divergence after 1000 iterations: 0.711910
[t-SNE] Computed conditional probabilities for sample 191 / 191
[t-SNE] Mean sigma: 0.410186
Beginning preprocessing + Leiden
2024-03-16 18:19:52.327978 MEMORY 16.963067904
Affmat transformed
2024-03-16 18:19:52.331085 MEMORY 16.963067904
sources, targets, weights extracted
2024-03-16 18:19:52.332344 MEMORY 16.963067904
About to launch parallel Leiden runs
2024-03-16 18:19:52.402320 MEMORY 16.963067904
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.8s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.2s finished
Parallel Leiden runs finished
2024-03-16 18:19:54.640062 MEMORY 16.963067904
Quality: 0.29124283141907814
Quality: 0.2926808628978155
Quality: 0.29296005408164805
Quality: 0.29423508192482284
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 176 out of 176 | elapsed:    0.1s finished
Got subclusters: Counter({0: 44, 1: 36, 2: 35, 3: 34, 5: 21, 4: 21})
On pattern 9
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 176 samples in 0.002s...
[t-SNE] Computed neighbors for 176 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 176 / 176
[t-SNE] Mean sigma: 0.405053
[t-SNE] Computed conditional probabilities in 0.012s
[t-SNE] Iteration 50: error = 60.5242691, gradient norm = 0.5493015 (50 iterations in 1.186s)
[t-SNE] Iteration 100: error = 61.3357201, gradient norm = 0.4829937 (50 iterations in 2.030s)
[t-SNE] Iteration 150: error = 58.7004051, gradient norm = 0.5636357 (50 iterations in 2.028s)
[t-SNE] Iteration 200: error = 59.5814514, gradient norm = 0.5096228 (50 iterations in 2.030s)
[t-SNE] Iteration 250: error = 59.0589027, gradient norm = 0.4846423 (50 iterations in 2.029s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 59.058903
[t-SNE] Iteration 300: error = 0.9621102, gradient norm = 0.0068004 (50 iterations in 2.028s)
[t-SNE] Iteration 350: error = 0.7041768, gradient norm = 0.0034236 (50 iterations in 1.628s)
[t-SNE] Iteration 400: error = 0.6910969, gradient norm = 0.0015549 (50 iterations in 0.683s)
[t-SNE] Iteration 450: error = 0.6863877, gradient norm = 0.0003510 (50 iterations in 0.027s)
[t-SNE] Iteration 500: error = 0.6859469, gradient norm = 0.0011357 (50 iterations in 0.133s)
[t-SNE] Iteration 550: error = 0.6862013, gradient norm = 0.0002315 (50 iterations in 0.866s)
[t-SNE] Iteration 600: error = 0.6861644, gradient norm = 0.0003916 (50 iterations in 2.027s)
[t-SNE] Iteration 650: error = 0.6861730, gradient norm = 0.0003844 (50 iterations in 0.576s)
[t-SNE] Iteration 700: error = 0.6861538, gradient norm = 0.0003556 (50 iterations in 0.122s)
[t-SNE] Iteration 750: error = 0.6748040, gradient norm = 0.0003759 (50 iterations in 0.793s)
[t-SNE] Iteration 800: error = 0.6747121, gradient norm = 0.0002383 (50 iterations in 2.028s)
[t-SNE] Iteration 850: error = 0.6747244, gradient norm = 0.0002302 (50 iterations in 2.040s)
[t-SNE] Iteration 900: error = 0.6747333, gradient norm = 0.0003091 (50 iterations in 2.027s)
[t-SNE] Iteration 950: error = 0.6747723, gradient norm = 0.0002628 (50 iterations in 2.028s)
[t-SNE] Iteration 1000: error = 0.6746810, gradient norm = 0.0002238 (50 iterations in 2.027s)
[t-SNE] KL divergence after 1000 iterations: 0.674681
[t-SNE] Computed conditional probabilities for sample 176 / 176
[t-SNE] Mean sigma: 0.405053
Beginning preprocessing + Leiden
2024-03-16 18:20:23.305846 MEMORY 16.963067904
Affmat transformed
2024-03-16 18:20:23.309392 MEMORY 16.963067904
sources, targets, weights extracted
2024-03-16 18:20:23.310601 MEMORY 16.963067904
About to launch parallel Leiden runs
2024-03-16 18:20:23.314721 MEMORY 16.963067904
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.8s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.2s finished
Parallel Leiden runs finished
2024-03-16 18:20:25.509128 MEMORY 16.963067904
Quality: 0.26999232457618455
Quality: 0.27500869553140206
Quality: 0.2751630317887096
Quality: 0.2753265762412299
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 114 out of 161 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=24)]: Done 161 out of 161 | elapsed:    0.1s finished
Got subclusters: Counter({0: 46, 1: 34, 2: 31, 3: 29, 4: 19, 5: 17})
On pattern 10
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 161 samples in 0.002s...
[t-SNE] Computed neighbors for 161 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 161 / 161
[t-SNE] Mean sigma: 0.384063
[t-SNE] Computed conditional probabilities in 0.011s
[t-SNE] Iteration 50: error = 60.4414024, gradient norm = 0.4559475 (50 iterations in 2.015s)
[t-SNE] Iteration 100: error = 57.5025940, gradient norm = 0.4978883 (50 iterations in 1.908s)
[t-SNE] Iteration 150: error = 56.9057884, gradient norm = 0.5342015 (50 iterations in 0.027s)
[t-SNE] Iteration 200: error = 61.5043068, gradient norm = 0.4678280 (50 iterations in 0.353s)
[t-SNE] Iteration 250: error = 60.7414207, gradient norm = 0.4833988 (50 iterations in 0.026s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 60.741421
[t-SNE] Iteration 300: error = 0.9373688, gradient norm = 0.0088265 (50 iterations in 0.103s)
[t-SNE] Iteration 350: error = 0.5440685, gradient norm = 0.0055919 (50 iterations in 0.028s)
[t-SNE] Iteration 400: error = 0.5299387, gradient norm = 0.0017644 (50 iterations in 0.030s)
[t-SNE] Iteration 450: error = 0.5122212, gradient norm = 0.0011434 (50 iterations in 0.027s)
[t-SNE] Iteration 500: error = 0.5117684, gradient norm = 0.0001545 (50 iterations in 0.025s)
[t-SNE] Iteration 550: error = 0.5118749, gradient norm = 0.0001770 (50 iterations in 0.026s)
[t-SNE] Iteration 600: error = 0.5118482, gradient norm = 0.0001502 (50 iterations in 0.025s)
[t-SNE] Iteration 650: error = 0.5118648, gradient norm = 0.0001647 (50 iterations in 0.030s)
[t-SNE] Iteration 700: error = 0.5118488, gradient norm = 0.0001280 (50 iterations in 0.024s)
[t-SNE] Iteration 750: error = 0.5118551, gradient norm = 0.0002183 (50 iterations in 0.026s)
[t-SNE] Iteration 800: error = 0.5118836, gradient norm = 0.0001619 (50 iterations in 0.025s)
[t-SNE] Iteration 850: error = 0.5118492, gradient norm = 0.0001247 (50 iterations in 0.026s)
[t-SNE] Iteration 850: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 850 iterations: 0.511849
[t-SNE] Computed conditional probabilities for sample 161 / 161
[t-SNE] Mean sigma: 0.384063
Beginning preprocessing + Leiden
2024-03-16 18:20:30.535474 MEMORY 16.963067904
Affmat transformed
2024-03-16 18:20:30.538445 MEMORY 16.963067904
sources, targets, weights extracted
2024-03-16 18:20:30.539447 MEMORY 16.963067904
About to launch parallel Leiden runs
2024-03-16 18:20:30.543346 MEMORY 16.963067904
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.8s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.2s finished
Parallel Leiden runs finished
2024-03-16 18:20:32.723205 MEMORY 16.963067904
Quality: 0.23910644171062415
Quality: 0.23995000203568373
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 108 out of 155 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=24)]: Done 155 out of 155 | elapsed:    0.0s finished
Got subclusters: Counter({0: 41, 1: 39, 2: 33, 3: 22, 4: 15, 5: 11})
On pattern 11
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 155 samples in 0.002s...
[t-SNE] Computed neighbors for 155 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 155 / 155
[t-SNE] Mean sigma: 0.453666
[t-SNE] Computed conditional probabilities in 0.011s
[t-SNE] Iteration 50: error = 58.1335335, gradient norm = 0.5090880 (50 iterations in 0.029s)
[t-SNE] Iteration 100: error = 52.8985138, gradient norm = 0.5576525 (50 iterations in 0.026s)
[t-SNE] Iteration 150: error = 54.1022301, gradient norm = 0.5295979 (50 iterations in 0.027s)
[t-SNE] Iteration 200: error = 54.2492180, gradient norm = 0.5532327 (50 iterations in 0.029s)
[t-SNE] Iteration 250: error = 56.2489204, gradient norm = 0.5374570 (50 iterations in 0.028s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 56.248920
[t-SNE] Iteration 300: error = 0.7734189, gradient norm = 0.0121016 (50 iterations in 0.027s)
[t-SNE] Iteration 350: error = 0.6001911, gradient norm = 0.0019425 (50 iterations in 0.025s)
[t-SNE] Iteration 400: error = 0.5908619, gradient norm = 0.0002436 (50 iterations in 0.025s)
[t-SNE] Iteration 450: error = 0.5908605, gradient norm = 0.0001771 (50 iterations in 0.029s)
[t-SNE] Iteration 500: error = 0.5908890, gradient norm = 0.0003088 (50 iterations in 0.025s)
[t-SNE] Iteration 550: error = 0.5908479, gradient norm = 0.0002390 (50 iterations in 0.025s)
[t-SNE] Iteration 600: error = 0.5909415, gradient norm = 0.0002126 (50 iterations in 0.025s)
[t-SNE] Iteration 650: error = 0.5909321, gradient norm = 0.0001006 (50 iterations in 0.027s)
[t-SNE] Iteration 700: error = 0.5909362, gradient norm = 0.0001631 (50 iterations in 0.024s)
[t-SNE] Iteration 750: error = 0.5909399, gradient norm = 0.0001752 (50 iterations in 0.024s)
[t-SNE] Iteration 800: error = 0.5907022, gradient norm = 0.0001346 (50 iterations in 0.025s)
[t-SNE] Iteration 850: error = 0.5908369, gradient norm = 0.0001670 (50 iterations in 0.024s)
[t-SNE] Iteration 900: error = 0.5908232, gradient norm = 0.0001958 (50 iterations in 0.025s)
[t-SNE] Iteration 950: error = 0.5907849, gradient norm = 0.0000972 (50 iterations in 0.024s)
[t-SNE] Iteration 1000: error = 0.5907910, gradient norm = 0.0001836 (50 iterations in 0.027s)
[t-SNE] KL divergence after 1000 iterations: 0.590791
[t-SNE] Computed conditional probabilities for sample 155 / 155
[t-SNE] Mean sigma: 0.453666
Beginning preprocessing + Leiden
2024-03-16 18:20:33.487006 MEMORY 16.963067904
Affmat transformed
2024-03-16 18:20:33.489578 MEMORY 16.963067904
sources, targets, weights extracted
2024-03-16 18:20:33.490497 MEMORY 16.963067904
About to launch parallel Leiden runs
2024-03-16 18:20:33.495829 MEMORY 16.963067904
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.8s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.2s finished
Parallel Leiden runs finished
2024-03-16 18:20:35.703542 MEMORY 16.963067904
Quality: 0.28947404561809953
Quality: 0.2911280832790409
Quality: 0.2921894654437258
Quality: 0.2923685109625756
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  92 out of 139 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=24)]: Done 139 out of 139 | elapsed:    0.1s finished
Got subclusters: Counter({0: 54, 1: 48, 2: 29, 3: 24})
On pattern 12
[t-SNE] Computing 138 nearest neighbors...
[t-SNE] Indexed 139 samples in 0.001s...
[t-SNE] Computed neighbors for 139 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 139 / 139
[t-SNE] Mean sigma: 0.415744
[t-SNE] Computed conditional probabilities in 0.008s
[t-SNE] Iteration 50: error = 55.0785522, gradient norm = 0.5437503 (50 iterations in 0.023s)
[t-SNE] Iteration 100: error = 53.5938606, gradient norm = 0.5092440 (50 iterations in 0.022s)
[t-SNE] Iteration 150: error = 57.0183372, gradient norm = 0.4980173 (50 iterations in 0.023s)
[t-SNE] Iteration 200: error = 55.4885674, gradient norm = 0.5371997 (50 iterations in 0.021s)
[t-SNE] Iteration 250: error = 57.7339821, gradient norm = 0.4627690 (50 iterations in 0.023s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 57.733982
[t-SNE] Iteration 300: error = 0.6687063, gradient norm = 0.0151632 (50 iterations in 0.021s)
[t-SNE] Iteration 350: error = 0.4933656, gradient norm = 0.0052189 (50 iterations in 0.021s)
[t-SNE] Iteration 400: error = 0.4888707, gradient norm = 0.0002190 (50 iterations in 0.021s)
[t-SNE] Iteration 450: error = 0.4891327, gradient norm = 0.0002453 (50 iterations in 0.023s)
[t-SNE] Iteration 500: error = 0.4888999, gradient norm = 0.0002042 (50 iterations in 0.023s)
[t-SNE] Iteration 550: error = 0.4890774, gradient norm = 0.0002114 (50 iterations in 0.024s)
[t-SNE] Iteration 600: error = 0.4889210, gradient norm = 0.0001871 (50 iterations in 0.023s)
[t-SNE] Iteration 650: error = 0.4889407, gradient norm = 0.0003154 (50 iterations in 0.022s)
[t-SNE] Iteration 700: error = 0.4890394, gradient norm = 0.0001550 (50 iterations in 0.022s)
[t-SNE] Iteration 750: error = 0.4890719, gradient norm = 0.0001892 (50 iterations in 0.022s)
[t-SNE] Iteration 750: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 750 iterations: 0.489072
[t-SNE] Computed conditional probabilities for sample 139 / 139
[t-SNE] Mean sigma: 0.415744
Beginning preprocessing + Leiden
2024-03-16 18:20:36.250526 MEMORY 16.963067904
Affmat transformed
2024-03-16 18:20:36.252377 MEMORY 16.963067904
sources, targets, weights extracted
2024-03-16 18:20:36.253138 MEMORY 16.963067904
About to launch parallel Leiden runs
2024-03-16 18:20:36.257873 MEMORY 16.963067904
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.0s finished
Parallel Leiden runs finished
2024-03-16 18:20:38.292862 MEMORY 16.963067904
Quality: 0.28589846363865823
Quality: 0.29090592068592624
Quality: 0.29105449766049774
Quality: 0.29124380759094975
Quality: 0.29147135414291697
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  84 out of 131 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=24)]: Done 131 out of 131 | elapsed:    0.0s finished
Got subclusters: Counter({0: 42, 1: 33, 2: 31, 3: 21, 4: 12})
On pattern 13
[t-SNE] Computing 130 nearest neighbors...
[t-SNE] Indexed 131 samples in 0.001s...
[t-SNE] Computed neighbors for 131 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 131 / 131
[t-SNE] Mean sigma: 0.492393
[t-SNE] Computed conditional probabilities in 0.008s
[t-SNE] Iteration 50: error = 55.5757523, gradient norm = 0.4662797 (50 iterations in 0.023s)
[t-SNE] Iteration 100: error = 55.5316544, gradient norm = 0.4783519 (50 iterations in 0.022s)
[t-SNE] Iteration 150: error = 55.7158546, gradient norm = 0.4715840 (50 iterations in 0.021s)
[t-SNE] Iteration 200: error = 57.1307297, gradient norm = 0.5061401 (50 iterations in 0.024s)
[t-SNE] Iteration 250: error = 55.6406746, gradient norm = 0.5013441 (50 iterations in 0.023s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 55.640675
[t-SNE] Iteration 300: error = 0.7166438, gradient norm = 0.0118028 (50 iterations in 0.023s)
[t-SNE] Iteration 350: error = 0.4799815, gradient norm = 0.0021527 (50 iterations in 0.023s)
[t-SNE] Iteration 400: error = 0.4602860, gradient norm = 0.0010985 (50 iterations in 0.022s)
[t-SNE] Iteration 450: error = 0.4590542, gradient norm = 0.0003811 (50 iterations in 0.022s)
[t-SNE] Iteration 500: error = 0.4588576, gradient norm = 0.0002600 (50 iterations in 0.020s)
[t-SNE] Iteration 550: error = 0.4589006, gradient norm = 0.0002949 (50 iterations in 0.023s)
[t-SNE] Iteration 600: error = 0.4588427, gradient norm = 0.0002989 (50 iterations in 0.022s)
[t-SNE] Iteration 650: error = 0.4586547, gradient norm = 0.0002440 (50 iterations in 0.024s)
[t-SNE] Iteration 700: error = 0.4590236, gradient norm = 0.0002611 (50 iterations in 0.023s)
[t-SNE] Iteration 750: error = 0.4588870, gradient norm = 0.0003659 (50 iterations in 0.023s)
[t-SNE] Iteration 800: error = 0.4588636, gradient norm = 0.0003502 (50 iterations in 0.022s)
[t-SNE] Iteration 850: error = 0.4588859, gradient norm = 0.0003248 (50 iterations in 0.023s)
[t-SNE] Iteration 900: error = 0.4588800, gradient norm = 0.0002657 (50 iterations in 0.022s)
[t-SNE] Iteration 950: error = 0.4587485, gradient norm = 0.0002946 (50 iterations in 0.021s)
[t-SNE] Iteration 1000: error = 0.4588328, gradient norm = 0.0003546 (50 iterations in 0.022s)
[t-SNE] Iteration 1000: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 1000 iterations: 0.458833
[t-SNE] Computed conditional probabilities for sample 131 / 131
[t-SNE] Mean sigma: 0.492394
Beginning preprocessing + Leiden
2024-03-16 18:20:38.953747 MEMORY 16.963067904
Affmat transformed
2024-03-16 18:20:38.955407 MEMORY 16.963067904
sources, targets, weights extracted
2024-03-16 18:20:38.956036 MEMORY 16.963067904
About to launch parallel Leiden runs
2024-03-16 18:20:38.960549 MEMORY 16.963067904
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.8s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.1s finished
Parallel Leiden runs finished
2024-03-16 18:20:41.040525 MEMORY 16.963067904
Quality: 0.2511387540046543
Quality: 0.25352687599129897
Quality: 0.2538852377176394
Quality: 0.25493049580271465
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 130 out of 130 | elapsed:    0.1s finished
Got subclusters: Counter({0: 38, 1: 33, 2: 24, 3: 20, 4: 16})
On pattern 14
[t-SNE] Computing 129 nearest neighbors...
[t-SNE] Indexed 130 samples in 0.001s...
[t-SNE] Computed neighbors for 130 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 130 / 130
[t-SNE] Mean sigma: 0.463111
[t-SNE] Computed conditional probabilities in 0.007s
[t-SNE] Iteration 50: error = 56.3684158, gradient norm = 0.4877907 (50 iterations in 0.022s)
[t-SNE] Iteration 100: error = 55.1233215, gradient norm = 0.5357621 (50 iterations in 0.023s)
[t-SNE] Iteration 150: error = 56.7485123, gradient norm = 0.5428076 (50 iterations in 0.024s)
[t-SNE] Iteration 200: error = 53.9602737, gradient norm = 0.5080228 (50 iterations in 0.023s)
[t-SNE] Iteration 250: error = 55.8592262, gradient norm = 0.5313902 (50 iterations in 0.023s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 55.859226
[t-SNE] Iteration 300: error = 0.7070579, gradient norm = 0.0160389 (50 iterations in 0.022s)
[t-SNE] Iteration 350: error = 0.4721964, gradient norm = 0.0027228 (50 iterations in 0.023s)
[t-SNE] Iteration 400: error = 0.4704509, gradient norm = 0.0003225 (50 iterations in 0.021s)
[t-SNE] Iteration 450: error = 0.4701456, gradient norm = 0.0002081 (50 iterations in 0.021s)
[t-SNE] Iteration 500: error = 0.4700883, gradient norm = 0.0002290 (50 iterations in 0.020s)
[t-SNE] Iteration 550: error = 0.4700988, gradient norm = 0.0003117 (50 iterations in 0.021s)
[t-SNE] Iteration 600: error = 0.4701385, gradient norm = 0.0002528 (50 iterations in 0.026s)
[t-SNE] Iteration 650: error = 0.4701388, gradient norm = 0.0003441 (50 iterations in 0.022s)
[t-SNE] Iteration 700: error = 0.4700980, gradient norm = 0.0003447 (50 iterations in 0.021s)
[t-SNE] Iteration 750: error = 0.4701558, gradient norm = 0.0003181 (50 iterations in 0.021s)
[t-SNE] Iteration 800: error = 0.4700666, gradient norm = 0.0003741 (50 iterations in 0.020s)
[t-SNE] Iteration 850: error = 0.4701201, gradient norm = 0.0002315 (50 iterations in 0.020s)
[t-SNE] Iteration 900: error = 0.4702119, gradient norm = 0.0002970 (50 iterations in 0.021s)
[t-SNE] Iteration 950: error = 0.4701734, gradient norm = 0.0002119 (50 iterations in 0.021s)
[t-SNE] Iteration 1000: error = 0.4701716, gradient norm = 0.0002471 (50 iterations in 0.021s)
[t-SNE] KL divergence after 1000 iterations: 0.470172
[t-SNE] Computed conditional probabilities for sample 130 / 130
[t-SNE] Mean sigma: 0.463111
Beginning preprocessing + Leiden
2024-03-16 18:20:41.688611 MEMORY 16.963067904
Affmat transformed
2024-03-16 18:20:41.690526 MEMORY 16.963067904
sources, targets, weights extracted
2024-03-16 18:20:41.691216 MEMORY 16.963067904
About to launch parallel Leiden runs
2024-03-16 18:20:41.695496 MEMORY 16.963067904
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.0s finished
Parallel Leiden runs finished
2024-03-16 18:20:43.702236 MEMORY 16.963067904
Quality: 0.2586856464577098
Quality: 0.2669052628009613
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  68 out of 115 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=24)]: Done 115 out of 115 | elapsed:    0.0s finished
Got subclusters: Counter({0: 45, 1: 31, 2: 30, 3: 24})
On pattern 15
[t-SNE] Computing 114 nearest neighbors...
[t-SNE] Indexed 115 samples in 0.001s...
[t-SNE] Computed neighbors for 115 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 115 / 115
[t-SNE] Mean sigma: 0.537244
[t-SNE] Computed conditional probabilities in 0.006s
[t-SNE] Iteration 50: error = 54.8446159, gradient norm = 0.5408774 (50 iterations in 0.031s)
[t-SNE] Iteration 100: error = 51.8562584, gradient norm = 0.5150045 (50 iterations in 0.019s)
[t-SNE] Iteration 150: error = 53.3997498, gradient norm = 0.5188254 (50 iterations in 0.021s)
[t-SNE] Iteration 200: error = 52.4082794, gradient norm = 0.5188957 (50 iterations in 0.019s)
[t-SNE] Iteration 250: error = 51.8881454, gradient norm = 0.5251719 (50 iterations in 0.022s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 51.888145
[t-SNE] Iteration 300: error = 0.5936485, gradient norm = 0.0137289 (50 iterations in 0.022s)
[t-SNE] Iteration 350: error = 0.4294118, gradient norm = 0.0034411 (50 iterations in 0.019s)
[t-SNE] Iteration 400: error = 0.4165460, gradient norm = 0.0005656 (50 iterations in 0.020s)
[t-SNE] Iteration 450: error = 0.4165305, gradient norm = 0.0003782 (50 iterations in 0.018s)
[t-SNE] Iteration 500: error = 0.4166600, gradient norm = 0.0004860 (50 iterations in 0.020s)
[t-SNE] Iteration 550: error = 0.4165948, gradient norm = 0.0004639 (50 iterations in 0.019s)
[t-SNE] Iteration 600: error = 0.4166783, gradient norm = 0.0005774 (50 iterations in 0.019s)
[t-SNE] Iteration 650: error = 0.4162700, gradient norm = 0.0004307 (50 iterations in 0.020s)
[t-SNE] Iteration 700: error = 0.4164573, gradient norm = 0.0004434 (50 iterations in 0.020s)
[t-SNE] Iteration 750: error = 0.4166102, gradient norm = 0.0004563 (50 iterations in 0.019s)
[t-SNE] Iteration 800: error = 0.4166101, gradient norm = 0.0004576 (50 iterations in 0.020s)
[t-SNE] Iteration 850: error = 0.4166616, gradient norm = 0.0003649 (50 iterations in 0.020s)
[t-SNE] Iteration 900: error = 0.4165894, gradient norm = 0.0003809 (50 iterations in 0.020s)
[t-SNE] Iteration 950: error = 0.4164017, gradient norm = 0.0005250 (50 iterations in 0.019s)
[t-SNE] Iteration 1000: error = 0.4164746, gradient norm = 0.0005808 (50 iterations in 0.019s)
[t-SNE] Iteration 1000: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 1000 iterations: 0.416475
[t-SNE] Computed conditional probabilities for sample 115 / 115
[t-SNE] Mean sigma: 0.537244
Beginning preprocessing + Leiden
2024-03-16 18:20:44.280660 MEMORY 16.963067904
Affmat transformed
2024-03-16 18:20:44.282088 MEMORY 16.963067904
sources, targets, weights extracted
2024-03-16 18:20:44.282695 MEMORY 16.963067904
About to launch parallel Leiden runs
2024-03-16 18:20:44.286979 MEMORY 16.963067904
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.9s finished
Parallel Leiden runs finished
2024-03-16 18:20:46.160502 MEMORY 16.963067904
Quality: 0.2368011478234093
Quality: 0.2368567116730949
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  66 out of 113 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=24)]: Done 113 out of 113 | elapsed:    0.0s finished
Got subclusters: Counter({0: 32, 1: 32, 2: 22, 3: 22, 4: 7})
On pattern 16
[t-SNE] Computing 112 nearest neighbors...
[t-SNE] Indexed 113 samples in 0.001s...
[t-SNE] Computed neighbors for 113 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 113 / 113
[t-SNE] Mean sigma: 0.574391
[t-SNE] Computed conditional probabilities in 0.006s
[t-SNE] Iteration 50: error = 49.7080460, gradient norm = 0.5736809 (50 iterations in 0.018s)
[t-SNE] Iteration 100: error = 53.1720963, gradient norm = 0.5158082 (50 iterations in 0.020s)
[t-SNE] Iteration 150: error = 50.9003754, gradient norm = 0.6357403 (50 iterations in 0.020s)
[t-SNE] Iteration 200: error = 52.3404236, gradient norm = 0.4960032 (50 iterations in 0.020s)
[t-SNE] Iteration 250: error = 53.5631104, gradient norm = 0.4824966 (50 iterations in 0.019s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 53.563110
[t-SNE] Iteration 300: error = 0.7477158, gradient norm = 0.0104552 (50 iterations in 0.019s)
[t-SNE] Iteration 350: error = 0.4123623, gradient norm = 0.0031034 (50 iterations in 0.020s)
[t-SNE] Iteration 400: error = 0.4104715, gradient norm = 0.0004262 (50 iterations in 0.020s)
[t-SNE] Iteration 450: error = 0.4105171, gradient norm = 0.0003712 (50 iterations in 0.019s)
[t-SNE] Iteration 500: error = 0.4105539, gradient norm = 0.0003378 (50 iterations in 0.020s)
[t-SNE] Iteration 550: error = 0.4106403, gradient norm = 0.0002110 (50 iterations in 0.020s)
[t-SNE] Iteration 600: error = 0.4105278, gradient norm = 0.0002486 (50 iterations in 0.020s)
[t-SNE] Iteration 650: error = 0.4105071, gradient norm = 0.0002853 (50 iterations in 0.020s)
[t-SNE] Iteration 700: error = 0.4106158, gradient norm = 0.0004288 (50 iterations in 0.019s)
[t-SNE] Iteration 750: error = 0.4105305, gradient norm = 0.0002923 (50 iterations in 0.020s)
[t-SNE] Iteration 750: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 750 iterations: 0.410531
[t-SNE] Computed conditional probabilities for sample 113 / 113
[t-SNE] Mean sigma: 0.574391
Beginning preprocessing + Leiden
2024-03-16 18:20:46.613638 MEMORY 16.963067904
Affmat transformed
2024-03-16 18:20:46.615092 MEMORY 16.963067904
sources, targets, weights extracted
2024-03-16 18:20:46.615677 MEMORY 16.963067904
About to launch parallel Leiden runs
2024-03-16 18:20:46.620119 MEMORY 16.963067904
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.9s finished
Parallel Leiden runs finished
2024-03-16 18:20:48.537962 MEMORY 16.963067904
Quality: 0.23951581033636957
Quality: 0.24110183124474777
Quality: 0.24147637665491264
Quality: 0.24150861591908016
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  83 out of  83 | elapsed:    0.0s finished
Got subclusters: Counter({0: 35, 1: 28, 2: 27, 3: 23})
On pattern 17
[t-SNE] Computing 82 nearest neighbors...
[t-SNE] Indexed 83 samples in 0.001s...
[t-SNE] Computed neighbors for 83 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 83 / 83
[t-SNE] Mean sigma: 0.595545
[t-SNE] Computed conditional probabilities in 0.003s
[t-SNE] Iteration 50: error = 49.4974670, gradient norm = 0.6404022 (50 iterations in 0.039s)
[t-SNE] Iteration 100: error = 46.6975021, gradient norm = 0.5894336 (50 iterations in 0.015s)
[t-SNE] Iteration 150: error = 47.6202660, gradient norm = 0.6350938 (50 iterations in 0.015s)
[t-SNE] Iteration 200: error = 47.9024734, gradient norm = 0.6116238 (50 iterations in 0.015s)
[t-SNE] Iteration 250: error = 51.5525856, gradient norm = 0.5946695 (50 iterations in 0.016s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 51.552586
[t-SNE] Iteration 300: error = 0.8783817, gradient norm = 0.0036155 (50 iterations in 0.017s)
[t-SNE] Iteration 350: error = 0.7126178, gradient norm = 0.0062983 (50 iterations in 0.015s)
[t-SNE] Iteration 400: error = 0.2602921, gradient norm = 0.0127838 (50 iterations in 0.015s)
[t-SNE] Iteration 450: error = 0.2480254, gradient norm = 0.0015440 (50 iterations in 0.016s)
[t-SNE] Iteration 500: error = 0.2479649, gradient norm = 0.0005421 (50 iterations in 0.015s)
[t-SNE] Iteration 550: error = 0.2480344, gradient norm = 0.0005448 (50 iterations in 0.015s)
[t-SNE] Iteration 600: error = 0.2480267, gradient norm = 0.0003911 (50 iterations in 0.014s)
[t-SNE] Iteration 650: error = 0.2479945, gradient norm = 0.0005276 (50 iterations in 0.015s)
[t-SNE] Iteration 700: error = 0.2479466, gradient norm = 0.0004672 (50 iterations in 0.016s)
[t-SNE] Iteration 750: error = 0.2480574, gradient norm = 0.0004398 (50 iterations in 0.019s)
[t-SNE] Iteration 800: error = 0.2479049, gradient norm = 0.0004103 (50 iterations in 0.016s)
[t-SNE] Iteration 850: error = 0.2479924, gradient norm = 0.0004707 (50 iterations in 0.016s)
[t-SNE] Iteration 900: error = 0.2479223, gradient norm = 0.0004736 (50 iterations in 0.016s)
[t-SNE] Iteration 950: error = 0.2479339, gradient norm = 0.0005270 (50 iterations in 0.015s)
[t-SNE] Iteration 1000: error = 0.2478994, gradient norm = 0.0006094 (50 iterations in 0.016s)
[t-SNE] KL divergence after 1000 iterations: 0.247899
[t-SNE] Computed conditional probabilities for sample 83 / 83
[t-SNE] Mean sigma: 0.595545
Beginning preprocessing + Leiden
2024-03-16 18:20:48.995298 MEMORY 16.963067904
Affmat transformed
2024-03-16 18:20:48.996410 MEMORY 16.963067904
sources, targets, weights extracted
2024-03-16 18:20:48.996842 MEMORY 16.963067904
About to launch parallel Leiden runs
2024-03-16 18:20:49.001000 MEMORY 16.963067904
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.6s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.8s finished
Parallel Leiden runs finished
2024-03-16 18:20:50.806702 MEMORY 16.963067904
Quality: 0.16046594743932022
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  79 out of  79 | elapsed:    0.0s finished
Got subclusters: Counter({0: 30, 1: 26, 2: 14, 3: 13})
On pattern 18
[t-SNE] Computing 78 nearest neighbors...
[t-SNE] Indexed 79 samples in 0.001s...
[t-SNE] Computed neighbors for 79 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 79 / 79
[t-SNE] Mean sigma: 0.638143
[t-SNE] Computed conditional probabilities in 0.003s
[t-SNE] Iteration 50: error = 50.2227364, gradient norm = 0.5471659 (50 iterations in 0.019s)
[t-SNE] Iteration 100: error = 54.4908829, gradient norm = 0.5333918 (50 iterations in 0.015s)
[t-SNE] Iteration 150: error = 49.4774857, gradient norm = 0.5654467 (50 iterations in 0.016s)
[t-SNE] Iteration 200: error = 50.6863823, gradient norm = 0.4228082 (50 iterations in 0.014s)
[t-SNE] Iteration 250: error = 50.2546539, gradient norm = 0.6626234 (50 iterations in 0.015s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 50.254654
[t-SNE] Iteration 300: error = 0.9065565, gradient norm = 0.0027847 (50 iterations in 0.017s)
[t-SNE] Iteration 350: error = 0.7519332, gradient norm = 0.0019677 (50 iterations in 0.016s)
[t-SNE] Iteration 400: error = 0.6916555, gradient norm = 0.0008927 (50 iterations in 0.015s)
[t-SNE] Iteration 450: error = 0.6647444, gradient norm = 0.0005391 (50 iterations in 0.017s)
[t-SNE] Iteration 500: error = 0.6501014, gradient norm = 0.0006180 (50 iterations in 0.018s)
[t-SNE] Iteration 550: error = 0.6162519, gradient norm = 0.0017533 (50 iterations in 0.017s)
[t-SNE] Iteration 600: error = 0.3483108, gradient norm = 0.0311554 (50 iterations in 0.015s)
[t-SNE] Iteration 650: error = 0.2105475, gradient norm = 0.0064773 (50 iterations in 0.015s)
[t-SNE] Iteration 700: error = 0.2096094, gradient norm = 0.0011122 (50 iterations in 0.015s)
[t-SNE] Iteration 750: error = 0.2094807, gradient norm = 0.0006768 (50 iterations in 0.017s)
[t-SNE] Iteration 800: error = 0.2094900, gradient norm = 0.0004787 (50 iterations in 0.017s)
[t-SNE] Iteration 850: error = 0.2096195, gradient norm = 0.0004926 (50 iterations in 0.014s)
[t-SNE] Iteration 900: error = 0.2094649, gradient norm = 0.0004264 (50 iterations in 0.016s)
[t-SNE] Iteration 950: error = 0.2095505, gradient norm = 0.0004636 (50 iterations in 0.015s)
[t-SNE] Iteration 1000: error = 0.2095373, gradient norm = 0.0005022 (50 iterations in 0.020s)
[t-SNE] KL divergence after 1000 iterations: 0.209537
[t-SNE] Computed conditional probabilities for sample 79 / 79
[t-SNE] Mean sigma: 0.638143
Beginning preprocessing + Leiden
2024-03-16 18:20:51.235069 MEMORY 16.963067904
Affmat transformed
2024-03-16 18:20:51.236015 MEMORY 16.963067904
sources, targets, weights extracted
2024-03-16 18:20:51.236407 MEMORY 16.963067904
About to launch parallel Leiden runs
2024-03-16 18:20:51.241321 MEMORY 16.963067904
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.6s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.8s finished
Parallel Leiden runs finished
2024-03-16 18:20:53.020159 MEMORY 16.963067904
Quality: 0.14926262483700786
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  65 out of  65 | elapsed:    0.0s finished
Got subclusters: Counter({0: 27, 1: 27, 2: 25})
On pattern 19
[t-SNE] Computing 64 nearest neighbors...
[t-SNE] Indexed 65 samples in 0.001s...
[t-SNE] Computed neighbors for 65 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 65 / 65
[t-SNE] Mean sigma: 0.701373
[t-SNE] Computed conditional probabilities in 0.002s
[t-SNE] Iteration 50: error = 46.6137352, gradient norm = 0.5795742 (50 iterations in 0.016s)
[t-SNE] Iteration 100: error = 46.5689354, gradient norm = 0.5273883 (50 iterations in 0.015s)
[t-SNE] Iteration 150: error = 47.7980232, gradient norm = 0.6030645 (50 iterations in 0.014s)
[t-SNE] Iteration 200: error = 47.3207779, gradient norm = 0.4470645 (50 iterations in 0.013s)
[t-SNE] Iteration 250: error = 46.1030807, gradient norm = 0.4288584 (50 iterations in 0.015s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 46.103081
[t-SNE] Iteration 300: error = 0.7653380, gradient norm = 0.0014969 (50 iterations in 0.014s)
[t-SNE] Iteration 350: error = 0.7074837, gradient norm = 0.0009566 (50 iterations in 0.013s)
[t-SNE] Iteration 400: error = 0.6636267, gradient norm = 0.0008817 (50 iterations in 0.014s)
[t-SNE] Iteration 450: error = 0.5952372, gradient norm = 0.0011597 (50 iterations in 0.014s)
[t-SNE] Iteration 500: error = 0.5458330, gradient norm = 0.0010375 (50 iterations in 0.014s)
[t-SNE] Iteration 550: error = 0.9457115, gradient norm = 0.0549986 (50 iterations in 0.012s)
[t-SNE] Iteration 600: error = 0.7006798, gradient norm = 0.0012055 (50 iterations in 0.013s)
[t-SNE] Iteration 650: error = 0.6038936, gradient norm = 0.0010418 (50 iterations in 0.014s)
[t-SNE] Iteration 700: error = 0.5486802, gradient norm = 0.0006521 (50 iterations in 0.013s)
[t-SNE] Iteration 750: error = 0.5229288, gradient norm = 0.0004169 (50 iterations in 0.012s)
[t-SNE] Iteration 800: error = 0.4953589, gradient norm = 0.0005198 (50 iterations in 0.017s)
[t-SNE] Iteration 850: error = 0.4830307, gradient norm = 0.0003304 (50 iterations in 0.012s)
[t-SNE] Iteration 900: error = 0.4771010, gradient norm = 0.0002036 (50 iterations in 0.013s)
[t-SNE] Iteration 950: error = 0.4739279, gradient norm = 0.0001618 (50 iterations in 0.013s)
[t-SNE] Iteration 1000: error = 0.4683432, gradient norm = 0.0003244 (50 iterations in 0.013s)
[t-SNE] KL divergence after 1000 iterations: 0.468343
[t-SNE] Computed conditional probabilities for sample 65 / 65
[t-SNE] Mean sigma: 0.701373
Beginning preprocessing + Leiden
2024-03-16 18:20:53.375390 MEMORY 16.963067904
Affmat transformed
2024-03-16 18:20:53.376297 MEMORY 16.963067904
sources, targets, weights extracted
2024-03-16 18:20:53.376659 MEMORY 16.963067904
About to launch parallel Leiden runs
2024-03-16 18:20:53.381225 MEMORY 16.963067904
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.6s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.8s finished
Parallel Leiden runs finished
2024-03-16 18:20:55.155082 MEMORY 16.963067904
Quality: 0.1302518035328434
Quality: 0.1309344301438165
Quality: 0.13101329700909056
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done  24 out of  35 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=24)]: Done  35 out of  35 | elapsed:    0.0s finished
Got subclusters: Counter({0: 28, 1: 24, 2: 13})
On pattern 20
[t-SNE] Computing 34 nearest neighbors...
[t-SNE] Indexed 35 samples in 0.000s...
[t-SNE] Computed neighbors for 35 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 35 / 35
[t-SNE] Mean sigma: 15.943162
[t-SNE] Computed conditional probabilities in 0.001s
[t-SNE] Iteration 50: error = 42.1677971, gradient norm = 0.4145909 (50 iterations in 0.011s)
[t-SNE] Iteration 100: error = 44.6377716, gradient norm = 0.4571347 (50 iterations in 0.013s)
[t-SNE] Iteration 150: error = 45.9984055, gradient norm = 0.4940209 (50 iterations in 0.011s)
[t-SNE] Iteration 200: error = 45.7098808, gradient norm = 0.5351675 (50 iterations in 0.012s)
[t-SNE] Iteration 250: error = 44.3188896, gradient norm = 0.3566445 (50 iterations in 0.011s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 44.318890
[t-SNE] Iteration 300: error = 0.5779050, gradient norm = 0.0009215 (50 iterations in 0.013s)
[t-SNE] Iteration 350: error = 0.5386596, gradient norm = 0.0000937 (50 iterations in 0.011s)
[t-SNE] Iteration 400: error = 0.5373571, gradient norm = 0.0000765 (50 iterations in 0.013s)
[t-SNE] Iteration 450: error = 0.5336821, gradient norm = 0.0000338 (50 iterations in 0.010s)
[t-SNE] Iteration 500: error = 0.5335882, gradient norm = 0.0000248 (50 iterations in 0.016s)
[t-SNE] Iteration 550: error = 0.5330772, gradient norm = 0.0000334 (50 iterations in 0.012s)
[t-SNE] Iteration 600: error = 0.5319366, gradient norm = 0.0000763 (50 iterations in 0.010s)
[t-SNE] Iteration 650: error = 0.5324764, gradient norm = 0.0000420 (50 iterations in 0.011s)
[t-SNE] Iteration 700: error = 0.5318486, gradient norm = 0.0000546 (50 iterations in 0.010s)
[t-SNE] Iteration 750: error = 0.5313138, gradient norm = 0.0000558 (50 iterations in 0.010s)
[t-SNE] Iteration 800: error = 0.5312761, gradient norm = 0.0000617 (50 iterations in 0.012s)
[t-SNE] Iteration 850: error = 0.5294340, gradient norm = 0.0004688 (50 iterations in 0.010s)
[t-SNE] Iteration 900: error = 1.1712961, gradient norm = 0.0249574 (50 iterations in 0.011s)
[t-SNE] Iteration 950: error = 0.6184499, gradient norm = 0.0007654 (50 iterations in 0.010s)
[t-SNE] Iteration 1000: error = 0.5468905, gradient norm = 0.0001841 (50 iterations in 0.011s)
[t-SNE] KL divergence after 1000 iterations: 0.546890
[t-SNE] Computed conditional probabilities for sample 35 / 35
[t-SNE] Mean sigma: 1125899906842624.000000
Beginning preprocessing + Leiden
2024-03-16 18:20:55.432416 MEMORY 16.963067904
Affmat transformed
2024-03-16 18:20:55.433108 MEMORY 16.963067904
sources, targets, weights extracted
2024-03-16 18:20:55.433410 MEMORY 16.963067904
About to launch parallel Leiden runs
2024-03-16 18:20:55.437095 MEMORY 16.963067904
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.6s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.7s finished
Parallel Leiden runs finished
2024-03-16 18:20:57.131815 MEMORY 16.963067904
Quality: 2.2204460492503205e-16
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done  14 out of  30 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=24)]: Done  30 out of  30 | elapsed:    0.0s finished
Got subclusters: Counter({0: 35})
On pattern 21
[t-SNE] Computing 29 nearest neighbors...
[t-SNE] Indexed 30 samples in 0.000s...
[t-SNE] Computed neighbors for 30 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 30 / 30
[t-SNE] Mean sigma: 12.583740
[t-SNE] Computed conditional probabilities in 0.001s
[t-SNE] Iteration 50: error = 46.8697243, gradient norm = 0.6621277 (50 iterations in 0.010s)
[t-SNE] Iteration 100: error = 45.5083885, gradient norm = 0.7004819 (50 iterations in 0.011s)
[t-SNE] Iteration 150: error = 47.3453636, gradient norm = 0.4412757 (50 iterations in 0.010s)
[t-SNE] Iteration 200: error = 43.4333534, gradient norm = 0.7316396 (50 iterations in 0.010s)
[t-SNE] Iteration 250: error = 42.2965889, gradient norm = 0.3855391 (50 iterations in 0.011s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 42.296589
[t-SNE] Iteration 300: error = 0.6784528, gradient norm = 0.0010997 (50 iterations in 0.010s)
[t-SNE] Iteration 350: error = 0.5410193, gradient norm = 0.0003714 (50 iterations in 0.012s)
[t-SNE] Iteration 400: error = 0.5156932, gradient norm = 0.0001161 (50 iterations in 0.011s)
[t-SNE] Iteration 450: error = 0.5076287, gradient norm = 0.0000774 (50 iterations in 0.010s)
[t-SNE] Iteration 500: error = 0.5046417, gradient norm = 0.0000657 (50 iterations in 0.011s)
[t-SNE] Iteration 550: error = 0.5026491, gradient norm = 0.0000335 (50 iterations in 0.012s)
[t-SNE] Iteration 600: error = 0.5015569, gradient norm = 0.0000262 (50 iterations in 0.011s)
[t-SNE] Iteration 650: error = 0.5008529, gradient norm = 0.0000407 (50 iterations in 0.011s)
[t-SNE] Iteration 700: error = 0.4992796, gradient norm = 0.0000216 (50 iterations in 0.010s)
[t-SNE] Iteration 750: error = 0.4990054, gradient norm = 0.0000155 (50 iterations in 0.010s)
[t-SNE] Iteration 800: error = 0.4987670, gradient norm = 0.0000130 (50 iterations in 0.011s)
[t-SNE] Iteration 850: error = 0.4985479, gradient norm = 0.0000113 (50 iterations in 0.011s)
[t-SNE] Iteration 900: error = 0.4985242, gradient norm = 0.0000106 (50 iterations in 0.011s)
[t-SNE] Iteration 950: error = 0.4984934, gradient norm = 0.0000127 (50 iterations in 0.011s)
[t-SNE] Iteration 1000: error = 0.4984941, gradient norm = 0.0000127 (50 iterations in 0.010s)
[t-SNE] KL divergence after 1000 iterations: 0.498494
[t-SNE] Computed conditional probabilities for sample 30 / 30
[t-SNE] Mean sigma: 1125899906842624.000000
Beginning preprocessing + Leiden
2024-03-16 18:20:57.384334 MEMORY 16.963067904
Affmat transformed
2024-03-16 18:20:57.385035 MEMORY 16.963067904
sources, targets, weights extracted
2024-03-16 18:20:57.385329 MEMORY 16.963067904
About to launch parallel Leiden runs
2024-03-16 18:20:57.388967 MEMORY 16.963067904
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.6s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.7s finished
Parallel Leiden runs finished
2024-03-16 18:20:59.117406 MEMORY 16.963067904
Quality: 1.9095836023552904e-14
Got subclusters: Counter({0: 30})
On metacluster 3
Metacluster size 11868
Relevant tasks:  ('head',)
Relevant signs:  (-1,)
TfModiscoSeqletsToPatternsFactory: seed=1234
(Round 1) num seqlets: 11868
(Round 1) Computing coarse affmat
2024-03-16 18:21:02.286879 MEMORY 16.963072
Beginning embedding computation
MEMORY 16.963072
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 152 tasks      | elapsed:    1.9s
[Parallel(n_jobs=24)]: Done 402 tasks      | elapsed:    4.7s
[Parallel(n_jobs=24)]: Done 752 tasks      | elapsed:    8.5s
[Parallel(n_jobs=24)]: Done 1202 tasks      | elapsed:   13.4s
[Parallel(n_jobs=24)]: Done 1752 tasks      | elapsed:   19.3s
[Parallel(n_jobs=24)]: Done 2402 tasks      | elapsed:   26.3s
[Parallel(n_jobs=24)]: Done 3152 tasks      | elapsed:   36.1s
[Parallel(n_jobs=24)]: Done 4002 tasks      | elapsed:   47.0s
[Parallel(n_jobs=24)]: Done 4952 tasks      | elapsed:   59.5s
[Parallel(n_jobs=24)]: Done 6002 tasks      | elapsed:  1.2min
[Parallel(n_jobs=24)]: Done 7152 tasks      | elapsed:  1.5min
[Parallel(n_jobs=24)]: Done 8402 tasks      | elapsed:  1.8min
[Parallel(n_jobs=24)]: Done 9752 tasks      | elapsed:  2.1min
[Parallel(n_jobs=24)]: Done 11202 tasks      | elapsed:  2.4min
[Parallel(n_jobs=24)]: Done 11868 out of 11868 | elapsed:  2.5min finished
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 152 tasks      | elapsed:    2.2s
[Parallel(n_jobs=24)]: Done 402 tasks      | elapsed:    5.5s
[Parallel(n_jobs=24)]: Done 752 tasks      | elapsed:   10.1s
[Parallel(n_jobs=24)]: Done 1202 tasks      | elapsed:   16.1s
[Parallel(n_jobs=24)]: Done 1752 tasks      | elapsed:   23.3s
[Parallel(n_jobs=24)]: Done 2402 tasks      | elapsed:   31.8s
[Parallel(n_jobs=24)]: Done 3152 tasks      | elapsed:   41.8s
[Parallel(n_jobs=24)]: Done 4002 tasks      | elapsed:   52.9s
[Parallel(n_jobs=24)]: Done 4952 tasks      | elapsed:  1.1min
[Parallel(n_jobs=24)]: Done 6002 tasks      | elapsed:  1.3min
[Parallel(n_jobs=24)]: Done 7152 tasks      | elapsed:  1.6min
[Parallel(n_jobs=24)]: Done 8402 tasks      | elapsed:  1.9min
[Parallel(n_jobs=24)]: Done 9752 tasks      | elapsed:  2.1min
[Parallel(n_jobs=24)]: Done 11202 tasks      | elapsed:  2.5min
[Parallel(n_jobs=24)]: Done 11868 out of 11868 | elapsed:  2.6min finished
At the beginning of embedding call
2024-03-16 18:21:02.287176 MEMORY 16.963072
before computing embeddings fwd
2024-03-16 18:21:02.299658 MEMORY 16.963072
after computing embeddings fwd
2024-03-16 18:23:33.428597 MEMORY 17.053126656
after computing embeddings rev
2024-03-16 18:26:10.478519 MEMORY 17.538142208
before computing sparse embeddings fwd
2024-03-16 18:26:10.478776 MEMORY 17.538142208
Constructing csr matrix...
csr matrix made in 1.467296838760376 s
after computing sparse embeddings fwd
2024-03-16 18:26:12.747667 MEMORY 17.640083456
before computing sparse embeddings rev
2024-03-16 18:26:12.747789 MEMORY 17.640083456
Constructing csr matrix...
csr matrix made in 1.4205050468444824 s
after computing sparse embeddings rev
2024-03-16 18:26:14.788866 MEMORY 17.810198528
Finished embedding computation in 315.0 s
MEMORY 17.397846016
Starting affinity matrix computations
MEMORY 17.397321728
Batching in slices of size 5654
  0%|          | 0/3 [00:00<?, ?it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 1/3 [00:09<00:18,  9.16s/it] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 2/3 [00:17<00:08,  8.91s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:20<00:00,  5.91s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:20<00:00,  6.75s/it]
Finished affinity matrix computations in 20.31 s
MEMORY 17.397469184
(Round 1) Computed coarse affmat
2024-03-16 18:26:39.296615 MEMORY 17.108283392
(Round 1) Computing affinity matrix on nearest neighbors
2024-03-16 18:26:39.296776 MEMORY 17.108283392
Launching nearest neighbors affmat calculation job
MEMORY 17.193033728
Parallel runs completed
MEMORY 17.195425792
Job completed in: 39.08 s
MEMORY 17.195278336
Launching nearest neighbors affmat calculation job
MEMORY 17.19296
Parallel runs completed
MEMORY 17.327013888
Job completed in: 39.07 s
MEMORY 17.327140864
(Round 1) Computed affinity matrix on nearest neighbors in 81.41 s
2024-03-16 18:28:00.713293 MEMORY 17.240158208
Filtered down to 11469 of 11868
(Round 1) Retained 11469 rows out of 11868 after filtering
2024-03-16 18:28:07.384026 MEMORY 17.240260608
(Round 1) Computing density adapted affmat
2024-03-16 18:28:11.211004 MEMORY 17.242206208
Symmetrizing nearest neighbors
Computing betas for density adaptation
Computing normalizing denominators
(Round 1) Computing clustering
2024-03-16 18:30:09.851926 MEMORY 17.661095936
Beginning preprocessing + Leiden
2024-03-16 18:30:09.872727 MEMORY 17.661095936
Affmat transformed
2024-03-16 18:30:09.872917 MEMORY 17.661095936
sources, targets, weights extracted
2024-03-16 18:30:10.349074 MEMORY 17.762816
About to launch parallel Leiden runs
2024-03-16 18:30:10.461897 MEMORY 17.661095936
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:  1.4min
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:  5.2min finished
Parallel Leiden runs finished
2024-03-16 18:35:23.724362 MEMORY 17.659244544
Quality: 0.36240984198475734
Quality: 0.36246776613813175
Quality: 0.36246805951611444
Quality: 0.36247846314835
Got 5 clusters after round 1
Counts:
{0: 2919, 1: 2677, 3: 1772, 2: 2380, 4: 1721}
2024-03-16 18:35:23.760915 MEMORY 17.55779072
(Round 1) Aggregating seqlets in each cluster
2024-03-16 18:35:23.761053 MEMORY 17.55779072
Aggregating for cluster 0 with 2919 seqlets
2024-03-16 18:35:23.770412 MEMORY 17.557794816
Skipped 11 due to duplicates
Trimming eliminated 0 seqlets out of 2908
Aggregating for cluster 1 with 2677 seqlets
2024-03-16 18:35:33.106402 MEMORY 17.557782528
Skipped 1 seqlets that went over sequence edge during flank expansion
Skipped 12 due to duplicates
Trimming eliminated 0 seqlets out of 2664
Aggregating for cluster 2 with 2380 seqlets
2024-03-16 18:35:40.305302 MEMORY 17.557782528
Skipped 8 due to duplicates
Trimming eliminated 0 seqlets out of 2372
Aggregating for cluster 3 with 1772 seqlets
2024-03-16 18:35:46.790296 MEMORY 17.557782528
Skipped 6 due to duplicates
Trimming eliminated 0 seqlets out of 1766
Aggregating for cluster 4 with 1721 seqlets
2024-03-16 18:35:51.197049 MEMORY 17.557782528
Skipped 5 due to duplicates
Trimming eliminated 0 seqlets out of 1716
(Round 2) num seqlets: 11420
(Round 2) Computing coarse affmat
2024-03-16 18:35:57.531698 MEMORY 17.557782528
Beginning embedding computation
MEMORY 17.557782528
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 368 tasks      | elapsed:    0.8s
[Parallel(n_jobs=24)]: Done 1368 tasks      | elapsed:    2.5s
[Parallel(n_jobs=24)]: Done 2768 tasks      | elapsed:    4.8s
[Parallel(n_jobs=24)]: Done 4568 tasks      | elapsed:    7.9s
[Parallel(n_jobs=24)]: Done 6768 tasks      | elapsed:   11.8s
[Parallel(n_jobs=24)]: Done 9368 tasks      | elapsed:   16.0s
[Parallel(n_jobs=24)]: Done 11420 out of 11420 | elapsed:   19.2s finished
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 368 tasks      | elapsed:    0.9s
[Parallel(n_jobs=24)]: Done 1368 tasks      | elapsed:    2.5s
[Parallel(n_jobs=24)]: Done 2768 tasks      | elapsed:    4.8s
[Parallel(n_jobs=24)]: Done 4568 tasks      | elapsed:    7.7s
[Parallel(n_jobs=24)]: Done 6768 tasks      | elapsed:   11.3s
[Parallel(n_jobs=24)]: Done 9368 tasks      | elapsed:   15.6s
[Parallel(n_jobs=24)]: Done 11373 out of 11420 | elapsed:   18.8s remaining:    0.1s
[Parallel(n_jobs=24)]: Done 11420 out of 11420 | elapsed:   18.8s finished
At the beginning of embedding call
2024-03-16 18:35:57.531977 MEMORY 17.557782528
before computing embeddings fwd
2024-03-16 18:35:57.540989 MEMORY 17.557782528
after computing embeddings fwd
2024-03-16 18:36:16.724862 MEMORY 17.857282048
after computing embeddings rev
2024-03-16 18:36:35.564792 MEMORY 18.292994048
before computing sparse embeddings fwd
2024-03-16 18:36:35.564896 MEMORY 18.292994048
Constructing csr matrix...
csr matrix made in 1.3671631813049316 s
after computing sparse embeddings fwd
2024-03-16 18:36:37.488324 MEMORY 18.464444416
before computing sparse embeddings rev
2024-03-16 18:36:37.488426 MEMORY 18.464444416
Constructing csr matrix...
csr matrix made in 1.318235158920288 s
after computing sparse embeddings rev
2024-03-16 18:36:39.246194 MEMORY 18.533126144
Finished embedding computation in 44.54 s
MEMORY 18.149085184
Starting affinity matrix computations
MEMORY 18.149085184
Batching in slices of size 5876
  0%|          | 0/2 [00:00<?, ?it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:11<00:11, 11.50s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:20<00:00, 10.12s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:20<00:00, 10.33s/it]
Finished affinity matrix computations in 20.72 s
MEMORY 18.149322752
(Round 2) Computed coarse affmat
2024-03-16 18:37:04.666074 MEMORY 17.909026816
(Round 2) Computing affinity matrix on nearest neighbors
2024-03-16 18:37:04.666240 MEMORY 17.909026816
Launching nearest neighbors affmat calculation job
MEMORY 17.909026816
Parallel runs completed
MEMORY 17.92671744
Job completed in: 20.61 s
MEMORY 17.924497408
Launching nearest neighbors affmat calculation job
MEMORY 17.92212992
Parallel runs completed
MEMORY 17.936805888
Job completed in: 20.05 s
MEMORY 17.934577664
(Round 2) Computed affinity matrix on nearest neighbors in 44.48 s
2024-03-16 18:37:49.147462 MEMORY 17.934405632
Not applying filtering for rounds above first round
2024-03-16 18:37:49.149137 MEMORY 17.934405632
(Round 2) Computing density adapted affmat
2024-03-16 18:37:53.228235 MEMORY 17.944539136
Symmetrizing nearest neighbors
Computing betas for density adaptation
Computing normalizing denominators
(Round 2) Computing clustering
2024-03-16 18:39:43.406123 MEMORY 18.315333632
Beginning preprocessing + Leiden
2024-03-16 18:39:43.432037 MEMORY 18.315333632
Affmat transformed
2024-03-16 18:39:43.432239 MEMORY 18.315333632
sources, targets, weights extracted
2024-03-16 18:39:43.856093 MEMORY 18.412146688
About to launch parallel Leiden runs
2024-03-16 18:39:43.969917 MEMORY 18.315321344
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:   42.9s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:  3.0min finished
Parallel Leiden runs finished
2024-03-16 18:42:44.945274 MEMORY 18.315321344
Quality: 0.5214172237069628
Quality: 0.5214174977442472
Quality: 0.5214179722111415
Got 6 clusters after round 2
Counts:
{1: 2093, 2: 1985, 0: 2126, 3: 1851, 5: 1608, 4: 1757}
2024-03-16 18:42:44.981203 MEMORY 18.2183936
(Round 2) Aggregating seqlets in each cluster
2024-03-16 18:42:44.981337 MEMORY 18.2183936
Aggregating for cluster 0 with 2126 seqlets
2024-03-16 18:42:44.990639 MEMORY 18.2183936
Skipped 4 due to duplicates
Trimming eliminated 0 seqlets out of 2122
Aggregating for cluster 1 with 2093 seqlets
2024-03-16 18:42:48.581051 MEMORY 18.218328064
Skipped 7 due to duplicates
Trimming eliminated 0 seqlets out of 2086
Aggregating for cluster 2 with 1985 seqlets
2024-03-16 18:42:55.008876 MEMORY 18.218319872
Skipped 2 due to duplicates
Trimming eliminated 0 seqlets out of 1983
Aggregating for cluster 3 with 1851 seqlets
2024-03-16 18:42:57.980854 MEMORY 18.218319872
Skipped 2 due to duplicates
Trimming eliminated 0 seqlets out of 1849
Aggregating for cluster 4 with 1757 seqlets
2024-03-16 18:43:00.832500 MEMORY 18.218319872
Skipped 1 due to duplicates
Trimming eliminated 0 seqlets out of 1756
Aggregating for cluster 5 with 1608 seqlets
2024-03-16 18:43:03.787033 MEMORY 18.218319872
Trimming eliminated 0 seqlets out of 1608
Got 6 clusters
Splitting into subclusters...
2024-03-16 18:43:06.422223 MEMORY 18.218319872
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 1812 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 2122 out of 2122 | elapsed:    0.4s finished
Inspecting pattern 0 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 2122
[t-SNE] Computed conditional probabilities for sample 2000 / 2122
[t-SNE] Computed conditional probabilities for sample 2122 / 2122
[t-SNE] Mean sigma: 0.261887
Beginning preprocessing + Leiden
2024-03-16 18:43:09.047175 MEMORY 18.218418176
Affmat transformed
2024-03-16 18:43:09.079683 MEMORY 18.21843456
sources, targets, weights extracted
2024-03-16 18:43:09.104656 MEMORY 18.21843456
About to launch parallel Leiden runs
2024-03-16 18:43:09.116965 MEMORY 18.21843456
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    7.5s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   25.6s finished
Parallel Leiden runs finished
2024-03-16 18:43:34.730732 MEMORY 18.21843456
Quality: 0.4648796256475016
Quality: 0.46746604522550955
Got subclusters: Counter({0: 480, 1: 404, 2: 279, 3: 220, 4: 220, 5: 217, 6: 161, 7: 141})
On merging iteration 1
Numbers for each pattern pre-subsample: [480, 404, 279, 220, 220, 217, 161, 141]
Numbers after subsampling: [300, 300, 279, 220, 220, 217, 161, 141]
Computing sims for pattern 0
Computed sims for pattern 0 in 2.251774311065674 s
Computing sims for pattern 1
Computed sims for pattern 1 in 2.3188695907592773 s
Computing sims for pattern 2
Computed sims for pattern 2 in 2.044823408126831 s
Computing sims for pattern 3
Computed sims for pattern 3 in 1.8944470882415771 s
Computing sims for pattern 4
Computed sims for pattern 4 in 1.9539546966552734 s
Computing sims for pattern 5
Computed sims for pattern 5 in 1.9973962306976318 s
Computing sims for pattern 6
Computed sims for pattern 6 in 3.6027774810791016 s
Computing sims for pattern 7
Computed sims for pattern 7 in 1.299595832824707 s
Cluster sizes
[480 404 279 220 220 217 161 141]
Cross-contamination matrix:
[[1.   0.49 0.84 0.71 0.19 0.8  0.76 0.58]
 [0.98 1.   0.96 0.95 0.51 0.98 0.93 0.84]
 [0.68 0.35 1.   0.74 0.17 0.67 0.52 0.5 ]
 [0.7  0.45 0.87 1.   0.26 0.75 0.73 0.63]
 [0.75 0.68 0.88 0.9  1.   0.89 0.74 0.85]
 [0.72 0.41 0.74 0.69 0.17 1.   0.64 0.64]
 [0.87 0.53 0.79 0.86 0.24 0.84 1.   0.67]
 [0.77 0.56 0.82 0.82 0.42 0.91 0.75 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.9  0.92 0.89 0.65 0.96 0.94 0.87]
 [0.9  1.   0.85 0.86 0.73 0.87 0.87 0.86]
 [0.92 0.85 1.   0.93 0.69 0.93 0.85 0.85]
 [0.89 0.86 0.93 1.   0.7  0.9  0.91 0.86]
 [0.65 0.73 0.69 0.7  1.   0.74 0.64 0.74]
 [0.96 0.87 0.93 0.9  0.74 1.   0.92 0.91]
 [0.94 0.87 0.85 0.91 0.64 0.92 1.   0.86]
 [0.87 0.86 0.85 0.86 0.74 0.91 0.86 1.  ]]
Collapsing 0 & 5 with crosscontam 0.7221917720991062 and sim 0.9581492734932268
Collapsing 0 & 6 with crosscontam 0.7568146685070163 and sim 0.9358516835298558
Collapsing 2 & 3 with crosscontam 0.7362882811943368 and sim 0.9287387567177242
Collapsing 2 & 5 with crosscontam 0.6682290760666005 and sim 0.9262160160551491
Collapsing 0 & 2 with crosscontam 0.6789221566242383 and sim 0.9202983845375649
Collapsing 5 & 6 with crosscontam 0.6424190161185053 and sim 0.9165728957567105
Collapsing 3 & 6 with crosscontam 0.734045956199747 and sim 0.9098093596435264
Collapsing 5 & 7 with crosscontam 0.6396911614117027 and sim 0.909210794788473
Collapsing 0 & 1 with crosscontam 0.4917650730864198 and sim 0.9046577049670035
Collapsing 3 & 5 with crosscontam 0.6877301477348472 and sim 0.9003408111991966
Collapsing 0 & 3 with crosscontam 0.6962253919358878 and sim 0.8936883520594361
Collapsing 0 & 7 with crosscontam 0.5774725095876017 and sim 0.873969701267455
Collapsing 1 & 6 with crosscontam 0.5348137864029125 and sim 0.8693591300736665
Collapsing 3 & 7 with crosscontam 0.6308923674941784 and sim 0.8616474109600963
Collapsing 1 & 7 with crosscontam 0.5605476890096548 and sim 0.8575290304307759
Collapsing 6 & 7 with crosscontam 0.6665394031579361 and sim 0.8557000785251468
Collapsing 2 & 7 with crosscontam 0.500698889529219 and sim 0.8538012538200137
Collapsing 2 & 6 with crosscontam 0.522869837973325 and sim 0.8532141028001665
Trimming eliminated 0 seqlets out of 697
Trimming eliminated 0 seqlets out of 858
Trimming eliminated 0 seqlets out of 499
Trimming eliminated 0 seqlets out of 1357
Trimming eliminated 0 seqlets out of 1498
Trimming eliminated 0 seqlets out of 1902
Unmerged patterns remapping: OrderedDict([(4, 1)])
Time spent on merging iteration: 9.257347822189331
On merging iteration 2
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 1812 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 2086 out of 2086 | elapsed:    0.4s finished
Numbers for each pattern pre-subsample: [1902, 220]
Numbers after subsampling: [300, 220]
Computing sims for pattern 0
Computed sims for pattern 0 in 0.34687113761901855 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.2901296615600586 s
Cluster sizes
[1902  220]
Cross-contamination matrix:
[[1.   0.42]
 [0.82 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.72]
 [0.72 1.  ]]
Inspecting pattern 1 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 2086
[t-SNE] Computed conditional probabilities for sample 2000 / 2086
[t-SNE] Computed conditional probabilities for sample 2086 / 2086
[t-SNE] Mean sigma: 0.246574
Beginning preprocessing + Leiden
2024-03-16 18:44:03.751606 MEMORY 18.21882368
Affmat transformed
2024-03-16 18:44:03.778846 MEMORY 18.21882368
sources, targets, weights extracted
2024-03-16 18:44:03.799800 MEMORY 18.21882368
About to launch parallel Leiden runs
2024-03-16 18:44:03.846782 MEMORY 18.218729472
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    7.0s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   23.7s finished
Parallel Leiden runs finished
2024-03-16 18:44:27.564675 MEMORY 18.218725376
Quality: 0.45336197292705605
Quality: 0.4550172546284758
Quality: 0.45793384652206853
Quality: 0.45821826245352154
Quality: 0.45850674440204897
Got subclusters: Counter({0: 490, 1: 343, 2: 306, 3: 304, 4: 298, 5: 280, 6: 62, 7: 3})
On merging iteration 1
Numbers for each pattern pre-subsample: [490, 343, 306, 304, 298, 280, 62, 3]
Numbers after subsampling: [300, 300, 300, 300, 298, 280, 62, 3]
Computing sims for pattern 0
Computed sims for pattern 0 in 2.276010036468506 s
Computing sims for pattern 1
Computed sims for pattern 1 in 2.2988340854644775 s
Computing sims for pattern 2
Computed sims for pattern 2 in 2.2954940795898438 s
Computing sims for pattern 3
Computed sims for pattern 3 in 2.289605140686035 s
Computing sims for pattern 4
Computed sims for pattern 4 in 2.264089822769165 s
Computing sims for pattern 5
Computed sims for pattern 5 in 2.0364348888397217 s
Computing sims for pattern 6
Computed sims for pattern 6 in 2.852522611618042 s
Computing sims for pattern 7
Computed sims for pattern 7 in 0.1683664321899414 s
Cluster sizes
[490 343 306 304 298 280  62   3]
Cross-contamination matrix:
[[1.   0.34 0.65 0.69 0.49 0.76 0.34 0.5 ]
 [0.89 1.   0.83 0.96 0.74 0.97 0.41 0.78]
 [0.88 0.5  1.   0.8  0.6  0.82 0.43 0.59]
 [0.87 0.49 0.72 1.   0.56 0.79 0.28 0.57]
 [1.   0.75 0.92 0.97 1.   0.96 0.59 0.78]
 [0.83 0.49 0.67 0.69 0.51 1.   0.37 0.44]
 [0.99 0.48 0.82 0.74 0.64 0.89 1.   0.57]
 [0.52 0.43 0.49 0.53 0.42 0.46 0.22 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.86 0.93 0.93 0.9  0.93 0.88 0.75]
 [0.86 1.   0.9  0.94 0.89 0.91 0.72 0.8 ]
 [0.93 0.9  1.   0.94 0.9  0.91 0.86 0.74]
 [0.93 0.94 0.94 1.   0.91 0.91 0.78 0.82]
 [0.9  0.89 0.9  0.91 1.   0.89 0.78 0.78]
 [0.93 0.91 0.91 0.91 0.89 1.   0.85 0.72]
 [0.88 0.72 0.86 0.78 0.78 0.85 1.   0.57]
 [0.75 0.8  0.74 0.82 0.78 0.72 0.57 1.  ]]
Collapsing 1 & 3 with crosscontam 0.4906582829629631 and sim 0.9445478785804087
Collapsing 2 & 3 with crosscontam 0.7247516834567902 and sim 0.9395437501979835
Collapsing 0 & 5 with crosscontam 0.7647633497354498 and sim 0.9331017472117648
Collapsing 0 & 2 with crosscontam 0.6535024587654321 and sim 0.9313841712646337
Collapsing 0 & 3 with crosscontam 0.6877325748148149 and sim 0.9313805003887582
Collapsing 3 & 5 with crosscontam 0.6883971070213801 and sim 0.9136180428900945
Collapsing 3 & 4 with crosscontam 0.5577493253790704 and sim 0.9092582062022874
Collapsing 2 & 5 with crosscontam 0.6661255095966958 and sim 0.9081729501955932
Collapsing 1 & 5 with crosscontam 0.4891860149416911 and sim 0.9069958778587515
Collapsing 0 & 4 with crosscontam 0.4900694357444695 and sim 0.9013371375787589
Collapsing 2 & 4 with crosscontam 0.6026191106139698 and sim 0.8987753953942051
Collapsing 1 & 2 with crosscontam 0.5048222074074074 and sim 0.8950479186131395
Collapsing 1 & 4 with crosscontam 0.7403040631369624 and sim 0.8943905879737288
Collapsing 4 & 5 with crosscontam 0.5137778478241728 and sim 0.8883178394541591
Trimming eliminated 0 seqlets out of 647
Trimming eliminated 0 seqlets out of 953
Trimming eliminated 0 seqlets out of 770
Trimming eliminated 0 seqlets out of 1723
Trimming eliminated 0 seqlets out of 2021
Unmerged patterns remapping: OrderedDict([(6, 1), (7, 2)])
Time spent on merging iteration: 7.839563846588135
On merging iteration 2
Numbers for each pattern pre-subsample: [2021, 62, 3]
Numbers after subsampling: [300, 62, 3]
Computing sims for pattern 0
Computed sims for pattern 0 in 0.5095431804656982 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.09931182861328125 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.02841043472290039 s
Cluster sizes
[2021   62    3]
Cross-contamination matrix:
[[1.   0.6  0.8 ]
 [0.78 1.   0.57]
 [0.49 0.22 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.85 0.8 ]
 [0.85 1.   0.57]
 [0.8  0.57 1.  ]]
Collapsing 0 & 1 with crosscontam 0.6048126188769416 and sim 0.850168517609496
Trimming eliminated 0 seqlets out of 2083
Unmerged patterns remapping: OrderedDict([(2, 1)])
Time spent on merging iteration: 2.178877353668213
On merging iteration 3
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 1812 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 1936 out of 1983 | elapsed:    0.3s remaining:    0.0s
[Parallel(n_jobs=24)]: Done 1983 out of 1983 | elapsed:    0.3s finished
Numbers for each pattern pre-subsample: [2083, 3]
Numbers after subsampling: [300, 3]
Computing sims for pattern 0
Computed sims for pattern 0 in 0.22395110130310059 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.028284788131713867 s
Cluster sizes
[2083    3]
Cross-contamination matrix:
[[1.   0.84]
 [0.47 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.79]
 [0.79 1.  ]]
Inspecting pattern 2 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 1983
[t-SNE] Computed conditional probabilities for sample 1983 / 1983
[t-SNE] Mean sigma: 0.282134
Beginning preprocessing + Leiden
2024-03-16 18:44:57.729229 MEMORY 18.218795008
Affmat transformed
2024-03-16 18:44:57.756828 MEMORY 18.218795008
sources, targets, weights extracted
2024-03-16 18:44:57.777813 MEMORY 18.218795008
About to launch parallel Leiden runs
2024-03-16 18:44:57.798713 MEMORY 18.21876224
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    6.5s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   22.0s finished
Parallel Leiden runs finished
2024-03-16 18:45:19.848276 MEMORY 18.21876224
Quality: 0.4566518616260517
Quality: 0.4578682727092211
Quality: 0.45790192391160917
Got subclusters: Counter({0: 407, 1: 378, 2: 339, 3: 263, 4: 246, 5: 123, 6: 114, 7: 113})
On merging iteration 1
Numbers for each pattern pre-subsample: [407, 378, 339, 263, 246, 123, 114, 113]
Numbers after subsampling: [300, 300, 300, 263, 246, 123, 114, 113]
Computing sims for pattern 0
Computed sims for pattern 0 in 4.382614374160767 s
Computing sims for pattern 1
Computed sims for pattern 1 in 2.224526882171631 s
Computing sims for pattern 2
Computed sims for pattern 2 in 2.2289130687713623 s
Computing sims for pattern 3
Computed sims for pattern 3 in 1.850745439529419 s
Computing sims for pattern 4
Computed sims for pattern 4 in 1.6232740879058838 s
Computing sims for pattern 5
Computed sims for pattern 5 in 1.0552172660827637 s
Computing sims for pattern 6
Computed sims for pattern 6 in 0.9660134315490723 s
Computing sims for pattern 7
Computed sims for pattern 7 in 0.9800753593444824 s
Cluster sizes
[407 378 339 263 246 123 114 113]
Cross-contamination matrix:
[[1.   0.38 0.41 0.49 0.44 0.23 0.61 0.65]
 [0.96 1.   0.63 0.62 0.56 0.6  0.7  0.76]
 [0.9  0.59 1.   0.56 0.77 0.51 0.83 0.75]
 [1.   0.71 0.7  1.   0.75 0.52 0.88 0.99]
 [0.92 0.52 0.75 0.6  1.   0.42 0.83 0.82]
 [0.84 0.71 0.66 0.52 0.52 1.   0.6  0.64]
 [0.91 0.48 0.64 0.56 0.65 0.32 1.   0.74]
 [0.93 0.5  0.54 0.62 0.62 0.33 0.72 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.84 0.85 0.94 0.88 0.77 0.91 0.95]
 [0.84 1.   0.77 0.81 0.78 0.77 0.77 0.83]
 [0.85 0.77 1.   0.81 0.88 0.77 0.85 0.83]
 [0.94 0.81 0.81 1.   0.87 0.74 0.88 0.94]
 [0.88 0.78 0.88 0.87 1.   0.72 0.87 0.9 ]
 [0.77 0.77 0.77 0.74 0.72 1.   0.71 0.74]
 [0.91 0.77 0.85 0.88 0.87 0.71 1.   0.89]
 [0.95 0.83 0.83 0.94 0.9  0.74 0.89 1.  ]]
Collapsing 0 & 7 with crosscontam 0.6528127866273354 and sim 0.9547105686115573
Collapsing 3 & 7 with crosscontam 0.6197043737349577 and sim 0.9438105498120608
Collapsing 0 & 3 with crosscontam 0.48694765638642457 and sim 0.9411430504832824
Collapsing 0 & 6 with crosscontam 0.6053063131903833 and sim 0.9139989918912174
Collapsing 4 & 7 with crosscontam 0.6203842359125624 and sim 0.8983033218779997
Collapsing 6 & 7 with crosscontam 0.7183766955973772 and sim 0.8929466228383919
Collapsing 3 & 6 with crosscontam 0.5607089091866939 and sim 0.8848720856155565
Collapsing 2 & 4 with crosscontam 0.7528394954251612 and sim 0.8756043816801267
Collapsing 3 & 4 with crosscontam 0.6042516638688273 and sim 0.8670479061516582
Collapsing 4 & 6 with crosscontam 0.6516862829851995 and sim 0.8669689684437807
Trimming eliminated 0 seqlets out of 520
Trimming eliminated 0 seqlets out of 783
Trimming eliminated 0 seqlets out of 897
Trimming eliminated 0 seqlets out of 1143
Skipped 1 due to duplicates
Trimming eliminated 0 seqlets out of 1481
Unmerged patterns remapping: OrderedDict([(1, 1), (5, 2)])
Time spent on merging iteration: 7.391412734985352
On merging iteration 2
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 1650 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 1849 out of 1849 | elapsed:    0.3s finished
Numbers for each pattern pre-subsample: [1481, 378, 123]
Numbers after subsampling: [300, 300, 123]
Computing sims for pattern 0
Computed sims for pattern 0 in 0.6327624320983887 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.35741209983825684 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.17566633224487305 s
Cluster sizes
[1481  378  123]
Cross-contamination matrix:
[[1.   0.78 0.62]
 [0.7  1.   0.6 ]
 [0.62 0.71 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.83 0.76]
 [0.83 1.   0.77]
 [0.76 0.77 1.  ]]
Inspecting pattern 3 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 1849
[t-SNE] Computed conditional probabilities for sample 1849 / 1849
[t-SNE] Mean sigma: 0.251621
Beginning preprocessing + Leiden
2024-03-16 18:45:45.584199 MEMORY 18.218725376
Affmat transformed
2024-03-16 18:45:45.607996 MEMORY 18.218725376
sources, targets, weights extracted
2024-03-16 18:45:45.626569 MEMORY 18.218725376
About to launch parallel Leiden runs
2024-03-16 18:45:45.660012 MEMORY 18.218627072
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    6.6s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   22.6s finished
Parallel Leiden runs finished
2024-03-16 18:46:08.235075 MEMORY 18.218573824
Quality: 0.4252895369266963
Quality: 0.4259798338566953
Got subclusters: Counter({0: 366, 1: 296, 2: 275, 3: 257, 4: 233, 5: 221, 6: 201})
On merging iteration 1
Numbers for each pattern pre-subsample: [366, 296, 275, 257, 233, 221, 201]
Numbers after subsampling: [300, 296, 275, 257, 233, 221, 201]
Computing sims for pattern 0
Computed sims for pattern 0 in 2.125424385070801 s
Computing sims for pattern 1
Computed sims for pattern 1 in 2.005706310272217 s
Computing sims for pattern 2
Computed sims for pattern 2 in 1.8019132614135742 s
Computing sims for pattern 3
Computed sims for pattern 3 in 1.642488718032837 s
Computing sims for pattern 4
Computed sims for pattern 4 in 1.8786342144012451 s
Computing sims for pattern 5
Computed sims for pattern 5 in 1.8089485168457031 s
Computing sims for pattern 6
Computed sims for pattern 6 in 1.6142101287841797 s
Cluster sizes
[366 296 275 257 233 221 201]
Cross-contamination matrix:
[[1.   0.55 0.6  0.66 0.6  0.25 0.62]
 [0.92 1.   0.73 0.8  0.77 0.47 0.78]
 [1.   0.81 1.   0.81 0.81 0.46 0.77]
 [0.93 0.72 0.67 1.   0.85 0.57 0.81]
 [0.91 0.7  0.66 0.86 1.   0.55 0.82]
 [0.93 0.81 0.7  1.   0.99 1.   0.95]
 [0.98 0.8  0.71 0.9  0.9  0.62 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.94 0.97 0.93 0.93 0.84 0.94]
 [0.94 1.   0.9  0.92 0.9  0.84 0.91]
 [0.97 0.9  1.   0.89 0.9  0.8  0.89]
 [0.93 0.92 0.89 1.   0.96 0.91 0.95]
 [0.93 0.9  0.9  0.96 1.   0.91 0.95]
 [0.84 0.84 0.8  0.91 0.91 1.   0.91]
 [0.94 0.91 0.89 0.95 0.95 0.91 1.  ]]
Collapsing 0 & 2 with crosscontam 0.6038376495622897 and sim 0.9653900330169973
Collapsing 3 & 4 with crosscontam 0.8462883807602535 and sim 0.9579241106571478
Collapsing 4 & 6 with crosscontam 0.8227891622331531 and sim 0.9520523983799595
Collapsing 3 & 6 with crosscontam 0.8068433952293419 and sim 0.9455821341823067
Collapsing 0 & 6 with crosscontam 0.6213296458448498 and sim 0.9436980108681949
Collapsing 0 & 1 with crosscontam 0.5544197012012011 and sim 0.9353686274838604
Collapsing 0 & 4 with crosscontam 0.601801173104435 and sim 0.9337384802260561
Collapsing 0 & 3 with crosscontam 0.6615819288081854 and sim 0.9298586166044215
Collapsing 1 & 3 with crosscontam 0.7234414827931208 and sim 0.9204070312837863
Collapsing 1 & 6 with crosscontam 0.781560104267127 and sim 0.9141504613946868
Collapsing 5 & 6 with crosscontam 0.6208040546690228 and sim 0.9135416903148268
Collapsing 4 & 5 with crosscontam 0.5451425149488376 and sim 0.9104169922366766
Collapsing 3 & 5 with crosscontam 0.5696610307414367 and sim 0.9068074467635898
Collapsing 2 & 4 with crosscontam 0.655086696854331 and sim 0.9022158573209713
Collapsing 1 & 2 with crosscontam 0.7332538282978842 and sim 0.8985836817282685
Collapsing 1 & 4 with crosscontam 0.696337747807481 and sim 0.8980157952996112
Collapsing 2 & 6 with crosscontam 0.7130493698008984 and sim 0.8900901095087153
Collapsing 2 & 3 with crosscontam 0.6653140413493808 and sim 0.8868830468222016
Trimming eliminated 0 seqlets out of 641
Trimming eliminated 0 seqlets out of 490
Trimming eliminated 0 seqlets out of 691
Trimming eliminated 0 seqlets out of 1332
Trimming eliminated 0 seqlets out of 1628
Removed 1 duplicate seqlets
Trimming eliminated 0 seqlets out of 1848
Unmerged patterns remapping: OrderedDict()
Time spent on merging iteration: 12.885663270950317
On merging iteration 2
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 1650 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 1756 out of 1756 | elapsed:    0.3s finished
Numbers for each pattern pre-subsample: [1848]
Numbers after subsampling: [300]
Computing sims for pattern 0
Computed sims for pattern 0 in 4.291534423828125e-06 s
Cluster sizes
[1848]
Cross-contamination matrix:
[[1.]]
Pattern-to-pattern sim matrix:
[[1.]]
Inspecting pattern 4 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 1756
[t-SNE] Computed conditional probabilities for sample 1756 / 1756
[t-SNE] Mean sigma: 0.327996
Beginning preprocessing + Leiden
2024-03-16 18:46:34.945147 MEMORY 18.218635264
Affmat transformed
2024-03-16 18:46:34.965654 MEMORY 18.218635264
sources, targets, weights extracted
2024-03-16 18:46:34.978244 MEMORY 18.218635264
About to launch parallel Leiden runs
2024-03-16 18:46:34.988010 MEMORY 18.218635264
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    4.8s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   15.5s finished
Parallel Leiden runs finished
2024-03-16 18:46:50.446684 MEMORY 18.218635264
Quality: 0.4864591458987748
Quality: 0.4869374702252661
Quality: 0.4875710135486147
Quality: 0.4879047185521063
Got subclusters: Counter({0: 349, 1: 347, 2: 346, 3: 327, 4: 316, 5: 63, 6: 6, 7: 2})
On merging iteration 1
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 1608 out of 1608 | elapsed:    0.6s finished
Numbers for each pattern pre-subsample: [349, 347, 346, 327, 316, 63, 6, 2]
Numbers after subsampling: [300, 300, 300, 300, 300, 63, 6, 2]
Computing sims for pattern 0
Computed sims for pattern 0 in 2.1843998432159424 s
Computing sims for pattern 1
Computed sims for pattern 1 in 2.2012906074523926 s
Computing sims for pattern 2
Computed sims for pattern 2 in 2.1766061782836914 s
Computing sims for pattern 3
Computed sims for pattern 3 in 2.2096917629241943 s
Computing sims for pattern 4
Computed sims for pattern 4 in 2.179112434387207 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.5808789730072021 s
Computing sims for pattern 6
Computed sims for pattern 6 in 0.16608977317810059 s
Computing sims for pattern 7
Computed sims for pattern 7 in 0.13559603691101074 s
Cluster sizes
[349 347 346 327 316  63   6   2]
Cross-contamination matrix:
[[1.   0.67 0.66 0.69 0.67 0.76 0.33 0.81]
 [0.58 1.   0.55 0.6  0.66 0.56 0.17 0.76]
 [0.63 0.61 1.   0.79 0.73 0.62 0.3  0.71]
 [0.5  0.5  0.63 1.   0.61 0.58 0.07 0.69]
 [0.53 0.61 0.61 0.65 1.   0.52 0.11 0.67]
 [0.54 0.45 0.45 0.56 0.45 1.   0.19 0.44]
 [0.03 0.01 0.03 0.01 0.02 0.04 1.   0.  ]
 [0.   0.   0.   0.   0.   0.   0.   1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.76 0.81 0.83 0.71 0.83 0.37 0.73]
 [0.76 1.   0.72 0.77 0.76 0.7  0.2  0.69]
 [0.81 0.72 1.   0.83 0.72 0.73 0.32 0.61]
 [0.83 0.77 0.83 1.   0.71 0.75 0.26 0.69]
 [0.71 0.76 0.72 0.71 1.   0.64 0.28 0.58]
 [0.83 0.7  0.73 0.75 0.64 1.   0.43 0.59]
 [0.37 0.2  0.32 0.26 0.28 0.43 1.   0.31]
 [0.73 0.69 0.61 0.69 0.58 0.59 0.31 1.  ]]
Inspecting pattern 5 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 1608
[t-SNE] Computed conditional probabilities for sample 1608 / 1608
[t-SNE] Mean sigma: 0.329767
Beginning preprocessing + Leiden
2024-03-16 18:47:05.013439 MEMORY 18.21872128
Affmat transformed
2024-03-16 18:47:05.032431 MEMORY 18.21872128
sources, targets, weights extracted
2024-03-16 18:47:05.044339 MEMORY 18.21872128
About to launch parallel Leiden runs
2024-03-16 18:47:05.053328 MEMORY 18.21872128
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    4.3s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   14.5s finished
Parallel Leiden runs finished
2024-03-16 18:47:19.589809 MEMORY 18.21872128
Quality: 0.5249739596310607
Quality: 0.5308317631600336
Quality: 0.5313463159452154
Quality: 0.5314102744940703
Got subclusters: Counter({0: 349, 1: 295, 2: 273, 3: 226, 4: 196, 5: 176, 6: 93})
On merging iteration 1
Numbers for each pattern pre-subsample: [349, 295, 273, 226, 196, 176, 93]
Numbers after subsampling: [300, 295, 273, 226, 196, 176, 93]
Computing sims for pattern 0
Computed sims for pattern 0 in 3.864556074142456 s
Computing sims for pattern 1
Computed sims for pattern 1 in 1.8800878524780273 s
Computing sims for pattern 2
Computed sims for pattern 2 in 1.6983540058135986 s
Computing sims for pattern 3
Computed sims for pattern 3 in 1.7323200702667236 s
Computing sims for pattern 4
Computed sims for pattern 4 in 1.408372163772583 s
Computing sims for pattern 5
Computed sims for pattern 5 in 1.2511327266693115 s
Computing sims for pattern 6
Computed sims for pattern 6 in 0.752648115158081 s
Cluster sizes
[349 295 273 226 196 176  93]
Cross-contamination matrix:
[[1.   0.36 0.7  0.49 0.48 0.4  0.46]
 [0.39 1.   0.64 0.49 0.68 0.58 0.51]
 [0.21 0.18 1.   0.21 0.14 0.17 0.26]
 [0.54 0.53 0.68 1.   0.66 0.49 0.67]
 [0.54 0.77 0.58 0.67 1.   0.53 0.56]
 [0.6  0.79 0.84 0.66 0.68 1.   0.68]
 [0.57 0.53 0.94 0.72 0.6  0.58 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.65 0.7  0.76 0.7  0.66 0.73]
 [0.65 1.   0.64 0.65 0.82 0.69 0.7 ]
 [0.7  0.64 1.   0.67 0.56 0.62 0.7 ]
 [0.76 0.65 0.67 1.   0.73 0.62 0.73]
 [0.7  0.82 0.56 0.73 1.   0.65 0.68]
 [0.66 0.69 0.62 0.62 0.65 1.   0.69]
 [0.73 0.7  0.7  0.73 0.68 0.69 1.  ]]
Merging on 23 clusters
2024-03-16 18:47:32.533860 MEMORY 18.21872128
On merging iteration 1
Numbers for each pattern pre-subsample: [1902, 220, 2083, 3, 1481, 378, 123, 1848, 349, 347, 346, 327, 316, 63, 6, 2, 349, 295, 273, 226, 196, 176, 93]
Numbers after subsampling: [300, 220, 300, 3, 300, 300, 123, 300, 300, 300, 300, 300, 300, 63, 6, 2, 300, 295, 273, 226, 196, 176, 93]
Computing sims for pattern 0
Computed sims for pattern 0 in 6.957398414611816 s
Computing sims for pattern 1
Computed sims for pattern 1 in 6.068772077560425 s
Computing sims for pattern 2
Computed sims for pattern 2 in 7.5503480434417725 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.4970130920410156 s
Computing sims for pattern 4
Computed sims for pattern 4 in 7.165484189987183 s
Computing sims for pattern 5
Computed sims for pattern 5 in 7.013190984725952 s
Computing sims for pattern 6
Computed sims for pattern 6 in 3.2910125255584717 s
Computing sims for pattern 7
Computed sims for pattern 7 in 7.128928184509277 s
Computing sims for pattern 8
Computed sims for pattern 8 in 7.207792520523071 s
Computing sims for pattern 9
Computed sims for pattern 9 in 7.221425533294678 s
Computing sims for pattern 10
Computed sims for pattern 10 in 7.448371171951294 s
Computing sims for pattern 11
Computed sims for pattern 11 in 9.356982469558716 s
Computing sims for pattern 12
Computed sims for pattern 12 in 7.2522571086883545 s
Computing sims for pattern 13
Computed sims for pattern 13 in 1.8835749626159668 s
Computing sims for pattern 14
Computed sims for pattern 14 in 0.5234172344207764 s
Computing sims for pattern 15
Computed sims for pattern 15 in 0.42755937576293945 s
Computing sims for pattern 16
Computed sims for pattern 16 in 7.135478258132935 s
Computing sims for pattern 17
Computed sims for pattern 17 in 6.924748659133911 s
Computing sims for pattern 18
Computed sims for pattern 18 in 6.177905559539795 s
Computing sims for pattern 19
Computed sims for pattern 19 in 6.214166879653931 s
Computing sims for pattern 20
Computed sims for pattern 20 in 5.118501663208008 s
Computing sims for pattern 21
Computed sims for pattern 21 in 4.35802149772644 s
Computing sims for pattern 22
Computed sims for pattern 22 in 2.5918829441070557 s
Cluster sizes
[1902  220 2083    3 1481  378  123 1848  349  347  346  327  316   63
    6    2  349  295  273  226  196  176   93]
Cross-contamination matrix:
[[1.   0.42 0.82 0.75 0.61 0.24 0.16 0.71 0.07 0.16 0.07 0.25 0.08 0.15
  0.02 0.03 0.01 0.04 0.04 0.09 0.07 0.04 0.04]
 [0.82 1.   0.58 0.47 0.36 0.03 0.06 0.42 0.15 0.06 0.13 0.29 0.19 0.4
  0.06 0.04 0.05 0.1  0.05 0.12 0.19 0.22 0.04]
 [0.8  0.27 1.   0.84 0.59 0.21 0.16 0.84 0.13 0.3  0.08 0.34 0.18 0.2
  0.12 0.08 0.01 0.05 0.04 0.08 0.06 0.05 0.04]
 [0.4  0.05 0.47 1.   0.3  0.03 0.02 0.41 0.   0.02 0.   0.07 0.01 0.
  0.   0.   0.   0.01 0.   0.01 0.   0.   0.  ]
 [0.95 0.41 0.95 0.88 1.   0.78 0.62 1.   0.32 0.35 0.27 0.39 0.33 0.27
  0.12 0.2  0.17 0.19 0.28 0.43 0.18 0.22 0.22]
 [0.38 0.02 0.34 0.3  0.7  1.   0.6  0.47 0.17 0.13 0.08 0.1  0.05 0.07
  0.03 0.38 0.16 0.37 0.34 0.56 0.31 0.17 0.34]
 [0.36 0.07 0.32 0.3  0.62 0.71 1.   0.44 0.28 0.14 0.27 0.08 0.21 0.16
  0.04 0.06 0.15 0.21 0.2  0.48 0.16 0.1  0.28]
 [0.76 0.22 0.92 0.81 0.72 0.34 0.3  1.   0.21 0.31 0.12 0.18 0.29 0.21
  0.16 0.16 0.02 0.06 0.06 0.14 0.1  0.05 0.07]
 [0.29 0.26 0.46 0.1  0.41 0.4  0.46 0.57 1.   0.67 0.66 0.69 0.67 0.76
  0.33 0.81 0.12 0.5  0.14 0.5  0.29 0.43 0.28]
 [0.41 0.08 0.5  0.36 0.43 0.2  0.23 0.56 0.58 1.   0.55 0.6  0.66 0.56
  0.17 0.76 0.04 0.32 0.09 0.2  0.19 0.18 0.13]
 [0.32 0.19 0.34 0.42 0.33 0.21 0.44 0.37 0.63 0.61 1.   0.79 0.73 0.62
  0.3  0.71 0.03 0.37 0.05 0.2  0.32 0.24 0.2 ]
 [0.53 0.29 0.69 0.48 0.34 0.16 0.09 0.3  0.5  0.5  0.63 1.   0.61 0.58
  0.07 0.69 0.02 0.27 0.03 0.09 0.13 0.18 0.16]
 [0.39 0.26 0.48 0.27 0.29 0.14 0.32 0.56 0.53 0.61 0.61 0.65 1.   0.52
  0.11 0.67 0.03 0.31 0.04 0.17 0.25 0.23 0.16]
 [0.31 0.35 0.44 0.1  0.21 0.13 0.16 0.39 0.54 0.45 0.45 0.56 0.45 1.
  0.19 0.44 0.03 0.16 0.03 0.19 0.07 0.2  0.13]
 [0.01 0.   0.03 0.   0.   0.01 0.   0.03 0.03 0.01 0.03 0.01 0.02 0.04
  1.   0.   0.   0.05 0.02 0.01 0.03 0.09 0.02]
 [0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.
  0.   1.   0.   0.   0.   0.   0.   0.   0.  ]
 [0.07 0.09 0.06 0.01 0.15 0.33 0.23 0.06 0.16 0.05 0.03 0.04 0.04 0.06
  0.07 0.36 1.   0.36 0.7  0.49 0.48 0.4  0.46]
 [0.19 0.17 0.21 0.14 0.24 0.62 0.34 0.14 0.41 0.29 0.3  0.32 0.29 0.21
  0.31 0.22 0.39 1.   0.64 0.49 0.68 0.58 0.51]
 [0.03 0.02 0.03 0.01 0.07 0.18 0.09 0.04 0.03 0.01 0.01 0.02 0.01 0.02
  0.06 0.21 0.21 0.18 1.   0.21 0.14 0.17 0.26]
 [0.34 0.21 0.29 0.21 0.59 0.92 0.68 0.38 0.46 0.19 0.15 0.1  0.17 0.26
  0.15 0.75 0.54 0.53 0.68 1.   0.66 0.49 0.67]
 [0.32 0.32 0.23 0.14 0.2  0.62 0.29 0.25 0.3  0.22 0.34 0.23 0.32 0.14
  0.27 0.57 0.54 0.77 0.58 0.67 1.   0.53 0.56]
 [0.31 0.44 0.35 0.22 0.39 0.63 0.25 0.26 0.55 0.29 0.35 0.4  0.4  0.45
  0.56 0.39 0.6  0.79 0.84 0.66 0.68 1.   0.68]
 [0.18 0.1  0.17 0.15 0.16 0.67 0.42 0.2  0.27 0.17 0.21 0.24 0.21 0.21
  0.26 0.86 0.57 0.53 0.94 0.72 0.6  0.58 1.  ]]
Pattern-to-pattern sim matrix:
[[ 1.    0.72  0.91  0.73  0.87  0.57  0.56  0.86  0.34  0.41  0.46  0.49
   0.39  0.44  0.13  0.34  0.21  0.28  0.22  0.4   0.29  0.31  0.35]
 [ 0.72  1.    0.5   0.37  0.42  0.22  0.26  0.39  0.39  0.18  0.27  0.34
   0.26  0.58  0.25  0.34  0.31  0.34  0.23  0.43  0.43  0.46  0.3 ]
 [ 0.91  0.5   1.    0.79  0.88  0.57  0.55  0.95  0.53  0.62  0.49  0.61
   0.6   0.57  0.18  0.49  0.11  0.27  0.18  0.38  0.31  0.31  0.35]
 [ 0.73  0.37  0.79  1.    0.75  0.41  0.56  0.75  0.32  0.42  0.53  0.43
   0.43  0.37  0.15  0.37  0.14  0.32  0.2   0.18  0.26  0.22  0.23]
 [ 0.87  0.42  0.88  0.75  1.    0.83  0.76  0.92  0.48  0.53  0.53  0.41
   0.53  0.45  0.06  0.41  0.29  0.3   0.28  0.61  0.31  0.37  0.38]
 [ 0.57  0.22  0.57  0.41  0.83  1.    0.77  0.67  0.52  0.35  0.34  0.29
   0.31  0.39  0.14  0.46  0.56  0.64  0.54  0.84  0.58  0.52  0.68]
 [ 0.56  0.26  0.55  0.56  0.76  0.77  1.    0.67  0.6   0.42  0.65  0.34
   0.54  0.53  0.21  0.36  0.34  0.33  0.38  0.74  0.38  0.37  0.44]
 [ 0.86  0.39  0.95  0.75  0.92  0.67  0.67  1.    0.61  0.69  0.54  0.54
   0.69  0.55  0.21  0.56  0.1   0.19  0.18  0.45  0.35  0.29  0.4 ]
 [ 0.34  0.39  0.53  0.32  0.48  0.52  0.6   0.61  1.    0.76  0.81  0.83
   0.71  0.83  0.37  0.73  0.24  0.53  0.13  0.61  0.35  0.56  0.32]
 [ 0.41  0.18  0.62  0.42  0.53  0.35  0.42  0.69  0.76  1.    0.72  0.77
   0.76  0.7   0.2   0.69 -0.03  0.35 -0.06  0.32  0.18  0.32  0.21]
 [ 0.46  0.27  0.49  0.53  0.53  0.34  0.65  0.54  0.81  0.72  1.    0.83
   0.72  0.73  0.32  0.61  0.02  0.44  0.04  0.33  0.43  0.43  0.31]
 [ 0.49  0.34  0.61  0.43  0.41  0.29  0.34  0.54  0.83  0.77  0.83  1.
   0.71  0.75  0.26  0.69  0.1   0.48  0.09  0.26  0.25  0.44  0.31]
 [ 0.39  0.26  0.6   0.43  0.53  0.31  0.54  0.69  0.71  0.76  0.72  0.71
   1.    0.64  0.28  0.58 -0.01  0.41  0.01  0.34  0.33  0.46  0.27]
 [ 0.44  0.58  0.57  0.37  0.45  0.39  0.53  0.55  0.83  0.7   0.73  0.75
   0.64  1.    0.43  0.59  0.15  0.34  0.    0.47  0.21  0.5   0.21]
 [ 0.13  0.25  0.18  0.15  0.06  0.14  0.21  0.21  0.37  0.2   0.32  0.26
   0.28  0.43  1.    0.31  0.15  0.34  0.31  0.24  0.32  0.48  0.26]
 [ 0.34  0.34  0.49  0.37  0.41  0.46  0.36  0.56  0.73  0.69  0.61  0.69
   0.58  0.59  0.31  1.    0.37  0.43  0.36  0.42  0.31  0.48  0.67]
 [ 0.21  0.31  0.11  0.14  0.29  0.56  0.34  0.1   0.24 -0.03  0.02  0.1
  -0.01  0.15  0.15  0.37  1.    0.65  0.7   0.76  0.7   0.66  0.73]
 [ 0.28  0.34  0.27  0.32  0.3   0.64  0.33  0.19  0.53  0.35  0.44  0.48
   0.41  0.34  0.34  0.43  0.65  1.    0.64  0.65  0.82  0.69  0.7 ]
 [ 0.22  0.23  0.18  0.2   0.28  0.54  0.38  0.18  0.13 -0.06  0.04  0.09
   0.01  0.    0.31  0.36  0.7   0.64  1.    0.67  0.56  0.62  0.7 ]
 [ 0.4   0.43  0.38  0.18  0.61  0.84  0.74  0.45  0.61  0.32  0.33  0.26
   0.34  0.47  0.24  0.42  0.76  0.65  0.67  1.    0.73  0.62  0.73]
 [ 0.29  0.43  0.31  0.26  0.31  0.58  0.38  0.35  0.35  0.18  0.43  0.25
   0.33  0.21  0.32  0.31  0.7   0.82  0.56  0.73  1.    0.65  0.68]
 [ 0.31  0.46  0.31  0.22  0.37  0.52  0.37  0.29  0.56  0.32  0.43  0.44
   0.46  0.5   0.48  0.48  0.66  0.69  0.62  0.62  0.65  1.    0.69]
 [ 0.35  0.3   0.35  0.23  0.38  0.68  0.44  0.4   0.32  0.21  0.31  0.31
   0.27  0.21  0.26  0.67  0.73  0.7   0.7   0.73  0.68  0.69  1.  ]]
Collapsing 2 & 7 with crosscontam 0.8439544814814817 and sim 0.9453575088904923
Collapsing 4 & 7 with crosscontam 0.7209991997530865 and sim 0.9218509502010249
Collapsing 0 & 2 with crosscontam 0.7960876009876543 and sim 0.9102637072643431
Collapsing 2 & 4 with crosscontam 0.5882724799999999 and sim 0.8770211538040767
Collapsing 0 & 4 with crosscontam 0.6067940311111111 and sim 0.874885148116353
Collapsing 0 & 7 with crosscontam 0.706305618765432 and sim 0.8617512183311986
Skipped 1 due to duplicates
Trimming eliminated 0 seqlets out of 3930
Skipped 8 due to duplicates
Trimming eliminated 0 seqlets out of 5403
Removed 1 duplicate seqlets
Skipped 10 due to duplicates
Trimming eliminated 0 seqlets out of 7294
Unmerged patterns remapping: OrderedDict([(1, 11), (3, 18), (5, 1), (6, 14), (8, 2), (9, 4), (10, 5), (11, 6), (12, 7), (13, 16), (14, 17), (15, 19), (16, 3), (17, 8), (18, 9), (19, 10), (20, 12), (21, 13), (22, 15)])
Time spent on merging iteration: 30.9356050491333
On merging iteration 2
Numbers for each pattern pre-subsample: [7294, 378, 349, 349, 347, 346, 327, 316, 295, 273, 226, 220, 196, 176, 123, 93, 63, 6, 3, 2]
Numbers after subsampling: [300, 300, 300, 300, 300, 300, 300, 300, 295, 273, 226, 220, 196, 176, 123, 93, 63, 6, 3, 2]
Computing sims for pattern 0
Computed sims for pattern 0 in 5.936227321624756 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.3550865650177002 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.3578920364379883 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.35486793518066406 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.34200263023376465 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.3526794910430908 s
Computing sims for pattern 6
Computed sims for pattern 6 in 0.3518989086151123 s
Computing sims for pattern 7
Computed sims for pattern 7 in 0.33802247047424316 s
Computing sims for pattern 8
Computed sims for pattern 8 in 0.3328437805175781 s
Computing sims for pattern 9
Computed sims for pattern 9 in 0.29037976264953613 s
Computing sims for pattern 10
Computed sims for pattern 10 in 0.2970726490020752 s
Computing sims for pattern 11
Computed sims for pattern 11 in 0.2911520004272461 s
Computing sims for pattern 12
Computed sims for pattern 12 in 0.26296067237854004 s
Computing sims for pattern 13
Computed sims for pattern 13 in 0.21712279319763184 s
Computing sims for pattern 14
Computed sims for pattern 14 in 0.17339658737182617 s
Computing sims for pattern 15
Computed sims for pattern 15 in 0.14110231399536133 s
Computing sims for pattern 16
Computed sims for pattern 16 in 0.09500885009765625 s
Computing sims for pattern 17
Computed sims for pattern 17 in 0.031072378158569336 s
Computing sims for pattern 18
Computed sims for pattern 18 in 0.025110244750976562 s
Computing sims for pattern 19
Computed sims for pattern 19 in 0.02408123016357422 s
Cluster sizes
[7294  378  349  349  347  346  327  316  295  273  226  220  196  176
  123   93   63    6    3    2]
Cross-contamination matrix:
[[1.   0.45 0.23 0.04 0.31 0.17 0.4  0.28 0.09 0.11 0.21 0.4  0.12 0.09
  0.35 0.1  0.25 0.18 0.92 0.15]
 [0.46 1.   0.17 0.16 0.13 0.08 0.1  0.05 0.37 0.34 0.56 0.02 0.31 0.17
  0.6  0.34 0.07 0.03 0.3  0.38]
 [0.44 0.4  1.   0.12 0.67 0.66 0.69 0.67 0.5  0.14 0.5  0.26 0.29 0.43
  0.46 0.28 0.76 0.33 0.1  0.81]
 [0.06 0.33 0.16 1.   0.05 0.03 0.04 0.04 0.36 0.7  0.49 0.09 0.48 0.4
  0.23 0.46 0.06 0.07 0.01 0.36]
 [0.43 0.2  0.58 0.04 1.   0.55 0.6  0.66 0.32 0.09 0.2  0.08 0.19 0.18
  0.23 0.13 0.56 0.17 0.36 0.76]
 [0.34 0.21 0.63 0.03 0.61 1.   0.79 0.73 0.37 0.05 0.2  0.19 0.32 0.24
  0.44 0.2  0.62 0.3  0.42 0.71]
 [0.53 0.16 0.5  0.02 0.5  0.63 1.   0.61 0.27 0.03 0.09 0.29 0.13 0.18
  0.09 0.16 0.58 0.07 0.48 0.69]
 [0.4  0.14 0.53 0.03 0.61 0.61 0.65 1.   0.31 0.04 0.17 0.26 0.25 0.23
  0.32 0.16 0.52 0.11 0.27 0.67]
 [0.16 0.62 0.41 0.39 0.29 0.3  0.32 0.29 1.   0.64 0.49 0.17 0.68 0.58
  0.34 0.51 0.21 0.31 0.14 0.22]
 [0.04 0.18 0.03 0.21 0.01 0.01 0.02 0.01 0.18 1.   0.21 0.02 0.14 0.17
  0.09 0.26 0.02 0.06 0.01 0.21]
 [0.39 0.92 0.46 0.54 0.19 0.15 0.1  0.17 0.53 0.68 1.   0.21 0.66 0.49
  0.68 0.67 0.26 0.15 0.21 0.75]
 [0.53 0.03 0.15 0.05 0.06 0.13 0.29 0.19 0.1  0.05 0.12 1.   0.19 0.22
  0.06 0.04 0.4  0.06 0.47 0.04]
 [0.22 0.62 0.3  0.54 0.22 0.34 0.23 0.32 0.77 0.58 0.67 0.32 1.   0.53
  0.29 0.56 0.14 0.27 0.14 0.57]
 [0.24 0.63 0.55 0.6  0.29 0.35 0.4  0.4  0.79 0.84 0.66 0.44 0.68 1.
  0.25 0.68 0.45 0.56 0.22 0.39]
 [0.42 0.71 0.28 0.15 0.14 0.27 0.08 0.21 0.21 0.2  0.48 0.07 0.16 0.1
  1.   0.28 0.16 0.04 0.3  0.06]
 [0.17 0.67 0.27 0.57 0.17 0.21 0.24 0.21 0.53 0.94 0.72 0.1  0.6  0.58
  0.42 1.   0.21 0.26 0.15 0.86]
 [0.33 0.13 0.54 0.03 0.45 0.45 0.56 0.45 0.16 0.03 0.19 0.35 0.07 0.2
  0.16 0.13 1.   0.19 0.1  0.44]
 [0.02 0.01 0.03 0.   0.01 0.03 0.01 0.02 0.05 0.02 0.01 0.   0.03 0.09
  0.   0.02 0.04 1.   0.   0.  ]
 [0.41 0.03 0.   0.   0.02 0.   0.07 0.01 0.01 0.   0.01 0.05 0.   0.
  0.02 0.   0.   0.   1.   0.  ]
 [0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.
  0.   0.   0.   0.   0.   1.  ]]
Pattern-to-pattern sim matrix:
[[ 1.    0.66  0.52  0.13  0.58  0.52  0.52  0.57  0.21  0.2   0.46  0.53
   0.32  0.28  0.64  0.37  0.53  0.14  0.79  0.48]
 [ 0.66  1.    0.52  0.56  0.35  0.34  0.29  0.31  0.64  0.54  0.84  0.22
   0.58  0.52  0.77  0.68  0.39  0.14  0.41  0.46]
 [ 0.52  0.52  1.    0.24  0.76  0.81  0.83  0.71  0.53  0.13  0.61  0.39
   0.35  0.56  0.6   0.32  0.83  0.37  0.32  0.73]
 [ 0.13  0.56  0.24  1.   -0.03  0.02  0.1  -0.01  0.65  0.7   0.76  0.31
   0.7   0.66  0.34  0.73  0.15  0.15  0.14  0.37]
 [ 0.58  0.35  0.76 -0.03  1.    0.72  0.77  0.76  0.35 -0.06  0.32  0.18
   0.18  0.32  0.42  0.21  0.7   0.2   0.42  0.69]
 [ 0.52  0.34  0.81  0.02  0.72  1.    0.83  0.72  0.44  0.04  0.33  0.27
   0.43  0.43  0.65  0.31  0.73  0.32  0.53  0.61]
 [ 0.52  0.29  0.83  0.1   0.77  0.83  1.    0.71  0.48  0.09  0.26  0.34
   0.25  0.44  0.34  0.31  0.75  0.26  0.43  0.69]
 [ 0.57  0.31  0.71 -0.01  0.76  0.72  0.71  1.    0.41  0.01  0.34  0.26
   0.33  0.46  0.54  0.27  0.64  0.28  0.43  0.58]
 [ 0.21  0.64  0.53  0.65  0.35  0.44  0.48  0.41  1.    0.64  0.65  0.34
   0.82  0.69  0.33  0.7   0.34  0.34  0.32  0.43]
 [ 0.2   0.54  0.13  0.7  -0.06  0.04  0.09  0.01  0.64  1.    0.67  0.23
   0.56  0.62  0.38  0.7   0.    0.31  0.2   0.36]
 [ 0.46  0.84  0.61  0.76  0.32  0.33  0.26  0.34  0.65  0.67  1.    0.43
   0.73  0.62  0.74  0.73  0.47  0.24  0.18  0.42]
 [ 0.53  0.22  0.39  0.31  0.18  0.27  0.34  0.26  0.34  0.23  0.43  1.
   0.43  0.46  0.26  0.3   0.58  0.25  0.37  0.34]
 [ 0.32  0.58  0.35  0.7   0.18  0.43  0.25  0.33  0.82  0.56  0.73  0.43
   1.    0.65  0.38  0.68  0.21  0.32  0.26  0.31]
 [ 0.28  0.52  0.56  0.66  0.32  0.43  0.44  0.46  0.69  0.62  0.62  0.46
   0.65  1.    0.37  0.69  0.5   0.48  0.22  0.48]
 [ 0.64  0.77  0.6   0.34  0.42  0.65  0.34  0.54  0.33  0.38  0.74  0.26
   0.38  0.37  1.    0.44  0.53  0.21  0.56  0.36]
 [ 0.37  0.68  0.32  0.73  0.21  0.31  0.31  0.27  0.7   0.7   0.73  0.3
   0.68  0.69  0.44  1.    0.21  0.26  0.23  0.67]
 [ 0.53  0.39  0.83  0.15  0.7   0.73  0.75  0.64  0.34  0.    0.47  0.58
   0.21  0.5   0.53  0.21  1.    0.43  0.37  0.59]
 [ 0.14  0.14  0.37  0.15  0.2   0.32  0.26  0.28  0.34  0.31  0.24  0.25
   0.32  0.48  0.21  0.26  0.43  1.    0.15  0.31]
 [ 0.79  0.41  0.32  0.14  0.42  0.53  0.43  0.43  0.32  0.2   0.18  0.37
   0.26  0.22  0.56  0.23  0.37  0.15  1.    0.37]
 [ 0.48  0.46  0.73  0.37  0.69  0.61  0.69  0.58  0.43  0.36  0.42  0.34
   0.31  0.48  0.36  0.67  0.59  0.31  0.37  1.  ]]
Got 20 patterns after merging
2024-03-16 18:50:20.431117 MEMORY 18.21872128
Performing filtering
2024-03-16 18:50:20.431352 MEMORY 18.21872128
Got 17 patterns after filtering
2024-03-16 18:50:21.941822 MEMORY 18.21872128
Total time taken is 1761.8s
2024-03-16 18:50:21.941977 MEMORY 18.21872128
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.4s
[Parallel(n_jobs=24)]: Done 4080 tasks      | elapsed:    2.4s
[Parallel(n_jobs=24)]: Done 7294 out of 7294 | elapsed:    4.1s finished
/ru-auth/local/home/lzhao/anaconda3/envs/jupyter-ml-clone/lib/python3.9/site-packages/sklearn/manifold/_t_sne.py:691: FutureWarning: 'square_distances' has been introduced in 0.24 to help phase out legacy squaring behavior. The 'legacy' setting will be removed in 1.1 (renaming of 0.26), and the default setting will be changed to True. In 1.3, 'square_distances' will be removed altogether, and distances will be squared by default. Set 'square_distances'=True to silence this warning.
  warnings.warn(
/ru-auth/local/home/lzhao/anaconda3/envs/jupyter-ml-clone/lib/python3.9/site-packages/sklearn/neighbors/_base.py:175: EfficiencyWarning: Precomputed sparse input was not sorted by data.
  warnings.warn('Precomputed sparse input was not sorted by data.',
Applying subclustering to the final motifs
On pattern 0
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 7294 samples in 0.054s...
[t-SNE] Computed neighbors for 7294 samples in 0.004s...
[t-SNE] Computed conditional probabilities for sample 1000 / 7294
[t-SNE] Computed conditional probabilities for sample 2000 / 7294
[t-SNE] Computed conditional probabilities for sample 3000 / 7294
[t-SNE] Computed conditional probabilities for sample 4000 / 7294
[t-SNE] Computed conditional probabilities for sample 5000 / 7294
[t-SNE] Computed conditional probabilities for sample 6000 / 7294
[t-SNE] Computed conditional probabilities for sample 7000 / 7294
[t-SNE] Computed conditional probabilities for sample 7294 / 7294
[t-SNE] Mean sigma: 0.245359
[t-SNE] Computed conditional probabilities in 0.520s
[t-SNE] Iteration 50: error = 84.8293152, gradient norm = 0.0000000 (50 iterations in 0.656s)
[t-SNE] Iteration 50: gradient norm 0.000000. Finished.
[t-SNE] KL divergence after 50 iterations with early exaggeration: 84.829315
[t-SNE] Iteration 100: error = 3.3546000, gradient norm = 0.0020795 (50 iterations in 0.578s)
[t-SNE] Iteration 150: error = 3.0222576, gradient norm = 0.0004801 (50 iterations in 0.542s)
[t-SNE] Iteration 200: error = 2.9286771, gradient norm = 0.0002625 (50 iterations in 0.558s)
[t-SNE] Iteration 250: error = 2.8732755, gradient norm = 0.0001920 (50 iterations in 0.607s)
[t-SNE] Iteration 300: error = 2.8374002, gradient norm = 0.0001437 (50 iterations in 0.561s)
[t-SNE] Iteration 350: error = 2.8125830, gradient norm = 0.0001222 (50 iterations in 0.552s)
[t-SNE] Iteration 400: error = 2.7943463, gradient norm = 0.0000852 (50 iterations in 0.554s)
[t-SNE] Iteration 450: error = 2.7803795, gradient norm = 0.0000717 (50 iterations in 0.559s)
[t-SNE] Iteration 500: error = 2.7701719, gradient norm = 0.0000611 (50 iterations in 0.566s)
[t-SNE] Iteration 550: error = 2.7617326, gradient norm = 0.0000505 (50 iterations in 0.552s)
[t-SNE] Iteration 600: error = 2.7545569, gradient norm = 0.0000451 (50 iterations in 0.555s)
[t-SNE] Iteration 650: error = 2.7485750, gradient norm = 0.0000397 (50 iterations in 0.551s)
[t-SNE] Iteration 700: error = 2.7435391, gradient norm = 0.0000369 (50 iterations in 0.552s)
[t-SNE] Iteration 750: error = 2.7393928, gradient norm = 0.0000346 (50 iterations in 0.557s)
[t-SNE] Iteration 800: error = 2.7360849, gradient norm = 0.0000369 (50 iterations in 0.572s)
[t-SNE] Iteration 850: error = 2.7336254, gradient norm = 0.0000332 (50 iterations in 0.547s)
[t-SNE] Iteration 900: error = 2.7316656, gradient norm = 0.0000352 (50 iterations in 0.595s)
[t-SNE] Iteration 950: error = 2.7303202, gradient norm = 0.0000365 (50 iterations in 0.561s)
[t-SNE] Iteration 1000: error = 2.7294717, gradient norm = 0.0000305 (50 iterations in 0.557s)
[t-SNE] KL divergence after 1000 iterations: 2.729472
[t-SNE] Computed conditional probabilities for sample 1000 / 7294
[t-SNE] Computed conditional probabilities for sample 2000 / 7294
[t-SNE] Computed conditional probabilities for sample 3000 / 7294
[t-SNE] Computed conditional probabilities for sample 4000 / 7294
[t-SNE] Computed conditional probabilities for sample 5000 / 7294
[t-SNE] Computed conditional probabilities for sample 6000 / 7294
[t-SNE] Computed conditional probabilities for sample 7000 / 7294
[t-SNE] Computed conditional probabilities for sample 7294 / 7294
[t-SNE] Mean sigma: 0.245359
Beginning preprocessing + Leiden
2024-03-16 18:50:45.020159 MEMORY 18.283122688
Affmat transformed
2024-03-16 18:50:45.113371 MEMORY 18.312339456
sources, targets, weights extracted
2024-03-16 18:50:45.181690 MEMORY 18.312339456
About to launch parallel Leiden runs
2024-03-16 18:50:45.208650 MEMORY 18.312339456
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:   32.9s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:  2.3min finished
Parallel Leiden runs finished
2024-03-16 18:53:02.753804 MEMORY 18.312339456
Quality: 0.5318109059809919
Quality: 0.5324938829719911
Quality: 0.535162685200194
Quality: 0.535275685487923
Quality: 0.5353533230850611
Quality: 0.5355109187034782
Quality: 0.5362320202873202
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 378 out of 378 | elapsed:    0.1s finished
Got subclusters: Counter({0: 1564, 1: 1514, 2: 1419, 3: 971, 4: 736, 5: 718, 6: 295, 7: 63, 8: 9, 9: 5})
On pattern 1
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 378 samples in 0.003s...
[t-SNE] Computed neighbors for 378 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 378 / 378
[t-SNE] Mean sigma: 0.338161
[t-SNE] Computed conditional probabilities in 0.027s
[t-SNE] Iteration 50: error = 63.8067703, gradient norm = 0.5187496 (50 iterations in 0.042s)
[t-SNE] Iteration 100: error = 67.0401764, gradient norm = 0.4922173 (50 iterations in 0.043s)
[t-SNE] Iteration 150: error = 66.9959869, gradient norm = 0.4862352 (50 iterations in 0.044s)
[t-SNE] Iteration 200: error = 67.1325760, gradient norm = 0.4870957 (50 iterations in 0.044s)
[t-SNE] Iteration 250: error = 70.9049988, gradient norm = 0.4327418 (50 iterations in 0.043s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 70.904999
[t-SNE] Iteration 300: error = 1.2996018, gradient norm = 0.0039401 (50 iterations in 0.042s)
[t-SNE] Iteration 350: error = 1.2322464, gradient norm = 0.0008688 (50 iterations in 0.041s)
[t-SNE] Iteration 400: error = 1.2088137, gradient norm = 0.0009904 (50 iterations in 0.043s)
[t-SNE] Iteration 450: error = 1.1562896, gradient norm = 0.0015007 (50 iterations in 0.043s)
[t-SNE] Iteration 500: error = 1.1310927, gradient norm = 0.0008239 (50 iterations in 0.044s)
[t-SNE] Iteration 550: error = 1.1265365, gradient norm = 0.0005446 (50 iterations in 0.043s)
[t-SNE] Iteration 600: error = 1.1083082, gradient norm = 0.0009246 (50 iterations in 0.041s)
[t-SNE] Iteration 650: error = 1.1064190, gradient norm = 0.0001925 (50 iterations in 0.041s)
[t-SNE] Iteration 700: error = 1.1057661, gradient norm = 0.0002920 (50 iterations in 0.045s)
[t-SNE] Iteration 750: error = 1.1035039, gradient norm = 0.0000796 (50 iterations in 0.044s)
[t-SNE] Iteration 800: error = 1.1034428, gradient norm = 0.0000588 (50 iterations in 0.045s)
[t-SNE] Iteration 850: error = 1.1035793, gradient norm = 0.0001854 (50 iterations in 0.044s)
[t-SNE] Iteration 900: error = 1.1034083, gradient norm = 0.0000964 (50 iterations in 0.043s)
[t-SNE] Iteration 950: error = 1.1033658, gradient norm = 0.0000663 (50 iterations in 0.045s)
[t-SNE] Iteration 1000: error = 1.1032687, gradient norm = 0.0000626 (50 iterations in 0.044s)
[t-SNE] KL divergence after 1000 iterations: 1.103269
[t-SNE] Computed conditional probabilities for sample 378 / 378
[t-SNE] Mean sigma: 0.338161
Beginning preprocessing + Leiden
2024-03-16 18:53:04.881236 MEMORY 18.220429312
Affmat transformed
2024-03-16 18:53:04.886286 MEMORY 18.220429312
sources, targets, weights extracted
2024-03-16 18:53:04.888959 MEMORY 18.220429312
About to launch parallel Leiden runs
2024-03-16 18:53:04.894736 MEMORY 18.220429312
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.1s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    3.2s finished
Parallel Leiden runs finished
2024-03-16 18:53:08.127600 MEMORY 18.220429312
Quality: 0.35844279123990325
Quality: 0.3587173108166034
Quality: 0.35945474767462476
Quality: 0.3602727463573426
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 349 out of 349 | elapsed:    0.1s finished
Got subclusters: Counter({0: 85, 1: 73, 2: 73, 3: 56, 4: 53, 5: 38})
On pattern 2
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 349 samples in 0.003s...
[t-SNE] Computed neighbors for 349 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 349 / 349
[t-SNE] Mean sigma: 0.370970
[t-SNE] Computed conditional probabilities in 0.025s
[t-SNE] Iteration 50: error = 62.9838829, gradient norm = 0.5085061 (50 iterations in 0.044s)
[t-SNE] Iteration 100: error = 62.8269348, gradient norm = 0.5446911 (50 iterations in 0.043s)
[t-SNE] Iteration 150: error = 65.7206879, gradient norm = 0.5041951 (50 iterations in 0.043s)
[t-SNE] Iteration 200: error = 64.7301407, gradient norm = 0.5036862 (50 iterations in 0.046s)
[t-SNE] Iteration 250: error = 66.3593063, gradient norm = 0.4829468 (50 iterations in 0.045s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 66.359306
[t-SNE] Iteration 300: error = 1.2915964, gradient norm = 0.0040134 (50 iterations in 0.045s)
[t-SNE] Iteration 350: error = 1.1971713, gradient norm = 0.0033232 (50 iterations in 0.040s)
[t-SNE] Iteration 400: error = 1.1526390, gradient norm = 0.0015962 (50 iterations in 0.041s)
[t-SNE] Iteration 450: error = 1.1375943, gradient norm = 0.0005974 (50 iterations in 0.041s)
[t-SNE] Iteration 500: error = 1.1367627, gradient norm = 0.0001243 (50 iterations in 0.042s)
[t-SNE] Iteration 550: error = 1.1365616, gradient norm = 0.0001140 (50 iterations in 0.045s)
[t-SNE] Iteration 600: error = 1.1365130, gradient norm = 0.0001323 (50 iterations in 0.042s)
[t-SNE] Iteration 650: error = 1.1365262, gradient norm = 0.0000993 (50 iterations in 0.041s)
[t-SNE] Iteration 700: error = 1.1364816, gradient norm = 0.0000928 (50 iterations in 0.043s)
[t-SNE] Iteration 750: error = 1.1365718, gradient norm = 0.0001114 (50 iterations in 0.041s)
[t-SNE] Iteration 800: error = 1.1369764, gradient norm = 0.0001431 (50 iterations in 0.044s)
[t-SNE] Iteration 850: error = 1.1344111, gradient norm = 0.0002559 (50 iterations in 0.041s)
[t-SNE] Iteration 900: error = 1.1341304, gradient norm = 0.0001612 (50 iterations in 0.042s)
[t-SNE] Iteration 950: error = 1.1340292, gradient norm = 0.0000527 (50 iterations in 0.042s)
[t-SNE] Iteration 1000: error = 1.1340362, gradient norm = 0.0000549 (50 iterations in 0.041s)
[t-SNE] KL divergence after 1000 iterations: 1.134036
[t-SNE] Computed conditional probabilities for sample 349 / 349
[t-SNE] Mean sigma: 0.370970
Beginning preprocessing + Leiden
2024-03-16 18:53:09.483069 MEMORY 18.220429312
Affmat transformed
2024-03-16 18:53:09.487913 MEMORY 18.220429312
sources, targets, weights extracted
2024-03-16 18:53:09.490232 MEMORY 18.220429312
About to launch parallel Leiden runs
2024-03-16 18:53:09.495831 MEMORY 18.220429312
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.1s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    3.1s finished
Parallel Leiden runs finished
2024-03-16 18:53:12.595323 MEMORY 18.220429312
Quality: 0.36118247474628506
Quality: 0.3612618068643368
Quality: 0.3612881914720401
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 349 out of 349 | elapsed:    0.1s finished
Got subclusters: Counter({0: 80, 1: 73, 2: 70, 3: 46, 4: 40, 5: 40})
On pattern 3
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 349 samples in 0.003s...
[t-SNE] Computed neighbors for 349 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 349 / 349
[t-SNE] Mean sigma: 0.364352
[t-SNE] Computed conditional probabilities in 0.024s
[t-SNE] Iteration 50: error = 66.3370743, gradient norm = 0.4699769 (50 iterations in 0.045s)
[t-SNE] Iteration 100: error = 66.7262726, gradient norm = 0.4920426 (50 iterations in 0.043s)
[t-SNE] Iteration 150: error = 67.1156845, gradient norm = 0.4567360 (50 iterations in 0.042s)
[t-SNE] Iteration 200: error = 69.2314987, gradient norm = 0.4731045 (50 iterations in 0.044s)
[t-SNE] Iteration 250: error = 70.6644669, gradient norm = 0.4618894 (50 iterations in 0.047s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 70.664467
[t-SNE] Iteration 300: error = 1.2923293, gradient norm = 0.0051422 (50 iterations in 0.043s)
[t-SNE] Iteration 350: error = 1.1773463, gradient norm = 0.0031412 (50 iterations in 0.042s)
[t-SNE] Iteration 400: error = 1.1140852, gradient norm = 0.0024374 (50 iterations in 0.047s)
[t-SNE] Iteration 450: error = 1.0756477, gradient norm = 0.0020673 (50 iterations in 0.039s)
[t-SNE] Iteration 500: error = 1.0390331, gradient norm = 0.0006333 (50 iterations in 0.041s)
[t-SNE] Iteration 550: error = 1.0301675, gradient norm = 0.0003745 (50 iterations in 0.040s)
[t-SNE] Iteration 600: error = 1.0288849, gradient norm = 0.0003675 (50 iterations in 0.039s)
[t-SNE] Iteration 650: error = 1.0157018, gradient norm = 0.0006623 (50 iterations in 0.040s)
[t-SNE] Iteration 700: error = 1.0143361, gradient norm = 0.0001074 (50 iterations in 0.039s)
[t-SNE] Iteration 750: error = 1.0140939, gradient norm = 0.0001113 (50 iterations in 0.040s)
[t-SNE] Iteration 800: error = 1.0139015, gradient norm = 0.0000487 (50 iterations in 0.039s)
[t-SNE] Iteration 850: error = 1.0138727, gradient norm = 0.0001123 (50 iterations in 0.040s)
[t-SNE] Iteration 900: error = 1.0140696, gradient norm = 0.0000784 (50 iterations in 0.039s)
[t-SNE] Iteration 950: error = 1.0137672, gradient norm = 0.0001101 (50 iterations in 0.040s)
[t-SNE] Iteration 1000: error = 1.0140063, gradient norm = 0.0000948 (50 iterations in 0.041s)
[t-SNE] KL divergence after 1000 iterations: 1.014006
[t-SNE] Computed conditional probabilities for sample 349 / 349
[t-SNE] Mean sigma: 0.364352
Beginning preprocessing + Leiden
2024-03-16 18:53:13.928581 MEMORY 18.220429312
Affmat transformed
2024-03-16 18:53:13.936377 MEMORY 18.220429312
sources, targets, weights extracted
2024-03-16 18:53:13.938791 MEMORY 18.220429312
About to launch parallel Leiden runs
2024-03-16 18:53:13.944005 MEMORY 18.220429312
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.0s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    3.0s finished
Parallel Leiden runs finished
2024-03-16 18:53:16.989680 MEMORY 18.220429312
Quality: 0.38781870347808833
Quality: 0.38795863721625123
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 300 out of 347 | elapsed:    0.1s remaining:    0.0s
[Parallel(n_jobs=24)]: Done 347 out of 347 | elapsed:    0.1s finished
Got subclusters: Counter({0: 78, 2: 77, 1: 77, 3: 64, 4: 53})
On pattern 4
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 347 samples in 0.003s...
[t-SNE] Computed neighbors for 347 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 347 / 347
[t-SNE] Mean sigma: 0.373052
[t-SNE] Computed conditional probabilities in 0.024s
[t-SNE] Iteration 50: error = 65.8826141, gradient norm = 0.4855896 (50 iterations in 0.042s)
[t-SNE] Iteration 100: error = 69.4797897, gradient norm = 0.4886999 (50 iterations in 0.041s)
[t-SNE] Iteration 150: error = 72.2705994, gradient norm = 0.4154736 (50 iterations in 0.043s)
[t-SNE] Iteration 200: error = 68.3012772, gradient norm = 0.4625631 (50 iterations in 0.042s)
[t-SNE] Iteration 250: error = 66.9048080, gradient norm = 0.4876028 (50 iterations in 0.043s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 66.904808
[t-SNE] Iteration 300: error = 1.2315406, gradient norm = 0.0053380 (50 iterations in 0.040s)
[t-SNE] Iteration 350: error = 1.0819027, gradient norm = 0.0022121 (50 iterations in 0.039s)
[t-SNE] Iteration 400: error = 1.0501187, gradient norm = 0.0009518 (50 iterations in 0.038s)
[t-SNE] Iteration 450: error = 1.0206647, gradient norm = 0.0017832 (50 iterations in 0.040s)
[t-SNE] Iteration 500: error = 1.0109197, gradient norm = 0.0005341 (50 iterations in 0.039s)
[t-SNE] Iteration 550: error = 1.0066667, gradient norm = 0.0006585 (50 iterations in 0.039s)
[t-SNE] Iteration 600: error = 1.0014629, gradient norm = 0.0009636 (50 iterations in 0.037s)
[t-SNE] Iteration 650: error = 0.9997598, gradient norm = 0.0001132 (50 iterations in 0.039s)
[t-SNE] Iteration 700: error = 0.9996385, gradient norm = 0.0000405 (50 iterations in 0.039s)
[t-SNE] Iteration 750: error = 0.9996564, gradient norm = 0.0000691 (50 iterations in 0.039s)
[t-SNE] Iteration 800: error = 0.9996490, gradient norm = 0.0000448 (50 iterations in 0.038s)
[t-SNE] Iteration 850: error = 0.9995973, gradient norm = 0.0000441 (50 iterations in 0.040s)
[t-SNE] Iteration 900: error = 0.9996151, gradient norm = 0.0000485 (50 iterations in 0.039s)
[t-SNE] Iteration 950: error = 0.9995837, gradient norm = 0.0000694 (50 iterations in 0.038s)
[t-SNE] Iteration 1000: error = 0.9996050, gradient norm = 0.0000566 (50 iterations in 0.041s)
[t-SNE] KL divergence after 1000 iterations: 0.999605
[t-SNE] Computed conditional probabilities for sample 347 / 347
[t-SNE] Mean sigma: 0.373052
Beginning preprocessing + Leiden
2024-03-16 18:53:18.284826 MEMORY 18.220429312
Affmat transformed
2024-03-16 18:53:18.289546 MEMORY 18.220429312
sources, targets, weights extracted
2024-03-16 18:53:18.291901 MEMORY 18.220429312
About to launch parallel Leiden runs
2024-03-16 18:53:18.296995 MEMORY 18.220429312
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.0s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    3.2s finished
Parallel Leiden runs finished
2024-03-16 18:53:21.504280 MEMORY 18.220429312
Quality: 0.39485101605351025
Quality: 0.3977373299095911
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 346 out of 346 | elapsed:    0.1s finished
Got subclusters: Counter({0: 89, 1: 59, 2: 56, 4: 52, 3: 52, 5: 39})
On pattern 5
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 346 samples in 0.003s...
[t-SNE] Computed neighbors for 346 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 346 / 346
[t-SNE] Mean sigma: 0.367208
[t-SNE] Computed conditional probabilities in 0.024s
[t-SNE] Iteration 50: error = 64.5397186, gradient norm = 0.4938504 (50 iterations in 0.044s)
[t-SNE] Iteration 100: error = 68.4285507, gradient norm = 0.4684803 (50 iterations in 0.042s)
[t-SNE] Iteration 150: error = 67.4924850, gradient norm = 0.4666595 (50 iterations in 0.041s)
[t-SNE] Iteration 200: error = 69.3081741, gradient norm = 0.4819714 (50 iterations in 0.044s)
[t-SNE] Iteration 250: error = 66.5860519, gradient norm = 0.4787829 (50 iterations in 0.043s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 66.586052
[t-SNE] Iteration 300: error = 1.2713274, gradient norm = 0.0038153 (50 iterations in 0.041s)
[t-SNE] Iteration 350: error = 1.1695192, gradient norm = 0.0021423 (50 iterations in 0.039s)
[t-SNE] Iteration 400: error = 1.1251051, gradient norm = 0.0023058 (50 iterations in 0.039s)
[t-SNE] Iteration 450: error = 1.0970140, gradient norm = 0.0012416 (50 iterations in 0.039s)
[t-SNE] Iteration 500: error = 1.0943874, gradient norm = 0.0001612 (50 iterations in 0.039s)
[t-SNE] Iteration 550: error = 1.0941381, gradient norm = 0.0001431 (50 iterations in 0.037s)
[t-SNE] Iteration 600: error = 1.0940611, gradient norm = 0.0000933 (50 iterations in 0.039s)
[t-SNE] Iteration 650: error = 1.0941892, gradient norm = 0.0000743 (50 iterations in 0.039s)
[t-SNE] Iteration 700: error = 1.0941764, gradient norm = 0.0000780 (50 iterations in 0.039s)
[t-SNE] Iteration 750: error = 1.0942807, gradient norm = 0.0000518 (50 iterations in 0.038s)
[t-SNE] Iteration 800: error = 1.0942409, gradient norm = 0.0000442 (50 iterations in 0.039s)
[t-SNE] Iteration 850: error = 1.0943294, gradient norm = 0.0000685 (50 iterations in 0.039s)
[t-SNE] Iteration 900: error = 1.0943536, gradient norm = 0.0000479 (50 iterations in 0.039s)
[t-SNE] Iteration 950: error = 1.0943321, gradient norm = 0.0000512 (50 iterations in 0.037s)
[t-SNE] Iteration 950: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 950 iterations: 1.094332
[t-SNE] Computed conditional probabilities for sample 346 / 346
[t-SNE] Mean sigma: 0.367208
Beginning preprocessing + Leiden
2024-03-16 18:53:22.761117 MEMORY 18.220429312
Affmat transformed
2024-03-16 18:53:22.765783 MEMORY 18.220429312
sources, targets, weights extracted
2024-03-16 18:53:22.768215 MEMORY 18.220429312
About to launch parallel Leiden runs
2024-03-16 18:53:22.773336 MEMORY 18.220429312
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.1s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    3.0s finished
Parallel Leiden runs finished
2024-03-16 18:53:25.758751 MEMORY 18.220429312
Quality: 0.33915713351572957
Quality: 0.33968388680191347
Quality: 0.3398167899851883
Quality: 0.3402804237321383
Quality: 0.34130413973797935
Quality: 0.3420922470856715
Quality: 0.3421696709636331
Quality: 0.34245038913894815
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 272 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 327 out of 327 | elapsed:    0.1s finished
Got subclusters: Counter({0: 92, 1: 73, 2: 70, 3: 63, 4: 48})
On pattern 6
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 327 samples in 0.003s...
[t-SNE] Computed neighbors for 327 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 327 / 327
[t-SNE] Mean sigma: 0.359859
[t-SNE] Computed conditional probabilities in 0.023s
[t-SNE] Iteration 50: error = 62.0582657, gradient norm = 0.5346712 (50 iterations in 0.044s)
[t-SNE] Iteration 100: error = 65.8597870, gradient norm = 0.4796011 (50 iterations in 0.039s)
[t-SNE] Iteration 150: error = 66.0675354, gradient norm = 0.4807360 (50 iterations in 0.040s)
[t-SNE] Iteration 200: error = 66.4891586, gradient norm = 0.4736514 (50 iterations in 0.040s)
[t-SNE] Iteration 250: error = 69.2526474, gradient norm = 0.4382191 (50 iterations in 0.041s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 69.252647
[t-SNE] Iteration 300: error = 1.3469687, gradient norm = 0.0054859 (50 iterations in 0.041s)
[t-SNE] Iteration 350: error = 1.0935152, gradient norm = 0.0039547 (50 iterations in 0.041s)
[t-SNE] Iteration 400: error = 1.0113970, gradient norm = 0.0029990 (50 iterations in 0.040s)
[t-SNE] Iteration 450: error = 0.9943829, gradient norm = 0.0008392 (50 iterations in 0.041s)
[t-SNE] Iteration 500: error = 0.9729429, gradient norm = 0.0016929 (50 iterations in 0.038s)
[t-SNE] Iteration 550: error = 0.9597626, gradient norm = 0.0006701 (50 iterations in 0.039s)
[t-SNE] Iteration 600: error = 0.9593399, gradient norm = 0.0001833 (50 iterations in 0.041s)
[t-SNE] Iteration 650: error = 0.9573584, gradient norm = 0.0004995 (50 iterations in 0.042s)
[t-SNE] Iteration 700: error = 0.9561942, gradient norm = 0.0001221 (50 iterations in 0.040s)
[t-SNE] Iteration 750: error = 0.9556128, gradient norm = 0.0003322 (50 iterations in 0.038s)
[t-SNE] Iteration 800: error = 0.9535388, gradient norm = 0.0001816 (50 iterations in 0.040s)
[t-SNE] Iteration 850: error = 0.9522977, gradient norm = 0.0002503 (50 iterations in 0.039s)
[t-SNE] Iteration 900: error = 0.9523012, gradient norm = 0.0001308 (50 iterations in 0.040s)
[t-SNE] Iteration 950: error = 0.9523423, gradient norm = 0.0000869 (50 iterations in 0.039s)
[t-SNE] Iteration 1000: error = 0.9523187, gradient norm = 0.0000865 (50 iterations in 0.040s)
[t-SNE] KL divergence after 1000 iterations: 0.952319
[t-SNE] Computed conditional probabilities for sample 327 / 327
[t-SNE] Mean sigma: 0.359859
Beginning preprocessing + Leiden
2024-03-16 18:53:27.061813 MEMORY 18.220433408
Affmat transformed
2024-03-16 18:53:27.066562 MEMORY 18.220433408
sources, targets, weights extracted
2024-03-16 18:53:27.068926 MEMORY 18.220433408
About to launch parallel Leiden runs
2024-03-16 18:53:27.074775 MEMORY 18.220433408
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.0s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    3.0s finished
Parallel Leiden runs finished
2024-03-16 18:53:30.082051 MEMORY 18.220433408
Quality: 0.3849767203344881
Quality: 0.3850837149979256
Quality: 0.38570643947711736
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 316 out of 316 | elapsed:    0.1s finished
Got subclusters: Counter({0: 90, 1: 77, 2: 65, 3: 61, 4: 29, 5: 5})
On pattern 7
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 316 samples in 0.003s...
[t-SNE] Computed neighbors for 316 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 316 / 316
[t-SNE] Mean sigma: 0.356758
[t-SNE] Computed conditional probabilities in 0.022s
[t-SNE] Iteration 50: error = 62.0420799, gradient norm = 0.5283718 (50 iterations in 0.039s)
[t-SNE] Iteration 100: error = 64.8411102, gradient norm = 0.4936840 (50 iterations in 0.043s)
[t-SNE] Iteration 150: error = 63.9138451, gradient norm = 0.5243222 (50 iterations in 0.042s)
[t-SNE] Iteration 200: error = 63.0459595, gradient norm = 0.5342075 (50 iterations in 0.041s)
[t-SNE] Iteration 250: error = 64.5208664, gradient norm = 0.5043945 (50 iterations in 0.041s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 64.520866
[t-SNE] Iteration 300: error = 1.2397590, gradient norm = 0.0049017 (50 iterations in 0.039s)
[t-SNE] Iteration 350: error = 1.1005472, gradient norm = 0.0033232 (50 iterations in 0.040s)
[t-SNE] Iteration 400: error = 1.0688589, gradient norm = 0.0009075 (50 iterations in 0.038s)
[t-SNE] Iteration 450: error = 1.0434088, gradient norm = 0.0006201 (50 iterations in 0.037s)
[t-SNE] Iteration 500: error = 1.0405924, gradient norm = 0.0002673 (50 iterations in 0.039s)
[t-SNE] Iteration 550: error = 1.0400105, gradient norm = 0.0001486 (50 iterations in 0.041s)
[t-SNE] Iteration 600: error = 1.0397704, gradient norm = 0.0001156 (50 iterations in 0.040s)
[t-SNE] Iteration 650: error = 1.0399199, gradient norm = 0.0000568 (50 iterations in 0.040s)
[t-SNE] Iteration 700: error = 1.0397902, gradient norm = 0.0001092 (50 iterations in 0.037s)
[t-SNE] Iteration 750: error = 1.0398448, gradient norm = 0.0001357 (50 iterations in 0.038s)
[t-SNE] Iteration 800: error = 1.0398432, gradient norm = 0.0000897 (50 iterations in 0.039s)
[t-SNE] Iteration 850: error = 1.0397795, gradient norm = 0.0000773 (50 iterations in 0.038s)
[t-SNE] Iteration 900: error = 1.0397557, gradient norm = 0.0000976 (50 iterations in 0.040s)
[t-SNE] Iteration 950: error = 1.0398000, gradient norm = 0.0000319 (50 iterations in 0.039s)
[t-SNE] Iteration 1000: error = 1.0397666, gradient norm = 0.0000430 (50 iterations in 0.039s)
[t-SNE] KL divergence after 1000 iterations: 1.039767
[t-SNE] Computed conditional probabilities for sample 316 / 316
[t-SNE] Mean sigma: 0.356758
Beginning preprocessing + Leiden
2024-03-16 18:53:31.357106 MEMORY 18.220433408
Affmat transformed
2024-03-16 18:53:31.361573 MEMORY 18.220433408
sources, targets, weights extracted
2024-03-16 18:53:31.363921 MEMORY 18.220433408
About to launch parallel Leiden runs
2024-03-16 18:53:31.369805 MEMORY 18.220433408
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.0s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    3.1s finished
Parallel Leiden runs finished
2024-03-16 18:53:34.482588 MEMORY 18.220433408
Quality: 0.32978230989795393
Quality: 0.3309934569150471
Quality: 0.33109593943651333
Quality: 0.33130840315756677
Quality: 0.33132716634999354
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 295 out of 295 | elapsed:    0.1s finished
Got subclusters: Counter({0: 81, 1: 65, 2: 57, 3: 39, 4: 33, 5: 30, 6: 11})
On pattern 8
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 295 samples in 0.003s...
[t-SNE] Computed neighbors for 295 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 295 / 295
[t-SNE] Mean sigma: 0.369025
[t-SNE] Computed conditional probabilities in 0.021s
[t-SNE] Iteration 50: error = 65.8096085, gradient norm = 0.4564201 (50 iterations in 0.037s)
[t-SNE] Iteration 100: error = 65.6499710, gradient norm = 0.5002599 (50 iterations in 0.040s)
[t-SNE] Iteration 150: error = 68.9144516, gradient norm = 0.4582257 (50 iterations in 0.039s)
[t-SNE] Iteration 200: error = 67.3100433, gradient norm = 0.4797708 (50 iterations in 0.040s)
[t-SNE] Iteration 250: error = 71.7395172, gradient norm = 0.4553088 (50 iterations in 0.040s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 71.739517
[t-SNE] Iteration 300: error = 1.3516909, gradient norm = 0.0055212 (50 iterations in 0.039s)
[t-SNE] Iteration 350: error = 1.0868083, gradient norm = 0.0050732 (50 iterations in 0.038s)
[t-SNE] Iteration 400: error = 0.9541773, gradient norm = 0.0021821 (50 iterations in 0.037s)
[t-SNE] Iteration 450: error = 0.9425989, gradient norm = 0.0008825 (50 iterations in 0.037s)
[t-SNE] Iteration 500: error = 0.9345666, gradient norm = 0.0005400 (50 iterations in 0.038s)
[t-SNE] Iteration 550: error = 0.9336634, gradient norm = 0.0002332 (50 iterations in 0.039s)
[t-SNE] Iteration 600: error = 0.9336129, gradient norm = 0.0001138 (50 iterations in 0.037s)
[t-SNE] Iteration 650: error = 0.9335961, gradient norm = 0.0000723 (50 iterations in 0.041s)
[t-SNE] Iteration 700: error = 0.9336255, gradient norm = 0.0001057 (50 iterations in 0.038s)
[t-SNE] Iteration 750: error = 0.9336085, gradient norm = 0.0000852 (50 iterations in 0.039s)
[t-SNE] Iteration 800: error = 0.9335931, gradient norm = 0.0001211 (50 iterations in 0.037s)
[t-SNE] Iteration 850: error = 0.9336111, gradient norm = 0.0000818 (50 iterations in 0.037s)
[t-SNE] Iteration 900: error = 0.9336283, gradient norm = 0.0000957 (50 iterations in 0.040s)
[t-SNE] Iteration 950: error = 0.9336184, gradient norm = 0.0001123 (50 iterations in 0.042s)
[t-SNE] Iteration 1000: error = 0.9336122, gradient norm = 0.0000643 (50 iterations in 0.037s)
[t-SNE] KL divergence after 1000 iterations: 0.933612
[t-SNE] Computed conditional probabilities for sample 295 / 295
[t-SNE] Mean sigma: 0.369024
Beginning preprocessing + Leiden
2024-03-16 18:53:35.703649 MEMORY 18.220437504
Affmat transformed
2024-03-16 18:53:35.707972 MEMORY 18.220437504
sources, targets, weights extracted
2024-03-16 18:53:35.710102 MEMORY 18.220437504
About to launch parallel Leiden runs
2024-03-16 18:53:35.731771 MEMORY 18.220437504
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.0s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.8s finished
Parallel Leiden runs finished
2024-03-16 18:53:38.571677 MEMORY 18.220437504
Quality: 0.3346450597829339
Quality: 0.3349197747744721
Quality: 0.3367021548344394
Quality: 0.3367096005876932
Quality: 0.3373236312123132
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 273 out of 273 | elapsed:    0.1s finished
Got subclusters: Counter({0: 89, 1: 72, 2: 72, 3: 46, 4: 16})
On pattern 9
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 273 samples in 0.002s...
[t-SNE] Computed neighbors for 273 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 273 / 273
[t-SNE] Mean sigma: 0.306270
[t-SNE] Computed conditional probabilities in 0.020s
[t-SNE] Iteration 50: error = 59.0708084, gradient norm = 0.5139162 (50 iterations in 0.037s)
[t-SNE] Iteration 100: error = 61.3458138, gradient norm = 0.5237356 (50 iterations in 0.039s)
[t-SNE] Iteration 150: error = 61.9661484, gradient norm = 0.5325106 (50 iterations in 0.037s)
[t-SNE] Iteration 200: error = 66.3720703, gradient norm = 0.4808419 (50 iterations in 0.040s)
[t-SNE] Iteration 250: error = 66.4793320, gradient norm = 0.4853209 (50 iterations in 0.036s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 66.479332
[t-SNE] Iteration 300: error = 0.9820120, gradient norm = 0.0046530 (50 iterations in 0.036s)
[t-SNE] Iteration 350: error = 0.8070518, gradient norm = 0.0034574 (50 iterations in 0.037s)
[t-SNE] Iteration 400: error = 0.7775788, gradient norm = 0.0016037 (50 iterations in 0.037s)
[t-SNE] Iteration 450: error = 0.7711237, gradient norm = 0.0006992 (50 iterations in 0.037s)
[t-SNE] Iteration 500: error = 0.7384965, gradient norm = 0.0009007 (50 iterations in 0.037s)
[t-SNE] Iteration 550: error = 0.7377561, gradient norm = 0.0003504 (50 iterations in 0.037s)
[t-SNE] Iteration 600: error = 0.7351556, gradient norm = 0.0005637 (50 iterations in 0.038s)
[t-SNE] Iteration 650: error = 0.7350550, gradient norm = 0.0000800 (50 iterations in 0.036s)
[t-SNE] Iteration 700: error = 0.7351289, gradient norm = 0.0001443 (50 iterations in 0.040s)
[t-SNE] Iteration 750: error = 0.7352168, gradient norm = 0.0000326 (50 iterations in 0.036s)
[t-SNE] Iteration 800: error = 0.7351475, gradient norm = 0.0000344 (50 iterations in 0.037s)
[t-SNE] Iteration 850: error = 0.7351863, gradient norm = 0.0000796 (50 iterations in 0.038s)
[t-SNE] Iteration 900: error = 0.7351666, gradient norm = 0.0000566 (50 iterations in 0.037s)
[t-SNE] Iteration 950: error = 0.7351738, gradient norm = 0.0000429 (50 iterations in 0.038s)
[t-SNE] Iteration 1000: error = 0.7351633, gradient norm = 0.0000311 (50 iterations in 0.039s)
[t-SNE] Iteration 1000: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 1000 iterations: 0.735163
[t-SNE] Computed conditional probabilities for sample 273 / 273
[t-SNE] Mean sigma: 0.306270
Beginning preprocessing + Leiden
2024-03-16 18:53:39.738797 MEMORY 18.2204416
Affmat transformed
2024-03-16 18:53:39.742810 MEMORY 18.2204416
sources, targets, weights extracted
2024-03-16 18:53:39.744838 MEMORY 18.2204416
About to launch parallel Leiden runs
2024-03-16 18:53:39.750390 MEMORY 18.2204416
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.9s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.7s finished
Parallel Leiden runs finished
2024-03-16 18:53:42.481184 MEMORY 18.2204416
Quality: 0.34487283426242843
Quality: 0.3455467959512485
Quality: 0.3457367713087718
Quality: 0.34573933921397304
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 226 out of 226 | elapsed:    0.1s finished
Got subclusters: Counter({0: 84, 1: 71, 2: 68, 3: 47, 4: 3})
On pattern 10
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 226 samples in 0.002s...
[t-SNE] Computed neighbors for 226 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 226 / 226
[t-SNE] Mean sigma: 0.392965
[t-SNE] Computed conditional probabilities in 0.015s
[t-SNE] Iteration 50: error = 60.0521088, gradient norm = 0.5280865 (50 iterations in 0.033s)
[t-SNE] Iteration 100: error = 59.7362213, gradient norm = 0.5067363 (50 iterations in 0.034s)
[t-SNE] Iteration 150: error = 61.8701553, gradient norm = 0.4619173 (50 iterations in 0.032s)
[t-SNE] Iteration 200: error = 60.1393051, gradient norm = 0.5101176 (50 iterations in 0.032s)
[t-SNE] Iteration 250: error = 60.8423386, gradient norm = 0.5125144 (50 iterations in 0.035s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 60.842339
[t-SNE] Iteration 300: error = 0.9471444, gradient norm = 0.0060958 (50 iterations in 0.033s)
[t-SNE] Iteration 350: error = 0.8637366, gradient norm = 0.0021762 (50 iterations in 0.032s)
[t-SNE] Iteration 400: error = 0.8401779, gradient norm = 0.0003457 (50 iterations in 0.032s)
[t-SNE] Iteration 450: error = 0.8404977, gradient norm = 0.0001713 (50 iterations in 0.033s)
[t-SNE] Iteration 500: error = 0.8401985, gradient norm = 0.0001768 (50 iterations in 0.032s)
[t-SNE] Iteration 550: error = 0.8401899, gradient norm = 0.0002062 (50 iterations in 0.031s)
[t-SNE] Iteration 600: error = 0.8403186, gradient norm = 0.0001333 (50 iterations in 0.030s)
[t-SNE] Iteration 650: error = 0.8404220, gradient norm = 0.0001320 (50 iterations in 0.031s)
[t-SNE] Iteration 700: error = 0.8402684, gradient norm = 0.0001238 (50 iterations in 0.031s)
[t-SNE] Iteration 750: error = 0.8403907, gradient norm = 0.0001713 (50 iterations in 0.030s)
[t-SNE] Iteration 750: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 750 iterations: 0.840391
[t-SNE] Computed conditional probabilities for sample 226 / 226
[t-SNE] Mean sigma: 0.392964
Beginning preprocessing + Leiden
2024-03-16 18:53:43.329135 MEMORY 18.2204416
Affmat transformed
2024-03-16 18:53:43.332437 MEMORY 18.2204416
sources, targets, weights extracted
2024-03-16 18:53:43.333852 MEMORY 18.2204416
About to launch parallel Leiden runs
2024-03-16 18:53:43.338876 MEMORY 18.2204416
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.8s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.4s finished
Parallel Leiden runs finished
2024-03-16 18:53:45.758768 MEMORY 18.2204416
Quality: 0.3065428829492476
Quality: 0.3077728802416443
Quality: 0.3080878414297208
Quality: 0.3085414098300979
Quality: 0.3096023688119271
Quality: 0.30960655501337836
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 220 out of 220 | elapsed:    0.1s finished
Got subclusters: Counter({0: 63, 1: 53, 2: 53, 3: 37, 4: 20})
On pattern 11
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 220 samples in 0.002s...
[t-SNE] Computed neighbors for 220 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 220 / 220
[t-SNE] Mean sigma: 0.384375
[t-SNE] Computed conditional probabilities in 0.015s
[t-SNE] Iteration 50: error = 59.8876152, gradient norm = 0.4974192 (50 iterations in 0.034s)
[t-SNE] Iteration 100: error = 60.5520363, gradient norm = 0.4829795 (50 iterations in 0.033s)
[t-SNE] Iteration 150: error = 60.7050972, gradient norm = 0.5074214 (50 iterations in 0.030s)
[t-SNE] Iteration 200: error = 60.7039757, gradient norm = 0.5199091 (50 iterations in 0.032s)
[t-SNE] Iteration 250: error = 59.6920967, gradient norm = 0.5153300 (50 iterations in 0.030s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 59.692097
[t-SNE] Iteration 300: error = 0.9366117, gradient norm = 0.0078548 (50 iterations in 0.031s)
[t-SNE] Iteration 350: error = 0.8043150, gradient norm = 0.0024356 (50 iterations in 0.030s)
[t-SNE] Iteration 400: error = 0.7586546, gradient norm = 0.0013420 (50 iterations in 0.031s)
[t-SNE] Iteration 450: error = 0.7568578, gradient norm = 0.0002380 (50 iterations in 0.031s)
[t-SNE] Iteration 500: error = 0.7571972, gradient norm = 0.0002874 (50 iterations in 0.030s)
[t-SNE] Iteration 550: error = 0.7458663, gradient norm = 0.0006226 (50 iterations in 0.030s)
[t-SNE] Iteration 600: error = 0.7460245, gradient norm = 0.0000923 (50 iterations in 0.032s)
[t-SNE] Iteration 650: error = 0.7459909, gradient norm = 0.0001409 (50 iterations in 0.030s)
[t-SNE] Iteration 700: error = 0.7459709, gradient norm = 0.0001681 (50 iterations in 0.031s)
[t-SNE] Iteration 750: error = 0.7458687, gradient norm = 0.0001139 (50 iterations in 0.030s)
[t-SNE] Iteration 800: error = 0.7459614, gradient norm = 0.0000585 (50 iterations in 0.030s)
[t-SNE] Iteration 850: error = 0.7459415, gradient norm = 0.0000678 (50 iterations in 0.030s)
[t-SNE] Iteration 900: error = 0.7459277, gradient norm = 0.0000917 (50 iterations in 0.032s)
[t-SNE] Iteration 900: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 900 iterations: 0.745928
[t-SNE] Computed conditional probabilities for sample 220 / 220
[t-SNE] Mean sigma: 0.384375
Beginning preprocessing + Leiden
2024-03-16 18:53:46.671188 MEMORY 18.2204416
Affmat transformed
2024-03-16 18:53:46.674433 MEMORY 18.2204416
sources, targets, weights extracted
2024-03-16 18:53:46.675759 MEMORY 18.2204416
About to launch parallel Leiden runs
2024-03-16 18:53:46.680764 MEMORY 18.2204416
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.9s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.4s finished
Parallel Leiden runs finished
2024-03-16 18:53:49.132263 MEMORY 18.2204416
Quality: 0.32618732935612144
Quality: 0.3264339052002438
Quality: 0.32646823512821954
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 196 out of 196 | elapsed:    0.1s finished
Got subclusters: Counter({1: 44, 0: 44, 2: 40, 3: 39, 4: 33, 5: 20})
On pattern 12
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 196 samples in 0.002s...
[t-SNE] Computed neighbors for 196 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 196 / 196
[t-SNE] Mean sigma: 0.414229
[t-SNE] Computed conditional probabilities in 0.014s
[t-SNE] Iteration 50: error = 59.9728165, gradient norm = 0.4870571 (50 iterations in 0.051s)
[t-SNE] Iteration 100: error = 60.3688164, gradient norm = 0.4832257 (50 iterations in 0.033s)
[t-SNE] Iteration 150: error = 59.7348022, gradient norm = 0.4683896 (50 iterations in 0.031s)
[t-SNE] Iteration 200: error = 61.9770050, gradient norm = 0.4975141 (50 iterations in 0.031s)
[t-SNE] Iteration 250: error = 61.3818283, gradient norm = 0.5213216 (50 iterations in 0.030s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 61.381828
[t-SNE] Iteration 300: error = 0.9815483, gradient norm = 0.0061231 (50 iterations in 0.028s)
[t-SNE] Iteration 350: error = 0.7315933, gradient norm = 0.0039466 (50 iterations in 0.028s)
[t-SNE] Iteration 400: error = 0.6835681, gradient norm = 0.0030859 (50 iterations in 0.029s)
[t-SNE] Iteration 450: error = 0.6617936, gradient norm = 0.0004563 (50 iterations in 0.029s)
[t-SNE] Iteration 500: error = 0.6617621, gradient norm = 0.0002120 (50 iterations in 0.028s)
[t-SNE] Iteration 550: error = 0.6617364, gradient norm = 0.0001346 (50 iterations in 0.030s)
[t-SNE] Iteration 600: error = 0.6618224, gradient norm = 0.0002662 (50 iterations in 0.028s)
[t-SNE] Iteration 650: error = 0.6616098, gradient norm = 0.0002567 (50 iterations in 0.029s)
[t-SNE] Iteration 700: error = 0.6618477, gradient norm = 0.0002481 (50 iterations in 0.030s)
[t-SNE] Iteration 750: error = 0.6619301, gradient norm = 0.0002133 (50 iterations in 0.029s)
[t-SNE] Iteration 800: error = 0.6619733, gradient norm = 0.0002796 (50 iterations in 0.032s)
[t-SNE] Iteration 850: error = 0.6616744, gradient norm = 0.0001557 (50 iterations in 0.029s)
[t-SNE] Iteration 900: error = 0.6618035, gradient norm = 0.0002231 (50 iterations in 0.029s)
[t-SNE] Iteration 950: error = 0.6617758, gradient norm = 0.0002538 (50 iterations in 0.028s)
[t-SNE] Iteration 1000: error = 0.6615429, gradient norm = 0.0001672 (50 iterations in 0.030s)
[t-SNE] KL divergence after 1000 iterations: 0.661543
[t-SNE] Computed conditional probabilities for sample 196 / 196
[t-SNE] Mean sigma: 0.414229
Beginning preprocessing + Leiden
2024-03-16 18:53:50.062582 MEMORY 18.2204416
Affmat transformed
2024-03-16 18:53:50.065497 MEMORY 18.2204416
sources, targets, weights extracted
2024-03-16 18:53:50.066633 MEMORY 18.2204416
About to launch parallel Leiden runs
2024-03-16 18:53:50.071599 MEMORY 18.2204416
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.8s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.3s finished
Parallel Leiden runs finished
2024-03-16 18:53:52.408465 MEMORY 18.2204416
Quality: 0.30519957030961986
Quality: 0.3076123080532384
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 176 out of 176 | elapsed:    0.1s finished
Got subclusters: Counter({0: 59, 1: 55, 3: 40, 2: 40, 4: 2})
On pattern 13
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 176 samples in 0.002s...
[t-SNE] Computed neighbors for 176 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 176 / 176
[t-SNE] Mean sigma: 0.448248
[t-SNE] Computed conditional probabilities in 0.012s
[t-SNE] Iteration 50: error = 56.2814255, gradient norm = 0.5476431 (50 iterations in 0.031s)
[t-SNE] Iteration 100: error = 53.9240074, gradient norm = 0.5768094 (50 iterations in 0.029s)
[t-SNE] Iteration 150: error = 56.1813087, gradient norm = 0.5030214 (50 iterations in 0.030s)
[t-SNE] Iteration 200: error = 55.6225204, gradient norm = 0.5206488 (50 iterations in 0.029s)
[t-SNE] Iteration 250: error = 56.5475235, gradient norm = 0.5311468 (50 iterations in 0.028s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 56.547523
[t-SNE] Iteration 300: error = 0.7881265, gradient norm = 0.0059440 (50 iterations in 0.027s)
[t-SNE] Iteration 350: error = 0.6130042, gradient norm = 0.0047271 (50 iterations in 0.027s)
[t-SNE] Iteration 400: error = 0.5930306, gradient norm = 0.0019317 (50 iterations in 0.027s)
[t-SNE] Iteration 450: error = 0.5892265, gradient norm = 0.0002552 (50 iterations in 0.028s)
[t-SNE] Iteration 500: error = 0.5894407, gradient norm = 0.0002034 (50 iterations in 0.027s)
[t-SNE] Iteration 550: error = 0.5894389, gradient norm = 0.0000772 (50 iterations in 0.029s)
[t-SNE] Iteration 600: error = 0.5894476, gradient norm = 0.0000722 (50 iterations in 0.028s)
[t-SNE] Iteration 650: error = 0.5894433, gradient norm = 0.0000733 (50 iterations in 0.027s)
[t-SNE] Iteration 700: error = 0.5894561, gradient norm = 0.0000464 (50 iterations in 0.029s)
[t-SNE] Iteration 750: error = 0.5894365, gradient norm = 0.0000351 (50 iterations in 0.026s)
[t-SNE] Iteration 800: error = 0.5894173, gradient norm = 0.0000703 (50 iterations in 0.027s)
[t-SNE] Iteration 800: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 800 iterations: 0.589417
[t-SNE] Computed conditional probabilities for sample 176 / 176
[t-SNE] Mean sigma: 0.448248
Beginning preprocessing + Leiden
2024-03-16 18:53:53.130485 MEMORY 18.2204416
Affmat transformed
2024-03-16 18:53:53.133082 MEMORY 18.2204416
sources, targets, weights extracted
2024-03-16 18:53:53.134124 MEMORY 18.2204416
About to launch parallel Leiden runs
2024-03-16 18:53:53.139846 MEMORY 18.2204416
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.2s finished
Parallel Leiden runs finished
2024-03-16 18:53:55.334584 MEMORY 18.2204416
Quality: 0.2969928596334139
Quality: 0.2987842235911187
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  76 out of 123 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=24)]: Done 123 out of 123 | elapsed:    0.0s finished
Got subclusters: Counter({0: 35, 2: 32, 1: 32, 3: 28, 4: 27, 5: 22})
On pattern 14
[t-SNE] Computing 122 nearest neighbors...
[t-SNE] Indexed 123 samples in 0.001s...
[t-SNE] Computed neighbors for 123 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 123 / 123
[t-SNE] Mean sigma: 0.448980
[t-SNE] Computed conditional probabilities in 0.007s
[t-SNE] Iteration 50: error = 56.0140572, gradient norm = 0.4482983 (50 iterations in 0.021s)
[t-SNE] Iteration 100: error = 51.7539101, gradient norm = 0.6021014 (50 iterations in 0.020s)
[t-SNE] Iteration 150: error = 54.2659798, gradient norm = 0.4721701 (50 iterations in 0.021s)
[t-SNE] Iteration 200: error = 53.7320747, gradient norm = 0.5538433 (50 iterations in 0.021s)
[t-SNE] Iteration 250: error = 56.0068512, gradient norm = 0.4589686 (50 iterations in 0.021s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 56.006851
[t-SNE] Iteration 300: error = 0.8183683, gradient norm = 0.0104980 (50 iterations in 0.021s)
[t-SNE] Iteration 350: error = 0.4478508, gradient norm = 0.0037066 (50 iterations in 0.021s)
[t-SNE] Iteration 400: error = 0.4465781, gradient norm = 0.0004538 (50 iterations in 0.022s)
[t-SNE] Iteration 450: error = 0.4466569, gradient norm = 0.0003097 (50 iterations in 0.021s)
[t-SNE] Iteration 500: error = 0.4465800, gradient norm = 0.0003726 (50 iterations in 0.021s)
[t-SNE] Iteration 550: error = 0.4466975, gradient norm = 0.0002647 (50 iterations in 0.022s)
[t-SNE] Iteration 600: error = 0.4466739, gradient norm = 0.0003876 (50 iterations in 0.020s)
[t-SNE] Iteration 650: error = 0.4466176, gradient norm = 0.0003329 (50 iterations in 0.022s)
[t-SNE] Iteration 700: error = 0.4466029, gradient norm = 0.0003746 (50 iterations in 0.021s)
[t-SNE] Iteration 750: error = 0.4467133, gradient norm = 0.0002918 (50 iterations in 0.021s)
[t-SNE] Iteration 750: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 750 iterations: 0.446713
[t-SNE] Computed conditional probabilities for sample 123 / 123
[t-SNE] Mean sigma: 0.448980
Beginning preprocessing + Leiden
2024-03-16 18:53:55.833308 MEMORY 18.2204416
Affmat transformed
2024-03-16 18:53:55.835018 MEMORY 18.2204416
sources, targets, weights extracted
2024-03-16 18:53:55.835705 MEMORY 18.2204416
About to launch parallel Leiden runs
2024-03-16 18:53:55.839736 MEMORY 18.2204416
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.0s finished
Parallel Leiden runs finished
2024-03-16 18:53:57.801524 MEMORY 18.2204416
Quality: 0.25687797560589837
Quality: 0.2627515003134488
Quality: 0.2638540908018073
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  93 out of  93 | elapsed:    0.0s finished
Got subclusters: Counter({0: 38, 1: 34, 2: 31, 3: 20})
On pattern 15
[t-SNE] Computing 92 nearest neighbors...
[t-SNE] Indexed 93 samples in 0.001s...
[t-SNE] Computed neighbors for 93 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 93 / 93
[t-SNE] Mean sigma: 0.561588
[t-SNE] Computed conditional probabilities in 0.004s
[t-SNE] Iteration 50: error = 50.6306572, gradient norm = 0.4012527 (50 iterations in 0.023s)
[t-SNE] Iteration 100: error = 53.2437820, gradient norm = 0.5294306 (50 iterations in 0.017s)
[t-SNE] Iteration 150: error = 52.5272865, gradient norm = 0.5188487 (50 iterations in 0.017s)
[t-SNE] Iteration 200: error = 53.2611885, gradient norm = 0.4312937 (50 iterations in 0.016s)
[t-SNE] Iteration 250: error = 51.1636696, gradient norm = 0.5198944 (50 iterations in 0.019s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 51.163670
[t-SNE] Iteration 300: error = 0.7566829, gradient norm = 0.0072172 (50 iterations in 0.028s)
[t-SNE] Iteration 350: error = 0.5134869, gradient norm = 0.0079913 (50 iterations in 0.030s)
[t-SNE] Iteration 400: error = 0.2311298, gradient norm = 0.0096270 (50 iterations in 0.027s)
[t-SNE] Iteration 450: error = 0.2192333, gradient norm = 0.0009602 (50 iterations in 0.033s)
[t-SNE] Iteration 500: error = 0.2192629, gradient norm = 0.0004143 (50 iterations in 0.027s)
[t-SNE] Iteration 550: error = 0.2192750, gradient norm = 0.0002605 (50 iterations in 0.026s)
[t-SNE] Iteration 600: error = 0.2194344, gradient norm = 0.0002510 (50 iterations in 0.026s)
[t-SNE] Iteration 650: error = 0.2192570, gradient norm = 0.0002610 (50 iterations in 0.030s)
[t-SNE] Iteration 700: error = 0.2192800, gradient norm = 0.0001878 (50 iterations in 0.026s)
[t-SNE] Iteration 750: error = 0.2191384, gradient norm = 0.0004901 (50 iterations in 0.026s)
[t-SNE] Iteration 800: error = 0.2190749, gradient norm = 0.0005690 (50 iterations in 0.027s)
[t-SNE] Iteration 850: error = 0.2192970, gradient norm = 0.0002228 (50 iterations in 0.028s)
[t-SNE] Iteration 900: error = 0.2192782, gradient norm = 0.0002213 (50 iterations in 0.028s)
[t-SNE] Iteration 950: error = 0.2192877, gradient norm = 0.0005368 (50 iterations in 0.025s)
[t-SNE] Iteration 1000: error = 0.2192086, gradient norm = 0.0005258 (50 iterations in 0.027s)
[t-SNE] KL divergence after 1000 iterations: 0.219209
[t-SNE] Computed conditional probabilities for sample 93 / 93
[t-SNE] Mean sigma: 0.561588
Beginning preprocessing + Leiden
2024-03-16 18:53:58.426698 MEMORY 18.2204416
Affmat transformed
2024-03-16 18:53:58.428064 MEMORY 18.2204416
sources, targets, weights extracted
2024-03-16 18:53:58.428671 MEMORY 18.2204416
About to launch parallel Leiden runs
2024-03-16 18:53:58.447450 MEMORY 18.2204416
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.6s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.8s finished
Parallel Leiden runs finished
2024-03-16 18:54:00.230486 MEMORY 18.2204416
Quality: 0.25041621755512594
Quality: 0.2511086693371445
Quality: 0.2517877347988029
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  63 out of  63 | elapsed:    0.0s finished
Got subclusters: Counter({0: 43, 1: 30, 2: 20})
On pattern 16
[t-SNE] Computing 62 nearest neighbors...
[t-SNE] Indexed 63 samples in 0.001s...
[t-SNE] Computed neighbors for 63 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 63 / 63
[t-SNE] Mean sigma: 0.685235
[t-SNE] Computed conditional probabilities in 0.002s
[t-SNE] Iteration 50: error = 45.9719086, gradient norm = 0.5458316 (50 iterations in 0.039s)
[t-SNE] Iteration 100: error = 47.3556290, gradient norm = 0.4869123 (50 iterations in 0.013s)
[t-SNE] Iteration 150: error = 51.2016296, gradient norm = 0.4832677 (50 iterations in 0.012s)
[t-SNE] Iteration 200: error = 48.3716888, gradient norm = 0.5874047 (50 iterations in 0.012s)
[t-SNE] Iteration 250: error = 47.2908745, gradient norm = 0.5489153 (50 iterations in 0.013s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 47.290874
[t-SNE] Iteration 300: error = 0.7632815, gradient norm = 0.0013534 (50 iterations in 0.014s)
[t-SNE] Iteration 350: error = 0.6944436, gradient norm = 0.0006524 (50 iterations in 0.013s)
[t-SNE] Iteration 400: error = 0.6432593, gradient norm = 0.0006783 (50 iterations in 0.014s)
[t-SNE] Iteration 450: error = 0.6136265, gradient norm = 0.0002465 (50 iterations in 0.017s)
[t-SNE] Iteration 500: error = 0.5923394, gradient norm = 0.0004407 (50 iterations in 0.013s)
[t-SNE] Iteration 550: error = 0.5659285, gradient norm = 0.0005783 (50 iterations in 0.013s)
[t-SNE] Iteration 600: error = 0.5445789, gradient norm = 0.0004385 (50 iterations in 0.016s)
[t-SNE] Iteration 650: error = 0.5187099, gradient norm = 0.0005247 (50 iterations in 0.017s)
[t-SNE] Iteration 700: error = 0.5008423, gradient norm = 0.0002322 (50 iterations in 0.016s)
[t-SNE] Iteration 750: error = 0.4895507, gradient norm = 0.0002765 (50 iterations in 0.015s)
[t-SNE] Iteration 800: error = 0.4848976, gradient norm = 0.0002167 (50 iterations in 0.018s)
[t-SNE] Iteration 850: error = 0.4797288, gradient norm = 0.0001903 (50 iterations in 0.015s)
[t-SNE] Iteration 900: error = 0.4776227, gradient norm = 0.0001832 (50 iterations in 0.014s)
[t-SNE] Iteration 950: error = 0.4663758, gradient norm = 0.0015524 (50 iterations in 0.017s)
[t-SNE] Iteration 1000: error = 0.9702598, gradient norm = 0.0021251 (50 iterations in 0.013s)
[t-SNE] KL divergence after 1000 iterations: 0.970260
[t-SNE] Computed conditional probabilities for sample 63 / 63
[t-SNE] Mean sigma: 0.685235
Beginning preprocessing + Leiden
2024-03-16 18:54:00.622429 MEMORY 18.2204416
Affmat transformed
2024-03-16 18:54:00.623318 MEMORY 18.2204416
sources, targets, weights extracted
2024-03-16 18:54:00.623695 MEMORY 18.2204416
About to launch parallel Leiden runs
2024-03-16 18:54:00.627901 MEMORY 18.2204416
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.6s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.7s finished
Parallel Leiden runs finished
2024-03-16 18:54:02.376272 MEMORY 18.2204416
Quality: 0.10756947965056872
Quality: 0.10810293715205344
Quality: 0.10879804760926677
Got subclusters: Counter({0: 20, 1: 20, 2: 13, 3: 10})
On metacluster 2
Metacluster size 16072
Relevant tasks:  ('head',)
Relevant signs:  (1,)
TfModiscoSeqletsToPatternsFactory: seed=1234
(Round 1) num seqlets: 16072
(Round 1) Computing coarse affmat
2024-03-16 18:54:05.162662 MEMORY 18.219921408
Beginning embedding computation
MEMORY 18.219921408
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 152 tasks      | elapsed:    1.9s
[Parallel(n_jobs=24)]: Done 402 tasks      | elapsed:    4.8s
[Parallel(n_jobs=24)]: Done 752 tasks      | elapsed:    8.6s
[Parallel(n_jobs=24)]: Done 1202 tasks      | elapsed:   13.6s
[Parallel(n_jobs=24)]: Done 1752 tasks      | elapsed:   19.7s
[Parallel(n_jobs=24)]: Done 2402 tasks      | elapsed:   26.8s
[Parallel(n_jobs=24)]: Done 3152 tasks      | elapsed:   35.0s
[Parallel(n_jobs=24)]: Done 4002 tasks      | elapsed:   44.2s
[Parallel(n_jobs=24)]: Done 4952 tasks      | elapsed:   54.8s
[Parallel(n_jobs=24)]: Done 6002 tasks      | elapsed:  1.1min
[Parallel(n_jobs=24)]: Done 7152 tasks      | elapsed:  1.3min
[Parallel(n_jobs=24)]: Done 8402 tasks      | elapsed:  1.5min
[Parallel(n_jobs=24)]: Done 9752 tasks      | elapsed:  1.8min
[Parallel(n_jobs=24)]: Done 11202 tasks      | elapsed:  2.1min
[Parallel(n_jobs=24)]: Done 12752 tasks      | elapsed:  2.3min
[Parallel(n_jobs=24)]: Done 14402 tasks      | elapsed:  2.6min
[Parallel(n_jobs=24)]: Done 16072 out of 16072 | elapsed:  2.9min finished
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 152 tasks      | elapsed:    1.9s
[Parallel(n_jobs=24)]: Done 402 tasks      | elapsed:    4.7s
[Parallel(n_jobs=24)]: Done 752 tasks      | elapsed:    8.5s
[Parallel(n_jobs=24)]: Done 1202 tasks      | elapsed:   13.4s
[Parallel(n_jobs=24)]: Done 1752 tasks      | elapsed:   19.4s
[Parallel(n_jobs=24)]: Done 2402 tasks      | elapsed:   26.6s
[Parallel(n_jobs=24)]: Done 3152 tasks      | elapsed:   34.9s
[Parallel(n_jobs=24)]: Done 4002 tasks      | elapsed:   44.2s
[Parallel(n_jobs=24)]: Done 4952 tasks      | elapsed:   54.5s
[Parallel(n_jobs=24)]: Done 6002 tasks      | elapsed:  1.1min
[Parallel(n_jobs=24)]: Done 7152 tasks      | elapsed:  1.3min
[Parallel(n_jobs=24)]: Done 8402 tasks      | elapsed:  1.5min
[Parallel(n_jobs=24)]: Done 9752 tasks      | elapsed:  1.8min
[Parallel(n_jobs=24)]: Done 11202 tasks      | elapsed:  2.0min
[Parallel(n_jobs=24)]: Done 12752 tasks      | elapsed:  2.3min
[Parallel(n_jobs=24)]: Done 14402 tasks      | elapsed:  2.6min
[Parallel(n_jobs=24)]: Done 16072 out of 16072 | elapsed:  2.9min finished
At the beginning of embedding call
2024-03-16 18:54:05.162931 MEMORY 18.219921408
before computing embeddings fwd
2024-03-16 18:54:05.172005 MEMORY 18.219921408
after computing embeddings fwd
2024-03-16 18:57:01.810965 MEMORY 18.219921408
after computing embeddings rev
2024-03-16 18:59:57.742801 MEMORY 18.695217152
before computing sparse embeddings fwd
2024-03-16 18:59:57.742924 MEMORY 18.695217152
Constructing csr matrix...
csr matrix made in 2.0154595375061035 s
after computing sparse embeddings fwd
2024-03-16 19:00:00.462722 MEMORY 18.894229504
before computing sparse embeddings rev
2024-03-16 19:00:00.462851 MEMORY 18.894229504
Constructing csr matrix...
csr matrix made in 1.8860464096069336 s
after computing sparse embeddings rev
2024-03-16 19:00:02.964314 MEMORY 18.990923776
Finished embedding computation in 360.28 s
MEMORY 18.523521024
Starting affinity matrix computations
MEMORY 18.523521024
Batching in slices of size 4175
  0%|          | 0/4 [00:00<?, ?it/s] 25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:07<00:21,  7.30s/it] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:14<00:14,  7.21s/it] 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:21<00:07,  7.14s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:27<00:00,  6.79s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:27<00:00,  6.94s/it]
Finished affinity matrix computations in 27.9 s
MEMORY 18.52370944
(Round 1) Computed coarse affmat
2024-03-16 19:00:35.267073 MEMORY 18.227843072
(Round 1) Computing affinity matrix on nearest neighbors
2024-03-16 19:00:35.267216 MEMORY 18.227843072
Launching nearest neighbors affmat calculation job
MEMORY 18.301775872
Parallel runs completed
MEMORY 18.308255744
Job completed in: 49.39 s
MEMORY 18.303864832
Launching nearest neighbors affmat calculation job
MEMORY 18.301546496
Parallel runs completed
MEMORY 18.394443776
Job completed in: 49.01 s
MEMORY 18.394492928
(Round 1) Computed affinity matrix on nearest neighbors in 102.37 s
2024-03-16 19:02:17.643592 MEMORY 18.320695296
Filtered down to 14841 of 16072
(Round 1) Retained 14841 rows out of 16072 after filtering
2024-03-16 19:02:26.005626 MEMORY 18.320891904
(Round 1) Computing density adapted affmat
2024-03-16 19:02:30.647664 MEMORY 18.320891904
Symmetrizing nearest neighbors
Computing betas for density adaptation
Computing normalizing denominators
(Round 1) Computing clustering
2024-03-16 19:04:32.665399 MEMORY 18.5212928
Beginning preprocessing + Leiden
2024-03-16 19:04:32.684198 MEMORY 18.5212928
Affmat transformed
2024-03-16 19:04:32.684327 MEMORY 18.5212928
sources, targets, weights extracted
2024-03-16 19:04:33.199160 MEMORY 18.638319616
About to launch parallel Leiden runs
2024-03-16 19:04:33.323927 MEMORY 18.5212928
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:  1.3min
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:  6.6min finished
Parallel Leiden runs finished
2024-03-16 19:11:10.256478 MEMORY 18.523398144
Quality: 0.3494770679583365
Quality: 0.3510283441117342
Quality: 0.3517803229378347
Quality: 0.3517805342370882
Quality: 0.3517903093212608
Got 6 clusters after round 1
Counts:
{1: 3422, 0: 3553, 2: 2552, 3: 2437, 5: 632, 4: 2245}
2024-03-16 19:11:10.301064 MEMORY 18.406219776
(Round 1) Aggregating seqlets in each cluster
2024-03-16 19:11:10.301160 MEMORY 18.406219776
Aggregating for cluster 0 with 3553 seqlets
2024-03-16 19:11:10.313414 MEMORY 18.406219776
Skipped 6 due to duplicates
Trimming eliminated 0 seqlets out of 3547
WARNING: Probabilities don't sum to 1 in all the rows; this can be caused by zero-padding. Will renormalize. PPM:
[[0.25401748 0.23879335 0.23541021 0.27149704]
 [0.26980547 0.22328729 0.23625599 0.27036933]
 [0.24809698 0.23428249 0.24443191 0.27290668]
 [0.24640541 0.23484635 0.23512828 0.28333803]
 [0.25148012 0.23907527 0.23174514 0.27741754]
 [0.2373837  0.24499577 0.24386806 0.27347054]
 [0.25429941 0.23992106 0.23541021 0.2700874 ]
 [0.25148012 0.2452777  0.24471384 0.25852833]
 [0.24302227 0.25937412 0.23456442 0.26303919]
 [0.25542712 0.23174514 0.22469693 0.28813081]
 [0.25288977 0.23315478 0.24274034 0.27121511]
 [0.24358613 0.25288977 0.23202707 0.27149704]
 [0.25458134 0.2393572  0.22356921 0.28249225]
 [0.2889766  0.19932337 0.23174514 0.27995489]
 [0.25909219 0.21229208 0.27995489 0.24866084]
 [0.23061742 0.27121511 0.2145475  0.28361996]
 [0.31886101 0.23512828 0.20270651 0.2433042 ]
 [0.24866084 0.21962222 0.29602481 0.23569213]
 [0.2700874  0.25373555 0.15365097 0.32252608]
 [0.4200733  0.08288695 0.22948971 0.26755004]
 [0.16239075 0.37355512 0.23541021 0.22864392]
 [0.16041725 0.09360023 0.09360023 0.65238229]
 [0.61826896 0.06738089 0.13842684 0.17592332]
 [0.30730195 0.13363406 0.3078658  0.2511982 ]
 [0.15562447 0.13673527 0.06991824 0.63772202]
 [0.40372145 0.08063152 0.12235692 0.3932901 ]
 [0.51564703 0.19340288 0.09641951 0.19453059]
 [0.40062024 0.14237384 0.14237384 0.31463208]
 [0.18945588 0.48717226 0.07414717 0.2492247 ]
 [0.44037215 0.16013533 0.16633775 0.23315478]
 [0.38116718 0.22159571 0.20468001 0.19255709]
 [0.26388497 0.29179588 0.16351847 0.28080068]
 [0.25965605 0.2224415  0.17958838 0.33831407]
 [0.25881026 0.2373837  0.25796448 0.24584156]
 [0.26585847 0.23569213 0.25458134 0.24386806]
 [0.2602199  0.26529462 0.21511136 0.25937412]
 [0.28051875 0.224415   0.22582464 0.26924161]
 [0.25796448 0.25232591 0.21736679 0.27234282]
 [0.25599098 0.23315478 0.23005357 0.28080068]
 [0.26585847 0.23879335 0.23879335 0.25655484]
 [0.25317169 0.24104877 0.24781505 0.25796448]
 [0.2700874  0.23822949 0.23202707 0.25965605]
 [0.2641669  0.25176205 0.24584156 0.23822949]
 [0.2661404  0.24950663 0.23597406 0.24837891]
 [0.26585847 0.24274034 0.24020299 0.2511982 ]
 [0.25373555 0.24386806 0.2373837  0.26501269]
 [0.25570905 0.25740062 0.23625599 0.25063434]
 [0.26783197 0.23259092 0.23710178 0.26247533]]
Probability sums:
[0.99971807 0.99971807 0.99971807 0.99971807 0.99971807 0.99971807
 0.99971807 1.         1.         1.         1.         1.
 1.         1.         1.         1.         1.         1.
 1.         1.         1.         1.         1.         1.
 1.         1.         1.         1.         1.         1.
 1.         1.         1.         1.         1.         1.
 1.         1.         1.         1.         1.         1.
 1.         1.         1.         1.         1.         1.        ]
Aggregating for cluster 1 with 3422 seqlets
2024-03-16 19:11:19.356603 MEMORY 18.406219776
Removed 1 duplicate seqlets
Skipped 14 due to duplicates
Trimming eliminated 0 seqlets out of 3407
Removed 3 duplicate seqlets
Aggregating for cluster 2 with 2552 seqlets
2024-03-16 19:11:26.993270 MEMORY 18.406219776
Skipped 10 due to duplicates
Trimming eliminated 0 seqlets out of 2542
Removed 2 duplicate seqlets
Aggregating for cluster 3 with 2437 seqlets
2024-03-16 19:11:32.627926 MEMORY 18.406219776
Skipped 1 seqlets that went over sequence edge during flank expansion
Skipped 11 due to duplicates
Trimming eliminated 0 seqlets out of 2425
Aggregating for cluster 4 with 2245 seqlets
2024-03-16 19:11:39.852785 MEMORY 18.406219776
Skipped 13 due to duplicates
Trimming eliminated 0 seqlets out of 2232
Aggregating for cluster 5 with 632 seqlets
2024-03-16 19:11:44.553170 MEMORY 18.406219776
Removed 1 duplicate seqlets
Trimming eliminated 0 seqlets out of 631
Dropping cluster 5 with 631 seqlets due to sign disagreement
(Round 2) num seqlets: 14141
(Round 2) Computing coarse affmat
2024-03-16 19:11:47.953151 MEMORY 18.406219776
Beginning embedding computation
MEMORY 18.406219776
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 368 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done 1368 tasks      | elapsed:    2.2s
[Parallel(n_jobs=24)]: Done 2768 tasks      | elapsed:    4.2s
[Parallel(n_jobs=24)]: Done 4568 tasks      | elapsed:    6.7s
[Parallel(n_jobs=24)]: Done 6768 tasks      | elapsed:    9.7s
[Parallel(n_jobs=24)]: Done 9368 tasks      | elapsed:   13.3s
[Parallel(n_jobs=24)]: Done 12368 tasks      | elapsed:   17.6s
[Parallel(n_jobs=24)]: Done 14141 out of 14141 | elapsed:   20.1s finished
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 368 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done 1368 tasks      | elapsed:    2.1s
[Parallel(n_jobs=24)]: Done 2768 tasks      | elapsed:    4.0s
[Parallel(n_jobs=24)]: Done 4568 tasks      | elapsed:    6.4s
[Parallel(n_jobs=24)]: Done 6768 tasks      | elapsed:    9.4s
[Parallel(n_jobs=24)]: Done 9368 tasks      | elapsed:   13.0s
[Parallel(n_jobs=24)]: Done 12368 tasks      | elapsed:   17.2s
[Parallel(n_jobs=24)]: Done 14141 out of 14141 | elapsed:   19.7s finished
At the beginning of embedding call
2024-03-16 19:11:47.953372 MEMORY 18.406219776
before computing embeddings fwd
2024-03-16 19:11:47.962084 MEMORY 18.406219776
after computing embeddings fwd
2024-03-16 19:12:08.027715 MEMORY 18.632081408
after computing embeddings rev
2024-03-16 19:12:27.749308 MEMORY 19.148906496
before computing sparse embeddings fwd
2024-03-16 19:12:27.749404 MEMORY 19.148906496
Constructing csr matrix...
csr matrix made in 1.7030587196350098 s
after computing sparse embeddings fwd
2024-03-16 19:12:30.097340 MEMORY 19.240882176
before computing sparse embeddings rev
2024-03-16 19:12:30.097433 MEMORY 19.240882176
Constructing csr matrix...
csr matrix made in 1.598447561264038 s
after computing sparse embeddings rev
2024-03-16 19:12:32.258069 MEMORY 19.388243968
Finished embedding computation in 47.7 s
MEMORY 18.921365504
Starting affinity matrix computations
MEMORY 18.920579072
Batching in slices of size 4745
  0%|          | 0/3 [00:00<?, ?it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 1/3 [00:09<00:18,  9.35s/it] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 2/3 [00:19<00:09,  9.70s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:27<00:00,  9.24s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:27<00:00,  9.33s/it]
Finished affinity matrix computations in 28.09 s
MEMORY 18.920710144
(Round 2) Computed coarse affmat
2024-03-16 19:13:05.716392 MEMORY 18.631151616
(Round 2) Computing affinity matrix on nearest neighbors
2024-03-16 19:13:05.716529 MEMORY 18.631151616
Launching nearest neighbors affmat calculation job
MEMORY 18.681540608
Parallel runs completed
MEMORY 18.685956096
Job completed in: 22.56 s
MEMORY 18.683662336
Launching nearest neighbors affmat calculation job
MEMORY 18.681442304
Parallel runs completed
MEMORY 18.682093568
Job completed in: 22.68 s
MEMORY 18.681970688
(Round 2) Computed affinity matrix on nearest neighbors in 49.1 s
2024-03-16 19:13:54.818928 MEMORY 18.681991168
Not applying filtering for rounds above first round
2024-03-16 19:13:54.820716 MEMORY 18.681991168
(Round 2) Computing density adapted affmat
2024-03-16 19:13:59.224159 MEMORY 18.681991168
Symmetrizing nearest neighbors
Computing betas for density adaptation
Computing normalizing denominators
(Round 2) Computing clustering
2024-03-16 19:16:00.773053 MEMORY 19.458957312
Beginning preprocessing + Leiden
2024-03-16 19:16:00.792815 MEMORY 19.458957312
Affmat transformed
2024-03-16 19:16:00.792946 MEMORY 19.458957312
sources, targets, weights extracted
2024-03-16 19:16:01.281960 MEMORY 19.458961408
About to launch parallel Leiden runs
2024-03-16 19:16:01.410451 MEMORY 19.458961408
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:  1.1min
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:  3.6min finished
Parallel Leiden runs finished
2024-03-16 19:19:38.756626 MEMORY 19.458961408
Quality: 0.4675509106394865
Quality: 0.4675509934138527
Got 5 clusters after round 2
Counts:
{1: 3330, 0: 3547, 4: 2011, 2: 2781, 3: 2472}
2024-03-16 19:19:38.797792 MEMORY 19.458961408
(Round 2) Aggregating seqlets in each cluster
2024-03-16 19:19:38.797898 MEMORY 19.458961408
Aggregating for cluster 0 with 3547 seqlets
2024-03-16 19:19:38.807438 MEMORY 19.458961408
Skipped 11 due to duplicates
Trimming eliminated 0 seqlets out of 3536
Aggregating for cluster 1 with 3330 seqlets
2024-03-16 19:19:44.864723 MEMORY 19.459067904
Skipped 6 due to duplicates
Trimming eliminated 0 seqlets out of 3324
Aggregating for cluster 2 with 2781 seqlets
2024-03-16 19:19:50.379295 MEMORY 19.459067904
Removed 1 duplicate seqlets
Skipped 6 due to duplicates
Trimming eliminated 0 seqlets out of 2774
Aggregating for cluster 3 with 2472 seqlets
2024-03-16 19:19:55.554899 MEMORY 19.459067904
Skipped 2 due to duplicates
Trimming eliminated 0 seqlets out of 2470
Aggregating for cluster 4 with 2011 seqlets
2024-03-16 19:20:01.790139 MEMORY 19.459067904
Skipped 3 due to duplicates
Trimming eliminated 0 seqlets out of 2008
Got 5 clusters
Splitting into subclusters...
2024-03-16 19:20:05.023495 MEMORY 19.459067904
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 3162 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done 3536 out of 3536 | elapsed:    0.8s finished
Inspecting pattern 0 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 3536
[t-SNE] Computed conditional probabilities for sample 2000 / 3536
[t-SNE] Computed conditional probabilities for sample 3000 / 3536
[t-SNE] Computed conditional probabilities for sample 3536 / 3536
[t-SNE] Mean sigma: 0.291209
Beginning preprocessing + Leiden
2024-03-16 19:20:09.342336 MEMORY 19.459067904
Affmat transformed
2024-03-16 19:20:09.387140 MEMORY 19.459067904
sources, targets, weights extracted
2024-03-16 19:20:09.420357 MEMORY 19.459067904
About to launch parallel Leiden runs
2024-03-16 19:20:09.435973 MEMORY 19.459067904
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:   15.3s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   55.1s finished
Parallel Leiden runs finished
2024-03-16 19:21:04.517291 MEMORY 19.459067904
Quality: 0.450377032123401
Quality: 0.4523694017334377
Quality: 0.4526767365167277
Quality: 0.4526911630502828
Quality: 0.45286926042228987
Quality: 0.45328002837422887
Got subclusters: Counter({0: 647, 1: 631, 2: 537, 3: 490, 4: 437, 5: 427, 6: 143, 7: 110, 8: 60, 9: 48, 10: 3, 11: 3})
On merging iteration 1
Numbers for each pattern pre-subsample: [647, 631, 537, 490, 437, 427, 143, 110, 60, 48, 3, 3]
Numbers after subsampling: [300, 300, 300, 300, 300, 300, 143, 110, 60, 48, 3, 3]
Computing sims for pattern 0
Computed sims for pattern 0 in 2.8811488151550293 s
Computing sims for pattern 1
Computed sims for pattern 1 in 2.9713025093078613 s
Computing sims for pattern 2
Computed sims for pattern 2 in 3.149040937423706 s
Computing sims for pattern 3
Computed sims for pattern 3 in 3.3647990226745605 s
Computing sims for pattern 4
Computed sims for pattern 4 in 3.4867653846740723 s
Computing sims for pattern 5
Computed sims for pattern 5 in 3.741616725921631 s
Computing sims for pattern 6
Computed sims for pattern 6 in 1.9399850368499756 s
Computing sims for pattern 7
Computed sims for pattern 7 in 1.452017068862915 s
Computing sims for pattern 8
Computed sims for pattern 8 in 0.9997119903564453 s
Computing sims for pattern 9
Computed sims for pattern 9 in 0.7410094738006592 s
Computing sims for pattern 10
Computed sims for pattern 10 in 0.21351838111877441 s
Computing sims for pattern 11
Computed sims for pattern 11 in 0.20694780349731445 s
Cluster sizes
[647 631 537 490 437 427 143 110  60  48   3   3]
Cross-contamination matrix:
[[1.   0.48 0.6  0.71 0.7  0.56 0.72 0.62 0.76 0.62 0.75 0.7 ]
 [0.72 1.   0.61 0.78 0.78 0.53 0.76 0.72 0.75 0.39 0.81 0.39]
 [0.86 0.45 1.   0.79 0.73 0.61 0.74 0.81 0.82 0.42 0.89 0.67]
 [0.88 0.68 0.7  1.   0.71 0.53 0.76 0.74 0.77 0.56 0.8  0.22]
 [0.85 0.66 0.63 0.69 1.   0.52 0.83 0.77 0.86 0.6  0.87 0.67]
 [0.97 0.66 0.73 0.74 0.75 1.   0.88 0.81 0.83 0.72 0.91 0.93]
 [0.79 0.58 0.56 0.66 0.75 0.56 1.   0.71 0.7  0.55 0.77 0.64]
 [0.56 0.42 0.5  0.53 0.57 0.38 0.58 1.   0.57 0.27 0.6  0.38]
 [0.42 0.21 0.26 0.3  0.36 0.16 0.3  0.29 1.   0.17 0.35 0.15]
 [0.57 0.31 0.38 0.4  0.43 0.34 0.45 0.35 0.39 1.   0.49 0.26]
 [0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   1.   0.  ]
 [0.12 0.08 0.08 0.06 0.08 0.07 0.11 0.1  0.06 0.02 0.2  1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.8  0.85 0.9  0.88 0.9  0.9  0.8  0.76 0.79 0.61 0.66]
 [0.8  1.   0.74 0.85 0.85 0.79 0.84 0.78 0.7  0.7  0.51 0.57]
 [0.85 0.74 1.   0.81 0.8  0.79 0.8  0.76 0.72 0.71 0.54 0.57]
 [0.9  0.85 0.81 1.   0.85 0.81 0.83 0.78 0.73 0.73 0.57 0.62]
 [0.88 0.85 0.8  0.85 1.   0.82 0.91 0.84 0.75 0.71 0.59 0.55]
 [0.9  0.79 0.79 0.81 0.82 1.   0.91 0.81 0.73 0.78 0.6  0.69]
 [0.9  0.84 0.8  0.83 0.91 0.91 1.   0.85 0.74 0.74 0.64 0.66]
 [0.8  0.78 0.76 0.78 0.84 0.81 0.85 1.   0.65 0.67 0.57 0.64]
 [0.76 0.7  0.72 0.73 0.75 0.73 0.74 0.65 1.   0.62 0.58 0.51]
 [0.79 0.7  0.71 0.73 0.71 0.78 0.74 0.67 0.62 1.   0.6  0.51]
 [0.61 0.51 0.54 0.57 0.59 0.6  0.64 0.57 0.58 0.6  1.   0.77]
 [0.66 0.57 0.57 0.62 0.55 0.69 0.66 0.64 0.51 0.51 0.77 1.  ]]
Collapsing 4 & 6 with crosscontam 0.7517227701960452 and sim 0.91238808966593
Collapsing 5 & 6 with crosscontam 0.5592263338402512 and sim 0.9061603856102901
Collapsing 0 & 3 with crosscontam 0.7120555224691358 and sim 0.9041241109086504
Collapsing 0 & 6 with crosscontam 0.7225627246827246 and sim 0.8983956319870814
Collapsing 0 & 5 with crosscontam 0.5576654814814817 and sim 0.8972384312612804
Collapsing 0 & 4 with crosscontam 0.6989109308641974 and sim 0.8770752078513091
Collapsing 0 & 2 with crosscontam 0.5990377555555555 and sim 0.8535974486539257
Collapsing 6 & 7 with crosscontam 0.5777237158033552 and sim 0.8518576047982718
Trimming eliminated 0 seqlets out of 580
Trimming eliminated 0 seqlets out of 1007
Trimming eliminated 0 seqlets out of 1137
Trimming eliminated 0 seqlets out of 2144
Skipped 1 due to duplicates
Trimming eliminated 0 seqlets out of 2680
Trimming eliminated 0 seqlets out of 2790
Unmerged patterns remapping: OrderedDict([(1, 1), (8, 2), (9, 3), (10, 4), (11, 5)])
Time spent on merging iteration: 18.723857402801514
On merging iteration 2
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 2735 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done 3324 out of 3324 | elapsed:    0.7s finished
Numbers for each pattern pre-subsample: [2790, 631, 60, 48, 3, 3]
Numbers after subsampling: [300, 300, 60, 48, 3, 3]
Computing sims for pattern 0
Computed sims for pattern 0 in 1.3351237773895264 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.347745418548584 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.10080313682556152 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.0807199478149414 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.028921842575073242 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.027003765106201172 s
Cluster sizes
[2790  631   60   48    3    3]
Cross-contamination matrix:
[[1.   0.83 1.   0.87 1.   0.98]
 [0.67 1.   0.75 0.39 0.81 0.39]
 [0.31 0.21 1.   0.17 0.35 0.15]
 [0.44 0.31 0.39 1.   0.49 0.26]
 [0.   0.   0.   0.   1.   0.  ]
 [0.07 0.08 0.06 0.02 0.2  1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.85 0.79 0.8  0.66 0.66]
 [0.85 1.   0.7  0.7  0.51 0.57]
 [0.79 0.7  1.   0.62 0.58 0.51]
 [0.8  0.7  0.62 1.   0.6  0.51]
 [0.66 0.51 0.58 0.6  1.   0.77]
 [0.66 0.57 0.51 0.51 0.77 1.  ]]
Inspecting pattern 1 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 3324
[t-SNE] Computed conditional probabilities for sample 2000 / 3324
[t-SNE] Computed conditional probabilities for sample 3000 / 3324
[t-SNE] Computed conditional probabilities for sample 3324 / 3324
[t-SNE] Mean sigma: 0.346165
Beginning preprocessing + Leiden
2024-03-16 19:21:55.143807 MEMORY 19.459067904
Affmat transformed
2024-03-16 19:21:55.186139 MEMORY 19.459067904
sources, targets, weights extracted
2024-03-16 19:21:55.208817 MEMORY 19.459067904
About to launch parallel Leiden runs
2024-03-16 19:21:55.222015 MEMORY 19.459067904
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:   11.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   44.8s finished
Parallel Leiden runs finished
2024-03-16 19:22:40.065382 MEMORY 19.459067904
Quality: 0.4783768023413001
Quality: 0.4793529319966002
Got subclusters: Counter({0: 735, 1: 704, 2: 507, 3: 464, 4: 444, 5: 310, 6: 95, 7: 65})
On merging iteration 1
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 2532 tasks      | elapsed:    0.5s
[Parallel(n_jobs=24)]: Done 2774 out of 2774 | elapsed:    0.5s finished
Numbers for each pattern pre-subsample: [735, 704, 507, 464, 444, 310, 95, 65]
Numbers after subsampling: [300, 300, 300, 300, 300, 300, 95, 65]
Computing sims for pattern 0
Computed sims for pattern 0 in 2.4281671047210693 s
Computing sims for pattern 1
Computed sims for pattern 1 in 2.351665735244751 s
Computing sims for pattern 2
Computed sims for pattern 2 in 2.3599278926849365 s
Computing sims for pattern 3
Computed sims for pattern 3 in 5.022984266281128 s
Computing sims for pattern 4
Computed sims for pattern 4 in 2.2749743461608887 s
Computing sims for pattern 5
Computed sims for pattern 5 in 2.343808889389038 s
Computing sims for pattern 6
Computed sims for pattern 6 in 0.9145333766937256 s
Computing sims for pattern 7
Computed sims for pattern 7 in 0.6759610176086426 s
Cluster sizes
[735 704 507 464 444 310  95  65]
Cross-contamination matrix:
[[1.   0.66 0.73 0.76 0.62 0.7  0.53 0.52]
 [0.52 1.   0.54 0.48 0.62 0.84 0.56 0.95]
 [0.78 0.69 1.   0.62 0.64 0.66 0.51 0.89]
 [0.67 0.58 0.52 1.   0.56 0.83 0.55 0.49]
 [0.56 0.69 0.56 0.52 1.   0.84 0.3  0.65]
 [0.46 0.71 0.41 0.59 0.64 1.   0.44 0.65]
 [0.58 0.74 0.54 0.6  0.48 0.7  1.   0.71]
 [0.15 0.43 0.3  0.29 0.22 0.34 0.18 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.49 0.8  0.78 0.52 0.48 0.57 0.43]
 [0.49 1.   0.62 0.42 0.66 0.81 0.65 0.83]
 [0.8  0.62 1.   0.62 0.56 0.49 0.59 0.6 ]
 [0.78 0.42 0.62 1.   0.56 0.64 0.55 0.59]
 [0.52 0.66 0.56 0.56 1.   0.75 0.27 0.6 ]
 [0.48 0.81 0.49 0.64 0.75 1.   0.57 0.69]
 [0.57 0.65 0.59 0.55 0.27 0.57 1.   0.54]
 [0.43 0.83 0.6  0.59 0.6  0.69 0.54 1.  ]]
Inspecting pattern 2 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 2774
[t-SNE] Computed conditional probabilities for sample 2000 / 2774
[t-SNE] Computed conditional probabilities for sample 2774 / 2774
[t-SNE] Mean sigma: 0.305554
Beginning preprocessing + Leiden
2024-03-16 19:23:02.655410 MEMORY 19.459067904
Affmat transformed
2024-03-16 19:23:02.689731 MEMORY 19.459067904
sources, targets, weights extracted
2024-03-16 19:23:02.715411 MEMORY 19.459067904
About to launch parallel Leiden runs
2024-03-16 19:23:02.742659 MEMORY 19.459067904
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:   11.8s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   40.7s finished
Parallel Leiden runs finished
2024-03-16 19:23:43.419151 MEMORY 19.459067904
Quality: 0.42894263080403794
Quality: 0.4293630096992964
Quality: 0.4301439907887628
Quality: 0.4319741122047889
Quality: 0.4325745774159193
Got subclusters: Counter({0: 443, 1: 363, 2: 343, 3: 319, 4: 314, 5: 271, 6: 265, 7: 248, 8: 208})
On merging iteration 1
Numbers for each pattern pre-subsample: [443, 363, 343, 319, 314, 271, 265, 248, 208]
Numbers after subsampling: [300, 300, 300, 300, 300, 271, 265, 248, 208]
Computing sims for pattern 0
Computed sims for pattern 0 in 2.54438853263855 s
Computing sims for pattern 1
Computed sims for pattern 1 in 2.632624387741089 s
Computing sims for pattern 2
Computed sims for pattern 2 in 2.616788387298584 s
Computing sims for pattern 3
Computed sims for pattern 3 in 2.7784698009490967 s
Computing sims for pattern 4
Computed sims for pattern 4 in 2.669248104095459 s
Computing sims for pattern 5
Computed sims for pattern 5 in 2.28873610496521 s
Computing sims for pattern 6
Computed sims for pattern 6 in 2.2567996978759766 s
Computing sims for pattern 7
Computed sims for pattern 7 in 2.1006124019622803 s
Computing sims for pattern 8
Computed sims for pattern 8 in 2.3098576068878174 s
Cluster sizes
[443 363 343 319 314 271 265 248 208]
Cross-contamination matrix:
[[1.   0.54 0.61 0.76 0.57 0.63 0.94 0.71 0.64]
 [0.73 1.   0.3  0.87 0.54 0.7  0.87 0.79 0.55]
 [0.72 0.23 1.   0.67 0.63 0.64 0.96 0.75 0.59]
 [0.74 0.63 0.55 1.   0.54 0.6  0.94 0.78 0.65]
 [0.72 0.48 0.67 0.71 1.   0.48 0.88 0.74 0.72]
 [0.73 0.59 0.64 0.73 0.6  1.   0.88 0.71 0.54]
 [0.64 0.33 0.53 0.66 0.43 0.38 1.   0.66 0.53]
 [0.7  0.57 0.64 0.79 0.58 0.6  0.95 1.   0.67]
 [0.74 0.43 0.59 0.78 0.67 0.51 0.95 0.79 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.71 0.76 0.84 0.76 0.76 0.88 0.8  0.76]
 [0.71 1.   0.5  0.85 0.55 0.72 0.69 0.76 0.59]
 [0.76 0.5  1.   0.68 0.72 0.71 0.83 0.73 0.71]
 [0.84 0.85 0.68 1.   0.72 0.77 0.9  0.87 0.78]
 [0.76 0.55 0.72 0.72 1.   0.64 0.76 0.75 0.8 ]
 [0.76 0.72 0.71 0.77 0.64 1.   0.77 0.78 0.72]
 [0.88 0.69 0.83 0.9  0.76 0.77 1.   0.88 0.84]
 [0.8  0.76 0.73 0.87 0.75 0.78 0.88 1.   0.82]
 [0.76 0.59 0.71 0.78 0.8  0.72 0.84 0.82 1.  ]]
Collapsing 3 & 6 with crosscontam 0.6617309920717551 and sim 0.8958276929770693
Collapsing 6 & 7 with crosscontam 0.6599642432690158 and sim 0.8793102460777862
Collapsing 0 & 6 with crosscontam 0.6408648478050114 and sim 0.8772215843910253
Collapsing 3 & 7 with crosscontam 0.7837677634408604 and sim 0.8668768063661635
Trimming eliminated 0 seqlets out of 584
Trimming eliminated 0 seqlets out of 832
Trimming eliminated 0 seqlets out of 1275
Unmerged patterns remapping: OrderedDict([(1, 1), (2, 2), (4, 3), (5, 4), (8, 5)])
Time spent on merging iteration: 5.706484079360962
On merging iteration 2
Numbers for each pattern pre-subsample: [1275, 363, 343, 314, 271, 208]
Numbers after subsampling: [300, 300, 300, 300, 271, 208]
Computing sims for pattern 0
Computed sims for pattern 0 in 1.8264520168304443 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.3656799793243408 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.3620593547821045 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.3635108470916748 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.3043496608734131 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.2753725051879883 s
Cluster sizes
[1275  363  343  314  271  208]
Cross-contamination matrix:
[[1.   0.64 0.74 0.69 0.74 0.8 ]
 [0.81 1.   0.3  0.54 0.7  0.55]
 [0.76 0.23 1.   0.63 0.64 0.59]
 [0.75 0.48 0.67 1.   0.48 0.72]
 [0.75 0.59 0.64 0.6  1.   0.54]
 [0.82 0.43 0.59 0.67 0.51 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.77 0.78 0.78 0.78 0.85]
 [0.77 1.   0.5  0.55 0.72 0.59]
 [0.78 0.5  1.   0.72 0.71 0.71]
 [0.78 0.55 0.72 1.   0.64 0.8 ]
 [0.78 0.72 0.71 0.64 1.   0.72]
 [0.85 0.59 0.71 0.8  0.72 1.  ]]
Collapsing 0 & 5 with crosscontam 0.8013538867521368 and sim 0.8524639834393734
Trimming eliminated 0 seqlets out of 1483
Unmerged patterns remapping: OrderedDict([(1, 1), (2, 2), (3, 3), (4, 4)])
Time spent on merging iteration: 2.1493804454803467
On merging iteration 3
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 2394 tasks      | elapsed:    0.4s
[Parallel(n_jobs=24)]: Done 2470 out of 2470 | elapsed:    0.4s finished
Numbers for each pattern pre-subsample: [1483, 363, 343, 314, 271]
Numbers after subsampling: [300, 300, 300, 300, 271]
Computing sims for pattern 0
Computed sims for pattern 0 in 1.3933489322662354 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.3505375385284424 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.3502004146575928 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.3560779094696045 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.31897568702697754 s
Cluster sizes
[1483  363  343  314  271]
Cross-contamination matrix:
[[1.   0.67 0.78 0.74 0.69]
 [0.73 1.   0.3  0.54 0.7 ]
 [0.73 0.23 1.   0.63 0.64]
 [0.73 0.48 0.67 1.   0.48]
 [0.65 0.59 0.64 0.6  1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.76 0.78 0.8  0.77]
 [0.76 1.   0.5  0.55 0.72]
 [0.78 0.5  1.   0.72 0.71]
 [0.8  0.55 0.72 1.   0.64]
 [0.77 0.72 0.71 0.64 1.  ]]
Inspecting pattern 3 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 2470
[t-SNE] Computed conditional probabilities for sample 2000 / 2470
[t-SNE] Computed conditional probabilities for sample 2470 / 2470
[t-SNE] Mean sigma: 0.331698
Beginning preprocessing + Leiden
2024-03-16 19:24:21.219486 MEMORY 19.459067904
Affmat transformed
2024-03-16 19:24:21.251574 MEMORY 19.459067904
sources, targets, weights extracted
2024-03-16 19:24:21.270945 MEMORY 19.459067904
About to launch parallel Leiden runs
2024-03-16 19:24:21.283299 MEMORY 19.459039232
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    7.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   25.5s finished
Parallel Leiden runs finished
2024-03-16 19:24:46.822321 MEMORY 19.459039232
Quality: 0.4882058757347347
Quality: 0.4884266271669569
Quality: 0.4888008421079151
Quality: 0.48926993710674777
Quality: 0.48994837007424646
Got subclusters: Counter({0: 540, 1: 512, 2: 473, 3: 392, 4: 298, 5: 252, 6: 3})
On merging iteration 1
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 1812 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 2008 out of 2008 | elapsed:    0.3s finished
Numbers for each pattern pre-subsample: [540, 512, 473, 392, 298, 252, 3]
Numbers after subsampling: [300, 300, 300, 300, 298, 252, 3]
Computing sims for pattern 0
Computed sims for pattern 0 in 1.9897820949554443 s
Computing sims for pattern 1
Computed sims for pattern 1 in 2.017404556274414 s
Computing sims for pattern 2
Computed sims for pattern 2 in 1.9896354675292969 s
Computing sims for pattern 3
Computed sims for pattern 3 in 1.999309778213501 s
Computing sims for pattern 4
Computed sims for pattern 4 in 2.0055503845214844 s
Computing sims for pattern 5
Computed sims for pattern 5 in 3.9321444034576416 s
Computing sims for pattern 6
Computed sims for pattern 6 in 0.15379095077514648 s
Cluster sizes
[540 512 473 392 298 252   3]
Cross-contamination matrix:
[[1.   0.54 0.61 0.45 0.62 0.76 0.52]
 [0.43 1.   0.49 0.76 0.5  0.6  0.66]
 [0.48 0.3  1.   0.5  0.57 0.63 0.45]
 [0.38 0.68 0.67 1.   0.58 0.72 0.23]
 [0.76 0.51 0.82 0.65 1.   0.8  0.58]
 [0.73 0.49 0.75 0.67 0.67 1.   0.5 ]
 [0.   0.   0.   0.   0.   0.   1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.7  0.52 0.51 0.82 0.74 0.53]
 [0.7  1.   0.43 0.8  0.59 0.58 0.58]
 [0.52 0.43 1.   0.67 0.72 0.73 0.46]
 [0.51 0.8  0.67 1.   0.65 0.74 0.44]
 [0.82 0.59 0.72 0.65 1.   0.72 0.55]
 [0.74 0.58 0.73 0.74 0.72 1.   0.41]
 [0.53 0.58 0.46 0.44 0.55 0.41 1.  ]]
Inspecting pattern 4 for spurious merging
Warning: each seqlet is not its own nearest neighbor; there may be duplicates
[t-SNE] Computed conditional probabilities for sample 1000 / 2008
[t-SNE] Computed conditional probabilities for sample 2000 / 2008
[t-SNE] Computed conditional probabilities for sample 2008 / 2008
[t-SNE] Mean sigma: 0.338347
Beginning preprocessing + Leiden
2024-03-16 19:25:04.020198 MEMORY 19.459039232
Affmat transformed
2024-03-16 19:25:04.044565 MEMORY 19.459039232
sources, targets, weights extracted
2024-03-16 19:25:04.058554 MEMORY 19.459039232
About to launch parallel Leiden runs
2024-03-16 19:25:04.068153 MEMORY 19.459039232
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    6.0s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   21.0s finished
Parallel Leiden runs finished
2024-03-16 19:25:25.081005 MEMORY 19.459039232
Quality: 0.44516543668187675
Quality: 0.44724883887582034
Quality: 0.4482974017850518
Quality: 0.449495788669492
Quality: 0.44953316203338045
Quality: 0.4498204801282679
Quality: 0.44995574974643077
Got subclusters: Counter({0: 420, 1: 360, 2: 279, 3: 260, 4: 252, 5: 226, 6: 206, 7: 5})
On merging iteration 1
Numbers for each pattern pre-subsample: [420, 360, 279, 260, 252, 226, 206, 5]
Numbers after subsampling: [300, 300, 279, 260, 252, 226, 206, 5]
Computing sims for pattern 0
Computed sims for pattern 0 in 2.2665908336639404 s
Computing sims for pattern 1
Computed sims for pattern 1 in 2.238435983657837 s
Computing sims for pattern 2
Computed sims for pattern 2 in 1.9946703910827637 s
Computing sims for pattern 3
Computed sims for pattern 3 in 1.8337180614471436 s
Computing sims for pattern 4
Computed sims for pattern 4 in 1.7135496139526367 s
Computing sims for pattern 5
Computed sims for pattern 5 in 2.0324549674987793 s
Computing sims for pattern 6
Computed sims for pattern 6 in 1.7240245342254639 s
Computing sims for pattern 7
Computed sims for pattern 7 in 0.18230342864990234 s
Cluster sizes
[420 360 279 260 252 226 206   5]
Cross-contamination matrix:
[[1.   0.34 0.57 0.66 0.28 0.36 0.36 0.49]
 [0.41 1.   0.68 0.62 0.73 0.64 0.58 0.24]
 [0.63 0.57 1.   0.6  0.61 0.58 0.59 0.5 ]
 [0.81 0.43 0.68 1.   0.62 0.53 0.59 0.54]
 [0.57 0.74 0.75 0.68 1.   0.73 0.64 0.4 ]
 [0.54 0.67 0.72 0.6  0.75 1.   0.48 0.43]
 [0.84 0.72 0.83 0.77 0.77 0.57 1.   0.29]
 [0.12 0.02 0.11 0.09 0.03 0.05 0.01 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.7  0.72 0.84 0.7  0.56 0.75 0.48]
 [0.7  1.   0.72 0.73 0.82 0.67 0.72 0.36]
 [0.72 0.72 1.   0.79 0.81 0.72 0.75 0.44]
 [0.84 0.73 0.79 1.   0.78 0.67 0.79 0.42]
 [0.7  0.82 0.81 0.78 1.   0.74 0.78 0.5 ]
 [0.56 0.67 0.72 0.67 0.74 1.   0.56 0.49]
 [0.75 0.72 0.75 0.79 0.78 0.56 1.   0.24]
 [0.48 0.36 0.44 0.42 0.5  0.49 0.24 1.  ]]
Merging on 34 clusters
2024-03-16 19:25:39.604742 MEMORY 19.459039232
On merging iteration 1
Numbers for each pattern pre-subsample: [2790, 631, 60, 48, 3, 3, 735, 704, 507, 464, 444, 310, 95, 65, 1483, 363, 343, 314, 271, 540, 512, 473, 392, 298, 252, 3, 420, 360, 279, 260, 252, 226, 206, 5]
Numbers after subsampling: [300, 300, 60, 48, 3, 3, 300, 300, 300, 300, 300, 300, 95, 65, 300, 300, 300, 300, 271, 300, 300, 300, 300, 298, 252, 3, 300, 300, 279, 260, 252, 226, 206, 5]
Computing sims for pattern 0
Computed sims for pattern 0 in 10.732736825942993 s
Computing sims for pattern 1
Computed sims for pattern 1 in 10.621502161026001 s
Computing sims for pattern 2
Computed sims for pattern 2 in 2.715827703475952 s
Computing sims for pattern 3
Computed sims for pattern 3 in 2.2228832244873047 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.6952471733093262 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.6825997829437256 s
Computing sims for pattern 6
Computed sims for pattern 6 in 10.632554531097412 s
Computing sims for pattern 7
Computed sims for pattern 7 in 10.579458236694336 s
Computing sims for pattern 8
Computed sims for pattern 8 in 10.560277462005615 s
Computing sims for pattern 9
Computed sims for pattern 9 in 13.075184106826782 s
Computing sims for pattern 10
Computed sims for pattern 10 in 10.655402660369873 s
Computing sims for pattern 11
Computed sims for pattern 11 in 10.76802134513855 s
Computing sims for pattern 12
Computed sims for pattern 12 in 4.028882265090942 s
Computing sims for pattern 13
Computed sims for pattern 13 in 2.8279566764831543 s
Computing sims for pattern 14
Computed sims for pattern 14 in 10.439820051193237 s
Computing sims for pattern 15
Computed sims for pattern 15 in 10.48848843574524 s
Computing sims for pattern 16
Computed sims for pattern 16 in 10.347179889678955 s
Computing sims for pattern 17
Computed sims for pattern 17 in 10.462432861328125 s
Computing sims for pattern 18
Computed sims for pattern 18 in 9.010499715805054 s
Computing sims for pattern 19
Computed sims for pattern 19 in 12.91972279548645 s
Computing sims for pattern 20
Computed sims for pattern 20 in 10.68172550201416 s
Computing sims for pattern 21
Computed sims for pattern 21 in 10.633800506591797 s
Computing sims for pattern 22
Computed sims for pattern 22 in 10.626825094223022 s
Computing sims for pattern 23
Computed sims for pattern 23 in 10.449376583099365 s
Computing sims for pattern 24
Computed sims for pattern 24 in 8.142720937728882 s
Computing sims for pattern 25
Computed sims for pattern 25 in 0.7040960788726807 s
Computing sims for pattern 26
Computed sims for pattern 26 in 10.502164125442505 s
Computing sims for pattern 27
Computed sims for pattern 27 in 10.437035322189331 s
Computing sims for pattern 28
Computed sims for pattern 28 in 9.28614616394043 s
Computing sims for pattern 29
Computed sims for pattern 29 in 10.617796421051025 s
Computing sims for pattern 30
Computed sims for pattern 30 in 8.026148796081543 s
Computing sims for pattern 31
Computed sims for pattern 31 in 9.163620471954346 s
Computing sims for pattern 32
Computed sims for pattern 32 in 8.254421949386597 s
Computing sims for pattern 33
Computed sims for pattern 33 in 0.7675275802612305 s
Cluster sizes
[2790  631   60   48    3    3  735  704  507  464  444  310   95   65
 1483  363  343  314  271  540  512  473  392  298  252    3  420  360
  279  260  252  226  206    5]
Cross-contamination matrix:
[[1.   0.83 1.   ... 0.26 0.6  0.28]
 [0.67 1.   0.75 ... 0.15 0.42 0.13]
 [0.31 0.21 1.   ... 0.02 0.08 0.01]
 ...
 [0.29 0.28 0.22 ... 1.   0.48 0.43]
 [0.83 0.78 0.74 ... 0.57 1.   0.29]
 [0.01 0.02 0.02 ... 0.05 0.01 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.85 0.79 ... 0.36 0.82 0.36]
 [0.85 1.   0.7  ... 0.45 0.81 0.32]
 [0.79 0.7  1.   ... 0.36 0.63 0.25]
 ...
 [0.36 0.45 0.36 ... 1.   0.56 0.49]
 [0.82 0.81 0.63 ... 0.56 1.   0.24]
 [0.36 0.32 0.25 ... 0.49 0.24 1.  ]]
Got 34 patterns after merging
2024-03-16 19:30:24.401111 MEMORY 19.459039232
Performing filtering
2024-03-16 19:30:24.401401 MEMORY 19.459039232
Got 30 patterns after filtering
2024-03-16 19:30:26.328451 MEMORY 19.459039232
Total time taken is 2182.88s
2024-03-16 19:30:26.328616 MEMORY 19.459039232
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 2412 tasks      | elapsed:    0.5s
[Parallel(n_jobs=24)]: Done 2790 out of 2790 | elapsed:    0.5s finished
/ru-auth/local/home/lzhao/anaconda3/envs/jupyter-ml-clone/lib/python3.9/site-packages/sklearn/manifold/_t_sne.py:691: FutureWarning: 'square_distances' has been introduced in 0.24 to help phase out legacy squaring behavior. The 'legacy' setting will be removed in 1.1 (renaming of 0.26), and the default setting will be changed to True. In 1.3, 'square_distances' will be removed altogether, and distances will be squared by default. Set 'square_distances'=True to silence this warning.
  warnings.warn(
/ru-auth/local/home/lzhao/anaconda3/envs/jupyter-ml-clone/lib/python3.9/site-packages/sklearn/neighbors/_base.py:175: EfficiencyWarning: Precomputed sparse input was not sorted by data.
  warnings.warn('Precomputed sparse input was not sorted by data.',
Applying subclustering to the final motifs
On pattern 0
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 2790 samples in 0.020s...
[t-SNE] Computed neighbors for 2790 samples in 0.002s...
[t-SNE] Computed conditional probabilities for sample 1000 / 2790
[t-SNE] Computed conditional probabilities for sample 2000 / 2790
[t-SNE] Computed conditional probabilities for sample 2790 / 2790
[t-SNE] Mean sigma: 0.294270
[t-SNE] Computed conditional probabilities in 0.197s
[t-SNE] Iteration 50: error = 73.4986954, gradient norm = 0.0628001 (50 iterations in 0.317s)
[t-SNE] Iteration 100: error = 73.6729813, gradient norm = 0.0629770 (50 iterations in 0.294s)
[t-SNE] Iteration 150: error = 73.5195312, gradient norm = 0.0697953 (50 iterations in 0.271s)
[t-SNE] Iteration 200: error = 73.4947662, gradient norm = 0.0602623 (50 iterations in 0.256s)
[t-SNE] Iteration 250: error = 73.4893417, gradient norm = 0.0559597 (50 iterations in 0.256s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 73.489342
[t-SNE] Iteration 300: error = 2.7275853, gradient norm = 0.0011372 (50 iterations in 0.233s)
[t-SNE] Iteration 350: error = 2.6268404, gradient norm = 0.0004529 (50 iterations in 0.211s)
[t-SNE] Iteration 400: error = 2.5800457, gradient norm = 0.0002328 (50 iterations in 0.209s)
[t-SNE] Iteration 450: error = 2.5550599, gradient norm = 0.0001528 (50 iterations in 0.207s)
[t-SNE] Iteration 500: error = 2.5396256, gradient norm = 0.0001240 (50 iterations in 0.208s)
[t-SNE] Iteration 550: error = 2.5303423, gradient norm = 0.0000940 (50 iterations in 0.209s)
[t-SNE] Iteration 600: error = 2.5243158, gradient norm = 0.0000776 (50 iterations in 0.215s)
[t-SNE] Iteration 650: error = 2.5200047, gradient norm = 0.0000818 (50 iterations in 0.212s)
[t-SNE] Iteration 700: error = 2.5164490, gradient norm = 0.0000768 (50 iterations in 0.213s)
[t-SNE] Iteration 750: error = 2.5143726, gradient norm = 0.0000580 (50 iterations in 0.215s)
[t-SNE] Iteration 800: error = 2.5123515, gradient norm = 0.0000868 (50 iterations in 0.217s)
[t-SNE] Iteration 850: error = 2.5102489, gradient norm = 0.0000489 (50 iterations in 0.210s)
[t-SNE] Iteration 900: error = 2.5088675, gradient norm = 0.0000431 (50 iterations in 0.211s)
[t-SNE] Iteration 950: error = 2.5076418, gradient norm = 0.0000390 (50 iterations in 0.215s)
[t-SNE] Iteration 1000: error = 2.5066261, gradient norm = 0.0000331 (50 iterations in 0.218s)
[t-SNE] KL divergence after 1000 iterations: 2.506626
[t-SNE] Computed conditional probabilities for sample 1000 / 2790
[t-SNE] Computed conditional probabilities for sample 2000 / 2790
[t-SNE] Computed conditional probabilities for sample 2790 / 2790
[t-SNE] Mean sigma: 0.294270
Beginning preprocessing + Leiden
2024-03-16 19:30:34.493211 MEMORY 19.459219456
Affmat transformed
2024-03-16 19:30:34.533189 MEMORY 19.459219456
sources, targets, weights extracted
2024-03-16 19:30:34.558694 MEMORY 19.459219456
About to launch parallel Leiden runs
2024-03-16 19:30:34.571415 MEMORY 19.459219456
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:   12.4s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   44.9s finished
Parallel Leiden runs finished
2024-03-16 19:31:19.493521 MEMORY 19.459219456
Quality: 0.42067152062350494
Quality: 0.4233443910069066
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 1290 tasks      | elapsed:    0.6s
[Parallel(n_jobs=24)]: Done 1483 out of 1483 | elapsed:    0.8s finished
Got subclusters: Counter({0: 451, 1: 404, 2: 394, 3: 365, 4: 335, 5: 266, 6: 262, 7: 209, 8: 104})
On pattern 1
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 1483 samples in 0.011s...
[t-SNE] Computed neighbors for 1483 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 1000 / 1483
[t-SNE] Computed conditional probabilities for sample 1483 / 1483
[t-SNE] Mean sigma: 0.307334
[t-SNE] Computed conditional probabilities in 0.103s
[t-SNE] Iteration 50: error = 70.0718155, gradient norm = 0.1872392 (50 iterations in 0.134s)
[t-SNE] Iteration 100: error = 70.3301468, gradient norm = 0.2005009 (50 iterations in 0.135s)
[t-SNE] Iteration 150: error = 70.6162720, gradient norm = 0.1868306 (50 iterations in 0.135s)
[t-SNE] Iteration 200: error = 69.4198456, gradient norm = 0.2130939 (50 iterations in 0.138s)
[t-SNE] Iteration 250: error = 69.9465561, gradient norm = 0.1996085 (50 iterations in 0.141s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 69.946556
[t-SNE] Iteration 300: error = 2.1268814, gradient norm = 0.0021691 (50 iterations in 0.122s)
[t-SNE] Iteration 350: error = 2.0660481, gradient norm = 0.0004091 (50 iterations in 0.119s)
[t-SNE] Iteration 400: error = 2.0396545, gradient norm = 0.0002328 (50 iterations in 0.118s)
[t-SNE] Iteration 450: error = 2.0284731, gradient norm = 0.0001559 (50 iterations in 0.118s)
[t-SNE] Iteration 500: error = 2.0216339, gradient norm = 0.0001221 (50 iterations in 0.118s)
[t-SNE] Iteration 550: error = 2.0173419, gradient norm = 0.0001121 (50 iterations in 0.119s)
[t-SNE] Iteration 600: error = 2.0150063, gradient norm = 0.0000713 (50 iterations in 0.120s)
[t-SNE] Iteration 650: error = 2.0127842, gradient norm = 0.0001046 (50 iterations in 0.116s)
[t-SNE] Iteration 700: error = 2.0120993, gradient norm = 0.0000900 (50 iterations in 0.121s)
[t-SNE] Iteration 750: error = 2.0111349, gradient norm = 0.0000519 (50 iterations in 0.118s)
[t-SNE] Iteration 800: error = 2.0102484, gradient norm = 0.0000432 (50 iterations in 0.116s)
[t-SNE] Iteration 850: error = 2.0095992, gradient norm = 0.0000336 (50 iterations in 0.117s)
[t-SNE] Iteration 900: error = 2.0090537, gradient norm = 0.0000340 (50 iterations in 0.116s)
[t-SNE] Iteration 950: error = 2.0087206, gradient norm = 0.0000285 (50 iterations in 0.116s)
[t-SNE] Iteration 1000: error = 2.0084321, gradient norm = 0.0000288 (50 iterations in 0.117s)
[t-SNE] KL divergence after 1000 iterations: 2.008432
[t-SNE] Computed conditional probabilities for sample 1000 / 1483
[t-SNE] Computed conditional probabilities for sample 1483 / 1483
[t-SNE] Mean sigma: 0.307334
Beginning preprocessing + Leiden
2024-03-16 19:31:24.713842 MEMORY 19.459252224
Affmat transformed
2024-03-16 19:31:24.731288 MEMORY 19.459252224
sources, targets, weights extracted
2024-03-16 19:31:24.745279 MEMORY 19.459252224
About to launch parallel Leiden runs
2024-03-16 19:31:24.754606 MEMORY 19.459252224
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    4.8s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   15.3s finished
Parallel Leiden runs finished
2024-03-16 19:31:40.037094 MEMORY 19.459252224
Quality: 0.4096858008385432
Quality: 0.4105215878756912
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 735 out of 735 | elapsed:    0.2s finished
Got subclusters: Counter({0: 339, 1: 245, 2: 228, 3: 219, 4: 206, 5: 155, 6: 91})
On pattern 2
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 735 samples in 0.006s...
[t-SNE] Computed neighbors for 735 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 735 / 735
[t-SNE] Mean sigma: 0.376526
[t-SNE] Computed conditional probabilities in 0.050s
[t-SNE] Iteration 50: error = 67.4055710, gradient norm = 0.3981558 (50 iterations in 0.075s)
[t-SNE] Iteration 100: error = 68.3395691, gradient norm = 0.3723588 (50 iterations in 0.070s)
[t-SNE] Iteration 150: error = 67.8710251, gradient norm = 0.3838367 (50 iterations in 0.072s)
[t-SNE] Iteration 200: error = 68.8996353, gradient norm = 0.3722515 (50 iterations in 0.072s)
[t-SNE] Iteration 250: error = 68.5268097, gradient norm = 0.3767968 (50 iterations in 0.070s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 68.526810
[t-SNE] Iteration 300: error = 1.8093568, gradient norm = 0.0022660 (50 iterations in 0.070s)
[t-SNE] Iteration 350: error = 1.7609402, gradient norm = 0.0009706 (50 iterations in 0.067s)
[t-SNE] Iteration 400: error = 1.7418845, gradient norm = 0.0004142 (50 iterations in 0.067s)
[t-SNE] Iteration 450: error = 1.7305086, gradient norm = 0.0003531 (50 iterations in 0.070s)
[t-SNE] Iteration 500: error = 1.7231133, gradient norm = 0.0002746 (50 iterations in 0.069s)
[t-SNE] Iteration 550: error = 1.7210358, gradient norm = 0.0001588 (50 iterations in 0.068s)
[t-SNE] Iteration 600: error = 1.7193044, gradient norm = 0.0001966 (50 iterations in 0.070s)
[t-SNE] Iteration 650: error = 1.7182205, gradient norm = 0.0000792 (50 iterations in 0.070s)
[t-SNE] Iteration 700: error = 1.7175180, gradient norm = 0.0000682 (50 iterations in 0.070s)
[t-SNE] Iteration 750: error = 1.7150980, gradient norm = 0.0001686 (50 iterations in 0.066s)
[t-SNE] Iteration 800: error = 1.7142022, gradient norm = 0.0000981 (50 iterations in 0.067s)
[t-SNE] Iteration 850: error = 1.7138956, gradient norm = 0.0000654 (50 iterations in 0.065s)
[t-SNE] Iteration 900: error = 1.7138610, gradient norm = 0.0000534 (50 iterations in 0.068s)
[t-SNE] Iteration 950: error = 1.7137270, gradient norm = 0.0000501 (50 iterations in 0.068s)
[t-SNE] Iteration 1000: error = 1.7136694, gradient norm = 0.0000476 (50 iterations in 0.067s)
[t-SNE] KL divergence after 1000 iterations: 1.713669
[t-SNE] Computed conditional probabilities for sample 735 / 735
[t-SNE] Mean sigma: 0.376526
Beginning preprocessing + Leiden
2024-03-16 19:31:42.563117 MEMORY 19.459268608
Affmat transformed
2024-03-16 19:31:42.572540 MEMORY 19.459268608
sources, targets, weights extracted
2024-03-16 19:31:42.577898 MEMORY 19.459268608
About to launch parallel Leiden runs
2024-03-16 19:31:42.583874 MEMORY 19.459268608
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    2.0s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    6.3s finished
Parallel Leiden runs finished
2024-03-16 19:31:48.918359 MEMORY 19.459268608
Quality: 0.3798994452103549
Quality: 0.38153196449617766
Quality: 0.38295505974628596
Quality: 0.3857363097124715
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 704 out of 704 | elapsed:    0.2s finished
Got subclusters: Counter({0: 164, 1: 151, 2: 150, 3: 103, 4: 101, 5: 66})
On pattern 3
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 704 samples in 0.006s...
[t-SNE] Computed neighbors for 704 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 704 / 704
[t-SNE] Mean sigma: 0.365730
[t-SNE] Computed conditional probabilities in 0.048s
[t-SNE] Iteration 50: error = 66.7475891, gradient norm = 0.4104740 (50 iterations in 0.069s)
[t-SNE] Iteration 100: error = 67.6733322, gradient norm = 0.3925580 (50 iterations in 0.067s)
[t-SNE] Iteration 150: error = 69.0031433, gradient norm = 0.3990020 (50 iterations in 0.066s)
[t-SNE] Iteration 200: error = 68.8706360, gradient norm = 0.3814820 (50 iterations in 0.067s)
[t-SNE] Iteration 250: error = 68.2146835, gradient norm = 0.4093143 (50 iterations in 0.067s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 68.214684
[t-SNE] Iteration 300: error = 1.8011358, gradient norm = 0.0026825 (50 iterations in 0.066s)
[t-SNE] Iteration 350: error = 1.7597877, gradient norm = 0.0006487 (50 iterations in 0.063s)
[t-SNE] Iteration 400: error = 1.7466856, gradient norm = 0.0003119 (50 iterations in 0.064s)
[t-SNE] Iteration 450: error = 1.7408038, gradient norm = 0.0002764 (50 iterations in 0.063s)
[t-SNE] Iteration 500: error = 1.7377200, gradient norm = 0.0001245 (50 iterations in 0.071s)
[t-SNE] Iteration 550: error = 1.7364991, gradient norm = 0.0000723 (50 iterations in 0.064s)
[t-SNE] Iteration 600: error = 1.7359289, gradient norm = 0.0000651 (50 iterations in 0.063s)
[t-SNE] Iteration 650: error = 1.7354572, gradient norm = 0.0000374 (50 iterations in 0.069s)
[t-SNE] Iteration 700: error = 1.7352355, gradient norm = 0.0000529 (50 iterations in 0.064s)
[t-SNE] Iteration 750: error = 1.7349150, gradient norm = 0.0000512 (50 iterations in 0.064s)
[t-SNE] Iteration 800: error = 1.7347771, gradient norm = 0.0000450 (50 iterations in 0.066s)
[t-SNE] Iteration 850: error = 1.7346786, gradient norm = 0.0000484 (50 iterations in 0.063s)
[t-SNE] Iteration 900: error = 1.7346262, gradient norm = 0.0000561 (50 iterations in 0.062s)
[t-SNE] Iteration 950: error = 1.7345774, gradient norm = 0.0000409 (50 iterations in 0.063s)
[t-SNE] Iteration 1000: error = 1.7342633, gradient norm = 0.0000812 (50 iterations in 0.064s)
[t-SNE] KL divergence after 1000 iterations: 1.734263
[t-SNE] Computed conditional probabilities for sample 704 / 704
[t-SNE] Mean sigma: 0.365730
Beginning preprocessing + Leiden
2024-03-16 19:31:51.312580 MEMORY 19.459268608
Affmat transformed
2024-03-16 19:31:51.321699 MEMORY 19.459268608
sources, targets, weights extracted
2024-03-16 19:31:51.326757 MEMORY 19.459268608
About to launch parallel Leiden runs
2024-03-16 19:31:51.351498 MEMORY 19.459268608
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.9s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    5.7s finished
Parallel Leiden runs finished
2024-03-16 19:31:57.023228 MEMORY 19.459268608
Quality: 0.38094773635290446
Quality: 0.3820416213270807
Quality: 0.3822292461352546
Quality: 0.38292399445280223
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 631 out of 631 | elapsed:    0.2s finished
Got subclusters: Counter({0: 158, 1: 128, 2: 123, 3: 116, 4: 74, 5: 55, 6: 50})
On pattern 4
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 631 samples in 0.005s...
[t-SNE] Computed neighbors for 631 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 631 / 631
[t-SNE] Mean sigma: 0.330798
[t-SNE] Computed conditional probabilities in 0.044s
[t-SNE] Iteration 50: error = 71.3946838, gradient norm = 0.3827841 (50 iterations in 0.070s)
[t-SNE] Iteration 100: error = 72.5073318, gradient norm = 0.3678396 (50 iterations in 0.072s)
[t-SNE] Iteration 150: error = 73.0397491, gradient norm = 0.3797136 (50 iterations in 0.070s)
[t-SNE] Iteration 200: error = 73.3121185, gradient norm = 0.3844424 (50 iterations in 0.068s)
[t-SNE] Iteration 250: error = 71.5825348, gradient norm = 0.4091590 (50 iterations in 0.072s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 71.582535
[t-SNE] Iteration 300: error = 1.7522761, gradient norm = 0.0031324 (50 iterations in 0.066s)
[t-SNE] Iteration 350: error = 1.6509835, gradient norm = 0.0021018 (50 iterations in 0.069s)
[t-SNE] Iteration 400: error = 1.6340500, gradient norm = 0.0005902 (50 iterations in 0.064s)
[t-SNE] Iteration 450: error = 1.6265484, gradient norm = 0.0006123 (50 iterations in 0.066s)
[t-SNE] Iteration 500: error = 1.6171787, gradient norm = 0.0004985 (50 iterations in 0.064s)
[t-SNE] Iteration 550: error = 1.6125307, gradient norm = 0.0002587 (50 iterations in 0.068s)
[t-SNE] Iteration 600: error = 1.6066145, gradient norm = 0.0002792 (50 iterations in 0.259s)
[t-SNE] Iteration 650: error = 1.5997480, gradient norm = 0.0002637 (50 iterations in 0.061s)
[t-SNE] Iteration 700: error = 1.5976548, gradient norm = 0.0002598 (50 iterations in 0.088s)
[t-SNE] Iteration 750: error = 1.5962145, gradient norm = 0.0001303 (50 iterations in 0.063s)
[t-SNE] Iteration 800: error = 1.5958725, gradient norm = 0.0000712 (50 iterations in 0.063s)
[t-SNE] Iteration 850: error = 1.5957451, gradient norm = 0.0000524 (50 iterations in 0.063s)
[t-SNE] Iteration 900: error = 1.5957303, gradient norm = 0.0000478 (50 iterations in 0.063s)
[t-SNE] Iteration 950: error = 1.5957030, gradient norm = 0.0000418 (50 iterations in 0.084s)
[t-SNE] Iteration 1000: error = 1.5957545, gradient norm = 0.0000284 (50 iterations in 0.075s)
[t-SNE] KL divergence after 1000 iterations: 1.595755
[t-SNE] Computed conditional probabilities for sample 631 / 631
[t-SNE] Mean sigma: 0.330798
Beginning preprocessing + Leiden
2024-03-16 19:31:59.556430 MEMORY 19.459268608
Affmat transformed
2024-03-16 19:31:59.564464 MEMORY 19.459268608
sources, targets, weights extracted
2024-03-16 19:31:59.569443 MEMORY 19.459268608
About to launch parallel Leiden runs
2024-03-16 19:31:59.575789 MEMORY 19.459268608
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    5.5s finished
Parallel Leiden runs finished
2024-03-16 19:32:05.098217 MEMORY 19.459268608
Quality: 0.35778643763800944
Quality: 0.3595498699755494
Quality: 0.3604720060464615
Quality: 0.36124597328809255
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 540 out of 540 | elapsed:    0.1s finished
Got subclusters: Counter({0: 157, 1: 107, 2: 104, 3: 83, 4: 79, 5: 65, 6: 34, 7: 2})
On pattern 5
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 540 samples in 0.004s...
[t-SNE] Computed neighbors for 540 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 540 / 540
[t-SNE] Mean sigma: 0.359364
[t-SNE] Computed conditional probabilities in 0.038s
[t-SNE] Iteration 50: error = 67.9448166, gradient norm = 0.4497422 (50 iterations in 0.062s)
[t-SNE] Iteration 100: error = 71.8712082, gradient norm = 0.4071421 (50 iterations in 0.061s)
[t-SNE] Iteration 150: error = 71.3171310, gradient norm = 0.4381697 (50 iterations in 0.060s)
[t-SNE] Iteration 200: error = 72.4618607, gradient norm = 0.4088838 (50 iterations in 0.062s)
[t-SNE] Iteration 250: error = 71.8265533, gradient norm = 0.3982114 (50 iterations in 0.062s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 71.826553
[t-SNE] Iteration 300: error = 1.6829556, gradient norm = 0.0036446 (50 iterations in 0.062s)
[t-SNE] Iteration 350: error = 1.5746285, gradient norm = 0.0019729 (50 iterations in 0.063s)
[t-SNE] Iteration 400: error = 1.5453918, gradient norm = 0.0011595 (50 iterations in 0.058s)
[t-SNE] Iteration 450: error = 1.5339074, gradient norm = 0.0006249 (50 iterations in 0.057s)
[t-SNE] Iteration 500: error = 1.5291504, gradient norm = 0.0003288 (50 iterations in 0.060s)
[t-SNE] Iteration 550: error = 1.5257186, gradient norm = 0.0003021 (50 iterations in 0.058s)
[t-SNE] Iteration 600: error = 1.5217482, gradient norm = 0.0002310 (50 iterations in 0.057s)
[t-SNE] Iteration 650: error = 1.5209377, gradient norm = 0.0001971 (50 iterations in 0.060s)
[t-SNE] Iteration 700: error = 1.5194020, gradient norm = 0.0002412 (50 iterations in 0.056s)
[t-SNE] Iteration 750: error = 1.5167084, gradient norm = 0.0001706 (50 iterations in 0.057s)
[t-SNE] Iteration 800: error = 1.5150315, gradient norm = 0.0003554 (50 iterations in 0.058s)
[t-SNE] Iteration 850: error = 1.5121827, gradient norm = 0.0002673 (50 iterations in 0.057s)
[t-SNE] Iteration 900: error = 1.5118202, gradient norm = 0.0000656 (50 iterations in 0.058s)
[t-SNE] Iteration 950: error = 1.5119534, gradient norm = 0.0000491 (50 iterations in 0.056s)
[t-SNE] Iteration 1000: error = 1.5119966, gradient norm = 0.0000348 (50 iterations in 0.055s)
[t-SNE] KL divergence after 1000 iterations: 1.511997
[t-SNE] Computed conditional probabilities for sample 540 / 540
[t-SNE] Mean sigma: 0.359364
Beginning preprocessing + Leiden
2024-03-16 19:32:07.044753 MEMORY 19.459268608
Affmat transformed
2024-03-16 19:32:07.051907 MEMORY 19.459268608
sources, targets, weights extracted
2024-03-16 19:32:07.056107 MEMORY 19.459268608
About to launch parallel Leiden runs
2024-03-16 19:32:07.081608 MEMORY 19.459268608
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.5s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    4.8s finished
Parallel Leiden runs finished
2024-03-16 19:32:11.897697 MEMORY 19.459268608
Quality: 0.3567945935069018
Quality: 0.3571210575331173
Quality: 0.3582173193622113
Quality: 0.3588856072416919
Quality: 0.35902099041422897
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 344 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 512 out of 512 | elapsed:    0.2s finished
Got subclusters: Counter({0: 112, 1: 95, 2: 94, 3: 72, 4: 64, 5: 56, 6: 37, 7: 10})
On pattern 6
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 512 samples in 0.004s...
[t-SNE] Computed neighbors for 512 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 512 / 512
[t-SNE] Mean sigma: 0.366260
[t-SNE] Computed conditional probabilities in 0.035s
[t-SNE] Iteration 50: error = 68.0713120, gradient norm = 0.4534934 (50 iterations in 0.059s)
[t-SNE] Iteration 100: error = 69.4566879, gradient norm = 0.4442523 (50 iterations in 0.057s)
[t-SNE] Iteration 150: error = 71.1171112, gradient norm = 0.4309365 (50 iterations in 0.059s)
[t-SNE] Iteration 200: error = 72.8310699, gradient norm = 0.4132711 (50 iterations in 0.059s)
[t-SNE] Iteration 250: error = 70.2882996, gradient norm = 0.4393344 (50 iterations in 0.058s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 70.288300
[t-SNE] Iteration 300: error = 1.6121194, gradient norm = 0.0036759 (50 iterations in 0.059s)
[t-SNE] Iteration 350: error = 1.5391111, gradient norm = 0.0015083 (50 iterations in 0.057s)
[t-SNE] Iteration 400: error = 1.5143352, gradient norm = 0.0007521 (50 iterations in 0.058s)
[t-SNE] Iteration 450: error = 1.5010623, gradient norm = 0.0005957 (50 iterations in 0.055s)
[t-SNE] Iteration 500: error = 1.4835464, gradient norm = 0.0009391 (50 iterations in 0.059s)
[t-SNE] Iteration 550: error = 1.4758677, gradient norm = 0.0002428 (50 iterations in 0.055s)
[t-SNE] Iteration 600: error = 1.4735104, gradient norm = 0.0002018 (50 iterations in 0.058s)
[t-SNE] Iteration 650: error = 1.4733756, gradient norm = 0.0000914 (50 iterations in 0.058s)
[t-SNE] Iteration 700: error = 1.4714127, gradient norm = 0.0001744 (50 iterations in 0.058s)
[t-SNE] Iteration 750: error = 1.4700823, gradient norm = 0.0000734 (50 iterations in 0.055s)
[t-SNE] Iteration 800: error = 1.4701383, gradient norm = 0.0000617 (50 iterations in 0.056s)
[t-SNE] Iteration 850: error = 1.4700516, gradient norm = 0.0000413 (50 iterations in 0.057s)
[t-SNE] Iteration 900: error = 1.4699860, gradient norm = 0.0000516 (50 iterations in 0.057s)
[t-SNE] Iteration 950: error = 1.4700540, gradient norm = 0.0000478 (50 iterations in 0.055s)
[t-SNE] Iteration 1000: error = 1.4699899, gradient norm = 0.0000728 (50 iterations in 0.147s)
[t-SNE] KL divergence after 1000 iterations: 1.469990
[t-SNE] Computed conditional probabilities for sample 512 / 512
[t-SNE] Mean sigma: 0.366260
Beginning preprocessing + Leiden
2024-03-16 19:32:13.935771 MEMORY 19.459301376
Affmat transformed
2024-03-16 19:32:13.942620 MEMORY 19.459301376
sources, targets, weights extracted
2024-03-16 19:32:13.946453 MEMORY 19.459301376
About to launch parallel Leiden runs
2024-03-16 19:32:13.951678 MEMORY 19.459301376
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.5s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    4.6s finished
Parallel Leiden runs finished
2024-03-16 19:32:18.516303 MEMORY 19.459301376
Quality: 0.3599196753902698
Quality: 0.3602768275651536
Quality: 0.3609901591962815
Quality: 0.3610549900312915
Quality: 0.36123440944990715
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 344 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 507 out of 507 | elapsed:    0.2s finished
Got subclusters: Counter({0: 112, 1: 106, 2: 97, 3: 97, 4: 87, 5: 8, 6: 5})
On pattern 7
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 507 samples in 0.004s...
[t-SNE] Computed neighbors for 507 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 507 / 507
[t-SNE] Mean sigma: 0.398100
[t-SNE] Computed conditional probabilities in 0.035s
[t-SNE] Iteration 50: error = 66.5359421, gradient norm = 0.4708589 (50 iterations in 0.082s)
[t-SNE] Iteration 100: error = 68.4384308, gradient norm = 0.4458191 (50 iterations in 0.060s)
[t-SNE] Iteration 150: error = 67.7534790, gradient norm = 0.4540236 (50 iterations in 0.066s)
[t-SNE] Iteration 200: error = 67.0923920, gradient norm = 0.4602422 (50 iterations in 0.070s)
[t-SNE] Iteration 250: error = 68.9165649, gradient norm = 0.4453363 (50 iterations in 0.062s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 68.916565
[t-SNE] Iteration 300: error = 1.5894493, gradient norm = 0.0030341 (50 iterations in 0.058s)
[t-SNE] Iteration 350: error = 1.5467063, gradient norm = 0.0009930 (50 iterations in 0.059s)
[t-SNE] Iteration 400: error = 1.5276192, gradient norm = 0.0004503 (50 iterations in 0.058s)
[t-SNE] Iteration 450: error = 1.5162921, gradient norm = 0.0004840 (50 iterations in 0.058s)
[t-SNE] Iteration 500: error = 1.5088863, gradient norm = 0.0009210 (50 iterations in 0.056s)
[t-SNE] Iteration 550: error = 1.5066491, gradient norm = 0.0002011 (50 iterations in 0.056s)
[t-SNE] Iteration 600: error = 1.5057110, gradient norm = 0.0002188 (50 iterations in 0.061s)
[t-SNE] Iteration 650: error = 1.5007285, gradient norm = 0.0003470 (50 iterations in 0.056s)
[t-SNE] Iteration 700: error = 1.4994609, gradient norm = 0.0000833 (50 iterations in 0.058s)
[t-SNE] Iteration 750: error = 1.4987684, gradient norm = 0.0001440 (50 iterations in 0.059s)
[t-SNE] Iteration 800: error = 1.4973524, gradient norm = 0.0006043 (50 iterations in 0.058s)
[t-SNE] Iteration 850: error = 1.4956459, gradient norm = 0.0002578 (50 iterations in 0.057s)
[t-SNE] Iteration 900: error = 1.4916147, gradient norm = 0.0002125 (50 iterations in 0.056s)
[t-SNE] Iteration 950: error = 1.4904323, gradient norm = 0.0001520 (50 iterations in 0.059s)
[t-SNE] Iteration 1000: error = 1.4867693, gradient norm = 0.0002249 (50 iterations in 0.064s)
[t-SNE] KL divergence after 1000 iterations: 1.486769
[t-SNE] Computed conditional probabilities for sample 507 / 507
[t-SNE] Mean sigma: 0.398100
Beginning preprocessing + Leiden
2024-03-16 19:32:20.500309 MEMORY 19.459301376
Affmat transformed
2024-03-16 19:32:20.507611 MEMORY 19.459301376
sources, targets, weights extracted
2024-03-16 19:32:20.511285 MEMORY 19.459301376
About to launch parallel Leiden runs
2024-03-16 19:32:20.516720 MEMORY 19.459301376
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.4s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    4.7s finished
Parallel Leiden runs finished
2024-03-16 19:32:25.245448 MEMORY 19.459301376
Quality: 0.3522343959494312
Quality: 0.3555812818751789
Quality: 0.3558388474548846
Quality: 0.3561784817035635
Quality: 0.35740562447176877
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 344 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 473 out of 473 | elapsed:    0.1s finished
Got subclusters: Counter({0: 112, 1: 107, 2: 95, 3: 86, 4: 68, 5: 39})
On pattern 8
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 473 samples in 0.004s...
[t-SNE] Computed neighbors for 473 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 473 / 473
[t-SNE] Mean sigma: 0.349869
[t-SNE] Computed conditional probabilities in 0.034s
[t-SNE] Iteration 50: error = 70.9997787, gradient norm = 0.4568486 (50 iterations in 0.061s)
[t-SNE] Iteration 100: error = 73.3817902, gradient norm = 0.4066253 (50 iterations in 0.061s)
[t-SNE] Iteration 150: error = 70.9665070, gradient norm = 0.4442185 (50 iterations in 0.060s)
[t-SNE] Iteration 200: error = 73.5594406, gradient norm = 0.4143678 (50 iterations in 0.062s)
[t-SNE] Iteration 250: error = 75.4667130, gradient norm = 0.4145485 (50 iterations in 0.057s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 75.466713
[t-SNE] Iteration 300: error = 1.6570352, gradient norm = 0.0051871 (50 iterations in 0.055s)
[t-SNE] Iteration 350: error = 1.4908295, gradient norm = 0.0017478 (50 iterations in 0.055s)
[t-SNE] Iteration 400: error = 1.4338374, gradient norm = 0.0015616 (50 iterations in 0.055s)
[t-SNE] Iteration 450: error = 1.3950162, gradient norm = 0.0009267 (50 iterations in 0.055s)
[t-SNE] Iteration 500: error = 1.3715628, gradient norm = 0.0008737 (50 iterations in 0.055s)
[t-SNE] Iteration 550: error = 1.3618313, gradient norm = 0.0004518 (50 iterations in 0.056s)
[t-SNE] Iteration 600: error = 1.3524609, gradient norm = 0.0005981 (50 iterations in 0.057s)
[t-SNE] Iteration 650: error = 1.3501344, gradient norm = 0.0001797 (50 iterations in 0.056s)
[t-SNE] Iteration 700: error = 1.3489138, gradient norm = 0.0002826 (50 iterations in 0.054s)
[t-SNE] Iteration 750: error = 1.3485680, gradient norm = 0.0000895 (50 iterations in 0.055s)
[t-SNE] Iteration 800: error = 1.3446126, gradient norm = 0.0005252 (50 iterations in 0.055s)
[t-SNE] Iteration 850: error = 1.3343260, gradient norm = 0.0002979 (50 iterations in 0.054s)
[t-SNE] Iteration 900: error = 1.3323519, gradient norm = 0.0005937 (50 iterations in 0.055s)
[t-SNE] Iteration 950: error = 1.3314841, gradient norm = 0.0005934 (50 iterations in 0.055s)
[t-SNE] Iteration 1000: error = 1.3309383, gradient norm = 0.0001526 (50 iterations in 0.054s)
[t-SNE] KL divergence after 1000 iterations: 1.330938
[t-SNE] Computed conditional probabilities for sample 473 / 473
[t-SNE] Mean sigma: 0.349869
Beginning preprocessing + Leiden
2024-03-16 19:32:27.086820 MEMORY 19.459301376
Affmat transformed
2024-03-16 19:32:27.093554 MEMORY 19.459301376
sources, targets, weights extracted
2024-03-16 19:32:27.097303 MEMORY 19.459301376
About to launch parallel Leiden runs
2024-03-16 19:32:27.103328 MEMORY 19.459301376
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.5s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    4.2s finished
Parallel Leiden runs finished
2024-03-16 19:32:31.299985 MEMORY 19.459301376
Quality: 0.332562796084211
Quality: 0.33281233762038565
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 344 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 464 out of 464 | elapsed:    0.2s finished
Got subclusters: Counter({0: 96, 1: 85, 2: 70, 3: 60, 4: 57, 5: 54, 6: 43, 7: 6, 8: 2})
On pattern 9
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 464 samples in 0.004s...
[t-SNE] Computed neighbors for 464 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 464 / 464
[t-SNE] Mean sigma: 0.406319
[t-SNE] Computed conditional probabilities in 0.031s
[t-SNE] Iteration 50: error = 67.6665115, gradient norm = 0.4678888 (50 iterations in 0.394s)
[t-SNE] Iteration 100: error = 69.1321182, gradient norm = 0.4609965 (50 iterations in 0.055s)
[t-SNE] Iteration 150: error = 69.0922775, gradient norm = 0.4688469 (50 iterations in 0.054s)
[t-SNE] Iteration 200: error = 71.5313034, gradient norm = 0.4458651 (50 iterations in 0.053s)
[t-SNE] Iteration 250: error = 68.7793045, gradient norm = 0.4647053 (50 iterations in 0.063s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 68.779305
[t-SNE] Iteration 300: error = 1.5679142, gradient norm = 0.0047699 (50 iterations in 0.303s)
[t-SNE] Iteration 350: error = 1.4711547, gradient norm = 0.0016344 (50 iterations in 0.052s)
[t-SNE] Iteration 400: error = 1.4443767, gradient norm = 0.0009635 (50 iterations in 0.052s)
[t-SNE] Iteration 450: error = 1.4219013, gradient norm = 0.0007784 (50 iterations in 0.837s)
[t-SNE] Iteration 500: error = 1.4010668, gradient norm = 0.0011385 (50 iterations in 2.004s)
[t-SNE] Iteration 550: error = 1.3896390, gradient norm = 0.0012304 (50 iterations in 0.056s)
[t-SNE] Iteration 600: error = 1.3800889, gradient norm = 0.0002107 (50 iterations in 0.057s)
[t-SNE] Iteration 650: error = 1.3747860, gradient norm = 0.0005055 (50 iterations in 0.056s)
[t-SNE] Iteration 700: error = 1.3738523, gradient norm = 0.0001474 (50 iterations in 0.057s)
[t-SNE] Iteration 750: error = 1.3720616, gradient norm = 0.0001938 (50 iterations in 0.055s)
[t-SNE] Iteration 800: error = 1.3718238, gradient norm = 0.0000716 (50 iterations in 0.160s)
[t-SNE] Iteration 850: error = 1.3715723, gradient norm = 0.0000463 (50 iterations in 0.059s)
[t-SNE] Iteration 900: error = 1.3714023, gradient norm = 0.0000483 (50 iterations in 0.065s)
[t-SNE] Iteration 950: error = 1.3713547, gradient norm = 0.0000524 (50 iterations in 0.069s)
[t-SNE] Iteration 1000: error = 1.3712813, gradient norm = 0.0000607 (50 iterations in 0.056s)
[t-SNE] KL divergence after 1000 iterations: 1.371281
[t-SNE] Computed conditional probabilities for sample 464 / 464
[t-SNE] Mean sigma: 0.406319
Beginning preprocessing + Leiden
2024-03-16 19:32:36.623192 MEMORY 19.45931776
Affmat transformed
2024-03-16 19:32:36.629675 MEMORY 19.45931776
sources, targets, weights extracted
2024-03-16 19:32:36.632826 MEMORY 19.45931776
About to launch parallel Leiden runs
2024-03-16 19:32:36.638585 MEMORY 19.45931776
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.3s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    3.9s finished
Parallel Leiden runs finished
2024-03-16 19:32:40.546120 MEMORY 19.45931776
Quality: 0.36693875609050075
Quality: 0.3671715317578274
Quality: 0.3672233563292719
Quality: 0.36823915524622275
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 344 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 444 out of 444 | elapsed:    0.1s finished
Got subclusters: Counter({0: 84, 1: 82, 2: 74, 3: 73, 4: 64, 5: 59, 6: 28})
On pattern 10
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 444 samples in 0.004s...
[t-SNE] Computed neighbors for 444 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 444 / 444
[t-SNE] Mean sigma: 0.399894
[t-SNE] Computed conditional probabilities in 0.033s
[t-SNE] Iteration 50: error = 68.0964661, gradient norm = 0.4789723 (50 iterations in 0.063s)
[t-SNE] Iteration 100: error = 70.3990936, gradient norm = 0.4370005 (50 iterations in 0.051s)
[t-SNE] Iteration 150: error = 71.3280334, gradient norm = 0.4388593 (50 iterations in 0.051s)
[t-SNE] Iteration 200: error = 73.6515350, gradient norm = 0.4328009 (50 iterations in 0.053s)
[t-SNE] Iteration 250: error = 73.2837524, gradient norm = 0.4396898 (50 iterations in 0.054s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 73.283752
[t-SNE] Iteration 300: error = 1.5150654, gradient norm = 0.0035681 (50 iterations in 0.054s)
[t-SNE] Iteration 350: error = 1.3958899, gradient norm = 0.0013612 (50 iterations in 0.054s)
[t-SNE] Iteration 400: error = 1.3587996, gradient norm = 0.0005707 (50 iterations in 0.054s)
[t-SNE] Iteration 450: error = 1.3485816, gradient norm = 0.0003937 (50 iterations in 0.051s)
[t-SNE] Iteration 500: error = 1.3355865, gradient norm = 0.0009476 (50 iterations in 0.051s)
[t-SNE] Iteration 550: error = 1.3326154, gradient norm = 0.0001491 (50 iterations in 0.052s)
[t-SNE] Iteration 600: error = 1.3299643, gradient norm = 0.0001526 (50 iterations in 0.052s)
[t-SNE] Iteration 650: error = 1.3283979, gradient norm = 0.0003689 (50 iterations in 0.055s)
[t-SNE] Iteration 700: error = 1.3237315, gradient norm = 0.0003216 (50 iterations in 0.052s)
[t-SNE] Iteration 750: error = 1.3209429, gradient norm = 0.0003769 (50 iterations in 0.052s)
[t-SNE] Iteration 800: error = 1.3155444, gradient norm = 0.0005996 (50 iterations in 0.054s)
[t-SNE] Iteration 850: error = 1.3081639, gradient norm = 0.0002238 (50 iterations in 0.051s)
[t-SNE] Iteration 900: error = 1.3046194, gradient norm = 0.0007891 (50 iterations in 0.052s)
[t-SNE] Iteration 950: error = 1.3016450, gradient norm = 0.0004279 (50 iterations in 0.054s)
[t-SNE] Iteration 1000: error = 1.2995917, gradient norm = 0.0004987 (50 iterations in 0.050s)
[t-SNE] KL divergence after 1000 iterations: 1.299592
[t-SNE] Computed conditional probabilities for sample 444 / 444
[t-SNE] Mean sigma: 0.399894
Beginning preprocessing + Leiden
2024-03-16 19:32:42.280880 MEMORY 19.45931776
Affmat transformed
2024-03-16 19:32:42.286858 MEMORY 19.45931776
sources, targets, weights extracted
2024-03-16 19:32:42.290016 MEMORY 19.45931776
About to launch parallel Leiden runs
2024-03-16 19:32:42.295611 MEMORY 19.45931776
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.3s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    4.0s finished
Parallel Leiden runs finished
2024-03-16 19:32:46.285696 MEMORY 19.45931776
Quality: 0.3561883940294381
Quality: 0.3568317336022062
Quality: 0.35699689319917016
Quality: 0.3570685641366991
Quality: 0.35787703514391894
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 344 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 420 out of 420 | elapsed:    0.1s finished
Got subclusters: Counter({0: 111, 1: 103, 2: 73, 3: 65, 4: 48, 5: 44})
On pattern 11
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 420 samples in 0.004s...
[t-SNE] Computed neighbors for 420 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 420 / 420
[t-SNE] Mean sigma: 0.359044
[t-SNE] Computed conditional probabilities in 0.029s
[t-SNE] Iteration 50: error = 67.7290268, gradient norm = 0.4878260 (50 iterations in 0.060s)
[t-SNE] Iteration 100: error = 69.9598541, gradient norm = 0.4656955 (50 iterations in 0.054s)
[t-SNE] Iteration 150: error = 71.9279709, gradient norm = 0.4575295 (50 iterations in 0.050s)
[t-SNE] Iteration 200: error = 69.5148621, gradient norm = 0.4639292 (50 iterations in 0.051s)
[t-SNE] Iteration 250: error = 71.6424942, gradient norm = 0.4526952 (50 iterations in 0.050s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 71.642494
[t-SNE] Iteration 300: error = 1.5022864, gradient norm = 0.0046618 (50 iterations in 0.048s)
[t-SNE] Iteration 350: error = 1.3814390, gradient norm = 0.0021486 (50 iterations in 0.047s)
[t-SNE] Iteration 400: error = 1.3472121, gradient norm = 0.0011387 (50 iterations in 0.047s)
[t-SNE] Iteration 450: error = 1.3314202, gradient norm = 0.0009640 (50 iterations in 0.049s)
[t-SNE] Iteration 500: error = 1.3240327, gradient norm = 0.0016331 (50 iterations in 0.048s)
[t-SNE] Iteration 550: error = 1.3189445, gradient norm = 0.0003878 (50 iterations in 0.047s)
[t-SNE] Iteration 600: error = 1.3123535, gradient norm = 0.0008751 (50 iterations in 0.047s)
[t-SNE] Iteration 650: error = 1.3082927, gradient norm = 0.0003519 (50 iterations in 0.047s)
[t-SNE] Iteration 700: error = 1.3080128, gradient norm = 0.0002270 (50 iterations in 0.047s)
[t-SNE] Iteration 750: error = 1.3078003, gradient norm = 0.0000808 (50 iterations in 0.047s)
[t-SNE] Iteration 800: error = 1.3079672, gradient norm = 0.0002067 (50 iterations in 0.049s)
[t-SNE] Iteration 850: error = 1.3074913, gradient norm = 0.0000810 (50 iterations in 0.048s)
[t-SNE] Iteration 900: error = 1.3074555, gradient norm = 0.0001060 (50 iterations in 0.047s)
[t-SNE] Iteration 950: error = 1.3074142, gradient norm = 0.0000801 (50 iterations in 0.046s)
[t-SNE] Iteration 1000: error = 1.3074381, gradient norm = 0.0001270 (50 iterations in 0.047s)
[t-SNE] KL divergence after 1000 iterations: 1.307438
[t-SNE] Computed conditional probabilities for sample 420 / 420
[t-SNE] Mean sigma: 0.359044
Beginning preprocessing + Leiden
2024-03-16 19:32:47.881718 MEMORY 19.45931776
Affmat transformed
2024-03-16 19:32:47.887606 MEMORY 19.45931776
sources, targets, weights extracted
2024-03-16 19:32:47.890747 MEMORY 19.45931776
About to launch parallel Leiden runs
2024-03-16 19:32:47.896543 MEMORY 19.45931776
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.3s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    3.8s finished
Parallel Leiden runs finished
2024-03-16 19:32:51.744286 MEMORY 19.45931776
Quality: 0.31887839463721446
Quality: 0.31890312556455735
Quality: 0.3199820588666583
Quality: 0.32002342591270894
Quality: 0.32038660233148547
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 344 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 392 out of 392 | elapsed:    0.1s finished
Got subclusters: Counter({0: 77, 1: 66, 2: 63, 3: 59, 4: 56, 5: 33, 7: 28, 6: 28, 8: 7, 9: 3})
On pattern 12
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 392 samples in 0.003s...
[t-SNE] Computed neighbors for 392 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 392 / 392
[t-SNE] Mean sigma: 0.376775
[t-SNE] Computed conditional probabilities in 0.027s
[t-SNE] Iteration 50: error = 70.0030670, gradient norm = 0.4680750 (50 iterations in 0.051s)
[t-SNE] Iteration 100: error = 72.0561218, gradient norm = 0.4539664 (50 iterations in 0.049s)
[t-SNE] Iteration 150: error = 70.8820190, gradient norm = 0.4562509 (50 iterations in 0.052s)
[t-SNE] Iteration 200: error = 73.0873260, gradient norm = 0.4338716 (50 iterations in 0.049s)
[t-SNE] Iteration 250: error = 72.6838913, gradient norm = 0.4424167 (50 iterations in 0.050s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 72.683891
[t-SNE] Iteration 300: error = 1.4336954, gradient norm = 0.0043747 (50 iterations in 0.048s)
[t-SNE] Iteration 350: error = 1.3335419, gradient norm = 0.0017165 (50 iterations in 0.046s)
[t-SNE] Iteration 400: error = 1.2980136, gradient norm = 0.0016534 (50 iterations in 0.047s)
[t-SNE] Iteration 450: error = 1.2625000, gradient norm = 0.0008844 (50 iterations in 0.047s)
[t-SNE] Iteration 500: error = 1.2521340, gradient norm = 0.0008842 (50 iterations in 0.045s)
[t-SNE] Iteration 550: error = 1.2480619, gradient norm = 0.0003546 (50 iterations in 0.044s)
[t-SNE] Iteration 600: error = 1.2467701, gradient norm = 0.0003842 (50 iterations in 0.047s)
[t-SNE] Iteration 650: error = 1.2402656, gradient norm = 0.0003350 (50 iterations in 0.045s)
[t-SNE] Iteration 700: error = 1.2397382, gradient norm = 0.0001648 (50 iterations in 0.046s)
[t-SNE] Iteration 750: error = 1.2397240, gradient norm = 0.0002096 (50 iterations in 0.045s)
[t-SNE] Iteration 800: error = 1.2387513, gradient norm = 0.0001789 (50 iterations in 0.048s)
[t-SNE] Iteration 850: error = 1.2388229, gradient norm = 0.0000752 (50 iterations in 0.054s)
[t-SNE] Iteration 900: error = 1.2387497, gradient norm = 0.0000447 (50 iterations in 0.046s)
[t-SNE] Iteration 950: error = 1.2386500, gradient norm = 0.0000670 (50 iterations in 0.051s)
[t-SNE] Iteration 1000: error = 1.2387284, gradient norm = 0.0000552 (50 iterations in 0.045s)
[t-SNE] KL divergence after 1000 iterations: 1.238728
[t-SNE] Computed conditional probabilities for sample 392 / 392
[t-SNE] Mean sigma: 0.376775
Beginning preprocessing + Leiden
2024-03-16 19:32:53.274736 MEMORY 19.45931776
Affmat transformed
2024-03-16 19:32:53.280237 MEMORY 19.45931776
sources, targets, weights extracted
2024-03-16 19:32:53.283058 MEMORY 19.45931776
About to launch parallel Leiden runs
2024-03-16 19:32:53.288616 MEMORY 19.45931776
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.2s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    3.3s finished
Parallel Leiden runs finished
2024-03-16 19:32:56.589988 MEMORY 19.45931776
Quality: 0.3259769818833759
Quality: 0.3282301528688021
Quality: 0.32839528564551823
Quality: 0.32954567039597155
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 316 out of 363 | elapsed:    0.1s remaining:    0.0s
[Parallel(n_jobs=24)]: Done 363 out of 363 | elapsed:    0.1s finished
Got subclusters: Counter({0: 94, 1: 80, 2: 71, 3: 58, 4: 52, 5: 37})
On pattern 13
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 363 samples in 0.003s...
[t-SNE] Computed neighbors for 363 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 363 / 363
[t-SNE] Mean sigma: 0.372055
[t-SNE] Computed conditional probabilities in 0.025s
[t-SNE] Iteration 50: error = 60.8575325, gradient norm = 0.5453652 (50 iterations in 0.048s)
[t-SNE] Iteration 100: error = 66.1741791, gradient norm = 0.4867851 (50 iterations in 0.047s)
[t-SNE] Iteration 150: error = 67.8150482, gradient norm = 0.4816123 (50 iterations in 0.046s)
[t-SNE] Iteration 200: error = 65.7543564, gradient norm = 0.4780907 (50 iterations in 0.044s)
[t-SNE] Iteration 250: error = 65.8564301, gradient norm = 0.4878180 (50 iterations in 0.047s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 65.856430
[t-SNE] Iteration 300: error = 1.4009509, gradient norm = 0.0039315 (50 iterations in 0.044s)
[t-SNE] Iteration 350: error = 1.3275584, gradient norm = 0.0016744 (50 iterations in 0.046s)
[t-SNE] Iteration 400: error = 1.2897351, gradient norm = 0.0013257 (50 iterations in 0.045s)
[t-SNE] Iteration 450: error = 1.2737833, gradient norm = 0.0019294 (50 iterations in 0.046s)
[t-SNE] Iteration 500: error = 1.2685138, gradient norm = 0.0003179 (50 iterations in 0.045s)
[t-SNE] Iteration 550: error = 1.2644923, gradient norm = 0.0001431 (50 iterations in 0.048s)
[t-SNE] Iteration 600: error = 1.2643747, gradient norm = 0.0000596 (50 iterations in 0.047s)
[t-SNE] Iteration 650: error = 1.2644023, gradient norm = 0.0000411 (50 iterations in 0.043s)
[t-SNE] Iteration 700: error = 1.2643479, gradient norm = 0.0000742 (50 iterations in 0.049s)
[t-SNE] Iteration 750: error = 1.2644379, gradient norm = 0.0000742 (50 iterations in 0.045s)
[t-SNE] Iteration 800: error = 1.2643093, gradient norm = 0.0001008 (50 iterations in 0.044s)
[t-SNE] Iteration 850: error = 1.2643136, gradient norm = 0.0000743 (50 iterations in 0.047s)
[t-SNE] Iteration 900: error = 1.2643667, gradient norm = 0.0000850 (50 iterations in 0.045s)
[t-SNE] Iteration 950: error = 1.2642496, gradient norm = 0.0000935 (50 iterations in 0.047s)
[t-SNE] Iteration 1000: error = 1.2644089, gradient norm = 0.0000762 (50 iterations in 0.046s)
[t-SNE] KL divergence after 1000 iterations: 1.264409
[t-SNE] Computed conditional probabilities for sample 363 / 363
[t-SNE] Mean sigma: 0.372055
Beginning preprocessing + Leiden
2024-03-16 19:32:58.017075 MEMORY 19.45931776
Affmat transformed
2024-03-16 19:32:58.021875 MEMORY 19.45931776
sources, targets, weights extracted
2024-03-16 19:32:58.024425 MEMORY 19.45931776
About to launch parallel Leiden runs
2024-03-16 19:32:58.030033 MEMORY 19.45931776
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.2s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    3.3s finished
Parallel Leiden runs finished
2024-03-16 19:33:01.355640 MEMORY 19.45931776
Quality: 0.3321538263889316
Quality: 0.33263008311728715
Quality: 0.33297642764862667
Quality: 0.33299495782019567
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 360 out of 360 | elapsed:    0.1s finished
Got subclusters: Counter({0: 79, 1: 71, 2: 49, 3: 47, 5: 40, 4: 40, 6: 37})
On pattern 14
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 360 samples in 0.003s...
[t-SNE] Computed neighbors for 360 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 360 / 360
[t-SNE] Mean sigma: 0.384981
[t-SNE] Computed conditional probabilities in 0.025s
[t-SNE] Iteration 50: error = 63.3254166, gradient norm = 0.5053692 (50 iterations in 0.047s)
[t-SNE] Iteration 100: error = 66.6978378, gradient norm = 0.4616141 (50 iterations in 0.047s)
[t-SNE] Iteration 150: error = 65.7171860, gradient norm = 0.5100549 (50 iterations in 0.047s)
[t-SNE] Iteration 200: error = 66.4070740, gradient norm = 0.4972532 (50 iterations in 0.048s)
[t-SNE] Iteration 250: error = 65.4780960, gradient norm = 0.4988330 (50 iterations in 0.049s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 65.478096
[t-SNE] Iteration 300: error = 1.4042387, gradient norm = 0.0043606 (50 iterations in 0.047s)
[t-SNE] Iteration 350: error = 1.3247765, gradient norm = 0.0023074 (50 iterations in 0.049s)
[t-SNE] Iteration 400: error = 1.3078750, gradient norm = 0.0009295 (50 iterations in 0.046s)
[t-SNE] Iteration 450: error = 1.2996631, gradient norm = 0.0005501 (50 iterations in 0.045s)
[t-SNE] Iteration 500: error = 1.2946781, gradient norm = 0.0015029 (50 iterations in 0.043s)
[t-SNE] Iteration 550: error = 1.2858242, gradient norm = 0.0008065 (50 iterations in 0.046s)
[t-SNE] Iteration 600: error = 1.2628789, gradient norm = 0.0009396 (50 iterations in 0.046s)
[t-SNE] Iteration 650: error = 1.2594483, gradient norm = 0.0002581 (50 iterations in 0.045s)
[t-SNE] Iteration 700: error = 1.2588814, gradient norm = 0.0002014 (50 iterations in 0.044s)
[t-SNE] Iteration 750: error = 1.2586294, gradient norm = 0.0001199 (50 iterations in 0.047s)
[t-SNE] Iteration 800: error = 1.2555567, gradient norm = 0.0006134 (50 iterations in 0.044s)
[t-SNE] Iteration 850: error = 1.2545966, gradient norm = 0.0001160 (50 iterations in 0.045s)
[t-SNE] Iteration 900: error = 1.2543733, gradient norm = 0.0001085 (50 iterations in 0.045s)
[t-SNE] Iteration 950: error = 1.2539436, gradient norm = 0.0000913 (50 iterations in 0.046s)
[t-SNE] Iteration 1000: error = 1.2537690, gradient norm = 0.0001041 (50 iterations in 0.048s)
[t-SNE] KL divergence after 1000 iterations: 1.253769
[t-SNE] Computed conditional probabilities for sample 360 / 360
[t-SNE] Mean sigma: 0.384981
Beginning preprocessing + Leiden
2024-03-16 19:33:02.790267 MEMORY 19.45931776
Affmat transformed
2024-03-16 19:33:02.795308 MEMORY 19.45931776
sources, targets, weights extracted
2024-03-16 19:33:02.797830 MEMORY 19.45931776
About to launch parallel Leiden runs
2024-03-16 19:33:02.804106 MEMORY 19.45931776
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.2s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    3.3s finished
Parallel Leiden runs finished
2024-03-16 19:33:06.132526 MEMORY 19.45931776
Quality: 0.324667781056209
Quality: 0.3251042706612597
Quality: 0.32641912810936724
Quality: 0.32655196313323087
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 296 out of 343 | elapsed:    0.1s remaining:    0.0s
[Parallel(n_jobs=24)]: Done 343 out of 343 | elapsed:    0.1s finished
Got subclusters: Counter({0: 94, 1: 83, 2: 58, 3: 38, 4: 35, 5: 32, 6: 20})
On pattern 15
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 343 samples in 0.003s...
[t-SNE] Computed neighbors for 343 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 343 / 343
[t-SNE] Mean sigma: 0.377517
[t-SNE] Computed conditional probabilities in 0.023s
[t-SNE] Iteration 50: error = 65.8112030, gradient norm = 0.4928234 (50 iterations in 0.044s)
[t-SNE] Iteration 100: error = 65.3631973, gradient norm = 0.5087816 (50 iterations in 0.045s)
[t-SNE] Iteration 150: error = 68.5234222, gradient norm = 0.4579403 (50 iterations in 0.043s)
[t-SNE] Iteration 200: error = 69.0685501, gradient norm = 0.4768019 (50 iterations in 0.043s)
[t-SNE] Iteration 250: error = 66.8846283, gradient norm = 0.4779378 (50 iterations in 0.044s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 66.884628
[t-SNE] Iteration 300: error = 1.2943022, gradient norm = 0.0043905 (50 iterations in 0.045s)
[t-SNE] Iteration 350: error = 1.1650261, gradient norm = 0.0024418 (50 iterations in 0.043s)
[t-SNE] Iteration 400: error = 1.1191958, gradient norm = 0.0011123 (50 iterations in 0.043s)
[t-SNE] Iteration 450: error = 1.0808964, gradient norm = 0.0013545 (50 iterations in 0.042s)
[t-SNE] Iteration 500: error = 1.0729365, gradient norm = 0.0005296 (50 iterations in 0.044s)
[t-SNE] Iteration 550: error = 1.0640005, gradient norm = 0.0007918 (50 iterations in 0.041s)
[t-SNE] Iteration 600: error = 1.0591233, gradient norm = 0.0004778 (50 iterations in 0.041s)
[t-SNE] Iteration 650: error = 1.0525439, gradient norm = 0.0006600 (50 iterations in 0.043s)
[t-SNE] Iteration 700: error = 1.0486596, gradient norm = 0.0003845 (50 iterations in 0.042s)
[t-SNE] Iteration 750: error = 1.0483570, gradient norm = 0.0001527 (50 iterations in 0.043s)
[t-SNE] Iteration 800: error = 1.0478997, gradient norm = 0.0001677 (50 iterations in 0.040s)
[t-SNE] Iteration 850: error = 1.0465524, gradient norm = 0.0003051 (50 iterations in 0.042s)
[t-SNE] Iteration 900: error = 1.0462788, gradient norm = 0.0000900 (50 iterations in 0.041s)
[t-SNE] Iteration 950: error = 1.0464458, gradient norm = 0.0000699 (50 iterations in 0.042s)
[t-SNE] Iteration 1000: error = 1.0467329, gradient norm = 0.0001303 (50 iterations in 0.043s)
[t-SNE] KL divergence after 1000 iterations: 1.046733
[t-SNE] Computed conditional probabilities for sample 343 / 343
[t-SNE] Mean sigma: 0.377517
Beginning preprocessing + Leiden
2024-03-16 19:33:07.472829 MEMORY 19.45931776
Affmat transformed
2024-03-16 19:33:07.477638 MEMORY 19.45931776
sources, targets, weights extracted
2024-03-16 19:33:07.480056 MEMORY 19.45931776
About to launch parallel Leiden runs
2024-03-16 19:33:07.485364 MEMORY 19.45931776
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.1s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    3.3s finished
Parallel Leiden runs finished
2024-03-16 19:33:10.790561 MEMORY 19.45931776
Quality: 0.36264707093531656
Quality: 0.3638840568562157
Quality: 0.36429894675566055
Quality: 0.3646324013193343
Quality: 0.36530713447636237
Quality: 0.36644648056783097
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 314 out of 314 | elapsed:    0.1s finished
Got subclusters: Counter({0: 86, 1: 75, 2: 73, 3: 62, 4: 47})
On pattern 16
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 314 samples in 0.003s...
[t-SNE] Computed neighbors for 314 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 314 / 314
[t-SNE] Mean sigma: 0.387873
[t-SNE] Computed conditional probabilities in 0.022s
[t-SNE] Iteration 50: error = 64.8411179, gradient norm = 0.4723450 (50 iterations in 0.044s)
[t-SNE] Iteration 100: error = 63.9975548, gradient norm = 0.5186769 (50 iterations in 0.045s)
[t-SNE] Iteration 150: error = 63.7826042, gradient norm = 0.5030732 (50 iterations in 0.044s)
[t-SNE] Iteration 200: error = 64.8139877, gradient norm = 0.5300545 (50 iterations in 0.043s)
[t-SNE] Iteration 250: error = 63.6783409, gradient norm = 0.4974965 (50 iterations in 0.045s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 63.678341
[t-SNE] Iteration 300: error = 1.1558819, gradient norm = 0.0047856 (50 iterations in 0.041s)
[t-SNE] Iteration 350: error = 1.0984229, gradient norm = 0.0019577 (50 iterations in 0.043s)
[t-SNE] Iteration 400: error = 1.0838394, gradient norm = 0.0011707 (50 iterations in 0.042s)
[t-SNE] Iteration 450: error = 1.0799762, gradient norm = 0.0002955 (50 iterations in 0.045s)
[t-SNE] Iteration 500: error = 1.0740845, gradient norm = 0.0004719 (50 iterations in 0.039s)
[t-SNE] Iteration 550: error = 1.0708964, gradient norm = 0.0007249 (50 iterations in 0.042s)
[t-SNE] Iteration 600: error = 1.0675973, gradient norm = 0.0002932 (50 iterations in 0.043s)
[t-SNE] Iteration 650: error = 1.0667207, gradient norm = 0.0002838 (50 iterations in 0.040s)
[t-SNE] Iteration 700: error = 1.0658647, gradient norm = 0.0006897 (50 iterations in 0.040s)
[t-SNE] Iteration 750: error = 1.0596125, gradient norm = 0.0006910 (50 iterations in 0.042s)
[t-SNE] Iteration 800: error = 1.0587260, gradient norm = 0.0001573 (50 iterations in 0.042s)
[t-SNE] Iteration 850: error = 1.0588177, gradient norm = 0.0000903 (50 iterations in 0.042s)
[t-SNE] Iteration 900: error = 1.0588073, gradient norm = 0.0001180 (50 iterations in 0.047s)
[t-SNE] Iteration 950: error = 1.0588108, gradient norm = 0.0000641 (50 iterations in 0.046s)
[t-SNE] Iteration 1000: error = 1.0587449, gradient norm = 0.0000885 (50 iterations in 0.046s)
[t-SNE] KL divergence after 1000 iterations: 1.058745
[t-SNE] Computed conditional probabilities for sample 314 / 314
[t-SNE] Mean sigma: 0.387873
Beginning preprocessing + Leiden
2024-03-16 19:33:12.123822 MEMORY 19.45931776
Affmat transformed
2024-03-16 19:33:12.128294 MEMORY 19.45931776
sources, targets, weights extracted
2024-03-16 19:33:12.130397 MEMORY 19.45931776
About to launch parallel Leiden runs
2024-03-16 19:33:12.135769 MEMORY 19.45931776
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.0s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    3.1s finished
Parallel Leiden runs finished
2024-03-16 19:33:15.210544 MEMORY 19.45931776
Quality: 0.35743680610961565
Quality: 0.35765532372662645
Quality: 0.35776102027895407
Quality: 0.35780950666417227
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 310 out of 310 | elapsed:    0.1s finished
Got subclusters: Counter({0: 72, 1: 56, 2: 51, 3: 41, 4: 39, 5: 36, 6: 13, 7: 6})
On pattern 17
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 310 samples in 0.003s...
[t-SNE] Computed neighbors for 310 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 310 / 310
[t-SNE] Mean sigma: 0.405288
[t-SNE] Computed conditional probabilities in 0.022s
[t-SNE] Iteration 50: error = 62.5969391, gradient norm = 0.5170746 (50 iterations in 0.047s)
[t-SNE] Iteration 100: error = 65.2029800, gradient norm = 0.5011300 (50 iterations in 0.044s)
[t-SNE] Iteration 150: error = 63.1962852, gradient norm = 0.5344173 (50 iterations in 0.043s)
[t-SNE] Iteration 200: error = 65.3080139, gradient norm = 0.5111073 (50 iterations in 0.043s)
[t-SNE] Iteration 250: error = 62.8517418, gradient norm = 0.5275356 (50 iterations in 0.045s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 62.851742
[t-SNE] Iteration 300: error = 1.1942397, gradient norm = 0.0039371 (50 iterations in 0.043s)
[t-SNE] Iteration 350: error = 1.0793582, gradient norm = 0.0016171 (50 iterations in 0.043s)
[t-SNE] Iteration 400: error = 1.0571609, gradient norm = 0.0011184 (50 iterations in 0.043s)
[t-SNE] Iteration 450: error = 1.0423639, gradient norm = 0.0004187 (50 iterations in 0.043s)
[t-SNE] Iteration 500: error = 1.0410565, gradient norm = 0.0003441 (50 iterations in 0.043s)
[t-SNE] Iteration 550: error = 1.0349249, gradient norm = 0.0002420 (50 iterations in 0.043s)
[t-SNE] Iteration 600: error = 1.0346388, gradient norm = 0.0002694 (50 iterations in 0.043s)
[t-SNE] Iteration 650: error = 1.0307961, gradient norm = 0.0007578 (50 iterations in 0.041s)
[t-SNE] Iteration 700: error = 1.0289233, gradient norm = 0.0002113 (50 iterations in 0.042s)
[t-SNE] Iteration 750: error = 1.0168370, gradient norm = 0.0005811 (50 iterations in 0.043s)
[t-SNE] Iteration 800: error = 1.0153700, gradient norm = 0.0002462 (50 iterations in 0.043s)
[t-SNE] Iteration 850: error = 1.0145957, gradient norm = 0.0001851 (50 iterations in 0.041s)
[t-SNE] Iteration 900: error = 1.0143936, gradient norm = 0.0001016 (50 iterations in 0.040s)
[t-SNE] Iteration 950: error = 1.0143533, gradient norm = 0.0000879 (50 iterations in 0.041s)
[t-SNE] Iteration 1000: error = 1.0143745, gradient norm = 0.0001541 (50 iterations in 0.046s)
[t-SNE] KL divergence after 1000 iterations: 1.014374
[t-SNE] Computed conditional probabilities for sample 310 / 310
[t-SNE] Mean sigma: 0.405288
Beginning preprocessing + Leiden
2024-03-16 19:33:16.545948 MEMORY 19.45931776
Affmat transformed
2024-03-16 19:33:16.550149 MEMORY 19.45931776
sources, targets, weights extracted
2024-03-16 19:33:16.552157 MEMORY 19.45931776
About to launch parallel Leiden runs
2024-03-16 19:33:16.558182 MEMORY 19.45931776
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.0s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    3.1s finished
Parallel Leiden runs finished
2024-03-16 19:33:19.647343 MEMORY 19.45931776
Quality: 0.3562138523462199
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 298 out of 298 | elapsed:    0.1s finished
Got subclusters: Counter({0: 77, 1: 72, 2: 63, 3: 61, 4: 35, 5: 2})
On pattern 18
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 298 samples in 0.003s...
[t-SNE] Computed neighbors for 298 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 298 / 298
[t-SNE] Mean sigma: 0.405523
[t-SNE] Computed conditional probabilities in 0.021s
[t-SNE] Iteration 50: error = 64.1838074, gradient norm = 0.4548170 (50 iterations in 0.043s)
[t-SNE] Iteration 100: error = 62.8568954, gradient norm = 0.4771734 (50 iterations in 0.044s)
[t-SNE] Iteration 150: error = 62.3157539, gradient norm = 0.5246928 (50 iterations in 0.044s)
[t-SNE] Iteration 200: error = 63.7194977, gradient norm = 0.5139865 (50 iterations in 0.109s)
[t-SNE] Iteration 250: error = 65.0980072, gradient norm = 0.4742225 (50 iterations in 0.045s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 65.098007
[t-SNE] Iteration 300: error = 1.2755404, gradient norm = 0.0044108 (50 iterations in 0.043s)
[t-SNE] Iteration 350: error = 1.0891232, gradient norm = 0.0029144 (50 iterations in 0.040s)
[t-SNE] Iteration 400: error = 1.0535140, gradient norm = 0.0020832 (50 iterations in 0.040s)
[t-SNE] Iteration 450: error = 1.0441335, gradient norm = 0.0003132 (50 iterations in 0.039s)
[t-SNE] Iteration 500: error = 1.0419368, gradient norm = 0.0003704 (50 iterations in 0.040s)
[t-SNE] Iteration 550: error = 1.0373911, gradient norm = 0.0010928 (50 iterations in 0.039s)
[t-SNE] Iteration 600: error = 1.0131751, gradient norm = 0.0015994 (50 iterations in 0.041s)
[t-SNE] Iteration 650: error = 0.9917872, gradient norm = 0.0015552 (50 iterations in 0.041s)
[t-SNE] Iteration 700: error = 0.9816188, gradient norm = 0.0021853 (50 iterations in 0.041s)
[t-SNE] Iteration 750: error = 0.9801866, gradient norm = 0.0001252 (50 iterations in 0.040s)
[t-SNE] Iteration 800: error = 0.9799065, gradient norm = 0.0001598 (50 iterations in 0.038s)
[t-SNE] Iteration 850: error = 0.9797180, gradient norm = 0.0001319 (50 iterations in 0.040s)
[t-SNE] Iteration 900: error = 0.9796184, gradient norm = 0.0000732 (50 iterations in 0.040s)
[t-SNE] Iteration 950: error = 0.9798321, gradient norm = 0.0001216 (50 iterations in 0.040s)
[t-SNE] Iteration 1000: error = 0.9797783, gradient norm = 0.0000858 (50 iterations in 0.038s)
[t-SNE] KL divergence after 1000 iterations: 0.979778
[t-SNE] Computed conditional probabilities for sample 298 / 298
[t-SNE] Mean sigma: 0.405523
Beginning preprocessing + Leiden
2024-03-16 19:33:20.984491 MEMORY 19.45931776
Affmat transformed
2024-03-16 19:33:20.988751 MEMORY 19.45931776
sources, targets, weights extracted
2024-03-16 19:33:20.990705 MEMORY 19.45931776
About to launch parallel Leiden runs
2024-03-16 19:33:20.995531 MEMORY 19.45931776
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.9s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.7s finished
Parallel Leiden runs finished
2024-03-16 19:33:23.673969 MEMORY 19.45931776
Quality: 0.37248457032557236
Quality: 0.3725550394265293
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 232 out of 279 | elapsed:    0.1s remaining:    0.0s
[Parallel(n_jobs=24)]: Done 279 out of 279 | elapsed:    0.1s finished
Got subclusters: Counter({1: 53, 0: 53, 2: 53, 3: 44, 4: 39, 5: 31, 6: 25})
On pattern 19
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 279 samples in 0.003s...
[t-SNE] Computed neighbors for 279 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 279 / 279
[t-SNE] Mean sigma: 0.390595
[t-SNE] Computed conditional probabilities in 0.020s
[t-SNE] Iteration 50: error = 64.2502518, gradient norm = 0.4704584 (50 iterations in 0.040s)
[t-SNE] Iteration 100: error = 63.5144501, gradient norm = 0.5369934 (50 iterations in 0.039s)
[t-SNE] Iteration 150: error = 63.7306709, gradient norm = 0.4851122 (50 iterations in 0.038s)
[t-SNE] Iteration 200: error = 64.4712830, gradient norm = 0.4425912 (50 iterations in 0.039s)
[t-SNE] Iteration 250: error = 64.1571503, gradient norm = 0.5010133 (50 iterations in 0.040s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 64.157150
[t-SNE] Iteration 300: error = 1.1709924, gradient norm = 0.0045024 (50 iterations in 0.042s)
[t-SNE] Iteration 350: error = 1.0892278, gradient norm = 0.0029597 (50 iterations in 0.044s)
[t-SNE] Iteration 400: error = 1.0510530, gradient norm = 0.0009700 (50 iterations in 0.042s)
[t-SNE] Iteration 450: error = 1.0405525, gradient norm = 0.0008492 (50 iterations in 0.042s)
[t-SNE] Iteration 500: error = 1.0388322, gradient norm = 0.0001356 (50 iterations in 0.040s)
[t-SNE] Iteration 550: error = 1.0387915, gradient norm = 0.0000848 (50 iterations in 0.040s)
[t-SNE] Iteration 600: error = 1.0388647, gradient norm = 0.0000923 (50 iterations in 0.040s)
[t-SNE] Iteration 650: error = 1.0387918, gradient norm = 0.0000767 (50 iterations in 0.039s)
[t-SNE] Iteration 700: error = 1.0388712, gradient norm = 0.0001068 (50 iterations in 0.040s)
[t-SNE] Iteration 750: error = 1.0390413, gradient norm = 0.0001349 (50 iterations in 0.041s)
[t-SNE] Iteration 800: error = 1.0390054, gradient norm = 0.0001038 (50 iterations in 0.038s)
[t-SNE] Iteration 850: error = 1.0389962, gradient norm = 0.0000908 (50 iterations in 0.041s)
[t-SNE] Iteration 900: error = 1.0388230, gradient norm = 0.0000605 (50 iterations in 0.044s)
[t-SNE] Iteration 900: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 900 iterations: 1.038823
[t-SNE] Computed conditional probabilities for sample 279 / 279
[t-SNE] Mean sigma: 0.390595
Beginning preprocessing + Leiden
2024-03-16 19:33:24.798224 MEMORY 19.45931776
Affmat transformed
2024-03-16 19:33:24.802163 MEMORY 19.45931776
sources, targets, weights extracted
2024-03-16 19:33:24.804001 MEMORY 19.45931776
About to launch parallel Leiden runs
2024-03-16 19:33:24.824221 MEMORY 19.45931776
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.0s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.8s finished
Parallel Leiden runs finished
2024-03-16 19:33:27.647507 MEMORY 19.45931776
Quality: 0.3101984818666861
Quality: 0.3106937787028863
Quality: 0.3110457701560132
Quality: 0.31163095133789787
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 224 out of 271 | elapsed:    0.1s remaining:    0.0s
[Parallel(n_jobs=24)]: Done 271 out of 271 | elapsed:    0.1s finished
Got subclusters: Counter({0: 50, 2: 48, 1: 48, 3: 46, 4: 36, 5: 29, 6: 22})
On pattern 20
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 271 samples in 0.003s...
[t-SNE] Computed neighbors for 271 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 271 / 271
[t-SNE] Mean sigma: 0.385614
[t-SNE] Computed conditional probabilities in 0.019s
[t-SNE] Iteration 50: error = 63.2053566, gradient norm = 0.4754413 (50 iterations in 0.039s)
[t-SNE] Iteration 100: error = 64.0616150, gradient norm = 0.4884633 (50 iterations in 0.038s)
[t-SNE] Iteration 150: error = 60.8572197, gradient norm = 0.5369908 (50 iterations in 0.038s)
[t-SNE] Iteration 200: error = 62.9345589, gradient norm = 0.4904442 (50 iterations in 0.040s)
[t-SNE] Iteration 250: error = 60.4824486, gradient norm = 0.5394113 (50 iterations in 0.040s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 60.482449
[t-SNE] Iteration 300: error = 1.1315738, gradient norm = 0.0049871 (50 iterations in 0.036s)
[t-SNE] Iteration 350: error = 1.0106622, gradient norm = 0.0016414 (50 iterations in 0.039s)
[t-SNE] Iteration 400: error = 1.0027395, gradient norm = 0.0006928 (50 iterations in 0.040s)
[t-SNE] Iteration 450: error = 1.0001435, gradient norm = 0.0002727 (50 iterations in 0.042s)
[t-SNE] Iteration 500: error = 1.0000805, gradient norm = 0.0001218 (50 iterations in 0.039s)
[t-SNE] Iteration 550: error = 1.0000411, gradient norm = 0.0000851 (50 iterations in 0.039s)
[t-SNE] Iteration 600: error = 0.9999512, gradient norm = 0.0001513 (50 iterations in 0.039s)
[t-SNE] Iteration 650: error = 1.0001428, gradient norm = 0.0001139 (50 iterations in 0.038s)
[t-SNE] Iteration 700: error = 1.0000259, gradient norm = 0.0001305 (50 iterations in 0.037s)
[t-SNE] Iteration 750: error = 1.0000720, gradient norm = 0.0001095 (50 iterations in 0.039s)
[t-SNE] Iteration 800: error = 1.0001549, gradient norm = 0.0001307 (50 iterations in 0.040s)
[t-SNE] Iteration 850: error = 1.0001221, gradient norm = 0.0001115 (50 iterations in 0.040s)
[t-SNE] Iteration 900: error = 1.0001811, gradient norm = 0.0001079 (50 iterations in 0.038s)
[t-SNE] Iteration 950: error = 1.0001347, gradient norm = 0.0001056 (50 iterations in 0.038s)
[t-SNE] Iteration 950: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 950 iterations: 1.000135
[t-SNE] Computed conditional probabilities for sample 271 / 271
[t-SNE] Mean sigma: 0.385615
Beginning preprocessing + Leiden
2024-03-16 19:33:28.774880 MEMORY 19.45931776
Affmat transformed
2024-03-16 19:33:28.778723 MEMORY 19.45931776
sources, targets, weights extracted
2024-03-16 19:33:28.780474 MEMORY 19.45931776
About to launch parallel Leiden runs
2024-03-16 19:33:28.785676 MEMORY 19.45931776
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.0s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.8s finished
Parallel Leiden runs finished
2024-03-16 19:33:31.590369 MEMORY 19.45931776
Quality: 0.33371612100548786
Quality: 0.33637945939457436
Quality: 0.33697178303465536
Quality: 0.33794638227682416
Quality: 0.33802592923382346
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 260 out of 260 | elapsed:    0.1s finished
Got subclusters: Counter({0: 71, 1: 64, 2: 54, 3: 51, 4: 27, 5: 4})
On pattern 21
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 260 samples in 0.002s...
[t-SNE] Computed neighbors for 260 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 260 / 260
[t-SNE] Mean sigma: 0.405719
[t-SNE] Computed conditional probabilities in 0.018s
[t-SNE] Iteration 50: error = 59.2062721, gradient norm = 0.5616821 (50 iterations in 0.038s)
[t-SNE] Iteration 100: error = 60.6764221, gradient norm = 0.5018821 (50 iterations in 0.041s)
[t-SNE] Iteration 150: error = 61.6530266, gradient norm = 0.5005485 (50 iterations in 0.037s)
[t-SNE] Iteration 200: error = 64.4995346, gradient norm = 0.4955805 (50 iterations in 0.037s)
[t-SNE] Iteration 250: error = 62.3611412, gradient norm = 0.5277002 (50 iterations in 0.039s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 62.361141
[t-SNE] Iteration 300: error = 1.2549539, gradient norm = 0.0064350 (50 iterations in 0.039s)
[t-SNE] Iteration 350: error = 1.1090159, gradient norm = 0.0027192 (50 iterations in 0.036s)
[t-SNE] Iteration 400: error = 1.0706123, gradient norm = 0.0009135 (50 iterations in 0.036s)
[t-SNE] Iteration 450: error = 1.0259365, gradient norm = 0.0018572 (50 iterations in 0.040s)
[t-SNE] Iteration 500: error = 1.0169513, gradient norm = 0.0006468 (50 iterations in 0.040s)
[t-SNE] Iteration 550: error = 1.0160234, gradient norm = 0.0004498 (50 iterations in 0.039s)
[t-SNE] Iteration 600: error = 1.0153421, gradient norm = 0.0003489 (50 iterations in 0.039s)
[t-SNE] Iteration 650: error = 1.0153928, gradient norm = 0.0003259 (50 iterations in 0.038s)
[t-SNE] Iteration 700: error = 1.0128999, gradient norm = 0.0008088 (50 iterations in 0.063s)
[t-SNE] Iteration 750: error = 1.0118198, gradient norm = 0.0001390 (50 iterations in 0.038s)
[t-SNE] Iteration 800: error = 1.0117917, gradient norm = 0.0000889 (50 iterations in 0.042s)
[t-SNE] Iteration 850: error = 1.0118535, gradient norm = 0.0001129 (50 iterations in 0.037s)
[t-SNE] Iteration 900: error = 1.0118326, gradient norm = 0.0000969 (50 iterations in 0.036s)
[t-SNE] Iteration 950: error = 1.0118700, gradient norm = 0.0001009 (50 iterations in 0.036s)
[t-SNE] Iteration 1000: error = 1.0117862, gradient norm = 0.0000857 (50 iterations in 0.036s)
[t-SNE] KL divergence after 1000 iterations: 1.011786
[t-SNE] Computed conditional probabilities for sample 260 / 260
[t-SNE] Mean sigma: 0.405719
Beginning preprocessing + Leiden
2024-03-16 19:33:32.742905 MEMORY 19.45931776
Affmat transformed
2024-03-16 19:33:32.746680 MEMORY 19.45931776
sources, targets, weights extracted
2024-03-16 19:33:32.748260 MEMORY 19.45931776
About to launch parallel Leiden runs
2024-03-16 19:33:32.753652 MEMORY 19.45931776
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.9s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.8s finished
Parallel Leiden runs finished
2024-03-16 19:33:35.566699 MEMORY 19.45931776
Quality: 0.31095482703347166
Quality: 0.3110794469566502
Quality: 0.3118703332995048
Quality: 0.3121698008094548
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 252 out of 252 | elapsed:    0.1s finished
Got subclusters: Counter({0: 62, 1: 58, 2: 46, 3: 39, 4: 25, 5: 17, 6: 13})
On pattern 22
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 252 samples in 0.002s...
[t-SNE] Computed neighbors for 252 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 252 / 252
[t-SNE] Mean sigma: 0.405879
[t-SNE] Computed conditional probabilities in 0.017s
[t-SNE] Iteration 50: error = 67.1176834, gradient norm = 0.4532732 (50 iterations in 0.040s)
[t-SNE] Iteration 100: error = 61.1962204, gradient norm = 0.5379747 (50 iterations in 0.040s)
[t-SNE] Iteration 150: error = 64.3598709, gradient norm = 0.4889257 (50 iterations in 0.038s)
[t-SNE] Iteration 200: error = 61.7770767, gradient norm = 0.5094846 (50 iterations in 0.038s)
[t-SNE] Iteration 250: error = 61.5605774, gradient norm = 0.5083598 (50 iterations in 0.039s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 61.560577
[t-SNE] Iteration 300: error = 1.0033209, gradient norm = 0.0056583 (50 iterations in 0.036s)
[t-SNE] Iteration 350: error = 0.8686309, gradient norm = 0.0025488 (50 iterations in 0.035s)
[t-SNE] Iteration 400: error = 0.8484352, gradient norm = 0.0007388 (50 iterations in 0.037s)
[t-SNE] Iteration 450: error = 0.8479673, gradient norm = 0.0001030 (50 iterations in 0.039s)
[t-SNE] Iteration 500: error = 0.8479808, gradient norm = 0.0001277 (50 iterations in 0.037s)
[t-SNE] Iteration 550: error = 0.8482342, gradient norm = 0.0002211 (50 iterations in 0.037s)
[t-SNE] Iteration 600: error = 0.8479130, gradient norm = 0.0001464 (50 iterations in 0.038s)
[t-SNE] Iteration 650: error = 0.8480973, gradient norm = 0.0000730 (50 iterations in 0.038s)
[t-SNE] Iteration 700: error = 0.8479981, gradient norm = 0.0000920 (50 iterations in 0.038s)
[t-SNE] Iteration 750: error = 0.8477650, gradient norm = 0.0001023 (50 iterations in 0.039s)
[t-SNE] Iteration 800: error = 0.8475658, gradient norm = 0.0000776 (50 iterations in 0.038s)
[t-SNE] Iteration 850: error = 0.8476322, gradient norm = 0.0000771 (50 iterations in 0.037s)
[t-SNE] Iteration 900: error = 0.8474998, gradient norm = 0.0000653 (50 iterations in 0.035s)
[t-SNE] Iteration 950: error = 0.8474963, gradient norm = 0.0000582 (50 iterations in 0.038s)
[t-SNE] Iteration 1000: error = 0.8476590, gradient norm = 0.0000887 (50 iterations in 0.037s)
[t-SNE] KL divergence after 1000 iterations: 0.847659
[t-SNE] Computed conditional probabilities for sample 252 / 252
[t-SNE] Mean sigma: 0.405880
Beginning preprocessing + Leiden
2024-03-16 19:33:36.679335 MEMORY 19.45931776
Affmat transformed
2024-03-16 19:33:36.682961 MEMORY 19.45931776
sources, targets, weights extracted
2024-03-16 19:33:36.684570 MEMORY 19.45931776
About to launch parallel Leiden runs
2024-03-16 19:33:36.689645 MEMORY 19.45931776
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.8s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.5s finished
Parallel Leiden runs finished
2024-03-16 19:33:39.210238 MEMORY 19.45931776
Quality: 0.3281588480454023
Quality: 0.32835924731787974
Quality: 0.32887932969089195
Quality: 0.32896449655157173
Quality: 0.32929949729763175
Quality: 0.32942950740606913
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 252 out of 252 | elapsed:    0.1s finished
Got subclusters: Counter({0: 71, 1: 42, 2: 38, 3: 37, 4: 37, 5: 27})
On pattern 23
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 252 samples in 0.003s...
[t-SNE] Computed neighbors for 252 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 252 / 252
[t-SNE] Mean sigma: 0.411921
[t-SNE] Computed conditional probabilities in 0.017s
[t-SNE] Iteration 50: error = 59.3547020, gradient norm = 0.5354394 (50 iterations in 0.057s)
[t-SNE] Iteration 100: error = 59.3971558, gradient norm = 0.5476336 (50 iterations in 0.041s)
[t-SNE] Iteration 150: error = 61.7618446, gradient norm = 0.5005612 (50 iterations in 0.039s)
[t-SNE] Iteration 200: error = 59.9999809, gradient norm = 0.5231274 (50 iterations in 0.040s)
[t-SNE] Iteration 250: error = 59.9815369, gradient norm = 0.4848014 (50 iterations in 0.042s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 59.981537
[t-SNE] Iteration 300: error = 1.0667186, gradient norm = 0.0056136 (50 iterations in 0.040s)
[t-SNE] Iteration 350: error = 0.9598052, gradient norm = 0.0017537 (50 iterations in 0.042s)
[t-SNE] Iteration 400: error = 0.9165884, gradient norm = 0.0017779 (50 iterations in 0.040s)
[t-SNE] Iteration 450: error = 0.9148157, gradient norm = 0.0001815 (50 iterations in 0.043s)
[t-SNE] Iteration 500: error = 0.9143451, gradient norm = 0.0004282 (50 iterations in 0.042s)
[t-SNE] Iteration 550: error = 0.9136606, gradient norm = 0.0001458 (50 iterations in 0.040s)
[t-SNE] Iteration 600: error = 0.9136312, gradient norm = 0.0001314 (50 iterations in 0.040s)
[t-SNE] Iteration 650: error = 0.9136295, gradient norm = 0.0001743 (50 iterations in 0.040s)
[t-SNE] Iteration 700: error = 0.9136596, gradient norm = 0.0001384 (50 iterations in 0.041s)
[t-SNE] Iteration 750: error = 0.9136660, gradient norm = 0.0001394 (50 iterations in 0.041s)
[t-SNE] Iteration 800: error = 0.9137126, gradient norm = 0.0001193 (50 iterations in 0.065s)
[t-SNE] Iteration 850: error = 0.9137221, gradient norm = 0.0000807 (50 iterations in 0.040s)
[t-SNE] Iteration 900: error = 0.9136807, gradient norm = 0.0001065 (50 iterations in 0.039s)
[t-SNE] Iteration 950: error = 0.9136529, gradient norm = 0.0001418 (50 iterations in 0.039s)
[t-SNE] Iteration 1000: error = 0.9136807, gradient norm = 0.0001276 (50 iterations in 0.038s)
[t-SNE] Iteration 1000: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 1000 iterations: 0.913681
[t-SNE] Computed conditional probabilities for sample 252 / 252
[t-SNE] Mean sigma: 0.411921
Beginning preprocessing + Leiden
2024-03-16 19:33:40.440923 MEMORY 19.45931776
Affmat transformed
2024-03-16 19:33:40.444699 MEMORY 19.45931776
sources, targets, weights extracted
2024-03-16 19:33:40.446577 MEMORY 19.45931776
About to launch parallel Leiden runs
2024-03-16 19:33:40.451054 MEMORY 19.45931776
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.9s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.5s finished
Parallel Leiden runs finished
2024-03-16 19:33:42.925979 MEMORY 19.45931776
Quality: 0.33519560931800446
Quality: 0.3367018915322896
Quality: 0.33680365064946394
Quality: 0.3369387190911644
Quality: 0.3370613745570572
Quality: 0.3370978970153714
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 226 out of 226 | elapsed:    0.1s finished
Got subclusters: Counter({0: 66, 1: 54, 2: 43, 3: 36, 4: 34, 5: 19})
On pattern 24
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 226 samples in 0.002s...
[t-SNE] Computed neighbors for 226 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 226 / 226
[t-SNE] Mean sigma: 0.421612
[t-SNE] Computed conditional probabilities in 0.015s
[t-SNE] Iteration 50: error = 59.8933868, gradient norm = 0.5115436 (50 iterations in 0.057s)
[t-SNE] Iteration 100: error = 61.0954514, gradient norm = 0.5007871 (50 iterations in 0.034s)
[t-SNE] Iteration 150: error = 60.0665359, gradient norm = 0.5246523 (50 iterations in 0.035s)
[t-SNE] Iteration 200: error = 58.8602753, gradient norm = 0.5418313 (50 iterations in 0.033s)
[t-SNE] Iteration 250: error = 59.4587021, gradient norm = 0.5347211 (50 iterations in 0.034s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 59.458702
[t-SNE] Iteration 300: error = 1.1039240, gradient norm = 0.0048350 (50 iterations in 0.034s)
[t-SNE] Iteration 350: error = 0.8785713, gradient norm = 0.0043151 (50 iterations in 0.035s)
[t-SNE] Iteration 400: error = 0.8458578, gradient norm = 0.0018822 (50 iterations in 0.036s)
[t-SNE] Iteration 450: error = 0.8393512, gradient norm = 0.0010131 (50 iterations in 0.036s)
[t-SNE] Iteration 500: error = 0.8379726, gradient norm = 0.0002040 (50 iterations in 0.033s)
[t-SNE] Iteration 550: error = 0.8379446, gradient norm = 0.0001754 (50 iterations in 0.040s)
[t-SNE] Iteration 600: error = 0.8379846, gradient norm = 0.0001635 (50 iterations in 0.034s)
[t-SNE] Iteration 650: error = 0.8380911, gradient norm = 0.0001901 (50 iterations in 0.042s)
[t-SNE] Iteration 700: error = 0.8382916, gradient norm = 0.0001759 (50 iterations in 0.036s)
[t-SNE] Iteration 750: error = 0.8381929, gradient norm = 0.0002246 (50 iterations in 0.035s)
[t-SNE] Iteration 800: error = 0.8382176, gradient norm = 0.0001837 (50 iterations in 0.036s)
[t-SNE] Iteration 850: error = 0.8379697, gradient norm = 0.0000803 (50 iterations in 0.036s)
[t-SNE] Iteration 900: error = 0.8379391, gradient norm = 0.0001313 (50 iterations in 0.035s)
[t-SNE] Iteration 950: error = 0.8378845, gradient norm = 0.0001114 (50 iterations in 0.037s)
[t-SNE] Iteration 1000: error = 0.8379628, gradient norm = 0.0001213 (50 iterations in 0.039s)
[t-SNE] KL divergence after 1000 iterations: 0.837963
[t-SNE] Computed conditional probabilities for sample 226 / 226
[t-SNE] Mean sigma: 0.421612
Beginning preprocessing + Leiden
2024-03-16 19:33:44.030059 MEMORY 19.45931776
Affmat transformed
2024-03-16 19:33:44.033408 MEMORY 19.45931776
sources, targets, weights extracted
2024-03-16 19:33:44.034784 MEMORY 19.45931776
About to launch parallel Leiden runs
2024-03-16 19:33:44.039678 MEMORY 19.45931776
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.8s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.4s finished
Parallel Leiden runs finished
2024-03-16 19:33:46.479702 MEMORY 19.45931776
Quality: 0.2971742416774383
Quality: 0.2973827303487932
Quality: 0.2978243925404224
Quality: 0.2989679636787198
Quality: 0.29949987198284944
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 206 out of 206 | elapsed:    0.1s finished
Got subclusters: Counter({0: 56, 1: 51, 2: 44, 3: 39, 4: 36})
On pattern 25
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 206 samples in 0.002s...
[t-SNE] Computed neighbors for 206 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 206 / 206
[t-SNE] Mean sigma: 0.447277
[t-SNE] Computed conditional probabilities in 0.014s
[t-SNE] Iteration 50: error = 59.6022224, gradient norm = 0.5081185 (50 iterations in 0.034s)
[t-SNE] Iteration 100: error = 57.6866646, gradient norm = 0.5567287 (50 iterations in 0.034s)
[t-SNE] Iteration 150: error = 58.0435791, gradient norm = 0.5011563 (50 iterations in 0.035s)
[t-SNE] Iteration 200: error = 56.3030663, gradient norm = 0.5517061 (50 iterations in 0.034s)
[t-SNE] Iteration 250: error = 57.6849709, gradient norm = 0.5321220 (50 iterations in 0.035s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 57.684971
[t-SNE] Iteration 300: error = 0.9478590, gradient norm = 0.0060213 (50 iterations in 0.032s)
[t-SNE] Iteration 350: error = 0.8732151, gradient norm = 0.0017221 (50 iterations in 0.034s)
[t-SNE] Iteration 400: error = 0.8204640, gradient norm = 0.0028047 (50 iterations in 0.031s)
[t-SNE] Iteration 450: error = 0.7808135, gradient norm = 0.0004705 (50 iterations in 0.031s)
[t-SNE] Iteration 500: error = 0.7794970, gradient norm = 0.0001790 (50 iterations in 0.032s)
[t-SNE] Iteration 550: error = 0.7793285, gradient norm = 0.0002784 (50 iterations in 0.033s)
[t-SNE] Iteration 600: error = 0.7794402, gradient norm = 0.0001820 (50 iterations in 0.034s)
[t-SNE] Iteration 650: error = 0.7790688, gradient norm = 0.0001121 (50 iterations in 0.033s)
[t-SNE] Iteration 700: error = 0.7790110, gradient norm = 0.0000665 (50 iterations in 0.034s)
[t-SNE] Iteration 750: error = 0.7790354, gradient norm = 0.0000641 (50 iterations in 0.034s)
[t-SNE] Iteration 800: error = 0.7790370, gradient norm = 0.0000671 (50 iterations in 0.032s)
[t-SNE] Iteration 850: error = 0.7790412, gradient norm = 0.0000636 (50 iterations in 0.033s)
[t-SNE] Iteration 900: error = 0.7790346, gradient norm = 0.0000922 (50 iterations in 0.033s)
[t-SNE] Iteration 950: error = 0.7790205, gradient norm = 0.0000746 (50 iterations in 0.031s)
[t-SNE] Iteration 1000: error = 0.7790194, gradient norm = 0.0000742 (50 iterations in 0.030s)
[t-SNE] KL divergence after 1000 iterations: 0.779019
Warning: each seqlet is not its own nearest neighbor; there may be duplicates
[t-SNE] Computed conditional probabilities for sample 206 / 206
[t-SNE] Mean sigma: 0.447277
Beginning preprocessing + Leiden
2024-03-16 19:33:47.461814 MEMORY 19.45931776
Affmat transformed
2024-03-16 19:33:47.464798 MEMORY 19.45931776
sources, targets, weights extracted
2024-03-16 19:33:47.465917 MEMORY 19.45931776
About to launch parallel Leiden runs
2024-03-16 19:33:47.470947 MEMORY 19.45931776
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.8s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.3s finished
Parallel Leiden runs finished
2024-03-16 19:33:49.814844 MEMORY 19.45931776
Quality: 0.31760665027445883
Quality: 0.31800634904168495
Quality: 0.3183141138349788
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  95 out of  95 | elapsed:    0.0s finished
Got subclusters: Counter({0: 69, 1: 40, 2: 35, 3: 33, 4: 29})
On pattern 26
[t-SNE] Computing 94 nearest neighbors...
[t-SNE] Indexed 95 samples in 0.001s...
[t-SNE] Computed neighbors for 95 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 95 / 95
[t-SNE] Mean sigma: 0.636000
[t-SNE] Computed conditional probabilities in 0.004s
[t-SNE] Iteration 50: error = 52.0766068, gradient norm = 0.5231224 (50 iterations in 0.026s)
[t-SNE] Iteration 100: error = 49.6135216, gradient norm = 0.4989633 (50 iterations in 0.018s)
[t-SNE] Iteration 150: error = 48.0729790, gradient norm = 0.5929114 (50 iterations in 0.017s)
[t-SNE] Iteration 200: error = 48.9744034, gradient norm = 0.5407014 (50 iterations in 0.019s)
[t-SNE] Iteration 250: error = 50.1264610, gradient norm = 0.5274076 (50 iterations in 0.017s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 50.126461
[t-SNE] Iteration 300: error = 0.4026000, gradient norm = 0.0204321 (50 iterations in 0.017s)
[t-SNE] Iteration 350: error = 0.2815970, gradient norm = 0.0022280 (50 iterations in 0.026s)
[t-SNE] Iteration 400: error = 0.2809528, gradient norm = 0.0009215 (50 iterations in 0.018s)
[t-SNE] Iteration 450: error = 0.2816184, gradient norm = 0.0004684 (50 iterations in 0.018s)
[t-SNE] Iteration 500: error = 0.2817594, gradient norm = 0.0006548 (50 iterations in 0.020s)
[t-SNE] Iteration 550: error = 0.2818831, gradient norm = 0.0004675 (50 iterations in 0.018s)
[t-SNE] Iteration 600: error = 0.2819259, gradient norm = 0.0004728 (50 iterations in 0.020s)
[t-SNE] Iteration 650: error = 0.2819106, gradient norm = 0.0004558 (50 iterations in 0.020s)
[t-SNE] Iteration 700: error = 0.2819067, gradient norm = 0.0004515 (50 iterations in 0.018s)
[t-SNE] Iteration 750: error = 0.2819381, gradient norm = 0.0004519 (50 iterations in 0.020s)
[t-SNE] Iteration 750: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 750 iterations: 0.281938
[t-SNE] Computed conditional probabilities for sample 95 / 95
[t-SNE] Mean sigma: 0.636000
Beginning preprocessing + Leiden
2024-03-16 19:33:50.235810 MEMORY 19.45931776
Affmat transformed
2024-03-16 19:33:50.237093 MEMORY 19.45931776
sources, targets, weights extracted
2024-03-16 19:33:50.237652 MEMORY 19.45931776
About to launch parallel Leiden runs
2024-03-16 19:33:50.242358 MEMORY 19.45931776
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.8s finished
Parallel Leiden runs finished
2024-03-16 19:33:52.091149 MEMORY 19.45931776
Quality: 0.23554097591424472
Quality: 0.23802437172106555
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  65 out of  65 | elapsed:    0.0s finished
Got subclusters: Counter({0: 40, 1: 28, 2: 27})
On pattern 27
[t-SNE] Computing 64 nearest neighbors...
[t-SNE] Indexed 65 samples in 0.001s...
[t-SNE] Computed neighbors for 65 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 65 / 65
[t-SNE] Mean sigma: 0.673293
[t-SNE] Computed conditional probabilities in 0.002s
[t-SNE] Iteration 50: error = 44.7049637, gradient norm = 0.4475519 (50 iterations in 0.013s)
[t-SNE] Iteration 100: error = 47.1836929, gradient norm = 0.5871465 (50 iterations in 0.013s)
[t-SNE] Iteration 150: error = 45.4122314, gradient norm = 0.4865383 (50 iterations in 0.014s)
[t-SNE] Iteration 200: error = 47.9557877, gradient norm = 0.5694198 (50 iterations in 0.014s)
[t-SNE] Iteration 250: error = 45.6689987, gradient norm = 0.4899353 (50 iterations in 0.013s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 45.668999
[t-SNE] Iteration 300: error = 0.7951029, gradient norm = 0.0019236 (50 iterations in 0.013s)
[t-SNE] Iteration 350: error = 0.7059107, gradient norm = 0.0013775 (50 iterations in 0.013s)
[t-SNE] Iteration 400: error = 0.6228626, gradient norm = 0.0013502 (50 iterations in 0.013s)
[t-SNE] Iteration 450: error = 0.5837755, gradient norm = 0.0014110 (50 iterations in 0.014s)
[t-SNE] Iteration 500: error = 0.5518011, gradient norm = 0.0007246 (50 iterations in 0.013s)
[t-SNE] Iteration 550: error = 0.5223331, gradient norm = 0.0005993 (50 iterations in 0.013s)
[t-SNE] Iteration 600: error = 0.5027076, gradient norm = 0.0010943 (50 iterations in 0.014s)
[t-SNE] Iteration 650: error = 0.4934014, gradient norm = 0.0004160 (50 iterations in 0.013s)
[t-SNE] Iteration 700: error = 0.7985322, gradient norm = 0.0504735 (50 iterations in 0.012s)
[t-SNE] Iteration 750: error = 0.5475726, gradient norm = 0.0014651 (50 iterations in 0.015s)
[t-SNE] Iteration 800: error = 0.4993286, gradient norm = 0.0011076 (50 iterations in 0.013s)
[t-SNE] Iteration 850: error = 0.4750033, gradient norm = 0.0193796 (50 iterations in 0.012s)
[t-SNE] Iteration 900: error = 0.8395890, gradient norm = 0.0014186 (50 iterations in 0.013s)
[t-SNE] Iteration 950: error = 0.7547274, gradient norm = 0.0005122 (50 iterations in 0.015s)
[t-SNE] Iteration 1000: error = 0.7070119, gradient norm = 0.0005225 (50 iterations in 0.013s)
[t-SNE] KL divergence after 1000 iterations: 0.707012
[t-SNE] Computed conditional probabilities for sample 65 / 65
[t-SNE] Mean sigma: 0.673293
Beginning preprocessing + Leiden
2024-03-16 19:33:52.429659 MEMORY 19.45931776
Affmat transformed
2024-03-16 19:33:52.430590 MEMORY 19.45931776
sources, targets, weights extracted
2024-03-16 19:33:52.431004 MEMORY 19.45931776
About to launch parallel Leiden runs
2024-03-16 19:33:52.436047 MEMORY 19.45931776
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.6s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.8s finished
Parallel Leiden runs finished
2024-03-16 19:33:54.203292 MEMORY 19.45931776
Quality: 0.11847086469994736
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  60 out of  60 | elapsed:    0.0s finished
Got subclusters: Counter({0: 27, 1: 15, 2: 13, 3: 10})
On pattern 28
[t-SNE] Computing 59 nearest neighbors...
[t-SNE] Indexed 60 samples in 0.001s...
[t-SNE] Computed neighbors for 60 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 60 / 60
[t-SNE] Mean sigma: 0.631646
[t-SNE] Computed conditional probabilities in 0.002s
[t-SNE] Iteration 50: error = 45.5211143, gradient norm = 0.5657498 (50 iterations in 0.013s)
[t-SNE] Iteration 100: error = 43.9543114, gradient norm = 0.5698429 (50 iterations in 0.012s)
[t-SNE] Iteration 150: error = 47.9987640, gradient norm = 0.4655599 (50 iterations in 0.013s)
[t-SNE] Iteration 200: error = 45.6482353, gradient norm = 0.5640290 (50 iterations in 0.014s)
[t-SNE] Iteration 250: error = 45.3829384, gradient norm = 0.6085557 (50 iterations in 0.012s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 45.382938
[t-SNE] Iteration 300: error = 0.7964294, gradient norm = 0.0015542 (50 iterations in 0.012s)
[t-SNE] Iteration 350: error = 0.7169477, gradient norm = 0.0006558 (50 iterations in 0.013s)
[t-SNE] Iteration 400: error = 0.6770890, gradient norm = 0.0005658 (50 iterations in 0.014s)
[t-SNE] Iteration 450: error = 0.6495379, gradient norm = 0.0004474 (50 iterations in 0.012s)
[t-SNE] Iteration 500: error = 0.6319650, gradient norm = 0.0002817 (50 iterations in 0.012s)
[t-SNE] Iteration 550: error = 0.6193920, gradient norm = 0.0002540 (50 iterations in 0.013s)
[t-SNE] Iteration 600: error = 0.6102501, gradient norm = 0.0002334 (50 iterations in 0.014s)
[t-SNE] Iteration 650: error = 0.6033567, gradient norm = 0.0002291 (50 iterations in 0.013s)
[t-SNE] Iteration 700: error = 0.5929160, gradient norm = 0.0002222 (50 iterations in 0.013s)
[t-SNE] Iteration 750: error = 0.5809852, gradient norm = 0.0003351 (50 iterations in 0.012s)
[t-SNE] Iteration 800: error = 0.5688058, gradient norm = 0.0002905 (50 iterations in 0.013s)
[t-SNE] Iteration 850: error = 0.5516629, gradient norm = 0.0004440 (50 iterations in 0.014s)
[t-SNE] Iteration 900: error = 0.5392258, gradient norm = 0.0006513 (50 iterations in 0.012s)
[t-SNE] Iteration 950: error = 0.5286229, gradient norm = 0.0005315 (50 iterations in 0.013s)
[t-SNE] Iteration 1000: error = 0.8467054, gradient norm = 0.0652034 (50 iterations in 0.013s)
[t-SNE] KL divergence after 1000 iterations: 0.846705
[t-SNE] Computed conditional probabilities for sample 60 / 60
[t-SNE] Mean sigma: 0.631647
Beginning preprocessing + Leiden
2024-03-16 19:33:54.522132 MEMORY 19.45931776
Affmat transformed
2024-03-16 19:33:54.522986 MEMORY 19.45931776
sources, targets, weights extracted
2024-03-16 19:33:54.523343 MEMORY 19.45931776
About to launch parallel Leiden runs
2024-03-16 19:33:54.528365 MEMORY 19.45931776
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.6s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.8s finished
Parallel Leiden runs finished
2024-03-16 19:33:56.321434 MEMORY 19.45931776
Quality: 0.07779234415276617
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done  48 out of  48 | elapsed:    0.0s finished
Got subclusters: Counter({0: 24, 1: 13, 2: 12, 3: 11})
On pattern 29
[t-SNE] Computing 47 nearest neighbors...
[t-SNE] Indexed 48 samples in 0.000s...
[t-SNE] Computed neighbors for 48 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 48 / 48
[t-SNE] Mean sigma: 10.569252
[t-SNE] Computed conditional probabilities in 0.001s
[t-SNE] Iteration 50: error = 41.6744919, gradient norm = 0.6965248 (50 iterations in 0.042s)
[t-SNE] Iteration 100: error = 44.0792007, gradient norm = 0.3657742 (50 iterations in 0.013s)
[t-SNE] Iteration 150: error = 42.8276596, gradient norm = 0.5478745 (50 iterations in 0.012s)
[t-SNE] Iteration 200: error = 47.0387268, gradient norm = 0.2887748 (50 iterations in 0.012s)
[t-SNE] Iteration 250: error = 44.4928703, gradient norm = 0.7137045 (50 iterations in 0.011s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 44.492870
[t-SNE] Iteration 300: error = 0.6674117, gradient norm = 0.0010709 (50 iterations in 0.012s)
[t-SNE] Iteration 350: error = 0.6094685, gradient norm = 0.0002021 (50 iterations in 0.012s)
[t-SNE] Iteration 400: error = 0.6067283, gradient norm = 0.0000596 (50 iterations in 0.011s)
[t-SNE] Iteration 450: error = 0.6060902, gradient norm = 0.0000655 (50 iterations in 0.013s)
[t-SNE] Iteration 500: error = 0.6064269, gradient norm = 0.0000870 (50 iterations in 0.012s)
[t-SNE] Iteration 550: error = 0.6052885, gradient norm = 0.0000537 (50 iterations in 0.012s)
[t-SNE] Iteration 600: error = 0.6038558, gradient norm = 0.0000482 (50 iterations in 0.014s)
[t-SNE] Iteration 650: error = 0.6035502, gradient norm = 0.0000321 (50 iterations in 0.010s)
[t-SNE] Iteration 700: error = 0.6041700, gradient norm = 0.0000429 (50 iterations in 0.014s)
[t-SNE] Iteration 750: error = 0.6040568, gradient norm = 0.0000537 (50 iterations in 0.013s)
[t-SNE] Iteration 800: error = 0.6038746, gradient norm = 0.0000359 (50 iterations in 0.011s)
[t-SNE] Iteration 850: error = 0.6034281, gradient norm = 0.0000660 (50 iterations in 0.012s)
[t-SNE] Iteration 900: error = 0.6018665, gradient norm = 0.0001357 (50 iterations in 0.011s)
[t-SNE] Iteration 950: error = 0.5935648, gradient norm = 0.0007004 (50 iterations in 0.014s)
[t-SNE] Iteration 1000: error = 0.7509485, gradient norm = 0.0016355 (50 iterations in 0.014s)
[t-SNE] KL divergence after 1000 iterations: 0.750948
[t-SNE] Computed conditional probabilities for sample 48 / 48
[t-SNE] Mean sigma: 1125899906842624.000000
Beginning preprocessing + Leiden
2024-03-16 19:33:56.644497 MEMORY 19.45931776
Affmat transformed
2024-03-16 19:33:56.645268 MEMORY 19.45931776
sources, targets, weights extracted
2024-03-16 19:33:56.645603 MEMORY 19.45931776
About to launch parallel Leiden runs
2024-03-16 19:33:56.649829 MEMORY 19.45931776
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.6s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.8s finished
Parallel Leiden runs finished
2024-03-16 19:33:58.435032 MEMORY 19.45931776
Quality: 8.88178419700137e-16
Got subclusters: Counter({0: 48})
On metacluster 1
Metacluster size 99028 limited to 20000
Relevant tasks:  ('head', 'testis')
Relevant signs:  (-1, -1)
TfModiscoSeqletsToPatternsFactory: seed=1234
(Round 1) num seqlets: 20000
(Round 1) Computing coarse affmat
2024-03-16 19:34:02.040496 MEMORY 19.45931776
Beginning embedding computation
MEMORY 19.45931776
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 152 tasks      | elapsed:    1.9s
[Parallel(n_jobs=24)]: Done 402 tasks      | elapsed:    4.8s
[Parallel(n_jobs=24)]: Done 752 tasks      | elapsed:    8.7s
[Parallel(n_jobs=24)]: Done 1202 tasks      | elapsed:   13.6s
[Parallel(n_jobs=24)]: Done 1752 tasks      | elapsed:   19.7s
[Parallel(n_jobs=24)]: Done 2402 tasks      | elapsed:   26.8s
[Parallel(n_jobs=24)]: Done 3152 tasks      | elapsed:   35.0s
[Parallel(n_jobs=24)]: Done 4002 tasks      | elapsed:   44.3s
[Parallel(n_jobs=24)]: Done 4952 tasks      | elapsed:   54.7s
[Parallel(n_jobs=24)]: Done 6002 tasks      | elapsed:  1.1min
[Parallel(n_jobs=24)]: Done 7152 tasks      | elapsed:  1.3min
[Parallel(n_jobs=24)]: Done 8402 tasks      | elapsed:  1.5min
[Parallel(n_jobs=24)]: Done 9752 tasks      | elapsed:  1.8min
[Parallel(n_jobs=24)]: Done 11202 tasks      | elapsed:  2.0min
[Parallel(n_jobs=24)]: Done 12752 tasks      | elapsed:  2.3min
[Parallel(n_jobs=24)]: Done 14402 tasks      | elapsed:  2.6min
[Parallel(n_jobs=24)]: Done 16152 tasks      | elapsed:  2.9min
[Parallel(n_jobs=24)]: Done 18002 tasks      | elapsed:  3.3min
[Parallel(n_jobs=24)]: Done 19952 tasks      | elapsed:  3.6min
[Parallel(n_jobs=24)]: Done 20000 out of 20000 | elapsed:  3.6min finished
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 152 tasks      | elapsed:    1.9s
[Parallel(n_jobs=24)]: Done 402 tasks      | elapsed:    4.6s
[Parallel(n_jobs=24)]: Done 752 tasks      | elapsed:    8.4s
[Parallel(n_jobs=24)]: Done 1202 tasks      | elapsed:   13.3s
[Parallel(n_jobs=24)]: Done 1752 tasks      | elapsed:   19.4s
[Parallel(n_jobs=24)]: Done 2402 tasks      | elapsed:   26.4s
[Parallel(n_jobs=24)]: Done 3152 tasks      | elapsed:   34.5s
[Parallel(n_jobs=24)]: Done 4002 tasks      | elapsed:   43.7s
[Parallel(n_jobs=24)]: Done 4952 tasks      | elapsed:   54.0s
[Parallel(n_jobs=24)]: Done 6002 tasks      | elapsed:  1.1min
[Parallel(n_jobs=24)]: Done 7152 tasks      | elapsed:  1.3min
[Parallel(n_jobs=24)]: Done 8402 tasks      | elapsed:  1.5min
[Parallel(n_jobs=24)]: Done 9752 tasks      | elapsed:  1.8min
[Parallel(n_jobs=24)]: Done 11202 tasks      | elapsed:  2.0min
[Parallel(n_jobs=24)]: Done 12752 tasks      | elapsed:  2.3min
[Parallel(n_jobs=24)]: Done 14402 tasks      | elapsed:  2.6min
[Parallel(n_jobs=24)]: Done 16152 tasks      | elapsed:  2.9min
[Parallel(n_jobs=24)]: Done 18002 tasks      | elapsed:  3.3min
[Parallel(n_jobs=24)]: Done 19952 tasks      | elapsed:  3.6min
[Parallel(n_jobs=24)]: Done 20000 out of 20000 | elapsed:  3.6min finished
At the beginning of embedding call
2024-03-16 19:34:02.040763 MEMORY 19.45931776
before computing embeddings fwd
2024-03-16 19:34:02.049918 MEMORY 19.45931776
after computing embeddings fwd
2024-03-16 19:37:40.898301 MEMORY 19.459055616
after computing embeddings rev
2024-03-16 19:41:18.345975 MEMORY 20.15162368
before computing sparse embeddings fwd
2024-03-16 19:41:18.346158 MEMORY 20.15162368
Constructing csr matrix...
csr matrix made in 2.512205123901367 s
after computing sparse embeddings fwd
2024-03-16 19:41:22.014206 MEMORY 20.271742976
before computing sparse embeddings rev
2024-03-16 19:41:22.014318 MEMORY 20.271742976
Constructing csr matrix...
csr matrix made in 2.411282777786255 s
after computing sparse embeddings rev
2024-03-16 19:41:25.714455 MEMORY 20.392013824
Finished embedding computation in 446.67 s
MEMORY 19.76260608
Starting affinity matrix computations
MEMORY 19.761819648
Batching in slices of size 3355
  0%|          | 0/6 [00:00<?, ?it/s] 17%|â–ˆâ–‹        | 1/6 [00:08<00:43,  8.80s/it] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 2/6 [00:17<00:35,  8.84s/it] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 3/6 [00:26<00:26,  8.84s/it] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 4/6 [00:35<00:17,  8.85s/it] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 5/6 [00:44<00:08,  8.86s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:52<00:00,  8.80s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:52<00:00,  8.82s/it]
Finished affinity matrix computations in 53.05 s
MEMORY 19.761819648
(Round 1) Computed coarse affmat
2024-03-16 19:42:23.810761 MEMORY 19.521286144
(Round 1) Computing affinity matrix on nearest neighbors
2024-03-16 19:42:23.810923 MEMORY 19.521286144
Launching nearest neighbors affmat calculation job
MEMORY 19.521286144
Parallel runs completed
MEMORY 19.580289024
Job completed in: 70.27 s
MEMORY 19.577913344
Launching nearest neighbors affmat calculation job
MEMORY 19.575791616
Parallel runs completed
MEMORY 19.715862528
Job completed in: 71.46 s
MEMORY 19.712012288
(Round 1) Computed affinity matrix on nearest neighbors in 148.29 s
2024-03-16 19:44:52.113639 MEMORY 19.712012288
Filtered down to 18434 of 20000
(Round 1) Retained 18434 rows out of 20000 after filtering
2024-03-16 19:45:02.681643 MEMORY 19.712012288
(Round 1) Computing density adapted affmat
2024-03-16 19:45:08.286037 MEMORY 19.712012288
Symmetrizing nearest neighbors
Computing betas for density adaptation
Computing normalizing denominators
(Round 1) Computing clustering
2024-03-16 19:47:54.555985 MEMORY 19.579052032
Beginning preprocessing + Leiden
2024-03-16 19:47:54.581734 MEMORY 19.579052032
Affmat transformed
2024-03-16 19:47:54.581890 MEMORY 19.579052032
sources, targets, weights extracted
2024-03-16 19:47:55.273695 MEMORY 19.631804416
About to launch parallel Leiden runs
2024-03-16 19:47:55.454309 MEMORY 19.579052032
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:  1.7min
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:  7.4min finished
Parallel Leiden runs finished
2024-03-16 19:55:19.933162 MEMORY 19.578662912
Quality: 0.4342050273156456
Quality: 0.43429649894897177
Quality: 0.43577785650110945
Got 5 clusters after round 1
Counts:
{0: 6697, 3: 3370, 2: 3458, 1: 3806, 4: 1103}
2024-03-16 19:55:19.985947 MEMORY 19.578662912
(Round 1) Aggregating seqlets in each cluster
2024-03-16 19:55:19.986047 MEMORY 19.578662912
Aggregating for cluster 0 with 6697 seqlets
2024-03-16 19:55:19.998501 MEMORY 19.578662912
Skipped 32 due to duplicates
Trimming eliminated 0 seqlets out of 6665
Aggregating for cluster 1 with 3806 seqlets
2024-03-16 19:55:37.990536 MEMORY 19.57873664
Skipped 17 due to duplicates
Trimming eliminated 0 seqlets out of 3789
WARNING: Probabilities don't sum to 1 in all the rows; this can be caused by zero-padding. Will renormalize. PPM:
[[0.29136975 0.19556611 0.20876221 0.30430193]
 [0.29849565 0.20533122 0.21060966 0.28556347]
 [0.3027184  0.19503827 0.20190024 0.3003431 ]
 [0.31749802 0.19213513 0.19266297 0.29770388]
 [0.30720507 0.18685669 0.20321985 0.3027184 ]
 [0.29136975 0.20401161 0.21087358 0.29374505]
 [0.31037213 0.185801   0.19239905 0.31142782]
 [0.28609132 0.19714964 0.21219319 0.30456585]
 [0.2750066  0.21192927 0.20955397 0.30351016]
 [0.27131169 0.19952494 0.20665083 0.32251254]
 [0.27183954 0.21245711 0.20480338 0.31089997]
 [0.29453682 0.21456849 0.18685669 0.304038  ]
 [0.34520982 0.19846925 0.16178411 0.29453682]
 [0.36737926 0.21272103 0.1567696  0.26313011]
 [0.34758511 0.21799947 0.20374769 0.23066772]
 [0.36157297 0.23568224 0.22011085 0.18263394]
 [0.64740037 0.13961467 0.10345738 0.10952758]
 [0.67537609 0.1652151  0.08392716 0.07548166]
 [0.22063869 0.11348641 0.05146477 0.61441013]
 [0.00422275 0.00659805 0.0023753  0.98680391]
 [0.08339931 0.10899974 0.05964634 0.74795461]
 [0.60622856 0.09316442 0.1459488  0.15465822]
 [0.53892848 0.06017419 0.11902877 0.28186857]
 [0.26260227 0.12404328 0.27104777 0.34204276]
 [0.28239641 0.16442333 0.22354183 0.32937451]
 [0.28318818 0.20058063 0.1942465  0.32172077]
 [0.2665611  0.23462655 0.18474532 0.31380311]
 [0.30958036 0.21720771 0.19952494 0.27342307]
 [0.31037213 0.20770652 0.17234099 0.30931644]
 [0.29110583 0.20849828 0.20190024 0.29823172]
 [0.28424386 0.21272103 0.19134336 0.31142782]
 [0.3027184  0.20559514 0.19107944 0.3003431 ]
 [0.29110583 0.21615202 0.19345474 0.29902349]
 [0.29532858 0.20638691 0.2074426  0.29057799]
 [0.29321721 0.20348377 0.19292689 0.31010821]
 [0.287147   0.20691475 0.22037477 0.28529955]
 [0.29057799 0.20665083 0.21008182 0.29242544]
 [0.30456585 0.20770652 0.19714964 0.29031407]
 [0.31749802 0.20084455 0.19028767 0.29110583]]
Probability sums:
[1.         1.         1.         1.         1.         1.
 1.         1.         1.         1.         1.         1.
 1.         1.         1.         1.         1.         1.
 1.         1.         1.         1.         1.         0.99973608
 0.99973608 0.99973608 0.99973608 0.99973608 0.99973608 0.99973608
 0.99973608 0.99973608 0.99973608 0.99973608 0.99973608 0.99973608
 0.99973608 0.99973608 0.99973608]
Aggregating for cluster 2 with 3458 seqlets
2024-03-16 19:55:46.263726 MEMORY 19.57873664
Removed 3 duplicate seqlets
Skipped 14 due to duplicates
Trimming eliminated 0 seqlets out of 3441
Aggregating for cluster 3 with 3370 seqlets
2024-03-16 19:55:54.963671 MEMORY 19.57873664
Removed 2 duplicate seqlets
Skipped 11 due to duplicates
Trimming eliminated 0 seqlets out of 3357
Aggregating for cluster 4 with 1103 seqlets
2024-03-16 19:56:02.628081 MEMORY 19.57873664
Skipped 8 due to duplicates
Trimming eliminated 0 seqlets out of 1095
(Round 2) num seqlets: 18346
(Round 2) Computing coarse affmat
2024-03-16 19:56:08.578545 MEMORY 19.57873664
Beginning embedding computation
MEMORY 19.57873664
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 368 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done 1368 tasks      | elapsed:    2.2s
[Parallel(n_jobs=24)]: Done 2768 tasks      | elapsed:    4.3s
[Parallel(n_jobs=24)]: Done 4568 tasks      | elapsed:    7.0s
[Parallel(n_jobs=24)]: Done 6768 tasks      | elapsed:   10.1s
[Parallel(n_jobs=24)]: Done 9368 tasks      | elapsed:   13.7s
[Parallel(n_jobs=24)]: Done 12368 tasks      | elapsed:   17.9s
[Parallel(n_jobs=24)]: Done 15768 tasks      | elapsed:   22.6s
[Parallel(n_jobs=24)]: Done 18346 out of 18346 | elapsed:   26.1s finished
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 368 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done 1368 tasks      | elapsed:    2.1s
[Parallel(n_jobs=24)]: Done 2768 tasks      | elapsed:    3.9s
[Parallel(n_jobs=24)]: Done 4568 tasks      | elapsed:    6.3s
[Parallel(n_jobs=24)]: Done 6768 tasks      | elapsed:    9.2s
[Parallel(n_jobs=24)]: Done 9368 tasks      | elapsed:   12.7s
[Parallel(n_jobs=24)]: Done 12368 tasks      | elapsed:   16.7s
[Parallel(n_jobs=24)]: Done 15768 tasks      | elapsed:   21.2s
[Parallel(n_jobs=24)]: Done 18346 out of 18346 | elapsed:   24.7s finished
At the beginning of embedding call
2024-03-16 19:56:08.578797 MEMORY 19.57873664
before computing embeddings fwd
2024-03-16 19:56:08.587905 MEMORY 19.57873664
after computing embeddings fwd
2024-03-16 19:56:34.657283 MEMORY 20.010467328
after computing embeddings rev
2024-03-16 19:56:59.348919 MEMORY 20.758409216
before computing sparse embeddings fwd
2024-03-16 19:56:59.349016 MEMORY 20.758409216
Constructing csr matrix...
csr matrix made in 2.1501193046569824 s
after computing sparse embeddings fwd
2024-03-16 19:57:02.228170 MEMORY 20.868468736
before computing sparse embeddings rev
2024-03-16 19:57:02.228249 MEMORY 20.868468736
Constructing csr matrix...
csr matrix made in 2.0873942375183105 s
after computing sparse embeddings rev
2024-03-16 19:57:04.955309 MEMORY 20.97852416
Finished embedding computation in 60.51 s
MEMORY 20.367204352
Starting affinity matrix computations
MEMORY 20.366680064
Batching in slices of size 3657
  0%|          | 0/6 [00:00<?, ?it/s] 17%|â–ˆâ–‹        | 1/6 [00:10<00:50, 10.19s/it] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 2/6 [00:20<00:40, 10.20s/it] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 3/6 [00:30<00:31, 10.38s/it] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 4/6 [00:40<00:20, 10.17s/it] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 5/6 [00:51<00:10, 10.27s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:53<00:00,  7.41s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:53<00:00,  8.86s/it]
Finished affinity matrix computations in 53.22 s
MEMORY 20.366737408
(Round 2) Computed coarse affmat
2024-03-16 19:58:04.607066 MEMORY 20.146425856
(Round 2) Computing affinity matrix on nearest neighbors
2024-03-16 19:58:04.607214 MEMORY 20.146425856
Launching nearest neighbors affmat calculation job
MEMORY 20.146425856
Parallel runs completed
MEMORY 20.155162624
Job completed in: 33.24 s
MEMORY 20.152967168
Launching nearest neighbors affmat calculation job
MEMORY 20.146429952
Parallel runs completed
MEMORY 20.179193856
Job completed in: 32.99 s
MEMORY 20.179181568
(Round 2) Computed affinity matrix on nearest neighbors in 72.27 s
2024-03-16 19:59:16.899216 MEMORY 20.176838656
Not applying filtering for rounds above first round
2024-03-16 19:59:16.901911 MEMORY 20.176838656
(Round 2) Computing density adapted affmat
2024-03-16 19:59:22.345642 MEMORY 20.183973888
Symmetrizing nearest neighbors
Computing betas for density adaptation
Computing normalizing denominators
(Round 2) Computing clustering
2024-03-16 20:02:00.299961 MEMORY 20.393476096
Beginning preprocessing + Leiden
2024-03-16 20:02:00.325803 MEMORY 20.393476096
Affmat transformed
2024-03-16 20:02:00.325952 MEMORY 20.393476096
sources, targets, weights extracted
2024-03-16 20:02:01.064811 MEMORY 20.60720128
About to launch parallel Leiden runs
2024-03-16 20:02:01.221865 MEMORY 20.393488384
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:  1.4min
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:  4.9min finished
Parallel Leiden runs finished
2024-03-16 20:06:53.347235 MEMORY 20.39322624
Quality: 0.5546097949426496
Quality: 0.5546119199286272
Got 6 clusters after round 2
Counts:
{4: 2322, 1: 3752, 3: 3212, 0: 4474, 2: 3607, 5: 979}
2024-03-16 20:06:53.395745 MEMORY 20.232941568
(Round 2) Aggregating seqlets in each cluster
2024-03-16 20:06:53.395845 MEMORY 20.232941568
Aggregating for cluster 0 with 4474 seqlets
2024-03-16 20:06:53.402922 MEMORY 20.232941568
Skipped 5 due to duplicates
Trimming eliminated 0 seqlets out of 4469
Aggregating for cluster 1 with 3752 seqlets
2024-03-16 20:07:01.843099 MEMORY 20.233003008
Skipped 6 due to duplicates
Trimming eliminated 0 seqlets out of 3746
WARNING: Probabilities don't sum to 1 in all the rows; this can be caused by zero-padding. Will renormalize. PPM:
[[2.69353978e-01 2.05819541e-01 2.13828083e-01 3.10998398e-01]
 [2.98451682e-01 2.09556861e-01 1.87666845e-01 3.04324613e-01]
 [3.30752803e-01 2.03683930e-01 1.75387080e-01 2.90176188e-01]
 [3.63854778e-01 1.87666845e-01 1.71916711e-01 2.76561666e-01]
 [3.38227443e-01 2.22370529e-01 1.94073679e-01 2.45328350e-01]
 [3.36625734e-01 2.56006407e-01 2.20768820e-01 1.86599039e-01]
 [5.65136145e-01 1.72450614e-01 1.29471436e-01 1.32941805e-01]
 [7.06086492e-01 1.44153764e-01 6.96743193e-02 8.00854245e-02]
 [4.20715430e-01 1.70581954e-01 7.79498131e-02 3.30752803e-01]
 [4.27122264e-03 4.27122264e-03 5.33902830e-04 9.90923652e-01]
 [2.18900160e-02 4.83182061e-02 1.36145222e-02 9.16177256e-01]
 [4.64495462e-01 9.12973839e-02 1.72717565e-01 2.71489589e-01]
 [6.47891084e-01 5.63267485e-02 1.13187400e-01 1.82594768e-01]
 [3.07528030e-01 1.02242392e-01 2.19967966e-01 3.69994661e-01]
 [2.52802990e-01 1.74586225e-01 2.62146289e-01 3.10197544e-01]
 [2.98718633e-01 1.89001602e-01 1.88734650e-01 3.23278163e-01]
 [2.80032034e-01 2.24239188e-01 1.88467699e-01 3.06994127e-01]
 [3.13934864e-01 2.06086492e-01 1.99412707e-01 2.80298986e-01]
 [3.19006941e-01 2.03950881e-01 1.76454885e-01 3.00320342e-01]
 [2.96583022e-01 2.09022958e-01 2.02616124e-01 2.91510945e-01]]
Probability sums:
[1.         1.         1.         1.         1.         1.
 1.         1.         1.         1.         1.         1.
 1.         0.99973305 0.99973305 0.99973305 0.99973305 0.99973305
 0.99973305 0.99973305]
Aggregating for cluster 2 with 3607 seqlets
2024-03-16 20:07:10.125268 MEMORY 20.233003008
Skipped 6 due to duplicates
Trimming eliminated 0 seqlets out of 3601
Aggregating for cluster 3 with 3212 seqlets
2024-03-16 20:07:16.750517 MEMORY 20.233003008
Removed 1 duplicate seqlets
Skipped 11 due to duplicates
Trimming eliminated 0 seqlets out of 3200
Aggregating for cluster 4 with 2322 seqlets
2024-03-16 20:07:22.242935 MEMORY 20.233003008
Skipped 6 due to duplicates
Trimming eliminated 0 seqlets out of 2316
Aggregating for cluster 5 with 979 seqlets
2024-03-16 20:07:26.475731 MEMORY 20.233003008
Skipped 1 due to duplicates
Trimming eliminated 0 seqlets out of 978
Got 6 clusters
Splitting into subclusters...
2024-03-16 20:07:28.216966 MEMORY 20.233003008
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.4s
[Parallel(n_jobs=24)]: Done 3930 tasks      | elapsed:    2.7s
[Parallel(n_jobs=24)]: Done 4469 out of 4469 | elapsed:    3.1s finished
Inspecting pattern 0 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 4469
[t-SNE] Computed conditional probabilities for sample 2000 / 4469
[t-SNE] Computed conditional probabilities for sample 3000 / 4469
[t-SNE] Computed conditional probabilities for sample 4000 / 4469
[t-SNE] Computed conditional probabilities for sample 4469 / 4469
[t-SNE] Mean sigma: 0.265691
Beginning preprocessing + Leiden
2024-03-16 20:07:35.820508 MEMORY 20.282400768
Affmat transformed
2024-03-16 20:07:35.872608 MEMORY 20.290469888
sources, targets, weights extracted
2024-03-16 20:07:35.914649 MEMORY 20.290490368
About to launch parallel Leiden runs
2024-03-16 20:07:35.932220 MEMORY 20.290490368
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:   16.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:  1.1min finished
Parallel Leiden runs finished
2024-03-16 20:08:39.104556 MEMORY 20.290490368
Quality: 0.5023617315168869
Quality: 0.5037448781027231
Quality: 0.5059972471963733
Got subclusters: Counter({0: 988, 1: 942, 2: 825, 3: 557, 4: 534, 5: 295, 6: 186, 7: 97, 8: 42, 9: 3})
On merging iteration 1
Numbers for each pattern pre-subsample: [988, 942, 825, 557, 534, 295, 186, 97, 42, 3]
Numbers after subsampling: [300, 300, 300, 300, 300, 295, 186, 97, 42, 3]
Computing sims for pattern 0
Computed sims for pattern 0 in 3.401076316833496 s
Computing sims for pattern 1
Computed sims for pattern 1 in 3.416656732559204 s
Computing sims for pattern 2
Computed sims for pattern 2 in 3.494558334350586 s
Computing sims for pattern 3
Computed sims for pattern 3 in 6.005544185638428 s
Computing sims for pattern 4
Computed sims for pattern 4 in 3.514777660369873 s
Computing sims for pattern 5
Computed sims for pattern 5 in 3.3923227787017822 s
Computing sims for pattern 6
Computed sims for pattern 6 in 2.398695945739746 s
Computing sims for pattern 7
Computed sims for pattern 7 in 1.3480274677276611 s
Computing sims for pattern 8
Computed sims for pattern 8 in 0.7720487117767334 s
Computing sims for pattern 9
Computed sims for pattern 9 in 0.3204944133758545 s
Cluster sizes
[988 942 825 557 534 295 186  97  42   3]
Cross-contamination matrix:
[[1.   0.55 0.7  0.63 0.75 0.51 0.54 0.34 0.72 0.64]
 [0.69 1.   0.6  0.6  0.68 0.49 0.56 0.54 0.75 0.64]
 [0.81 0.57 1.   0.68 0.75 0.55 0.56 0.18 0.74 0.7 ]
 [0.94 0.75 0.88 1.   0.93 0.63 0.69 0.48 0.92 0.81]
 [0.86 0.65 0.75 0.73 1.   0.61 0.63 0.45 0.78 0.64]
 [0.94 0.76 0.86 0.77 0.94 1.   0.76 0.61 0.78 0.74]
 [0.86 0.73 0.76 0.71 0.84 0.65 1.   0.49 0.74 0.5 ]
 [0.38 0.49 0.13 0.31 0.42 0.29 0.28 1.   0.23 0.32]
 [0.34 0.25 0.27 0.22 0.29 0.13 0.14 0.03 1.   0.1 ]
 [0.   0.   0.01 0.   0.   0.   0.   0.   0.   1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.85 0.89 0.94 0.95 0.83 0.85 0.65 0.83 0.74]
 [0.85 1.   0.79 0.85 0.84 0.79 0.81 0.68 0.77 0.65]
 [0.89 0.79 1.   0.94 0.9  0.81 0.82 0.58 0.83 0.7 ]
 [0.94 0.85 0.94 1.   0.94 0.81 0.84 0.6  0.85 0.76]
 [0.95 0.84 0.9  0.94 1.   0.91 0.88 0.65 0.84 0.72]
 [0.83 0.79 0.81 0.81 0.91 1.   0.83 0.71 0.73 0.59]
 [0.85 0.81 0.82 0.84 0.88 0.83 1.   0.58 0.74 0.57]
 [0.65 0.68 0.58 0.6  0.65 0.71 0.58 1.   0.53 0.49]
 [0.83 0.77 0.83 0.85 0.84 0.73 0.74 0.53 1.   0.65]
 [0.74 0.65 0.7  0.76 0.72 0.59 0.57 0.49 0.65 1.  ]]
Collapsing 0 & 4 with crosscontam 0.7492735619753086 and sim 0.9469665337783842
Collapsing 0 & 3 with crosscontam 0.627236904691358 and sim 0.9421415587024377
Collapsing 2 & 3 with crosscontam 0.6817568977777779 and sim 0.9377941062661239
Collapsing 3 & 4 with crosscontam 0.7317497338271606 and sim 0.9377216852500155
Collapsing 4 & 5 with crosscontam 0.6059734543628374 and sim 0.9142703281663723
Collapsing 2 & 4 with crosscontam 0.7506415560493827 and sim 0.9011436772130897
Collapsing 0 & 2 with crosscontam 0.7024599244444445 and sim 0.890535260787441
Collapsing 4 & 6 with crosscontam 0.6319248506571085 and sim 0.8790598190387626
Collapsing 0 & 1 with crosscontam 0.5497402291358024 and sim 0.8504895517893465
Trimming eliminated 0 seqlets out of 1522
Trimming eliminated 0 seqlets out of 2079
Trimming eliminated 0 seqlets out of 2904
Trimming eliminated 0 seqlets out of 3199
Trimming eliminated 0 seqlets out of 3385
Trimming eliminated 0 seqlets out of 4327
Unmerged patterns remapping: OrderedDict([(7, 1), (8, 2), (9, 3)])
Time spent on merging iteration: 24.684045791625977
On merging iteration 2
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 3345 tasks      | elapsed:    1.9s
[Parallel(n_jobs=24)]: Done 3746 out of 3746 | elapsed:    2.1s finished
Numbers for each pattern pre-subsample: [4327, 97, 42, 3]
Numbers after subsampling: [300, 97, 42, 3]
Computing sims for pattern 0
Computed sims for pattern 0 in 0.941504716873169 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.17889738082885742 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.11437010765075684 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.05634045600891113 s
Cluster sizes
[4327   97   42    3]
Cross-contamination matrix:
[[1.   0.61 1.   0.91]
 [0.37 1.   0.23 0.32]
 [0.28 0.03 1.   0.1 ]
 [0.01 0.   0.   1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.65 0.86 0.74]
 [0.65 1.   0.53 0.49]
 [0.86 0.53 1.   0.65]
 [0.74 0.49 0.65 1.  ]]
Inspecting pattern 1 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 3746
[t-SNE] Computed conditional probabilities for sample 2000 / 3746
[t-SNE] Computed conditional probabilities for sample 3000 / 3746
[t-SNE] Computed conditional probabilities for sample 3746 / 3746
[t-SNE] Mean sigma: 0.294476
Beginning preprocessing + Leiden
2024-03-16 20:09:39.862766 MEMORY 20.290732032
Affmat transformed
2024-03-16 20:09:39.906284 MEMORY 20.290732032
sources, targets, weights extracted
2024-03-16 20:09:39.936859 MEMORY 20.290732032
About to launch parallel Leiden runs
2024-03-16 20:09:39.952162 MEMORY 20.29072384
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:   14.6s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   55.1s finished
Parallel Leiden runs finished
2024-03-16 20:10:35.030093 MEMORY 20.29072384
Quality: 0.47212707624054373
Quality: 0.4724780569496252
Quality: 0.472845404958688
Quality: 0.47597365394004987
Got subclusters: Counter({0: 685, 1: 664, 2: 655, 3: 534, 4: 488, 5: 280, 6: 232, 7: 107, 8: 101})
On merging iteration 1
Numbers for each pattern pre-subsample: [685, 664, 655, 534, 488, 280, 232, 107, 101]
Numbers after subsampling: [300, 300, 300, 300, 300, 280, 232, 107, 101]
Computing sims for pattern 0
Computed sims for pattern 0 in 3.13572096824646 s
Computing sims for pattern 1
Computed sims for pattern 1 in 3.162816047668457 s
Computing sims for pattern 2
Computed sims for pattern 2 in 3.2233474254608154 s
Computing sims for pattern 3
Computed sims for pattern 3 in 3.2267906665802 s
Computing sims for pattern 4
Computed sims for pattern 4 in 5.708752632141113 s
Computing sims for pattern 5
Computed sims for pattern 5 in 2.960414409637451 s
Computing sims for pattern 6
Computed sims for pattern 6 in 2.9577901363372803 s
Computing sims for pattern 7
Computed sims for pattern 7 in 1.457639455795288 s
Computing sims for pattern 8
Computed sims for pattern 8 in 1.3374388217926025 s
Cluster sizes
[685 664 655 534 488 280 232 107 101]
Cross-contamination matrix:
[[1.   0.73 0.83 0.73 0.77 0.69 0.89 0.68 0.67]
 [0.55 1.   0.78 0.73 0.63 0.51 0.74 0.67 0.63]
 [0.55 0.71 1.   0.62 0.57 0.53 0.69 0.61 0.58]
 [0.58 0.77 0.74 1.   0.67 0.56 0.61 0.68 0.64]
 [0.73 0.78 0.8  0.78 1.   0.49 0.66 0.67 0.69]
 [0.64 0.63 0.74 0.66 0.49 1.   0.79 0.6  0.71]
 [0.58 0.65 0.68 0.48 0.42 0.56 1.   0.49 0.52]
 [0.46 0.6  0.61 0.57 0.47 0.43 0.53 1.   0.53]
 [0.34 0.46 0.47 0.43 0.37 0.4  0.44 0.42 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.78 0.83 0.81 0.87 0.85 0.85 0.73 0.75]
 [0.78 1.   0.86 0.85 0.81 0.78 0.81 0.78 0.74]
 [0.83 0.86 1.   0.83 0.82 0.84 0.81 0.79 0.78]
 [0.81 0.85 0.83 1.   0.79 0.84 0.74 0.79 0.74]
 [0.87 0.81 0.82 0.79 1.   0.74 0.72 0.71 0.74]
 [0.85 0.78 0.84 0.84 0.74 1.   0.82 0.73 0.78]
 [0.85 0.81 0.81 0.74 0.72 0.82 1.   0.7  0.71]
 [0.73 0.78 0.79 0.79 0.71 0.73 0.7  1.   0.66]
 [0.75 0.74 0.78 0.74 0.74 0.78 0.71 0.66 1.  ]]
Collapsing 0 & 4 with crosscontam 0.7344642479012347 and sim 0.8651616129709238
Collapsing 1 & 2 with crosscontam 0.7135162266666666 and sim 0.8615139962675861
Skipped 1 due to duplicates
Trimming eliminated 0 seqlets out of 1172
Trimming eliminated 0 seqlets out of 1319
WARNING: Probabilities don't sum to 1 in all the rows; this can be caused by zero-padding. Will renormalize. PPM:
[[0.26307809 0.22668688 0.20090978 0.3085671 ]
 [0.25928734 0.19636088 0.22592873 0.3176649 ]
 [0.27824109 0.18574678 0.21683093 0.31842305]
 [0.30932525 0.18726308 0.20318423 0.29946929]
 [0.33813495 0.19332828 0.16982563 0.29795299]
 [0.35178165 0.18574678 0.18574678 0.27596664]
 [0.3009856  0.21228203 0.18953753 0.29719484]
 [0.27899924 0.26080364 0.21758908 0.24260804]
 [0.51402578 0.19636088 0.09325246 0.19636088]
 [0.67399545 0.17589083 0.06595906 0.08415466]
 [0.60500379 0.06671721 0.05307051 0.27520849]
 [0.0045489  0.00833965 0.0060652  0.98104625]
 [0.03942381 0.09780136 0.03411676 0.82865807]
 [0.75890826 0.04321456 0.11978772 0.07808946]
 [0.85746778 0.02956785 0.05610311 0.05686126]
 [0.47839272 0.10083397 0.14101592 0.27975739]
 [0.24715694 0.13495072 0.23123578 0.38665656]
 [0.23654284 0.18877938 0.21910538 0.3555724 ]
 [0.27672479 0.21379833 0.21531463 0.29416224]
 [0.3449583  0.21228203 0.18877938 0.25398029]
 [0.3661865  0.17285823 0.16755118 0.29340409]
 [0.328279   0.20242608 0.19939348 0.26990144]
 [0.28430629 0.19711903 0.19863533 0.31993935]
 [0.28127369 0.19029568 0.22365428 0.30477635]]
Probability sums:
[0.99924185 0.99924185 0.99924185 0.99924185 0.99924185 0.99924185
 1.         1.         1.         1.         1.         1.
 1.         1.         1.         1.         1.         1.
 1.         1.         1.         1.         1.         1.        ]
Unmerged patterns remapping: OrderedDict([(3, 2), (5, 3), (6, 4), (7, 5), (8, 6)])
Time spent on merging iteration: 5.295775651931763
On merging iteration 2
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 3330 tasks      | elapsed:    2.0s
[Parallel(n_jobs=24)]: Done 3601 out of 3601 | elapsed:    2.1s finished
Numbers for each pattern pre-subsample: [1319, 1172, 534, 280, 232, 107, 101]
Numbers after subsampling: [300, 300, 300, 280, 232, 107, 101]
Computing sims for pattern 0
Computed sims for pattern 0 in 2.4055047035217285 s
Computing sims for pattern 1
Computed sims for pattern 1 in 2.4253203868865967 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.8896265029907227 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.8195648193359375 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.7996671199798584 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.36942052841186523 s
Computing sims for pattern 6
Computed sims for pattern 6 in 0.34552741050720215 s
Cluster sizes
[1319 1172  534  280  232  107  101]
Cross-contamination matrix:
[[1.   0.73 0.84 0.67 0.88 0.8  0.77]
 [0.82 1.   0.79 0.71 0.92 0.82 0.82]
 [0.7  0.53 1.   0.56 0.61 0.68 0.64]
 [0.62 0.6  0.66 1.   0.79 0.6  0.71]
 [0.62 0.53 0.48 0.56 1.   0.49 0.52]
 [0.56 0.46 0.57 0.43 0.53 1.   0.53]
 [0.43 0.37 0.43 0.4  0.44 0.42 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.84 0.85 0.81 0.83 0.8  0.77]
 [0.84 1.   0.79 0.83 0.83 0.79 0.75]
 [0.85 0.79 1.   0.84 0.74 0.79 0.74]
 [0.81 0.83 0.84 1.   0.82 0.73 0.78]
 [0.83 0.83 0.74 0.82 1.   0.7  0.71]
 [0.8  0.79 0.79 0.73 0.7  1.   0.66]
 [0.77 0.75 0.74 0.78 0.71 0.66 1.  ]]
Inspecting pattern 2 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 3601
[t-SNE] Computed conditional probabilities for sample 2000 / 3601
[t-SNE] Computed conditional probabilities for sample 3000 / 3601
[t-SNE] Computed conditional probabilities for sample 3601 / 3601
[t-SNE] Mean sigma: 0.300265
Beginning preprocessing + Leiden
2024-03-16 20:11:20.983591 MEMORY 20.29072384
Affmat transformed
2024-03-16 20:11:21.025021 MEMORY 20.29072384
sources, targets, weights extracted
2024-03-16 20:11:21.054021 MEMORY 20.29072384
About to launch parallel Leiden runs
2024-03-16 20:11:21.068558 MEMORY 20.29072384
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    9.8s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   34.5s finished
Parallel Leiden runs finished
2024-03-16 20:11:55.581854 MEMORY 20.29072384
Quality: 0.5505835289605131
Quality: 0.5505931664009995
Quality: 0.5506314895691428
Quality: 0.5508835878469335
Quality: 0.5509987473471286
Quality: 0.5511510282552978
Got subclusters: Counter({0: 718, 1: 698, 2: 649, 3: 627, 4: 542, 5: 367})
On merging iteration 1
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 2955 tasks      | elapsed:    1.7s
[Parallel(n_jobs=24)]: Done 3200 out of 3200 | elapsed:    1.7s finished
Numbers for each pattern pre-subsample: [718, 698, 649, 627, 542, 367]
Numbers after subsampling: [300, 300, 300, 300, 300, 300]
Computing sims for pattern 0
Computed sims for pattern 0 in 2.052569627761841 s
Computing sims for pattern 1
Computed sims for pattern 1 in 2.1386454105377197 s
Computing sims for pattern 2
Computed sims for pattern 2 in 2.178318500518799 s
Computing sims for pattern 3
Computed sims for pattern 3 in 2.2042458057403564 s
Computing sims for pattern 4
Computed sims for pattern 4 in 2.136186361312866 s
Computing sims for pattern 5
Computed sims for pattern 5 in 2.1446235179901123 s
Cluster sizes
[718 698 649 627 542 367]
Cross-contamination matrix:
[[1.   0.57 0.37 0.75 0.43 0.6 ]
 [0.65 1.   0.63 0.66 0.65 0.51]
 [0.33 0.49 1.   0.44 0.66 0.7 ]
 [0.62 0.48 0.51 1.   0.56 0.36]
 [0.38 0.5  0.55 0.6  1.   0.54]
 [0.64 0.47 0.78 0.51 0.64 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.69 0.47 0.8  0.54 0.72]
 [0.69 1.   0.63 0.64 0.61 0.5 ]
 [0.47 0.63 1.   0.61 0.7  0.81]
 [0.8  0.64 0.61 1.   0.66 0.56]
 [0.54 0.61 0.7  0.66 1.   0.71]
 [0.72 0.5  0.81 0.56 0.71 1.  ]]
Inspecting pattern 3 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 3200
[t-SNE] Computed conditional probabilities for sample 2000 / 3200
[t-SNE] Computed conditional probabilities for sample 3000 / 3200
[t-SNE] Computed conditional probabilities for sample 3200 / 3200
[t-SNE] Mean sigma: 0.268947
Beginning preprocessing + Leiden
2024-03-16 20:12:14.298873 MEMORY 20.29072384
Affmat transformed
2024-03-16 20:12:14.335985 MEMORY 20.29072384
sources, targets, weights extracted
2024-03-16 20:12:14.366098 MEMORY 20.29072384
About to launch parallel Leiden runs
2024-03-16 20:12:14.380649 MEMORY 20.29072384
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:   12.5s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   40.7s finished
Parallel Leiden runs finished
2024-03-16 20:12:55.033666 MEMORY 20.29072384
Quality: 0.45823946226999646
Quality: 0.45932718338309914
Quality: 0.4599891759612403
Quality: 0.4601415394701285
Got subclusters: Counter({0: 799, 1: 670, 2: 598, 3: 417, 4: 265, 5: 257, 6: 194})
On merging iteration 1
Numbers for each pattern pre-subsample: [799, 670, 598, 417, 265, 257, 194]
Numbers after subsampling: [300, 300, 300, 300, 265, 257, 194]
Computing sims for pattern 0
Computed sims for pattern 0 in 2.4703917503356934 s
Computing sims for pattern 1
Computed sims for pattern 1 in 2.5784988403320312 s
Computing sims for pattern 2
Computed sims for pattern 2 in 2.5733835697174072 s
Computing sims for pattern 3
Computed sims for pattern 3 in 2.7374494075775146 s
Computing sims for pattern 4
Computed sims for pattern 4 in 2.129401445388794 s
Computing sims for pattern 5
Computed sims for pattern 5 in 2.033205509185791 s
Computing sims for pattern 6
Computed sims for pattern 6 in 1.8989996910095215 s
Cluster sizes
[799 670 598 417 265 257 194]
Cross-contamination matrix:
[[1.   0.57 0.46 0.4  0.58 0.6  0.52]
 [0.82 1.   0.6  0.53 0.64 0.76 0.68]
 [0.94 0.82 1.   0.76 0.72 0.77 0.8 ]
 [0.92 0.82 0.82 1.   0.79 0.9  0.73]
 [0.95 0.71 0.62 0.62 1.   0.7  0.68]
 [0.94 0.86 0.66 0.71 0.74 1.   0.72]
 [0.89 0.79 0.66 0.54 0.65 0.72 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.84 0.86 0.81 0.87 0.85 0.84]
 [0.84 1.   0.88 0.79 0.85 0.89 0.89]
 [0.86 0.88 1.   0.92 0.86 0.86 0.88]
 [0.81 0.79 0.92 1.   0.82 0.86 0.8 ]
 [0.87 0.85 0.86 0.82 1.   0.85 0.85]
 [0.85 0.89 0.86 0.86 0.85 1.   0.84]
 [0.84 0.89 0.88 0.8  0.85 0.84 1.  ]]
Collapsing 2 & 3 with crosscontam 0.757061701234568 and sim 0.9154427719897957
Collapsing 1 & 6 with crosscontam 0.6777326170294005 and sim 0.893241984155644
Collapsing 1 & 5 with crosscontam 0.7602025513762791 and sim 0.8886767287309496
Collapsing 1 & 2 with crosscontam 0.5955897269135801 and sim 0.8818747856816076
Collapsing 2 & 6 with crosscontam 0.6607737053687357 and sim 0.8765735541377457
Collapsing 0 & 4 with crosscontam 0.5817078334032144 and sim 0.8712174942974549
Collapsing 2 & 5 with crosscontam 0.6560831905267674 and sim 0.8635747366946858
Collapsing 3 & 5 with crosscontam 0.7054693352588779 and sim 0.8631959659873591
Collapsing 2 & 4 with crosscontam 0.6225791015849773 and sim 0.8595055592131529
Collapsing 1 & 4 with crosscontam 0.6373535603074771 and sim 0.8541918925937594
Collapsing 0 & 5 with crosscontam 0.595517581784119 and sim 0.8518591071135667
Trimming eliminated 0 seqlets out of 1015
Trimming eliminated 0 seqlets out of 864
Trimming eliminated 0 seqlets out of 1121
Trimming eliminated 0 seqlets out of 2136
Skipped 1 due to duplicates
Trimming eliminated 0 seqlets out of 1063
Trimming eliminated 0 seqlets out of 3199
Unmerged patterns remapping: OrderedDict()
Time spent on merging iteration: 17.09629726409912
On merging iteration 2
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 2316 out of 2316 | elapsed:    1.0s finished
Numbers for each pattern pre-subsample: [3199]
Numbers after subsampling: [300]
Computing sims for pattern 0
Computed sims for pattern 0 in 4.5299530029296875e-06 s
Cluster sizes
[3199]
Cross-contamination matrix:
[[1.]]
Pattern-to-pattern sim matrix:
[[1.]]
Inspecting pattern 4 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 2316
[t-SNE] Computed conditional probabilities for sample 2000 / 2316
[t-SNE] Computed conditional probabilities for sample 2316 / 2316
[t-SNE] Mean sigma: 0.266443
Beginning preprocessing + Leiden
2024-03-16 20:13:31.238522 MEMORY 20.29072384
Affmat transformed
2024-03-16 20:13:31.265296 MEMORY 20.29072384
sources, targets, weights extracted
2024-03-16 20:13:31.286198 MEMORY 20.29072384
About to launch parallel Leiden runs
2024-03-16 20:13:31.298760 MEMORY 20.29072384
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    7.9s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   26.1s finished
Parallel Leiden runs finished
2024-03-16 20:13:57.366927 MEMORY 20.29072384
Quality: 0.48403787241555085
Quality: 0.48512067879319176
Got subclusters: Counter({0: 497, 1: 467, 2: 349, 3: 336, 4: 235, 5: 202, 6: 175, 7: 55})
On merging iteration 1
Numbers for each pattern pre-subsample: [497, 467, 349, 336, 235, 202, 175, 55]
Numbers after subsampling: [300, 300, 300, 300, 235, 202, 175, 55]
Computing sims for pattern 0
Computed sims for pattern 0 in 2.773857831954956 s
Computing sims for pattern 1
Computed sims for pattern 1 in 2.8870859146118164 s
Computing sims for pattern 2
Computed sims for pattern 2 in 2.787837505340576 s
Computing sims for pattern 3
Computed sims for pattern 3 in 2.861361026763916 s
Computing sims for pattern 4
Computed sims for pattern 4 in 2.624213933944702 s
Computing sims for pattern 5
Computed sims for pattern 5 in 2.164088487625122 s
Computing sims for pattern 6
Computed sims for pattern 6 in 1.8591220378875732 s
Computing sims for pattern 7
Computed sims for pattern 7 in 0.8605198860168457 s
Cluster sizes
[497 467 349 336 235 202 175  55]
Cross-contamination matrix:
[[1.   0.74 0.58 0.66 0.6  0.63 0.82 0.83]
 [0.77 1.   0.6  0.63 0.57 0.62 0.83 0.84]
 [0.77 0.75 1.   0.73 0.59 0.49 0.88 0.84]
 [0.78 0.71 0.67 1.   0.66 0.58 0.87 0.8 ]
 [0.94 0.87 0.73 0.87 1.   0.83 1.   0.91]
 [0.76 0.73 0.47 0.61 0.65 1.   0.74 0.67]
 [0.63 0.61 0.49 0.55 0.46 0.42 1.   0.67]
 [0.69 0.68 0.53 0.56 0.46 0.44 0.71 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.91 0.86 0.92 0.94 0.86 0.93 0.91]
 [0.91 1.   0.84 0.88 0.92 0.84 0.92 0.91]
 [0.86 0.84 1.   0.85 0.84 0.73 0.88 0.87]
 [0.92 0.88 0.85 1.   0.92 0.8  0.91 0.91]
 [0.94 0.92 0.84 0.92 1.   0.89 0.93 0.89]
 [0.86 0.84 0.73 0.8  0.89 1.   0.84 0.79]
 [0.93 0.92 0.88 0.91 0.93 0.84 1.   0.93]
 [0.91 0.91 0.87 0.91 0.89 0.79 0.93 1.  ]]
Collapsing 0 & 4 with crosscontam 0.597070740425532 and sim 0.9415762587092718
Collapsing 6 & 7 with crosscontam 0.6658851621521336 and sim 0.934725636908216
Collapsing 0 & 6 with crosscontam 0.6252961511370263 and sim 0.9311101798504099
Collapsing 4 & 6 with crosscontam 0.45882543822343513 and sim 0.9264717240047893
Collapsing 0 & 3 with crosscontam 0.6598621896296297 and sim 0.9244418488814898
Collapsing 1 & 4 with crosscontam 0.5667223501970056 and sim 0.9210315377192195
Collapsing 1 & 6 with crosscontam 0.6085105794363461 and sim 0.9207495705484502
Collapsing 3 & 4 with crosscontam 0.6552211555555556 and sim 0.9181477435658278
Collapsing 0 & 7 with crosscontam 0.6888743300776359 and sim 0.9120268933169516
Collapsing 3 & 7 with crosscontam 0.5582652041071878 and sim 0.9091608174767463
Collapsing 3 & 6 with crosscontam 0.554608921127308 and sim 0.9085357798237155
Collapsing 0 & 1 with crosscontam 0.7424647634567902 and sim 0.9077442913293957
Collapsing 1 & 7 with crosscontam 0.6818817731029301 and sim 0.905377062393836
Collapsing 4 & 5 with crosscontam 0.6467097561883743 and sim 0.892894110201558
Collapsing 1 & 3 with crosscontam 0.6277804533333333 and sim 0.882318975800612
Collapsing 2 & 7 with crosscontam 0.5259097019784622 and sim 0.8702950089545008
Collapsing 0 & 5 with crosscontam 0.6250436604327099 and sim 0.8630327260629752
Collapsing 0 & 2 with crosscontam 0.5846962414814814 and sim 0.8595941169192003
Collapsing 2 & 3 with crosscontam 0.6663451772839504 and sim 0.8549133054614884
Trimming eliminated 0 seqlets out of 732
Trimming eliminated 0 seqlets out of 230
Trimming eliminated 0 seqlets out of 962
Trimming eliminated 0 seqlets out of 1298
Trimming eliminated 0 seqlets out of 1765
Trimming eliminated 0 seqlets out of 1967
Trimming eliminated 0 seqlets out of 2316
Unmerged patterns remapping: OrderedDict()
Time spent on merging iteration: 14.93864917755127
On merging iteration 2
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 930 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 978 out of 978 | elapsed:    0.2s finished
Numbers for each pattern pre-subsample: [2316]
Numbers after subsampling: [300]
Computing sims for pattern 0
Computed sims for pattern 0 in 5.7220458984375e-06 s
Cluster sizes
[2316]
Cross-contamination matrix:
[[1.]]
Pattern-to-pattern sim matrix:
[[1.]]
Inspecting pattern 5 for spurious merging
[t-SNE] Computed conditional probabilities for sample 978 / 978
[t-SNE] Mean sigma: 0.300397
Beginning preprocessing + Leiden
2024-03-16 20:14:32.162118 MEMORY 20.29072384
Affmat transformed
2024-03-16 20:14:32.174353 MEMORY 20.29072384
sources, targets, weights extracted
2024-03-16 20:14:32.183758 MEMORY 20.29072384
About to launch parallel Leiden runs
2024-03-16 20:14:32.191501 MEMORY 20.29072384
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    2.8s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    9.0s finished
Parallel Leiden runs finished
2024-03-16 20:14:41.167441 MEMORY 20.29072384
Quality: 0.4544349189803379
Quality: 0.4547746057397554
Quality: 0.4547777867996234
Quality: 0.4548320532015586
Got subclusters: Counter({0: 199, 1: 185, 2: 164, 3: 151, 4: 138, 5: 121, 6: 20})
On merging iteration 1
Numbers for each pattern pre-subsample: [199, 185, 164, 151, 138, 121, 20]
Numbers after subsampling: [199, 185, 164, 151, 138, 121, 20]
Computing sims for pattern 0
Computed sims for pattern 0 in 1.5830590724945068 s
Computing sims for pattern 1
Computed sims for pattern 1 in 1.4365525245666504 s
Computing sims for pattern 2
Computed sims for pattern 2 in 1.2607250213623047 s
Computing sims for pattern 3
Computed sims for pattern 3 in 1.1452248096466064 s
Computing sims for pattern 4
Computed sims for pattern 4 in 1.1288447380065918 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.9968953132629395 s
Computing sims for pattern 6
Computed sims for pattern 6 in 0.28452110290527344 s
Cluster sizes
[199 185 164 151 138 121  20]
Cross-contamination matrix:
[[1.   0.68 0.41 0.25 0.31 0.24 0.2 ]
 [1.   1.   0.58 0.45 0.42 0.37 0.22]
 [1.   0.94 1.   0.7  0.5  0.52 0.5 ]
 [0.94 0.94 0.79 1.   0.63 0.5  0.65]
 [0.87 0.7  0.4  0.5  1.   0.52 0.39]
 [0.96 0.85 0.69 0.58 0.72 1.   0.56]
 [0.64 0.53 0.45 0.48 0.38 0.38 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.94 0.88 0.78 0.69 0.68 0.67]
 [0.94 1.   0.82 0.81 0.71 0.7  0.61]
 [0.88 0.82 1.   0.86 0.65 0.66 0.67]
 [0.78 0.81 0.86 1.   0.71 0.71 0.72]
 [0.69 0.71 0.65 0.71 1.   0.7  0.54]
 [0.68 0.7  0.66 0.71 0.7  1.   0.6 ]
 [0.67 0.61 0.67 0.72 0.54 0.6  1.  ]]
Collapsing 0 & 1 with crosscontam 0.6808344884937287 and sim 0.9420042887852976
Collapsing 2 & 3 with crosscontam 0.6997857814653135 and sim 0.8557255538858929
Trimming eliminated 0 seqlets out of 384
Trimming eliminated 0 seqlets out of 315
Unmerged patterns remapping: OrderedDict([(4, 2), (5, 3), (6, 4)])
Time spent on merging iteration: 1.345320463180542
On merging iteration 2
Numbers for each pattern pre-subsample: [384, 315, 138, 121, 20]
Numbers after subsampling: [300, 300, 138, 121, 20]
Computing sims for pattern 0
Computed sims for pattern 0 in 1.4957823753356934 s
Computing sims for pattern 1
Computed sims for pattern 1 in 1.463526725769043 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.48812294006347656 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.4358365535736084 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.14536476135253906 s
Cluster sizes
[384 315 138 121  20]
Cross-contamination matrix:
[[1.   0.54 0.5  0.41 0.4 ]
 [0.98 1.   0.6  0.55 0.65]
 [0.74 0.4  1.   0.52 0.39]
 [0.83 0.58 0.72 1.   0.56]
 [0.58 0.47 0.38 0.38 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.81 0.68 0.67 0.67]
 [0.81 1.   0.66 0.72 0.73]
 [0.68 0.66 1.   0.7  0.54]
 [0.67 0.72 0.7  1.   0.6 ]
 [0.67 0.73 0.54 0.6  1.  ]]
Merging on 24 clusters
2024-03-16 20:14:54.347104 MEMORY 20.29072384
On merging iteration 1
Numbers for each pattern pre-subsample: [4327, 97, 42, 3, 1319, 1172, 534, 280, 232, 107, 101, 718, 698, 649, 627, 542, 367, 3199, 2316, 384, 315, 138, 121, 20]
Numbers after subsampling: [300, 97, 42, 3, 300, 300, 300, 280, 232, 107, 101, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 138, 121, 20]
Computing sims for pattern 0
Computed sims for pattern 0 in 9.294519662857056 s
Computing sims for pattern 1
Computed sims for pattern 1 in 3.432147741317749 s
Computing sims for pattern 2
Computed sims for pattern 2 in 4.479631185531616 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.7955834865570068 s
Computing sims for pattern 4
Computed sims for pattern 4 in 9.224956274032593 s
Computing sims for pattern 5
Computed sims for pattern 5 in 9.514389276504517 s
Computing sims for pattern 6
Computed sims for pattern 6 in 9.775182485580444 s
Computing sims for pattern 7
Computed sims for pattern 7 in 8.545475006103516 s
Computing sims for pattern 8
Computed sims for pattern 8 in 8.504135370254517 s
Computing sims for pattern 9
Computed sims for pattern 9 in 3.847053289413452 s
Computing sims for pattern 10
Computed sims for pattern 10 in 3.5963597297668457 s
Computing sims for pattern 11
Computed sims for pattern 11 in 9.281774282455444 s
Computing sims for pattern 12
Computed sims for pattern 12 in 9.156364917755127 s
Computing sims for pattern 13
Computed sims for pattern 13 in 9.304909706115723 s
Computing sims for pattern 14
Computed sims for pattern 14 in 9.220949172973633 s
Computing sims for pattern 15
Computed sims for pattern 15 in 9.347110509872437 s
Computing sims for pattern 16
Computed sims for pattern 16 in 9.137516021728516 s
Computing sims for pattern 17
Computed sims for pattern 17 in 12.691464185714722 s
Computing sims for pattern 18
Computed sims for pattern 18 in 8.427721977233887 s
Computing sims for pattern 19
Computed sims for pattern 19 in 9.15980076789856 s
Computing sims for pattern 20
Computed sims for pattern 20 in 9.37301254272461 s
Computing sims for pattern 21
Computed sims for pattern 21 in 5.059060096740723 s
Computing sims for pattern 22
Computed sims for pattern 22 in 4.38871693611145 s
Computing sims for pattern 23
Computed sims for pattern 23 in 1.3262410163879395 s
Cluster sizes
[4327   97   42    3 1319 1172  534  280  232  107  101  718  698  649
  627  542  367 3199 2316  384  315  138  121   20]
Cross-contamination matrix:
[[1.   0.61 1.   0.91 0.15 0.21 0.12 0.27 0.14 0.52 0.1  0.59 0.23 0.24
  0.3  0.23 0.58 0.61 0.97 0.22 0.17 0.67 0.48 0.09]
 [0.37 1.   0.23 0.32 0.07 0.13 0.13 0.42 0.1  0.14 0.15 0.03 0.02 0.08
  0.04 0.03 0.12 0.13 0.26 0.18 0.14 0.23 0.42 0.07]
 [0.28 0.03 1.   0.1  0.01 0.03 0.03 0.02 0.01 0.2  0.03 0.07 0.03 0.05
  0.01 0.05 0.25 0.12 0.28 0.   0.01 0.11 0.05 0.01]
 [0.01 0.   0.   1.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.
  0.   0.   0.   0.   0.   0.   0.   0.   0.   0.  ]
 [0.21 0.29 0.51 0.18 1.   0.73 0.84 0.67 0.88 0.8  0.77 0.09 0.22 0.43
  0.12 0.45 0.29 0.29 0.18 0.4  0.51 0.32 0.38 0.75]
 [0.3  0.42 0.61 0.29 0.82 1.   0.79 0.71 0.92 0.82 0.82 0.12 0.43 0.66
  0.13 0.7  0.48 0.28 0.28 0.56 0.77 0.39 0.38 0.57]
 [0.08 0.27 0.42 0.11 0.7  0.53 1.   0.56 0.61 0.68 0.64 0.1  0.26 0.4
  0.19 0.38 0.28 0.16 0.09 0.33 0.4  0.24 0.25 0.79]
 [0.32 0.75 0.43 0.31 0.62 0.6  0.66 1.   0.79 0.6  0.71 0.1  0.12 0.36
  0.13 0.32 0.19 0.21 0.21 0.44 0.5  0.37 0.47 0.56]
 [0.07 0.16 0.22 0.05 0.62 0.53 0.48 0.56 1.   0.49 0.52 0.03 0.18 0.29
  0.07 0.36 0.2  0.13 0.05 0.23 0.41 0.21 0.2  0.53]
 [0.42 0.26 0.8  0.3  0.56 0.46 0.57 0.43 0.53 1.   0.53 0.24 0.24 0.54
  0.23 0.31 0.51 0.31 0.39 0.18 0.35 0.16 0.19 0.44]
 [0.04 0.18 0.2  0.08 0.43 0.37 0.43 0.4  0.44 0.42 1.   0.04 0.08 0.23
  0.06 0.22 0.12 0.1  0.04 0.07 0.14 0.06 0.08 0.2 ]
 [0.69 0.15 0.68 0.46 0.05 0.07 0.12 0.07 0.05 0.34 0.09 1.   0.57 0.37
  0.75 0.43 0.6  0.37 0.66 0.12 0.09 0.44 0.25 0.1 ]
 [0.31 0.13 0.51 0.06 0.22 0.32 0.31 0.15 0.34 0.37 0.19 0.65 1.   0.63
  0.66 0.65 0.51 0.27 0.3  0.35 0.43 0.28 0.26 0.37]
 [0.24 0.21 0.62 0.06 0.22 0.38 0.34 0.27 0.29 0.58 0.34 0.33 0.49 1.
  0.44 0.66 0.7  0.14 0.22 0.39 0.53 0.38 0.33 0.32]
 [0.26 0.11 0.26 0.05 0.04 0.05 0.16 0.08 0.07 0.21 0.09 0.62 0.48 0.51
  1.   0.56 0.36 0.28 0.24 0.07 0.13 0.18 0.07 0.16]
 [0.22 0.08 0.53 0.18 0.31 0.42 0.37 0.23 0.42 0.31 0.35 0.38 0.5  0.55
  0.6  1.   0.54 0.09 0.18 0.2  0.32 0.19 0.19 0.36]
 [0.71 0.38 1.   0.44 0.23 0.35 0.32 0.17 0.35 0.68 0.23 0.64 0.47 0.78
  0.51 0.64 1.   0.55 0.71 0.22 0.35 0.43 0.23 0.32]
 [0.65 0.33 0.74 0.48 0.24 0.22 0.22 0.2  0.14 0.42 0.33 0.36 0.22 0.19
  0.34 0.13 0.49 1.   0.74 0.17 0.16 0.48 0.38 0.39]
 [0.75 0.31 0.78 0.6  0.07 0.11 0.07 0.11 0.06 0.32 0.06 0.39 0.12 0.13
  0.17 0.11 0.4  0.49 1.   0.07 0.09 0.35 0.25 0.04]
 [0.15 0.24 0.13 0.21 0.2  0.25 0.24 0.24 0.22 0.15 0.11 0.11 0.19 0.27
  0.11 0.15 0.12 0.11 0.1  1.   0.54 0.5  0.41 0.4 ]
 [0.18 0.35 0.29 0.15 0.48 0.66 0.52 0.5  0.65 0.54 0.33 0.12 0.35 0.68
  0.15 0.41 0.35 0.15 0.17 0.98 1.   0.6  0.55 0.65]
 [0.59 0.39 0.66 0.67 0.18 0.23 0.24 0.26 0.24 0.18 0.11 0.31 0.17 0.24
  0.16 0.17 0.31 0.42 0.45 0.74 0.4  1.   0.52 0.39]
 [0.61 0.78 0.68 0.68 0.37 0.34 0.38 0.52 0.39 0.32 0.23 0.29 0.26 0.36
  0.15 0.25 0.2  0.45 0.52 0.83 0.58 0.72 1.   0.56]
 [0.08 0.18 0.3  0.13 0.54 0.33 0.64 0.4  0.56 0.44 0.28 0.09 0.24 0.28
  0.17 0.3  0.22 0.31 0.08 0.58 0.47 0.38 0.38 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.65 0.86 0.74 0.31 0.36 0.29 0.36 0.23 0.53 0.21 0.76 0.32 0.37
  0.44 0.39 0.78 0.73 0.94 0.25 0.33 0.72 0.65 0.25]
 [0.65 1.   0.53 0.49 0.4  0.49 0.49 0.69 0.37 0.52 0.39 0.4  0.26 0.35
  0.22 0.29 0.43 0.5  0.55 0.41 0.47 0.5  0.69 0.44]
 [0.86 0.53 1.   0.65 0.37 0.4  0.4  0.37 0.26 0.64 0.32 0.66 0.45 0.61
  0.38 0.53 0.86 0.65 0.82 0.16 0.3  0.59 0.58 0.3 ]
 [0.74 0.49 0.65 1.   0.26 0.39 0.36 0.36 0.23 0.4  0.26 0.43 0.14 0.19
  0.16 0.21 0.45 0.56 0.71 0.3  0.32 0.6  0.65 0.37]
 [0.31 0.4  0.37 0.26 1.   0.84 0.85 0.81 0.83 0.8  0.77 0.13 0.22 0.45
  0.15 0.54 0.26 0.47 0.28 0.37 0.66 0.36 0.55 0.71]
 [0.36 0.49 0.4  0.39 0.84 1.   0.79 0.83 0.83 0.79 0.75 0.16 0.39 0.61
  0.18 0.67 0.39 0.45 0.35 0.51 0.81 0.48 0.59 0.59]
 [0.29 0.49 0.4  0.36 0.85 0.79 1.   0.84 0.74 0.79 0.74 0.18 0.33 0.57
  0.29 0.55 0.3  0.39 0.29 0.5  0.69 0.45 0.55 0.82]
 [0.36 0.69 0.37 0.36 0.81 0.83 0.84 1.   0.82 0.73 0.78 0.17 0.23 0.58
  0.23 0.56 0.28 0.38 0.31 0.47 0.71 0.5  0.63 0.71]
 [0.23 0.37 0.26 0.23 0.83 0.83 0.74 0.82 1.   0.7  0.71 0.13 0.3  0.52
  0.15 0.58 0.35 0.3  0.2  0.44 0.71 0.46 0.52 0.66]
 [0.53 0.52 0.64 0.4  0.8  0.79 0.79 0.73 0.7  1.   0.66 0.41 0.34 0.69
  0.33 0.49 0.59 0.54 0.5  0.39 0.67 0.41 0.52 0.68]
 [0.21 0.39 0.32 0.26 0.77 0.75 0.74 0.78 0.71 0.66 1.   0.14 0.22 0.54
  0.23 0.63 0.28 0.43 0.18 0.3  0.53 0.31 0.39 0.53]
 [0.76 0.4  0.66 0.43 0.13 0.16 0.18 0.17 0.13 0.41 0.14 1.   0.69 0.47
  0.8  0.54 0.72 0.52 0.71 0.14 0.25 0.49 0.36 0.09]
 [0.32 0.26 0.45 0.14 0.22 0.39 0.33 0.23 0.3  0.34 0.22 0.69 1.   0.63
  0.64 0.61 0.5  0.27 0.3  0.43 0.47 0.4  0.34 0.38]
 [0.37 0.35 0.61 0.19 0.45 0.61 0.57 0.58 0.52 0.69 0.54 0.47 0.63 1.
  0.61 0.7  0.81 0.25 0.35 0.53 0.74 0.58 0.62 0.49]
 [0.44 0.22 0.38 0.16 0.15 0.18 0.29 0.23 0.15 0.33 0.23 0.8  0.64 0.61
  1.   0.66 0.56 0.41 0.39 0.14 0.21 0.21 0.23 0.23]
 [0.39 0.29 0.53 0.21 0.54 0.67 0.55 0.56 0.58 0.49 0.63 0.54 0.61 0.7
  0.66 1.   0.71 0.19 0.33 0.32 0.56 0.38 0.43 0.48]
 [0.78 0.43 0.86 0.45 0.26 0.39 0.3  0.28 0.35 0.59 0.28 0.72 0.5  0.81
  0.56 0.71 1.   0.58 0.73 0.23 0.41 0.43 0.33 0.26]
 [0.73 0.5  0.65 0.56 0.47 0.45 0.39 0.38 0.3  0.54 0.43 0.52 0.27 0.25
  0.41 0.19 0.58 1.   0.74 0.24 0.39 0.59 0.55 0.46]
 [0.94 0.55 0.82 0.71 0.28 0.35 0.29 0.31 0.2  0.5  0.18 0.71 0.3  0.35
  0.39 0.33 0.73 0.74 1.   0.19 0.33 0.62 0.61 0.27]
 [0.25 0.41 0.16 0.3  0.37 0.51 0.5  0.47 0.44 0.39 0.3  0.14 0.43 0.53
  0.14 0.32 0.23 0.24 0.19 1.   0.81 0.68 0.67 0.67]
 [0.33 0.47 0.3  0.32 0.66 0.81 0.69 0.71 0.71 0.67 0.53 0.25 0.47 0.74
  0.21 0.56 0.41 0.39 0.33 0.81 1.   0.66 0.72 0.73]
 [0.72 0.5  0.59 0.6  0.36 0.48 0.45 0.5  0.46 0.41 0.31 0.49 0.4  0.58
  0.21 0.38 0.43 0.59 0.62 0.68 0.66 1.   0.7  0.54]
 [0.65 0.69 0.58 0.65 0.55 0.59 0.55 0.63 0.52 0.52 0.39 0.36 0.34 0.62
  0.23 0.43 0.33 0.55 0.61 0.67 0.72 0.7  1.   0.6 ]
 [0.25 0.44 0.3  0.37 0.71 0.59 0.82 0.71 0.66 0.68 0.53 0.09 0.38 0.49
  0.23 0.48 0.26 0.46 0.27 0.67 0.73 0.54 0.6  1.  ]]
Collapsing 0 & 18 with crosscontam 0.749927 and sim 0.9352062626485778
Skipped 2 due to duplicates
Trimming eliminated 0 seqlets out of 6641
Unmerged patterns remapping: OrderedDict([(1, 19), (2, 20), (3, 22), (4, 2), (5, 3), (6, 9), (7, 13), (8, 14), (9, 17), (10, 18), (11, 4), (12, 5), (13, 6), (14, 7), (15, 8), (16, 11), (17, 1), (19, 10), (20, 12), (21, 15), (22, 16), (23, 21)])
Time spent on merging iteration: 9.76161003112793
On merging iteration 2
Numbers for each pattern pre-subsample: [6641, 3199, 1319, 1172, 718, 698, 649, 627, 542, 534, 384, 367, 315, 280, 232, 138, 121, 107, 101, 97, 42, 20, 3]
Numbers after subsampling: [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 280, 232, 138, 121, 107, 101, 97, 42, 20, 3]
Computing sims for pattern 0
Computed sims for pattern 0 in 12.364688873291016 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.44520115852355957 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.45521044731140137 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.45867156982421875 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.45499610900878906 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.44803786277770996 s
Computing sims for pattern 6
Computed sims for pattern 6 in 0.4367086887359619 s
Computing sims for pattern 7
Computed sims for pattern 7 in 0.4454517364501953 s
Computing sims for pattern 8
Computed sims for pattern 8 in 0.45246458053588867 s
Computing sims for pattern 9
Computed sims for pattern 9 in 0.4727609157562256 s
Computing sims for pattern 10
Computed sims for pattern 10 in 0.4861440658569336 s
Computing sims for pattern 11
Computed sims for pattern 11 in 0.4883463382720947 s
Computing sims for pattern 12
Computed sims for pattern 12 in 0.46658968925476074 s
Computing sims for pattern 13
Computed sims for pattern 13 in 0.40596961975097656 s
Computing sims for pattern 14
Computed sims for pattern 14 in 0.3989582061767578 s
Computing sims for pattern 15
Computed sims for pattern 15 in 0.2484896183013916 s
Computing sims for pattern 16
Computed sims for pattern 16 in 0.20686745643615723 s
Computing sims for pattern 17
Computed sims for pattern 17 in 0.1884136199951172 s
Computing sims for pattern 18
Computed sims for pattern 18 in 0.17252588272094727 s
Computing sims for pattern 19
Computed sims for pattern 19 in 0.16954779624938965 s
Computing sims for pattern 20
Computed sims for pattern 20 in 0.09950828552246094 s
Computing sims for pattern 21
Computed sims for pattern 21 in 0.07125234603881836 s
Computing sims for pattern 22
Computed sims for pattern 22 in 0.04636406898498535 s
Cluster sizes
[6641 3199 1319 1172  718  698  649  627  542  534  384  367  315  280
  232  138  121  107  101   97   42   20    3]
Cross-contamination matrix:
[[1.   0.65 0.15 0.22 0.57 0.21 0.23 0.27 0.23 0.13 0.19 0.6  0.17 0.21
  0.15 0.63 0.46 0.55 0.58 0.6  1.   0.09 0.87]
 [0.65 1.   0.24 0.22 0.36 0.22 0.19 0.34 0.13 0.22 0.17 0.49 0.16 0.2
  0.14 0.48 0.38 0.42 0.33 0.33 0.74 0.39 0.48]
 [0.21 0.29 1.   0.73 0.09 0.22 0.43 0.12 0.45 0.84 0.4  0.29 0.51 0.67
  0.88 0.32 0.38 0.8  0.77 0.29 0.51 0.75 0.18]
 [0.3  0.28 0.82 1.   0.12 0.43 0.66 0.13 0.7  0.79 0.56 0.48 0.77 0.71
  0.92 0.39 0.38 0.82 0.82 0.42 0.61 0.57 0.29]
 [0.63 0.37 0.05 0.07 1.   0.57 0.37 0.75 0.43 0.12 0.12 0.6  0.09 0.07
  0.05 0.44 0.25 0.34 0.09 0.15 0.68 0.1  0.46]
 [0.29 0.27 0.22 0.32 0.65 1.   0.63 0.66 0.65 0.31 0.35 0.51 0.43 0.15
  0.34 0.28 0.26 0.37 0.19 0.13 0.51 0.37 0.06]
 [0.23 0.14 0.22 0.38 0.33 0.49 1.   0.44 0.66 0.34 0.39 0.7  0.53 0.27
  0.29 0.38 0.33 0.58 0.34 0.21 0.62 0.32 0.06]
 [0.23 0.28 0.04 0.05 0.62 0.48 0.51 1.   0.56 0.16 0.07 0.36 0.13 0.08
  0.07 0.18 0.07 0.21 0.09 0.11 0.26 0.16 0.05]
 [0.2  0.09 0.31 0.42 0.38 0.5  0.55 0.6  1.   0.37 0.2  0.54 0.32 0.23
  0.42 0.19 0.19 0.31 0.35 0.08 0.53 0.36 0.18]
 [0.09 0.16 0.7  0.53 0.1  0.26 0.4  0.19 0.38 1.   0.33 0.28 0.4  0.56
  0.61 0.24 0.25 0.68 0.64 0.27 0.42 0.79 0.11]
 [0.13 0.11 0.2  0.25 0.11 0.19 0.27 0.11 0.15 0.24 1.   0.12 0.54 0.24
  0.22 0.5  0.41 0.15 0.11 0.24 0.13 0.4  0.21]
 [0.71 0.55 0.23 0.35 0.64 0.47 0.78 0.51 0.64 0.32 0.22 1.   0.35 0.17
  0.35 0.43 0.23 0.68 0.23 0.38 1.   0.32 0.44]
 [0.19 0.15 0.48 0.66 0.12 0.35 0.68 0.15 0.41 0.52 0.98 0.35 1.   0.5
  0.65 0.6  0.55 0.54 0.33 0.35 0.29 0.65 0.15]
 [0.23 0.21 0.62 0.6  0.1  0.12 0.36 0.13 0.32 0.66 0.44 0.19 0.5  1.
  0.79 0.37 0.47 0.6  0.71 0.75 0.43 0.56 0.31]
 [0.08 0.13 0.62 0.53 0.03 0.18 0.29 0.07 0.36 0.48 0.23 0.2  0.41 0.56
  1.   0.21 0.2  0.49 0.52 0.16 0.22 0.53 0.05]
 [0.53 0.42 0.18 0.23 0.31 0.17 0.24 0.16 0.17 0.24 0.74 0.31 0.4  0.26
  0.24 1.   0.52 0.18 0.11 0.39 0.66 0.39 0.67]
 [0.57 0.45 0.37 0.34 0.29 0.26 0.36 0.15 0.25 0.38 0.83 0.2  0.58 0.52
  0.39 0.72 1.   0.32 0.23 0.78 0.68 0.56 0.68]
 [0.42 0.31 0.56 0.46 0.24 0.24 0.54 0.23 0.31 0.57 0.18 0.51 0.35 0.43
  0.53 0.16 0.19 1.   0.53 0.26 0.8  0.44 0.3 ]
 [0.26 0.1  0.43 0.37 0.04 0.08 0.23 0.06 0.22 0.43 0.07 0.12 0.14 0.4
  0.44 0.06 0.08 0.42 1.   0.18 0.2  0.2  0.08]
 [0.35 0.13 0.07 0.13 0.03 0.02 0.08 0.04 0.03 0.13 0.18 0.12 0.14 0.42
  0.1  0.23 0.42 0.14 0.15 1.   0.23 0.07 0.32]
 [0.27 0.12 0.01 0.03 0.07 0.03 0.05 0.01 0.05 0.03 0.   0.25 0.01 0.02
  0.01 0.11 0.05 0.2  0.03 0.03 1.   0.01 0.1 ]
 [0.09 0.31 0.54 0.33 0.09 0.24 0.28 0.17 0.3  0.64 0.58 0.22 0.47 0.4
  0.56 0.38 0.38 0.44 0.28 0.18 0.3  1.   0.13]
 [0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.
  0.   0.   0.   0.   0.   0.   0.   0.   1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.75 0.3  0.37 0.75 0.31 0.39 0.42 0.39 0.3  0.24 0.77 0.34 0.34
  0.22 0.72 0.64 0.63 0.57 0.62 0.85 0.27 0.74]
 [0.75 1.   0.47 0.45 0.52 0.27 0.25 0.41 0.19 0.39 0.24 0.58 0.39 0.38
  0.3  0.59 0.55 0.54 0.43 0.5  0.65 0.46 0.56]
 [0.3  0.47 1.   0.84 0.13 0.22 0.45 0.15 0.54 0.85 0.37 0.26 0.66 0.81
  0.83 0.36 0.55 0.8  0.77 0.4  0.37 0.71 0.26]
 [0.37 0.45 0.84 1.   0.16 0.39 0.61 0.18 0.67 0.79 0.51 0.39 0.81 0.83
  0.83 0.48 0.59 0.79 0.75 0.49 0.4  0.59 0.39]
 [0.75 0.52 0.13 0.16 1.   0.69 0.47 0.8  0.54 0.18 0.14 0.72 0.25 0.17
  0.13 0.49 0.36 0.41 0.14 0.4  0.66 0.09 0.43]
 [0.31 0.27 0.22 0.39 0.69 1.   0.63 0.64 0.61 0.33 0.43 0.5  0.47 0.23
  0.3  0.4  0.34 0.34 0.22 0.26 0.45 0.38 0.14]
 [0.39 0.25 0.45 0.61 0.47 0.63 1.   0.61 0.7  0.57 0.53 0.81 0.74 0.58
  0.52 0.58 0.62 0.69 0.54 0.35 0.61 0.49 0.19]
 [0.42 0.41 0.15 0.18 0.8  0.64 0.61 1.   0.66 0.29 0.14 0.56 0.21 0.23
  0.15 0.21 0.23 0.33 0.23 0.22 0.38 0.23 0.16]
 [0.39 0.19 0.54 0.67 0.54 0.61 0.7  0.66 1.   0.55 0.32 0.71 0.56 0.56
  0.58 0.38 0.43 0.49 0.63 0.29 0.53 0.48 0.21]
 [0.3  0.39 0.85 0.79 0.18 0.33 0.57 0.29 0.55 1.   0.5  0.3  0.69 0.84
  0.74 0.45 0.55 0.79 0.74 0.49 0.4  0.82 0.36]
 [0.24 0.24 0.37 0.51 0.14 0.43 0.53 0.14 0.32 0.5  1.   0.23 0.81 0.47
  0.44 0.68 0.67 0.39 0.3  0.41 0.16 0.67 0.3 ]
 [0.77 0.58 0.26 0.39 0.72 0.5  0.81 0.56 0.71 0.3  0.23 1.   0.41 0.28
  0.35 0.43 0.33 0.59 0.28 0.43 0.86 0.26 0.45]
 [0.34 0.39 0.66 0.81 0.25 0.47 0.74 0.21 0.56 0.69 0.81 0.41 1.   0.71
  0.71 0.66 0.72 0.67 0.53 0.47 0.3  0.73 0.32]
 [0.34 0.38 0.81 0.83 0.17 0.23 0.58 0.23 0.56 0.84 0.47 0.28 0.71 1.
  0.82 0.5  0.63 0.73 0.78 0.69 0.37 0.71 0.36]
 [0.22 0.3  0.83 0.83 0.13 0.3  0.52 0.15 0.58 0.74 0.44 0.35 0.71 0.82
  1.   0.46 0.52 0.7  0.71 0.37 0.26 0.66 0.23]
 [0.72 0.59 0.36 0.48 0.49 0.4  0.58 0.21 0.38 0.45 0.68 0.43 0.66 0.5
  0.46 1.   0.7  0.41 0.31 0.5  0.59 0.54 0.6 ]
 [0.64 0.55 0.55 0.59 0.36 0.34 0.62 0.23 0.43 0.55 0.67 0.33 0.72 0.63
  0.52 0.7  1.   0.52 0.39 0.69 0.58 0.6  0.65]
 [0.63 0.54 0.8  0.79 0.41 0.34 0.69 0.33 0.49 0.79 0.39 0.59 0.67 0.73
  0.7  0.41 0.52 1.   0.66 0.52 0.64 0.68 0.4 ]
 [0.57 0.43 0.77 0.75 0.14 0.22 0.54 0.23 0.63 0.74 0.3  0.28 0.53 0.78
  0.71 0.31 0.39 0.66 1.   0.39 0.32 0.53 0.26]
 [0.62 0.5  0.4  0.49 0.4  0.26 0.35 0.22 0.29 0.49 0.41 0.43 0.47 0.69
  0.37 0.5  0.69 0.52 0.39 1.   0.53 0.44 0.49]
 [0.85 0.65 0.37 0.4  0.66 0.45 0.61 0.38 0.53 0.4  0.16 0.86 0.3  0.37
  0.26 0.59 0.58 0.64 0.32 0.53 1.   0.3  0.65]
 [0.27 0.46 0.71 0.59 0.09 0.38 0.49 0.23 0.48 0.82 0.67 0.26 0.73 0.71
  0.66 0.54 0.6  0.68 0.53 0.44 0.3  1.   0.37]
 [0.74 0.56 0.26 0.39 0.43 0.14 0.19 0.16 0.21 0.36 0.3  0.45 0.32 0.36
  0.23 0.6  0.65 0.4  0.26 0.49 0.65 0.37 1.  ]]
Got 23 patterns after merging
2024-03-16 20:18:22.150421 MEMORY 20.290695168
Performing filtering
2024-03-16 20:18:22.150638 MEMORY 20.290695168
Got 21 patterns after filtering
2024-03-16 20:18:24.474642 MEMORY 20.290695168
Total time taken is 2664.72s
2024-03-16 20:18:24.474797 MEMORY 20.290695168
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.6s
[Parallel(n_jobs=24)]: Done 2400 tasks      | elapsed:    2.8s
[Parallel(n_jobs=24)]: Done 5200 tasks      | elapsed:    5.9s
[Parallel(n_jobs=24)]: Done 6641 out of 6641 | elapsed:    7.4s finished
/ru-auth/local/home/lzhao/anaconda3/envs/jupyter-ml-clone/lib/python3.9/site-packages/sklearn/manifold/_t_sne.py:691: FutureWarning: 'square_distances' has been introduced in 0.24 to help phase out legacy squaring behavior. The 'legacy' setting will be removed in 1.1 (renaming of 0.26), and the default setting will be changed to True. In 1.3, 'square_distances' will be removed altogether, and distances will be squared by default. Set 'square_distances'=True to silence this warning.
  warnings.warn(
/ru-auth/local/home/lzhao/anaconda3/envs/jupyter-ml-clone/lib/python3.9/site-packages/sklearn/neighbors/_base.py:175: EfficiencyWarning: Precomputed sparse input was not sorted by data.
  warnings.warn('Precomputed sparse input was not sorted by data.',
Applying subclustering to the final motifs
On pattern 0
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 6641 samples in 0.046s...
[t-SNE] Computed neighbors for 6641 samples in 0.005s...
[t-SNE] Computed conditional probabilities for sample 1000 / 6641
[t-SNE] Computed conditional probabilities for sample 2000 / 6641
[t-SNE] Computed conditional probabilities for sample 3000 / 6641
[t-SNE] Computed conditional probabilities for sample 4000 / 6641
[t-SNE] Computed conditional probabilities for sample 5000 / 6641
[t-SNE] Computed conditional probabilities for sample 6000 / 6641
[t-SNE] Computed conditional probabilities for sample 6641 / 6641
[t-SNE] Mean sigma: 0.259305
[t-SNE] Computed conditional probabilities in 0.467s
[t-SNE] Iteration 50: error = 83.6302795, gradient norm = 0.0000001 (50 iterations in 0.704s)
[t-SNE] Iteration 50: gradient norm 0.000000. Finished.
[t-SNE] KL divergence after 50 iterations with early exaggeration: 83.630280
[t-SNE] Iteration 100: error = 3.3765304, gradient norm = 0.0016392 (50 iterations in 0.572s)
[t-SNE] Iteration 150: error = 3.1175270, gradient norm = 0.0005343 (50 iterations in 0.504s)
[t-SNE] Iteration 200: error = 3.0280728, gradient norm = 0.0002724 (50 iterations in 0.494s)
[t-SNE] Iteration 250: error = 2.9762163, gradient norm = 0.0001809 (50 iterations in 0.513s)
[t-SNE] Iteration 300: error = 2.9436941, gradient norm = 0.0001299 (50 iterations in 0.513s)
[t-SNE] Iteration 350: error = 2.9219348, gradient norm = 0.0000935 (50 iterations in 0.492s)
[t-SNE] Iteration 400: error = 2.9064448, gradient norm = 0.0000778 (50 iterations in 0.529s)
[t-SNE] Iteration 450: error = 2.8954024, gradient norm = 0.0000660 (50 iterations in 0.506s)
[t-SNE] Iteration 500: error = 2.8868456, gradient norm = 0.0000541 (50 iterations in 0.493s)
[t-SNE] Iteration 550: error = 2.8796382, gradient norm = 0.0000503 (50 iterations in 0.490s)
[t-SNE] Iteration 600: error = 2.8743010, gradient norm = 0.0000507 (50 iterations in 0.503s)
[t-SNE] Iteration 650: error = 2.8710113, gradient norm = 0.0000511 (50 iterations in 0.585s)
[t-SNE] Iteration 700: error = 2.8685045, gradient norm = 0.0000421 (50 iterations in 0.499s)
[t-SNE] Iteration 750: error = 2.8661551, gradient norm = 0.0000414 (50 iterations in 0.500s)
[t-SNE] Iteration 800: error = 2.8637786, gradient norm = 0.0000381 (50 iterations in 0.514s)
[t-SNE] Iteration 850: error = 2.8617702, gradient norm = 0.0000325 (50 iterations in 0.509s)
[t-SNE] Iteration 900: error = 2.8599160, gradient norm = 0.0000343 (50 iterations in 0.504s)
[t-SNE] Iteration 950: error = 2.8581958, gradient norm = 0.0000304 (50 iterations in 0.501s)
[t-SNE] Iteration 1000: error = 2.8566539, gradient norm = 0.0000300 (50 iterations in 0.494s)
[t-SNE] KL divergence after 1000 iterations: 2.856654
[t-SNE] Computed conditional probabilities for sample 1000 / 6641
[t-SNE] Computed conditional probabilities for sample 2000 / 6641
[t-SNE] Computed conditional probabilities for sample 3000 / 6641
[t-SNE] Computed conditional probabilities for sample 4000 / 6641
[t-SNE] Computed conditional probabilities for sample 5000 / 6641
[t-SNE] Computed conditional probabilities for sample 6000 / 6641
[t-SNE] Computed conditional probabilities for sample 6641 / 6641
[t-SNE] Mean sigma: 0.259305
Beginning preprocessing + Leiden
2024-03-16 20:18:49.493085 MEMORY 20.328157184
Affmat transformed
2024-03-16 20:18:49.577443 MEMORY 20.348706816
sources, targets, weights extracted
2024-03-16 20:18:49.640463 MEMORY 20.348837888
About to launch parallel Leiden runs
2024-03-16 20:18:49.667009 MEMORY 20.348837888
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:   26.9s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:  1.7min finished
Parallel Leiden runs finished
2024-03-16 20:20:30.502476 MEMORY 20.348837888
Quality: 0.5241529506509116
Quality: 0.5254322039249918
Quality: 0.5259223092027017
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 2797 tasks      | elapsed:    1.2s
[Parallel(n_jobs=24)]: Done 3199 out of 3199 | elapsed:    1.3s finished
Got subclusters: Counter({0: 1276, 1: 1176, 2: 937, 3: 878, 4: 849, 5: 565, 6: 496, 7: 464})
On pattern 1
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 3199 samples in 0.025s...
[t-SNE] Computed neighbors for 3199 samples in 0.002s...
[t-SNE] Computed conditional probabilities for sample 1000 / 3199
[t-SNE] Computed conditional probabilities for sample 2000 / 3199
[t-SNE] Computed conditional probabilities for sample 3000 / 3199
[t-SNE] Computed conditional probabilities for sample 3199 / 3199
[t-SNE] Mean sigma: 0.270677
[t-SNE] Computed conditional probabilities in 0.227s
[t-SNE] Iteration 50: error = 74.9765167, gradient norm = 0.0695704 (50 iterations in 0.323s)
[t-SNE] Iteration 100: error = 74.9781723, gradient norm = 0.0680435 (50 iterations in 0.327s)
[t-SNE] Iteration 150: error = 74.9367676, gradient norm = 0.0368994 (50 iterations in 0.355s)
[t-SNE] Iteration 200: error = 74.9463348, gradient norm = 0.0475007 (50 iterations in 0.326s)
[t-SNE] Iteration 250: error = 74.9370117, gradient norm = 0.0401062 (50 iterations in 0.376s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 74.937012
[t-SNE] Iteration 300: error = 2.6884766, gradient norm = 0.0010872 (50 iterations in 0.332s)
[t-SNE] Iteration 350: error = 2.5757725, gradient norm = 0.0004147 (50 iterations in 0.248s)
[t-SNE] Iteration 400: error = 2.5255444, gradient norm = 0.0002279 (50 iterations in 0.253s)
[t-SNE] Iteration 450: error = 2.5000472, gradient norm = 0.0001462 (50 iterations in 0.251s)
[t-SNE] Iteration 500: error = 2.4844236, gradient norm = 0.0001162 (50 iterations in 0.251s)
[t-SNE] Iteration 550: error = 2.4753184, gradient norm = 0.0000768 (50 iterations in 0.242s)
[t-SNE] Iteration 600: error = 2.4686842, gradient norm = 0.0000630 (50 iterations in 0.258s)
[t-SNE] Iteration 650: error = 2.4642694, gradient norm = 0.0000575 (50 iterations in 0.259s)
[t-SNE] Iteration 700: error = 2.4612889, gradient norm = 0.0000461 (50 iterations in 0.255s)
[t-SNE] Iteration 750: error = 2.4585865, gradient norm = 0.0000423 (50 iterations in 0.271s)
[t-SNE] Iteration 800: error = 2.4566870, gradient norm = 0.0000378 (50 iterations in 0.289s)
[t-SNE] Iteration 850: error = 2.4552493, gradient norm = 0.0000391 (50 iterations in 0.283s)
[t-SNE] Iteration 900: error = 2.4540720, gradient norm = 0.0000353 (50 iterations in 0.326s)
[t-SNE] Iteration 950: error = 2.4531620, gradient norm = 0.0000306 (50 iterations in 0.358s)
[t-SNE] Iteration 1000: error = 2.4524188, gradient norm = 0.0000341 (50 iterations in 0.237s)
[t-SNE] KL divergence after 1000 iterations: 2.452419
[t-SNE] Computed conditional probabilities for sample 1000 / 3199
[t-SNE] Computed conditional probabilities for sample 2000 / 3199
[t-SNE] Computed conditional probabilities for sample 3000 / 3199
[t-SNE] Computed conditional probabilities for sample 3199 / 3199
[t-SNE] Mean sigma: 0.270677
Beginning preprocessing + Leiden
2024-03-16 20:20:42.032275 MEMORY 20.255125504
Affmat transformed
2024-03-16 20:20:42.070671 MEMORY 20.265807872
sources, targets, weights extracted
2024-03-16 20:20:42.100881 MEMORY 20.26586112
About to launch parallel Leiden runs
2024-03-16 20:20:42.115361 MEMORY 20.26586112
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:   12.9s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   42.2s finished
Parallel Leiden runs finished
2024-03-16 20:21:24.279607 MEMORY 20.26586112
Quality: 0.46430391464823567
Quality: 0.46488515590828844
Quality: 0.466183304431716
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 1319 out of 1319 | elapsed:    0.3s finished
Got subclusters: Counter({0: 823, 1: 499, 2: 421, 3: 419, 4: 372, 5: 333, 6: 332})
On pattern 2
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 1319 samples in 0.011s...
[t-SNE] Computed neighbors for 1319 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 1000 / 1319
[t-SNE] Computed conditional probabilities for sample 1319 / 1319
[t-SNE] Mean sigma: 0.303239
[t-SNE] Computed conditional probabilities in 0.095s
[t-SNE] Iteration 50: error = 70.2386017, gradient norm = 0.2350149 (50 iterations in 0.132s)
[t-SNE] Iteration 100: error = 70.8296661, gradient norm = 0.2246708 (50 iterations in 0.127s)
[t-SNE] Iteration 150: error = 71.0851898, gradient norm = 0.2109976 (50 iterations in 0.131s)
[t-SNE] Iteration 200: error = 70.4192505, gradient norm = 0.2315074 (50 iterations in 0.131s)
[t-SNE] Iteration 250: error = 71.6064377, gradient norm = 0.2045734 (50 iterations in 0.128s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 71.606438
[t-SNE] Iteration 300: error = 2.0622675, gradient norm = 0.0023754 (50 iterations in 0.116s)
[t-SNE] Iteration 350: error = 1.9967592, gradient norm = 0.0005597 (50 iterations in 0.113s)
[t-SNE] Iteration 400: error = 1.9777094, gradient norm = 0.0003287 (50 iterations in 0.115s)
[t-SNE] Iteration 450: error = 1.9660559, gradient norm = 0.0001486 (50 iterations in 0.109s)
[t-SNE] Iteration 500: error = 1.9612161, gradient norm = 0.0001076 (50 iterations in 0.110s)
[t-SNE] Iteration 550: error = 1.9572070, gradient norm = 0.0002398 (50 iterations in 0.108s)
[t-SNE] Iteration 600: error = 1.9546958, gradient norm = 0.0000826 (50 iterations in 0.110s)
[t-SNE] Iteration 650: error = 1.9530580, gradient norm = 0.0000636 (50 iterations in 0.106s)
[t-SNE] Iteration 700: error = 1.9522552, gradient norm = 0.0000941 (50 iterations in 0.107s)
[t-SNE] Iteration 750: error = 1.9502342, gradient norm = 0.0001246 (50 iterations in 0.108s)
[t-SNE] Iteration 800: error = 1.9484459, gradient norm = 0.0001231 (50 iterations in 0.108s)
[t-SNE] Iteration 850: error = 1.9468560, gradient norm = 0.0001286 (50 iterations in 0.113s)
[t-SNE] Iteration 900: error = 1.9435414, gradient norm = 0.0001603 (50 iterations in 0.106s)
[t-SNE] Iteration 950: error = 1.9394000, gradient norm = 0.0001953 (50 iterations in 0.111s)
[t-SNE] Iteration 1000: error = 1.9368918, gradient norm = 0.0001187 (50 iterations in 0.109s)
[t-SNE] KL divergence after 1000 iterations: 1.936892
[t-SNE] Computed conditional probabilities for sample 1000 / 1319
[t-SNE] Computed conditional probabilities for sample 1319 / 1319
[t-SNE] Mean sigma: 0.303239
Beginning preprocessing + Leiden
2024-03-16 20:21:28.746088 MEMORY 20.26586112
Affmat transformed
2024-03-16 20:21:28.760562 MEMORY 20.26586112
sources, targets, weights extracted
2024-03-16 20:21:28.771811 MEMORY 20.26586112
About to launch parallel Leiden runs
2024-03-16 20:21:28.783745 MEMORY 20.26586112
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    3.9s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   12.5s finished
Parallel Leiden runs finished
2024-03-16 20:21:41.248685 MEMORY 20.26586112
Quality: 0.42421505740412857
Quality: 0.42748650799768273
Quality: 0.4276952470613007
Quality: 0.4281024306947808
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 1125 out of 1172 | elapsed:    0.2s remaining:    0.0s
[Parallel(n_jobs=24)]: Done 1172 out of 1172 | elapsed:    0.2s finished
Got subclusters: Counter({0: 399, 1: 251, 2: 230, 3: 213, 4: 185, 5: 25, 6: 16})
On pattern 3
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 1172 samples in 0.009s...
[t-SNE] Computed neighbors for 1172 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 1000 / 1172
[t-SNE] Computed conditional probabilities for sample 1172 / 1172
[t-SNE] Mean sigma: 0.321821
[t-SNE] Computed conditional probabilities in 0.081s
[t-SNE] Iteration 50: error = 68.0307846, gradient norm = 0.2759726 (50 iterations in 0.181s)
[t-SNE] Iteration 100: error = 68.6339722, gradient norm = 0.2516203 (50 iterations in 0.100s)
[t-SNE] Iteration 150: error = 68.7799683, gradient norm = 0.2462926 (50 iterations in 0.106s)
[t-SNE] Iteration 200: error = 68.6817398, gradient norm = 0.2654887 (50 iterations in 0.107s)
[t-SNE] Iteration 250: error = 68.6219177, gradient norm = 0.2625310 (50 iterations in 0.102s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 68.621918
[t-SNE] Iteration 300: error = 1.9513577, gradient norm = 0.0023006 (50 iterations in 0.094s)
[t-SNE] Iteration 350: error = 1.8846017, gradient norm = 0.0005679 (50 iterations in 0.094s)
[t-SNE] Iteration 400: error = 1.8611993, gradient norm = 0.0003664 (50 iterations in 0.091s)
[t-SNE] Iteration 450: error = 1.8452045, gradient norm = 0.0002830 (50 iterations in 0.095s)
[t-SNE] Iteration 500: error = 1.8362603, gradient norm = 0.0001654 (50 iterations in 0.096s)
[t-SNE] Iteration 550: error = 1.8328527, gradient norm = 0.0001589 (50 iterations in 0.098s)
[t-SNE] Iteration 600: error = 1.8302941, gradient norm = 0.0001141 (50 iterations in 0.095s)
[t-SNE] Iteration 650: error = 1.8275700, gradient norm = 0.0001390 (50 iterations in 0.097s)
[t-SNE] Iteration 700: error = 1.8260061, gradient norm = 0.0001329 (50 iterations in 0.099s)
[t-SNE] Iteration 750: error = 1.8235558, gradient norm = 0.0002507 (50 iterations in 0.107s)
[t-SNE] Iteration 800: error = 1.8215185, gradient norm = 0.0001867 (50 iterations in 0.099s)
[t-SNE] Iteration 850: error = 1.8197993, gradient norm = 0.0001038 (50 iterations in 0.095s)
[t-SNE] Iteration 900: error = 1.8192900, gradient norm = 0.0000781 (50 iterations in 0.097s)
[t-SNE] Iteration 950: error = 1.8185581, gradient norm = 0.0001086 (50 iterations in 0.096s)
[t-SNE] Iteration 1000: error = 1.8182498, gradient norm = 0.0000789 (50 iterations in 0.095s)
[t-SNE] KL divergence after 1000 iterations: 1.818250
[t-SNE] Computed conditional probabilities for sample 1000 / 1172
[t-SNE] Computed conditional probabilities for sample 1172 / 1172
[t-SNE] Mean sigma: 0.321821
Beginning preprocessing + Leiden
2024-03-16 20:21:45.014406 MEMORY 20.26586112
Affmat transformed
2024-03-16 20:21:45.029544 MEMORY 20.26586112
sources, targets, weights extracted
2024-03-16 20:21:45.039391 MEMORY 20.26586112
About to launch parallel Leiden runs
2024-03-16 20:21:45.047470 MEMORY 20.26586112
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    3.3s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   10.1s finished
Parallel Leiden runs finished
2024-03-16 20:21:55.110421 MEMORY 20.26586112
Quality: 0.4348593991918402
Quality: 0.4348834236431874
Quality: 0.435954842598265
Quality: 0.43608724629576195
Quality: 0.4384692588282743
Quality: 0.43936378780679647
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 718 out of 718 | elapsed:    0.5s finished
Got subclusters: Counter({0: 230, 1: 206, 2: 177, 3: 167, 4: 164, 5: 154, 6: 74})
On pattern 4
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 718 samples in 0.006s...
[t-SNE] Computed neighbors for 718 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 718 / 718
[t-SNE] Mean sigma: 0.315641
[t-SNE] Computed conditional probabilities in 0.050s
[t-SNE] Iteration 50: error = 68.4709015, gradient norm = 0.4039384 (50 iterations in 0.119s)
[t-SNE] Iteration 100: error = 71.9586945, gradient norm = 0.3566947 (50 iterations in 0.076s)
[t-SNE] Iteration 150: error = 72.7880402, gradient norm = 0.3618223 (50 iterations in 0.078s)
[t-SNE] Iteration 200: error = 73.8762894, gradient norm = 0.3517267 (50 iterations in 0.080s)
[t-SNE] Iteration 250: error = 72.7135925, gradient norm = 0.3548881 (50 iterations in 0.078s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 72.713593
[t-SNE] Iteration 300: error = 1.7540082, gradient norm = 0.0031863 (50 iterations in 0.073s)
[t-SNE] Iteration 350: error = 1.7055016, gradient norm = 0.0012769 (50 iterations in 0.072s)
[t-SNE] Iteration 400: error = 1.6767786, gradient norm = 0.0006937 (50 iterations in 0.071s)
[t-SNE] Iteration 450: error = 1.6641365, gradient norm = 0.0003401 (50 iterations in 0.073s)
[t-SNE] Iteration 500: error = 1.6577826, gradient norm = 0.0003952 (50 iterations in 0.074s)
[t-SNE] Iteration 550: error = 1.6552224, gradient norm = 0.0001776 (50 iterations in 0.075s)
[t-SNE] Iteration 600: error = 1.6538631, gradient norm = 0.0001229 (50 iterations in 0.072s)
[t-SNE] Iteration 650: error = 1.6514355, gradient norm = 0.0002416 (50 iterations in 0.076s)
[t-SNE] Iteration 700: error = 1.6489707, gradient norm = 0.0001578 (50 iterations in 0.074s)
[t-SNE] Iteration 750: error = 1.6485755, gradient norm = 0.0000663 (50 iterations in 0.077s)
[t-SNE] Iteration 800: error = 1.6482590, gradient norm = 0.0001345 (50 iterations in 0.075s)
[t-SNE] Iteration 850: error = 1.6470468, gradient norm = 0.0001539 (50 iterations in 0.075s)
[t-SNE] Iteration 900: error = 1.6457117, gradient norm = 0.0001747 (50 iterations in 0.077s)
[t-SNE] Iteration 950: error = 1.6449746, gradient norm = 0.0000592 (50 iterations in 0.078s)
[t-SNE] Iteration 1000: error = 1.6455572, gradient norm = 0.0001112 (50 iterations in 0.077s)
[t-SNE] KL divergence after 1000 iterations: 1.645557
[t-SNE] Computed conditional probabilities for sample 718 / 718
[t-SNE] Mean sigma: 0.315641
Beginning preprocessing + Leiden
2024-03-16 20:21:58.023792 MEMORY 20.26586112
Affmat transformed
2024-03-16 20:21:58.033310 MEMORY 20.26586112
sources, targets, weights extracted
2024-03-16 20:21:58.039911 MEMORY 20.26586112
About to launch parallel Leiden runs
2024-03-16 20:21:58.046584 MEMORY 20.26586112
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    2.0s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    6.7s finished
Parallel Leiden runs finished
2024-03-16 20:22:04.713666 MEMORY 20.26586112
Quality: 0.3582611525488534
Quality: 0.35857762205091365
Quality: 0.35981536861371627
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 698 out of 698 | elapsed:    0.4s finished
Got subclusters: Counter({0: 147, 1: 126, 2: 124, 3: 110, 4: 97, 5: 69, 6: 45})
On pattern 5
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 698 samples in 0.006s...
[t-SNE] Computed neighbors for 698 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 698 / 698
[t-SNE] Mean sigma: 0.336983
[t-SNE] Computed conditional probabilities in 0.048s
[t-SNE] Iteration 50: error = 71.2267609, gradient norm = 0.3759378 (50 iterations in 0.094s)
[t-SNE] Iteration 100: error = 71.1492310, gradient norm = 0.3820930 (50 iterations in 0.071s)
[t-SNE] Iteration 150: error = 74.6426468, gradient norm = 0.3360392 (50 iterations in 0.071s)
[t-SNE] Iteration 200: error = 72.2200546, gradient norm = 0.3697523 (50 iterations in 0.073s)
[t-SNE] Iteration 250: error = 70.8755493, gradient norm = 0.3898906 (50 iterations in 0.072s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 70.875549
[t-SNE] Iteration 300: error = 1.6050928, gradient norm = 0.0033683 (50 iterations in 0.074s)
[t-SNE] Iteration 350: error = 1.5088160, gradient norm = 0.0010510 (50 iterations in 0.071s)
[t-SNE] Iteration 400: error = 1.4840152, gradient norm = 0.0006907 (50 iterations in 0.072s)
[t-SNE] Iteration 450: error = 1.4691609, gradient norm = 0.0005508 (50 iterations in 0.067s)
[t-SNE] Iteration 500: error = 1.4617635, gradient norm = 0.0002912 (50 iterations in 0.065s)
[t-SNE] Iteration 550: error = 1.4578691, gradient norm = 0.0004303 (50 iterations in 0.070s)
[t-SNE] Iteration 600: error = 1.4554292, gradient norm = 0.0001497 (50 iterations in 0.066s)
[t-SNE] Iteration 650: error = 1.4517158, gradient norm = 0.0001527 (50 iterations in 0.070s)
[t-SNE] Iteration 700: error = 1.4506228, gradient norm = 0.0001327 (50 iterations in 0.068s)
[t-SNE] Iteration 750: error = 1.4505752, gradient norm = 0.0001124 (50 iterations in 0.067s)
[t-SNE] Iteration 800: error = 1.4503284, gradient norm = 0.0000566 (50 iterations in 0.071s)
[t-SNE] Iteration 850: error = 1.4501266, gradient norm = 0.0000521 (50 iterations in 0.066s)
[t-SNE] Iteration 900: error = 1.4498093, gradient norm = 0.0001109 (50 iterations in 0.066s)
[t-SNE] Iteration 950: error = 1.4476138, gradient norm = 0.0004374 (50 iterations in 0.066s)
[t-SNE] Iteration 1000: error = 1.4415797, gradient norm = 0.0004279 (50 iterations in 0.067s)
[t-SNE] KL divergence after 1000 iterations: 1.441580
[t-SNE] Computed conditional probabilities for sample 698 / 698
[t-SNE] Mean sigma: 0.336983
Beginning preprocessing + Leiden
2024-03-16 20:22:07.385013 MEMORY 20.26586112
Affmat transformed
2024-03-16 20:22:07.393534 MEMORY 20.26586112
sources, targets, weights extracted
2024-03-16 20:22:07.399127 MEMORY 20.26586112
About to launch parallel Leiden runs
2024-03-16 20:22:07.405134 MEMORY 20.26586112
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    5.9s finished
Parallel Leiden runs finished
2024-03-16 20:22:13.318774 MEMORY 20.26586112
Quality: 0.4133597328944384
Quality: 0.413364994010605
Quality: 0.4135321410377975
Quality: 0.41407648651310647
Quality: 0.4147457588621923
Quality: 0.41516773320397515
Quality: 0.41537413288414393
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 649 out of 649 | elapsed:    0.3s finished
Got subclusters: Counter({0: 168, 1: 152, 2: 101, 3: 96, 4: 96, 5: 85})
On pattern 6
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 649 samples in 0.006s...
[t-SNE] Computed neighbors for 649 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 649 / 649
[t-SNE] Mean sigma: 0.315398
[t-SNE] Computed conditional probabilities in 0.049s
[t-SNE] Iteration 50: error = 72.6245956, gradient norm = 0.3850310 (50 iterations in 0.069s)
[t-SNE] Iteration 100: error = 76.1362762, gradient norm = 0.3570355 (50 iterations in 0.072s)
[t-SNE] Iteration 150: error = 73.6842270, gradient norm = 0.3966562 (50 iterations in 0.070s)
[t-SNE] Iteration 200: error = 74.7373199, gradient norm = 0.3617248 (50 iterations in 0.070s)
[t-SNE] Iteration 250: error = 75.3836288, gradient norm = 0.3725845 (50 iterations in 0.068s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 75.383629
[t-SNE] Iteration 300: error = 1.7300632, gradient norm = 0.0048243 (50 iterations in 0.065s)
[t-SNE] Iteration 350: error = 1.6500869, gradient norm = 0.0012622 (50 iterations in 0.067s)
[t-SNE] Iteration 400: error = 1.6211011, gradient norm = 0.0007149 (50 iterations in 0.064s)
[t-SNE] Iteration 450: error = 1.6081287, gradient norm = 0.0005698 (50 iterations in 0.062s)
[t-SNE] Iteration 500: error = 1.5969061, gradient norm = 0.0005474 (50 iterations in 0.065s)
[t-SNE] Iteration 550: error = 1.5838231, gradient norm = 0.0004822 (50 iterations in 0.068s)
[t-SNE] Iteration 600: error = 1.5722963, gradient norm = 0.0006458 (50 iterations in 0.067s)
[t-SNE] Iteration 650: error = 1.5593755, gradient norm = 0.0004915 (50 iterations in 0.065s)
[t-SNE] Iteration 700: error = 1.5556413, gradient norm = 0.0003382 (50 iterations in 0.065s)
[t-SNE] Iteration 750: error = 1.5518465, gradient norm = 0.0003444 (50 iterations in 0.065s)
[t-SNE] Iteration 800: error = 1.5448989, gradient norm = 0.0004363 (50 iterations in 0.067s)
[t-SNE] Iteration 850: error = 1.5432833, gradient norm = 0.0001487 (50 iterations in 0.065s)
[t-SNE] Iteration 900: error = 1.5422916, gradient norm = 0.0002035 (50 iterations in 0.068s)
[t-SNE] Iteration 950: error = 1.5390363, gradient norm = 0.0006702 (50 iterations in 0.064s)
[t-SNE] Iteration 1000: error = 1.5376340, gradient norm = 0.0001226 (50 iterations in 0.065s)
[t-SNE] KL divergence after 1000 iterations: 1.537634
[t-SNE] Computed conditional probabilities for sample 649 / 649
[t-SNE] Mean sigma: 0.315398
Beginning preprocessing + Leiden
2024-03-16 20:22:15.772164 MEMORY 20.26586112
Affmat transformed
2024-03-16 20:22:15.780314 MEMORY 20.26586112
sources, targets, weights extracted
2024-03-16 20:22:15.786089 MEMORY 20.26586112
About to launch parallel Leiden runs
2024-03-16 20:22:15.795346 MEMORY 20.26586112
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.8s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    5.9s finished
Parallel Leiden runs finished
2024-03-16 20:22:21.720726 MEMORY 20.26586112
Quality: 0.3655215498140239
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 627 out of 627 | elapsed:    0.3s finished
Got subclusters: Counter({0: 143, 1: 132, 2: 125, 3: 114, 4: 68, 5: 67})
On pattern 7
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 627 samples in 0.006s...
[t-SNE] Computed neighbors for 627 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 627 / 627
[t-SNE] Mean sigma: 0.320346
[t-SNE] Computed conditional probabilities in 0.044s
[t-SNE] Iteration 50: error = 72.7007294, gradient norm = 0.3868330 (50 iterations in 0.079s)
[t-SNE] Iteration 100: error = 76.5194321, gradient norm = 0.3692273 (50 iterations in 0.069s)
[t-SNE] Iteration 150: error = 74.7450562, gradient norm = 0.3617615 (50 iterations in 0.068s)
[t-SNE] Iteration 200: error = 73.7346649, gradient norm = 0.3963484 (50 iterations in 0.071s)
[t-SNE] Iteration 250: error = 75.5416107, gradient norm = 0.3683690 (50 iterations in 0.071s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 75.541611
[t-SNE] Iteration 300: error = 1.7113233, gradient norm = 0.0041155 (50 iterations in 0.069s)
[t-SNE] Iteration 350: error = 1.6103934, gradient norm = 0.0012177 (50 iterations in 0.066s)
[t-SNE] Iteration 400: error = 1.5588820, gradient norm = 0.0012012 (50 iterations in 0.066s)
[t-SNE] Iteration 450: error = 1.5308546, gradient norm = 0.0008162 (50 iterations in 0.065s)
[t-SNE] Iteration 500: error = 1.5173132, gradient norm = 0.0005043 (50 iterations in 0.068s)
[t-SNE] Iteration 550: error = 1.5070198, gradient norm = 0.0005674 (50 iterations in 0.068s)
[t-SNE] Iteration 600: error = 1.5024501, gradient norm = 0.0001794 (50 iterations in 0.063s)
[t-SNE] Iteration 650: error = 1.4957215, gradient norm = 0.0003315 (50 iterations in 0.063s)
[t-SNE] Iteration 700: error = 1.4902339, gradient norm = 0.0003779 (50 iterations in 0.064s)
[t-SNE] Iteration 750: error = 1.4867646, gradient norm = 0.0001599 (50 iterations in 0.063s)
[t-SNE] Iteration 800: error = 1.4866146, gradient norm = 0.0000860 (50 iterations in 0.066s)
[t-SNE] Iteration 850: error = 1.4862726, gradient norm = 0.0000610 (50 iterations in 0.064s)
[t-SNE] Iteration 900: error = 1.4861567, gradient norm = 0.0000646 (50 iterations in 0.066s)
[t-SNE] Iteration 950: error = 1.4853425, gradient norm = 0.0001048 (50 iterations in 0.063s)
[t-SNE] Iteration 1000: error = 1.4853426, gradient norm = 0.0000658 (50 iterations in 0.076s)
[t-SNE] KL divergence after 1000 iterations: 1.485343
[t-SNE] Computed conditional probabilities for sample 627 / 627
[t-SNE] Mean sigma: 0.320346
Beginning preprocessing + Leiden
2024-03-16 20:22:24.110014 MEMORY 20.26586112
Affmat transformed
2024-03-16 20:22:24.118767 MEMORY 20.26586112
sources, targets, weights extracted
2024-03-16 20:22:24.124198 MEMORY 20.26586112
About to launch parallel Leiden runs
2024-03-16 20:22:24.129731 MEMORY 20.26586112
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.6s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    5.1s finished
Parallel Leiden runs finished
2024-03-16 20:22:29.277300 MEMORY 20.26586112
Quality: 0.36934553306594775
Quality: 0.3709823127357883
Quality: 0.37105194589725715
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 542 out of 542 | elapsed:    0.2s finished
Got subclusters: Counter({0: 165, 1: 129, 2: 106, 3: 84, 4: 77, 5: 66})
On pattern 8
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 542 samples in 0.005s...
[t-SNE] Computed neighbors for 542 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 542 / 542
[t-SNE] Mean sigma: 0.327207
[t-SNE] Computed conditional probabilities in 0.038s
[t-SNE] Iteration 50: error = 72.9919968, gradient norm = 0.4115429 (50 iterations in 0.065s)
[t-SNE] Iteration 100: error = 75.6593704, gradient norm = 0.3857654 (50 iterations in 0.065s)
[t-SNE] Iteration 150: error = 73.7573776, gradient norm = 0.4062516 (50 iterations in 0.065s)
[t-SNE] Iteration 200: error = 75.7559662, gradient norm = 0.3772469 (50 iterations in 0.064s)
[t-SNE] Iteration 250: error = 77.0286484, gradient norm = 0.3533990 (50 iterations in 0.064s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 77.028648
[t-SNE] Iteration 300: error = 1.4499300, gradient norm = 0.0033098 (50 iterations in 0.067s)
[t-SNE] Iteration 350: error = 1.3881335, gradient norm = 0.0010913 (50 iterations in 0.062s)
[t-SNE] Iteration 400: error = 1.3644794, gradient norm = 0.0007595 (50 iterations in 0.077s)
[t-SNE] Iteration 450: error = 1.3498484, gradient norm = 0.0007385 (50 iterations in 0.062s)
[t-SNE] Iteration 500: error = 1.3407178, gradient norm = 0.0006071 (50 iterations in 0.063s)
[t-SNE] Iteration 550: error = 1.3345157, gradient norm = 0.0005198 (50 iterations in 0.065s)
[t-SNE] Iteration 600: error = 1.3333195, gradient norm = 0.0002025 (50 iterations in 0.063s)
[t-SNE] Iteration 650: error = 1.3284770, gradient norm = 0.0004024 (50 iterations in 0.061s)
[t-SNE] Iteration 700: error = 1.3269892, gradient norm = 0.0001358 (50 iterations in 0.063s)
[t-SNE] Iteration 750: error = 1.3262966, gradient norm = 0.0001089 (50 iterations in 0.064s)
[t-SNE] Iteration 800: error = 1.3197061, gradient norm = 0.0003069 (50 iterations in 0.060s)
[t-SNE] Iteration 850: error = 1.3186535, gradient norm = 0.0001796 (50 iterations in 0.062s)
[t-SNE] Iteration 900: error = 1.3160979, gradient norm = 0.0003345 (50 iterations in 0.061s)
[t-SNE] Iteration 950: error = 1.3154074, gradient norm = 0.0000702 (50 iterations in 0.063s)
[t-SNE] Iteration 1000: error = 1.3153391, gradient norm = 0.0000518 (50 iterations in 0.065s)
[t-SNE] KL divergence after 1000 iterations: 1.315339
[t-SNE] Computed conditional probabilities for sample 542 / 542
[t-SNE] Mean sigma: 0.327207
Beginning preprocessing + Leiden
2024-03-16 20:22:31.509887 MEMORY 20.26586112
Affmat transformed
2024-03-16 20:22:31.517428 MEMORY 20.26586112
sources, targets, weights extracted
2024-03-16 20:22:31.521952 MEMORY 20.26586112
About to launch parallel Leiden runs
2024-03-16 20:22:31.527890 MEMORY 20.26586112
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.5s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    4.5s finished
Parallel Leiden runs finished
2024-03-16 20:22:36.000169 MEMORY 20.26586112
Quality: 0.3605939377967852
Quality: 0.3609050413748581
Quality: 0.3609680032263561
Quality: 0.36097274695630915
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 534 out of 534 | elapsed:    0.2s finished
Got subclusters: Counter({0: 116, 1: 89, 2: 86, 4: 67, 3: 67, 5: 60, 6: 57})
On pattern 9
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 534 samples in 0.004s...
[t-SNE] Computed neighbors for 534 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 534 / 534
[t-SNE] Mean sigma: 0.335314
[t-SNE] Computed conditional probabilities in 0.037s
[t-SNE] Iteration 50: error = 70.7731094, gradient norm = 0.4353672 (50 iterations in 0.067s)
[t-SNE] Iteration 100: error = 72.3551407, gradient norm = 0.4131485 (50 iterations in 0.060s)
[t-SNE] Iteration 150: error = 76.8197098, gradient norm = 0.3654949 (50 iterations in 0.059s)
[t-SNE] Iteration 200: error = 73.8377838, gradient norm = 0.4044425 (50 iterations in 0.063s)
[t-SNE] Iteration 250: error = 77.5111542, gradient norm = 0.3595957 (50 iterations in 0.061s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 77.511154
[t-SNE] Iteration 300: error = 1.5947243, gradient norm = 0.0043092 (50 iterations in 0.058s)
[t-SNE] Iteration 350: error = 1.4706540, gradient norm = 0.0025473 (50 iterations in 0.059s)
[t-SNE] Iteration 400: error = 1.4254792, gradient norm = 0.0010956 (50 iterations in 0.057s)
[t-SNE] Iteration 450: error = 1.4019217, gradient norm = 0.0009991 (50 iterations in 0.057s)
[t-SNE] Iteration 500: error = 1.3933820, gradient norm = 0.0003649 (50 iterations in 0.056s)
[t-SNE] Iteration 550: error = 1.3901739, gradient norm = 0.0004891 (50 iterations in 0.056s)
[t-SNE] Iteration 600: error = 1.3850724, gradient norm = 0.0002104 (50 iterations in 0.057s)
[t-SNE] Iteration 650: error = 1.3809030, gradient norm = 0.0002797 (50 iterations in 0.058s)
[t-SNE] Iteration 700: error = 1.3782336, gradient norm = 0.0002160 (50 iterations in 0.056s)
[t-SNE] Iteration 750: error = 1.3777573, gradient norm = 0.0001774 (50 iterations in 0.058s)
[t-SNE] Iteration 800: error = 1.3744901, gradient norm = 0.0002187 (50 iterations in 0.056s)
[t-SNE] Iteration 850: error = 1.3724920, gradient norm = 0.0001205 (50 iterations in 0.058s)
[t-SNE] Iteration 900: error = 1.3696485, gradient norm = 0.0002313 (50 iterations in 0.056s)
[t-SNE] Iteration 950: error = 1.3657972, gradient norm = 0.0005629 (50 iterations in 0.057s)
[t-SNE] Iteration 1000: error = 1.3638045, gradient norm = 0.0001327 (50 iterations in 0.058s)
[t-SNE] KL divergence after 1000 iterations: 1.363804
[t-SNE] Computed conditional probabilities for sample 534 / 534
[t-SNE] Mean sigma: 0.335314
Beginning preprocessing + Leiden
2024-03-16 20:22:37.985673 MEMORY 20.26586112
Affmat transformed
2024-03-16 20:22:37.992790 MEMORY 20.26586112
sources, targets, weights extracted
2024-03-16 20:22:37.996984 MEMORY 20.26586112
About to launch parallel Leiden runs
2024-03-16 20:22:38.002448 MEMORY 20.26586112
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.4s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    4.2s finished
Parallel Leiden runs finished
2024-03-16 20:22:42.253263 MEMORY 20.26586112
Quality: 0.37089123618884995
Quality: 0.37280113680081073
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 384 out of 384 | elapsed:    0.1s finished
Got subclusters: Counter({0: 108, 1: 106, 2: 90, 3: 82, 4: 75, 5: 73})
On pattern 10
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 384 samples in 0.004s...
[t-SNE] Computed neighbors for 384 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 384 / 384
[t-SNE] Mean sigma: 0.273077
[t-SNE] Computed conditional probabilities in 0.027s
[t-SNE] Iteration 50: error = 67.7467499, gradient norm = 0.4664246 (50 iterations in 0.054s)
[t-SNE] Iteration 100: error = 66.1865463, gradient norm = 0.4721917 (50 iterations in 0.055s)
[t-SNE] Iteration 150: error = 70.4794312, gradient norm = 0.4320885 (50 iterations in 0.054s)
[t-SNE] Iteration 200: error = 69.2030411, gradient norm = 0.4529725 (50 iterations in 0.050s)
[t-SNE] Iteration 250: error = 71.5087433, gradient norm = 0.4345458 (50 iterations in 0.050s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 71.508743
[t-SNE] Iteration 300: error = 1.2666061, gradient norm = 0.0048152 (50 iterations in 0.051s)
[t-SNE] Iteration 350: error = 1.1024202, gradient norm = 0.0027637 (50 iterations in 0.052s)
[t-SNE] Iteration 400: error = 1.0338960, gradient norm = 0.0014581 (50 iterations in 0.051s)
[t-SNE] Iteration 450: error = 1.0142567, gradient norm = 0.0008330 (50 iterations in 0.050s)
[t-SNE] Iteration 500: error = 1.0060633, gradient norm = 0.0003973 (50 iterations in 0.050s)
[t-SNE] Iteration 550: error = 1.0051272, gradient norm = 0.0000757 (50 iterations in 0.052s)
[t-SNE] Iteration 600: error = 1.0049089, gradient norm = 0.0001060 (50 iterations in 0.050s)
[t-SNE] Iteration 650: error = 1.0049298, gradient norm = 0.0001061 (50 iterations in 0.051s)
[t-SNE] Iteration 700: error = 1.0048797, gradient norm = 0.0000955 (50 iterations in 0.052s)
[t-SNE] Iteration 750: error = 1.0049554, gradient norm = 0.0000863 (50 iterations in 0.051s)
[t-SNE] Iteration 800: error = 1.0051600, gradient norm = 0.0000937 (50 iterations in 0.052s)
[t-SNE] Iteration 850: error = 1.0042330, gradient norm = 0.0005185 (50 iterations in 0.051s)
[t-SNE] Iteration 900: error = 0.9978279, gradient norm = 0.0002288 (50 iterations in 0.050s)
[t-SNE] Iteration 950: error = 0.9958218, gradient norm = 0.0002166 (50 iterations in 0.051s)
[t-SNE] Iteration 1000: error = 0.9952422, gradient norm = 0.0001073 (50 iterations in 0.050s)
[t-SNE] KL divergence after 1000 iterations: 0.995242
[t-SNE] Computed conditional probabilities for sample 384 / 384
[t-SNE] Mean sigma: 0.273078
Beginning preprocessing + Leiden
2024-03-16 20:22:43.904690 MEMORY 20.26586112
Affmat transformed
2024-03-16 20:22:43.909865 MEMORY 20.26586112
sources, targets, weights extracted
2024-03-16 20:22:43.913298 MEMORY 20.26586112
About to launch parallel Leiden runs
2024-03-16 20:22:43.918724 MEMORY 20.26586112
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.1s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    3.6s finished
Parallel Leiden runs finished
2024-03-16 20:22:47.494812 MEMORY 20.26586112
Quality: 0.3285516932433487
Quality: 0.32878379793602985
Quality: 0.33024474690767
Quality: 0.3305229393714021
Quality: 0.3317224296528833
Quality: 0.33225131202927993
Quality: 0.3326492825202646
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 320 out of 367 | elapsed:    0.1s remaining:    0.0s
[Parallel(n_jobs=24)]: Done 367 out of 367 | elapsed:    0.1s finished
Got subclusters: Counter({0: 103, 1: 99, 2: 60, 3: 57, 4: 50, 5: 15})
On pattern 11
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 367 samples in 0.003s...
[t-SNE] Computed neighbors for 367 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 367 / 367
[t-SNE] Mean sigma: 0.352674
[t-SNE] Computed conditional probabilities in 0.026s
[t-SNE] Iteration 50: error = 67.2223587, gradient norm = 0.4970855 (50 iterations in 0.071s)
[t-SNE] Iteration 100: error = 71.8540192, gradient norm = 0.4245553 (50 iterations in 0.048s)
[t-SNE] Iteration 150: error = 70.0808563, gradient norm = 0.4897372 (50 iterations in 0.048s)
[t-SNE] Iteration 200: error = 74.1398773, gradient norm = 0.4141266 (50 iterations in 0.054s)
[t-SNE] Iteration 250: error = 72.9653549, gradient norm = 0.4237548 (50 iterations in 0.051s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 72.965355
[t-SNE] Iteration 300: error = 1.4608667, gradient norm = 0.0045504 (50 iterations in 0.053s)
[t-SNE] Iteration 350: error = 1.2891612, gradient norm = 0.0026475 (50 iterations in 0.051s)
[t-SNE] Iteration 400: error = 1.2197819, gradient norm = 0.0018077 (50 iterations in 0.048s)
[t-SNE] Iteration 450: error = 1.1593020, gradient norm = 0.0009584 (50 iterations in 0.049s)
[t-SNE] Iteration 500: error = 1.1560884, gradient norm = 0.0001851 (50 iterations in 0.047s)
[t-SNE] Iteration 550: error = 1.1542062, gradient norm = 0.0003596 (50 iterations in 0.050s)
[t-SNE] Iteration 600: error = 1.1482224, gradient norm = 0.0008314 (50 iterations in 0.046s)
[t-SNE] Iteration 650: error = 1.1394150, gradient norm = 0.0004271 (50 iterations in 0.045s)
[t-SNE] Iteration 700: error = 1.1297330, gradient norm = 0.0008774 (50 iterations in 0.045s)
[t-SNE] Iteration 750: error = 1.1262169, gradient norm = 0.0002362 (50 iterations in 0.044s)
[t-SNE] Iteration 800: error = 1.1256443, gradient norm = 0.0001286 (50 iterations in 0.044s)
[t-SNE] Iteration 850: error = 1.1256856, gradient norm = 0.0001063 (50 iterations in 0.045s)
[t-SNE] Iteration 900: error = 1.1256406, gradient norm = 0.0000915 (50 iterations in 0.046s)
[t-SNE] Iteration 950: error = 1.1258208, gradient norm = 0.0000559 (50 iterations in 0.047s)
[t-SNE] Iteration 1000: error = 1.1258087, gradient norm = 0.0000332 (50 iterations in 0.046s)
[t-SNE] KL divergence after 1000 iterations: 1.125809
[t-SNE] Computed conditional probabilities for sample 367 / 367
[t-SNE] Mean sigma: 0.352674
Beginning preprocessing + Leiden
2024-03-16 20:22:49.053106 MEMORY 20.26586112
Affmat transformed
2024-03-16 20:22:49.058160 MEMORY 20.26586112
sources, targets, weights extracted
2024-03-16 20:22:49.061091 MEMORY 20.26586112
About to launch parallel Leiden runs
2024-03-16 20:22:49.078276 MEMORY 20.26586112
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.2s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    3.3s finished
Parallel Leiden runs finished
2024-03-16 20:22:52.424064 MEMORY 20.26586112
Quality: 0.3273774231506507
Quality: 0.32756134111057195
Quality: 0.3280807900689498
Quality: 0.32833316309905636
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 315 out of 315 | elapsed:    0.1s finished
Got subclusters: Counter({0: 79, 1: 73, 2: 64, 3: 52, 4: 52, 5: 31, 6: 9, 7: 7})
On pattern 12
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 315 samples in 0.003s...
[t-SNE] Computed neighbors for 315 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 315 / 315
[t-SNE] Mean sigma: 0.372603
[t-SNE] Computed conditional probabilities in 0.022s
[t-SNE] Iteration 50: error = 63.6681824, gradient norm = 0.4905108 (50 iterations in 0.048s)
[t-SNE] Iteration 100: error = 62.5189476, gradient norm = 0.5202154 (50 iterations in 0.044s)
[t-SNE] Iteration 150: error = 64.4469681, gradient norm = 0.4769194 (50 iterations in 0.048s)
[t-SNE] Iteration 200: error = 67.3215027, gradient norm = 0.4872100 (50 iterations in 0.045s)
[t-SNE] Iteration 250: error = 63.5907822, gradient norm = 0.4959590 (50 iterations in 0.046s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 63.590782
[t-SNE] Iteration 300: error = 1.2720382, gradient norm = 0.0047941 (50 iterations in 0.043s)
[t-SNE] Iteration 350: error = 1.1039398, gradient norm = 0.0029541 (50 iterations in 0.044s)
[t-SNE] Iteration 400: error = 1.0449059, gradient norm = 0.0020800 (50 iterations in 0.044s)
[t-SNE] Iteration 450: error = 1.0281200, gradient norm = 0.0009337 (50 iterations in 0.044s)
[t-SNE] Iteration 500: error = 1.0195976, gradient norm = 0.0014807 (50 iterations in 0.044s)
[t-SNE] Iteration 550: error = 1.0012634, gradient norm = 0.0009028 (50 iterations in 0.044s)
[t-SNE] Iteration 600: error = 0.9926254, gradient norm = 0.0005400 (50 iterations in 0.046s)
[t-SNE] Iteration 650: error = 0.9914793, gradient norm = 0.0002286 (50 iterations in 0.044s)
[t-SNE] Iteration 700: error = 0.9915337, gradient norm = 0.0000800 (50 iterations in 0.044s)
[t-SNE] Iteration 750: error = 0.9907182, gradient norm = 0.0005078 (50 iterations in 0.045s)
[t-SNE] Iteration 800: error = 0.9895824, gradient norm = 0.0005696 (50 iterations in 0.043s)
[t-SNE] Iteration 850: error = 0.9894058, gradient norm = 0.0000876 (50 iterations in 0.044s)
[t-SNE] Iteration 900: error = 0.9894592, gradient norm = 0.0001493 (50 iterations in 0.044s)
[t-SNE] Iteration 950: error = 0.9896081, gradient norm = 0.0001034 (50 iterations in 0.044s)
[t-SNE] Iteration 1000: error = 0.9896404, gradient norm = 0.0001217 (50 iterations in 0.044s)
[t-SNE] KL divergence after 1000 iterations: 0.989640
[t-SNE] Computed conditional probabilities for sample 315 / 315
[t-SNE] Mean sigma: 0.372603
Beginning preprocessing + Leiden
2024-03-16 20:22:53.845900 MEMORY 20.26586112
Affmat transformed
2024-03-16 20:22:53.850479 MEMORY 20.26586112
sources, targets, weights extracted
2024-03-16 20:22:53.852863 MEMORY 20.26586112
About to launch parallel Leiden runs
2024-03-16 20:22:53.857862 MEMORY 20.26586112
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.0s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.9s finished
Parallel Leiden runs finished
2024-03-16 20:22:56.788800 MEMORY 20.26586112
Quality: 0.3372257065575547
Quality: 0.3384135271708698
Quality: 0.33879166094117147
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 233 out of 280 | elapsed:    0.1s remaining:    0.0s
[Parallel(n_jobs=24)]: Done 280 out of 280 | elapsed:    0.1s finished
Got subclusters: Counter({0: 78, 1: 71, 2: 65, 3: 54, 4: 45, 5: 2})
On pattern 13
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 280 samples in 0.003s...
[t-SNE] Computed neighbors for 280 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 280 / 280
[t-SNE] Mean sigma: 0.375394
[t-SNE] Computed conditional probabilities in 0.024s
[t-SNE] Iteration 50: error = 60.3302689, gradient norm = 0.5390671 (50 iterations in 0.041s)
[t-SNE] Iteration 100: error = 61.2633247, gradient norm = 0.5232210 (50 iterations in 0.045s)
[t-SNE] Iteration 150: error = 62.3813934, gradient norm = 0.5196233 (50 iterations in 0.043s)
[t-SNE] Iteration 200: error = 66.0237198, gradient norm = 0.4992436 (50 iterations in 0.043s)
[t-SNE] Iteration 250: error = 63.5802879, gradient norm = 0.4781445 (50 iterations in 0.043s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 63.580288
[t-SNE] Iteration 300: error = 1.1450584, gradient norm = 0.0042085 (50 iterations in 0.044s)
[t-SNE] Iteration 350: error = 0.9958139, gradient norm = 0.0035237 (50 iterations in 0.042s)
[t-SNE] Iteration 400: error = 0.9616690, gradient norm = 0.0009215 (50 iterations in 0.043s)
[t-SNE] Iteration 450: error = 0.9398461, gradient norm = 0.0015797 (50 iterations in 0.040s)
[t-SNE] Iteration 500: error = 0.9323105, gradient norm = 0.0005652 (50 iterations in 0.040s)
[t-SNE] Iteration 550: error = 0.9255099, gradient norm = 0.0016088 (50 iterations in 0.041s)
[t-SNE] Iteration 600: error = 0.9234102, gradient norm = 0.0001302 (50 iterations in 0.042s)
[t-SNE] Iteration 650: error = 0.9234335, gradient norm = 0.0001135 (50 iterations in 0.041s)
[t-SNE] Iteration 700: error = 0.9233261, gradient norm = 0.0001351 (50 iterations in 0.042s)
[t-SNE] Iteration 750: error = 0.9234240, gradient norm = 0.0000896 (50 iterations in 0.040s)
[t-SNE] Iteration 800: error = 0.9235075, gradient norm = 0.0001212 (50 iterations in 0.041s)
[t-SNE] Iteration 850: error = 0.9234334, gradient norm = 0.0000602 (50 iterations in 0.040s)
[t-SNE] Iteration 900: error = 0.9235212, gradient norm = 0.0000782 (50 iterations in 0.040s)
[t-SNE] Iteration 950: error = 0.9235346, gradient norm = 0.0000654 (50 iterations in 0.039s)
[t-SNE] Iteration 1000: error = 0.9234342, gradient norm = 0.0000751 (50 iterations in 0.039s)
[t-SNE] KL divergence after 1000 iterations: 0.923434
[t-SNE] Computed conditional probabilities for sample 280 / 280
[t-SNE] Mean sigma: 0.375394
Beginning preprocessing + Leiden
2024-03-16 20:22:58.064061 MEMORY 20.26586112
Affmat transformed
2024-03-16 20:22:58.067947 MEMORY 20.26586112
sources, targets, weights extracted
2024-03-16 20:22:58.069886 MEMORY 20.26586112
About to launch parallel Leiden runs
2024-03-16 20:22:58.074810 MEMORY 20.26586112
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.9s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.7s finished
Parallel Leiden runs finished
2024-03-16 20:23:00.779782 MEMORY 20.26586112
Quality: 0.34151409140617334
Quality: 0.34900397730527355
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 232 out of 232 | elapsed:    0.1s finished
Got subclusters: Counter({0: 79, 1: 72, 2: 46, 3: 44, 4: 35, 5: 4})
On pattern 14
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 232 samples in 0.002s...
[t-SNE] Computed neighbors for 232 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 232 / 232
[t-SNE] Mean sigma: 0.371444
[t-SNE] Computed conditional probabilities in 0.016s
[t-SNE] Iteration 50: error = 61.3315964, gradient norm = 0.5167983 (50 iterations in 0.038s)
[t-SNE] Iteration 100: error = 65.6189270, gradient norm = 0.4809065 (50 iterations in 0.037s)
[t-SNE] Iteration 150: error = 63.1260490, gradient norm = 0.5279860 (50 iterations in 0.043s)
[t-SNE] Iteration 200: error = 63.0698242, gradient norm = 0.4942064 (50 iterations in 0.037s)
[t-SNE] Iteration 250: error = 65.8702698, gradient norm = 0.4521330 (50 iterations in 0.038s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 65.870270
[t-SNE] Iteration 300: error = 1.0814897, gradient norm = 0.0062480 (50 iterations in 0.035s)
[t-SNE] Iteration 350: error = 0.8425328, gradient norm = 0.0044586 (50 iterations in 0.039s)
[t-SNE] Iteration 400: error = 0.7509968, gradient norm = 0.0038414 (50 iterations in 0.041s)
[t-SNE] Iteration 450: error = 0.7414444, gradient norm = 0.0005094 (50 iterations in 0.038s)
[t-SNE] Iteration 500: error = 0.7382643, gradient norm = 0.0004924 (50 iterations in 0.035s)
[t-SNE] Iteration 550: error = 0.7344640, gradient norm = 0.0005523 (50 iterations in 0.038s)
[t-SNE] Iteration 600: error = 0.7338237, gradient norm = 0.0003911 (50 iterations in 0.036s)
[t-SNE] Iteration 650: error = 0.7340143, gradient norm = 0.0001396 (50 iterations in 0.034s)
[t-SNE] Iteration 700: error = 0.7338995, gradient norm = 0.0001707 (50 iterations in 0.036s)
[t-SNE] Iteration 750: error = 0.7340668, gradient norm = 0.0001219 (50 iterations in 0.035s)
[t-SNE] Iteration 800: error = 0.7340769, gradient norm = 0.0001859 (50 iterations in 0.035s)
[t-SNE] Iteration 850: error = 0.7341626, gradient norm = 0.0000954 (50 iterations in 0.036s)
[t-SNE] Iteration 900: error = 0.7341803, gradient norm = 0.0000660 (50 iterations in 0.037s)
[t-SNE] Iteration 950: error = 0.7341118, gradient norm = 0.0001891 (50 iterations in 0.036s)
[t-SNE] Iteration 950: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 950 iterations: 0.734112
[t-SNE] Computed conditional probabilities for sample 232 / 232
[t-SNE] Mean sigma: 0.371444
Beginning preprocessing + Leiden
2024-03-16 20:23:01.882435 MEMORY 20.26586112
Affmat transformed
2024-03-16 20:23:01.885770 MEMORY 20.26586112
sources, targets, weights extracted
2024-03-16 20:23:01.887259 MEMORY 20.26586112
About to launch parallel Leiden runs
2024-03-16 20:23:01.892029 MEMORY 20.26586112
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.9s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.6s finished
Parallel Leiden runs finished
2024-03-16 20:23:04.503372 MEMORY 20.26586112
Quality: 0.3366041608890282
Quality: 0.33753063230598024
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 138 out of 138 | elapsed:    0.1s finished
Got subclusters: Counter({0: 67, 1: 55, 2: 52, 3: 31, 4: 27})
On pattern 15
[t-SNE] Computing 137 nearest neighbors...
[t-SNE] Indexed 138 samples in 0.001s...
[t-SNE] Computed neighbors for 138 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 138 / 138
[t-SNE] Mean sigma: 0.422052
[t-SNE] Computed conditional probabilities in 0.009s
[t-SNE] Iteration 50: error = 63.5955391, gradient norm = 0.4323937 (50 iterations in 0.032s)
[t-SNE] Iteration 100: error = 63.1671982, gradient norm = 0.4583083 (50 iterations in 0.029s)
[t-SNE] Iteration 150: error = 59.3214951, gradient norm = 0.5255917 (50 iterations in 0.030s)
[t-SNE] Iteration 200: error = 56.3542404, gradient norm = 0.5822219 (50 iterations in 0.028s)
[t-SNE] Iteration 250: error = 63.5970802, gradient norm = 0.4385170 (50 iterations in 0.029s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 63.597080
[t-SNE] Iteration 300: error = 1.0514263, gradient norm = 0.0106675 (50 iterations in 0.029s)
[t-SNE] Iteration 350: error = 0.7868375, gradient norm = 0.0085559 (50 iterations in 0.029s)
[t-SNE] Iteration 400: error = 0.4687684, gradient norm = 0.0039991 (50 iterations in 0.032s)
[t-SNE] Iteration 450: error = 0.4661158, gradient norm = 0.0003485 (50 iterations in 0.031s)
[t-SNE] Iteration 500: error = 0.4662577, gradient norm = 0.0003289 (50 iterations in 0.031s)
[t-SNE] Iteration 550: error = 0.4655636, gradient norm = 0.0003949 (50 iterations in 0.031s)
[t-SNE] Iteration 600: error = 0.4657297, gradient norm = 0.0002197 (50 iterations in 0.032s)
[t-SNE] Iteration 650: error = 0.4659114, gradient norm = 0.0003072 (50 iterations in 0.034s)
[t-SNE] Iteration 700: error = 0.4657491, gradient norm = 0.0002722 (50 iterations in 0.032s)
[t-SNE] Iteration 750: error = 0.4657218, gradient norm = 0.0002740 (50 iterations in 0.032s)
[t-SNE] Iteration 800: error = 0.4659095, gradient norm = 0.0003165 (50 iterations in 0.034s)
[t-SNE] Iteration 850: error = 0.4658573, gradient norm = 0.0003879 (50 iterations in 0.035s)
[t-SNE] Iteration 900: error = 0.4658167, gradient norm = 0.0003722 (50 iterations in 0.033s)
[t-SNE] Iteration 900: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 900 iterations: 0.465817
[t-SNE] Computed conditional probabilities for sample 138 / 138
[t-SNE] Mean sigma: 0.422052
Beginning preprocessing + Leiden
2024-03-16 20:23:05.298438 MEMORY 20.26586112
Affmat transformed
2024-03-16 20:23:05.300430 MEMORY 20.26586112
sources, targets, weights extracted
2024-03-16 20:23:05.301208 MEMORY 20.26586112
About to launch parallel Leiden runs
2024-03-16 20:23:05.305993 MEMORY 20.26586112
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.8s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.1s finished
Parallel Leiden runs finished
2024-03-16 20:23:07.414344 MEMORY 20.26586112
Quality: 0.22743284036932035
Quality: 0.22784282652448393
Quality: 0.22825844087972777
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  74 out of 121 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=24)]: Done 121 out of 121 | elapsed:    0.0s finished
Got subclusters: Counter({0: 31, 1: 30, 2: 25, 3: 25, 4: 14, 5: 13})
On pattern 16
[t-SNE] Computing 120 nearest neighbors...
[t-SNE] Indexed 121 samples in 0.002s...
[t-SNE] Computed neighbors for 121 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 121 / 121
[t-SNE] Mean sigma: 0.467243
[t-SNE] Computed conditional probabilities in 0.007s
[t-SNE] Iteration 50: error = 59.3159637, gradient norm = 0.5121278 (50 iterations in 0.057s)
[t-SNE] Iteration 100: error = 53.9581184, gradient norm = 0.5328813 (50 iterations in 0.026s)
[t-SNE] Iteration 150: error = 55.6833763, gradient norm = 0.5252319 (50 iterations in 0.024s)
[t-SNE] Iteration 200: error = 57.0674782, gradient norm = 0.4459645 (50 iterations in 0.026s)
[t-SNE] Iteration 250: error = 52.5079308, gradient norm = 0.5814192 (50 iterations in 0.025s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 52.507931
[t-SNE] Iteration 300: error = 0.8357160, gradient norm = 0.0120470 (50 iterations in 0.024s)
[t-SNE] Iteration 350: error = 0.4583037, gradient norm = 0.0048799 (50 iterations in 0.025s)
[t-SNE] Iteration 400: error = 0.4560785, gradient norm = 0.0004668 (50 iterations in 0.025s)
[t-SNE] Iteration 450: error = 0.4429438, gradient norm = 0.0014736 (50 iterations in 0.026s)
[t-SNE] Iteration 500: error = 0.4427055, gradient norm = 0.0002573 (50 iterations in 0.026s)
[t-SNE] Iteration 550: error = 0.4430366, gradient norm = 0.0002512 (50 iterations in 0.026s)
[t-SNE] Iteration 600: error = 0.4430314, gradient norm = 0.0002872 (50 iterations in 0.025s)
[t-SNE] Iteration 650: error = 0.4433812, gradient norm = 0.0003094 (50 iterations in 0.026s)
[t-SNE] Iteration 700: error = 0.4428680, gradient norm = 0.0003576 (50 iterations in 0.025s)
[t-SNE] Iteration 750: error = 0.4430974, gradient norm = 0.0003128 (50 iterations in 0.025s)
[t-SNE] Iteration 800: error = 0.4431282, gradient norm = 0.0003711 (50 iterations in 0.024s)
[t-SNE] Iteration 850: error = 0.4430362, gradient norm = 0.0001961 (50 iterations in 0.025s)
[t-SNE] Iteration 850: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 850 iterations: 0.443036
[t-SNE] Computed conditional probabilities for sample 121 / 121
[t-SNE] Mean sigma: 0.467243
Beginning preprocessing + Leiden
2024-03-16 20:23:08.057050 MEMORY 20.26586112
Affmat transformed
2024-03-16 20:23:08.059023 MEMORY 20.26586112
sources, targets, weights extracted
2024-03-16 20:23:08.059857 MEMORY 20.26586112
About to launch parallel Leiden runs
2024-03-16 20:23:08.063994 MEMORY 20.26586112
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.0s finished
Parallel Leiden runs finished
2024-03-16 20:23:10.059622 MEMORY 20.26586112
Quality: 0.22374776678582453
Quality: 0.22412433890279765
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  60 out of 107 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=24)]: Done 107 out of 107 | elapsed:    0.0s finished
Got subclusters: Counter({0: 36, 1: 26, 2: 25, 3: 24, 4: 10})
On pattern 17
[t-SNE] Computing 106 nearest neighbors...
[t-SNE] Indexed 107 samples in 0.001s...
[t-SNE] Computed neighbors for 107 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 107 / 107
[t-SNE] Mean sigma: 0.462840
[t-SNE] Computed conditional probabilities in 0.006s
[t-SNE] Iteration 50: error = 56.8685913, gradient norm = 0.5127473 (50 iterations in 0.027s)
[t-SNE] Iteration 100: error = 58.1261482, gradient norm = 0.5040705 (50 iterations in 0.024s)
[t-SNE] Iteration 150: error = 53.9736633, gradient norm = 0.5343044 (50 iterations in 0.028s)
[t-SNE] Iteration 200: error = 54.0114212, gradient norm = 0.5315134 (50 iterations in 0.022s)
[t-SNE] Iteration 250: error = 56.4673653, gradient norm = 0.4738670 (50 iterations in 0.027s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 56.467365
[t-SNE] Iteration 300: error = 0.6434495, gradient norm = 0.0118064 (50 iterations in 0.023s)
[t-SNE] Iteration 350: error = 0.3376264, gradient norm = 0.0043409 (50 iterations in 0.022s)
[t-SNE] Iteration 400: error = 0.3367882, gradient norm = 0.0008724 (50 iterations in 0.025s)
[t-SNE] Iteration 450: error = 0.3367514, gradient norm = 0.0006745 (50 iterations in 0.023s)
[t-SNE] Iteration 500: error = 0.3367384, gradient norm = 0.0004873 (50 iterations in 0.024s)
[t-SNE] Iteration 550: error = 0.3366796, gradient norm = 0.0004979 (50 iterations in 0.024s)
[t-SNE] Iteration 600: error = 0.3367043, gradient norm = 0.0010767 (50 iterations in 0.025s)
[t-SNE] Iteration 650: error = 0.3366909, gradient norm = 0.0005018 (50 iterations in 0.023s)
[t-SNE] Iteration 700: error = 0.3367438, gradient norm = 0.0005333 (50 iterations in 0.025s)
[t-SNE] Iteration 750: error = 0.3366881, gradient norm = 0.0005780 (50 iterations in 0.025s)
[t-SNE] Iteration 800: error = 0.3367196, gradient norm = 0.0004928 (50 iterations in 0.025s)
[t-SNE] Iteration 850: error = 0.3367092, gradient norm = 0.0005307 (50 iterations in 0.023s)
[t-SNE] Iteration 900: error = 0.3367445, gradient norm = 0.0005456 (50 iterations in 0.025s)
[t-SNE] Iteration 900: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 900 iterations: 0.336744
[t-SNE] Computed conditional probabilities for sample 107 / 107
[t-SNE] Mean sigma: 0.462840
Beginning preprocessing + Leiden
2024-03-16 20:23:10.654224 MEMORY 20.26586112
Affmat transformed
2024-03-16 20:23:10.655907 MEMORY 20.26586112
sources, targets, weights extracted
2024-03-16 20:23:10.656638 MEMORY 20.26586112
About to launch parallel Leiden runs
2024-03-16 20:23:10.661983 MEMORY 20.26586112
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.9s finished
Parallel Leiden runs finished
2024-03-16 20:23:12.607975 MEMORY 20.26586112
Quality: 0.19401337845460334
Quality: 0.19432134492399789
Quality: 0.1970498177427978
Quality: 0.1978320963262943
Quality: 0.19836373752921946
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  54 out of 101 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=24)]: Done 101 out of 101 | elapsed:    0.0s finished
Got subclusters: Counter({0: 40, 1: 28, 2: 20, 3: 17, 4: 2})
On pattern 18
[t-SNE] Computing 100 nearest neighbors...
[t-SNE] Indexed 101 samples in 0.001s...
[t-SNE] Computed neighbors for 101 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 101 / 101
[t-SNE] Mean sigma: 0.448059
[t-SNE] Computed conditional probabilities in 0.005s
[t-SNE] Iteration 50: error = 50.8453712, gradient norm = 0.4620712 (50 iterations in 0.020s)
[t-SNE] Iteration 100: error = 55.1084366, gradient norm = 0.5148209 (50 iterations in 0.020s)
[t-SNE] Iteration 150: error = 54.5226593, gradient norm = 0.5545485 (50 iterations in 0.020s)
[t-SNE] Iteration 200: error = 55.9920082, gradient norm = 0.4565446 (50 iterations in 0.020s)
[t-SNE] Iteration 250: error = 56.5475349, gradient norm = 0.5654104 (50 iterations in 0.022s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 56.547535
[t-SNE] Iteration 300: error = 0.8813108, gradient norm = 0.0063356 (50 iterations in 0.020s)
[t-SNE] Iteration 350: error = 0.7113678, gradient norm = 0.0047587 (50 iterations in 0.020s)
[t-SNE] Iteration 400: error = 0.3644153, gradient norm = 0.0186266 (50 iterations in 0.021s)
[t-SNE] Iteration 450: error = 0.3284614, gradient norm = 0.0015367 (50 iterations in 0.020s)
[t-SNE] Iteration 500: error = 0.3283817, gradient norm = 0.0002356 (50 iterations in 0.021s)
[t-SNE] Iteration 550: error = 0.3283750, gradient norm = 0.0002228 (50 iterations in 0.018s)
[t-SNE] Iteration 600: error = 0.3283408, gradient norm = 0.0002004 (50 iterations in 0.020s)
[t-SNE] Iteration 650: error = 0.3283488, gradient norm = 0.0002114 (50 iterations in 0.020s)
[t-SNE] Iteration 700: error = 0.3283390, gradient norm = 0.0002163 (50 iterations in 0.019s)
[t-SNE] Iteration 750: error = 0.3283612, gradient norm = 0.0002174 (50 iterations in 0.019s)
[t-SNE] Iteration 800: error = 0.3283416, gradient norm = 0.0002263 (50 iterations in 0.019s)
[t-SNE] Iteration 850: error = 0.3283584, gradient norm = 0.0001662 (50 iterations in 0.020s)
[t-SNE] Iteration 900: error = 0.3283413, gradient norm = 0.0002094 (50 iterations in 0.021s)
[t-SNE] Iteration 950: error = 0.3283618, gradient norm = 0.0001764 (50 iterations in 0.020s)
[t-SNE] Iteration 1000: error = 0.3283726, gradient norm = 0.0002207 (50 iterations in 0.020s)
[t-SNE] KL divergence after 1000 iterations: 0.328373
[t-SNE] Computed conditional probabilities for sample 101 / 101
[t-SNE] Mean sigma: 0.448059
Beginning preprocessing + Leiden
2024-03-16 20:23:13.146630 MEMORY 20.26586112
Affmat transformed
2024-03-16 20:23:13.148093 MEMORY 20.26586112
sources, targets, weights extracted
2024-03-16 20:23:13.148681 MEMORY 20.26586112
About to launch parallel Leiden runs
2024-03-16 20:23:13.153554 MEMORY 20.26586112
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.8s finished
Parallel Leiden runs finished
2024-03-16 20:23:14.996755 MEMORY 20.26586112
Quality: 0.1778040212493091
Quality: 0.17981563843255977
Quality: 0.17995340892644449
Quality: 0.17999066991246812
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  50 out of  97 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=24)]: Done  97 out of  97 | elapsed:    0.0s finished
Got subclusters: Counter({0: 28, 1: 28, 2: 25, 3: 20})
On pattern 19
[t-SNE] Computing 96 nearest neighbors...
[t-SNE] Indexed 97 samples in 0.001s...
[t-SNE] Computed neighbors for 97 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 97 / 97
[t-SNE] Mean sigma: 0.462462
[t-SNE] Computed conditional probabilities in 0.004s
[t-SNE] Iteration 50: error = 52.8701210, gradient norm = 0.5085351 (50 iterations in 0.023s)
[t-SNE] Iteration 100: error = 48.2396317, gradient norm = 0.6036796 (50 iterations in 0.021s)
[t-SNE] Iteration 150: error = 51.3932304, gradient norm = 0.5252658 (50 iterations in 0.022s)
[t-SNE] Iteration 200: error = 53.0682259, gradient norm = 0.5510865 (50 iterations in 0.023s)
[t-SNE] Iteration 250: error = 52.0244331, gradient norm = 0.4528693 (50 iterations in 0.021s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 52.024433
[t-SNE] Iteration 300: error = 0.6520247, gradient norm = 0.0114488 (50 iterations in 0.022s)
[t-SNE] Iteration 350: error = 0.3157940, gradient norm = 0.0091408 (50 iterations in 0.020s)
[t-SNE] Iteration 400: error = 0.3115005, gradient norm = 0.0011569 (50 iterations in 0.021s)
[t-SNE] Iteration 450: error = 0.3113327, gradient norm = 0.0009647 (50 iterations in 0.021s)
[t-SNE] Iteration 500: error = 0.3114425, gradient norm = 0.0008788 (50 iterations in 0.021s)
[t-SNE] Iteration 550: error = 0.3114220, gradient norm = 0.0009426 (50 iterations in 0.022s)
[t-SNE] Iteration 600: error = 0.3115857, gradient norm = 0.0011314 (50 iterations in 0.020s)
[t-SNE] Iteration 650: error = 0.3116635, gradient norm = 0.0010618 (50 iterations in 0.021s)
[t-SNE] Iteration 700: error = 0.3114986, gradient norm = 0.0014173 (50 iterations in 0.022s)
[t-SNE] Iteration 750: error = 0.3116003, gradient norm = 0.0010711 (50 iterations in 0.020s)
[t-SNE] Iteration 800: error = 0.3118332, gradient norm = 0.0010316 (50 iterations in 0.024s)
[t-SNE] Iteration 800: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 800 iterations: 0.311833
[t-SNE] Computed conditional probabilities for sample 97 / 97
[t-SNE] Mean sigma: 0.462462
Beginning preprocessing + Leiden
2024-03-16 20:23:15.464632 MEMORY 20.26586112
Affmat transformed
2024-03-16 20:23:15.466081 MEMORY 20.26586112
sources, targets, weights extracted
2024-03-16 20:23:15.466715 MEMORY 20.26586112
About to launch parallel Leiden runs
2024-03-16 20:23:15.471368 MEMORY 20.26586112
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.8s finished
Parallel Leiden runs finished
2024-03-16 20:23:17.319772 MEMORY 20.26586112
Quality: 0.22014701984724738
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done  38 out of  42 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=24)]: Done  42 out of  42 | elapsed:    0.0s finished
Got subclusters: Counter({0: 31, 1: 28, 2: 18, 3: 13, 4: 7})
On pattern 20
[t-SNE] Computing 41 nearest neighbors...
[t-SNE] Indexed 42 samples in 0.000s...
[t-SNE] Computed neighbors for 42 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 42 / 42
[t-SNE] Mean sigma: 8.000000
[t-SNE] Computed conditional probabilities in 0.001s
[t-SNE] Iteration 50: error = 40.7868652, gradient norm = 0.5610633 (50 iterations in 0.042s)
[t-SNE] Iteration 100: error = 44.5077286, gradient norm = 0.5619852 (50 iterations in 0.013s)
[t-SNE] Iteration 150: error = 45.2425537, gradient norm = 0.5978425 (50 iterations in 0.010s)
[t-SNE] Iteration 200: error = 42.1921997, gradient norm = 0.4034859 (50 iterations in 0.010s)
[t-SNE] Iteration 250: error = 42.9351196, gradient norm = 0.7036167 (50 iterations in 0.011s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 42.935120
[t-SNE] Iteration 300: error = 0.7489613, gradient norm = 0.0013135 (50 iterations in 0.011s)
[t-SNE] Iteration 350: error = 0.6303667, gradient norm = 0.0003982 (50 iterations in 0.012s)
[t-SNE] Iteration 400: error = 0.5821478, gradient norm = 0.0001558 (50 iterations in 0.010s)
[t-SNE] Iteration 450: error = 0.5774258, gradient norm = 0.0000497 (50 iterations in 0.010s)
[t-SNE] Iteration 500: error = 0.5762917, gradient norm = 0.0000459 (50 iterations in 0.010s)
[t-SNE] Iteration 550: error = 0.5756474, gradient norm = 0.0000161 (50 iterations in 0.012s)
[t-SNE] Iteration 600: error = 0.5755090, gradient norm = 0.0000114 (50 iterations in 0.010s)
[t-SNE] Iteration 650: error = 0.5754212, gradient norm = 0.0000101 (50 iterations in 0.010s)
[t-SNE] Iteration 700: error = 0.5753208, gradient norm = 0.0000103 (50 iterations in 0.011s)
[t-SNE] Iteration 750: error = 0.5752687, gradient norm = 0.0000108 (50 iterations in 0.010s)
[t-SNE] Iteration 800: error = 0.5750418, gradient norm = 0.0000127 (50 iterations in 0.012s)
[t-SNE] Iteration 850: error = 0.5749322, gradient norm = 0.0000169 (50 iterations in 0.010s)
[t-SNE] Iteration 900: error = 0.5751004, gradient norm = 0.0000150 (50 iterations in 0.011s)
[t-SNE] Iteration 950: error = 0.5750573, gradient norm = 0.0000155 (50 iterations in 0.010s)
[t-SNE] Iteration 1000: error = 0.5749760, gradient norm = 0.0000168 (50 iterations in 0.011s)
[t-SNE] KL divergence after 1000 iterations: 0.574976
[t-SNE] Computed conditional probabilities for sample 42 / 42
[t-SNE] Mean sigma: 1125899906842624.000000
Beginning preprocessing + Leiden
2024-03-16 20:23:17.618057 MEMORY 20.26586112
Affmat transformed
2024-03-16 20:23:17.618809 MEMORY 20.26586112
sources, targets, weights extracted
2024-03-16 20:23:17.619141 MEMORY 20.26586112
About to launch parallel Leiden runs
2024-03-16 20:23:17.633244 MEMORY 20.26586112
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.6s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.7s finished
Parallel Leiden runs finished
2024-03-16 20:23:19.373148 MEMORY 20.26586112
Quality: -1.905142710256783e-13
Got subclusters: Counter({0: 42})
On metacluster 0
Metacluster size 105959 limited to 20000
Relevant tasks:  ('head', 'testis')
Relevant signs:  (1, 1)
TfModiscoSeqletsToPatternsFactory: seed=1234
(Round 1) num seqlets: 20000
(Round 1) Computing coarse affmat
2024-03-16 20:23:24.601177 MEMORY 20.123148288
Beginning embedding computation
MEMORY 20.123148288
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 152 tasks      | elapsed:    1.9s
[Parallel(n_jobs=24)]: Done 402 tasks      | elapsed:    4.7s
[Parallel(n_jobs=24)]: Done 752 tasks      | elapsed:    8.5s
[Parallel(n_jobs=24)]: Done 1202 tasks      | elapsed:   13.5s
[Parallel(n_jobs=24)]: Done 1752 tasks      | elapsed:   19.6s
[Parallel(n_jobs=24)]: Done 2402 tasks      | elapsed:   26.6s
[Parallel(n_jobs=24)]: Done 3152 tasks      | elapsed:   34.6s
[Parallel(n_jobs=24)]: Done 4002 tasks      | elapsed:   43.8s
[Parallel(n_jobs=24)]: Done 4952 tasks      | elapsed:   54.2s
[Parallel(n_jobs=24)]: Done 6002 tasks      | elapsed:  1.1min
[Parallel(n_jobs=24)]: Done 7152 tasks      | elapsed:  1.3min
[Parallel(n_jobs=24)]: Done 8402 tasks      | elapsed:  1.5min
[Parallel(n_jobs=24)]: Done 9752 tasks      | elapsed:  1.8min
[Parallel(n_jobs=24)]: Done 11202 tasks      | elapsed:  2.0min
[Parallel(n_jobs=24)]: Done 12752 tasks      | elapsed:  2.3min
[Parallel(n_jobs=24)]: Done 14402 tasks      | elapsed:  2.6min
[Parallel(n_jobs=24)]: Done 16152 tasks      | elapsed:  2.9min
[Parallel(n_jobs=24)]: Done 18002 tasks      | elapsed:  3.3min
[Parallel(n_jobs=24)]: Done 19952 tasks      | elapsed:  3.6min
[Parallel(n_jobs=24)]: Done 20000 out of 20000 | elapsed:  3.6min finished
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 152 tasks      | elapsed:    1.8s
[Parallel(n_jobs=24)]: Done 402 tasks      | elapsed:    4.7s
[Parallel(n_jobs=24)]: Done 752 tasks      | elapsed:    8.5s
[Parallel(n_jobs=24)]: Done 1202 tasks      | elapsed:   13.4s
[Parallel(n_jobs=24)]: Done 1752 tasks      | elapsed:   19.4s
[Parallel(n_jobs=24)]: Done 2402 tasks      | elapsed:   26.5s
[Parallel(n_jobs=24)]: Done 3152 tasks      | elapsed:   34.7s
[Parallel(n_jobs=24)]: Done 4002 tasks      | elapsed:   44.0s
[Parallel(n_jobs=24)]: Done 4952 tasks      | elapsed:   54.4s
[Parallel(n_jobs=24)]: Done 6002 tasks      | elapsed:  1.1min
[Parallel(n_jobs=24)]: Done 7152 tasks      | elapsed:  1.3min
[Parallel(n_jobs=24)]: Done 8402 tasks      | elapsed:  1.5min
[Parallel(n_jobs=24)]: Done 9752 tasks      | elapsed:  1.8min
[Parallel(n_jobs=24)]: Done 11202 tasks      | elapsed:  2.0min
[Parallel(n_jobs=24)]: Done 12752 tasks      | elapsed:  2.3min
[Parallel(n_jobs=24)]: Done 14402 tasks      | elapsed:  2.6min
[Parallel(n_jobs=24)]: Done 16152 tasks      | elapsed:  2.9min
[Parallel(n_jobs=24)]: Done 18002 tasks      | elapsed:  3.3min
[Parallel(n_jobs=24)]: Done 19952 tasks      | elapsed:  3.6min
[Parallel(n_jobs=24)]: Done 20000 out of 20000 | elapsed:  3.6min finished
At the beginning of embedding call
2024-03-16 20:23:24.601455 MEMORY 20.123148288
before computing embeddings fwd
2024-03-16 20:23:24.611390 MEMORY 20.123148288
after computing embeddings fwd
2024-03-16 20:27:02.057174 MEMORY 20.122624
after computing embeddings rev
2024-03-16 20:30:40.967789 MEMORY 20.633329664
before computing sparse embeddings fwd
2024-03-16 20:30:40.967920 MEMORY 20.633329664
Constructing csr matrix...
csr matrix made in 2.58050537109375 s
after computing sparse embeddings fwd
2024-03-16 20:30:44.425440 MEMORY 20.725129216
before computing sparse embeddings rev
2024-03-16 20:30:44.425555 MEMORY 20.725129216
Constructing csr matrix...
csr matrix made in 2.347463369369507 s
after computing sparse embeddings rev
2024-03-16 20:30:47.671025 MEMORY 20.894785536
Finished embedding computation in 446.91 s
MEMORY 20.445995008
Starting affinity matrix computations
MEMORY 20.445995008
Batching in slices of size 3355
  0%|          | 0/6 [00:00<?, ?it/s] 17%|â–ˆâ–‹        | 1/6 [00:07<00:36,  7.23s/it] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 2/6 [00:14<00:28,  7.19s/it] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 3/6 [00:21<00:21,  7.16s/it] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 4/6 [00:28<00:14,  7.12s/it] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 5/6 [00:35<00:07,  7.09s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:42<00:00,  6.96s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:42<00:00,  7.05s/it]
Finished affinity matrix computations in 42.47 s
MEMORY 20.396634112
(Round 1) Computed coarse affmat
2024-03-16 20:31:36.366963 MEMORY 20.156100608
(Round 1) Computing affinity matrix on nearest neighbors
2024-03-16 20:31:36.367097 MEMORY 20.156100608
Launching nearest neighbors affmat calculation job
MEMORY 20.442607616
Parallel runs completed
MEMORY 20.496330752
Job completed in: 71.03 s
MEMORY 20.496134144
Launching nearest neighbors affmat calculation job
MEMORY 20.491812864
Parallel runs completed
MEMORY 20.50009088
Job completed in: 71.83 s
MEMORY 20.499968
(Round 1) Computed affinity matrix on nearest neighbors in 149.56 s
2024-03-16 20:34:05.933306 MEMORY 20.146499584
Filtered down to 18410 of 20000
(Round 1) Retained 18410 rows out of 20000 after filtering
2024-03-16 20:34:17.334327 MEMORY 20.146499584
(Round 1) Computing density adapted affmat
2024-03-16 20:34:23.002197 MEMORY 20.146499584
Symmetrizing nearest neighbors
Computing betas for density adaptation
Computing normalizing denominators
(Round 1) Computing clustering
2024-03-16 20:37:07.469785 MEMORY 20.232708096
Beginning preprocessing + Leiden
2024-03-16 20:37:07.493812 MEMORY 20.232708096
Affmat transformed
2024-03-16 20:37:07.493960 MEMORY 20.232708096
sources, targets, weights extracted
2024-03-16 20:37:08.166731 MEMORY 20.428734464
About to launch parallel Leiden runs
2024-03-16 20:37:08.321641 MEMORY 20.232712192
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:  1.7min
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:  7.3min finished
Parallel Leiden runs finished
2024-03-16 20:44:28.469050 MEMORY 20.232712192
Quality: 0.39884370401051
Quality: 0.39884910921426164
Quality: 0.39902548542206606
Got 7 clusters after round 1
Counts:
{4: 3337, 2: 3511, 0: 3764, 1: 3585, 3: 3445, 6: 237, 5: 531}
2024-03-16 20:44:28.519128 MEMORY 20.085702656
(Round 1) Aggregating seqlets in each cluster
2024-03-16 20:44:28.519223 MEMORY 20.085702656
Aggregating for cluster 0 with 3764 seqlets
2024-03-16 20:44:28.536323 MEMORY 20.085702656
Skipped 2 seqlets that went over sequence edge during flank expansion
Skipped 59 due to duplicates
Trimming eliminated 0 seqlets out of 3703
Aggregating for cluster 1 with 3585 seqlets
2024-03-16 20:44:40.635807 MEMORY 20.08612864
Removed 1 duplicate seqlets
Skipped 1 seqlets that went over sequence edge during flank expansion
Skipped 31 due to duplicates
Trimming eliminated 0 seqlets out of 3552
Removed 1 duplicate seqlets
Aggregating for cluster 2 with 3511 seqlets
2024-03-16 20:44:49.139516 MEMORY 20.08612864
Skipped 60 due to duplicates
Trimming eliminated 0 seqlets out of 3451
Aggregating for cluster 3 with 3445 seqlets
2024-03-16 20:44:57.248458 MEMORY 20.08612864
Skipped 2 seqlets that went over sequence edge during flank expansion
Skipped 14 due to duplicates
Trimming eliminated 0 seqlets out of 3429
Aggregating for cluster 4 with 3337 seqlets
2024-03-16 20:45:05.257841 MEMORY 20.08612864
Removed 3 duplicate seqlets
Removed 1 duplicate seqlets
Skipped 1 seqlets that went over the sequence edge during flank expansion
Skipped 48 due to duplicates
Trimming eliminated 0 seqlets out of 3284
Removed 7 duplicate seqlets
Aggregating for cluster 5 with 531 seqlets
2024-03-16 20:45:16.015985 MEMORY 20.08612864
Skipped 1 seqlets that went over sequence edge during flank expansion
Skipped 4 due to duplicates
Trimming eliminated 0 seqlets out of 526
Aggregating for cluster 6 with 237 seqlets
2024-03-16 20:45:17.274855 MEMORY 20.08612864
Skipped 3 due to duplicates
Trimming eliminated 0 seqlets out of 234
Dropping cluster 6 with 234 seqlets due to sign disagreement
(Round 2) num seqlets: 17928
(Round 2) Computing coarse affmat
2024-03-16 20:45:20.238448 MEMORY 20.08612864
Beginning embedding computation
MEMORY 20.08612864
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.8s
[Parallel(n_jobs=24)]: Done 2400 tasks      | elapsed:    2.9s
[Parallel(n_jobs=24)]: Done 5200 tasks      | elapsed:    5.8s
[Parallel(n_jobs=24)]: Done 8800 tasks      | elapsed:    9.5s
[Parallel(n_jobs=24)]: Done 13200 tasks      | elapsed:   13.9s
[Parallel(n_jobs=24)]: Done 17928 out of 17928 | elapsed:   18.5s finished
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 368 tasks      | elapsed:    0.8s
[Parallel(n_jobs=24)]: Done 2304 tasks      | elapsed:    2.7s
[Parallel(n_jobs=24)]: Done 5104 tasks      | elapsed:    5.5s
[Parallel(n_jobs=24)]: Done 8704 tasks      | elapsed:    9.1s
[Parallel(n_jobs=24)]: Done 13104 tasks      | elapsed:   13.5s
[Parallel(n_jobs=24)]: Done 17928 out of 17928 | elapsed:   18.2s finished
At the beginning of embedding call
2024-03-16 20:45:20.238658 MEMORY 20.08612864
before computing embeddings fwd
2024-03-16 20:45:20.247264 MEMORY 20.08612864
after computing embeddings fwd
2024-03-16 20:45:38.774390 MEMORY 20.277772288
after computing embeddings rev
2024-03-16 20:45:56.970371 MEMORY 20.996235264
before computing sparse embeddings fwd
2024-03-16 20:45:56.970460 MEMORY 20.996235264
Constructing csr matrix...
csr matrix made in 2.144428014755249 s
after computing sparse embeddings fwd
2024-03-16 20:45:59.922115 MEMORY 21.153501184
before computing sparse embeddings rev
2024-03-16 20:45:59.922192 MEMORY 21.153501184
Constructing csr matrix...
csr matrix made in 2.067340612411499 s
after computing sparse embeddings rev
2024-03-16 20:46:02.645153 MEMORY 21.211930624
Finished embedding computation in 45.93 s
MEMORY 20.592222208
Starting affinity matrix computations
MEMORY 20.59169792
Batching in slices of size 3743
  0%|          | 0/5 [00:00<?, ?it/s] 20%|â–ˆâ–ˆ        | 1/5 [00:09<00:36,  9.17s/it] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [00:17<00:25,  8.41s/it] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [00:25<00:17,  8.64s/it] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [00:34<00:08,  8.78s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [00:42<00:00,  8.32s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [00:42<00:00,  8.49s/it]
Finished affinity matrix computations in 42.58 s
MEMORY 20.6216192
(Round 2) Computed coarse affmat
2024-03-16 20:46:51.374089 MEMORY 20.40569856
(Round 2) Computing affinity matrix on nearest neighbors
2024-03-16 20:46:51.374252 MEMORY 20.40569856
Launching nearest neighbors affmat calculation job
MEMORY 20.48126976
Parallel runs completed
MEMORY 20.516114432
Job completed in: 32.37 s
MEMORY 20.5159424
Launching nearest neighbors affmat calculation job
MEMORY 20.515794944
Parallel runs completed
MEMORY 20.556931072
Job completed in: 32.92 s
MEMORY 20.556783616
(Round 2) Computed affinity matrix on nearest neighbors in 71.6 s
2024-03-16 20:48:02.976221 MEMORY 20.382511104
Not applying filtering for rounds above first round
2024-03-16 20:48:02.978917 MEMORY 20.382511104
(Round 2) Computing density adapted affmat
2024-03-16 20:48:08.847678 MEMORY 20.412690432
Symmetrizing nearest neighbors
Computing betas for density adaptation
Computing normalizing denominators
(Round 2) Computing clustering
2024-03-16 20:50:41.148547 MEMORY 20.540739584
Beginning preprocessing + Leiden
2024-03-16 20:50:41.174185 MEMORY 20.540739584
Affmat transformed
2024-03-16 20:50:41.174324 MEMORY 20.540739584
sources, targets, weights extracted
2024-03-16 20:50:41.867330 MEMORY 20.746940416
About to launch parallel Leiden runs
2024-03-16 20:50:42.020095 MEMORY 20.540739584
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:  1.2min
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:  4.5min finished
Parallel Leiden runs finished
2024-03-16 20:55:14.973470 MEMORY 20.54047744
Quality: 0.5358480020178625
Quality: 0.5358481896689682
Quality: 0.5358486406149638
Quality: 0.5358486654195589
Got 6 clusters after round 2
Counts:
{0: 3600, 2: 3509, 3: 3486, 1: 3561, 4: 3327, 5: 445}
2024-03-16 20:55:15.022447 MEMORY 20.385763328
(Round 2) Aggregating seqlets in each cluster
2024-03-16 20:55:15.022545 MEMORY 20.385763328
Aggregating for cluster 0 with 3600 seqlets
2024-03-16 20:55:15.031277 MEMORY 20.385763328
Removed 3 duplicate seqlets
Removed 2 duplicate seqlets
Skipped 47 due to duplicates
Trimming eliminated 0 seqlets out of 3548
Aggregating for cluster 1 with 3561 seqlets
2024-03-16 20:55:24.321969 MEMORY 20.38523904
Removed 2 duplicate seqlets
Skipped 16 due to duplicates
Trimming eliminated 0 seqlets out of 3543
Removed 1 duplicate seqlets
Aggregating for cluster 2 with 3509 seqlets
2024-03-16 20:55:30.931499 MEMORY 20.385411072
Skipped 30 due to duplicates
Trimming eliminated 0 seqlets out of 3479
Aggregating for cluster 3 with 3486 seqlets
2024-03-16 20:55:36.672152 MEMORY 20.385411072
Skipped 20 due to duplicates
Trimming eliminated 0 seqlets out of 3466
Removed 2 duplicate seqlets
Aggregating for cluster 4 with 3327 seqlets
2024-03-16 20:55:42.787814 MEMORY 20.385411072
Skipped 15 due to duplicates
Trimming eliminated 0 seqlets out of 3312
Aggregating for cluster 5 with 445 seqlets
2024-03-16 20:55:48.711638 MEMORY 20.385411072
Skipped 4 due to duplicates
Trimming eliminated 0 seqlets out of 441
Got 6 clusters
Splitting into subclusters...
2024-03-16 20:55:49.508471 MEMORY 20.385411072
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 2160 tasks      | elapsed:    4.1s
[Parallel(n_jobs=24)]: Done 3548 out of 3548 | elapsed:    4.8s finished
Inspecting pattern 0 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 3548
[t-SNE] Computed conditional probabilities for sample 2000 / 3548
[t-SNE] Computed conditional probabilities for sample 3000 / 3548
[t-SNE] Computed conditional probabilities for sample 3548 / 3548
[t-SNE] Mean sigma: 0.300311
Beginning preprocessing + Leiden
2024-03-16 20:55:58.522618 MEMORY 20.414132224
Affmat transformed
2024-03-16 20:55:58.564702 MEMORY 20.421603328
sources, targets, weights extracted
2024-03-16 20:55:58.595764 MEMORY 20.421681152
About to launch parallel Leiden runs
2024-03-16 20:55:58.625459 MEMORY 20.421681152
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:   13.9s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   54.7s finished
Parallel Leiden runs finished
2024-03-16 20:56:53.283926 MEMORY 20.421681152
Quality: 0.45821701815045524
Quality: 0.4591975356354064
Quality: 0.4599265413620453
Quality: 0.46168167710377944
Got subclusters: Counter({0: 769, 1: 646, 2: 631, 3: 585, 4: 419, 5: 399, 6: 87, 7: 12})
On merging iteration 1
Numbers for each pattern pre-subsample: [769, 646, 631, 585, 419, 399, 87, 12]
Numbers after subsampling: [300, 300, 300, 300, 300, 300, 87, 12]
Computing sims for pattern 0
Computed sims for pattern 0 in 2.7185466289520264 s
Computing sims for pattern 1
Computed sims for pattern 1 in 2.6752548217773438 s
Computing sims for pattern 2
Computed sims for pattern 2 in 2.6637766361236572 s
Computing sims for pattern 3
Computed sims for pattern 3 in 2.8156046867370605 s
Computing sims for pattern 4
Computed sims for pattern 4 in 2.7245032787323 s
Computing sims for pattern 5
Computed sims for pattern 5 in 2.752537250518799 s
Computing sims for pattern 6
Computed sims for pattern 6 in 1.199279546737671 s
Computing sims for pattern 7
Computed sims for pattern 7 in 0.4326658248901367 s
Cluster sizes
[769 646 631 585 419 399  87  12]
Cross-contamination matrix:
[[1.   0.76 0.71 0.75 0.66 0.65 0.65 0.72]
 [0.54 1.   0.94 0.79 0.63 0.47 0.63 0.66]
 [0.32 0.66 1.   0.72 0.43 0.27 0.54 0.49]
 [0.49 0.72 0.92 1.   0.5  0.48 0.66 0.6 ]
 [0.56 0.8  0.81 0.69 1.   0.55 0.6  0.75]
 [0.68 0.72 0.68 0.78 0.61 1.   0.67 0.64]
 [0.41 0.56 0.55 0.66 0.33 0.29 1.   0.45]
 [0.11 0.21 0.26 0.21 0.15 0.07 0.1  1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.76 0.66 0.7  0.73 0.82 0.66 0.74]
 [0.76 1.   0.88 0.85 0.81 0.8  0.77 0.77]
 [0.66 0.88 1.   0.9  0.76 0.73 0.74 0.68]
 [0.7  0.85 0.9  1.   0.73 0.79 0.73 0.68]
 [0.73 0.81 0.76 0.73 1.   0.79 0.69 0.76]
 [0.82 0.8  0.73 0.79 0.79 1.   0.7  0.77]
 [0.66 0.77 0.74 0.73 0.69 0.7  1.   0.65]
 [0.74 0.77 0.68 0.68 0.76 0.77 0.65 1.  ]]
Collapsing 2 & 3 with crosscontam 0.7213895881481482 and sim 0.8980014957019419
Collapsing 1 & 2 with crosscontam 0.6589827767901233 and sim 0.8841143409580803
Collapsing 1 & 3 with crosscontam 0.7207351516049383 and sim 0.8540716295251944
Trimming eliminated 0 seqlets out of 1216
Trimming eliminated 0 seqlets out of 1862
Unmerged patterns remapping: OrderedDict([(0, 1), (4, 2), (5, 3), (6, 4), (7, 5)])
Time spent on merging iteration: 7.155470371246338
On merging iteration 2
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 3315 tasks      | elapsed:    1.9s
[Parallel(n_jobs=24)]: Done 3495 out of 3542 | elapsed:    2.0s remaining:    0.0s
[Parallel(n_jobs=24)]: Done 3542 out of 3542 | elapsed:    2.0s finished
Numbers for each pattern pre-subsample: [1862, 769, 419, 399, 87, 12]
Numbers after subsampling: [300, 300, 300, 300, 87, 12]
Computing sims for pattern 0
Computed sims for pattern 0 in 1.9286928176879883 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.41565728187561035 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.4213218688964844 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.41094255447387695 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.1740245819091797 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.05955696105957031 s
Cluster sizes
[1862  769  419  399   87   12]
Cross-contamination matrix:
[[1.   0.59 0.68 0.57 0.77 0.76]
 [0.72 1.   0.66 0.65 0.65 0.72]
 [0.6  0.56 1.   0.55 0.6  0.75]
 [0.71 0.68 0.61 1.   0.67 0.64]
 [0.46 0.41 0.33 0.29 1.   0.45]
 [0.25 0.11 0.15 0.07 0.1  1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.75 0.79 0.79 0.8  0.73]
 [0.75 1.   0.73 0.82 0.66 0.74]
 [0.79 0.73 1.   0.79 0.69 0.76]
 [0.79 0.82 0.79 1.   0.7  0.77]
 [0.8  0.66 0.69 0.7  1.   0.65]
 [0.73 0.74 0.76 0.77 0.65 1.  ]]
Inspecting pattern 1 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 3542
[t-SNE] Computed conditional probabilities for sample 2000 / 3542
[t-SNE] Computed conditional probabilities for sample 3000 / 3542
[t-SNE] Computed conditional probabilities for sample 3542 / 3542
[t-SNE] Mean sigma: 0.327428
Beginning preprocessing + Leiden
2024-03-16 20:57:28.020337 MEMORY 20.413632512
Affmat transformed
2024-03-16 20:57:28.061621 MEMORY 20.420755456
sources, targets, weights extracted
2024-03-16 20:57:28.089055 MEMORY 20.420898816
About to launch parallel Leiden runs
2024-03-16 20:57:28.134083 MEMORY 20.420898816
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:   14.4s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   52.6s finished
Parallel Leiden runs finished
2024-03-16 20:58:20.730156 MEMORY 20.420898816
Quality: 0.4697433214223975
Quality: 0.4704043637862626
Quality: 0.47222188510991164
Quality: 0.47335046576628964
Got subclusters: Counter({0: 682, 1: 609, 2: 528, 3: 467, 4: 433, 5: 402, 6: 357, 7: 62, 8: 2})
On merging iteration 1
Numbers for each pattern pre-subsample: [682, 609, 528, 467, 433, 402, 357, 62, 2]
Numbers after subsampling: [300, 300, 300, 300, 300, 300, 300, 62, 2]
Computing sims for pattern 0
Computed sims for pattern 0 in 2.890429973602295 s
Computing sims for pattern 1
Computed sims for pattern 1 in 2.8996798992156982 s
Computing sims for pattern 2
Computed sims for pattern 2 in 3.0177266597747803 s
Computing sims for pattern 3
Computed sims for pattern 3 in 3.0167582035064697 s
Computing sims for pattern 4
Computed sims for pattern 4 in 3.136415719985962 s
Computing sims for pattern 5
Computed sims for pattern 5 in 3.2670538425445557 s
Computing sims for pattern 6
Computed sims for pattern 6 in 3.1380300521850586 s
Computing sims for pattern 7
Computed sims for pattern 7 in 1.0069911479949951 s
Computing sims for pattern 8
Computed sims for pattern 8 in 0.30799126625061035 s
Cluster sizes
[682 609 528 467 433 402 357  62   2]
Cross-contamination matrix:
[[1.   0.75 0.45 0.59 0.84 0.84 0.72 0.85 0.48]
 [0.4  1.   0.42 0.14 0.49 0.41 0.51 0.48 0.35]
 [0.65 0.85 1.   0.63 0.77 0.62 0.51 0.69 0.56]
 [0.68 0.43 0.77 1.   0.83 0.74 0.64 0.72 0.4 ]
 [0.69 0.71 0.55 0.59 1.   0.77 0.63 0.75 0.47]
 [0.75 0.68 0.36 0.56 0.84 1.   0.7  0.75 0.41]
 [0.64 0.65 0.41 0.49 0.71 0.72 1.   0.7  0.37]
 [0.67 0.67 0.48 0.5  0.72 0.66 0.61 1.   0.41]
 [0.   0.   0.   0.   0.   0.   0.   0.   1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.64 0.62 0.69 0.86 0.9  0.76 0.83 0.38]
 [0.64 1.   0.7  0.39 0.67 0.62 0.6  0.67 0.54]
 [0.62 0.7  1.   0.73 0.59 0.59 0.65 0.58 0.38]
 [0.69 0.39 0.73 1.   0.7  0.68 0.61 0.65 0.39]
 [0.86 0.67 0.59 0.7  1.   0.85 0.71 0.8  0.45]
 [0.9  0.62 0.59 0.68 0.85 1.   0.79 0.75 0.38]
 [0.76 0.6  0.65 0.61 0.71 0.79 1.   0.7  0.3 ]
 [0.83 0.67 0.58 0.65 0.8  0.75 0.7  1.   0.38]
 [0.38 0.54 0.38 0.39 0.45 0.38 0.3  0.38 1.  ]]
Collapsing 0 & 5 with crosscontam 0.746562028148148 and sim 0.9010961350839002
Collapsing 0 & 4 with crosscontam 0.6864030350617285 and sim 0.8588442091136812
Collapsing 4 & 5 with crosscontam 0.7698587313580245 and sim 0.8526719801024447
Trimming eliminated 0 seqlets out of 1084
Skipped 1 due to duplicates
Trimming eliminated 0 seqlets out of 1516
Unmerged patterns remapping: OrderedDict([(1, 1), (2, 2), (3, 3), (6, 4), (7, 5), (8, 6)])
Time spent on merging iteration: 8.679020643234253
On merging iteration 2
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 3479 out of 3479 | elapsed:    1.7s finished
Numbers for each pattern pre-subsample: [1516, 609, 528, 467, 357, 62, 2]
Numbers after subsampling: [300, 300, 300, 300, 300, 62, 2]
Computing sims for pattern 0
Computed sims for pattern 0 in 2.251882553100586 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.42873096466064453 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.42337632179260254 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.4201390743255615 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.43133544921875 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.14099860191345215 s
Computing sims for pattern 6
Computed sims for pattern 6 in 0.04432320594787598 s
Cluster sizes
[1516  609  528  467  357   62    2]
Cross-contamination matrix:
[[1.   0.89 0.52 0.75 0.87 0.95 0.61]
 [0.43 1.   0.42 0.14 0.51 0.48 0.35]
 [0.66 0.85 1.   0.63 0.51 0.69 0.56]
 [0.7  0.43 0.77 1.   0.64 0.72 0.4 ]
 [0.66 0.65 0.41 0.49 1.   0.7  0.37]
 [0.66 0.67 0.48 0.5  0.61 1.   0.41]
 [0.   0.   0.   0.   0.   0.   1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.67 0.62 0.69 0.78 0.84 0.41]
 [0.67 1.   0.7  0.39 0.6  0.67 0.54]
 [0.62 0.7  1.   0.73 0.65 0.58 0.38]
 [0.69 0.39 0.73 1.   0.61 0.65 0.39]
 [0.78 0.6  0.65 0.61 1.   0.7  0.3 ]
 [0.84 0.67 0.58 0.65 0.7  1.   0.38]
 [0.41 0.54 0.38 0.39 0.3  0.38 1.  ]]
Inspecting pattern 2 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 3479
[t-SNE] Computed conditional probabilities for sample 2000 / 3479
[t-SNE] Computed conditional probabilities for sample 3000 / 3479
[t-SNE] Computed conditional probabilities for sample 3479 / 3479
[t-SNE] Mean sigma: 0.300625
Beginning preprocessing + Leiden
2024-03-16 20:59:02.342771 MEMORY 20.412669952
Affmat transformed
2024-03-16 20:59:02.383544 MEMORY 20.420173824
sources, targets, weights extracted
2024-03-16 20:59:02.415074 MEMORY 20.420288512
About to launch parallel Leiden runs
2024-03-16 20:59:02.479354 MEMORY 20.420288512
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:   12.0s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   46.0s finished
Parallel Leiden runs finished
2024-03-16 20:59:48.463106 MEMORY 20.420288512
Quality: 0.48751621185046373
Quality: 0.4875207650155514
Quality: 0.4878064012231793
Quality: 0.48783276036244627
Got subclusters: Counter({0: 878, 1: 828, 2: 611, 3: 502, 4: 350, 5: 158, 6: 152})
On merging iteration 1
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 3464 out of 3464 | elapsed:    1.6s finished
Numbers for each pattern pre-subsample: [878, 828, 611, 502, 350, 158, 152]
Numbers after subsampling: [300, 300, 300, 300, 300, 158, 152]
Computing sims for pattern 0
Computed sims for pattern 0 in 2.3192243576049805 s
Computing sims for pattern 1
Computed sims for pattern 1 in 2.454298973083496 s
Computing sims for pattern 2
Computed sims for pattern 2 in 2.499845027923584 s
Computing sims for pattern 3
Computed sims for pattern 3 in 2.4480645656585693 s
Computing sims for pattern 4
Computed sims for pattern 4 in 2.533222198486328 s
Computing sims for pattern 5
Computed sims for pattern 5 in 1.4735257625579834 s
Computing sims for pattern 6
Computed sims for pattern 6 in 1.3800482749938965 s
Cluster sizes
[878 828 611 502 350 158 152]
Cross-contamination matrix:
[[1.   0.49 0.59 0.54 0.48 0.63 0.68]
 [0.52 1.   0.64 0.55 0.5  0.62 0.71]
 [0.63 0.65 1.   0.54 0.61 0.67 0.68]
 [0.77 0.73 0.73 1.   0.62 0.31 0.73]
 [0.77 0.74 0.89 0.69 1.   0.56 0.8 ]
 [0.57 0.53 0.57 0.16 0.27 1.   0.49]
 [0.62 0.62 0.57 0.46 0.45 0.49 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.55 0.73 0.69 0.73 0.71 0.69]
 [0.55 1.   0.73 0.67 0.7  0.64 0.72]
 [0.73 0.73 1.   0.64 0.82 0.74 0.67]
 [0.69 0.67 0.64 1.   0.73 0.54 0.65]
 [0.73 0.7  0.82 0.73 1.   0.5  0.7 ]
 [0.71 0.64 0.74 0.54 0.5  1.   0.57]
 [0.69 0.72 0.67 0.65 0.7  0.57 1.  ]]
Inspecting pattern 3 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 3464
[t-SNE] Computed conditional probabilities for sample 2000 / 3464
[t-SNE] Computed conditional probabilities for sample 3000 / 3464
[t-SNE] Computed conditional probabilities for sample 3464 / 3464
[t-SNE] Mean sigma: 0.293602
Beginning preprocessing + Leiden
2024-03-16 21:00:09.595587 MEMORY 20.41243648
Affmat transformed
2024-03-16 21:00:09.639410 MEMORY 20.419997696
sources, targets, weights extracted
2024-03-16 21:00:09.672620 MEMORY 20.420173824
About to launch parallel Leiden runs
2024-03-16 21:00:09.687585 MEMORY 20.420173824
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:   13.6s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   47.7s finished
Parallel Leiden runs finished
2024-03-16 21:00:57.371817 MEMORY 20.420173824
Quality: 0.47660946683977984
Quality: 0.4768786835375042
Got subclusters: Counter({0: 720, 1: 620, 2: 588, 3: 480, 4: 450, 5: 431, 6: 99, 7: 76})
On merging iteration 1
Numbers for each pattern pre-subsample: [720, 620, 588, 480, 450, 431, 99, 76]
Numbers after subsampling: [300, 300, 300, 300, 300, 300, 99, 76]
Computing sims for pattern 0
Computed sims for pattern 0 in 2.86377215385437 s
Computing sims for pattern 1
Computed sims for pattern 1 in 2.8590502738952637 s
Computing sims for pattern 2
Computed sims for pattern 2 in 2.8898301124572754 s
Computing sims for pattern 3
Computed sims for pattern 3 in 2.9130518436431885 s
Computing sims for pattern 4
Computed sims for pattern 4 in 2.9655091762542725 s
Computing sims for pattern 5
Computed sims for pattern 5 in 2.9425320625305176 s
Computing sims for pattern 6
Computed sims for pattern 6 in 1.1579501628875732 s
Computing sims for pattern 7
Computed sims for pattern 7 in 1.070647954940796 s
Cluster sizes
[720 620 588 480 450 431  99  76]
Cross-contamination matrix:
[[1.   0.39 0.54 0.4  0.56 0.48 0.58 0.44]
 [0.82 1.   0.29 0.62 0.71 0.61 0.4  0.46]
 [1.   0.3  1.   0.61 0.73 0.6  0.84 0.65]
 [0.8  0.58 0.57 1.   0.78 0.68 0.43 0.59]
 [0.95 0.62 0.63 0.71 1.   0.56 0.54 0.64]
 [0.96 0.65 0.64 0.76 0.7  1.   0.72 0.76]
 [0.87 0.3  0.68 0.34 0.32 0.52 1.   0.43]
 [0.85 0.45 0.63 0.61 0.71 0.7  0.55 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.73 0.84 0.75 0.84 0.83 0.79 0.74]
 [0.73 1.   0.54 0.71 0.78 0.74 0.39 0.65]
 [0.84 0.54 1.   0.68 0.73 0.75 0.81 0.74]
 [0.75 0.71 0.68 1.   0.85 0.75 0.51 0.71]
 [0.84 0.78 0.73 0.85 1.   0.79 0.56 0.83]
 [0.83 0.74 0.75 0.75 0.79 1.   0.72 0.85]
 [0.79 0.39 0.81 0.51 0.56 0.72 1.   0.62]
 [0.74 0.65 0.74 0.71 0.83 0.85 0.62 1.  ]]
Collapsing 3 & 4 with crosscontam 0.7084026597530864 and sim 0.8534829163106448
Trimming eliminated 0 seqlets out of 930
Unmerged patterns remapping: OrderedDict([(0, 1), (1, 2), (2, 3), (5, 4), (6, 5), (7, 6)])
Time spent on merging iteration: 2.560950994491577
On merging iteration 2
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 3015 tasks      | elapsed:    1.5s
[Parallel(n_jobs=24)]: Done 3312 out of 3312 | elapsed:    1.6s finished
Numbers for each pattern pre-subsample: [930, 720, 620, 588, 431, 99, 76]
Numbers after subsampling: [300, 300, 300, 300, 300, 99, 76]
Computing sims for pattern 0
Computed sims for pattern 0 in 2.4231622219085693 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.4230637550354004 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.4285428524017334 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.4408292770385742 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.45751261711120605 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.16903233528137207 s
Computing sims for pattern 6
Computed sims for pattern 6 in 0.15922880172729492 s
Cluster sizes
[930 720 620 588 431  99  76]
Cross-contamination matrix:
[[1.   0.98 0.72 0.71 0.75 0.54 0.72]
 [0.46 1.   0.39 0.54 0.48 0.58 0.44]
 [0.66 0.82 1.   0.29 0.61 0.4  0.46]
 [0.65 1.   0.3  1.   0.6  0.84 0.65]
 [0.73 0.96 0.65 0.64 1.   0.72 0.76]
 [0.36 0.87 0.3  0.68 0.52 1.   0.43]
 [0.64 0.85 0.45 0.63 0.7  0.55 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.82 0.76 0.73 0.75 0.5  0.79]
 [0.82 1.   0.73 0.84 0.83 0.79 0.74]
 [0.76 0.73 1.   0.54 0.74 0.39 0.65]
 [0.73 0.84 0.54 1.   0.75 0.81 0.74]
 [0.75 0.83 0.74 0.75 1.   0.72 0.85]
 [0.5  0.79 0.39 0.81 0.72 1.   0.62]
 [0.79 0.74 0.65 0.74 0.85 0.62 1.  ]]
Inspecting pattern 4 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 3312
[t-SNE] Computed conditional probabilities for sample 2000 / 3312
[t-SNE] Computed conditional probabilities for sample 3000 / 3312
[t-SNE] Computed conditional probabilities for sample 3312 / 3312
[t-SNE] Mean sigma: 0.294195
Beginning preprocessing + Leiden
2024-03-16 21:01:29.095872 MEMORY 20.407246848
Affmat transformed
2024-03-16 21:01:29.137553 MEMORY 20.422823936
sources, targets, weights extracted
2024-03-16 21:01:29.168864 MEMORY 20.4240896
About to launch parallel Leiden runs
2024-03-16 21:01:29.183288 MEMORY 20.4240896
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:   12.6s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   48.0s finished
Parallel Leiden runs finished
2024-03-16 21:02:17.140230 MEMORY 20.424077312
Quality: 0.4375293201162969
Quality: 0.43809879237399507
Quality: 0.43884850591943914
Quality: 0.4397450752649122
Quality: 0.44093147060171595
Got subclusters: Counter({0: 790, 1: 696, 2: 600, 3: 470, 4: 443, 5: 135, 6: 104, 7: 74})
On merging iteration 1
Numbers for each pattern pre-subsample: [790, 696, 600, 470, 443, 135, 104, 74]
Numbers after subsampling: [300, 300, 300, 300, 300, 135, 104, 74]
Computing sims for pattern 0
Computed sims for pattern 0 in 2.6926040649414062 s
Computing sims for pattern 1
Computed sims for pattern 1 in 2.6863162517547607 s
Computing sims for pattern 2
Computed sims for pattern 2 in 2.7410006523132324 s
Computing sims for pattern 3
Computed sims for pattern 3 in 2.731868028640747 s
Computing sims for pattern 4
Computed sims for pattern 4 in 2.7590889930725098 s
Computing sims for pattern 5
Computed sims for pattern 5 in 1.4519076347351074 s
Computing sims for pattern 6
Computed sims for pattern 6 in 1.0976641178131104 s
Computing sims for pattern 7
Computed sims for pattern 7 in 0.9809012413024902 s
Cluster sizes
[790 696 600 470 443 135 104  74]
Cross-contamination matrix:
[[1.   0.48 0.86 0.75 0.47 0.62 0.57 0.67]
 [0.67 1.   0.79 0.74 0.74 0.57 0.71 0.7 ]
 [0.75 0.49 1.   0.76 0.51 0.53 0.59 0.68]
 [0.8  0.58 0.91 1.   0.54 0.48 0.74 0.71]
 [0.72 0.81 0.88 0.76 1.   0.63 0.83 0.81]
 [0.84 0.57 0.84 0.62 0.57 1.   0.5  0.6 ]
 [0.56 0.5  0.69 0.69 0.55 0.32 1.   0.62]
 [0.5  0.35 0.62 0.5  0.39 0.29 0.46 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.72 0.86 0.82 0.76 0.84 0.68 0.75]
 [0.72 1.   0.74 0.72 0.85 0.68 0.72 0.74]
 [0.86 0.74 1.   0.84 0.81 0.8  0.72 0.78]
 [0.82 0.72 0.84 1.   0.73 0.65 0.76 0.72]
 [0.76 0.85 0.81 0.73 1.   0.73 0.8  0.81]
 [0.84 0.68 0.8  0.65 0.73 1.   0.54 0.72]
 [0.68 0.72 0.72 0.76 0.8  0.54 1.   0.72]
 [0.75 0.74 0.78 0.72 0.81 0.72 0.72 1.  ]]
Collapsing 0 & 2 with crosscontam 0.7479007170370371 and sim 0.8597671310961263
Trimming eliminated 0 seqlets out of 1390
Unmerged patterns remapping: OrderedDict([(1, 1), (3, 2), (4, 3), (5, 4), (6, 5), (7, 6)])
Time spent on merging iteration: 3.337859630584717
On merging iteration 2
Numbers for each pattern pre-subsample: [1390, 696, 470, 443, 135, 104, 74]
Numbers after subsampling: [300, 300, 300, 300, 135, 104, 74]
Computing sims for pattern 0
Computed sims for pattern 0 in 2.3366000652313232 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.4555544853210449 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.43007540702819824 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.44472765922546387 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.2386612892150879 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.17696571350097656 s
Computing sims for pattern 6
Computed sims for pattern 6 in 0.15758585929870605 s
Cluster sizes
[1390  696  470  443  135  104   74]
Cross-contamination matrix:
[[1.   0.61 0.88 0.6  0.76 0.69 0.8 ]
 [0.69 1.   0.74 0.74 0.57 0.71 0.7 ]
 [0.8  0.58 1.   0.54 0.48 0.74 0.71]
 [0.76 0.81 0.76 1.   0.63 0.83 0.81]
 [0.82 0.57 0.62 0.57 1.   0.5  0.6 ]
 [0.57 0.5  0.69 0.55 0.32 1.   0.62]
 [0.51 0.35 0.5  0.39 0.29 0.46 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.75 0.85 0.81 0.88 0.71 0.79]
 [0.75 1.   0.72 0.85 0.68 0.72 0.74]
 [0.85 0.72 1.   0.73 0.65 0.76 0.72]
 [0.81 0.85 0.73 1.   0.73 0.8  0.81]
 [0.88 0.68 0.65 0.73 1.   0.54 0.72]
 [0.71 0.72 0.76 0.8  0.54 1.   0.72]
 [0.79 0.74 0.72 0.81 0.72 0.72 1.  ]]
Collapsing 0 & 4 with crosscontam 0.7578515917695472 and sim 0.8770914428710099
Collapsing 0 & 2 with crosscontam 0.8036444567901235 and sim 0.8473027704000611
Trimming eliminated 0 seqlets out of 1525
Trimming eliminated 0 seqlets out of 1995
Unmerged patterns remapping: OrderedDict([(1, 1), (3, 2), (5, 3), (6, 4)])
Time spent on merging iteration: 8.389342308044434
On merging iteration 3
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 344 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 441 out of 441 | elapsed:    0.3s finished
Numbers for each pattern pre-subsample: [1995, 696, 443, 104, 74]
Numbers after subsampling: [300, 300, 300, 104, 74]
Computing sims for pattern 0
Computed sims for pattern 0 in 1.5342965126037598 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.4233686923980713 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.4338541030883789 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.17809462547302246 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.15509486198425293 s
Cluster sizes
[1995  696  443  104   74]
Cross-contamination matrix:
[[1.   0.78 0.76 0.83 0.91]
 [0.67 1.   0.74 0.71 0.7 ]
 [0.72 0.81 1.   0.83 0.81]
 [0.53 0.5  0.55 1.   0.62]
 [0.47 0.35 0.39 0.46 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.78 0.83 0.72 0.81]
 [0.78 1.   0.85 0.72 0.74]
 [0.83 0.85 1.   0.8  0.81]
 [0.72 0.72 0.8  1.   0.72]
 [0.81 0.74 0.81 0.72 1.  ]]
Inspecting pattern 5 for spurious merging
[t-SNE] Computed conditional probabilities for sample 441 / 441
[t-SNE] Mean sigma: 0.346865
Beginning preprocessing + Leiden
2024-03-16 21:02:53.553827 MEMORY 20.35621888
Affmat transformed
2024-03-16 21:02:53.559967 MEMORY 20.35621888
sources, targets, weights extracted
2024-03-16 21:02:53.563374 MEMORY 20.35621888
About to launch parallel Leiden runs
2024-03-16 21:02:53.569814 MEMORY 20.35621888
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.4s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    4.1s finished
Parallel Leiden runs finished
2024-03-16 21:02:57.711631 MEMORY 20.35621888
Quality: 0.36429929819361834
Quality: 0.36430184015682004
Got subclusters: Counter({0: 115, 1: 114, 2: 99, 3: 80, 4: 33})
On merging iteration 1
Numbers for each pattern pre-subsample: [115, 114, 99, 80, 33]
Numbers after subsampling: [115, 114, 99, 80, 33]
Computing sims for pattern 0
Computed sims for pattern 0 in 0.5296475887298584 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.5233454704284668 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.44579243659973145 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.4426229000091553 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.20471787452697754 s
Cluster sizes
[115 114  99  80  33]
Cross-contamination matrix:
[[1.   0.55 0.57 0.55 0.42]
 [0.84 1.   0.83 0.71 0.77]
 [0.62 0.6  1.   0.7  0.62]
 [0.66 0.54 0.74 1.   0.59]
 [0.68 0.75 0.83 0.74 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.81 0.77 0.79 0.74]
 [0.81 1.   0.84 0.79 0.86]
 [0.77 0.84 1.   0.85 0.87]
 [0.79 0.79 0.85 1.   0.82]
 [0.74 0.86 0.87 0.82 1.  ]]
Collapsing 2 & 4 with crosscontam 0.6163129909315361 and sim 0.8734909090779422
Collapsing 1 & 4 with crosscontam 0.7495456229688506 and sim 0.8569242993785432
Collapsing 2 & 3 with crosscontam 0.6954006960740968 and sim 0.8531236761186956
Trimming eliminated 0 seqlets out of 132
Skipped 1 due to duplicates
Trimming eliminated 0 seqlets out of 245
Trimming eliminated 0 seqlets out of 325
Unmerged patterns remapping: OrderedDict([(0, 1)])
Time spent on merging iteration: 1.1140236854553223
On merging iteration 2
Numbers for each pattern pre-subsample: [325, 115]
Numbers after subsampling: [300, 115]
Computing sims for pattern 0
Computed sims for pattern 0 in 0.35645389556884766 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.20440411567687988 s
Cluster sizes
[325 115]
Cross-contamination matrix:
[[1.   0.93]
 [0.54 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.83]
 [0.83 1.  ]]
Merging on 34 clusters
2024-03-16 21:03:01.450831 MEMORY 20.35621888
On merging iteration 1
Numbers for each pattern pre-subsample: [1862, 769, 419, 399, 87, 12, 1516, 609, 528, 467, 357, 62, 2, 878, 828, 611, 502, 350, 158, 152, 930, 720, 620, 588, 431, 99, 76, 1995, 696, 443, 104, 74, 325, 115]
Numbers after subsampling: [300, 300, 300, 300, 87, 12, 300, 300, 300, 300, 300, 62, 2, 300, 300, 300, 300, 300, 158, 152, 300, 300, 300, 300, 300, 99, 76, 300, 300, 300, 104, 74, 300, 115]
Computing sims for pattern 0
Computed sims for pattern 0 in 13.794702291488647 s
Computing sims for pattern 1
Computed sims for pattern 1 in 13.772732973098755 s
Computing sims for pattern 2
Computed sims for pattern 2 in 13.7032630443573 s
Computing sims for pattern 3
Computed sims for pattern 3 in 13.342528820037842 s
Computing sims for pattern 4
Computed sims for pattern 4 in 5.310539484024048 s
Computing sims for pattern 5
Computed sims for pattern 5 in 1.5441405773162842 s
Computing sims for pattern 6
Computed sims for pattern 6 in 13.214490175247192 s
Computing sims for pattern 7
Computed sims for pattern 7 in 16.202535390853882 s
Computing sims for pattern 8
Computed sims for pattern 8 in 12.829524517059326 s
Computing sims for pattern 9
Computed sims for pattern 9 in 13.355226039886475 s
Computing sims for pattern 10
Computed sims for pattern 10 in 13.444393396377563 s
Computing sims for pattern 11
Computed sims for pattern 11 in 4.200833797454834 s
Computing sims for pattern 12
Computed sims for pattern 12 in 1.3010351657867432 s
Computing sims for pattern 13
Computed sims for pattern 13 in 13.61692476272583 s
Computing sims for pattern 14
Computed sims for pattern 14 in 13.49093222618103 s
Computing sims for pattern 15
Computed sims for pattern 15 in 13.29817247390747 s
Computing sims for pattern 16
Computed sims for pattern 16 in 13.58851671218872 s
Computing sims for pattern 17
Computed sims for pattern 17 in 13.789782524108887 s
Computing sims for pattern 18
Computed sims for pattern 18 in 7.629909038543701 s
Computing sims for pattern 19
Computed sims for pattern 19 in 11.948805093765259 s
Computing sims for pattern 20
Computed sims for pattern 20 in 13.43635892868042 s
Computing sims for pattern 21
Computed sims for pattern 21 in 13.424460887908936 s
Computing sims for pattern 22
Computed sims for pattern 22 in 13.500176191329956 s
Computing sims for pattern 23
Computed sims for pattern 23 in 13.549116134643555 s
Computing sims for pattern 24
Computed sims for pattern 24 in 13.634499549865723 s
Computing sims for pattern 25
Computed sims for pattern 25 in 5.354514837265015 s
Computing sims for pattern 26
Computed sims for pattern 26 in 4.7817864418029785 s
Computing sims for pattern 27
Computed sims for pattern 27 in 13.873754501342773 s
Computing sims for pattern 28
Computed sims for pattern 28 in 13.4723060131073 s
Computing sims for pattern 29
Computed sims for pattern 29 in 13.34298300743103 s
Computing sims for pattern 30
Computed sims for pattern 30 in 5.360732316970825 s
Computing sims for pattern 31
Computed sims for pattern 31 in 4.458821058273315 s
Computing sims for pattern 32
Computed sims for pattern 32 in 18.474393367767334 s
Computing sims for pattern 33
Computed sims for pattern 33 in 5.941925525665283 s
Cluster sizes
[1862  769  419  399   87   12 1516  609  528  467  357   62    2  878
  828  611  502  350  158  152  930  720  620  588  431   99   76 1995
  696  443  104   74  325  115]
Cross-contamination matrix:
[[1.   0.59 0.68 ... 0.19 0.2  0.2 ]
 [0.72 1.   0.66 ... 0.21 0.22 0.2 ]
 [0.6  0.56 1.   ... 0.2  0.17 0.18]
 ...
 [0.05 0.04 0.05 ... 1.   0.06 0.08]
 [0.13 0.15 0.14 ... 0.18 1.   0.93]
 [0.02 0.02 0.03 ... 0.05 0.54 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.75 0.79 ... 0.31 0.3  0.26]
 [0.75 1.   0.73 ... 0.37 0.34 0.4 ]
 [0.79 0.73 1.   ... 0.36 0.31 0.35]
 ...
 [0.31 0.37 0.36 ... 1.   0.4  0.44]
 [0.3  0.34 0.31 ... 0.4  1.   0.83]
 [0.26 0.4  0.35 ... 0.44 0.83 1.  ]]
Got 34 patterns after merging
2024-03-16 21:09:19.852679 MEMORY 20.35621888
Performing filtering
2024-03-16 21:09:19.853017 MEMORY 20.35621888
Got 32 patterns after filtering
2024-03-16 21:09:22.164543 MEMORY 20.35621888
Total time taken is 2761.17s
2024-03-16 21:09:22.164716 MEMORY 20.35621888
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 1812 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done 1948 out of 1995 | elapsed:    0.7s remaining:    0.0s
[Parallel(n_jobs=24)]: Done 1995 out of 1995 | elapsed:    0.8s finished
/ru-auth/local/home/lzhao/anaconda3/envs/jupyter-ml-clone/lib/python3.9/site-packages/sklearn/manifold/_t_sne.py:691: FutureWarning: 'square_distances' has been introduced in 0.24 to help phase out legacy squaring behavior. The 'legacy' setting will be removed in 1.1 (renaming of 0.26), and the default setting will be changed to True. In 1.3, 'square_distances' will be removed altogether, and distances will be squared by default. Set 'square_distances'=True to silence this warning.
  warnings.warn(
/ru-auth/local/home/lzhao/anaconda3/envs/jupyter-ml-clone/lib/python3.9/site-packages/sklearn/neighbors/_base.py:175: EfficiencyWarning: Precomputed sparse input was not sorted by data.
  warnings.warn('Precomputed sparse input was not sorted by data.',
Applying subclustering to the final motifs
On pattern 0
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 1995 samples in 0.015s...
[t-SNE] Computed neighbors for 1995 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 1000 / 1995
[t-SNE] Computed conditional probabilities for sample 1995 / 1995
[t-SNE] Mean sigma: 0.294688
[t-SNE] Computed conditional probabilities in 0.138s
[t-SNE] Iteration 50: error = 70.3514175, gradient norm = 0.1709516 (50 iterations in 0.285s)
[t-SNE] Iteration 100: error = 70.9925232, gradient norm = 0.1752205 (50 iterations in 0.191s)
[t-SNE] Iteration 150: error = 71.9153519, gradient norm = 0.1422823 (50 iterations in 0.186s)
[t-SNE] Iteration 200: error = 71.2280579, gradient norm = 0.1773987 (50 iterations in 0.179s)
[t-SNE] Iteration 250: error = 72.7105942, gradient norm = 0.1326874 (50 iterations in 0.182s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 72.710594
[t-SNE] Iteration 300: error = 2.4656610, gradient norm = 0.0016463 (50 iterations in 0.169s)
[t-SNE] Iteration 350: error = 2.3632333, gradient norm = 0.0005612 (50 iterations in 0.154s)
[t-SNE] Iteration 400: error = 2.3299901, gradient norm = 0.0002727 (50 iterations in 0.157s)
[t-SNE] Iteration 450: error = 2.3142877, gradient norm = 0.0002161 (50 iterations in 0.158s)
[t-SNE] Iteration 500: error = 2.3047440, gradient norm = 0.0001564 (50 iterations in 0.153s)
[t-SNE] Iteration 550: error = 2.2988091, gradient norm = 0.0001350 (50 iterations in 0.159s)
[t-SNE] Iteration 600: error = 2.2948711, gradient norm = 0.0001005 (50 iterations in 0.155s)
[t-SNE] Iteration 650: error = 2.2905691, gradient norm = 0.0001275 (50 iterations in 0.161s)
[t-SNE] Iteration 700: error = 2.2882965, gradient norm = 0.0001110 (50 iterations in 0.159s)
[t-SNE] Iteration 750: error = 2.2867887, gradient norm = 0.0000671 (50 iterations in 0.157s)
[t-SNE] Iteration 800: error = 2.2854564, gradient norm = 0.0000592 (50 iterations in 0.155s)
[t-SNE] Iteration 850: error = 2.2843797, gradient norm = 0.0000470 (50 iterations in 0.154s)
[t-SNE] Iteration 900: error = 2.2834811, gradient norm = 0.0000377 (50 iterations in 0.155s)
[t-SNE] Iteration 950: error = 2.2828140, gradient norm = 0.0000371 (50 iterations in 0.160s)
[t-SNE] Iteration 1000: error = 2.2822952, gradient norm = 0.0000366 (50 iterations in 0.157s)
[t-SNE] KL divergence after 1000 iterations: 2.282295
[t-SNE] Computed conditional probabilities for sample 1000 / 1995
[t-SNE] Computed conditional probabilities for sample 1995 / 1995
[t-SNE] Mean sigma: 0.294688
Beginning preprocessing + Leiden
2024-03-16 21:09:28.530251 MEMORY 20.381761536
Affmat transformed
2024-03-16 21:09:28.553805 MEMORY 20.38358016
sources, targets, weights extracted
2024-03-16 21:09:28.572936 MEMORY 20.383707136
About to launch parallel Leiden runs
2024-03-16 21:09:28.583150 MEMORY 20.383711232
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    7.8s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   26.7s finished
Parallel Leiden runs finished
2024-03-16 21:09:55.313759 MEMORY 20.383711232
Quality: 0.3879324796435373
Quality: 0.3909219276871441
Quality: 0.39165030001558493
Quality: 0.39207046718105887
Quality: 0.3933143072662568
Quality: 0.39349365983426343
Quality: 0.3938779839629663
Quality: 0.39443813558870594
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 1650 tasks      | elapsed:    0.6s
[Parallel(n_jobs=24)]: Done 1862 out of 1862 | elapsed:    0.7s finished
Got subclusters: Counter({0: 373, 1: 372, 2: 356, 3: 266, 4: 258, 5: 188, 6: 175, 7: 7})
On pattern 1
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 1862 samples in 0.013s...
[t-SNE] Computed neighbors for 1862 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 1000 / 1862
[t-SNE] Computed conditional probabilities for sample 1862 / 1862
[t-SNE] Mean sigma: 0.291148
[t-SNE] Computed conditional probabilities in 0.126s
[t-SNE] Iteration 50: error = 70.3199234, gradient norm = 0.1954083 (50 iterations in 0.183s)
[t-SNE] Iteration 100: error = 70.8237991, gradient norm = 0.1858616 (50 iterations in 0.180s)
[t-SNE] Iteration 150: error = 70.1846466, gradient norm = 0.1856618 (50 iterations in 0.176s)
[t-SNE] Iteration 200: error = 70.9050369, gradient norm = 0.1841077 (50 iterations in 0.178s)
[t-SNE] Iteration 250: error = 71.0307999, gradient norm = 0.1741066 (50 iterations in 0.181s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 71.030800
[t-SNE] Iteration 300: error = 2.3175640, gradient norm = 0.0022899 (50 iterations in 0.177s)
[t-SNE] Iteration 350: error = 2.2552187, gradient norm = 0.0004207 (50 iterations in 0.152s)
[t-SNE] Iteration 400: error = 2.2302153, gradient norm = 0.0002463 (50 iterations in 0.156s)
[t-SNE] Iteration 450: error = 2.2181196, gradient norm = 0.0001652 (50 iterations in 0.160s)
[t-SNE] Iteration 500: error = 2.2118433, gradient norm = 0.0001119 (50 iterations in 0.158s)
[t-SNE] Iteration 550: error = 2.2082527, gradient norm = 0.0000796 (50 iterations in 0.156s)
[t-SNE] Iteration 600: error = 2.2054460, gradient norm = 0.0000864 (50 iterations in 0.157s)
[t-SNE] Iteration 650: error = 2.2038362, gradient norm = 0.0000557 (50 iterations in 0.155s)
[t-SNE] Iteration 700: error = 2.2025671, gradient norm = 0.0000633 (50 iterations in 0.157s)
[t-SNE] Iteration 750: error = 2.2016287, gradient norm = 0.0000603 (50 iterations in 0.155s)
[t-SNE] Iteration 800: error = 2.2008195, gradient norm = 0.0000578 (50 iterations in 0.166s)
[t-SNE] Iteration 850: error = 2.2002199, gradient norm = 0.0000434 (50 iterations in 0.159s)
[t-SNE] Iteration 900: error = 2.1995180, gradient norm = 0.0000314 (50 iterations in 0.156s)
[t-SNE] Iteration 950: error = 2.1992168, gradient norm = 0.0000440 (50 iterations in 0.161s)
[t-SNE] Iteration 1000: error = 2.1987927, gradient norm = 0.0000499 (50 iterations in 0.157s)
[t-SNE] KL divergence after 1000 iterations: 2.198793
[t-SNE] Computed conditional probabilities for sample 1000 / 1862
[t-SNE] Computed conditional probabilities for sample 1862 / 1862
[t-SNE] Mean sigma: 0.291148
Beginning preprocessing + Leiden
2024-03-16 21:10:01.554398 MEMORY 20.383711232
Affmat transformed
2024-03-16 21:10:01.576179 MEMORY 20.383711232
sources, targets, weights extracted
2024-03-16 21:10:01.593960 MEMORY 20.383711232
About to launch parallel Leiden runs
2024-03-16 21:10:01.604501 MEMORY 20.383715328
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    6.6s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   22.4s finished
Parallel Leiden runs finished
2024-03-16 21:10:23.983368 MEMORY 20.383715328
Quality: 0.4033561691342425
Quality: 0.4038820157031487
Quality: 0.40462572236532196
Quality: 0.4046902079629793
Quality: 0.40478622186075486
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 1516 out of 1516 | elapsed:    0.4s finished
Got subclusters: Counter({0: 414, 1: 332, 2: 323, 3: 285, 4: 274, 5: 155, 6: 56, 7: 10, 8: 7, 9: 6})
On pattern 2
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 1516 samples in 0.013s...
[t-SNE] Computed neighbors for 1516 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 1000 / 1516
[t-SNE] Computed conditional probabilities for sample 1516 / 1516
[t-SNE] Mean sigma: 0.337454
[t-SNE] Computed conditional probabilities in 0.105s
[t-SNE] Iteration 50: error = 69.1650009, gradient norm = 0.1743150 (50 iterations in 0.167s)
[t-SNE] Iteration 100: error = 68.3231430, gradient norm = 0.1733325 (50 iterations in 0.157s)
[t-SNE] Iteration 150: error = 69.3121796, gradient norm = 0.1596860 (50 iterations in 0.141s)
[t-SNE] Iteration 200: error = 69.2871017, gradient norm = 0.1703258 (50 iterations in 0.140s)
[t-SNE] Iteration 250: error = 69.6738510, gradient norm = 0.1758768 (50 iterations in 0.143s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 69.673851
[t-SNE] Iteration 300: error = 2.2616420, gradient norm = 0.0022627 (50 iterations in 0.130s)
[t-SNE] Iteration 350: error = 2.2018523, gradient norm = 0.0004138 (50 iterations in 0.122s)
[t-SNE] Iteration 400: error = 2.1778531, gradient norm = 0.0001916 (50 iterations in 0.118s)
[t-SNE] Iteration 450: error = 2.1665435, gradient norm = 0.0001546 (50 iterations in 0.120s)
[t-SNE] Iteration 500: error = 2.1617534, gradient norm = 0.0000938 (50 iterations in 0.121s)
[t-SNE] Iteration 550: error = 2.1590521, gradient norm = 0.0000745 (50 iterations in 0.124s)
[t-SNE] Iteration 600: error = 2.1575701, gradient norm = 0.0000657 (50 iterations in 0.125s)
[t-SNE] Iteration 650: error = 2.1562724, gradient norm = 0.0000825 (50 iterations in 0.120s)
[t-SNE] Iteration 700: error = 2.1550410, gradient norm = 0.0000572 (50 iterations in 0.127s)
[t-SNE] Iteration 750: error = 2.1541281, gradient norm = 0.0000541 (50 iterations in 0.126s)
[t-SNE] Iteration 800: error = 2.1532187, gradient norm = 0.0000412 (50 iterations in 0.122s)
[t-SNE] Iteration 850: error = 2.1526208, gradient norm = 0.0000457 (50 iterations in 0.124s)
[t-SNE] Iteration 900: error = 2.1518075, gradient norm = 0.0000531 (50 iterations in 0.125s)
[t-SNE] Iteration 950: error = 2.1509867, gradient norm = 0.0001013 (50 iterations in 0.120s)
[t-SNE] Iteration 1000: error = 2.1502149, gradient norm = 0.0000813 (50 iterations in 0.125s)
[t-SNE] KL divergence after 1000 iterations: 2.150215
[t-SNE] Computed conditional probabilities for sample 1000 / 1516
[t-SNE] Computed conditional probabilities for sample 1516 / 1516
[t-SNE] Mean sigma: 0.337455
Beginning preprocessing + Leiden
2024-03-16 21:10:28.878862 MEMORY 20.383715328
Affmat transformed
2024-03-16 21:10:28.896629 MEMORY 20.383715328
sources, targets, weights extracted
2024-03-16 21:10:28.908803 MEMORY 20.383715328
About to launch parallel Leiden runs
2024-03-16 21:10:28.917845 MEMORY 20.383715328
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    4.5s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   15.4s finished
Parallel Leiden runs finished
2024-03-16 21:10:44.304266 MEMORY 20.383715328
Quality: 0.4112294741203593
Quality: 0.4149455995301074
Quality: 0.4164634942778757
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 930 out of 930 | elapsed:    0.2s finished
Got subclusters: Counter({0: 293, 1: 288, 2: 209, 3: 180, 4: 164, 5: 161, 6: 142, 7: 79})
On pattern 3
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 930 samples in 0.008s...
[t-SNE] Computed neighbors for 930 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 930 / 930
[t-SNE] Mean sigma: 0.329450
[t-SNE] Computed conditional probabilities in 0.064s
[t-SNE] Iteration 50: error = 71.0287476, gradient norm = 0.2979785 (50 iterations in 0.096s)
[t-SNE] Iteration 100: error = 72.6600418, gradient norm = 0.3083799 (50 iterations in 0.089s)
[t-SNE] Iteration 150: error = 72.8652191, gradient norm = 0.2974912 (50 iterations in 0.091s)
[t-SNE] Iteration 200: error = 72.9438553, gradient norm = 0.3003463 (50 iterations in 0.089s)
[t-SNE] Iteration 250: error = 73.6913300, gradient norm = 0.2998343 (50 iterations in 0.088s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 73.691330
[t-SNE] Iteration 300: error = 1.8685106, gradient norm = 0.0039162 (50 iterations in 0.086s)
[t-SNE] Iteration 350: error = 1.7938656, gradient norm = 0.0006325 (50 iterations in 0.082s)
[t-SNE] Iteration 400: error = 1.7804298, gradient norm = 0.0003253 (50 iterations in 0.081s)
[t-SNE] Iteration 450: error = 1.7694979, gradient norm = 0.0003142 (50 iterations in 0.083s)
[t-SNE] Iteration 500: error = 1.7636956, gradient norm = 0.0002763 (50 iterations in 0.082s)
[t-SNE] Iteration 550: error = 1.7559918, gradient norm = 0.0001686 (50 iterations in 0.083s)
[t-SNE] Iteration 600: error = 1.7535098, gradient norm = 0.0001337 (50 iterations in 0.087s)
[t-SNE] Iteration 650: error = 1.7521805, gradient norm = 0.0001203 (50 iterations in 0.081s)
[t-SNE] Iteration 700: error = 1.7486824, gradient norm = 0.0001984 (50 iterations in 0.087s)
[t-SNE] Iteration 750: error = 1.7479355, gradient norm = 0.0001371 (50 iterations in 0.088s)
[t-SNE] Iteration 800: error = 1.7472688, gradient norm = 0.0001507 (50 iterations in 0.083s)
[t-SNE] Iteration 850: error = 1.7448878, gradient norm = 0.0001105 (50 iterations in 0.083s)
[t-SNE] Iteration 900: error = 1.7447383, gradient norm = 0.0000423 (50 iterations in 0.081s)
[t-SNE] Iteration 950: error = 1.7446463, gradient norm = 0.0000406 (50 iterations in 0.083s)
[t-SNE] Iteration 1000: error = 1.7444255, gradient norm = 0.0000382 (50 iterations in 0.080s)
[t-SNE] KL divergence after 1000 iterations: 1.744426
[t-SNE] Computed conditional probabilities for sample 930 / 930
[t-SNE] Mean sigma: 0.329450
Beginning preprocessing + Leiden
2024-03-16 21:10:47.483466 MEMORY 20.383715328
Affmat transformed
2024-03-16 21:10:47.495087 MEMORY 20.383715328
sources, targets, weights extracted
2024-03-16 21:10:47.502604 MEMORY 20.383715328
About to launch parallel Leiden runs
2024-03-16 21:10:47.510900 MEMORY 20.383690752
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    2.5s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    8.2s finished
Parallel Leiden runs finished
2024-03-16 21:10:55.722764 MEMORY 20.383690752
Quality: 0.39570113548719216
Quality: 0.3957824913027067
Quality: 0.3974999193317165
Quality: 0.3975352758967963
Quality: 0.3979132505201411
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 878 out of 878 | elapsed:    0.2s finished
Got subclusters: Counter({0: 293, 1: 239, 2: 195, 3: 134, 4: 52, 5: 17})
On pattern 4
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 878 samples in 0.007s...
[t-SNE] Computed neighbors for 878 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 878 / 878
[t-SNE] Mean sigma: 0.314315
[t-SNE] Computed conditional probabilities in 0.060s
[t-SNE] Iteration 50: error = 73.1899948, gradient norm = 0.3198028 (50 iterations in 0.145s)
[t-SNE] Iteration 100: error = 73.9352188, gradient norm = 0.3218395 (50 iterations in 0.094s)
[t-SNE] Iteration 150: error = 75.9964523, gradient norm = 0.2931671 (50 iterations in 0.083s)
[t-SNE] Iteration 200: error = 74.9113541, gradient norm = 0.3082696 (50 iterations in 0.087s)
[t-SNE] Iteration 250: error = 74.6256790, gradient norm = 0.3061485 (50 iterations in 0.087s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 74.625679
[t-SNE] Iteration 300: error = 1.9634806, gradient norm = 0.0030691 (50 iterations in 0.080s)
[t-SNE] Iteration 350: error = 1.8799735, gradient norm = 0.0012264 (50 iterations in 0.078s)
[t-SNE] Iteration 400: error = 1.8655705, gradient norm = 0.0004276 (50 iterations in 0.082s)
[t-SNE] Iteration 450: error = 1.8533608, gradient norm = 0.0003328 (50 iterations in 0.082s)
[t-SNE] Iteration 500: error = 1.8473867, gradient norm = 0.0002664 (50 iterations in 0.083s)
[t-SNE] Iteration 550: error = 1.8430631, gradient norm = 0.0001718 (50 iterations in 0.080s)
[t-SNE] Iteration 600: error = 1.8406771, gradient norm = 0.0001200 (50 iterations in 0.080s)
[t-SNE] Iteration 650: error = 1.8391235, gradient norm = 0.0001240 (50 iterations in 0.082s)
[t-SNE] Iteration 700: error = 1.8360500, gradient norm = 0.0002313 (50 iterations in 0.082s)
[t-SNE] Iteration 750: error = 1.8350891, gradient norm = 0.0002187 (50 iterations in 0.083s)
[t-SNE] Iteration 800: error = 1.8326664, gradient norm = 0.0001199 (50 iterations in 0.083s)
[t-SNE] Iteration 850: error = 1.8298247, gradient norm = 0.0002798 (50 iterations in 0.077s)
[t-SNE] Iteration 900: error = 1.8285300, gradient norm = 0.0001259 (50 iterations in 0.083s)
[t-SNE] Iteration 950: error = 1.8276103, gradient norm = 0.0001150 (50 iterations in 0.080s)
[t-SNE] Iteration 1000: error = 1.8264972, gradient norm = 0.0001436 (50 iterations in 0.085s)
[t-SNE] KL divergence after 1000 iterations: 1.826497
[t-SNE] Computed conditional probabilities for sample 878 / 878
[t-SNE] Mean sigma: 0.314315
Beginning preprocessing + Leiden
2024-03-16 21:10:58.750331 MEMORY 20.383690752
Affmat transformed
2024-03-16 21:10:58.760809 MEMORY 20.383690752
sources, targets, weights extracted
2024-03-16 21:10:58.768590 MEMORY 20.383690752
About to launch parallel Leiden runs
2024-03-16 21:10:58.775837 MEMORY 20.383690752
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    2.9s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   10.3s finished
Parallel Leiden runs finished
2024-03-16 21:11:09.124152 MEMORY 20.383690752
Quality: 0.33346856594687624
Quality: 0.335446401129138
Quality: 0.33563979985684916
Quality: 0.3365246081804798
Quality: 0.33676363950198757
Quality: 0.3389069824318287
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 828 out of 828 | elapsed:    0.2s finished
Got subclusters: Counter({0: 177, 1: 150, 2: 111, 3: 106, 4: 90, 5: 80, 6: 63, 7: 51, 8: 37, 9: 13})
On pattern 5
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 828 samples in 0.007s...
[t-SNE] Computed neighbors for 828 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 828 / 828
[t-SNE] Mean sigma: 0.309661
[t-SNE] Computed conditional probabilities in 0.056s
[t-SNE] Iteration 50: error = 76.2281494, gradient norm = 0.3237482 (50 iterations in 0.101s)
[t-SNE] Iteration 100: error = 78.8677292, gradient norm = 0.2914228 (50 iterations in 0.095s)
[t-SNE] Iteration 150: error = 79.7502823, gradient norm = 0.3008541 (50 iterations in 0.090s)
[t-SNE] Iteration 200: error = 79.7580643, gradient norm = 0.2887395 (50 iterations in 0.095s)
[t-SNE] Iteration 250: error = 79.2445526, gradient norm = 0.3111340 (50 iterations in 0.092s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 79.244553
[t-SNE] Iteration 300: error = 1.8188188, gradient norm = 0.0038136 (50 iterations in 0.094s)
[t-SNE] Iteration 350: error = 1.7147530, gradient norm = 0.0009961 (50 iterations in 0.084s)
[t-SNE] Iteration 400: error = 1.6955031, gradient norm = 0.0007266 (50 iterations in 0.085s)
[t-SNE] Iteration 450: error = 1.6855785, gradient norm = 0.0005397 (50 iterations in 0.080s)
[t-SNE] Iteration 500: error = 1.6807959, gradient norm = 0.0003314 (50 iterations in 0.084s)
[t-SNE] Iteration 550: error = 1.6789058, gradient norm = 0.0001898 (50 iterations in 0.089s)
[t-SNE] Iteration 600: error = 1.6728852, gradient norm = 0.0005655 (50 iterations in 0.082s)
[t-SNE] Iteration 650: error = 1.6655592, gradient norm = 0.0004490 (50 iterations in 0.090s)
[t-SNE] Iteration 700: error = 1.6618646, gradient norm = 0.0002287 (50 iterations in 0.090s)
[t-SNE] Iteration 750: error = 1.6606556, gradient norm = 0.0001404 (50 iterations in 0.087s)
[t-SNE] Iteration 800: error = 1.6584821, gradient norm = 0.0006200 (50 iterations in 0.085s)
[t-SNE] Iteration 850: error = 1.6580536, gradient norm = 0.0000513 (50 iterations in 0.084s)
[t-SNE] Iteration 900: error = 1.6579773, gradient norm = 0.0000327 (50 iterations in 0.083s)
[t-SNE] Iteration 950: error = 1.6575511, gradient norm = 0.0000758 (50 iterations in 0.084s)
[t-SNE] Iteration 1000: error = 1.6575135, gradient norm = 0.0000398 (50 iterations in 0.085s)
[t-SNE] KL divergence after 1000 iterations: 1.657513
[t-SNE] Computed conditional probabilities for sample 828 / 828
[t-SNE] Mean sigma: 0.309661
Beginning preprocessing + Leiden
2024-03-16 21:11:12.222835 MEMORY 20.383690752
Affmat transformed
2024-03-16 21:11:12.233708 MEMORY 20.383690752
sources, targets, weights extracted
2024-03-16 21:11:12.241492 MEMORY 20.383690752
About to launch parallel Leiden runs
2024-03-16 21:11:12.248549 MEMORY 20.383690752
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    2.3s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    7.6s finished
Parallel Leiden runs finished
2024-03-16 21:11:19.843833 MEMORY 20.383690752
Quality: 0.346974740897065
Quality: 0.34879876479137256
Quality: 0.34930859276788007
Quality: 0.34985881058101787
Quality: 0.3500958707430924
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 769 out of 769 | elapsed:    0.4s finished
Got subclusters: Counter({0: 160, 1: 153, 2: 137, 3: 115, 4: 95, 5: 79, 6: 65, 7: 24})
On pattern 6
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 769 samples in 0.007s...
[t-SNE] Computed neighbors for 769 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 769 / 769
[t-SNE] Mean sigma: 0.347268
[t-SNE] Computed conditional probabilities in 0.054s
[t-SNE] Iteration 50: error = 68.7225952, gradient norm = 0.3772340 (50 iterations in 0.078s)
[t-SNE] Iteration 100: error = 70.7408295, gradient norm = 0.3559425 (50 iterations in 0.079s)
[t-SNE] Iteration 150: error = 70.7439194, gradient norm = 0.3552921 (50 iterations in 0.077s)
[t-SNE] Iteration 200: error = 71.4465027, gradient norm = 0.3470541 (50 iterations in 0.080s)
[t-SNE] Iteration 250: error = 72.0695953, gradient norm = 0.3392881 (50 iterations in 0.080s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 72.069595
[t-SNE] Iteration 300: error = 1.8745995, gradient norm = 0.0032659 (50 iterations in 0.077s)
[t-SNE] Iteration 350: error = 1.8289882, gradient norm = 0.0006627 (50 iterations in 0.072s)
[t-SNE] Iteration 400: error = 1.8096770, gradient norm = 0.0006030 (50 iterations in 0.072s)
[t-SNE] Iteration 450: error = 1.7982801, gradient norm = 0.0003088 (50 iterations in 0.074s)
[t-SNE] Iteration 500: error = 1.7932936, gradient norm = 0.0004013 (50 iterations in 0.073s)
[t-SNE] Iteration 550: error = 1.7909049, gradient norm = 0.0001147 (50 iterations in 0.070s)
[t-SNE] Iteration 600: error = 1.7899318, gradient norm = 0.0001262 (50 iterations in 0.070s)
[t-SNE] Iteration 650: error = 1.7889799, gradient norm = 0.0001440 (50 iterations in 0.072s)
[t-SNE] Iteration 700: error = 1.7886715, gradient norm = 0.0000628 (50 iterations in 0.071s)
[t-SNE] Iteration 750: error = 1.7884629, gradient norm = 0.0000641 (50 iterations in 0.073s)
[t-SNE] Iteration 800: error = 1.7882001, gradient norm = 0.0000443 (50 iterations in 0.072s)
[t-SNE] Iteration 850: error = 1.7877740, gradient norm = 0.0001637 (50 iterations in 0.072s)
[t-SNE] Iteration 900: error = 1.7870208, gradient norm = 0.0000642 (50 iterations in 0.072s)
[t-SNE] Iteration 950: error = 1.7860355, gradient norm = 0.0000823 (50 iterations in 0.072s)
[t-SNE] Iteration 1000: error = 1.7859319, gradient norm = 0.0000957 (50 iterations in 0.073s)
[t-SNE] KL divergence after 1000 iterations: 1.785932
[t-SNE] Computed conditional probabilities for sample 769 / 769
[t-SNE] Mean sigma: 0.347268
Beginning preprocessing + Leiden
2024-03-16 21:11:22.648532 MEMORY 20.383690752
Affmat transformed
2024-03-16 21:11:22.658349 MEMORY 20.383690752
sources, targets, weights extracted
2024-03-16 21:11:22.664156 MEMORY 20.383690752
About to launch parallel Leiden runs
2024-03-16 21:11:22.670736 MEMORY 20.383690752
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    2.0s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    6.1s finished
Parallel Leiden runs finished
2024-03-16 21:11:28.792539 MEMORY 20.383690752
Quality: 0.370284490408665
Quality: 0.37045916914941535
Quality: 0.37072418460301854
Quality: 0.37218818547937926
Quality: 0.37731936699152724
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 720 out of 720 | elapsed:    0.3s finished
Got subclusters: Counter({0: 150, 1: 142, 2: 122, 3: 117, 4: 103, 5: 76, 6: 59})
On pattern 7
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 720 samples in 0.006s...
[t-SNE] Computed neighbors for 720 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 720 / 720
[t-SNE] Mean sigma: 0.280480
[t-SNE] Computed conditional probabilities in 0.051s
[t-SNE] Iteration 50: error = 73.6568756, gradient norm = 0.3655984 (50 iterations in 0.079s)
[t-SNE] Iteration 100: error = 74.5015259, gradient norm = 0.3641552 (50 iterations in 0.077s)
[t-SNE] Iteration 150: error = 74.2164383, gradient norm = 0.3534646 (50 iterations in 0.083s)
[t-SNE] Iteration 200: error = 76.6478119, gradient norm = 0.3355979 (50 iterations in 0.082s)
[t-SNE] Iteration 250: error = 77.0642166, gradient norm = 0.3286521 (50 iterations in 0.085s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 77.064217
[t-SNE] Iteration 300: error = 1.7581815, gradient norm = 0.0028440 (50 iterations in 0.084s)
[t-SNE] Iteration 350: error = 1.6452622, gradient norm = 0.0010018 (50 iterations in 0.084s)
[t-SNE] Iteration 400: error = 1.5932496, gradient norm = 0.0015038 (50 iterations in 0.080s)
[t-SNE] Iteration 450: error = 1.5563029, gradient norm = 0.0009560 (50 iterations in 0.085s)
[t-SNE] Iteration 500: error = 1.5454019, gradient norm = 0.0004591 (50 iterations in 0.097s)
[t-SNE] Iteration 550: error = 1.5368824, gradient norm = 0.0002354 (50 iterations in 0.080s)
[t-SNE] Iteration 600: error = 1.5304394, gradient norm = 0.0002906 (50 iterations in 0.079s)
[t-SNE] Iteration 650: error = 1.5278630, gradient norm = 0.0001363 (50 iterations in 0.081s)
[t-SNE] Iteration 700: error = 1.5246675, gradient norm = 0.0001529 (50 iterations in 0.076s)
[t-SNE] Iteration 750: error = 1.5232754, gradient norm = 0.0001030 (50 iterations in 0.080s)
[t-SNE] Iteration 800: error = 1.5214411, gradient norm = 0.0002214 (50 iterations in 0.077s)
[t-SNE] Iteration 850: error = 1.5204945, gradient norm = 0.0000822 (50 iterations in 0.077s)
[t-SNE] Iteration 900: error = 1.5204877, gradient norm = 0.0000382 (50 iterations in 0.075s)
[t-SNE] Iteration 950: error = 1.5204607, gradient norm = 0.0000298 (50 iterations in 0.073s)
[t-SNE] Iteration 1000: error = 1.5204329, gradient norm = 0.0000435 (50 iterations in 0.081s)
[t-SNE] KL divergence after 1000 iterations: 1.520433
[t-SNE] Computed conditional probabilities for sample 720 / 720
[t-SNE] Mean sigma: 0.280480
Beginning preprocessing + Leiden
2024-03-16 21:11:31.563061 MEMORY 20.383690752
Affmat transformed
2024-03-16 21:11:31.576228 MEMORY 20.383690752
sources, targets, weights extracted
2024-03-16 21:11:31.583747 MEMORY 20.383690752
About to launch parallel Leiden runs
2024-03-16 21:11:31.590207 MEMORY 20.383690752
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    2.1s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    6.8s finished
Parallel Leiden runs finished
2024-03-16 21:11:38.361757 MEMORY 20.383690752
Quality: 0.33341011180222657
Quality: 0.33366075066291084
Quality: 0.3350985794221005
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 696 out of 696 | elapsed:    0.4s finished
Got subclusters: Counter({0: 150, 1: 119, 2: 80, 3: 79, 4: 68, 5: 61, 6: 61, 7: 57, 8: 45})
On pattern 8
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 696 samples in 0.006s...
[t-SNE] Computed neighbors for 696 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 696 / 696
[t-SNE] Mean sigma: 0.335153
[t-SNE] Computed conditional probabilities in 0.047s
[t-SNE] Iteration 50: error = 69.5079041, gradient norm = 0.4062346 (50 iterations in 0.074s)
[t-SNE] Iteration 100: error = 72.3799515, gradient norm = 0.3731385 (50 iterations in 0.074s)
[t-SNE] Iteration 150: error = 72.1724472, gradient norm = 0.3772849 (50 iterations in 0.078s)
[t-SNE] Iteration 200: error = 70.5157471, gradient norm = 0.3986638 (50 iterations in 0.073s)
[t-SNE] Iteration 250: error = 72.4823761, gradient norm = 0.3576665 (50 iterations in 0.072s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 72.482376
[t-SNE] Iteration 300: error = 1.7890084, gradient norm = 0.0030981 (50 iterations in 0.069s)
[t-SNE] Iteration 350: error = 1.7177740, gradient norm = 0.0012483 (50 iterations in 0.066s)
[t-SNE] Iteration 400: error = 1.6825607, gradient norm = 0.0006410 (50 iterations in 0.065s)
[t-SNE] Iteration 450: error = 1.6691562, gradient norm = 0.0003856 (50 iterations in 0.065s)
[t-SNE] Iteration 500: error = 1.6627878, gradient norm = 0.0002694 (50 iterations in 0.068s)
[t-SNE] Iteration 550: error = 1.6540892, gradient norm = 0.0002639 (50 iterations in 0.069s)
[t-SNE] Iteration 600: error = 1.6471509, gradient norm = 0.0003407 (50 iterations in 0.068s)
[t-SNE] Iteration 650: error = 1.6436359, gradient norm = 0.0001406 (50 iterations in 0.068s)
[t-SNE] Iteration 700: error = 1.6400862, gradient norm = 0.0004024 (50 iterations in 0.067s)
[t-SNE] Iteration 750: error = 1.6384885, gradient norm = 0.0001851 (50 iterations in 0.073s)
[t-SNE] Iteration 800: error = 1.6374042, gradient norm = 0.0001073 (50 iterations in 0.066s)
[t-SNE] Iteration 850: error = 1.6360931, gradient norm = 0.0001228 (50 iterations in 0.067s)
[t-SNE] Iteration 900: error = 1.6360018, gradient norm = 0.0000666 (50 iterations in 0.076s)
[t-SNE] Iteration 950: error = 1.6358229, gradient norm = 0.0000700 (50 iterations in 0.067s)
[t-SNE] Iteration 1000: error = 1.6358482, gradient norm = 0.0000514 (50 iterations in 0.070s)
[t-SNE] KL divergence after 1000 iterations: 1.635848
[t-SNE] Computed conditional probabilities for sample 696 / 696
[t-SNE] Mean sigma: 0.335153
Beginning preprocessing + Leiden
2024-03-16 21:11:40.992567 MEMORY 20.383690752
Affmat transformed
2024-03-16 21:11:41.001366 MEMORY 20.383690752
sources, targets, weights extracted
2024-03-16 21:11:41.006927 MEMORY 20.383690752
About to launch parallel Leiden runs
2024-03-16 21:11:41.012978 MEMORY 20.383690752
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.8s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    6.0s finished
Parallel Leiden runs finished
2024-03-16 21:11:47.025402 MEMORY 20.383690752
Quality: 0.3722704164559919
Quality: 0.37335804221469315
Quality: 0.3735851965924071
Quality: 0.3736668480639756
Quality: 0.37415695190439985
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 620 out of 620 | elapsed:    0.3s finished
Got subclusters: Counter({0: 119, 1: 113, 2: 109, 3: 103, 4: 97, 5: 84, 6: 71})
On pattern 9
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 620 samples in 0.005s...
[t-SNE] Computed neighbors for 620 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 620 / 620
[t-SNE] Mean sigma: 0.336309
[t-SNE] Computed conditional probabilities in 0.043s
[t-SNE] Iteration 50: error = 69.8466721, gradient norm = 0.4237435 (50 iterations in 0.081s)
[t-SNE] Iteration 100: error = 71.1851959, gradient norm = 0.3910507 (50 iterations in 0.067s)
[t-SNE] Iteration 150: error = 72.9215927, gradient norm = 0.3696176 (50 iterations in 0.069s)
[t-SNE] Iteration 200: error = 71.9798737, gradient norm = 0.4047602 (50 iterations in 0.068s)
[t-SNE] Iteration 250: error = 72.8399582, gradient norm = 0.3635613 (50 iterations in 0.069s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 72.839958
[t-SNE] Iteration 300: error = 1.7309176, gradient norm = 0.0030918 (50 iterations in 0.066s)
[t-SNE] Iteration 350: error = 1.6836872, gradient norm = 0.0011906 (50 iterations in 0.067s)
[t-SNE] Iteration 400: error = 1.6660998, gradient norm = 0.0006361 (50 iterations in 0.071s)
[t-SNE] Iteration 450: error = 1.6528790, gradient norm = 0.0007946 (50 iterations in 0.072s)
[t-SNE] Iteration 500: error = 1.6422452, gradient norm = 0.0005531 (50 iterations in 0.070s)
[t-SNE] Iteration 550: error = 1.6359959, gradient norm = 0.0004124 (50 iterations in 0.072s)
[t-SNE] Iteration 600: error = 1.6310434, gradient norm = 0.0003118 (50 iterations in 0.072s)
[t-SNE] Iteration 650: error = 1.6262190, gradient norm = 0.0003987 (50 iterations in 0.067s)
[t-SNE] Iteration 700: error = 1.6148765, gradient norm = 0.0010460 (50 iterations in 0.068s)
[t-SNE] Iteration 750: error = 1.5931842, gradient norm = 0.0005469 (50 iterations in 0.073s)
[t-SNE] Iteration 800: error = 1.5908265, gradient norm = 0.0002323 (50 iterations in 0.073s)
[t-SNE] Iteration 850: error = 1.5875828, gradient norm = 0.0002215 (50 iterations in 0.072s)
[t-SNE] Iteration 900: error = 1.5868220, gradient norm = 0.0000946 (50 iterations in 0.070s)
[t-SNE] Iteration 950: error = 1.5866318, gradient norm = 0.0000534 (50 iterations in 0.069s)
[t-SNE] Iteration 1000: error = 1.5865912, gradient norm = 0.0000320 (50 iterations in 0.070s)
[t-SNE] KL divergence after 1000 iterations: 1.586591
[t-SNE] Computed conditional probabilities for sample 620 / 620
[t-SNE] Mean sigma: 0.336309
Beginning preprocessing + Leiden
2024-03-16 21:11:49.480786 MEMORY 20.383690752
Affmat transformed
2024-03-16 21:11:49.489642 MEMORY 20.383690752
sources, targets, weights extracted
2024-03-16 21:11:49.494591 MEMORY 20.383690752
About to launch parallel Leiden runs
2024-03-16 21:11:49.500602 MEMORY 20.383690752
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    5.4s finished
Parallel Leiden runs finished
2024-03-16 21:11:54.918049 MEMORY 20.383690752
Quality: 0.355475839479716
Quality: 0.35624563248137553
Quality: 0.356954735979896
Quality: 0.357455853379069
Quality: 0.3577495967514608
Quality: 0.3577549110823264
Quality: 0.35791720948936245
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 611 out of 611 | elapsed:    0.3s finished
Got subclusters: Counter({0: 127, 1: 124, 2: 96, 3: 92, 4: 91, 5: 90})
On pattern 10
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 611 samples in 0.006s...
[t-SNE] Computed neighbors for 611 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 611 / 611
[t-SNE] Mean sigma: 0.331950
[t-SNE] Computed conditional probabilities in 0.050s
[t-SNE] Iteration 50: error = 72.3550644, gradient norm = 0.4280968 (50 iterations in 0.075s)
[t-SNE] Iteration 100: error = 73.9927673, gradient norm = 0.3816057 (50 iterations in 0.079s)
[t-SNE] Iteration 150: error = 73.9409790, gradient norm = 0.3826780 (50 iterations in 0.078s)
[t-SNE] Iteration 200: error = 73.1665039, gradient norm = 0.3971635 (50 iterations in 0.068s)
[t-SNE] Iteration 250: error = 77.0706329, gradient norm = 0.3656275 (50 iterations in 0.069s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 77.070633
[t-SNE] Iteration 300: error = 1.6856484, gradient norm = 0.0045460 (50 iterations in 0.067s)
[t-SNE] Iteration 350: error = 1.6101806, gradient norm = 0.0010058 (50 iterations in 0.073s)
[t-SNE] Iteration 400: error = 1.5758233, gradient norm = 0.0012422 (50 iterations in 0.067s)
[t-SNE] Iteration 450: error = 1.5515552, gradient norm = 0.0008195 (50 iterations in 0.069s)
[t-SNE] Iteration 500: error = 1.5350746, gradient norm = 0.0008736 (50 iterations in 0.074s)
[t-SNE] Iteration 550: error = 1.5248810, gradient norm = 0.0008205 (50 iterations in 0.069s)
[t-SNE] Iteration 600: error = 1.5144235, gradient norm = 0.0006032 (50 iterations in 0.067s)
[t-SNE] Iteration 650: error = 1.5075266, gradient norm = 0.0004104 (50 iterations in 0.067s)
[t-SNE] Iteration 700: error = 1.5042250, gradient norm = 0.0003097 (50 iterations in 0.067s)
[t-SNE] Iteration 750: error = 1.5035999, gradient norm = 0.0000536 (50 iterations in 0.066s)
[t-SNE] Iteration 800: error = 1.5033641, gradient norm = 0.0000415 (50 iterations in 0.067s)
[t-SNE] Iteration 850: error = 1.5027279, gradient norm = 0.0000957 (50 iterations in 0.066s)
[t-SNE] Iteration 900: error = 1.5025315, gradient norm = 0.0000427 (50 iterations in 0.066s)
[t-SNE] Iteration 950: error = 1.5025047, gradient norm = 0.0000397 (50 iterations in 0.067s)
[t-SNE] Iteration 1000: error = 1.5024437, gradient norm = 0.0000378 (50 iterations in 0.070s)
[t-SNE] KL divergence after 1000 iterations: 1.502444
[t-SNE] Computed conditional probabilities for sample 611 / 611
[t-SNE] Mean sigma: 0.331950
Beginning preprocessing + Leiden
2024-03-16 21:11:57.383839 MEMORY 20.383690752
Affmat transformed
2024-03-16 21:11:57.391859 MEMORY 20.383690752
sources, targets, weights extracted
2024-03-16 21:11:57.396901 MEMORY 20.383690752
About to launch parallel Leiden runs
2024-03-16 21:11:57.417737 MEMORY 20.383690752
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.6s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    4.9s finished
Parallel Leiden runs finished
2024-03-16 21:12:02.284989 MEMORY 20.383690752
Quality: 0.3514310117546906
Quality: 0.3517985581366813
Quality: 0.35315351128252237
Quality: 0.3536115747998298
Quality: 0.3538913606501626
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 609 out of 609 | elapsed:    0.3s finished
Got subclusters: Counter({0: 121, 1: 119, 2: 108, 3: 92, 4: 91, 5: 80})
On pattern 11
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 609 samples in 0.005s...
[t-SNE] Computed neighbors for 609 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 609 / 609
[t-SNE] Mean sigma: 0.336821
[t-SNE] Computed conditional probabilities in 0.042s
[t-SNE] Iteration 50: error = 73.2839890, gradient norm = 0.3917733 (50 iterations in 0.072s)
[t-SNE] Iteration 100: error = 75.9280396, gradient norm = 0.3555827 (50 iterations in 0.070s)
[t-SNE] Iteration 150: error = 74.3235855, gradient norm = 0.3679922 (50 iterations in 0.070s)
[t-SNE] Iteration 200: error = 74.2858429, gradient norm = 0.3903619 (50 iterations in 0.069s)
[t-SNE] Iteration 250: error = 73.0780258, gradient norm = 0.3944554 (50 iterations in 0.070s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 73.078026
[t-SNE] Iteration 300: error = 1.6415424, gradient norm = 0.0036967 (50 iterations in 0.064s)
[t-SNE] Iteration 350: error = 1.5814389, gradient norm = 0.0011270 (50 iterations in 0.067s)
[t-SNE] Iteration 400: error = 1.5624896, gradient norm = 0.0003569 (50 iterations in 0.069s)
[t-SNE] Iteration 450: error = 1.5593287, gradient norm = 0.0002154 (50 iterations in 0.066s)
[t-SNE] Iteration 500: error = 1.5538574, gradient norm = 0.0003201 (50 iterations in 0.065s)
[t-SNE] Iteration 550: error = 1.5506809, gradient norm = 0.0001564 (50 iterations in 0.067s)
[t-SNE] Iteration 600: error = 1.5493777, gradient norm = 0.0001891 (50 iterations in 0.066s)
[t-SNE] Iteration 650: error = 1.5477438, gradient norm = 0.0003049 (50 iterations in 0.066s)
[t-SNE] Iteration 700: error = 1.5467727, gradient norm = 0.0001088 (50 iterations in 0.065s)
[t-SNE] Iteration 750: error = 1.5461546, gradient norm = 0.0000657 (50 iterations in 0.065s)
[t-SNE] Iteration 800: error = 1.5434879, gradient norm = 0.0004112 (50 iterations in 0.067s)
[t-SNE] Iteration 850: error = 1.5417199, gradient norm = 0.0001093 (50 iterations in 0.066s)
[t-SNE] Iteration 900: error = 1.5415626, gradient norm = 0.0000915 (50 iterations in 0.065s)
[t-SNE] Iteration 950: error = 1.5381972, gradient norm = 0.0004401 (50 iterations in 0.066s)
[t-SNE] Iteration 1000: error = 1.5351460, gradient norm = 0.0002749 (50 iterations in 0.065s)
[t-SNE] KL divergence after 1000 iterations: 1.535146
[t-SNE] Computed conditional probabilities for sample 609 / 609
[t-SNE] Mean sigma: 0.336821
Beginning preprocessing + Leiden
2024-03-16 21:12:04.746211 MEMORY 20.383690752
Affmat transformed
2024-03-16 21:12:04.753370 MEMORY 20.383690752
sources, targets, weights extracted
2024-03-16 21:12:04.758063 MEMORY 20.383690752
About to launch parallel Leiden runs
2024-03-16 21:12:04.764173 MEMORY 20.383690752
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    5.6s finished
Parallel Leiden runs finished
2024-03-16 21:12:10.350186 MEMORY 20.383690752
Quality: 0.36321418426213137
Quality: 0.3634873246680899
Quality: 0.3645439509310098
Quality: 0.3645862161782586
Quality: 0.3657745180058785
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 588 out of 588 | elapsed:    0.3s finished
Got subclusters: Counter({0: 162, 1: 123, 2: 113, 3: 97, 4: 57, 5: 57})
On pattern 12
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 588 samples in 0.005s...
[t-SNE] Computed neighbors for 588 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 588 / 588
[t-SNE] Mean sigma: 0.341691
[t-SNE] Computed conditional probabilities in 0.041s
[t-SNE] Iteration 50: error = 72.0159988, gradient norm = 0.3872464 (50 iterations in 0.067s)
[t-SNE] Iteration 100: error = 71.0859299, gradient norm = 0.4124562 (50 iterations in 0.064s)
[t-SNE] Iteration 150: error = 74.1081314, gradient norm = 0.3944122 (50 iterations in 0.067s)
[t-SNE] Iteration 200: error = 76.1171112, gradient norm = 0.3538416 (50 iterations in 0.067s)
[t-SNE] Iteration 250: error = 75.0062790, gradient norm = 0.3520218 (50 iterations in 0.063s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 75.006279
[t-SNE] Iteration 300: error = 1.5937977, gradient norm = 0.0034197 (50 iterations in 0.060s)
[t-SNE] Iteration 350: error = 1.5378072, gradient norm = 0.0012597 (50 iterations in 0.063s)
[t-SNE] Iteration 400: error = 1.5074770, gradient norm = 0.0006158 (50 iterations in 0.060s)
[t-SNE] Iteration 450: error = 1.4981979, gradient norm = 0.0004004 (50 iterations in 0.062s)
[t-SNE] Iteration 500: error = 1.4899813, gradient norm = 0.0003943 (50 iterations in 0.063s)
[t-SNE] Iteration 550: error = 1.4835472, gradient norm = 0.0004843 (50 iterations in 0.059s)
[t-SNE] Iteration 600: error = 1.4797184, gradient norm = 0.0002249 (50 iterations in 0.063s)
[t-SNE] Iteration 650: error = 1.4790536, gradient norm = 0.0002448 (50 iterations in 0.062s)
[t-SNE] Iteration 700: error = 1.4720094, gradient norm = 0.0004929 (50 iterations in 0.062s)
[t-SNE] Iteration 750: error = 1.4544525, gradient norm = 0.0003243 (50 iterations in 0.062s)
[t-SNE] Iteration 800: error = 1.4493340, gradient norm = 0.0004926 (50 iterations in 0.059s)
[t-SNE] Iteration 850: error = 1.4424422, gradient norm = 0.0002813 (50 iterations in 0.066s)
[t-SNE] Iteration 900: error = 1.4418945, gradient norm = 0.0000672 (50 iterations in 0.060s)
[t-SNE] Iteration 950: error = 1.4415773, gradient norm = 0.0001567 (50 iterations in 0.065s)
[t-SNE] Iteration 1000: error = 1.4388342, gradient norm = 0.0002775 (50 iterations in 0.062s)
[t-SNE] KL divergence after 1000 iterations: 1.438834
[t-SNE] Computed conditional probabilities for sample 588 / 588
[t-SNE] Mean sigma: 0.341691
Beginning preprocessing + Leiden
2024-03-16 21:12:12.552182 MEMORY 20.383690752
Affmat transformed
2024-03-16 21:12:12.559358 MEMORY 20.383690752
sources, targets, weights extracted
2024-03-16 21:12:12.564596 MEMORY 20.383690752
About to launch parallel Leiden runs
2024-03-16 21:12:12.570150 MEMORY 20.383690752
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.6s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    5.2s finished
Parallel Leiden runs finished
2024-03-16 21:12:17.730286 MEMORY 20.383690752
Quality: 0.36181024174200066
Quality: 0.3652341581062497
Quality: 0.366325074364042
Quality: 0.36660150056252516
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 528 out of 528 | elapsed:    0.2s finished
Got subclusters: Counter({0: 104, 2: 103, 1: 103, 3: 96, 4: 77, 5: 67, 6: 38})
On pattern 13
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 528 samples in 0.005s...
[t-SNE] Computed neighbors for 528 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 528 / 528
[t-SNE] Mean sigma: 0.388654
[t-SNE] Computed conditional probabilities in 0.036s
[t-SNE] Iteration 50: error = 69.2740021, gradient norm = 0.4393520 (50 iterations in 0.063s)
[t-SNE] Iteration 100: error = 69.7197342, gradient norm = 0.4623044 (50 iterations in 0.063s)
[t-SNE] Iteration 150: error = 71.6753235, gradient norm = 0.4185734 (50 iterations in 0.065s)
[t-SNE] Iteration 200: error = 70.1181259, gradient norm = 0.4340760 (50 iterations in 0.067s)
[t-SNE] Iteration 250: error = 68.5775833, gradient norm = 0.4315221 (50 iterations in 0.061s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 68.577583
[t-SNE] Iteration 300: error = 1.4741334, gradient norm = 0.0025176 (50 iterations in 0.057s)
[t-SNE] Iteration 350: error = 1.4359747, gradient norm = 0.0007401 (50 iterations in 0.056s)
[t-SNE] Iteration 400: error = 1.4267716, gradient norm = 0.0003068 (50 iterations in 0.056s)
[t-SNE] Iteration 450: error = 1.4201522, gradient norm = 0.0005529 (50 iterations in 0.067s)
[t-SNE] Iteration 500: error = 1.4153359, gradient norm = 0.0002199 (50 iterations in 0.060s)
[t-SNE] Iteration 550: error = 1.4132881, gradient norm = 0.0001691 (50 iterations in 0.056s)
[t-SNE] Iteration 600: error = 1.4104763, gradient norm = 0.0002017 (50 iterations in 0.056s)
[t-SNE] Iteration 650: error = 1.4103698, gradient norm = 0.0001708 (50 iterations in 0.056s)
[t-SNE] Iteration 700: error = 1.4100387, gradient norm = 0.0001451 (50 iterations in 0.056s)
[t-SNE] Iteration 750: error = 1.4094211, gradient norm = 0.0001009 (50 iterations in 0.056s)
[t-SNE] Iteration 800: error = 1.4086649, gradient norm = 0.0001078 (50 iterations in 0.057s)
[t-SNE] Iteration 850: error = 1.4082925, gradient norm = 0.0001310 (50 iterations in 0.056s)
[t-SNE] Iteration 900: error = 1.4085401, gradient norm = 0.0000643 (50 iterations in 0.057s)
[t-SNE] Iteration 950: error = 1.4085476, gradient norm = 0.0000364 (50 iterations in 0.061s)
[t-SNE] Iteration 1000: error = 1.4085295, gradient norm = 0.0000381 (50 iterations in 0.056s)
[t-SNE] KL divergence after 1000 iterations: 1.408530
[t-SNE] Computed conditional probabilities for sample 528 / 528
[t-SNE] Mean sigma: 0.388654
Beginning preprocessing + Leiden
2024-03-16 21:12:19.721841 MEMORY 20.383690752
Affmat transformed
2024-03-16 21:12:19.728471 MEMORY 20.383690752
sources, targets, weights extracted
2024-03-16 21:12:19.732198 MEMORY 20.383690752
About to launch parallel Leiden runs
2024-03-16 21:12:19.737614 MEMORY 20.383690752
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.5s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    4.4s finished
Parallel Leiden runs finished
2024-03-16 21:12:24.106811 MEMORY 20.383690752
Quality: 0.36902839239810625
Quality: 0.3698608771330339
Quality: 0.3702202817611506
Quality: 0.3707847110997229
Quality: 0.3709100647935609
Quality: 0.37110194555464004
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 344 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 502 out of 502 | elapsed:    0.3s finished
Got subclusters: Counter({0: 109, 1: 106, 2: 88, 3: 69, 4: 62, 5: 62, 6: 32})
On pattern 14
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 502 samples in 0.004s...
[t-SNE] Computed neighbors for 502 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 502 / 502
[t-SNE] Mean sigma: 0.356311
[t-SNE] Computed conditional probabilities in 0.035s
[t-SNE] Iteration 50: error = 71.3373566, gradient norm = 0.4433886 (50 iterations in 0.058s)
[t-SNE] Iteration 100: error = 73.5797272, gradient norm = 0.4261673 (50 iterations in 0.059s)
[t-SNE] Iteration 150: error = 75.1812820, gradient norm = 0.3857869 (50 iterations in 0.058s)
[t-SNE] Iteration 200: error = 72.8098221, gradient norm = 0.4137501 (50 iterations in 0.061s)
[t-SNE] Iteration 250: error = 73.7269440, gradient norm = 0.4319814 (50 iterations in 0.061s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 73.726944
[t-SNE] Iteration 300: error = 1.5707504, gradient norm = 0.0048233 (50 iterations in 0.058s)
[t-SNE] Iteration 350: error = 1.4787738, gradient norm = 0.0013891 (50 iterations in 0.058s)
[t-SNE] Iteration 400: error = 1.4040982, gradient norm = 0.0014490 (50 iterations in 0.057s)
[t-SNE] Iteration 450: error = 1.3721813, gradient norm = 0.0010486 (50 iterations in 0.057s)
[t-SNE] Iteration 500: error = 1.3613040, gradient norm = 0.0003670 (50 iterations in 0.055s)
[t-SNE] Iteration 550: error = 1.3513867, gradient norm = 0.0009644 (50 iterations in 0.057s)
[t-SNE] Iteration 600: error = 1.3470367, gradient norm = 0.0001167 (50 iterations in 0.059s)
[t-SNE] Iteration 650: error = 1.3464805, gradient norm = 0.0000621 (50 iterations in 0.058s)
[t-SNE] Iteration 700: error = 1.3461409, gradient norm = 0.0000751 (50 iterations in 0.056s)
[t-SNE] Iteration 750: error = 1.3459870, gradient norm = 0.0000285 (50 iterations in 0.058s)
[t-SNE] Iteration 800: error = 1.3459632, gradient norm = 0.0000318 (50 iterations in 0.058s)
[t-SNE] Iteration 850: error = 1.3459624, gradient norm = 0.0000272 (50 iterations in 0.058s)
[t-SNE] Iteration 900: error = 1.3460230, gradient norm = 0.0000466 (50 iterations in 0.055s)
[t-SNE] Iteration 950: error = 1.3459195, gradient norm = 0.0000314 (50 iterations in 0.059s)
[t-SNE] Iteration 1000: error = 1.3458437, gradient norm = 0.0000358 (50 iterations in 0.061s)
[t-SNE] KL divergence after 1000 iterations: 1.345844
[t-SNE] Computed conditional probabilities for sample 502 / 502
[t-SNE] Mean sigma: 0.356311
Beginning preprocessing + Leiden
2024-03-16 21:12:26.168601 MEMORY 20.383690752
Affmat transformed
2024-03-16 21:12:26.175375 MEMORY 20.383690752
sources, targets, weights extracted
2024-03-16 21:12:26.178918 MEMORY 20.383690752
About to launch parallel Leiden runs
2024-03-16 21:12:26.184226 MEMORY 20.383690752
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.3s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    3.9s finished
Parallel Leiden runs finished
2024-03-16 21:12:30.128435 MEMORY 20.383690752
Quality: 0.37847928061387576
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 344 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 467 out of 467 | elapsed:    0.2s finished
Got subclusters: Counter({0: 161, 1: 121, 2: 98, 3: 65, 4: 42, 5: 15})
On pattern 15
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 467 samples in 0.004s...
[t-SNE] Computed neighbors for 467 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 467 / 467
[t-SNE] Mean sigma: 0.394358
[t-SNE] Computed conditional probabilities in 0.032s
[t-SNE] Iteration 50: error = 66.4226532, gradient norm = 0.4924616 (50 iterations in 0.057s)
[t-SNE] Iteration 100: error = 68.5911484, gradient norm = 0.4614207 (50 iterations in 0.056s)
[t-SNE] Iteration 150: error = 71.9500427, gradient norm = 0.4298257 (50 iterations in 0.057s)
[t-SNE] Iteration 200: error = 71.4884109, gradient norm = 0.4367546 (50 iterations in 0.056s)
[t-SNE] Iteration 250: error = 69.4611359, gradient norm = 0.4519795 (50 iterations in 0.055s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 69.461136
[t-SNE] Iteration 300: error = 1.4787589, gradient norm = 0.0041760 (50 iterations in 0.055s)
[t-SNE] Iteration 350: error = 1.3580098, gradient norm = 0.0014542 (50 iterations in 0.055s)
[t-SNE] Iteration 400: error = 1.3334045, gradient norm = 0.0008438 (50 iterations in 0.055s)
[t-SNE] Iteration 450: error = 1.3117355, gradient norm = 0.0013210 (50 iterations in 0.053s)
[t-SNE] Iteration 500: error = 1.2840486, gradient norm = 0.0011282 (50 iterations in 0.053s)
[t-SNE] Iteration 550: error = 1.2488921, gradient norm = 0.0008230 (50 iterations in 0.052s)
[t-SNE] Iteration 600: error = 1.2419909, gradient norm = 0.0003455 (50 iterations in 0.052s)
[t-SNE] Iteration 650: error = 1.2366723, gradient norm = 0.0003788 (50 iterations in 0.052s)
[t-SNE] Iteration 700: error = 1.2325712, gradient norm = 0.0002903 (50 iterations in 0.052s)
[t-SNE] Iteration 750: error = 1.2167221, gradient norm = 0.0012639 (50 iterations in 0.053s)
[t-SNE] Iteration 800: error = 1.2091634, gradient norm = 0.0009063 (50 iterations in 0.052s)
[t-SNE] Iteration 850: error = 1.2074000, gradient norm = 0.0001433 (50 iterations in 0.052s)
[t-SNE] Iteration 900: error = 1.2073729, gradient norm = 0.0000515 (50 iterations in 0.055s)
[t-SNE] Iteration 950: error = 1.2073233, gradient norm = 0.0000635 (50 iterations in 0.056s)
[t-SNE] Iteration 1000: error = 1.2072291, gradient norm = 0.0000374 (50 iterations in 0.056s)
[t-SNE] KL divergence after 1000 iterations: 1.207229
[t-SNE] Computed conditional probabilities for sample 467 / 467
[t-SNE] Mean sigma: 0.394358
Beginning preprocessing + Leiden
2024-03-16 21:12:32.027837 MEMORY 20.383690752
Affmat transformed
2024-03-16 21:12:32.034539 MEMORY 20.383690752
sources, targets, weights extracted
2024-03-16 21:12:32.037722 MEMORY 20.383690752
About to launch parallel Leiden runs
2024-03-16 21:12:32.043365 MEMORY 20.383690752
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.3s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    3.8s finished
Parallel Leiden runs finished
2024-03-16 21:12:35.835570 MEMORY 20.383690752
Quality: 0.39668969272069254
Quality: 0.3967553205928436
Quality: 0.39699019232894894
Quality: 0.3973083251693136
Quality: 0.3979954557155209
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 344 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 443 out of 443 | elapsed:    0.2s finished
Got subclusters: Counter({0: 115, 1: 67, 2: 67, 3: 63, 4: 62, 5: 56, 6: 37})
On pattern 16
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 443 samples in 0.004s...
[t-SNE] Computed neighbors for 443 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 443 / 443
[t-SNE] Mean sigma: 0.366205
[t-SNE] Computed conditional probabilities in 0.031s
[t-SNE] Iteration 50: error = 66.4585648, gradient norm = 0.4939189 (50 iterations in 0.054s)
[t-SNE] Iteration 100: error = 71.1040955, gradient norm = 0.4509366 (50 iterations in 0.058s)
[t-SNE] Iteration 150: error = 69.8974991, gradient norm = 0.4694574 (50 iterations in 0.059s)
[t-SNE] Iteration 200: error = 72.2386780, gradient norm = 0.4408220 (50 iterations in 0.058s)
[t-SNE] Iteration 250: error = 72.6231232, gradient norm = 0.4210386 (50 iterations in 0.058s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 72.623123
[t-SNE] Iteration 300: error = 1.5402617, gradient norm = 0.0044067 (50 iterations in 0.058s)
[t-SNE] Iteration 350: error = 1.4351885, gradient norm = 0.0022254 (50 iterations in 0.054s)
[t-SNE] Iteration 400: error = 1.3841109, gradient norm = 0.0014656 (50 iterations in 0.055s)
[t-SNE] Iteration 450: error = 1.3657196, gradient norm = 0.0010201 (50 iterations in 0.053s)
[t-SNE] Iteration 500: error = 1.3499887, gradient norm = 0.0003072 (50 iterations in 0.053s)
[t-SNE] Iteration 550: error = 1.3483092, gradient norm = 0.0004647 (50 iterations in 0.053s)
[t-SNE] Iteration 600: error = 1.3459685, gradient norm = 0.0002883 (50 iterations in 0.052s)
[t-SNE] Iteration 650: error = 1.3446085, gradient norm = 0.0002510 (50 iterations in 0.051s)
[t-SNE] Iteration 700: error = 1.3435105, gradient norm = 0.0002657 (50 iterations in 0.053s)
[t-SNE] Iteration 750: error = 1.3430187, gradient norm = 0.0000893 (50 iterations in 0.052s)
[t-SNE] Iteration 800: error = 1.3425965, gradient norm = 0.0002642 (50 iterations in 0.053s)
[t-SNE] Iteration 850: error = 1.3412225, gradient norm = 0.0000865 (50 iterations in 0.052s)
[t-SNE] Iteration 900: error = 1.3412101, gradient norm = 0.0000635 (50 iterations in 0.052s)
[t-SNE] Iteration 950: error = 1.3410373, gradient norm = 0.0000633 (50 iterations in 0.060s)
[t-SNE] Iteration 1000: error = 1.3410914, gradient norm = 0.0000636 (50 iterations in 0.057s)
[t-SNE] KL divergence after 1000 iterations: 1.341091
[t-SNE] Computed conditional probabilities for sample 443 / 443
[t-SNE] Mean sigma: 0.366205
Beginning preprocessing + Leiden
2024-03-16 21:12:37.712909 MEMORY 20.383690752
Affmat transformed
2024-03-16 21:12:37.723808 MEMORY 20.383690752
sources, targets, weights extracted
2024-03-16 21:12:37.727972 MEMORY 20.383690752
About to launch parallel Leiden runs
2024-03-16 21:12:37.734324 MEMORY 20.383690752
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.2s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    3.8s finished
Parallel Leiden runs finished
2024-03-16 21:12:41.551771 MEMORY 20.383690752
Quality: 0.35023244476664345
Quality: 0.3514962154977012
Quality: 0.35168491211704456
Quality: 0.35200982642736733
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 344 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 431 out of 431 | elapsed:    0.2s finished
Got subclusters: Counter({0: 82, 1: 80, 2: 75, 3: 68, 4: 43, 5: 39, 6: 28, 7: 19, 8: 9})
On pattern 17
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 431 samples in 0.004s...
[t-SNE] Computed neighbors for 431 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 431 / 431
[t-SNE] Mean sigma: 0.368565
[t-SNE] Computed conditional probabilities in 0.030s
[t-SNE] Iteration 50: error = 67.5941696, gradient norm = 0.4931304 (50 iterations in 0.062s)
[t-SNE] Iteration 100: error = 68.8380127, gradient norm = 0.4743477 (50 iterations in 0.062s)
[t-SNE] Iteration 150: error = 69.9126358, gradient norm = 0.4776236 (50 iterations in 0.052s)
[t-SNE] Iteration 200: error = 71.9814835, gradient norm = 0.4430501 (50 iterations in 0.054s)
[t-SNE] Iteration 250: error = 71.7666626, gradient norm = 0.4432143 (50 iterations in 0.055s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 71.766663
[t-SNE] Iteration 300: error = 1.4465674, gradient norm = 0.0035762 (50 iterations in 0.054s)
[t-SNE] Iteration 350: error = 1.3624369, gradient norm = 0.0019226 (50 iterations in 0.055s)
[t-SNE] Iteration 400: error = 1.3009584, gradient norm = 0.0010348 (50 iterations in 0.055s)
[t-SNE] Iteration 450: error = 1.2379944, gradient norm = 0.0012477 (50 iterations in 0.054s)
[t-SNE] Iteration 500: error = 1.2191085, gradient norm = 0.0006798 (50 iterations in 0.055s)
[t-SNE] Iteration 550: error = 1.2125415, gradient norm = 0.0004357 (50 iterations in 0.058s)
[t-SNE] Iteration 600: error = 1.2106092, gradient norm = 0.0003208 (50 iterations in 0.057s)
[t-SNE] Iteration 650: error = 1.2047050, gradient norm = 0.0002518 (50 iterations in 0.054s)
[t-SNE] Iteration 700: error = 1.2005955, gradient norm = 0.0007186 (50 iterations in 0.052s)
[t-SNE] Iteration 750: error = 1.1953048, gradient norm = 0.0006219 (50 iterations in 0.055s)
[t-SNE] Iteration 800: error = 1.1936307, gradient norm = 0.0000954 (50 iterations in 0.061s)
[t-SNE] Iteration 850: error = 1.1932610, gradient norm = 0.0001066 (50 iterations in 0.056s)
[t-SNE] Iteration 900: error = 1.1932725, gradient norm = 0.0000795 (50 iterations in 0.050s)
[t-SNE] Iteration 950: error = 1.1931689, gradient norm = 0.0000600 (50 iterations in 0.051s)
[t-SNE] Iteration 1000: error = 1.1931578, gradient norm = 0.0000818 (50 iterations in 0.057s)
[t-SNE] KL divergence after 1000 iterations: 1.193158
[t-SNE] Computed conditional probabilities for sample 431 / 431
[t-SNE] Mean sigma: 0.368565
Beginning preprocessing + Leiden
2024-03-16 21:12:43.443132 MEMORY 20.383690752
Affmat transformed
2024-03-16 21:12:43.449178 MEMORY 20.383690752
sources, targets, weights extracted
2024-03-16 21:12:43.453075 MEMORY 20.383690752
About to launch parallel Leiden runs
2024-03-16 21:12:43.458626 MEMORY 20.383690752
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.1s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    3.6s finished
Parallel Leiden runs finished
2024-03-16 21:12:47.077540 MEMORY 20.383690752
Quality: 0.3833016446899188
Quality: 0.3837673789979854
Quality: 0.3843586440313865
Quality: 0.3845161194200873
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 344 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 419 out of 419 | elapsed:    0.2s finished
Got subclusters: Counter({0: 122, 2: 87, 1: 87, 3: 58, 4: 45, 5: 32})
On pattern 18
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 419 samples in 0.004s...
[t-SNE] Computed neighbors for 419 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 419 / 419
[t-SNE] Mean sigma: 0.373110
[t-SNE] Computed conditional probabilities in 0.029s
[t-SNE] Iteration 50: error = 67.3240891, gradient norm = 0.4894782 (50 iterations in 0.051s)
[t-SNE] Iteration 100: error = 70.2074661, gradient norm = 0.4491242 (50 iterations in 0.053s)
[t-SNE] Iteration 150: error = 70.2131119, gradient norm = 0.4440685 (50 iterations in 0.054s)
[t-SNE] Iteration 200: error = 69.4481735, gradient norm = 0.4473900 (50 iterations in 0.054s)
[t-SNE] Iteration 250: error = 72.9394989, gradient norm = 0.4145926 (50 iterations in 0.052s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 72.939499
[t-SNE] Iteration 300: error = 1.4655817, gradient norm = 0.0039623 (50 iterations in 0.053s)
[t-SNE] Iteration 350: error = 1.3426092, gradient norm = 0.0019553 (50 iterations in 0.054s)
[t-SNE] Iteration 400: error = 1.2701681, gradient norm = 0.0012871 (50 iterations in 0.050s)
[t-SNE] Iteration 450: error = 1.2424804, gradient norm = 0.0010302 (50 iterations in 0.049s)
[t-SNE] Iteration 500: error = 1.2340157, gradient norm = 0.0006438 (50 iterations in 0.049s)
[t-SNE] Iteration 550: error = 1.2309705, gradient norm = 0.0002169 (50 iterations in 0.050s)
[t-SNE] Iteration 600: error = 1.2295244, gradient norm = 0.0002074 (50 iterations in 0.055s)
[t-SNE] Iteration 650: error = 1.2291784, gradient norm = 0.0001816 (50 iterations in 0.052s)
[t-SNE] Iteration 700: error = 1.2278391, gradient norm = 0.0002399 (50 iterations in 0.050s)
[t-SNE] Iteration 750: error = 1.2267342, gradient norm = 0.0002614 (50 iterations in 0.051s)
[t-SNE] Iteration 800: error = 1.2262657, gradient norm = 0.0001195 (50 iterations in 0.050s)
[t-SNE] Iteration 850: error = 1.2262051, gradient norm = 0.0001178 (50 iterations in 0.049s)
[t-SNE] Iteration 900: error = 1.2260574, gradient norm = 0.0001142 (50 iterations in 0.052s)
[t-SNE] Iteration 950: error = 1.2257417, gradient norm = 0.0002581 (50 iterations in 0.054s)
[t-SNE] Iteration 1000: error = 1.2256136, gradient norm = 0.0001092 (50 iterations in 0.053s)
[t-SNE] KL divergence after 1000 iterations: 1.225614
[t-SNE] Computed conditional probabilities for sample 419 / 419
[t-SNE] Mean sigma: 0.373111
Beginning preprocessing + Leiden
2024-03-16 21:12:48.884398 MEMORY 20.383690752
Affmat transformed
2024-03-16 21:12:48.889899 MEMORY 20.383690752
sources, targets, weights extracted
2024-03-16 21:12:48.892514 MEMORY 20.383690752
About to launch parallel Leiden runs
2024-03-16 21:12:48.897939 MEMORY 20.383690752
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.2s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    3.6s finished
Parallel Leiden runs finished
2024-03-16 21:12:52.512990 MEMORY 20.383690752
Quality: 0.38820171972501166
Quality: 0.3882882960488188
Quality: 0.38851592735230456
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 344 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 399 out of 399 | elapsed:    0.2s finished
Got subclusters: Counter({0: 95, 1: 91, 2: 74, 3: 56, 4: 52, 5: 48, 6: 3})
On pattern 19
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 399 samples in 0.004s...
[t-SNE] Computed neighbors for 399 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 399 / 399
[t-SNE] Mean sigma: 0.386453
[t-SNE] Computed conditional probabilities in 0.027s
[t-SNE] Iteration 50: error = 64.6479568, gradient norm = 0.5078887 (50 iterations in 0.051s)
[t-SNE] Iteration 100: error = 66.2579269, gradient norm = 0.4918021 (50 iterations in 0.054s)
[t-SNE] Iteration 150: error = 67.9340439, gradient norm = 0.4888248 (50 iterations in 0.049s)
[t-SNE] Iteration 200: error = 67.6700668, gradient norm = 0.4927427 (50 iterations in 0.049s)
[t-SNE] Iteration 250: error = 69.9549484, gradient norm = 0.4480851 (50 iterations in 0.053s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 69.954948
[t-SNE] Iteration 300: error = 1.4643807, gradient norm = 0.0039984 (50 iterations in 0.055s)
[t-SNE] Iteration 350: error = 1.3589969, gradient norm = 0.0025241 (50 iterations in 0.054s)
[t-SNE] Iteration 400: error = 1.3129724, gradient norm = 0.0007588 (50 iterations in 0.057s)
[t-SNE] Iteration 450: error = 1.2958245, gradient norm = 0.0006972 (50 iterations in 0.054s)
[t-SNE] Iteration 500: error = 1.2784567, gradient norm = 0.0010900 (50 iterations in 0.053s)
[t-SNE] Iteration 550: error = 1.2724929, gradient norm = 0.0003488 (50 iterations in 0.053s)
[t-SNE] Iteration 600: error = 1.2709644, gradient norm = 0.0001890 (50 iterations in 0.057s)
[t-SNE] Iteration 650: error = 1.2651460, gradient norm = 0.0002478 (50 iterations in 0.058s)
[t-SNE] Iteration 700: error = 1.2624991, gradient norm = 0.0004995 (50 iterations in 0.055s)
[t-SNE] Iteration 750: error = 1.2622315, gradient norm = 0.0000948 (50 iterations in 0.053s)
[t-SNE] Iteration 800: error = 1.2624722, gradient norm = 0.0000851 (50 iterations in 0.052s)
[t-SNE] Iteration 850: error = 1.2623328, gradient norm = 0.0001074 (50 iterations in 0.052s)
[t-SNE] Iteration 900: error = 1.2619766, gradient norm = 0.0001592 (50 iterations in 0.050s)
[t-SNE] Iteration 950: error = 1.2615674, gradient norm = 0.0001258 (50 iterations in 0.046s)
[t-SNE] Iteration 1000: error = 1.2615199, gradient norm = 0.0000851 (50 iterations in 0.046s)
[t-SNE] KL divergence after 1000 iterations: 1.261520
[t-SNE] Computed conditional probabilities for sample 399 / 399
[t-SNE] Mean sigma: 0.386453
Beginning preprocessing + Leiden
2024-03-16 21:12:54.301087 MEMORY 20.383690752
Affmat transformed
2024-03-16 21:12:54.306652 MEMORY 20.383690752
sources, targets, weights extracted
2024-03-16 21:12:54.309172 MEMORY 20.383690752
About to launch parallel Leiden runs
2024-03-16 21:12:54.314199 MEMORY 20.383690752
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.1s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    3.3s finished
Parallel Leiden runs finished
2024-03-16 21:12:57.595983 MEMORY 20.383690752
Quality: 0.36872173933290087
Quality: 0.3701799106862722
Quality: 0.37049015767586196
Quality: 0.3741640396285801
Quality: 0.37624536590920543
Quality: 0.3764523745774934
Quality: 0.37657629311051777
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 357 out of 357 | elapsed:    0.1s finished
Got subclusters: Counter({0: 93, 1: 82, 2: 80, 3: 76, 5: 34, 4: 34})
On pattern 20
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 357 samples in 0.003s...
[t-SNE] Computed neighbors for 357 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 357 / 357
[t-SNE] Mean sigma: 0.405457
[t-SNE] Computed conditional probabilities in 0.026s
[t-SNE] Iteration 50: error = 68.8539352, gradient norm = 0.4835023 (50 iterations in 0.047s)
[t-SNE] Iteration 100: error = 71.5053711, gradient norm = 0.4626247 (50 iterations in 0.046s)
[t-SNE] Iteration 150: error = 70.6392822, gradient norm = 0.4507594 (50 iterations in 0.050s)
[t-SNE] Iteration 200: error = 68.4397812, gradient norm = 0.4875444 (50 iterations in 0.044s)
[t-SNE] Iteration 250: error = 73.1584015, gradient norm = 0.4547957 (50 iterations in 0.045s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 73.158401
[t-SNE] Iteration 300: error = 1.2821740, gradient norm = 0.0050970 (50 iterations in 0.043s)
[t-SNE] Iteration 350: error = 1.1381357, gradient norm = 0.0034715 (50 iterations in 0.044s)
[t-SNE] Iteration 400: error = 1.0441767, gradient norm = 0.0016394 (50 iterations in 0.044s)
[t-SNE] Iteration 450: error = 1.0141222, gradient norm = 0.0006758 (50 iterations in 0.047s)
[t-SNE] Iteration 500: error = 1.0020304, gradient norm = 0.0002789 (50 iterations in 0.044s)
[t-SNE] Iteration 550: error = 1.0020806, gradient norm = 0.0000888 (50 iterations in 0.046s)
[t-SNE] Iteration 600: error = 1.0015056, gradient norm = 0.0004830 (50 iterations in 0.046s)
[t-SNE] Iteration 650: error = 1.0012136, gradient norm = 0.0000806 (50 iterations in 0.046s)
[t-SNE] Iteration 700: error = 1.0011269, gradient norm = 0.0000826 (50 iterations in 0.045s)
[t-SNE] Iteration 750: error = 0.9982402, gradient norm = 0.0006287 (50 iterations in 0.045s)
[t-SNE] Iteration 800: error = 0.9953135, gradient norm = 0.0004322 (50 iterations in 0.045s)
[t-SNE] Iteration 850: error = 0.9935164, gradient norm = 0.0001510 (50 iterations in 0.045s)
[t-SNE] Iteration 900: error = 0.9910609, gradient norm = 0.0003934 (50 iterations in 0.044s)
[t-SNE] Iteration 950: error = 0.9907907, gradient norm = 0.0000951 (50 iterations in 0.043s)
[t-SNE] Iteration 1000: error = 0.9906874, gradient norm = 0.0000679 (50 iterations in 0.044s)
[t-SNE] KL divergence after 1000 iterations: 0.990687
[t-SNE] Computed conditional probabilities for sample 357 / 357
[t-SNE] Mean sigma: 0.405457
Beginning preprocessing + Leiden
2024-03-16 21:12:59.067568 MEMORY 20.383690752
Affmat transformed
2024-03-16 21:12:59.072424 MEMORY 20.383690752
sources, targets, weights extracted
2024-03-16 21:12:59.074849 MEMORY 20.383690752
About to launch parallel Leiden runs
2024-03-16 21:12:59.079353 MEMORY 20.383690752
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.1s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    3.0s finished
Parallel Leiden runs finished
2024-03-16 21:13:02.114484 MEMORY 20.383690752
Quality: 0.4037532984016655
Quality: 0.4037746643804584
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 350 out of 350 | elapsed:    0.1s finished
Got subclusters: Counter({0: 89, 1: 88, 2: 73, 3: 70, 4: 37})
On pattern 21
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 350 samples in 0.003s...
[t-SNE] Computed neighbors for 350 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 350 / 350
[t-SNE] Mean sigma: 0.386947
[t-SNE] Computed conditional probabilities in 0.024s
[t-SNE] Iteration 50: error = 62.5308990, gradient norm = 0.4909721 (50 iterations in 0.071s)
[t-SNE] Iteration 100: error = 65.4721603, gradient norm = 0.4664733 (50 iterations in 0.045s)
[t-SNE] Iteration 150: error = 66.9020691, gradient norm = 0.4809315 (50 iterations in 0.049s)
[t-SNE] Iteration 200: error = 67.4152527, gradient norm = 0.4995937 (50 iterations in 0.047s)
[t-SNE] Iteration 250: error = 67.2781372, gradient norm = 0.4948190 (50 iterations in 0.046s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 67.278137
[t-SNE] Iteration 300: error = 1.2551893, gradient norm = 0.0044225 (50 iterations in 0.051s)
[t-SNE] Iteration 350: error = 1.1214393, gradient norm = 0.0023940 (50 iterations in 0.049s)
[t-SNE] Iteration 400: error = 1.0802258, gradient norm = 0.0008612 (50 iterations in 0.051s)
[t-SNE] Iteration 450: error = 1.0705028, gradient norm = 0.0011371 (50 iterations in 0.053s)
[t-SNE] Iteration 500: error = 1.0653480, gradient norm = 0.0001247 (50 iterations in 0.051s)
[t-SNE] Iteration 550: error = 1.0652052, gradient norm = 0.0000519 (50 iterations in 0.053s)
[t-SNE] Iteration 600: error = 1.0653081, gradient norm = 0.0000626 (50 iterations in 0.051s)
[t-SNE] Iteration 650: error = 1.0651529, gradient norm = 0.0000499 (50 iterations in 0.053s)
[t-SNE] Iteration 700: error = 1.0650274, gradient norm = 0.0000686 (50 iterations in 0.050s)
[t-SNE] Iteration 750: error = 1.0650585, gradient norm = 0.0000633 (50 iterations in 0.052s)
[t-SNE] Iteration 800: error = 1.0649067, gradient norm = 0.0000530 (50 iterations in 0.049s)
[t-SNE] Iteration 850: error = 1.0650332, gradient norm = 0.0000539 (50 iterations in 0.049s)
[t-SNE] Iteration 900: error = 1.0650769, gradient norm = 0.0000552 (50 iterations in 0.049s)
[t-SNE] Iteration 950: error = 1.0650564, gradient norm = 0.0000677 (50 iterations in 0.052s)
[t-SNE] Iteration 1000: error = 1.0651120, gradient norm = 0.0000406 (50 iterations in 0.049s)
[t-SNE] KL divergence after 1000 iterations: 1.065112
[t-SNE] Computed conditional probabilities for sample 350 / 350
[t-SNE] Mean sigma: 0.386947
Beginning preprocessing + Leiden
2024-03-16 21:13:03.689063 MEMORY 20.383690752
Affmat transformed
2024-03-16 21:13:03.693973 MEMORY 20.383690752
sources, targets, weights extracted
2024-03-16 21:13:03.696699 MEMORY 20.383690752
About to launch parallel Leiden runs
2024-03-16 21:13:03.704683 MEMORY 20.383690752
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.1s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    3.1s finished
Parallel Leiden runs finished
2024-03-16 21:13:06.819414 MEMORY 20.383690752
Quality: 0.39463767723333504
Quality: 0.3946417944076616
Quality: 0.3953470304364546
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 272 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 325 out of 325 | elapsed:    0.1s finished
Got subclusters: Counter({0: 112, 1: 91, 2: 87, 3: 51, 4: 9})
On pattern 22
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 325 samples in 0.003s...
[t-SNE] Computed neighbors for 325 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 325 / 325
[t-SNE] Mean sigma: 0.361600
[t-SNE] Computed conditional probabilities in 0.023s
[t-SNE] Iteration 50: error = 67.1868057, gradient norm = 0.4839426 (50 iterations in 0.049s)
[t-SNE] Iteration 100: error = 66.5348969, gradient norm = 0.4982282 (50 iterations in 0.048s)
[t-SNE] Iteration 150: error = 70.0431900, gradient norm = 0.4411142 (50 iterations in 0.049s)
[t-SNE] Iteration 200: error = 70.4526367, gradient norm = 0.4416489 (50 iterations in 0.048s)
[t-SNE] Iteration 250: error = 66.6204605, gradient norm = 0.4962681 (50 iterations in 0.047s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 66.620461
[t-SNE] Iteration 300: error = 1.3555913, gradient norm = 0.0059166 (50 iterations in 0.047s)
[t-SNE] Iteration 350: error = 1.1115425, gradient norm = 0.0045072 (50 iterations in 0.046s)
[t-SNE] Iteration 400: error = 1.0656526, gradient norm = 0.0011251 (50 iterations in 0.044s)
[t-SNE] Iteration 450: error = 1.0487504, gradient norm = 0.0003486 (50 iterations in 0.046s)
[t-SNE] Iteration 500: error = 1.0457110, gradient norm = 0.0001931 (50 iterations in 0.068s)
[t-SNE] Iteration 550: error = 1.0455933, gradient norm = 0.0000816 (50 iterations in 0.043s)
[t-SNE] Iteration 600: error = 1.0456052, gradient norm = 0.0001081 (50 iterations in 0.044s)
[t-SNE] Iteration 650: error = 1.0455064, gradient norm = 0.0001202 (50 iterations in 0.044s)
[t-SNE] Iteration 700: error = 1.0454565, gradient norm = 0.0001276 (50 iterations in 0.043s)
[t-SNE] Iteration 750: error = 1.0455537, gradient norm = 0.0001202 (50 iterations in 0.045s)
[t-SNE] Iteration 800: error = 1.0419033, gradient norm = 0.0002141 (50 iterations in 0.046s)
[t-SNE] Iteration 850: error = 1.0418088, gradient norm = 0.0000978 (50 iterations in 0.044s)
[t-SNE] Iteration 900: error = 1.0417389, gradient norm = 0.0001199 (50 iterations in 0.043s)
[t-SNE] Iteration 950: error = 1.0418826, gradient norm = 0.0001140 (50 iterations in 0.043s)
[t-SNE] Iteration 1000: error = 1.0417553, gradient norm = 0.0001255 (50 iterations in 0.046s)
[t-SNE] KL divergence after 1000 iterations: 1.041755
[t-SNE] Computed conditional probabilities for sample 325 / 325
[t-SNE] Mean sigma: 0.361600
Beginning preprocessing + Leiden
2024-03-16 21:13:08.273807 MEMORY 20.383690752
Affmat transformed
2024-03-16 21:13:08.278339 MEMORY 20.383690752
sources, targets, weights extracted
2024-03-16 21:13:08.280594 MEMORY 20.383690752
About to launch parallel Leiden runs
2024-03-16 21:13:08.285542 MEMORY 20.383690752
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.0s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.9s finished
Parallel Leiden runs finished
2024-03-16 21:13:11.235694 MEMORY 20.383690752
Quality: 0.3274831698262518
Quality: 0.32785633626815086
Quality: 0.3290448843144906
Quality: 0.32972083630535687
Quality: 0.3298668519015047
Quality: 0.33033592727259664
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 158 out of 158 | elapsed:    0.1s finished
Got subclusters: Counter({0: 101, 1: 76, 2: 75, 3: 38, 4: 35})
On pattern 23
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 158 samples in 0.002s...
[t-SNE] Computed neighbors for 158 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 158 / 158
[t-SNE] Mean sigma: 0.413004
[t-SNE] Computed conditional probabilities in 0.011s
[t-SNE] Iteration 50: error = 64.0034790, gradient norm = 0.5011979 (50 iterations in 0.082s)
[t-SNE] Iteration 100: error = 63.6120758, gradient norm = 0.4949770 (50 iterations in 0.031s)
[t-SNE] Iteration 150: error = 66.3978424, gradient norm = 0.4368163 (50 iterations in 0.031s)
[t-SNE] Iteration 200: error = 67.4158249, gradient norm = 0.3803442 (50 iterations in 0.031s)
[t-SNE] Iteration 250: error = 64.3548965, gradient norm = 0.4845392 (50 iterations in 0.035s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 64.354897
[t-SNE] Iteration 300: error = 0.9816772, gradient norm = 0.0099357 (50 iterations in 0.033s)
[t-SNE] Iteration 350: error = 0.6201005, gradient norm = 0.0062391 (50 iterations in 0.031s)
[t-SNE] Iteration 400: error = 0.6065745, gradient norm = 0.0004304 (50 iterations in 0.035s)
[t-SNE] Iteration 450: error = 0.6066316, gradient norm = 0.0002602 (50 iterations in 0.031s)
[t-SNE] Iteration 500: error = 0.6066456, gradient norm = 0.0002647 (50 iterations in 0.031s)
[t-SNE] Iteration 550: error = 0.6067425, gradient norm = 0.0002231 (50 iterations in 0.032s)
[t-SNE] Iteration 600: error = 0.6066698, gradient norm = 0.0002028 (50 iterations in 0.033s)
[t-SNE] Iteration 650: error = 0.6066302, gradient norm = 0.0001905 (50 iterations in 0.031s)
[t-SNE] Iteration 700: error = 0.6066342, gradient norm = 0.0002995 (50 iterations in 0.031s)
[t-SNE] Iteration 750: error = 0.6065452, gradient norm = 0.0002605 (50 iterations in 0.031s)
[t-SNE] Iteration 800: error = 0.6065872, gradient norm = 0.0002416 (50 iterations in 0.031s)
[t-SNE] Iteration 850: error = 0.6066111, gradient norm = 0.0002304 (50 iterations in 0.032s)
[t-SNE] Iteration 900: error = 0.6066234, gradient norm = 0.0002108 (50 iterations in 0.032s)
[t-SNE] Iteration 950: error = 0.6065803, gradient norm = 0.0003007 (50 iterations in 0.031s)
[t-SNE] Iteration 1000: error = 0.6066155, gradient norm = 0.0002567 (50 iterations in 0.032s)
[t-SNE] KL divergence after 1000 iterations: 0.606615
[t-SNE] Computed conditional probabilities for sample 158 / 158
[t-SNE] Mean sigma: 0.413004
Beginning preprocessing + Leiden
2024-03-16 21:13:12.233394 MEMORY 20.383690752
Affmat transformed
2024-03-16 21:13:12.236040 MEMORY 20.383690752
sources, targets, weights extracted
2024-03-16 21:13:12.236970 MEMORY 20.383690752
About to launch parallel Leiden runs
2024-03-16 21:13:12.241339 MEMORY 20.383690752
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.1s finished
Parallel Leiden runs finished
2024-03-16 21:13:14.371660 MEMORY 20.383690752
Quality: 0.23514529737323134
Quality: 0.23597013815658097
Quality: 0.236849662466145
Quality: 0.2379331386922674
Quality: 0.23847379073432223
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 152 out of 152 | elapsed:    0.0s finished
Got subclusters: Counter({0: 39, 1: 37, 2: 31, 3: 27, 4: 24})
On pattern 24
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 152 samples in 0.002s...
[t-SNE] Computed neighbors for 152 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 152 / 152
[t-SNE] Mean sigma: 0.424950
[t-SNE] Computed conditional probabilities in 0.011s
[t-SNE] Iteration 50: error = 61.2146149, gradient norm = 0.4907750 (50 iterations in 0.031s)
[t-SNE] Iteration 100: error = 59.5025368, gradient norm = 0.4823681 (50 iterations in 0.031s)
[t-SNE] Iteration 150: error = 55.6431198, gradient norm = 0.5863934 (50 iterations in 0.035s)
[t-SNE] Iteration 200: error = 59.6102486, gradient norm = 0.5296895 (50 iterations in 0.031s)
[t-SNE] Iteration 250: error = 59.0023651, gradient norm = 0.4936427 (50 iterations in 0.033s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 59.002365
[t-SNE] Iteration 300: error = 0.9584970, gradient norm = 0.0081272 (50 iterations in 0.033s)
[t-SNE] Iteration 350: error = 0.5887725, gradient norm = 0.0061346 (50 iterations in 0.039s)
[t-SNE] Iteration 400: error = 0.5778701, gradient norm = 0.0005947 (50 iterations in 0.031s)
[t-SNE] Iteration 450: error = 0.5778157, gradient norm = 0.0001809 (50 iterations in 0.030s)
[t-SNE] Iteration 500: error = 0.5779518, gradient norm = 0.0001996 (50 iterations in 0.031s)
[t-SNE] Iteration 550: error = 0.5778369, gradient norm = 0.0001548 (50 iterations in 0.033s)
[t-SNE] Iteration 600: error = 0.5778170, gradient norm = 0.0001744 (50 iterations in 0.032s)
[t-SNE] Iteration 650: error = 0.5777956, gradient norm = 0.0002018 (50 iterations in 0.032s)
[t-SNE] Iteration 700: error = 0.5780104, gradient norm = 0.0001600 (50 iterations in 0.032s)
[t-SNE] Iteration 750: error = 0.5777155, gradient norm = 0.0002022 (50 iterations in 0.030s)
[t-SNE] Iteration 800: error = 0.5777764, gradient norm = 0.0001777 (50 iterations in 0.032s)
[t-SNE] Iteration 850: error = 0.5778037, gradient norm = 0.0001675 (50 iterations in 0.032s)
[t-SNE] Iteration 900: error = 0.5778134, gradient norm = 0.0001445 (50 iterations in 0.032s)
[t-SNE] Iteration 950: error = 0.5778100, gradient norm = 0.0002361 (50 iterations in 0.031s)
[t-SNE] Iteration 1000: error = 0.5778264, gradient norm = 0.0001741 (50 iterations in 0.031s)
[t-SNE] KL divergence after 1000 iterations: 0.577826
[t-SNE] Computed conditional probabilities for sample 152 / 152
[t-SNE] Mean sigma: 0.424950
Beginning preprocessing + Leiden
2024-03-16 21:13:15.250715 MEMORY 20.383690752
Affmat transformed
2024-03-16 21:13:15.253006 MEMORY 20.383690752
sources, targets, weights extracted
2024-03-16 21:13:15.253919 MEMORY 20.383690752
About to launch parallel Leiden runs
2024-03-16 21:13:15.258261 MEMORY 20.383690752
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.0s finished
Parallel Leiden runs finished
2024-03-16 21:13:17.301595 MEMORY 20.383690752
Quality: 0.2471324851999588
Quality: 0.24791191091319187
Quality: 0.24815190067131865
Quality: 0.24871268281214629
Quality: 0.24975790150063923
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  68 out of 115 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=24)]: Done 115 out of 115 | elapsed:    0.0s finished
Got subclusters: Counter({0: 31, 1: 26, 2: 25, 3: 24, 4: 22, 5: 14, 6: 10})
On pattern 25
[t-SNE] Computing 114 nearest neighbors...
[t-SNE] Indexed 115 samples in 0.001s...
[t-SNE] Computed neighbors for 115 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 115 / 115
[t-SNE] Mean sigma: 0.428194
[t-SNE] Computed conditional probabilities in 0.006s
[t-SNE] Iteration 50: error = 57.5547104, gradient norm = 0.4657325 (50 iterations in 0.026s)
[t-SNE] Iteration 100: error = 54.6620407, gradient norm = 0.5162339 (50 iterations in 0.023s)
[t-SNE] Iteration 150: error = 53.7299690, gradient norm = 0.5236526 (50 iterations in 0.024s)
[t-SNE] Iteration 200: error = 53.9893532, gradient norm = 0.5938605 (50 iterations in 0.029s)
[t-SNE] Iteration 250: error = 57.6281128, gradient norm = 0.5367706 (50 iterations in 0.025s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 57.628113
[t-SNE] Iteration 300: error = 0.9794099, gradient norm = 0.0054205 (50 iterations in 0.026s)
[t-SNE] Iteration 350: error = 0.7420108, gradient norm = 0.0079744 (50 iterations in 0.024s)
[t-SNE] Iteration 400: error = 0.4120879, gradient norm = 0.0038889 (50 iterations in 0.025s)
[t-SNE] Iteration 450: error = 0.4115275, gradient norm = 0.0005093 (50 iterations in 0.024s)
[t-SNE] Iteration 500: error = 0.4111560, gradient norm = 0.0003342 (50 iterations in 0.026s)
[t-SNE] Iteration 550: error = 0.4113359, gradient norm = 0.0002718 (50 iterations in 0.022s)
[t-SNE] Iteration 600: error = 0.4111791, gradient norm = 0.0003457 (50 iterations in 0.025s)
[t-SNE] Iteration 650: error = 0.4113347, gradient norm = 0.0003099 (50 iterations in 0.022s)
[t-SNE] Iteration 700: error = 0.4113705, gradient norm = 0.0002377 (50 iterations in 0.026s)
[t-SNE] Iteration 750: error = 0.4113215, gradient norm = 0.0002544 (50 iterations in 0.022s)
[t-SNE] Iteration 800: error = 0.4112076, gradient norm = 0.0003398 (50 iterations in 0.029s)
[t-SNE] Iteration 850: error = 0.4113340, gradient norm = 0.0003150 (50 iterations in 0.024s)
[t-SNE] Iteration 850: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 850 iterations: 0.411334
[t-SNE] Computed conditional probabilities for sample 115 / 115
[t-SNE] Mean sigma: 0.428194
Beginning preprocessing + Leiden
2024-03-16 21:13:17.887752 MEMORY 20.383690752
Affmat transformed
2024-03-16 21:13:17.889384 MEMORY 20.383690752
sources, targets, weights extracted
2024-03-16 21:13:17.890090 MEMORY 20.383690752
About to launch parallel Leiden runs
2024-03-16 21:13:17.894320 MEMORY 20.383690752
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.9s finished
Parallel Leiden runs finished
2024-03-16 21:13:19.818001 MEMORY 20.383690752
Quality: 0.20750400183466336
Quality: 0.20769448364981893
Quality: 0.20838967927629318
Quality: 0.20889213693560507
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 104 out of 104 | elapsed:    0.0s finished
Got subclusters: Counter({0: 25, 2: 24, 1: 24, 3: 22, 4: 20})
On pattern 26
[t-SNE] Computing 103 nearest neighbors...
[t-SNE] Indexed 104 samples in 0.001s...
[t-SNE] Computed neighbors for 104 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 104 / 104
[t-SNE] Mean sigma: 0.488205
[t-SNE] Computed conditional probabilities in 0.005s
[t-SNE] Iteration 50: error = 58.5752258, gradient norm = 0.4514699 (50 iterations in 0.024s)
[t-SNE] Iteration 100: error = 56.5017357, gradient norm = 0.4252611 (50 iterations in 0.027s)
[t-SNE] Iteration 150: error = 59.3840408, gradient norm = 0.4878086 (50 iterations in 0.024s)
[t-SNE] Iteration 200: error = 57.0131874, gradient norm = 0.5127366 (50 iterations in 0.024s)
[t-SNE] Iteration 250: error = 55.3806915, gradient norm = 0.4568742 (50 iterations in 0.030s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 55.380692
[t-SNE] Iteration 300: error = 0.7844670, gradient norm = 0.0080911 (50 iterations in 0.026s)
[t-SNE] Iteration 350: error = 0.3437509, gradient norm = 0.0125293 (50 iterations in 0.026s)
[t-SNE] Iteration 400: error = 0.3163875, gradient norm = 0.0016809 (50 iterations in 0.025s)
[t-SNE] Iteration 450: error = 0.3160362, gradient norm = 0.0006045 (50 iterations in 0.027s)
[t-SNE] Iteration 500: error = 0.3159979, gradient norm = 0.0005247 (50 iterations in 0.025s)
[t-SNE] Iteration 550: error = 0.3161386, gradient norm = 0.0004505 (50 iterations in 0.026s)
[t-SNE] Iteration 600: error = 0.3160439, gradient norm = 0.0005482 (50 iterations in 0.030s)
[t-SNE] Iteration 650: error = 0.3159514, gradient norm = 0.0005280 (50 iterations in 0.024s)
[t-SNE] Iteration 700: error = 0.3161468, gradient norm = 0.0006111 (50 iterations in 0.025s)
[t-SNE] Iteration 750: error = 0.3159894, gradient norm = 0.0004186 (50 iterations in 0.024s)
[t-SNE] Iteration 800: error = 0.3160025, gradient norm = 0.0005860 (50 iterations in 0.024s)
[t-SNE] Iteration 850: error = 0.3160820, gradient norm = 0.0005198 (50 iterations in 0.025s)
[t-SNE] Iteration 900: error = 0.3161072, gradient norm = 0.0004560 (50 iterations in 0.027s)
[t-SNE] Iteration 950: error = 0.3157958, gradient norm = 0.0005245 (50 iterations in 0.026s)
[t-SNE] Iteration 1000: error = 0.3160956, gradient norm = 0.0005475 (50 iterations in 0.024s)
[t-SNE] KL divergence after 1000 iterations: 0.316096
[t-SNE] Computed conditional probabilities for sample 104 / 104
[t-SNE] Mean sigma: 0.488205
Beginning preprocessing + Leiden
2024-03-16 21:13:20.470937 MEMORY 20.383690752
Affmat transformed
2024-03-16 21:13:20.472549 MEMORY 20.383690752
sources, targets, weights extracted
2024-03-16 21:13:20.473249 MEMORY 20.383690752
About to launch parallel Leiden runs
2024-03-16 21:13:20.477630 MEMORY 20.383690752
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.8s finished
Parallel Leiden runs finished
2024-03-16 21:13:22.299052 MEMORY 20.383690752
Quality: 0.2090708058134722
Quality: 0.2097450995440868
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  52 out of  99 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=24)]: Done  99 out of  99 | elapsed:    0.0s finished
Got subclusters: Counter({0: 35, 1: 29, 2: 28, 3: 10, 4: 2})
On pattern 27
[t-SNE] Computing 98 nearest neighbors...
[t-SNE] Indexed 99 samples in 0.001s...
[t-SNE] Computed neighbors for 99 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 99 / 99
[t-SNE] Mean sigma: 0.519449
[t-SNE] Computed conditional probabilities in 0.004s
[t-SNE] Iteration 50: error = 55.1307068, gradient norm = 0.4813334 (50 iterations in 0.020s)
[t-SNE] Iteration 100: error = 60.3989830, gradient norm = 0.4714880 (50 iterations in 0.020s)
[t-SNE] Iteration 150: error = 52.6256180, gradient norm = 0.6087611 (50 iterations in 0.020s)
[t-SNE] Iteration 200: error = 56.4791527, gradient norm = 0.4774024 (50 iterations in 0.019s)
[t-SNE] Iteration 250: error = 55.0518227, gradient norm = 0.5257679 (50 iterations in 0.020s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 55.051823
[t-SNE] Iteration 300: error = 0.8567742, gradient norm = 0.0064193 (50 iterations in 0.018s)
[t-SNE] Iteration 350: error = 0.4134455, gradient norm = 0.0273884 (50 iterations in 0.018s)
[t-SNE] Iteration 400: error = 0.2627904, gradient norm = 0.0030613 (50 iterations in 0.019s)
[t-SNE] Iteration 450: error = 0.2626904, gradient norm = 0.0005013 (50 iterations in 0.018s)
[t-SNE] Iteration 500: error = 0.2623062, gradient norm = 0.0009464 (50 iterations in 0.019s)
[t-SNE] Iteration 550: error = 0.2623617, gradient norm = 0.0008643 (50 iterations in 0.020s)
[t-SNE] Iteration 600: error = 0.2623811, gradient norm = 0.0007154 (50 iterations in 0.018s)
[t-SNE] Iteration 650: error = 0.2624412, gradient norm = 0.0014790 (50 iterations in 0.019s)
[t-SNE] Iteration 700: error = 0.2624265, gradient norm = 0.0007781 (50 iterations in 0.020s)
[t-SNE] Iteration 750: error = 0.2623768, gradient norm = 0.0008357 (50 iterations in 0.019s)
[t-SNE] Iteration 800: error = 0.2625061, gradient norm = 0.0008490 (50 iterations in 0.021s)
[t-SNE] Iteration 850: error = 0.2624105, gradient norm = 0.0008427 (50 iterations in 0.019s)
[t-SNE] Iteration 850: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 850 iterations: 0.262410
[t-SNE] Computed conditional probabilities for sample 99 / 99
[t-SNE] Mean sigma: 0.519449
Beginning preprocessing + Leiden
2024-03-16 21:13:22.754037 MEMORY 20.383690752
Affmat transformed
2024-03-16 21:13:22.755340 MEMORY 20.383690752
sources, targets, weights extracted
2024-03-16 21:13:22.755899 MEMORY 20.383690752
About to launch parallel Leiden runs
2024-03-16 21:13:22.774912 MEMORY 20.383690752
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.8s finished
Parallel Leiden runs finished
2024-03-16 21:13:24.610060 MEMORY 20.383690752
Quality: 0.20633126012223507
Quality: 0.20639009128858768
Quality: 0.20709643856527005
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  87 out of  87 | elapsed:    0.0s finished
Got subclusters: Counter({0: 37, 1: 32, 2: 19, 3: 11})
On pattern 28
[t-SNE] Computing 86 nearest neighbors...
[t-SNE] Indexed 87 samples in 0.001s...
[t-SNE] Computed neighbors for 87 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 87 / 87
[t-SNE] Mean sigma: 0.544990
[t-SNE] Computed conditional probabilities in 0.004s
[t-SNE] Iteration 50: error = 51.4992180, gradient norm = 0.5223513 (50 iterations in 0.021s)
[t-SNE] Iteration 100: error = 51.6716423, gradient norm = 0.4809851 (50 iterations in 0.018s)
[t-SNE] Iteration 150: error = 53.1422195, gradient norm = 0.5203794 (50 iterations in 0.020s)
[t-SNE] Iteration 200: error = 52.2000694, gradient norm = 0.5323925 (50 iterations in 0.018s)
[t-SNE] Iteration 250: error = 48.4484444, gradient norm = 0.5665330 (50 iterations in 0.018s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 48.448444
[t-SNE] Iteration 300: error = 0.7272893, gradient norm = 0.0083317 (50 iterations in 0.021s)
[t-SNE] Iteration 350: error = 0.2703367, gradient norm = 0.0129800 (50 iterations in 0.020s)
[t-SNE] Iteration 400: error = 0.2595208, gradient norm = 0.0018097 (50 iterations in 0.022s)
[t-SNE] Iteration 450: error = 0.2594378, gradient norm = 0.0002234 (50 iterations in 0.018s)
[t-SNE] Iteration 500: error = 0.2594295, gradient norm = 0.0003637 (50 iterations in 0.018s)
[t-SNE] Iteration 550: error = 0.2594392, gradient norm = 0.0002965 (50 iterations in 0.020s)
[t-SNE] Iteration 600: error = 0.2594833, gradient norm = 0.0003547 (50 iterations in 0.017s)
[t-SNE] Iteration 650: error = 0.2594895, gradient norm = 0.0003178 (50 iterations in 0.017s)
[t-SNE] Iteration 700: error = 0.2594308, gradient norm = 0.0004105 (50 iterations in 0.020s)
[t-SNE] Iteration 750: error = 0.2594590, gradient norm = 0.0003915 (50 iterations in 0.017s)
[t-SNE] Iteration 800: error = 0.2594177, gradient norm = 0.0003496 (50 iterations in 0.017s)
[t-SNE] Iteration 850: error = 0.2594077, gradient norm = 0.0003889 (50 iterations in 0.019s)
[t-SNE] Iteration 900: error = 0.2594421, gradient norm = 0.0002550 (50 iterations in 0.017s)
[t-SNE] Iteration 950: error = 0.2594108, gradient norm = 0.0003412 (50 iterations in 0.020s)
[t-SNE] Iteration 1000: error = 0.2594015, gradient norm = 0.0003099 (50 iterations in 0.020s)
[t-SNE] KL divergence after 1000 iterations: 0.259402
[t-SNE] Computed conditional probabilities for sample 87 / 87
[t-SNE] Mean sigma: 0.544990
Beginning preprocessing + Leiden
2024-03-16 21:13:25.103458 MEMORY 20.383690752
Affmat transformed
2024-03-16 21:13:25.104737 MEMORY 20.383690752
sources, targets, weights extracted
2024-03-16 21:13:25.105278 MEMORY 20.383690752
About to launch parallel Leiden runs
2024-03-16 21:13:25.124934 MEMORY 20.383690752
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.8s finished
Parallel Leiden runs finished
2024-03-16 21:13:26.973860 MEMORY 20.383690752
Quality: 0.18449379689878595
Quality: 0.18498056665029736
Quality: 0.18536667907031482
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  76 out of  76 | elapsed:    0.0s finished
Got subclusters: Counter({0: 24, 1: 22, 2: 20, 3: 19, 4: 2})
On pattern 29
[t-SNE] Computing 75 nearest neighbors...
[t-SNE] Indexed 76 samples in 0.001s...
[t-SNE] Computed neighbors for 76 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 76 / 76
[t-SNE] Mean sigma: 0.638910
[t-SNE] Computed conditional probabilities in 0.003s
[t-SNE] Iteration 50: error = 50.6248932, gradient norm = 0.4406761 (50 iterations in 0.018s)
[t-SNE] Iteration 100: error = 51.9544601, gradient norm = 0.5014388 (50 iterations in 0.018s)
[t-SNE] Iteration 150: error = 47.7466927, gradient norm = 0.6398029 (50 iterations in 0.018s)
[t-SNE] Iteration 200: error = 52.2471848, gradient norm = 0.5487220 (50 iterations in 0.020s)
[t-SNE] Iteration 250: error = 48.2769775, gradient norm = 0.6211963 (50 iterations in 0.021s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 48.276978
[t-SNE] Iteration 300: error = 0.9711639, gradient norm = 0.0022080 (50 iterations in 0.019s)
[t-SNE] Iteration 350: error = 0.8358914, gradient norm = 0.0012194 (50 iterations in 0.019s)
[t-SNE] Iteration 400: error = 0.7665014, gradient norm = 0.0016172 (50 iterations in 0.016s)
[t-SNE] Iteration 450: error = 0.7283710, gradient norm = 0.0008165 (50 iterations in 0.017s)
[t-SNE] Iteration 500: error = 0.6908432, gradient norm = 0.0006678 (50 iterations in 0.017s)
[t-SNE] Iteration 550: error = 0.6676130, gradient norm = 0.0005004 (50 iterations in 0.016s)
[t-SNE] Iteration 600: error = 0.6258366, gradient norm = 0.0014556 (50 iterations in 0.018s)
[t-SNE] Iteration 650: error = 0.5470455, gradient norm = 0.0024049 (50 iterations in 0.020s)
[t-SNE] Iteration 700: error = 0.4547084, gradient norm = 0.0016032 (50 iterations in 0.019s)
[t-SNE] Iteration 750: error = 0.3710523, gradient norm = 0.0060462 (50 iterations in 0.021s)
[t-SNE] Iteration 800: error = 0.1471353, gradient norm = 0.0094467 (50 iterations in 0.017s)
[t-SNE] Iteration 850: error = 0.1432954, gradient norm = 0.0015836 (50 iterations in 0.019s)
[t-SNE] Iteration 900: error = 0.1433977, gradient norm = 0.0005209 (50 iterations in 0.017s)
[t-SNE] Iteration 950: error = 0.1432953, gradient norm = 0.0008899 (50 iterations in 0.018s)
[t-SNE] Iteration 1000: error = 0.1432752, gradient norm = 0.0007723 (50 iterations in 0.018s)
[t-SNE] KL divergence after 1000 iterations: 0.143275
[t-SNE] Computed conditional probabilities for sample 76 / 76
[t-SNE] Mean sigma: 0.638910
Beginning preprocessing + Leiden
2024-03-16 21:13:27.443694 MEMORY 20.383690752
Affmat transformed
2024-03-16 21:13:27.444951 MEMORY 20.383690752
sources, targets, weights extracted
2024-03-16 21:13:27.445472 MEMORY 20.383690752
About to launch parallel Leiden runs
2024-03-16 21:13:27.449825 MEMORY 20.383690752
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.6s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.7s finished
Parallel Leiden runs finished
2024-03-16 21:13:29.171289 MEMORY 20.383690752
Quality: 0.19248217556118244
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  74 out of  74 | elapsed:    0.0s finished
Got subclusters: Counter({0: 27, 1: 19, 2: 18, 3: 12})
On pattern 30
[t-SNE] Computing 73 nearest neighbors...
[t-SNE] Indexed 74 samples in 0.001s...
[t-SNE] Computed neighbors for 74 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 74 / 74
[t-SNE] Mean sigma: 0.581866
[t-SNE] Computed conditional probabilities in 0.003s
[t-SNE] Iteration 50: error = 54.5159836, gradient norm = 0.4180845 (50 iterations in 0.014s)
[t-SNE] Iteration 100: error = 50.8262596, gradient norm = 0.5087460 (50 iterations in 0.013s)
[t-SNE] Iteration 150: error = 48.5031395, gradient norm = 0.6037506 (50 iterations in 0.014s)
[t-SNE] Iteration 200: error = 49.4394684, gradient norm = 0.6016719 (50 iterations in 0.014s)
[t-SNE] Iteration 250: error = 46.3827400, gradient norm = 0.5873417 (50 iterations in 0.013s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 46.382740
[t-SNE] Iteration 300: error = 0.8171698, gradient norm = 0.0028165 (50 iterations in 0.013s)
[t-SNE] Iteration 350: error = 0.7152270, gradient norm = 0.0012636 (50 iterations in 0.015s)
[t-SNE] Iteration 400: error = 0.6714576, gradient norm = 0.0006528 (50 iterations in 0.014s)
[t-SNE] Iteration 450: error = 0.6345447, gradient norm = 0.0018188 (50 iterations in 0.014s)
[t-SNE] Iteration 500: error = 0.5808986, gradient norm = 0.0024103 (50 iterations in 0.015s)
[t-SNE] Iteration 550: error = 0.8400028, gradient norm = 0.0395165 (50 iterations in 0.016s)
[t-SNE] Iteration 600: error = 0.6172835, gradient norm = 0.0033346 (50 iterations in 0.013s)
[t-SNE] Iteration 650: error = 0.5344325, gradient norm = 0.0014392 (50 iterations in 0.015s)
[t-SNE] Iteration 700: error = 0.5006583, gradient norm = 0.0017712 (50 iterations in 0.015s)
[t-SNE] Iteration 750: error = 0.2187180, gradient norm = 0.0289137 (50 iterations in 0.014s)
[t-SNE] Iteration 800: error = 0.1605700, gradient norm = 0.0047876 (50 iterations in 0.014s)
[t-SNE] Iteration 850: error = 0.1597268, gradient norm = 0.0010097 (50 iterations in 0.014s)
[t-SNE] Iteration 900: error = 0.1589259, gradient norm = 0.0013913 (50 iterations in 0.015s)
[t-SNE] Iteration 950: error = 0.1590060, gradient norm = 0.0014559 (50 iterations in 0.014s)
[t-SNE] Iteration 1000: error = 0.1592113, gradient norm = 0.0010572 (50 iterations in 0.014s)
[t-SNE] KL divergence after 1000 iterations: 0.159211
[t-SNE] Computed conditional probabilities for sample 74 / 74
[t-SNE] Mean sigma: 0.581865
Beginning preprocessing + Leiden
2024-03-16 21:13:29.543717 MEMORY 20.383690752
Affmat transformed
2024-03-16 21:13:29.544907 MEMORY 20.383690752
sources, targets, weights extracted
2024-03-16 21:13:29.545406 MEMORY 20.383690752
About to launch parallel Leiden runs
2024-03-16 21:13:29.549949 MEMORY 20.383690752
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.6s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.8s finished
Parallel Leiden runs finished
2024-03-16 21:13:31.356028 MEMORY 20.383690752
Quality: 0.16258488470813567
Quality: 0.16345578122310633
Quality: 0.1642026038680563
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  62 out of  62 | elapsed:    0.0s finished
Got subclusters: Counter({0: 23, 1: 21, 2: 17, 3: 13})
On pattern 31
[t-SNE] Computing 61 nearest neighbors...
[t-SNE] Indexed 62 samples in 0.001s...
[t-SNE] Computed neighbors for 62 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 62 / 62
[t-SNE] Mean sigma: 0.856914
[t-SNE] Computed conditional probabilities in 0.002s
[t-SNE] Iteration 50: error = 47.4679260, gradient norm = 0.4307926 (50 iterations in 0.017s)
[t-SNE] Iteration 100: error = 47.8024292, gradient norm = 0.5019284 (50 iterations in 0.012s)
[t-SNE] Iteration 150: error = 44.2261353, gradient norm = 0.5535204 (50 iterations in 0.014s)
[t-SNE] Iteration 200: error = 51.1421547, gradient norm = 0.5451021 (50 iterations in 0.013s)
[t-SNE] Iteration 250: error = 46.7502441, gradient norm = 0.5749698 (50 iterations in 0.013s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 46.750244
[t-SNE] Iteration 300: error = 0.7519944, gradient norm = 0.0018351 (50 iterations in 0.012s)
[t-SNE] Iteration 350: error = 0.6449236, gradient norm = 0.0008270 (50 iterations in 0.013s)
[t-SNE] Iteration 400: error = 0.6074479, gradient norm = 0.0004677 (50 iterations in 0.012s)
[t-SNE] Iteration 450: error = 0.5913016, gradient norm = 0.0002451 (50 iterations in 0.016s)
[t-SNE] Iteration 500: error = 0.5787107, gradient norm = 0.0002129 (50 iterations in 0.012s)
[t-SNE] Iteration 550: error = 0.5606789, gradient norm = 0.0005798 (50 iterations in 0.013s)
[t-SNE] Iteration 600: error = 0.5456152, gradient norm = 0.0002381 (50 iterations in 0.012s)
[t-SNE] Iteration 650: error = 0.5315672, gradient norm = 0.0005017 (50 iterations in 0.013s)
[t-SNE] Iteration 700: error = 0.5192639, gradient norm = 0.0002886 (50 iterations in 0.012s)
[t-SNE] Iteration 750: error = 0.5123943, gradient norm = 0.0001803 (50 iterations in 0.014s)
[t-SNE] Iteration 800: error = 0.4943099, gradient norm = 0.0006137 (50 iterations in 0.013s)
[t-SNE] Iteration 850: error = 0.4863105, gradient norm = 0.0002141 (50 iterations in 0.014s)
[t-SNE] Iteration 900: error = 1.1450093, gradient norm = 0.0038282 (50 iterations in 0.015s)
[t-SNE] Iteration 950: error = 0.9003254, gradient norm = 0.0006462 (50 iterations in 0.013s)
[t-SNE] Iteration 1000: error = 0.7948095, gradient norm = 0.0003475 (50 iterations in 0.012s)
[t-SNE] KL divergence after 1000 iterations: 0.794809
[t-SNE] Computed conditional probabilities for sample 62 / 62
[t-SNE] Mean sigma: 0.856915
Beginning preprocessing + Leiden
2024-03-16 21:13:31.696639 MEMORY 20.383690752
Affmat transformed
2024-03-16 21:13:31.697776 MEMORY 20.383690752
sources, targets, weights extracted
2024-03-16 21:13:31.698248 MEMORY 20.383690752
About to launch parallel Leiden runs
2024-03-16 21:13:31.702148 MEMORY 20.383690752
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.6s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.7s finished
Parallel Leiden runs finished
2024-03-16 21:13:33.441449 MEMORY 20.383690752
Quality: 0.1038689991065577
Got subclusters: Counter({0: 32, 1: 30})
