/ru-auth/local/home/xwu05/.local/lib/python3.9/site-packages/pandas/core/computation/expressions.py:21: UserWarning: Pandas requires version '2.8.0' or newer of 'numexpr' (version '2.7.3' currently installed).
  from pandas.core.computation.check import NUMEXPR_INSTALLED
/ru-auth/local/home/xwu05/.local/lib/python3.9/site-packages/pandas/core/arrays/masked.py:62: UserWarning: Pandas requires version '1.3.4' or newer of 'bottleneck' (version '1.3.2' currently installed).
  from pandas.core import (
[22;0t]0;IPython: detect_peaks_scripts/run_modelMEMORY 0.69963776
On task head
Computing windowed sums on original
Generating null dist
peak(mu)= 5.575513422217786e-06
Computing threshold
Subsampling!
For increasing = True , the minimum IR precision was 0.41539715000724764 occurring at 0.0 implying a frac_neg of 0.7105629916316649
To be conservative, adjusted frac neg is 0.95
For increasing = False , the minimum IR precision was 0.35782453360458766 occurring at -5.544183556693838e-08 implying a frac_neg of 0.5572067952285509
To be conservative, adjusted frac neg is 0.95
Thresholds from null dist were -0.5082294415267357  and  0.49217394585247787 with frac passing 0.087681
Final raw thresholds are -0.5082294415267357  and  0.49217394585247787
Final transformed thresholds are -0.9142370402447942  and  0.9090323028715933
saving plot to figures/scoredist_0.png
Got 15667 coords
On task testis
Computing windowed sums on original
Generating null dist
peak(mu)= -5.848456473557008e-06
Computing threshold
Subsampling!
For increasing = True , the minimum IR precision was 0.41484657083015586 occurring at 0.0 implying a frac_neg of 0.7089534986041145
To be conservative, adjusted frac neg is 0.95
For increasing = False , the minimum IR precision was 0.42405116360176187 occurring at -2.502579583563147e-07 implying a frac_neg of 0.73626533609064
To be conservative, adjusted frac neg is 0.95
Thresholds from null dist were -0.8902822348459907  and  0.6714440289515329 with frac passing 0.044452
Final raw thresholds are -0.8902822348459907  and  0.6714440289515329
Final transformed thresholds are -0.9672747030971047  and  0.9338638842701724
saving plot to figures/scoredist_1.png
Got 9307 coords
After resolving overlaps, got 16211 seqlets
Across all tasks, the weakest transformed threshold used was: 0.9089323028715933
MEMORY 1.012248576
16211 identified in total
min_metacluster_size_frac * len(seqlets) = 162 is more than min_metacluster_size=100.
Using it as a new min_metacluster_size
5 activity patterns with support >= 162 out of 8 possible patterns
Metacluster sizes:  [8908, 6235, 423, 383, 232]
Idx to activities:  {0: '-1,-1', 1: '1,1', 2: '-1,0', 3: '1,0', 4: '0,1'}
MEMORY 1.012457472
On metacluster 4
Metacluster size 232
Relevant tasks:  ('testis',)
Relevant signs:  (1,)
TfModiscoSeqletsToPatternsFactory: seed=1234
(Round 1) num seqlets: 232
(Round 1) Computing coarse affmat
2024-03-11 18:30:56.023191 MEMORY 1.01246976
Beginning embedding computation
MEMORY 1.01246976
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
At the beginning of embedding call
2024-03-11 18:30:56.023401 MEMORY 1.01246976
before computing embeddings fwd
2024-03-11 18:30:56.032051 MEMORY 1.013006336
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    2.5s
[Parallel(n_jobs=24)]: Done 152 tasks      | elapsed:    4.3s
[Parallel(n_jobs=24)]: Done 232 out of 232 | elapsed:    5.3s finished
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 152 tasks      | elapsed:    2.1s
[Parallel(n_jobs=24)]: Done 232 out of 232 | elapsed:    3.0s finished
after computing embeddings fwd
2024-03-11 18:31:01.376907 MEMORY 1.011298304
after computing embeddings rev
2024-03-11 18:31:04.340323 MEMORY 1.02100992
before computing sparse embeddings fwd
2024-03-11 18:31:04.340477 MEMORY 1.02100992
Constructing csr matrix...
csr matrix made in 0.2120506763458252 s
after computing sparse embeddings fwd
2024-03-11 18:31:04.563525 MEMORY 1.021075456
before computing sparse embeddings rev
2024-03-11 18:31:04.563602 MEMORY 1.021075456
Constructing csr matrix...
csr matrix made in 0.024944782257080078 s
after computing sparse embeddings rev
2024-03-11 18:31:04.595991 MEMORY 1.021108224
Finished embedding computation in 8.76 s
MEMORY 1.015414784
Starting affinity matrix computations
MEMORY 1.01515264
Batching in slices of size 232
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:01<00:00,  1.04s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:01<00:00,  1.07s/it]
Finished affinity matrix computations in 1.12 s
MEMORY 1.015324672
(Round 1) Computed coarse affmat
2024-03-11 18:31:06.046007 MEMORY 1.015324672
(Round 1) Computing affinity matrix on nearest neighbors
2024-03-11 18:31:06.046137 MEMORY 1.015324672
Launching nearest neighbors affmat calculation job
MEMORY 1.015324672
Parallel runs completed
MEMORY 1.058148352
Job completed in: 0.67 s
MEMORY 1.06008576
Launching nearest neighbors affmat calculation job
MEMORY 1.061408768
Parallel runs completed
MEMORY 1.082802176
Job completed in: 0.64 s
MEMORY 1.083170816
(Round 1) Computed affinity matrix on nearest neighbors in 1.45 s
2024-03-11 18:31:07.495440 MEMORY 1.083387904
Filtered down to 232 of 232
(Round 1) Retained 232 rows out of 232 after filtering
2024-03-11 18:31:07.718598 MEMORY 1.085591552
(Round 1) Computing density adapted affmat
2024-03-11 18:31:07.845855 MEMORY 1.085841408
Symmetrizing nearest neighbors
Computing betas for density adaptation
Computing normalizing denominators
(Round 1) Computing clustering
2024-03-11 18:31:08.377158 MEMORY 1.085820928
Beginning preprocessing + Leiden
2024-03-11 18:31:08.377477 MEMORY 1.085820928
Affmat transformed
2024-03-11 18:31:08.377581 MEMORY 1.085820928
sources, targets, weights extracted
2024-03-11 18:31:08.406903 MEMORY 1.0858496
About to launch parallel Leiden runs
2024-03-11 18:31:08.441335 MEMORY 1.085857792
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.8s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    3.6s finished
Parallel Leiden runs finished
2024-03-11 18:31:12.027409 MEMORY 1.085550592
Quality: 0.023980662209078858
Quality: 0.023990066655968718
Quality: 0.02399358616966793
Quality: 0.023994279444867213
Quality: 0.02399472614538538
Got 4 clusters after round 1
Counts:
{0: 93, 1: 85, 2: 47, 3: 7}
2024-03-11 18:31:12.030394 MEMORY 1.085550592
(Round 1) Aggregating seqlets in each cluster
2024-03-11 18:31:12.030477 MEMORY 1.085550592
Aggregating for cluster 0 with 93 seqlets
2024-03-11 18:31:12.030768 MEMORY 1.085550592
Trimming eliminated 0 seqlets out of 93
Aggregating for cluster 1 with 85 seqlets
2024-03-11 18:31:12.235674 MEMORY 1.085550592
Trimming eliminated 0 seqlets out of 85
Aggregating for cluster 2 with 47 seqlets
2024-03-11 18:31:12.376023 MEMORY 1.085550592
Trimming eliminated 0 seqlets out of 47
Aggregating for cluster 3 with 7 seqlets
2024-03-11 18:31:12.465649 MEMORY 1.085550592
Trimming eliminated 0 seqlets out of 7
(Round 2) num seqlets: 232
(Round 2) Computing coarse affmat
2024-03-11 18:31:12.652326 MEMORY 1.085394944
Beginning embedding computation
MEMORY 1.085394944
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 232 out of 232 | elapsed:    0.6s finished
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 232 out of 232 | elapsed:    0.6s finished
At the beginning of embedding call
2024-03-11 18:31:12.652538 MEMORY 1.085394944
before computing embeddings fwd
2024-03-11 18:31:12.661216 MEMORY 1.085394944
after computing embeddings fwd
2024-03-11 18:31:13.264246 MEMORY 1.086959616
after computing embeddings rev
2024-03-11 18:31:13.897724 MEMORY 1.095032832
before computing sparse embeddings fwd
2024-03-11 18:31:13.897809 MEMORY 1.095032832
Constructing csr matrix...
csr matrix made in 0.026894092559814453 s
after computing sparse embeddings fwd
2024-03-11 18:31:13.931894 MEMORY 1.095032832
before computing sparse embeddings rev
2024-03-11 18:31:13.931958 MEMORY 1.095032832
Constructing csr matrix...
csr matrix made in 0.02564239501953125 s
after computing sparse embeddings rev
2024-03-11 18:31:13.965163 MEMORY 1.095102464
Finished embedding computation in 1.48 s
MEMORY 1.089073152
Starting affinity matrix computations
MEMORY 1.089073152
Batching in slices of size 232
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:01<00:00,  1.02s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:01<00:00,  1.02s/it]
Finished affinity matrix computations in 1.02 s
MEMORY 1.089093632
(Round 2) Computed coarse affmat
2024-03-11 18:31:15.277304 MEMORY 1.089093632
(Round 2) Computing affinity matrix on nearest neighbors
2024-03-11 18:31:15.277431 MEMORY 1.089093632
Launching nearest neighbors affmat calculation job
MEMORY 1.089093632
Parallel runs completed
MEMORY 1.098907648
Job completed in: 0.35 s
MEMORY 1.09871104
Launching nearest neighbors affmat calculation job
MEMORY 1.098489856
Parallel runs completed
MEMORY 1.10743552
Job completed in: 0.34 s
MEMORY 1.107329024
(Round 2) Computed affinity matrix on nearest neighbors in 0.83 s
2024-03-11 18:31:16.109552 MEMORY 1.107263488
Not applying filtering for rounds above first round
2024-03-11 18:31:16.109722 MEMORY 1.107263488
(Round 2) Computing density adapted affmat
2024-03-11 18:31:16.238680 MEMORY 1.107263488
Symmetrizing nearest neighbors
Computing betas for density adaptation
Computing normalizing denominators
(Round 2) Computing clustering
2024-03-11 18:31:16.745644 MEMORY 1.107193856
Beginning preprocessing + Leiden
2024-03-11 18:31:16.745962 MEMORY 1.107193856
Affmat transformed
2024-03-11 18:31:16.746049 MEMORY 1.107193856
sources, targets, weights extracted
2024-03-11 18:31:16.747327 MEMORY 1.107193856
About to launch parallel Leiden runs
2024-03-11 18:31:16.793280 MEMORY 1.107206144
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.8s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.2s finished
Parallel Leiden runs finished
2024-03-11 18:31:18.984789 MEMORY 1.107202048
Quality: 0.02698087226418544
Quality: 0.027372762380824804
Got 3 clusters after round 2
Counts:
{0: 93, 2: 54, 1: 85}
2024-03-11 18:31:18.987394 MEMORY 1.107202048
(Round 2) Aggregating seqlets in each cluster
2024-03-11 18:31:18.987474 MEMORY 1.107202048
Aggregating for cluster 0 with 93 seqlets
2024-03-11 18:31:18.987684 MEMORY 1.107202048
Trimming eliminated 0 seqlets out of 93
Aggregating for cluster 1 with 85 seqlets
2024-03-11 18:31:19.135693 MEMORY 1.107202048
Trimming eliminated 0 seqlets out of 85
Aggregating for cluster 2 with 54 seqlets
2024-03-11 18:31:19.253931 MEMORY 1.107202048
Trimming eliminated 0 seqlets out of 54
Got 3 clusters
Splitting into subclusters...
2024-03-11 18:31:19.331573 MEMORY 1.107202048
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  93 out of  93 | elapsed:    0.0s finished
Inspecting pattern 0 for spurious merging
[t-SNE] Computed conditional probabilities for sample 93 / 93
[t-SNE] Mean sigma: 0.592657
Beginning preprocessing + Leiden
2024-03-11 18:31:19.420689 MEMORY 1.107304448
Affmat transformed
2024-03-11 18:31:19.456471 MEMORY 1.10731264
sources, targets, weights extracted
2024-03-11 18:31:19.456962 MEMORY 1.107316736
About to launch parallel Leiden runs
2024-03-11 18:31:19.483002 MEMORY 1.107316736
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.6s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.0s finished
Parallel Leiden runs finished
2024-03-11 18:31:21.501199 MEMORY 1.107316736
Quality: 0.19933801339859594
Quality: 0.1993812073199777
Got subclusters: Counter({0: 24, 1: 23, 2: 18, 3: 15, 4: 13})
On merging iteration 1
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  85 out of  85 | elapsed:    0.0s finished
Numbers for each pattern pre-subsample: [24, 23, 18, 15, 13]
Numbers after subsampling: [24, 23, 18, 15, 13]
Computing sims for pattern 0
Computed sims for pattern 0 in 0.12268447875976562 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.07280659675598145 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.06090855598449707 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.054364919662475586 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.047186851501464844 s
Cluster sizes
[24 23 18 15 13]
Cross-contamination matrix:
[[1.   0.7  0.75 0.76 0.79]
 [0.32 1.   0.38 0.59 0.72]
 [0.41 0.47 1.   0.58 0.7 ]
 [0.32 0.55 0.42 1.   0.53]
 [0.23 0.4  0.25 0.28 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.7  0.75 0.74 0.65]
 [0.7  1.   0.74 0.79 0.76]
 [0.75 0.74 1.   0.79 0.58]
 [0.74 0.79 0.79 1.   0.65]
 [0.65 0.76 0.58 0.65 1.  ]]
Inspecting pattern 1 for spurious merging
[t-SNE] Computed conditional probabilities for sample 85 / 85
[t-SNE] Mean sigma: 0.581556
Beginning preprocessing + Leiden
2024-03-11 18:31:21.959192 MEMORY 1.107345408
Affmat transformed
2024-03-11 18:31:21.960220 MEMORY 1.107345408
sources, targets, weights extracted
2024-03-11 18:31:21.960622 MEMORY 1.107345408
About to launch parallel Leiden runs
2024-03-11 18:31:21.994194 MEMORY 1.107349504
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.8s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.9s finished
Parallel Leiden runs finished
2024-03-11 18:31:23.922125 MEMORY 1.107349504
Quality: 0.16767618386319846
Quality: 0.1678359419683745
Got subclusters: Counter({0: 24, 1: 22, 2: 21, 3: 18})
On merging iteration 1
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  54 out of  54 | elapsed:    0.0s finished
Numbers for each pattern pre-subsample: [24, 22, 21, 18]
Numbers after subsampling: [24, 22, 21, 18]
Computing sims for pattern 0
Computed sims for pattern 0 in 0.06139993667602539 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.056292057037353516 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.05127263069152832 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.045424461364746094 s
Cluster sizes
[24 22 21 18]
Cross-contamination matrix:
[[1.   0.82 0.69 0.47]
 [0.44 1.   0.54 0.27]
 [0.5  0.74 1.   0.42]
 [0.85 0.91 0.92 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.7  0.72 0.59]
 [0.7  1.   0.71 0.54]
 [0.72 0.71 1.   0.71]
 [0.59 0.54 0.71 1.  ]]
Inspecting pattern 2 for spurious merging
[t-SNE] Computed conditional probabilities for sample 54 / 54
[t-SNE] Mean sigma: 0.994671
Beginning preprocessing + Leiden
2024-03-11 18:31:24.196952 MEMORY 1.107349504
Affmat transformed
2024-03-11 18:31:24.197741 MEMORY 1.107349504
sources, targets, weights extracted
2024-03-11 18:31:24.198064 MEMORY 1.107349504
About to launch parallel Leiden runs
2024-03-11 18:31:24.231193 MEMORY 1.107349504
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.6s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.6s finished
Parallel Leiden runs finished
2024-03-11 18:31:25.877361 MEMORY 1.107361792
Quality: 0.04222715848487426
Quality: 0.043411745451795596
Got subclusters: Counter({0: 21, 1: 18, 2: 15})
On merging iteration 1
Numbers for each pattern pre-subsample: [21, 18, 15]
Numbers after subsampling: [21, 18, 15]
Computing sims for pattern 0
Computed sims for pattern 0 in 0.035016775131225586 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.030097007751464844 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.02899026870727539 s
Cluster sizes
[21 18 15]
Cross-contamination matrix:
[[1.   0.62 0.6 ]
 [0.59 1.   0.67]
 [0.46 0.55 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.76 0.77]
 [0.76 1.   0.76]
 [0.77 0.76 1.  ]]
Merging on 12 clusters
2024-03-11 18:31:25.987289 MEMORY 1.107361792
On merging iteration 1
Numbers for each pattern pre-subsample: [24, 23, 18, 15, 13, 24, 22, 21, 18, 21, 18, 15]
Numbers after subsampling: [24, 23, 18, 15, 13, 24, 22, 21, 18, 21, 18, 15]
Computing sims for pattern 0
Computed sims for pattern 0 in 0.21068453788757324 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.21671533584594727 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.17822003364562988 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.15820956230163574 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.14242219924926758 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.21202564239501953 s
Computing sims for pattern 6
Computed sims for pattern 6 in 0.19833922386169434 s
Computing sims for pattern 7
Computed sims for pattern 7 in 0.19202399253845215 s
Computing sims for pattern 8
Computed sims for pattern 8 in 0.16626334190368652 s
Computing sims for pattern 9
Computed sims for pattern 9 in 0.1959848403930664 s
Computing sims for pattern 10
Computed sims for pattern 10 in 0.16902780532836914 s
Computing sims for pattern 11
Computed sims for pattern 11 in 0.15757226943969727 s
Cluster sizes
[24 23 18 15 13 24 22 21 18 21 18 15]
Cross-contamination matrix:
[[1.   0.7  0.75 0.76 0.79 0.5  0.55 0.44 0.22 0.43 0.4  0.38]
 [0.32 1.   0.38 0.59 0.72 0.29 0.55 0.52 0.29 0.55 0.48 0.53]
 [0.41 0.47 1.   0.58 0.7  0.2  0.18 0.21 0.16 0.34 0.24 0.52]
 [0.32 0.55 0.42 1.   0.53 0.36 0.51 0.22 0.2  0.42 0.28 0.4 ]
 [0.23 0.4  0.25 0.28 1.   0.11 0.26 0.28 0.17 0.22 0.14 0.18]
 [0.16 0.22 0.12 0.32 0.27 1.   0.82 0.69 0.47 0.53 0.55 0.37]
 [0.08 0.3  0.08 0.18 0.23 0.44 1.   0.54 0.27 0.51 0.53 0.29]
 [0.05 0.3  0.05 0.09 0.33 0.5  0.74 1.   0.42 0.52 0.48 0.36]
 [0.26 0.55 0.45 0.47 0.56 0.85 0.91 0.92 1.   0.77 0.82 0.9 ]
 [0.1  0.5  0.15 0.2  0.41 0.44 0.89 0.72 0.45 1.   0.62 0.6 ]
 [0.1  0.44 0.14 0.31 0.41 0.47 0.8  0.63 0.42 0.59 1.   0.67]
 [0.08 0.39 0.26 0.37 0.36 0.26 0.32 0.39 0.51 0.46 0.55 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.7  0.75 0.74 0.65 0.58 0.55 0.55 0.25 0.5  0.49 0.44]
 [0.7  1.   0.74 0.79 0.76 0.5  0.68 0.65 0.59 0.7  0.75 0.74]
 [0.75 0.74 1.   0.79 0.58 0.53 0.46 0.6  0.5  0.62 0.54 0.65]
 [0.74 0.79 0.79 1.   0.65 0.6  0.5  0.57 0.41 0.68 0.55 0.67]
 [0.65 0.76 0.58 0.65 1.   0.51 0.55 0.64 0.59 0.66 0.64 0.65]
 [0.58 0.5  0.53 0.6  0.51 1.   0.7  0.72 0.59 0.61 0.64 0.52]
 [0.55 0.68 0.46 0.5  0.55 0.7  1.   0.71 0.54 0.75 0.77 0.59]
 [0.55 0.65 0.6  0.57 0.64 0.72 0.71 1.   0.71 0.74 0.71 0.6 ]
 [0.25 0.59 0.5  0.41 0.59 0.59 0.54 0.71 1.   0.67 0.67 0.69]
 [0.5  0.7  0.62 0.68 0.66 0.61 0.75 0.74 0.67 1.   0.76 0.77]
 [0.49 0.75 0.54 0.55 0.64 0.64 0.77 0.71 0.67 0.76 1.   0.76]
 [0.44 0.74 0.65 0.67 0.65 0.52 0.59 0.6  0.69 0.77 0.76 1.  ]]
Got 12 patterns after merging
2024-03-11 18:31:28.212577 MEMORY 1.107365888
Performing filtering
2024-03-11 18:31:28.212766 MEMORY 1.107365888
Got 0 patterns after filtering
2024-03-11 18:31:28.248616 MEMORY 1.107365888
Total time taken is 32.34s
2024-03-11 18:31:28.248720 MEMORY 1.107365888
Applying subclustering to the final motifs
On metacluster 3
Metacluster size 383
Relevant tasks:  ('head',)
Relevant signs:  (1,)
TfModiscoSeqletsToPatternsFactory: seed=1234
(Round 1) num seqlets: 383
(Round 1) Computing coarse affmat
2024-03-11 18:31:28.497002 MEMORY 1.107369984
Beginning embedding computation
MEMORY 1.107369984
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 152 tasks      | elapsed:    1.9s
[Parallel(n_jobs=24)]: Done 383 out of 383 | elapsed:    4.3s finished
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 152 tasks      | elapsed:    1.8s
[Parallel(n_jobs=24)]: Done 383 out of 383 | elapsed:    4.4s finished
At the beginning of embedding call
2024-03-11 18:31:28.497215 MEMORY 1.107369984
before computing embeddings fwd
2024-03-11 18:31:28.506088 MEMORY 1.107369984
after computing embeddings fwd
2024-03-11 18:31:32.848030 MEMORY 1.109843968
after computing embeddings rev
2024-03-11 18:31:37.260561 MEMORY 1.124241408
before computing sparse embeddings fwd
2024-03-11 18:31:37.260668 MEMORY 1.124241408
Constructing csr matrix...
csr matrix made in 0.045278072357177734 s
after computing sparse embeddings fwd
2024-03-11 18:31:37.319558 MEMORY 1.124245504
before computing sparse embeddings rev
2024-03-11 18:31:37.319633 MEMORY 1.124245504
Constructing csr matrix...
csr matrix made in 0.04829072952270508 s
after computing sparse embeddings rev
2024-03-11 18:31:37.383455 MEMORY 1.124245504
Finished embedding computation in 9.07 s
MEMORY 1.111662592
Starting affinity matrix computations
MEMORY 1.111400448
Batching in slices of size 383
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:01<00:00,  1.04s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:01<00:00,  1.04s/it]
Finished affinity matrix computations in 1.05 s
MEMORY 1.111400448
(Round 1) Computed coarse affmat
2024-03-11 18:31:38.779069 MEMORY 1.111400448
(Round 1) Computing affinity matrix on nearest neighbors
2024-03-11 18:31:38.779198 MEMORY 1.111400448
Launching nearest neighbors affmat calculation job
MEMORY 1.111400448
Parallel runs completed
MEMORY 1.148653568
Job completed in: 1.17 s
MEMORY 1.149329408
Launching nearest neighbors affmat calculation job
MEMORY 1.150099456
Parallel runs completed
MEMORY 1.185406976
Job completed in: 1.15 s
MEMORY 1.186193408
(Round 1) Computed affinity matrix on nearest neighbors in 2.5 s
2024-03-11 18:31:41.277032 MEMORY 1.186332672
Filtered down to 371 of 383
(Round 1) Retained 371 rows out of 383 after filtering
2024-03-11 18:31:41.468378 MEMORY 1.186430976
(Round 1) Computing density adapted affmat
2024-03-11 18:31:41.635834 MEMORY 1.186430976
Symmetrizing nearest neighbors
Computing betas for density adaptation
Computing normalizing denominators
(Round 1) Computing clustering
2024-03-11 18:31:43.057735 MEMORY 1.188298752
Beginning preprocessing + Leiden
2024-03-11 18:31:43.058319 MEMORY 1.188298752
Affmat transformed
2024-03-11 18:31:43.058429 MEMORY 1.188298752
sources, targets, weights extracted
2024-03-11 18:31:43.061592 MEMORY 1.188298752
About to launch parallel Leiden runs
2024-03-11 18:31:43.096851 MEMORY 1.188298752
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.1s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    4.0s finished
Parallel Leiden runs finished
2024-03-11 18:31:47.064141 MEMORY 1.188298752
Quality: 0.026331869065694215
Quality: 0.026333827636833878
Got 7 clusters after round 1
Counts:
{1: 154, 0: 158, 2: 47, 3: 8, 4: 2, 5: 1, 6: 1}
2024-03-11 18:31:47.067339 MEMORY 1.188298752
(Round 1) Aggregating seqlets in each cluster
2024-03-11 18:31:47.067423 MEMORY 1.188298752
Aggregating for cluster 0 with 158 seqlets
2024-03-11 18:31:47.067870 MEMORY 1.188298752
Skipped 1 due to duplicates
Trimming eliminated 0 seqlets out of 157
Aggregating for cluster 1 with 154 seqlets
2024-03-11 18:31:47.437219 MEMORY 1.188339712
Skipped 2 due to duplicates
Trimming eliminated 0 seqlets out of 152
Aggregating for cluster 2 with 47 seqlets
2024-03-11 18:31:47.795132 MEMORY 1.188343808
Trimming eliminated 0 seqlets out of 47
Aggregating for cluster 3 with 8 seqlets
2024-03-11 18:31:47.894000 MEMORY 1.188343808
Trimming eliminated 0 seqlets out of 8
Aggregating for cluster 4 with 2 seqlets
2024-03-11 18:31:47.909245 MEMORY 1.188343808
Trimming eliminated 0 seqlets out of 2
Aggregating for cluster 5 with 1 seqlets
2024-03-11 18:31:47.912219 MEMORY 1.188343808
Trimming eliminated 0 seqlets out of 1
Dropping cluster 5 with 1 seqlets due to sign disagreement
Aggregating for cluster 6 with 1 seqlets
2024-03-11 18:31:47.913372 MEMORY 1.188343808
Trimming eliminated 0 seqlets out of 1
(Round 2) num seqlets: 367
(Round 2) Computing coarse affmat
2024-03-11 18:31:48.055635 MEMORY 1.188343808
Beginning embedding computation
MEMORY 1.188343808
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 320 out of 367 | elapsed:    0.6s remaining:    0.1s
[Parallel(n_jobs=24)]: Done 367 out of 367 | elapsed:    0.6s finished
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 320 out of 367 | elapsed:    0.6s remaining:    0.1s
[Parallel(n_jobs=24)]: Done 367 out of 367 | elapsed:    0.7s finished
At the beginning of embedding call
2024-03-11 18:31:48.055826 MEMORY 1.188343808
before computing embeddings fwd
2024-03-11 18:31:48.064240 MEMORY 1.188343808
after computing embeddings fwd
2024-03-11 18:31:48.707965 MEMORY 1.191591936
after computing embeddings rev
2024-03-11 18:31:49.371784 MEMORY 1.204518912
before computing sparse embeddings fwd
2024-03-11 18:31:49.371860 MEMORY 1.204518912
Constructing csr matrix...
csr matrix made in 0.04131007194519043 s
after computing sparse embeddings fwd
2024-03-11 18:31:49.425005 MEMORY 1.204523008
before computing sparse embeddings rev
2024-03-11 18:31:49.425074 MEMORY 1.204523008
Constructing csr matrix...
csr matrix made in 0.040129661560058594 s
after computing sparse embeddings rev
2024-03-11 18:31:49.473217 MEMORY 1.204523008
Finished embedding computation in 1.58 s
MEMORY 1.19220224
Starting affinity matrix computations
MEMORY 1.19220224
Batching in slices of size 367
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:01<00:00,  1.04s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:01<00:00,  1.04s/it]
Finished affinity matrix computations in 1.04 s
MEMORY 1.19220224
(Round 2) Computed coarse affmat
2024-03-11 18:31:50.824092 MEMORY 1.19201792
(Round 2) Computing affinity matrix on nearest neighbors
2024-03-11 18:31:50.824219 MEMORY 1.19201792
Launching nearest neighbors affmat calculation job
MEMORY 1.19201792
Parallel runs completed
MEMORY 1.206697984
Job completed in: 0.54 s
MEMORY 1.206489088
Launching nearest neighbors affmat calculation job
MEMORY 1.206243328
Parallel runs completed
MEMORY 1.221251072
Job completed in: 0.55 s
MEMORY 1.221152768
(Round 2) Computed affinity matrix on nearest neighbors in 1.26 s
2024-03-11 18:31:52.087932 MEMORY 1.221029888
Not applying filtering for rounds above first round
2024-03-11 18:31:52.088120 MEMORY 1.221029888
(Round 2) Computing density adapted affmat
2024-03-11 18:31:52.250892 MEMORY 1.221029888
Symmetrizing nearest neighbors
Computing betas for density adaptation
Computing normalizing denominators
(Round 2) Computing clustering
2024-03-11 18:31:53.570609 MEMORY 1.222438912
Beginning preprocessing + Leiden
2024-03-11 18:31:53.571040 MEMORY 1.222438912
Affmat transformed
2024-03-11 18:31:53.571127 MEMORY 1.222438912
sources, targets, weights extracted
2024-03-11 18:31:53.573985 MEMORY 1.222438912
About to launch parallel Leiden runs
2024-03-11 18:31:53.606913 MEMORY 1.222438912
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.0s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.9s finished
Parallel Leiden runs finished
2024-03-11 18:31:56.554861 MEMORY 1.222438912
Quality: 0.032864669126793936
Quality: 0.03286470426146158
Quality: 0.03293993562938817
Quality: 0.032940976257669445
Got 4 clusters after round 2
Counts:
{1: 161, 2: 30, 0: 172, 3: 4}
2024-03-11 18:31:56.558443 MEMORY 1.222438912
(Round 2) Aggregating seqlets in each cluster
2024-03-11 18:31:56.558524 MEMORY 1.222438912
Aggregating for cluster 0 with 172 seqlets
2024-03-11 18:31:56.558722 MEMORY 1.222438912
Skipped 1 due to duplicates
Trimming eliminated 0 seqlets out of 171
Aggregating for cluster 1 with 161 seqlets
2024-03-11 18:31:56.833977 MEMORY 1.222176768
Skipped 1 due to duplicates
Trimming eliminated 0 seqlets out of 160
Aggregating for cluster 2 with 30 seqlets
2024-03-11 18:31:57.093897 MEMORY 1.222176768
Trimming eliminated 0 seqlets out of 30
Aggregating for cluster 3 with 4 seqlets
2024-03-11 18:31:57.135592 MEMORY 1.222176768
Trimming eliminated 0 seqlets out of 4
Dropping cluster 3 with 4 seqlets due to sign disagreement
Got 3 clusters
Splitting into subclusters...
2024-03-11 18:31:57.142241 MEMORY 1.222176768
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 124 out of 171 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=24)]: Done 171 out of 171 | elapsed:    0.1s finished
Inspecting pattern 0 for spurious merging
[t-SNE] Computed conditional probabilities for sample 171 / 171
[t-SNE] Mean sigma: 0.584271
Beginning preprocessing + Leiden
2024-03-11 18:31:57.353000 MEMORY 1.222176768
Affmat transformed
2024-03-11 18:31:57.355210 MEMORY 1.222176768
sources, targets, weights extracted
2024-03-11 18:31:57.355977 MEMORY 1.222176768
About to launch parallel Leiden runs
2024-03-11 18:31:57.369328 MEMORY 1.222176768
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.1s finished
Parallel Leiden runs finished
2024-03-11 18:31:59.495654 MEMORY 1.222176768
Quality: 0.24968237575242183
Quality: 0.25216632396863153
Quality: 0.25225344794684224
Quality: 0.2524398685979006
Got subclusters: Counter({0: 51, 1: 40, 2: 32, 3: 26, 4: 18, 5: 4})
On merging iteration 1
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 160 out of 160 | elapsed:    0.1s finished
Numbers for each pattern pre-subsample: [51, 40, 32, 26, 18, 4]
Numbers after subsampling: [51, 40, 32, 26, 18, 4]
Computing sims for pattern 0
Computed sims for pattern 0 in 0.1841113567352295 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.1460418701171875 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.11912345886230469 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.10219669342041016 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.07694721221923828 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.03602886199951172 s
Cluster sizes
[51 40 32 26 18  4]
Cross-contamination matrix:
[[1.   0.58 0.83 0.65 0.52 0.71]
 [0.6  1.   0.88 0.58 0.57 0.64]
 [0.41 0.45 1.   0.56 0.37 0.52]
 [0.57 0.58 0.79 1.   0.49 0.5 ]
 [0.56 0.56 0.65 0.61 1.   0.65]
 [0.18 0.13 0.32 0.13 0.15 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.34 0.58 0.56 0.37 0.49]
 [0.34 1.   0.65 0.36 0.4  0.35]
 [0.58 0.65 1.   0.71 0.34 0.58]
 [0.56 0.36 0.71 1.   0.35 0.34]
 [0.37 0.4  0.34 0.35 1.   0.21]
 [0.49 0.35 0.58 0.34 0.21 1.  ]]
Inspecting pattern 1 for spurious merging
[t-SNE] Computed conditional probabilities for sample 160 / 160
[t-SNE] Mean sigma: 0.573093
Beginning preprocessing + Leiden
2024-03-11 18:32:00.404555 MEMORY 1.222176768
Affmat transformed
2024-03-11 18:32:00.406607 MEMORY 1.222176768
sources, targets, weights extracted
2024-03-11 18:32:00.407309 MEMORY 1.222176768
About to launch parallel Leiden runs
2024-03-11 18:32:00.427282 MEMORY 1.222176768
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.1s finished
Parallel Leiden runs finished
2024-03-11 18:32:02.493372 MEMORY 1.222176768
Quality: 0.2434972117123842
Quality: 0.2504204390397408
Quality: 0.2517332093609207
Quality: 0.2519702983267489
Quality: 0.25314460561780955
Got subclusters: Counter({0: 48, 1: 40, 2: 38, 3: 34})
On merging iteration 1
Numbers for each pattern pre-subsample: [48, 40, 38, 34]
Numbers after subsampling: [48, 40, 38, 34]
Computing sims for pattern 0
Computed sims for pattern 0 in 0.11060118675231934 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.09628653526306152 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.08863544464111328 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.08239531517028809 s
Cluster sizes
[48 40 38 34]
Cross-contamination matrix:
[[1.   0.77 0.71 0.79]
 [0.59 1.   0.76 0.67]
 [0.32 0.54 1.   0.56]
 [0.48 0.58 0.7  1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.52 0.36 0.49]
 [0.52 1.   0.61 0.54]
 [0.36 0.61 1.   0.68]
 [0.49 0.54 0.68 1.  ]]
Inspecting pattern 2 for spurious merging
Merging on 11 clusters
2024-03-11 18:32:02.907603 MEMORY 1.222176768
On merging iteration 1
Numbers for each pattern pre-subsample: [51, 40, 32, 26, 18, 4, 48, 40, 38, 34, 30]
Numbers after subsampling: [51, 40, 32, 26, 18, 4, 48, 40, 38, 34, 30]
Computing sims for pattern 0
Computed sims for pattern 0 in 0.3744082450866699 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.3017692565917969 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.2501039505004883 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.21344327926635742 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.16634774208068848 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.08202409744262695 s
Computing sims for pattern 6
Computed sims for pattern 6 in 0.35698509216308594 s
Computing sims for pattern 7
Computed sims for pattern 7 in 0.46183085441589355 s
Computing sims for pattern 8
Computed sims for pattern 8 in 0.28767824172973633 s
Computing sims for pattern 9
Computed sims for pattern 9 in 0.259868860244751 s
Computing sims for pattern 10
Computed sims for pattern 10 in 0.24075770378112793 s
Cluster sizes
[51 40 32 26 18  4 48 40 38 34 30]
Cross-contamination matrix:
[[1.   0.58 0.83 0.65 0.52 0.71 0.27 0.46 0.5  0.31 0.69]
 [0.6  1.   0.88 0.58 0.57 0.64 0.55 0.58 0.69 0.37 0.52]
 [0.41 0.45 1.   0.56 0.37 0.52 0.17 0.31 0.47 0.24 0.45]
 [0.57 0.58 0.79 1.   0.49 0.5  0.39 0.43 0.55 0.26 0.43]
 [0.56 0.56 0.65 0.61 1.   0.65 0.31 0.4  0.51 0.31 0.62]
 [0.18 0.13 0.32 0.13 0.15 1.   0.03 0.08 0.11 0.12 0.22]
 [0.36 0.63 0.49 0.55 0.42 0.4  1.   0.77 0.71 0.79 0.47]
 [0.38 0.43 0.57 0.47 0.28 0.51 0.59 1.   0.76 0.67 0.31]
 [0.29 0.34 0.55 0.39 0.25 0.43 0.32 0.54 1.   0.56 0.54]
 [0.22 0.18 0.39 0.19 0.15 0.36 0.48 0.58 0.7  1.   0.46]
 [0.54 0.31 0.66 0.37 0.47 0.53 0.33 0.39 0.65 0.55 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.34 0.58 0.56 0.37 0.49 0.15 0.35 0.32 0.29 0.5 ]
 [0.34 1.   0.65 0.36 0.4  0.35 0.26 0.36 0.33 0.12 0.24]
 [0.58 0.65 1.   0.71 0.34 0.58 0.19 0.35 0.49 0.28 0.49]
 [0.56 0.36 0.71 1.   0.35 0.34 0.29 0.28 0.32 0.16 0.24]
 [0.37 0.4  0.34 0.35 1.   0.21 0.13 0.22 0.21 0.11 0.38]
 [0.49 0.35 0.58 0.34 0.21 1.   0.18 0.31 0.41 0.36 0.45]
 [0.15 0.26 0.19 0.29 0.13 0.18 1.   0.52 0.36 0.49 0.25]
 [0.35 0.36 0.35 0.28 0.22 0.31 0.52 1.   0.61 0.54 0.33]
 [0.32 0.33 0.49 0.32 0.21 0.41 0.36 0.61 1.   0.68 0.72]
 [0.29 0.12 0.28 0.16 0.11 0.36 0.49 0.54 0.68 1.   0.66]
 [0.5  0.24 0.49 0.24 0.38 0.45 0.25 0.33 0.72 0.66 1.  ]]
Got 11 patterns after merging
2024-03-11 18:32:05.944147 MEMORY 1.22165248
Performing filtering
2024-03-11 18:32:05.944299 MEMORY 1.22165248
Got 8 patterns after filtering
2024-03-11 18:32:05.994940 MEMORY 1.22165248
Total time taken is 37.7s
2024-03-11 18:32:05.995052 MEMORY 1.22165248
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  51 out of  51 | elapsed:    0.0s finished
/ru-auth/local/home/lzhao/anaconda3/envs/jupyter-ml-clone/lib/python3.9/site-packages/sklearn/manifold/_t_sne.py:691: FutureWarning: 'square_distances' has been introduced in 0.24 to help phase out legacy squaring behavior. The 'legacy' setting will be removed in 1.1 (renaming of 0.26), and the default setting will be changed to True. In 1.3, 'square_distances' will be removed altogether, and distances will be squared by default. Set 'square_distances'=True to silence this warning.
  warnings.warn(
/ru-auth/local/home/lzhao/anaconda3/envs/jupyter-ml-clone/lib/python3.9/site-packages/sklearn/neighbors/_base.py:175: EfficiencyWarning: Precomputed sparse input was not sorted by data.
  warnings.warn('Precomputed sparse input was not sorted by data.',
Applying subclustering to the final motifs
On pattern 0
[t-SNE] Computing 50 nearest neighbors...
[t-SNE] Indexed 51 samples in 0.088s...
[t-SNE] Computed neighbors for 51 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 51 / 51
[t-SNE] Mean sigma: 23.956004
[t-SNE] Computed conditional probabilities in 0.001s
[t-SNE] Iteration 50: error = 44.4103813, gradient norm = 0.4893579 (50 iterations in 7.414s)
[t-SNE] Iteration 100: error = 43.9135170, gradient norm = 0.6274278 (50 iterations in 0.014s)
[t-SNE] Iteration 150: error = 42.5253296, gradient norm = 0.5888945 (50 iterations in 0.013s)
[t-SNE] Iteration 200: error = 49.3197556, gradient norm = 0.4140381 (50 iterations in 0.014s)
[t-SNE] Iteration 250: error = 42.6927681, gradient norm = 0.3348148 (50 iterations in 0.014s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 42.692768
[t-SNE] Iteration 300: error = 0.6363545, gradient norm = 0.0008055 (50 iterations in 0.013s)
[t-SNE] Iteration 350: error = 0.6203114, gradient norm = 0.0002083 (50 iterations in 0.012s)
[t-SNE] Iteration 400: error = 0.6158878, gradient norm = 0.0001396 (50 iterations in 0.014s)
[t-SNE] Iteration 450: error = 0.6164292, gradient norm = 0.0000834 (50 iterations in 0.012s)
[t-SNE] Iteration 500: error = 0.6146706, gradient norm = 0.0001701 (50 iterations in 0.014s)
[t-SNE] Iteration 550: error = 0.6089749, gradient norm = 0.0004651 (50 iterations in 0.012s)
[t-SNE] Iteration 600: error = 0.9169370, gradient norm = 0.0039047 (50 iterations in 0.014s)
[t-SNE] Iteration 650: error = 0.6867064, gradient norm = 0.0006219 (50 iterations in 0.013s)
[t-SNE] Iteration 700: error = 0.6250881, gradient norm = 0.0001642 (50 iterations in 0.014s)
[t-SNE] Iteration 750: error = 0.6202530, gradient norm = 0.0000671 (50 iterations in 0.012s)
[t-SNE] Iteration 800: error = 0.6204926, gradient norm = 0.0000641 (50 iterations in 0.012s)
[t-SNE] Iteration 850: error = 0.6191909, gradient norm = 0.0000699 (50 iterations in 0.013s)
[t-SNE] Iteration 900: error = 0.6185686, gradient norm = 0.0000270 (50 iterations in 0.012s)
[t-SNE] Iteration 900: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 900 iterations: 0.618569
[t-SNE] Computed conditional probabilities for sample 51 / 51
[t-SNE] Mean sigma: 24.022090
Beginning preprocessing + Leiden
2024-03-11 18:32:13.812860 MEMORY 1.236332544
Affmat transformed
2024-03-11 18:32:13.813661 MEMORY 1.236332544
sources, targets, weights extracted
2024-03-11 18:32:13.813976 MEMORY 1.236332544
About to launch parallel Leiden runs
2024-03-11 18:32:13.841759 MEMORY 1.236332544
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.6s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.6s finished
Parallel Leiden runs finished
2024-03-11 18:32:15.475936 MEMORY 1.236332544
Quality: 9.547918011776308e-15
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done  48 out of  48 | elapsed:    0.0s finished
Got subclusters: Counter({0: 51})
On pattern 1
[t-SNE] Computing 47 nearest neighbors...
[t-SNE] Indexed 48 samples in 0.012s...
[t-SNE] Computed neighbors for 48 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 48 / 48
[t-SNE] Mean sigma: 29.759396
[t-SNE] Computed conditional probabilities in 0.001s
[t-SNE] Iteration 50: error = 47.2711754, gradient norm = 0.6544887 (50 iterations in 0.013s)
[t-SNE] Iteration 100: error = 44.7544746, gradient norm = 0.5333829 (50 iterations in 0.013s)
[t-SNE] Iteration 150: error = 43.0755005, gradient norm = 0.3684428 (50 iterations in 0.012s)
[t-SNE] Iteration 200: error = 45.1986465, gradient norm = 0.5340924 (50 iterations in 0.013s)
[t-SNE] Iteration 250: error = 42.1247940, gradient norm = 0.5757802 (50 iterations in 0.013s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 42.124794
[t-SNE] Iteration 300: error = 0.7232007, gradient norm = 0.0010887 (50 iterations in 0.012s)
[t-SNE] Iteration 350: error = 0.6400203, gradient norm = 0.0004088 (50 iterations in 0.018s)
[t-SNE] Iteration 400: error = 0.6068341, gradient norm = 0.0000862 (50 iterations in 0.012s)
[t-SNE] Iteration 450: error = 0.6056595, gradient norm = 0.0000542 (50 iterations in 0.013s)
[t-SNE] Iteration 500: error = 0.6055388, gradient norm = 0.0000520 (50 iterations in 0.012s)
[t-SNE] Iteration 550: error = 0.6055518, gradient norm = 0.0000510 (50 iterations in 0.013s)
[t-SNE] Iteration 600: error = 0.6060513, gradient norm = 0.0000318 (50 iterations in 0.012s)
[t-SNE] Iteration 650: error = 0.6063682, gradient norm = 0.0000220 (50 iterations in 0.013s)
[t-SNE] Iteration 700: error = 0.6060982, gradient norm = 0.0000182 (50 iterations in 0.014s)
[t-SNE] Iteration 750: error = 0.6058938, gradient norm = 0.0000208 (50 iterations in 0.013s)
[t-SNE] Iteration 800: error = 0.6059306, gradient norm = 0.0000473 (50 iterations in 0.013s)
[t-SNE] Iteration 850: error = 0.6055387, gradient norm = 0.0000275 (50 iterations in 0.014s)
[t-SNE] Iteration 900: error = 0.6053730, gradient norm = 0.0000243 (50 iterations in 0.012s)
[t-SNE] Iteration 950: error = 0.6048959, gradient norm = 0.0000385 (50 iterations in 0.014s)
[t-SNE] Iteration 1000: error = 0.6048577, gradient norm = 0.0000400 (50 iterations in 0.012s)
[t-SNE] KL divergence after 1000 iterations: 0.604858
[t-SNE] Computed conditional probabilities for sample 48 / 48
[t-SNE] Mean sigma: 1125899906842624.000000
Beginning preprocessing + Leiden
2024-03-11 18:32:15.794073 MEMORY 1.23633664
Affmat transformed
2024-03-11 18:32:15.794900 MEMORY 1.23633664
sources, targets, weights extracted
2024-03-11 18:32:15.795256 MEMORY 1.23633664
About to launch parallel Leiden runs
2024-03-11 18:32:15.850039 MEMORY 1.23633664
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.6s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.6s finished
Parallel Leiden runs finished
2024-03-11 18:32:17.487013 MEMORY 1.23633664
Quality: 8.88178419700137e-16
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done  34 out of  40 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=24)]: Done  40 out of  40 | elapsed:    0.0s finished
Got subclusters: Counter({0: 48})
On pattern 2
[t-SNE] Computing 39 nearest neighbors...
[t-SNE] Indexed 40 samples in 0.000s...
[t-SNE] Computed neighbors for 40 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 40 / 40
[t-SNE] Mean sigma: 30.338910
[t-SNE] Computed conditional probabilities in 0.001s
[t-SNE] Iteration 50: error = 41.8067398, gradient norm = 0.5041123 (50 iterations in 0.012s)
[t-SNE] Iteration 100: error = 42.6071014, gradient norm = 0.7501732 (50 iterations in 0.015s)
[t-SNE] Iteration 150: error = 42.5134392, gradient norm = 0.6983789 (50 iterations in 0.013s)
[t-SNE] Iteration 200: error = 43.5943146, gradient norm = 0.4509638 (50 iterations in 0.012s)
[t-SNE] Iteration 250: error = 40.6672516, gradient norm = 0.5812075 (50 iterations in 0.013s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 40.667252
[t-SNE] Iteration 300: error = 0.6238143, gradient norm = 0.0010214 (50 iterations in 0.012s)
[t-SNE] Iteration 350: error = 0.5708881, gradient norm = 0.0001110 (50 iterations in 0.013s)
[t-SNE] Iteration 400: error = 0.5675331, gradient norm = 0.0000789 (50 iterations in 0.013s)
[t-SNE] Iteration 450: error = 0.5663674, gradient norm = 0.0000565 (50 iterations in 0.012s)
[t-SNE] Iteration 500: error = 0.5644190, gradient norm = 0.0000535 (50 iterations in 0.012s)
[t-SNE] Iteration 550: error = 0.5648403, gradient norm = 0.0000308 (50 iterations in 0.012s)
[t-SNE] Iteration 600: error = 0.5646607, gradient norm = 0.0000319 (50 iterations in 0.013s)
[t-SNE] Iteration 650: error = 0.5641711, gradient norm = 0.0000300 (50 iterations in 0.012s)
[t-SNE] Iteration 700: error = 0.5639967, gradient norm = 0.0000246 (50 iterations in 0.012s)
[t-SNE] Iteration 750: error = 0.5639217, gradient norm = 0.0000257 (50 iterations in 0.013s)
[t-SNE] Iteration 800: error = 0.5636148, gradient norm = 0.0000333 (50 iterations in 0.012s)
[t-SNE] Iteration 850: error = 0.5629422, gradient norm = 0.0000680 (50 iterations in 0.013s)
[t-SNE] Iteration 900: error = 0.5603028, gradient norm = 0.0002433 (50 iterations in 0.013s)
[t-SNE] Iteration 950: error = 1.3206810, gradient norm = 0.0399164 (50 iterations in 0.013s)
[t-SNE] Iteration 1000: error = 0.7249011, gradient norm = 0.0008262 (50 iterations in 0.014s)
[t-SNE] KL divergence after 1000 iterations: 0.724901
[t-SNE] Computed conditional probabilities for sample 40 / 40
[t-SNE] Mean sigma: 1125899906842624.000000
Beginning preprocessing + Leiden
2024-03-11 18:32:17.778202 MEMORY 1.23633664
Affmat transformed
2024-03-11 18:32:17.778967 MEMORY 1.23633664
sources, targets, weights extracted
2024-03-11 18:32:17.779274 MEMORY 1.23633664
About to launch parallel Leiden runs
2024-03-11 18:32:17.827090 MEMORY 1.23633664
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.6s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.6s finished
Parallel Leiden runs finished
2024-03-11 18:32:19.472733 MEMORY 1.23633664
Quality: 2.2204460492503205e-16
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done  34 out of  40 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=24)]: Done  40 out of  40 | elapsed:    0.0s finished
Got subclusters: Counter({0: 40})
On pattern 3
[t-SNE] Computing 39 nearest neighbors...
[t-SNE] Indexed 40 samples in 0.000s...
[t-SNE] Computed neighbors for 40 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 40 / 40
[t-SNE] Mean sigma: 20.930238
[t-SNE] Computed conditional probabilities in 0.001s
[t-SNE] Iteration 50: error = 46.2752609, gradient norm = 0.4606767 (50 iterations in 0.013s)
[t-SNE] Iteration 100: error = 47.8969841, gradient norm = 0.4704148 (50 iterations in 0.012s)
[t-SNE] Iteration 150: error = 43.7665176, gradient norm = 0.5591446 (50 iterations in 0.013s)
[t-SNE] Iteration 200: error = 44.7398262, gradient norm = 0.5988696 (50 iterations in 0.014s)
[t-SNE] Iteration 250: error = 45.7745705, gradient norm = 0.6743461 (50 iterations in 0.014s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 45.774570
[t-SNE] Iteration 300: error = 0.6224974, gradient norm = 0.0009752 (50 iterations in 0.015s)
[t-SNE] Iteration 350: error = 0.5715665, gradient norm = 0.0001700 (50 iterations in 0.013s)
[t-SNE] Iteration 400: error = 0.5665166, gradient norm = 0.0000828 (50 iterations in 0.012s)
[t-SNE] Iteration 450: error = 0.5651806, gradient norm = 0.0000362 (50 iterations in 0.014s)
[t-SNE] Iteration 500: error = 0.5647452, gradient norm = 0.0000231 (50 iterations in 0.014s)
[t-SNE] Iteration 550: error = 0.5647679, gradient norm = 0.0000195 (50 iterations in 0.012s)
[t-SNE] Iteration 600: error = 0.5651815, gradient norm = 0.0000233 (50 iterations in 0.014s)
[t-SNE] Iteration 650: error = 0.5646231, gradient norm = 0.0000248 (50 iterations in 0.014s)
[t-SNE] Iteration 700: error = 0.5642087, gradient norm = 0.0000239 (50 iterations in 0.012s)
[t-SNE] Iteration 750: error = 0.5641788, gradient norm = 0.0000259 (50 iterations in 0.013s)
[t-SNE] Iteration 800: error = 0.5636572, gradient norm = 0.0000408 (50 iterations in 0.012s)
[t-SNE] Iteration 850: error = 0.5628007, gradient norm = 0.0000708 (50 iterations in 0.013s)
[t-SNE] Iteration 900: error = 0.5598629, gradient norm = 0.0001788 (50 iterations in 0.013s)
[t-SNE] Iteration 950: error = 1.0965453, gradient norm = 0.0649742 (50 iterations in 0.012s)
[t-SNE] Iteration 1000: error = 0.6553711, gradient norm = 0.0008888 (50 iterations in 0.013s)
[t-SNE] KL divergence after 1000 iterations: 0.655371
[t-SNE] Computed conditional probabilities for sample 40 / 40
[t-SNE] Mean sigma: 1125899906842624.000000
Beginning preprocessing + Leiden
2024-03-11 18:32:19.771907 MEMORY 1.23633664
Affmat transformed
2024-03-11 18:32:19.772652 MEMORY 1.23633664
sources, targets, weights extracted
2024-03-11 18:32:19.772952 MEMORY 1.23633664
About to launch parallel Leiden runs
2024-03-11 18:32:19.810067 MEMORY 1.23633664
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.0s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.4s finished
Parallel Leiden runs finished
2024-03-11 18:32:22.193321 MEMORY 1.234878464
Quality: 2.2204460492503205e-16
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done  30 out of  38 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=24)]: Done  38 out of  38 | elapsed:    0.0s finished
Got subclusters: Counter({0: 40})
On pattern 4
[t-SNE] Computing 37 nearest neighbors...
[t-SNE] Indexed 38 samples in 0.000s...
[t-SNE] Computed neighbors for 38 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 38 / 38
[t-SNE] Mean sigma: 14.054282
[t-SNE] Computed conditional probabilities in 0.001s
[t-SNE] Iteration 50: error = 44.7531090, gradient norm = 0.5689541 (50 iterations in 2.056s)
[t-SNE] Iteration 100: error = 41.8394203, gradient norm = 0.3948913 (50 iterations in 1.655s)
[t-SNE] Iteration 150: error = 45.6190262, gradient norm = 0.6312548 (50 iterations in 0.014s)
[t-SNE] Iteration 200: error = 42.7502060, gradient norm = 0.6044311 (50 iterations in 0.012s)
[t-SNE] Iteration 250: error = 45.5029221, gradient norm = 0.5498720 (50 iterations in 0.017s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 45.502922
[t-SNE] Iteration 300: error = 0.5955534, gradient norm = 0.0008687 (50 iterations in 0.017s)
[t-SNE] Iteration 350: error = 0.5580584, gradient norm = 0.0001611 (50 iterations in 0.013s)
[t-SNE] Iteration 400: error = 0.5546695, gradient norm = 0.0000604 (50 iterations in 0.016s)
[t-SNE] Iteration 450: error = 0.5544690, gradient norm = 0.0000320 (50 iterations in 0.012s)
[t-SNE] Iteration 500: error = 0.5538740, gradient norm = 0.0000238 (50 iterations in 0.014s)
[t-SNE] Iteration 550: error = 0.5535529, gradient norm = 0.0000250 (50 iterations in 0.014s)
[t-SNE] Iteration 600: error = 0.5526866, gradient norm = 0.0000280 (50 iterations in 0.012s)
[t-SNE] Iteration 650: error = 0.5530082, gradient norm = 0.0000222 (50 iterations in 0.014s)
[t-SNE] Iteration 700: error = 0.5528548, gradient norm = 0.0000208 (50 iterations in 0.014s)
[t-SNE] Iteration 750: error = 0.5526362, gradient norm = 0.0000225 (50 iterations in 0.012s)
[t-SNE] Iteration 800: error = 0.5524377, gradient norm = 0.0000276 (50 iterations in 0.014s)
[t-SNE] Iteration 850: error = 0.5519172, gradient norm = 0.0000571 (50 iterations in 0.014s)
[t-SNE] Iteration 900: error = 0.5499841, gradient norm = 0.0001287 (50 iterations in 0.012s)
[t-SNE] Iteration 950: error = 0.5806043, gradient norm = 0.0125539 (50 iterations in 0.013s)
[t-SNE] Iteration 1000: error = 0.5638510, gradient norm = 0.0008481 (50 iterations in 0.013s)
[t-SNE] KL divergence after 1000 iterations: 0.563851
[t-SNE] Computed conditional probabilities for sample 38 / 38
[t-SNE] Mean sigma: 1125899906842624.000000
Beginning preprocessing + Leiden
2024-03-11 18:32:26.188198 MEMORY 1.235185664
Affmat transformed
2024-03-11 18:32:26.189188 MEMORY 1.235185664
sources, targets, weights extracted
2024-03-11 18:32:26.189599 MEMORY 1.235185664
About to launch parallel Leiden runs
2024-03-11 18:32:26.201418 MEMORY 1.235197952
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.6s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.6s finished
Parallel Leiden runs finished
2024-03-11 18:32:27.841732 MEMORY 1.235197952
Quality: -1.4643841694806183e-13
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done  22 out of  34 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=24)]: Done  34 out of  34 | elapsed:    0.0s finished
Got subclusters: Counter({0: 38})
On pattern 5
[t-SNE] Computing 33 nearest neighbors...
[t-SNE] Indexed 34 samples in 0.000s...
[t-SNE] Computed neighbors for 34 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 34 / 34
[t-SNE] Mean sigma: 15.389722
[t-SNE] Computed conditional probabilities in 0.001s
[t-SNE] Iteration 50: error = 44.0154495, gradient norm = 0.4680611 (50 iterations in 0.012s)
[t-SNE] Iteration 100: error = 46.1145325, gradient norm = 0.7431861 (50 iterations in 0.013s)
[t-SNE] Iteration 150: error = 42.6715202, gradient norm = 0.6379790 (50 iterations in 0.014s)
[t-SNE] Iteration 200: error = 42.5193520, gradient norm = 0.5708178 (50 iterations in 0.012s)
[t-SNE] Iteration 250: error = 47.5315895, gradient norm = 0.3238788 (50 iterations in 0.014s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 47.531590
[t-SNE] Iteration 300: error = 0.7125618, gradient norm = 0.0013072 (50 iterations in 0.012s)
[t-SNE] Iteration 350: error = 0.6068344, gradient norm = 0.0003768 (50 iterations in 0.011s)
[t-SNE] Iteration 400: error = 0.5345660, gradient norm = 0.0002191 (50 iterations in 0.012s)
[t-SNE] Iteration 450: error = 0.5289890, gradient norm = 0.0000571 (50 iterations in 0.011s)
[t-SNE] Iteration 500: error = 0.5279684, gradient norm = 0.0000353 (50 iterations in 0.013s)
[t-SNE] Iteration 550: error = 0.5275596, gradient norm = 0.0000257 (50 iterations in 0.014s)
[t-SNE] Iteration 600: error = 0.5269722, gradient norm = 0.0000260 (50 iterations in 0.011s)
[t-SNE] Iteration 650: error = 0.5255993, gradient norm = 0.0000339 (50 iterations in 0.013s)
[t-SNE] Iteration 700: error = 0.5252043, gradient norm = 0.0000186 (50 iterations in 0.011s)
[t-SNE] Iteration 750: error = 0.5250702, gradient norm = 0.0000181 (50 iterations in 0.013s)
[t-SNE] Iteration 800: error = 0.5247488, gradient norm = 0.0000201 (50 iterations in 0.013s)
[t-SNE] Iteration 850: error = 0.5246961, gradient norm = 0.0000220 (50 iterations in 0.011s)
[t-SNE] Iteration 900: error = 0.5246705, gradient norm = 0.0000244 (50 iterations in 0.014s)
[t-SNE] Iteration 950: error = 0.5245830, gradient norm = 0.0000298 (50 iterations in 0.012s)
[t-SNE] Iteration 1000: error = 0.5245016, gradient norm = 0.0000556 (50 iterations in 0.011s)
[t-SNE] KL divergence after 1000 iterations: 0.524502
[t-SNE] Computed conditional probabilities for sample 34 / 34
[t-SNE] Mean sigma: 1125899906842624.000000
Beginning preprocessing + Leiden
2024-03-11 18:32:28.121768 MEMORY 1.235197952
Affmat transformed
2024-03-11 18:32:28.122461 MEMORY 1.235197952
sources, targets, weights extracted
2024-03-11 18:32:28.122767 MEMORY 1.235197952
About to launch parallel Leiden runs
2024-03-11 18:32:28.150126 MEMORY 1.235197952
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.6s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.6s finished
Parallel Leiden runs finished
2024-03-11 18:32:29.793583 MEMORY 1.235197952
Quality: -1.0069722833350307e-13
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done  18 out of  32 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=24)]: Done  32 out of  32 | elapsed:    0.0s finished
Got subclusters: Counter({0: 34})
On pattern 6
[t-SNE] Computing 31 nearest neighbors...
[t-SNE] Indexed 32 samples in 0.000s...
[t-SNE] Computed neighbors for 32 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 32 / 32
[t-SNE] Mean sigma: 13.237445
[t-SNE] Computed conditional probabilities in 0.001s
[t-SNE] Iteration 50: error = 41.2249146, gradient norm = 0.6197405 (50 iterations in 0.015s)
[t-SNE] Iteration 100: error = 44.7966881, gradient norm = 0.4753645 (50 iterations in 0.011s)
[t-SNE] Iteration 150: error = 46.5035858, gradient norm = 0.6050798 (50 iterations in 0.013s)
[t-SNE] Iteration 200: error = 41.4920235, gradient norm = 0.5362902 (50 iterations in 0.014s)
[t-SNE] Iteration 250: error = 43.6407013, gradient norm = 0.5130758 (50 iterations in 0.011s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 43.640701
[t-SNE] Iteration 300: error = 0.6651749, gradient norm = 0.0010662 (50 iterations in 0.013s)
[t-SNE] Iteration 350: error = 0.5370675, gradient norm = 0.0003232 (50 iterations in 0.011s)
[t-SNE] Iteration 400: error = 0.5207617, gradient norm = 0.0000810 (50 iterations in 0.014s)
[t-SNE] Iteration 450: error = 0.5177860, gradient norm = 0.0000495 (50 iterations in 0.013s)
[t-SNE] Iteration 500: error = 0.5166091, gradient norm = 0.0000388 (50 iterations in 0.011s)
[t-SNE] Iteration 550: error = 0.5150136, gradient norm = 0.0000312 (50 iterations in 0.013s)
[t-SNE] Iteration 600: error = 0.5139174, gradient norm = 0.0000281 (50 iterations in 0.014s)
[t-SNE] Iteration 650: error = 0.5128745, gradient norm = 0.0000261 (50 iterations in 0.011s)
[t-SNE] Iteration 700: error = 0.5128098, gradient norm = 0.0000152 (50 iterations in 0.014s)
[t-SNE] Iteration 750: error = 0.5126487, gradient norm = 0.0000137 (50 iterations in 0.014s)
[t-SNE] Iteration 800: error = 0.5124745, gradient norm = 0.0000151 (50 iterations in 0.014s)
[t-SNE] Iteration 850: error = 0.5123159, gradient norm = 0.0000144 (50 iterations in 0.013s)
[t-SNE] Iteration 900: error = 0.5122531, gradient norm = 0.0000137 (50 iterations in 0.013s)
[t-SNE] Iteration 950: error = 0.5122129, gradient norm = 0.0000140 (50 iterations in 0.012s)
[t-SNE] Iteration 1000: error = 0.5121619, gradient norm = 0.0000158 (50 iterations in 0.011s)
[t-SNE] KL divergence after 1000 iterations: 0.512162
[t-SNE] Computed conditional probabilities for sample 32 / 32
[t-SNE] Mean sigma: 1125899906842624.000000
Beginning preprocessing + Leiden
2024-03-11 18:32:30.079218 MEMORY 1.235197952
Affmat transformed
2024-03-11 18:32:30.079946 MEMORY 1.235197952
sources, targets, weights extracted
2024-03-11 18:32:30.080259 MEMORY 1.235197952
About to launch parallel Leiden runs
2024-03-11 18:32:30.121278 MEMORY 1.235197952
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.6s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.6s finished
Parallel Leiden runs finished
2024-03-11 18:32:31.769190 MEMORY 1.235197952
Quality: 2.0650148258028073e-14
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done  14 out of  30 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=24)]: Done  30 out of  30 | elapsed:    0.0s finished
Got subclusters: Counter({0: 32})
On pattern 7
[t-SNE] Computing 29 nearest neighbors...
[t-SNE] Indexed 30 samples in 0.000s...
[t-SNE] Computed neighbors for 30 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 30 / 30
[t-SNE] Mean sigma: 17.064139
[t-SNE] Computed conditional probabilities in 0.001s
[t-SNE] Iteration 50: error = 43.2963829, gradient norm = 0.4048229 (50 iterations in 0.014s)
[t-SNE] Iteration 100: error = 45.8131371, gradient norm = 0.5868002 (50 iterations in 0.011s)
[t-SNE] Iteration 150: error = 41.2804031, gradient norm = 0.6824832 (50 iterations in 0.011s)
[t-SNE] Iteration 200: error = 44.1667747, gradient norm = 0.4803824 (50 iterations in 0.013s)
[t-SNE] Iteration 250: error = 42.6034775, gradient norm = 0.5149652 (50 iterations in 0.013s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 42.603477
[t-SNE] Iteration 300: error = 0.5600322, gradient norm = 0.0008353 (50 iterations in 0.011s)
[t-SNE] Iteration 350: error = 0.5104175, gradient norm = 0.0002034 (50 iterations in 0.013s)
[t-SNE] Iteration 400: error = 0.5016984, gradient norm = 0.0000797 (50 iterations in 0.011s)
[t-SNE] Iteration 450: error = 0.4993242, gradient norm = 0.0000498 (50 iterations in 0.012s)
[t-SNE] Iteration 500: error = 0.4993409, gradient norm = 0.0000245 (50 iterations in 0.011s)
[t-SNE] Iteration 550: error = 0.4991183, gradient norm = 0.0000245 (50 iterations in 0.011s)
[t-SNE] Iteration 600: error = 0.4990216, gradient norm = 0.0000266 (50 iterations in 0.011s)
[t-SNE] Iteration 650: error = 0.4994980, gradient norm = 0.0000266 (50 iterations in 0.011s)
[t-SNE] Iteration 700: error = 0.4991216, gradient norm = 0.0000308 (50 iterations in 0.011s)
[t-SNE] Iteration 750: error = 0.4990579, gradient norm = 0.0000331 (50 iterations in 0.011s)
[t-SNE] Iteration 800: error = 0.4987833, gradient norm = 0.0000444 (50 iterations in 0.011s)
[t-SNE] Iteration 850: error = 0.4985119, gradient norm = 0.0000599 (50 iterations in 0.011s)
[t-SNE] Iteration 900: error = 0.4979855, gradient norm = 0.0001018 (50 iterations in 0.011s)
[t-SNE] Iteration 950: error = 0.4952862, gradient norm = 0.0003493 (50 iterations in 0.011s)
[t-SNE] Iteration 1000: error = 1.2041018, gradient norm = 0.1453377 (50 iterations in 0.011s)
[t-SNE] KL divergence after 1000 iterations: 1.204102
[t-SNE] Computed conditional probabilities for sample 30 / 30
[t-SNE] Mean sigma: 1125899906842624.000000
Beginning preprocessing + Leiden
2024-03-11 18:32:32.030509 MEMORY 1.235197952
Affmat transformed
2024-03-11 18:32:32.031271 MEMORY 1.235197952
sources, targets, weights extracted
2024-03-11 18:32:32.031609 MEMORY 1.235197952
About to launch parallel Leiden runs
2024-03-11 18:32:32.119739 MEMORY 1.235197952
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.6s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.6s finished
Parallel Leiden runs finished
2024-03-11 18:32:33.748906 MEMORY 1.235197952
Quality: 1.9095836023552904e-14
Got subclusters: Counter({0: 30})
On metacluster 2
Metacluster size 423
Relevant tasks:  ('head',)
Relevant signs:  (-1,)
TfModiscoSeqletsToPatternsFactory: seed=1234
(Round 1) num seqlets: 423
(Round 1) Computing coarse affmat
2024-03-11 18:32:33.949021 MEMORY 1.23533312
Beginning embedding computation
MEMORY 1.23533312
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 152 tasks      | elapsed:    1.9s
[Parallel(n_jobs=24)]: Done 423 out of 423 | elapsed:    4.9s finished
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 152 tasks      | elapsed:    1.9s
[Parallel(n_jobs=24)]: Done 423 out of 423 | elapsed:    4.8s finished
At the beginning of embedding call
2024-03-11 18:32:33.949218 MEMORY 1.23533312
before computing embeddings fwd
2024-03-11 18:32:33.957862 MEMORY 1.23533312
after computing embeddings fwd
2024-03-11 18:32:38.814945 MEMORY 1.235582976
after computing embeddings rev
2024-03-11 18:32:43.578928 MEMORY 1.247588352
before computing sparse embeddings fwd
2024-03-11 18:32:43.579018 MEMORY 1.247588352
Constructing csr matrix...
csr matrix made in 0.04914712905883789 s
after computing sparse embeddings fwd
2024-03-11 18:32:43.642387 MEMORY 1.247588352
before computing sparse embeddings rev
2024-03-11 18:32:43.642463 MEMORY 1.247588352
Constructing csr matrix...
csr matrix made in 0.04676461219787598 s
after computing sparse embeddings rev
2024-03-11 18:32:43.701237 MEMORY 1.247588352
Finished embedding computation in 9.91 s
MEMORY 1.235795968
Starting affinity matrix computations
MEMORY 1.235795968
Batching in slices of size 423
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:01<00:00,  1.04s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:01<00:00,  1.04s/it]
Finished affinity matrix computations in 1.05 s
MEMORY 1.235853312
(Round 1) Computed coarse affmat
2024-03-11 18:32:45.048754 MEMORY 1.235853312
(Round 1) Computing affinity matrix on nearest neighbors
2024-03-11 18:32:45.048889 MEMORY 1.235853312
Launching nearest neighbors affmat calculation job
MEMORY 1.235853312
Parallel runs completed
MEMORY 1.32132864
Job completed in: 1.41 s
MEMORY 1.321762816
Launching nearest neighbors affmat calculation job
MEMORY 1.319866368
Parallel runs completed
MEMORY 1.35606272
Job completed in: 1.3 s
MEMORY 1.357156352
(Round 1) Computed affinity matrix on nearest neighbors in 2.89 s
2024-03-11 18:32:47.935292 MEMORY 1.358045184
Filtered down to 423 of 423
(Round 1) Retained 423 rows out of 423 after filtering
2024-03-11 18:32:48.141689 MEMORY 1.358045184
(Round 1) Computing density adapted affmat
2024-03-11 18:32:48.318269 MEMORY 1.358045184
Symmetrizing nearest neighbors
Computing betas for density adaptation
Computing normalizing denominators
(Round 1) Computing clustering
2024-03-11 18:32:50.186872 MEMORY 1.366806528
Beginning preprocessing + Leiden
2024-03-11 18:32:50.187388 MEMORY 1.366806528
Affmat transformed
2024-03-11 18:32:50.187484 MEMORY 1.366806528
sources, targets, weights extracted
2024-03-11 18:32:50.191697 MEMORY 1.366806528
About to launch parallel Leiden runs
2024-03-11 18:32:50.223087 MEMORY 1.366806528
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.2s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    3.9s finished
Parallel Leiden runs finished
2024-03-11 18:32:54.135306 MEMORY 1.366806528
Quality: 0.018525654513533885
Quality: 0.01891893666602678
Quality: 0.018959036222593442
Quality: 0.018963286910658645
Quality: 0.01899790216779177
Quality: 0.0189981130345996
Got 4 clusters after round 1
Counts:
{2: 126, 0: 154, 1: 141, 3: 2}
2024-03-11 18:32:54.139130 MEMORY 1.366806528
(Round 1) Aggregating seqlets in each cluster
2024-03-11 18:32:54.139215 MEMORY 1.366806528
Aggregating for cluster 0 with 154 seqlets
2024-03-11 18:32:54.139442 MEMORY 1.366806528
Skipped 1 due to duplicates
Trimming eliminated 0 seqlets out of 153
Aggregating for cluster 1 with 141 seqlets
2024-03-11 18:32:54.501611 MEMORY 1.366806528
Trimming eliminated 0 seqlets out of 141
Removed 1 duplicate seqlets
Aggregating for cluster 2 with 126 seqlets
2024-03-11 18:32:54.802067 MEMORY 1.366806528
Trimming eliminated 0 seqlets out of 126
Aggregating for cluster 3 with 2 seqlets
2024-03-11 18:32:55.067914 MEMORY 1.366806528
Trimming eliminated 0 seqlets out of 2
(Round 2) num seqlets: 421
(Round 2) Computing coarse affmat
2024-03-11 18:32:55.201233 MEMORY 1.366806528
Beginning embedding computation
MEMORY 1.366806528
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 344 tasks      | elapsed:    0.6s
[Parallel(n_jobs=24)]: Done 421 out of 421 | elapsed:    0.8s finished
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 344 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done 421 out of 421 | elapsed:    0.8s finished
At the beginning of embedding call
2024-03-11 18:32:55.201424 MEMORY 1.366806528
before computing embeddings fwd
2024-03-11 18:32:55.209919 MEMORY 1.366806528
after computing embeddings fwd
2024-03-11 18:32:56.014918 MEMORY 1.369894912
after computing embeddings rev
2024-03-11 18:32:56.847379 MEMORY 1.384861696
before computing sparse embeddings fwd
2024-03-11 18:32:56.847462 MEMORY 1.384861696
Constructing csr matrix...
csr matrix made in 0.047592878341674805 s
after computing sparse embeddings fwd
2024-03-11 18:32:56.906641 MEMORY 1.384861696
before computing sparse embeddings rev
2024-03-11 18:32:56.906710 MEMORY 1.384861696
Constructing csr matrix...
csr matrix made in 0.0460352897644043 s
after computing sparse embeddings rev
2024-03-11 18:32:56.962735 MEMORY 1.384865792
Finished embedding computation in 1.92 s
MEMORY 1.371549696
Starting affinity matrix computations
MEMORY 1.371287552
Batching in slices of size 421
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:01<00:00,  1.05s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:01<00:00,  1.05s/it]
Finished affinity matrix computations in 1.06 s
MEMORY 1.371287552
(Round 2) Computed coarse affmat
2024-03-11 18:32:58.313755 MEMORY 1.371025408
(Round 2) Computing affinity matrix on nearest neighbors
2024-03-11 18:32:58.313889 MEMORY 1.371025408
Launching nearest neighbors affmat calculation job
MEMORY 1.371025408
Parallel runs completed
MEMORY 1.3734912
Job completed in: 0.66 s
MEMORY 1.373319168
Launching nearest neighbors affmat calculation job
MEMORY 1.371025408
Parallel runs completed
MEMORY 1.390874624
Job completed in: 0.67 s
MEMORY 1.390952448
(Round 2) Computed affinity matrix on nearest neighbors in 1.5 s
2024-03-11 18:32:59.817047 MEMORY 1.388814336
Not applying filtering for rounds above first round
2024-03-11 18:32:59.817248 MEMORY 1.388814336
(Round 2) Computing density adapted affmat
2024-03-11 18:32:59.997558 MEMORY 1.388814336
Symmetrizing nearest neighbors
Computing betas for density adaptation
Computing normalizing denominators
(Round 2) Computing clustering
2024-03-11 18:33:01.827148 MEMORY 1.390452736
Beginning preprocessing + Leiden
2024-03-11 18:33:01.827673 MEMORY 1.390452736
Affmat transformed
2024-03-11 18:33:01.827768 MEMORY 1.390452736
sources, targets, weights extracted
2024-03-11 18:33:01.831852 MEMORY 1.390452736
About to launch parallel Leiden runs
2024-03-11 18:33:01.872547 MEMORY 1.390452736
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.2s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    3.6s finished
Parallel Leiden runs finished
2024-03-11 18:33:05.425928 MEMORY 1.390452736
Quality: 0.023942296722159927
Got 3 clusters after round 2
Counts:
{2: 118, 0: 160, 1: 143}
2024-03-11 18:33:05.430261 MEMORY 1.390452736
(Round 2) Aggregating seqlets in each cluster
2024-03-11 18:33:05.430346 MEMORY 1.390452736
Aggregating for cluster 0 with 160 seqlets
2024-03-11 18:33:05.430555 MEMORY 1.390452736
Skipped 2 due to duplicates
Trimming eliminated 0 seqlets out of 158
Aggregating for cluster 1 with 143 seqlets
2024-03-11 18:33:05.642024 MEMORY 1.390452736
Skipped 2 due to duplicates
Trimming eliminated 0 seqlets out of 141
Aggregating for cluster 2 with 118 seqlets
2024-03-11 18:33:05.867688 MEMORY 1.390452736
Trimming eliminated 0 seqlets out of 118
Got 3 clusters
Splitting into subclusters...
2024-03-11 18:33:06.036838 MEMORY 1.390452736
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 158 out of 158 | elapsed:    0.0s finished
Inspecting pattern 0 for spurious merging
[t-SNE] Computed conditional probabilities for sample 158 / 158
[t-SNE] Mean sigma: 0.433220
Beginning preprocessing + Leiden
2024-03-11 18:33:06.238960 MEMORY 1.390452736
Affmat transformed
2024-03-11 18:33:06.241009 MEMORY 1.390452736
sources, targets, weights extracted
2024-03-11 18:33:06.241737 MEMORY 1.390452736
About to launch parallel Leiden runs
2024-03-11 18:33:06.298514 MEMORY 1.390452736
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.0s finished
Parallel Leiden runs finished
2024-03-11 18:33:08.305813 MEMORY 1.390452736
Quality: 0.22437212810596996
Quality: 0.22469671319287537
Quality: 0.22572744117188187
Quality: 0.22809894919260632
Quality: 0.22879621040958087
Quality: 0.2288769540033456
Got subclusters: Counter({0: 45, 1: 39, 2: 26, 3: 21, 4: 14, 5: 13})
On merging iteration 1
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  94 out of 141 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=24)]: Done 141 out of 141 | elapsed:    0.1s finished
Numbers for each pattern pre-subsample: [45, 39, 26, 21, 14, 13]
Numbers after subsampling: [45, 39, 26, 21, 14, 13]
Computing sims for pattern 0
Computed sims for pattern 0 in 0.16582894325256348 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.1481332778930664 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.10481500625610352 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.08985161781311035 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.06662249565124512 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.06347823143005371 s
Cluster sizes
[45 39 26 21 14 13]
Cross-contamination matrix:
[[1.   0.5  0.45 0.68 0.82 0.72]
 [0.88 1.   0.65 0.81 0.98 0.83]
 [0.72 0.58 1.   0.8  0.95 0.7 ]
 [0.65 0.41 0.46 1.   0.67 0.56]
 [0.43 0.24 0.29 0.32 1.   0.19]
 [0.53 0.31 0.3  0.4  0.35 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.8  0.79 0.81 0.86 0.79]
 [0.8  1.   0.76 0.7  0.83 0.73]
 [0.79 0.76 1.   0.84 0.82 0.66]
 [0.81 0.7  0.84 1.   0.78 0.74]
 [0.86 0.83 0.82 0.78 1.   0.72]
 [0.79 0.73 0.66 0.74 0.72 1.  ]]
Inspecting pattern 1 for spurious merging
[t-SNE] Computed conditional probabilities for sample 141 / 141
[t-SNE] Mean sigma: 0.553352
Beginning preprocessing + Leiden
2024-03-11 18:33:09.176331 MEMORY 1.390456832
Affmat transformed
2024-03-11 18:33:09.178189 MEMORY 1.390456832
sources, targets, weights extracted
2024-03-11 18:33:09.178889 MEMORY 1.390456832
About to launch parallel Leiden runs
2024-03-11 18:33:09.206994 MEMORY 1.390456832
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.9s finished
Parallel Leiden runs finished
2024-03-11 18:33:11.134444 MEMORY 1.390456832
Quality: 0.24504509226051327
Quality: 0.2458060206909261
Quality: 0.24628098117294914
Quality: 0.2465466885563438
Quality: 0.2477587397678775
Quality: 0.24968214597942506
Quality: 0.25021916622029294
Got subclusters: Counter({0: 39, 1: 32, 2: 30, 3: 24, 4: 16})
On merging iteration 1
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 118 out of 118 | elapsed:    0.0s finished
Numbers for each pattern pre-subsample: [39, 32, 30, 24, 16]
Numbers after subsampling: [39, 32, 30, 24, 16]
Computing sims for pattern 0
Computed sims for pattern 0 in 0.11931324005126953 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.10022115707397461 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.09515929222106934 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.07921218872070312 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.06056928634643555 s
Cluster sizes
[39 32 30 24 16]
Cross-contamination matrix:
[[1.   0.74 0.42 0.4  0.4 ]
 [0.87 1.   0.52 0.57 0.55]
 [0.73 0.68 1.   0.59 0.51]
 [0.77 0.74 0.69 1.   0.66]
 [0.61 0.5  0.42 0.45 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.76 0.5  0.45 0.45]
 [0.76 1.   0.59 0.62 0.59]
 [0.5  0.59 1.   0.54 0.37]
 [0.45 0.62 0.54 1.   0.47]
 [0.45 0.59 0.37 0.47 1.  ]]
Inspecting pattern 2 for spurious merging
[t-SNE] Computed conditional probabilities for sample 118 / 118
[t-SNE] Mean sigma: 0.516254
Beginning preprocessing + Leiden
2024-03-11 18:33:11.762866 MEMORY 1.390456832
Affmat transformed
2024-03-11 18:33:11.764296 MEMORY 1.390456832
sources, targets, weights extracted
2024-03-11 18:33:11.764836 MEMORY 1.390456832
About to launch parallel Leiden runs
2024-03-11 18:33:11.816623 MEMORY 1.390456832
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.9s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.1s finished
Parallel Leiden runs finished
2024-03-11 18:33:13.951493 MEMORY 1.390456832
Quality: 0.22733258918606325
Quality: 0.22822347918598335
Quality: 0.2287010533392771
Got subclusters: Counter({0: 27, 1: 26, 3: 24, 2: 24, 4: 17})
On merging iteration 1
Numbers for each pattern pre-subsample: [27, 26, 24, 24, 17]
Numbers after subsampling: [27, 26, 24, 24, 17]
Computing sims for pattern 0
Computed sims for pattern 0 in 0.08393073081970215 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.07974410057067871 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.07414913177490234 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.07248544692993164 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.05694890022277832 s
Cluster sizes
[27 26 24 24 17]
Cross-contamination matrix:
[[1.   0.54 0.44 0.74 0.62]
 [0.48 1.   0.38 0.73 0.73]
 [0.66 0.64 1.   0.71 0.65]
 [0.6  0.65 0.46 1.   0.59]
 [0.42 0.57 0.26 0.53 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.78 0.65 0.8  0.74]
 [0.78 1.   0.69 0.86 0.82]
 [0.65 0.69 1.   0.68 0.63]
 [0.8  0.86 0.68 1.   0.82]
 [0.74 0.82 0.63 0.82 1.  ]]
Collapsing 1 & 3 with crosscontam 0.6549479166666665 and sim 0.855793230572155
Trimming eliminated 0 seqlets out of 50
Unmerged patterns remapping: OrderedDict([(0, 1), (2, 2), (4, 3)])
Time spent on merging iteration: 0.11467528343200684
On merging iteration 2
Numbers for each pattern pre-subsample: [50, 27, 24, 17]
Numbers after subsampling: [50, 27, 24, 17]
Computing sims for pattern 0
Computed sims for pattern 0 in 0.11059045791625977 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.022355318069458008 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.023090362548828125 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.016767501831054688 s
Cluster sizes
[50 27 24 17]
Cross-contamination matrix:
[[1.   0.67 0.5  0.82]
 [0.61 1.   0.44 0.62]
 [0.65 0.66 1.   0.65]
 [0.55 0.42 0.26 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.84 0.71 0.83]
 [0.84 1.   0.65 0.74]
 [0.71 0.65 1.   0.63]
 [0.83 0.74 0.63 1.  ]]
Merging on 15 clusters
2024-03-11 18:33:14.577774 MEMORY 1.390456832
On merging iteration 1
Numbers for each pattern pre-subsample: [45, 39, 26, 21, 14, 13, 39, 32, 30, 24, 16, 50, 27, 24, 17]
Numbers after subsampling: [45, 39, 26, 21, 14, 13, 39, 32, 30, 24, 16, 50, 27, 24, 17]
Computing sims for pattern 0
Computed sims for pattern 0 in 0.6303291320800781 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.41451025009155273 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.28095531463623047 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.24157953262329102 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.1888422966003418 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.18471455574035645 s
Computing sims for pattern 6
Computed sims for pattern 6 in 0.41593432426452637 s
Computing sims for pattern 7
Computed sims for pattern 7 in 0.3518373966217041 s
Computing sims for pattern 8
Computed sims for pattern 8 in 0.3236966133117676 s
Computing sims for pattern 9
Computed sims for pattern 9 in 0.2782278060913086 s
Computing sims for pattern 10
Computed sims for pattern 10 in 0.2051551342010498 s
Computing sims for pattern 11
Computed sims for pattern 11 in 0.5197770595550537 s
Computing sims for pattern 12
Computed sims for pattern 12 in 0.2945530414581299 s
Computing sims for pattern 13
Computed sims for pattern 13 in 0.2661905288696289 s
Computing sims for pattern 14
Computed sims for pattern 14 in 0.21401286125183105 s
Cluster sizes
[45 39 26 21 14 13 39 32 30 24 16 50 27 24 17]
Cross-contamination matrix:
[[1.   0.5  0.45 0.68 0.82 0.72 0.12 0.15 0.28 0.06 0.13 0.31 0.06 0.37
  0.43]
 [0.88 1.   0.65 0.81 0.98 0.83 0.21 0.26 0.26 0.2  0.3  0.35 0.23 0.42
  0.57]
 [0.72 0.58 1.   0.8  0.95 0.7  0.15 0.15 0.22 0.16 0.2  0.26 0.37 0.26
  0.4 ]
 [0.65 0.41 0.46 1.   0.67 0.56 0.09 0.05 0.22 0.04 0.11 0.27 0.12 0.1
  0.54]
 [0.43 0.24 0.29 0.32 1.   0.19 0.03 0.01 0.07 0.01 0.1  0.06 0.02 0.06
  0.11]
 [0.53 0.31 0.3  0.4  0.35 1.   0.04 0.11 0.11 0.13 0.04 0.21 0.06 0.29
  0.39]
 [0.32 0.22 0.22 0.36 0.35 0.31 1.   0.74 0.42 0.4  0.4  0.27 0.44 0.23
  0.17]
 [0.45 0.42 0.31 0.31 0.36 0.5  0.87 1.   0.52 0.57 0.55 0.31 0.47 0.46
  0.35]
 [0.85 0.53 0.54 0.79 0.66 0.68 0.73 0.68 1.   0.59 0.51 0.54 0.33 0.55
  0.53]
 [0.42 0.48 0.48 0.44 0.42 0.53 0.77 0.74 0.69 1.   0.66 0.37 0.45 0.45
  0.48]
 [0.47 0.46 0.4  0.46 0.72 0.29 0.61 0.5  0.42 0.45 1.   0.14 0.31 0.21
  0.21]
 [0.58 0.38 0.31 0.6  0.42 0.6  0.29 0.23 0.27 0.17 0.04 1.   0.67 0.5
  0.82]
 [0.17 0.21 0.4  0.3  0.2  0.24 0.39 0.31 0.1  0.18 0.12 0.61 1.   0.44
  0.62]
 [0.83 0.56 0.44 0.49 0.58 0.85 0.37 0.47 0.42 0.32 0.19 0.65 0.66 1.
  0.65]
 [0.48 0.32 0.24 0.63 0.36 0.63 0.09 0.12 0.13 0.12 0.03 0.55 0.42 0.26
  1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.8  0.79 0.81 0.86 0.79 0.18 0.49 0.63 0.33 0.26 0.5  0.44 0.76
  0.64]
 [0.8  1.   0.76 0.7  0.83 0.73 0.13 0.44 0.3  0.44 0.37 0.43 0.38 0.59
  0.61]
 [0.79 0.76 1.   0.84 0.82 0.66 0.29 0.31 0.49 0.31 0.32 0.44 0.45 0.45
  0.58]
 [0.81 0.7  0.84 1.   0.78 0.74 0.33 0.33 0.68 0.41 0.25 0.64 0.57 0.57
  0.81]
 [0.86 0.83 0.82 0.78 1.   0.72 0.18 0.39 0.45 0.34 0.54 0.45 0.37 0.61
  0.57]
 [0.79 0.73 0.66 0.74 0.72 1.   0.24 0.52 0.42 0.5  0.21 0.55 0.43 0.68
  0.73]
 [0.18 0.13 0.29 0.33 0.18 0.24 1.   0.76 0.5  0.45 0.45 0.37 0.48 0.37
  0.27]
 [0.49 0.44 0.31 0.33 0.39 0.52 0.76 1.   0.59 0.62 0.59 0.38 0.43 0.56
  0.42]
 [0.63 0.3  0.49 0.68 0.45 0.42 0.5  0.59 1.   0.54 0.37 0.49 0.35 0.52
  0.5 ]
 [0.33 0.44 0.31 0.41 0.34 0.5  0.45 0.62 0.54 1.   0.47 0.41 0.45 0.5
  0.49]
 [0.26 0.37 0.32 0.25 0.54 0.21 0.45 0.59 0.37 0.47 1.   0.13 0.14 0.05
  0.23]
 [0.5  0.43 0.44 0.64 0.45 0.55 0.37 0.38 0.49 0.41 0.13 1.   0.84 0.71
  0.83]
 [0.44 0.38 0.45 0.57 0.37 0.43 0.48 0.43 0.35 0.45 0.14 0.84 1.   0.65
  0.74]
 [0.76 0.59 0.45 0.57 0.61 0.68 0.37 0.56 0.52 0.5  0.05 0.71 0.65 1.
  0.63]
 [0.64 0.61 0.58 0.81 0.57 0.73 0.27 0.42 0.5  0.49 0.23 0.83 0.74 0.63
  1.  ]]
Got 15 patterns after merging
2024-03-11 18:33:19.434707 MEMORY 1.390456832
Performing filtering
2024-03-11 18:33:19.434907 MEMORY 1.390456832
Got 6 patterns after filtering
2024-03-11 18:33:19.493675 MEMORY 1.390460928
Total time taken is 45.7s
2024-03-11 18:33:19.493791 MEMORY 1.390460928
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    0.0s finished
/ru-auth/local/home/lzhao/anaconda3/envs/jupyter-ml-clone/lib/python3.9/site-packages/sklearn/manifold/_t_sne.py:691: FutureWarning: 'square_distances' has been introduced in 0.24 to help phase out legacy squaring behavior. The 'legacy' setting will be removed in 1.1 (renaming of 0.26), and the default setting will be changed to True. In 1.3, 'square_distances' will be removed altogether, and distances will be squared by default. Set 'square_distances'=True to silence this warning.
  warnings.warn(
/ru-auth/local/home/lzhao/anaconda3/envs/jupyter-ml-clone/lib/python3.9/site-packages/sklearn/neighbors/_base.py:175: EfficiencyWarning: Precomputed sparse input was not sorted by data.
  warnings.warn('Precomputed sparse input was not sorted by data.',
Applying subclustering to the final motifs
On pattern 0
[t-SNE] Computing 49 nearest neighbors...
[t-SNE] Indexed 50 samples in 0.000s...
[t-SNE] Computed neighbors for 50 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 50 / 50
[t-SNE] Mean sigma: 11.684748
[t-SNE] Computed conditional probabilities in 0.001s
[t-SNE] Iteration 50: error = 44.4742813, gradient norm = 0.3991827 (50 iterations in 0.014s)
[t-SNE] Iteration 100: error = 44.0009384, gradient norm = 0.4616085 (50 iterations in 0.012s)
[t-SNE] Iteration 150: error = 42.9342346, gradient norm = 0.4291727 (50 iterations in 0.013s)
[t-SNE] Iteration 200: error = 44.6902924, gradient norm = 0.3262709 (50 iterations in 0.012s)
[t-SNE] Iteration 250: error = 43.5199966, gradient norm = 0.4236185 (50 iterations in 0.014s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 43.519997
[t-SNE] Iteration 300: error = 0.6883128, gradient norm = 0.0012377 (50 iterations in 0.014s)
[t-SNE] Iteration 350: error = 0.6228965, gradient norm = 0.0002773 (50 iterations in 0.013s)
[t-SNE] Iteration 400: error = 0.6163133, gradient norm = 0.0001057 (50 iterations in 0.012s)
[t-SNE] Iteration 450: error = 0.6146680, gradient norm = 0.0000906 (50 iterations in 0.013s)
[t-SNE] Iteration 500: error = 0.6124831, gradient norm = 0.0000936 (50 iterations in 0.012s)
[t-SNE] Iteration 550: error = 0.6129488, gradient norm = 0.0000546 (50 iterations in 0.014s)
[t-SNE] Iteration 600: error = 0.6128125, gradient norm = 0.0000550 (50 iterations in 0.012s)
[t-SNE] Iteration 650: error = 0.6137017, gradient norm = 0.0000798 (50 iterations in 0.012s)
[t-SNE] Iteration 700: error = 0.6133062, gradient norm = 0.0000404 (50 iterations in 0.012s)
[t-SNE] Iteration 750: error = 0.6120664, gradient norm = 0.0001044 (50 iterations in 0.014s)
[t-SNE] Iteration 800: error = 0.6111512, gradient norm = 0.0001180 (50 iterations in 0.013s)
[t-SNE] Iteration 850: error = 0.6090883, gradient norm = 0.0001763 (50 iterations in 0.014s)
[t-SNE] Iteration 900: error = 0.7088853, gradient norm = 0.0576195 (50 iterations in 0.012s)
[t-SNE] Iteration 950: error = 0.8166950, gradient norm = 0.0010380 (50 iterations in 0.014s)
[t-SNE] Iteration 1000: error = 0.7149432, gradient norm = 0.0004257 (50 iterations in 0.013s)
[t-SNE] KL divergence after 1000 iterations: 0.714943
[t-SNE] Computed conditional probabilities for sample 50 / 50
[t-SNE] Mean sigma: 1125899906842624.000000
Beginning preprocessing + Leiden
2024-03-11 18:33:19.793392 MEMORY 1.390460928
Affmat transformed
2024-03-11 18:33:19.794142 MEMORY 1.390460928
sources, targets, weights extracted
2024-03-11 18:33:19.794472 MEMORY 1.390460928
About to launch parallel Leiden runs
2024-03-11 18:33:19.826723 MEMORY 1.390460928
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.1s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.6s finished
Parallel Leiden runs finished
2024-03-11 18:33:22.416863 MEMORY 1.383411712
Quality: -8.881784197001154e-16
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done  45 out of  45 | elapsed:    0.0s finished
Got subclusters: Counter({0: 50})
On pattern 1
[t-SNE] Computing 44 nearest neighbors...
[t-SNE] Indexed 45 samples in 0.000s...
[t-SNE] Computed neighbors for 45 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 45 / 45
[t-SNE] Mean sigma: 10.627379
[t-SNE] Computed conditional probabilities in 0.001s
[t-SNE] Iteration 50: error = 39.5135193, gradient norm = 0.6097582 (50 iterations in 2.064s)
[t-SNE] Iteration 100: error = 42.1608849, gradient norm = 0.6600135 (50 iterations in 2.042s)
[t-SNE] Iteration 150: error = 44.8079414, gradient norm = 0.3374342 (50 iterations in 1.362s)
[t-SNE] Iteration 200: error = 42.2937164, gradient norm = 0.6968895 (50 iterations in 0.012s)
[t-SNE] Iteration 250: error = 43.3455467, gradient norm = 0.3608601 (50 iterations in 0.013s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 43.345547
[t-SNE] Iteration 300: error = 0.6940491, gradient norm = 0.0010512 (50 iterations in 0.016s)
[t-SNE] Iteration 350: error = 0.6131879, gradient norm = 0.0004023 (50 iterations in 0.012s)
[t-SNE] Iteration 400: error = 0.5941572, gradient norm = 0.0000658 (50 iterations in 0.016s)
[t-SNE] Iteration 450: error = 0.5933984, gradient norm = 0.0000359 (50 iterations in 0.013s)
[t-SNE] Iteration 500: error = 0.5925037, gradient norm = 0.0000455 (50 iterations in 0.017s)
[t-SNE] Iteration 550: error = 0.5916878, gradient norm = 0.0000309 (50 iterations in 0.012s)
[t-SNE] Iteration 600: error = 0.5919739, gradient norm = 0.0000515 (50 iterations in 0.013s)
[t-SNE] Iteration 650: error = 0.5916991, gradient norm = 0.0000440 (50 iterations in 0.012s)
[t-SNE] Iteration 700: error = 0.5915425, gradient norm = 0.0000329 (50 iterations in 0.012s)
[t-SNE] Iteration 750: error = 0.5904179, gradient norm = 0.0000453 (50 iterations in 0.014s)
[t-SNE] Iteration 800: error = 0.5905787, gradient norm = 0.0000353 (50 iterations in 0.012s)
[t-SNE] Iteration 850: error = 0.5903249, gradient norm = 0.0000308 (50 iterations in 0.012s)
[t-SNE] Iteration 900: error = 0.5898129, gradient norm = 0.0000378 (50 iterations in 0.088s)
[t-SNE] Iteration 950: error = 0.5896807, gradient norm = 0.0000360 (50 iterations in 0.090s)
[t-SNE] Iteration 1000: error = 0.5894479, gradient norm = 0.0000431 (50 iterations in 0.012s)
[t-SNE] KL divergence after 1000 iterations: 0.589448
[t-SNE] Computed conditional probabilities for sample 45 / 45
[t-SNE] Mean sigma: 1125899906842624.000000
Beginning preprocessing + Leiden
2024-03-11 18:33:28.306245 MEMORY 1.38346496
Affmat transformed
2024-03-11 18:33:28.307248 MEMORY 1.38346496
sources, targets, weights extracted
2024-03-11 18:33:28.307670 MEMORY 1.38346496
About to launch parallel Leiden runs
2024-03-11 18:33:28.331440 MEMORY 1.38346496
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.6s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.6s finished
Parallel Leiden runs finished
2024-03-11 18:33:29.979980 MEMORY 1.38346496
Quality: -1.6509016376176883e-13
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done  32 out of  39 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=24)]: Done  39 out of  39 | elapsed:    0.0s finished
Got subclusters: Counter({0: 45})
On pattern 2
[t-SNE] Computing 38 nearest neighbors...
[t-SNE] Indexed 39 samples in 0.000s...
[t-SNE] Computed neighbors for 39 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 39 / 39
[t-SNE] Mean sigma: 11.461606
[t-SNE] Computed conditional probabilities in 0.001s
[t-SNE] Iteration 50: error = 45.2297707, gradient norm = 0.4251580 (50 iterations in 0.028s)
[t-SNE] Iteration 100: error = 42.5756912, gradient norm = 0.4518838 (50 iterations in 0.012s)
[t-SNE] Iteration 150: error = 45.7549973, gradient norm = 0.3445534 (50 iterations in 0.014s)
[t-SNE] Iteration 200: error = 43.3224487, gradient norm = 0.4008952 (50 iterations in 0.013s)
[t-SNE] Iteration 250: error = 44.6066170, gradient norm = 0.6868788 (50 iterations in 0.012s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 44.606617
[t-SNE] Iteration 300: error = 0.7608418, gradient norm = 0.0010964 (50 iterations in 0.015s)
[t-SNE] Iteration 350: error = 0.6469058, gradient norm = 0.0004114 (50 iterations in 0.013s)
[t-SNE] Iteration 400: error = 0.5891878, gradient norm = 0.0002639 (50 iterations in 0.013s)
[t-SNE] Iteration 450: error = 0.5632063, gradient norm = 0.0000635 (50 iterations in 0.014s)
[t-SNE] Iteration 500: error = 0.5613387, gradient norm = 0.0000334 (50 iterations in 0.014s)
[t-SNE] Iteration 550: error = 0.5609674, gradient norm = 0.0000233 (50 iterations in 0.012s)
[t-SNE] Iteration 600: error = 0.5608178, gradient norm = 0.0000272 (50 iterations in 0.013s)
[t-SNE] Iteration 650: error = 0.5598528, gradient norm = 0.0000147 (50 iterations in 0.012s)
[t-SNE] Iteration 700: error = 0.5596960, gradient norm = 0.0000130 (50 iterations in 0.013s)
[t-SNE] Iteration 750: error = 0.5595816, gradient norm = 0.0000148 (50 iterations in 0.015s)
[t-SNE] Iteration 800: error = 0.5595726, gradient norm = 0.0000137 (50 iterations in 0.012s)
[t-SNE] Iteration 850: error = 0.5599359, gradient norm = 0.0000114 (50 iterations in 0.014s)
[t-SNE] Iteration 900: error = 0.5598849, gradient norm = 0.0000103 (50 iterations in 0.013s)
[t-SNE] Iteration 950: error = 0.5598614, gradient norm = 0.0000102 (50 iterations in 0.012s)
[t-SNE] Iteration 1000: error = 0.5598454, gradient norm = 0.0000106 (50 iterations in 0.014s)
[t-SNE] KL divergence after 1000 iterations: 0.559845
[t-SNE] Computed conditional probabilities for sample 39 / 39
[t-SNE] Mean sigma: 1125899906842624.000000
Beginning preprocessing + Leiden
2024-03-11 18:33:30.300249 MEMORY 1.38346496
Affmat transformed
2024-03-11 18:33:30.301049 MEMORY 1.38346496
sources, targets, weights extracted
2024-03-11 18:33:30.301387 MEMORY 1.38346496
About to launch parallel Leiden runs
2024-03-11 18:33:30.345911 MEMORY 1.38346496
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.6s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.6s finished
Parallel Leiden runs finished
2024-03-11 18:33:31.995547 MEMORY 1.38346496
Quality: 4.0412118096357004e-14
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done  32 out of  39 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=24)]: Done  39 out of  39 | elapsed:    0.0s finished
Got subclusters: Counter({0: 39})
On pattern 3
[t-SNE] Computing 38 nearest neighbors...
[t-SNE] Indexed 39 samples in 0.001s...
[t-SNE] Computed neighbors for 39 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 39 / 39
[t-SNE] Mean sigma: 12.072772
[t-SNE] Computed conditional probabilities in 0.001s
[t-SNE] Iteration 50: error = 41.9568253, gradient norm = 0.5267698 (50 iterations in 0.044s)
[t-SNE] Iteration 100: error = 46.6447830, gradient norm = 0.4401739 (50 iterations in 0.014s)
[t-SNE] Iteration 150: error = 44.0125732, gradient norm = 0.3942465 (50 iterations in 0.012s)
[t-SNE] Iteration 200: error = 43.5066872, gradient norm = 0.6124097 (50 iterations in 0.014s)
[t-SNE] Iteration 250: error = 43.5859146, gradient norm = 0.5250437 (50 iterations in 0.014s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 43.585915
[t-SNE] Iteration 300: error = 0.5717204, gradient norm = 0.0004932 (50 iterations in 0.012s)
[t-SNE] Iteration 350: error = 0.5592632, gradient norm = 0.0001496 (50 iterations in 0.014s)
[t-SNE] Iteration 400: error = 0.5586715, gradient norm = 0.0000289 (50 iterations in 0.013s)
[t-SNE] Iteration 450: error = 0.5585504, gradient norm = 0.0000352 (50 iterations in 0.011s)
[t-SNE] Iteration 500: error = 0.5578858, gradient norm = 0.0000512 (50 iterations in 0.014s)
[t-SNE] Iteration 550: error = 0.5570140, gradient norm = 0.0000715 (50 iterations in 0.013s)
[t-SNE] Iteration 600: error = 0.5535508, gradient norm = 0.0002430 (50 iterations in 0.013s)
[t-SNE] Iteration 650: error = 0.7544343, gradient norm = 0.0046436 (50 iterations in 0.014s)
[t-SNE] Iteration 700: error = 0.5892898, gradient norm = 0.0005296 (50 iterations in 0.019s)
[t-SNE] Iteration 750: error = 0.5630549, gradient norm = 0.0001446 (50 iterations in 0.012s)
[t-SNE] Iteration 800: error = 0.5605630, gradient norm = 0.0000606 (50 iterations in 0.013s)
[t-SNE] Iteration 850: error = 0.5599906, gradient norm = 0.0000267 (50 iterations in 0.013s)
[t-SNE] Iteration 900: error = 0.5595329, gradient norm = 0.0000235 (50 iterations in 0.012s)
[t-SNE] Iteration 950: error = 0.5591271, gradient norm = 0.0000128 (50 iterations in 0.013s)
[t-SNE] Iteration 950: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 950 iterations: 0.559127
[t-SNE] Computed conditional probabilities for sample 39 / 39
[t-SNE] Mean sigma: 1125899906842624.000000
Beginning preprocessing + Leiden
2024-03-11 18:33:32.327502 MEMORY 1.38346496
Affmat transformed
2024-03-11 18:33:32.328587 MEMORY 1.38346496
sources, targets, weights extracted
2024-03-11 18:33:32.329045 MEMORY 1.38346496
About to launch parallel Leiden runs
2024-03-11 18:33:32.369732 MEMORY 1.38346496
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.6s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.6s finished
Parallel Leiden runs finished
2024-03-11 18:33:33.987747 MEMORY 1.38346496
Quality: 4.0412118096357004e-14
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done  18 out of  32 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=24)]: Done  32 out of  32 | elapsed:    0.0s finished
Got subclusters: Counter({0: 39})
On pattern 4
[t-SNE] Computing 31 nearest neighbors...
[t-SNE] Indexed 32 samples in 0.000s...
[t-SNE] Computed neighbors for 32 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 32 / 32
[t-SNE] Mean sigma: 16.490410
[t-SNE] Computed conditional probabilities in 0.001s
[t-SNE] Iteration 50: error = 43.1646881, gradient norm = 0.3892416 (50 iterations in 0.021s)
[t-SNE] Iteration 100: error = 42.6351128, gradient norm = 0.5455157 (50 iterations in 0.013s)
[t-SNE] Iteration 150: error = 41.9338913, gradient norm = 0.6993127 (50 iterations in 0.014s)
[t-SNE] Iteration 200: error = 41.1152115, gradient norm = 0.6121939 (50 iterations in 0.013s)
[t-SNE] Iteration 250: error = 38.9870872, gradient norm = 0.8370706 (50 iterations in 0.013s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 38.987087
[t-SNE] Iteration 300: error = 0.7190759, gradient norm = 0.0010779 (50 iterations in 0.013s)
[t-SNE] Iteration 350: error = 0.5782261, gradient norm = 0.0004709 (50 iterations in 0.013s)
[t-SNE] Iteration 400: error = 0.5255212, gradient norm = 0.0001475 (50 iterations in 0.011s)
[t-SNE] Iteration 450: error = 0.5190067, gradient norm = 0.0000626 (50 iterations in 0.013s)
[t-SNE] Iteration 500: error = 0.5161853, gradient norm = 0.0000495 (50 iterations in 0.013s)
[t-SNE] Iteration 550: error = 0.5153260, gradient norm = 0.0000158 (50 iterations in 0.011s)
[t-SNE] Iteration 600: error = 0.5150809, gradient norm = 0.0000170 (50 iterations in 0.013s)
[t-SNE] Iteration 650: error = 0.5145617, gradient norm = 0.0000316 (50 iterations in 0.011s)
[t-SNE] Iteration 700: error = 0.5124314, gradient norm = 0.0000232 (50 iterations in 0.013s)
[t-SNE] Iteration 750: error = 0.5122665, gradient norm = 0.0000131 (50 iterations in 0.016s)
[t-SNE] Iteration 800: error = 0.5123314, gradient norm = 0.0000113 (50 iterations in 0.011s)
[t-SNE] Iteration 850: error = 0.5123104, gradient norm = 0.0000128 (50 iterations in 0.011s)
[t-SNE] Iteration 900: error = 0.5121610, gradient norm = 0.0000139 (50 iterations in 0.011s)
[t-SNE] Iteration 950: error = 0.5121431, gradient norm = 0.0000132 (50 iterations in 0.011s)
[t-SNE] Iteration 1000: error = 0.5122648, gradient norm = 0.0000137 (50 iterations in 0.013s)
[t-SNE] KL divergence after 1000 iterations: 0.512265
[t-SNE] Computed conditional probabilities for sample 32 / 32
[t-SNE] Mean sigma: 1125899906842624.000000
Beginning preprocessing + Leiden
2024-03-11 18:33:34.277503 MEMORY 1.38346496
Affmat transformed
2024-03-11 18:33:34.278285 MEMORY 1.38346496
sources, targets, weights extracted
2024-03-11 18:33:34.278672 MEMORY 1.383477248
About to launch parallel Leiden runs
2024-03-11 18:33:34.310547 MEMORY 1.383477248
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.6s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.6s finished
Parallel Leiden runs finished
2024-03-11 18:33:35.942764 MEMORY 1.383501824
Quality: 2.0650148258028073e-14
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done  14 out of  30 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=24)]: Done  30 out of  30 | elapsed:    0.0s finished
Got subclusters: Counter({0: 32})
On pattern 5
[t-SNE] Computing 29 nearest neighbors...
[t-SNE] Indexed 30 samples in 0.000s...
[t-SNE] Computed neighbors for 30 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 30 / 30
[t-SNE] Mean sigma: 16.488129
[t-SNE] Computed conditional probabilities in 0.001s
[t-SNE] Iteration 50: error = 43.7319679, gradient norm = 0.5851312 (50 iterations in 0.012s)
[t-SNE] Iteration 100: error = 40.2292938, gradient norm = 0.5700566 (50 iterations in 0.018s)
[t-SNE] Iteration 150: error = 42.3996086, gradient norm = 0.3533260 (50 iterations in 0.011s)
[t-SNE] Iteration 200: error = 41.5063515, gradient norm = 0.4146113 (50 iterations in 0.013s)
[t-SNE] Iteration 250: error = 42.5793076, gradient norm = 0.5426058 (50 iterations in 0.013s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 42.579308
[t-SNE] Iteration 300: error = 0.6865238, gradient norm = 0.0010279 (50 iterations in 0.014s)
[t-SNE] Iteration 350: error = 0.5687758, gradient norm = 0.0003934 (50 iterations in 0.013s)
[t-SNE] Iteration 400: error = 0.5083125, gradient norm = 0.0001420 (50 iterations in 0.014s)
[t-SNE] Iteration 450: error = 0.5024431, gradient norm = 0.0000647 (50 iterations in 0.013s)
[t-SNE] Iteration 500: error = 0.5009201, gradient norm = 0.0000285 (50 iterations in 0.011s)
[t-SNE] Iteration 550: error = 0.5001611, gradient norm = 0.0000261 (50 iterations in 0.013s)
[t-SNE] Iteration 600: error = 0.4994868, gradient norm = 0.0000176 (50 iterations in 0.011s)
[t-SNE] Iteration 650: error = 0.4991648, gradient norm = 0.0000187 (50 iterations in 0.014s)
[t-SNE] Iteration 700: error = 0.4990468, gradient norm = 0.0000213 (50 iterations in 0.013s)
[t-SNE] Iteration 750: error = 0.4988332, gradient norm = 0.0000164 (50 iterations in 0.012s)
[t-SNE] Iteration 800: error = 0.4989886, gradient norm = 0.0000135 (50 iterations in 0.014s)
[t-SNE] Iteration 850: error = 0.4990730, gradient norm = 0.0000130 (50 iterations in 0.012s)
[t-SNE] Iteration 900: error = 0.4991176, gradient norm = 0.0000140 (50 iterations in 0.012s)
[t-SNE] Iteration 950: error = 0.4991948, gradient norm = 0.0000136 (50 iterations in 0.012s)
[t-SNE] Iteration 1000: error = 0.4991243, gradient norm = 0.0000188 (50 iterations in 0.013s)
[t-SNE] KL divergence after 1000 iterations: 0.499124
[t-SNE] Computed conditional probabilities for sample 30 / 30
[t-SNE] Mean sigma: 1125899906842624.000000
Beginning preprocessing + Leiden
2024-03-11 18:33:36.231087 MEMORY 1.3835264
Affmat transformed
2024-03-11 18:33:36.231884 MEMORY 1.3835264
sources, targets, weights extracted
2024-03-11 18:33:36.232245 MEMORY 1.3835264
About to launch parallel Leiden runs
2024-03-11 18:33:36.247472 MEMORY 1.3835264
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.6s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.6s finished
Parallel Leiden runs finished
2024-03-11 18:33:37.884583 MEMORY 1.3835264
Quality: 1.9095836023552904e-14
Got subclusters: Counter({0: 30})
On metacluster 1
Metacluster size 6235
Relevant tasks:  ('head', 'testis')
Relevant signs:  (1, 1)
TfModiscoSeqletsToPatternsFactory: seed=1234
(Round 1) num seqlets: 6235
(Round 1) Computing coarse affmat
2024-03-11 18:33:38.262312 MEMORY 1.383264256
Beginning embedding computation
MEMORY 1.383264256
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 152 tasks      | elapsed:    1.9s
[Parallel(n_jobs=24)]: Done 402 tasks      | elapsed:    4.7s
[Parallel(n_jobs=24)]: Done 752 tasks      | elapsed:    8.6s
[Parallel(n_jobs=24)]: Done 1202 tasks      | elapsed:   13.5s
[Parallel(n_jobs=24)]: Done 1752 tasks      | elapsed:   19.5s
[Parallel(n_jobs=24)]: Done 2402 tasks      | elapsed:   26.4s
[Parallel(n_jobs=24)]: Done 3152 tasks      | elapsed:   34.5s
[Parallel(n_jobs=24)]: Done 4002 tasks      | elapsed:   44.0s
[Parallel(n_jobs=24)]: Done 4952 tasks      | elapsed:   54.5s
[Parallel(n_jobs=24)]: Done 6002 tasks      | elapsed:  1.1min
[Parallel(n_jobs=24)]: Done 6235 out of 6235 | elapsed:  1.1min finished
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 152 tasks      | elapsed:    1.8s
[Parallel(n_jobs=24)]: Done 402 tasks      | elapsed:    4.6s
[Parallel(n_jobs=24)]: Done 752 tasks      | elapsed:    8.4s
[Parallel(n_jobs=24)]: Done 1202 tasks      | elapsed:   13.2s
[Parallel(n_jobs=24)]: Done 1752 tasks      | elapsed:   19.3s
[Parallel(n_jobs=24)]: Done 2402 tasks      | elapsed:   26.3s
[Parallel(n_jobs=24)]: Done 3152 tasks      | elapsed:   34.3s
[Parallel(n_jobs=24)]: Done 4002 tasks      | elapsed:   43.8s
[Parallel(n_jobs=24)]: Done 4952 tasks      | elapsed:   54.1s
[Parallel(n_jobs=24)]: Done 6002 tasks      | elapsed:  1.1min
[Parallel(n_jobs=24)]: Done 6235 out of 6235 | elapsed:  1.1min finished
At the beginning of embedding call
2024-03-11 18:33:38.262550 MEMORY 1.383264256
before computing embeddings fwd
2024-03-11 18:33:38.271464 MEMORY 1.383309312
after computing embeddings fwd
2024-03-11 18:34:46.594745 MEMORY 1.612414976
after computing embeddings rev
2024-03-11 18:35:54.486000 MEMORY 1.867395072
before computing sparse embeddings fwd
2024-03-11 18:35:54.486096 MEMORY 1.867395072
Constructing csr matrix...
csr matrix made in 0.7907998561859131 s
after computing sparse embeddings fwd
2024-03-11 18:35:55.579539 MEMORY 1.982926848
before computing sparse embeddings rev
2024-03-11 18:35:55.579627 MEMORY 1.982926848
Constructing csr matrix...
csr matrix made in 0.7034168243408203 s
after computing sparse embeddings rev
2024-03-11 18:35:56.543160 MEMORY 2.09598464
Finished embedding computation in 138.73 s
MEMORY 1.819164672
Starting affinity matrix computations
MEMORY 1.818648576
Batching in slices of size 6235
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:04<00:00,  4.58s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:04<00:00,  4.58s/it]
Finished affinity matrix computations in 4.62 s
MEMORY 1.820356608
(Round 1) Computed coarse affmat
2024-03-11 18:36:01.838013 MEMORY 1.795035136
(Round 1) Computing affinity matrix on nearest neighbors
2024-03-11 18:36:01.838144 MEMORY 1.795035136
Launching nearest neighbors affmat calculation job
MEMORY 1.795043328
Parallel runs completed
MEMORY 1.943519232
Job completed in: 22.23 s
MEMORY 1.943396352
Launching nearest neighbors affmat calculation job
MEMORY 1.941430272
Parallel runs completed
MEMORY 2.050187264
Job completed in: 21.62 s
MEMORY 2.048086016
(Round 1) Computed affinity matrix on nearest neighbors in 45.41 s
2024-03-11 18:36:47.246107 MEMORY 1.957036032
Filtered down to 5756 of 6235
(Round 1) Retained 5756 rows out of 6235 after filtering
2024-03-11 18:36:50.407931 MEMORY 1.957036032
(Round 1) Computing density adapted affmat
2024-03-11 18:36:51.550444 MEMORY 2.00269824
Symmetrizing nearest neighbors
Computing betas for density adaptation
Computing normalizing denominators
(Round 1) Computing clustering
2024-03-11 18:37:34.350774 MEMORY 2.289917952
Beginning preprocessing + Leiden
2024-03-11 18:37:34.358104 MEMORY 2.289917952
Affmat transformed
2024-03-11 18:37:34.358214 MEMORY 2.289917952
sources, targets, weights extracted
2024-03-11 18:37:34.513884 MEMORY 2.289922048
About to launch parallel Leiden runs
2024-03-11 18:37:34.578022 MEMORY 2.289926144
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:   27.9s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:  1.7min finished
Parallel Leiden runs finished
2024-03-11 18:39:16.656497 MEMORY 2.28988928
Quality: 0.28698997613421356
Quality: 0.28699586200435784
Quality: 0.2869958780305942
Quality: 0.2869958873679265
Quality: 0.28699591756485504
Got 5 clusters after round 1
Counts:
{2: 1231, 4: 897, 3: 952, 0: 1407, 1: 1269}
2024-03-11 18:39:16.672286 MEMORY 2.290003968
(Round 1) Aggregating seqlets in each cluster
2024-03-11 18:39:16.672375 MEMORY 2.290003968
Aggregating for cluster 0 with 1407 seqlets
2024-03-11 18:39:16.674131 MEMORY 2.290003968
Skipped 11 due to duplicates
Trimming eliminated 0 seqlets out of 1396
Aggregating for cluster 1 with 1269 seqlets
2024-03-11 18:39:20.135381 MEMORY 2.290802688
Skipped 7 due to duplicates
Trimming eliminated 0 seqlets out of 1262
Aggregating for cluster 2 with 1231 seqlets
2024-03-11 18:39:23.227230 MEMORY 2.290802688
Removed 1 duplicate seqlets
Removed 1 duplicate seqlets
Skipped 8 due to duplicates
Trimming eliminated 0 seqlets out of 1221
Aggregating for cluster 3 with 952 seqlets
2024-03-11 18:39:25.996112 MEMORY 2.292535296
Skipped 9 due to duplicates
Trimming eliminated 0 seqlets out of 943
Removed 3 duplicate seqlets
Aggregating for cluster 4 with 897 seqlets
2024-03-11 18:39:28.363700 MEMORY 2.292637696
Removed 1 duplicate seqlets
Skipped 10 due to duplicates
Trimming eliminated 0 seqlets out of 886
Removed 2 duplicate seqlets
(Round 2) num seqlets: 5695
(Round 2) Computing coarse affmat
2024-03-11 18:39:30.571827 MEMORY 2.294726656
Beginning embedding computation
MEMORY 2.294726656
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done 2400 tasks      | elapsed:    2.6s
[Parallel(n_jobs=24)]: Done 5200 tasks      | elapsed:    5.2s
[Parallel(n_jobs=24)]: Done 5695 out of 5695 | elapsed:    6.0s finished
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 368 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done 1368 tasks      | elapsed:    2.1s
[Parallel(n_jobs=24)]: Done 2768 tasks      | elapsed:    4.0s
[Parallel(n_jobs=24)]: Done 4568 tasks      | elapsed:    6.3s
[Parallel(n_jobs=24)]: Done 5695 out of 5695 | elapsed:    7.9s finished
At the beginning of embedding call
2024-03-11 18:39:30.572043 MEMORY 2.294726656
before computing embeddings fwd
2024-03-11 18:39:30.580391 MEMORY 2.294984704
after computing embeddings fwd
2024-03-11 18:39:36.628706 MEMORY 2.52850176
after computing embeddings rev
2024-03-11 18:39:44.532191 MEMORY 2.762887168
before computing sparse embeddings fwd
2024-03-11 18:39:44.532290 MEMORY 2.762887168
Constructing csr matrix...
csr matrix made in 0.6381733417510986 s
after computing sparse embeddings fwd
2024-03-11 18:39:45.508661 MEMORY 2.763096064
before computing sparse embeddings rev
2024-03-11 18:39:45.508739 MEMORY 2.763096064
Constructing csr matrix...
csr matrix made in 0.6339442729949951 s
after computing sparse embeddings rev
2024-03-11 18:39:46.460955 MEMORY 2.763124736
Finished embedding computation in 16.38 s
MEMORY 2.53663232
Starting affinity matrix computations
MEMORY 2.536370176
Batching in slices of size 5695
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:04<00:00,  4.99s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:04<00:00,  4.99s/it]
Finished affinity matrix computations in 5.02 s
MEMORY 2.536153088
(Round 2) Computed coarse affmat
2024-03-11 18:39:52.174371 MEMORY 2.535940096
(Round 2) Computing affinity matrix on nearest neighbors
2024-03-11 18:39:52.174511 MEMORY 2.535940096
Launching nearest neighbors affmat calculation job
MEMORY 2.535677952
Parallel runs completed
MEMORY 2.582171648
Job completed in: 9.66 s
MEMORY 2.579902464
Launching nearest neighbors affmat calculation job
MEMORY 2.577584128
Parallel runs completed
MEMORY 2.563944448
Job completed in: 9.56 s
MEMORY 2.561789952
(Round 2) Computed affinity matrix on nearest neighbors in 20.55 s
2024-03-11 18:40:12.729306 MEMORY 2.559496192
Not applying filtering for rounds above first round
2024-03-11 18:40:12.729993 MEMORY 2.559496192
(Round 2) Computing density adapted affmat
2024-03-11 18:40:13.903293 MEMORY 2.596937728
Symmetrizing nearest neighbors
Computing betas for density adaptation
Computing normalizing denominators
(Round 2) Computing clustering
2024-03-11 18:41:01.950249 MEMORY 2.454528
Beginning preprocessing + Leiden
2024-03-11 18:41:01.957517 MEMORY 2.454532096
Affmat transformed
2024-03-11 18:41:01.957654 MEMORY 2.454532096
sources, targets, weights extracted
2024-03-11 18:41:02.133083 MEMORY 2.454536192
About to launch parallel Leiden runs
2024-03-11 18:41:02.191957 MEMORY 2.454536192
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:   16.2s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:  1.6min finished
Parallel Leiden runs finished
2024-03-11 18:42:39.893663 MEMORY 2.454536192
Quality: 0.38095080557228783
Got 5 clusters after round 2
Counts:
{0: 1504, 4: 1003, 2: 1049, 1: 1119, 3: 1020}
2024-03-11 18:42:39.909297 MEMORY 2.454536192
(Round 2) Aggregating seqlets in each cluster
2024-03-11 18:42:39.909387 MEMORY 2.454536192
Aggregating for cluster 0 with 1504 seqlets
2024-03-11 18:42:39.912152 MEMORY 2.454536192
Skipped 2 due to duplicates
Trimming eliminated 0 seqlets out of 1502
Aggregating for cluster 1 with 1119 seqlets
2024-03-11 18:42:42.632241 MEMORY 2.454757376
Skipped 2 due to duplicates
Trimming eliminated 0 seqlets out of 1117
Aggregating for cluster 2 with 1049 seqlets
2024-03-11 18:42:44.543574 MEMORY 2.454757376
Removed 1 duplicate seqlets
Skipped 2 due to duplicates
Trimming eliminated 0 seqlets out of 1046
Aggregating for cluster 3 with 1020 seqlets
2024-03-11 18:42:46.727104 MEMORY 2.454757376
Skipped 3 due to duplicates
Trimming eliminated 0 seqlets out of 1017
Aggregating for cluster 4 with 1003 seqlets
2024-03-11 18:42:48.657687 MEMORY 2.454757376
Skipped 2 due to duplicates
Trimming eliminated 0 seqlets out of 1001
Got 5 clusters
Splitting into subclusters...
2024-03-11 18:42:50.369415 MEMORY 2.454757376
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 1502 out of 1502 | elapsed:    0.4s finished
Inspecting pattern 0 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 1502
[t-SNE] Computed conditional probabilities for sample 1502 / 1502
[t-SNE] Mean sigma: 0.362443
Beginning preprocessing + Leiden
2024-03-11 18:42:52.339812 MEMORY 2.45561344
Affmat transformed
2024-03-11 18:42:52.358502 MEMORY 2.45561344
sources, targets, weights extracted
2024-03-11 18:42:52.368380 MEMORY 2.455617536
About to launch parallel Leiden runs
2024-03-11 18:42:54.852476 MEMORY 2.455617536
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    3.8s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   14.5s finished
Parallel Leiden runs finished
2024-03-11 18:43:09.381868 MEMORY 2.455617536
Quality: 0.4727846451351422
Quality: 0.4736244766283486
Quality: 0.4737892546559873
Got subclusters: Counter({0: 359, 1: 265, 2: 241, 3: 214, 4: 210, 5: 137, 6: 68, 7: 8})
On merging iteration 1
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 1117 out of 1117 | elapsed:    0.2s finished
Numbers for each pattern pre-subsample: [359, 265, 241, 214, 210, 137, 68, 8]
Numbers after subsampling: [300, 265, 241, 214, 210, 137, 68, 8]
Computing sims for pattern 0
Computed sims for pattern 0 in 2.232928514480591 s
Computing sims for pattern 1
Computed sims for pattern 1 in 2.1767001152038574 s
Computing sims for pattern 2
Computed sims for pattern 2 in 1.5509908199310303 s
Computing sims for pattern 3
Computed sims for pattern 3 in 1.7279534339904785 s
Computing sims for pattern 4
Computed sims for pattern 4 in 1.7325360774993896 s
Computing sims for pattern 5
Computed sims for pattern 5 in 1.1922688484191895 s
Computing sims for pattern 6
Computed sims for pattern 6 in 0.7318177223205566 s
Computing sims for pattern 7
Computed sims for pattern 7 in 0.24892568588256836 s
Cluster sizes
[359 265 241 214 210 137  68   8]
Cross-contamination matrix:
[[1.   0.41 0.18 0.24 0.48 0.84 0.54 0.3 ]
 [0.79 1.   0.5  0.49 0.83 0.75 0.58 0.61]
 [0.41 0.47 1.   0.57 0.5  0.5  0.63 0.53]
 [0.53 0.49 0.63 1.   0.55 0.53 0.65 0.33]
 [0.7  0.64 0.38 0.39 1.   0.61 0.59 0.16]
 [0.67 0.28 0.16 0.16 0.29 1.   0.31 0.22]
 [0.64 0.33 0.39 0.39 0.49 0.53 1.   0.38]
 [0.14 0.13 0.11 0.04 0.04 0.14 0.13 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.8  0.5  0.53 0.78 0.78 0.77 0.55]
 [0.8  1.   0.63 0.63 0.8  0.7  0.66 0.55]
 [0.5  0.63 1.   0.64 0.6  0.51 0.54 0.43]
 [0.53 0.63 0.64 1.   0.55 0.49 0.48 0.43]
 [0.78 0.8  0.6  0.55 1.   0.69 0.67 0.41]
 [0.78 0.7  0.51 0.49 0.69 1.   0.61 0.51]
 [0.77 0.66 0.54 0.48 0.67 0.61 1.   0.46]
 [0.55 0.55 0.43 0.43 0.41 0.51 0.46 1.  ]]
Inspecting pattern 1 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 1117
[t-SNE] Computed conditional probabilities for sample 1117 / 1117
[t-SNE] Mean sigma: 0.344329
Beginning preprocessing + Leiden
2024-03-11 18:43:22.736551 MEMORY 2.456006656
Affmat transformed
2024-03-11 18:43:22.750568 MEMORY 2.456006656
sources, targets, weights extracted
2024-03-11 18:43:22.758510 MEMORY 2.456006656
About to launch parallel Leiden runs
2024-03-11 18:43:22.783851 MEMORY 2.456006656
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    3.1s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   10.1s finished
Parallel Leiden runs finished
2024-03-11 18:43:32.889971 MEMORY 2.456006656
Quality: 0.4127581098871408
Quality: 0.4147930433261174
Quality: 0.4148963630253491
Quality: 0.41549780604641007
Got subclusters: Counter({0: 203, 1: 198, 2: 190, 3: 167, 4: 130, 5: 116, 6: 97, 7: 16})
On merging iteration 1
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 930 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 1046 out of 1046 | elapsed:    0.3s finished
Numbers for each pattern pre-subsample: [203, 198, 190, 167, 130, 116, 97, 16]
Numbers after subsampling: [203, 198, 190, 167, 130, 116, 97, 16]
Computing sims for pattern 0
Computed sims for pattern 0 in 2.129976987838745 s
Computing sims for pattern 1
Computed sims for pattern 1 in 1.7406198978424072 s
Computing sims for pattern 2
Computed sims for pattern 2 in 1.655968427658081 s
Computing sims for pattern 3
Computed sims for pattern 3 in 1.435243844985962 s
Computing sims for pattern 4
Computed sims for pattern 4 in 1.1887567043304443 s
Computing sims for pattern 5
Computed sims for pattern 5 in 1.0653419494628906 s
Computing sims for pattern 6
Computed sims for pattern 6 in 0.8946452140808105 s
Computing sims for pattern 7
Computed sims for pattern 7 in 0.30677032470703125 s
Cluster sizes
[203 198 190 167 130 116  97  16]
Cross-contamination matrix:
[[1.   0.74 0.5  0.67 0.65 0.52 0.77 0.76]
 [0.47 1.   0.35 0.62 0.43 0.43 0.55 0.8 ]
 [0.71 0.8  1.   0.76 0.75 0.74 0.8  0.97]
 [0.6  0.83 0.49 1.   0.45 0.57 0.61 0.91]
 [0.78 0.8  0.66 0.62 1.   0.66 0.8  0.94]
 [0.61 0.78 0.62 0.73 0.64 1.   0.64 0.83]
 [0.66 0.74 0.5  0.6  0.58 0.47 1.   0.95]
 [0.09 0.21 0.11 0.18 0.13 0.1  0.19 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.8  0.82 0.8  0.84 0.69 0.81 0.66]
 [0.8  1.   0.85 0.83 0.79 0.73 0.83 0.83]
 [0.82 0.85 1.   0.83 0.84 0.79 0.84 0.71]
 [0.8  0.83 0.83 1.   0.7  0.73 0.8  0.69]
 [0.84 0.79 0.84 0.7  1.   0.72 0.83 0.72]
 [0.69 0.73 0.79 0.73 0.72 1.   0.69 0.61]
 [0.81 0.83 0.84 0.8  0.83 0.69 1.   0.76]
 [0.66 0.83 0.71 0.69 0.72 0.61 0.76 1.  ]]
Inspecting pattern 2 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 1046
[t-SNE] Computed conditional probabilities for sample 1046 / 1046
[t-SNE] Mean sigma: 0.352224
Beginning preprocessing + Leiden
2024-03-11 18:43:44.960355 MEMORY 2.456006656
Affmat transformed
2024-03-11 18:43:44.972546 MEMORY 2.456006656
sources, targets, weights extracted
2024-03-11 18:43:44.979563 MEMORY 2.456006656
About to launch parallel Leiden runs
2024-03-11 18:43:45.018039 MEMORY 2.456006656
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    2.8s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    9.4s finished
Parallel Leiden runs finished
2024-03-11 18:43:54.439487 MEMORY 2.456010752
Quality: 0.40286855617055717
Got subclusters: Counter({0: 216, 1: 187, 2: 177, 3: 126, 5: 117, 4: 117, 6: 100, 7: 6})
On merging iteration 1
Numbers for each pattern pre-subsample: [216, 187, 177, 126, 117, 117, 100, 6]
Numbers after subsampling: [216, 187, 177, 126, 117, 117, 100, 6]
Computing sims for pattern 0
Computed sims for pattern 0 in 1.9370439052581787 s
Computing sims for pattern 1
Computed sims for pattern 1 in 2.001952886581421 s
Computing sims for pattern 2
Computed sims for pattern 2 in 1.5118796825408936 s
Computing sims for pattern 3
Computed sims for pattern 3 in 1.1690196990966797 s
Computing sims for pattern 4
Computed sims for pattern 4 in 1.0546245574951172 s
Computing sims for pattern 5
Computed sims for pattern 5 in 1.0481653213500977 s
Computing sims for pattern 6
Computed sims for pattern 6 in 0.8771967887878418 s
Computing sims for pattern 7
Computed sims for pattern 7 in 0.18463706970214844 s
Cluster sizes
[216 187 177 126 117 117 100   6]
Cross-contamination matrix:
[[1.   0.52 0.59 0.6  0.72 0.46 0.59 0.72]
 [0.73 1.   0.7  0.8  0.74 0.63 0.49 1.  ]
 [0.7  0.66 1.   0.65 0.77 0.55 0.54 0.74]
 [0.62 0.59 0.51 1.   0.68 0.47 0.44 0.66]
 [0.69 0.48 0.55 0.61 1.   0.38 0.46 0.6 ]
 [0.78 0.76 0.7  0.78 0.74 1.   0.65 0.72]
 [0.79 0.48 0.57 0.6  0.7  0.52 1.   0.64]
 [0.28 0.32 0.23 0.28 0.28 0.14 0.16 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.76 0.82 0.78 0.83 0.82 0.88 0.64]
 [0.76 1.   0.73 0.79 0.7  0.84 0.73 0.78]
 [0.82 0.73 1.   0.71 0.78 0.78 0.8  0.71]
 [0.78 0.79 0.71 1.   0.79 0.77 0.8  0.67]
 [0.83 0.7  0.78 0.79 1.   0.75 0.85 0.71]
 [0.82 0.84 0.78 0.77 0.75 1.   0.84 0.71]
 [0.88 0.73 0.8  0.8  0.85 0.84 1.   0.7 ]
 [0.64 0.78 0.71 0.67 0.71 0.71 0.7  1.  ]]
Collapsing 0 & 6 with crosscontam 0.5898347876339989 and sim 0.8788902067163605
Trimming eliminated 0 seqlets out of 316
Unmerged patterns remapping: OrderedDict([(1, 1), (2, 2), (3, 3), (4, 4), (5, 5), (7, 6)])
Time spent on merging iteration: 0.5461630821228027
On merging iteration 2
Numbers for each pattern pre-subsample: [316, 187, 177, 126, 117, 117, 6]
Numbers after subsampling: [300, 187, 177, 126, 117, 117, 6]
Computing sims for pattern 0
Computed sims for pattern 0 in 2.0964205265045166 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.2857236862182617 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.27593111991882324 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.21323776245117188 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.20104742050170898 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.5369501113891602 s
Computing sims for pattern 6
Computed sims for pattern 6 in 0.04736971855163574 s
Cluster sizes
[316 187 177 126 117 117   6]
Cross-contamination matrix:
[[1.   0.67 0.73 0.75 0.85 0.63 0.77]
 [0.66 1.   0.7  0.8  0.74 0.63 1.  ]
 [0.69 0.66 1.   0.65 0.77 0.55 0.74]
 [0.56 0.59 0.51 1.   0.68 0.47 0.66]
 [0.61 0.48 0.55 0.61 1.   0.38 0.6 ]
 [0.75 0.76 0.7  0.78 0.74 1.   0.72]
 [0.23 0.32 0.23 0.28 0.28 0.14 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.77 0.8  0.79 0.84 0.85 0.65]
 [0.77 1.   0.73 0.79 0.7  0.84 0.78]
 [0.8  0.73 1.   0.71 0.78 0.78 0.71]
 [0.79 0.79 0.71 1.   0.79 0.77 0.67]
 [0.84 0.7  0.78 0.79 1.   0.75 0.71]
 [0.85 0.84 0.78 0.77 0.75 1.   0.71]
 [0.65 0.78 0.71 0.67 0.71 0.71 1.  ]]
Collapsing 0 & 5 with crosscontam 0.6308927306109526 and sim 0.8507973001933744
Trimming eliminated 0 seqlets out of 433
Unmerged patterns remapping: OrderedDict([(1, 1), (2, 2), (3, 3), (4, 4), (6, 5)])
Time spent on merging iteration: 0.6949853897094727
On merging iteration 3
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 930 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 1017 out of 1017 | elapsed:    0.2s finished
Numbers for each pattern pre-subsample: [433, 187, 177, 126, 117, 6]
Numbers after subsampling: [300, 187, 177, 126, 117, 6]
Computing sims for pattern 0
Computed sims for pattern 0 in 1.7681281566619873 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.2945270538330078 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.2766759395599365 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.2075214385986328 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.19435715675354004 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.04655885696411133 s
Cluster sizes
[433 187 177 126 117   6]
Cross-contamination matrix:
[[1.   0.84 0.87 0.9  0.95 0.9 ]
 [0.65 1.   0.7  0.8  0.74 1.  ]
 [0.65 0.66 1.   0.65 0.77 0.74]
 [0.52 0.59 0.51 1.   0.68 0.66]
 [0.54 0.48 0.55 0.61 1.   0.6 ]
 [0.2  0.32 0.23 0.28 0.28 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.81 0.82 0.8  0.84 0.68]
 [0.81 1.   0.73 0.79 0.7  0.78]
 [0.82 0.73 1.   0.71 0.78 0.71]
 [0.8  0.79 0.71 1.   0.79 0.67]
 [0.84 0.7  0.78 0.79 1.   0.71]
 [0.68 0.78 0.71 0.67 0.71 1.  ]]
Inspecting pattern 3 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 1017
[t-SNE] Computed conditional probabilities for sample 1017 / 1017
[t-SNE] Mean sigma: 0.351383
Beginning preprocessing + Leiden
2024-03-11 18:44:13.285186 MEMORY 2.456018944
Affmat transformed
2024-03-11 18:44:13.296696 MEMORY 2.456018944
sources, targets, weights extracted
2024-03-11 18:44:13.304126 MEMORY 2.456018944
About to launch parallel Leiden runs
2024-03-11 18:44:13.329924 MEMORY 2.456018944
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    2.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    8.2s finished
Parallel Leiden runs finished
2024-03-11 18:44:21.514894 MEMORY 2.456018944
Quality: 0.41923859257905544
Quality: 0.4212852957470827
Quality: 0.4220380214801614
Quality: 0.4228874578441117
Quality: 0.42301536154005753
Got subclusters: Counter({0: 192, 1: 182, 2: 179, 3: 156, 4: 146, 5: 90, 6: 70, 7: 2})
On merging iteration 1
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 930 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 1001 out of 1001 | elapsed:    0.2s finished
Numbers for each pattern pre-subsample: [192, 182, 179, 156, 146, 90, 70, 2]
Numbers after subsampling: [192, 182, 179, 156, 146, 90, 70, 2]
Computing sims for pattern 0
Computed sims for pattern 0 in 1.6486082077026367 s
Computing sims for pattern 1
Computed sims for pattern 1 in 1.5429656505584717 s
Computing sims for pattern 2
Computed sims for pattern 2 in 2.0171749591827393 s
Computing sims for pattern 3
Computed sims for pattern 3 in 1.2565581798553467 s
Computing sims for pattern 4
Computed sims for pattern 4 in 1.1445794105529785 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.9282779693603516 s
Computing sims for pattern 6
Computed sims for pattern 6 in 0.7442164421081543 s
Computing sims for pattern 7
Computed sims for pattern 7 in 0.15542340278625488 s
Cluster sizes
[192 182 179 156 146  90  70   2]
Cross-contamination matrix:
[[1.   0.53 0.46 0.6  0.69 0.59 0.65 0.64]
 [0.74 1.   0.71 0.67 0.75 0.66 0.72 0.72]
 [0.64 0.68 1.   0.32 0.29 0.7  0.5  0.67]
 [0.77 0.61 0.35 1.   0.79 0.51 0.71 0.74]
 [0.74 0.58 0.23 0.67 1.   0.29 0.65 0.7 ]
 [0.73 0.5  0.63 0.49 0.35 1.   0.57 0.47]
 [0.8  0.65 0.48 0.7  0.75 0.6  1.   0.54]
 [0.   0.   0.   0.   0.   0.   0.   1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.74 0.66 0.75 0.79 0.78 0.77 0.47]
 [0.74 1.   0.77 0.69 0.74 0.74 0.77 0.47]
 [0.66 0.77 1.   0.57 0.49 0.82 0.58 0.43]
 [0.75 0.69 0.57 1.   0.84 0.61 0.74 0.56]
 [0.79 0.74 0.49 0.84 1.   0.57 0.8  0.51]
 [0.78 0.74 0.82 0.61 0.57 1.   0.64 0.47]
 [0.77 0.77 0.58 0.74 0.8  0.64 1.   0.44]
 [0.47 0.47 0.43 0.56 0.51 0.47 0.44 1.  ]]
Inspecting pattern 4 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 1001
[t-SNE] Computed conditional probabilities for sample 1001 / 1001
[t-SNE] Mean sigma: 0.346095
Beginning preprocessing + Leiden
2024-03-11 18:44:32.468226 MEMORY 2.456018944
Affmat transformed
2024-03-11 18:44:32.479729 MEMORY 2.456018944
sources, targets, weights extracted
2024-03-11 18:44:32.486626 MEMORY 2.456018944
About to launch parallel Leiden runs
2024-03-11 18:44:32.518824 MEMORY 2.456018944
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    2.6s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    8.2s finished
Parallel Leiden runs finished
2024-03-11 18:44:40.718163 MEMORY 2.456018944
Quality: 0.41706427904369936
Quality: 0.41753915697232036
Quality: 0.41897907421545544
Got subclusters: Counter({0: 225, 1: 183, 2: 141, 3: 119, 4: 110, 5: 96, 6: 58, 7: 52, 8: 17})
On merging iteration 1
Numbers for each pattern pre-subsample: [225, 183, 141, 119, 110, 96, 58, 52, 17]
Numbers after subsampling: [225, 183, 141, 119, 110, 96, 58, 52, 17]
Computing sims for pattern 0
Computed sims for pattern 0 in 2.2783212661743164 s
Computing sims for pattern 1
Computed sims for pattern 1 in 1.7157831192016602 s
Computing sims for pattern 2
Computed sims for pattern 2 in 1.3827831745147705 s
Computing sims for pattern 3
Computed sims for pattern 3 in 1.1390411853790283 s
Computing sims for pattern 4
Computed sims for pattern 4 in 1.3634600639343262 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.9025602340698242 s
Computing sims for pattern 6
Computed sims for pattern 6 in 0.6538724899291992 s
Computing sims for pattern 7
Computed sims for pattern 7 in 0.6287853717803955 s
Computing sims for pattern 8
Computed sims for pattern 8 in 0.2719595432281494 s
Cluster sizes
[225 183 141 119 110  96  58  52  17]
Cross-contamination matrix:
[[1.   0.45 0.87 0.59 0.39 0.31 0.81 0.71 0.56]
 [0.38 1.   0.53 0.27 0.74 0.68 0.74 0.66 0.65]
 [0.58 0.38 1.   0.53 0.63 0.68 0.66 0.59 0.62]
 [0.7  0.53 0.92 1.   0.73 0.71 0.78 0.7  0.85]
 [0.28 0.63 0.72 0.35 1.   0.63 0.78 0.57 0.56]
 [0.2  0.5  0.68 0.37 0.55 1.   0.44 0.58 0.63]
 [0.48 0.51 0.6  0.36 0.62 0.44 1.   0.59 0.32]
 [0.44 0.46 0.58 0.35 0.48 0.56 0.64 1.   0.29]
 [0.19 0.28 0.37 0.26 0.28 0.38 0.19 0.16 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.6  0.78 0.71 0.6  0.53 0.62 0.64 0.58]
 [0.6  1.   0.53 0.53 0.76 0.69 0.79 0.71 0.64]
 [0.78 0.53 1.   0.83 0.73 0.74 0.7  0.73 0.74]
 [0.71 0.53 0.83 1.   0.66 0.65 0.65 0.72 0.72]
 [0.6  0.76 0.73 0.66 1.   0.7  0.85 0.77 0.61]
 [0.53 0.69 0.74 0.65 0.7  1.   0.69 0.69 0.77]
 [0.62 0.79 0.7  0.65 0.85 0.69 1.   0.77 0.6 ]
 [0.64 0.71 0.73 0.72 0.77 0.69 0.77 1.   0.57]
 [0.58 0.64 0.74 0.72 0.61 0.77 0.6  0.57 1.  ]]
Merging on 39 clusters
2024-03-11 18:44:51.255733 MEMORY 2.456018944
On merging iteration 1
Numbers for each pattern pre-subsample: [359, 265, 241, 214, 210, 137, 68, 8, 203, 198, 190, 167, 130, 116, 97, 16, 433, 187, 177, 126, 117, 6, 192, 182, 179, 156, 146, 90, 70, 2, 225, 183, 141, 119, 110, 96, 58, 52, 17]
Numbers after subsampling: [300, 265, 241, 214, 210, 137, 68, 8, 203, 198, 190, 167, 130, 116, 97, 16, 300, 187, 177, 126, 117, 6, 192, 182, 179, 156, 146, 90, 70, 2, 225, 183, 141, 119, 110, 96, 58, 52, 17]
Computing sims for pattern 0
Computed sims for pattern 0 in 13.824119329452515 s
Computing sims for pattern 1
Computed sims for pattern 1 in 11.144845485687256 s
Computing sims for pattern 2
Computed sims for pattern 2 in 9.667501211166382 s
Computing sims for pattern 3
Computed sims for pattern 3 in 11.129098176956177 s
Computing sims for pattern 4
Computed sims for pattern 4 in 10.828536033630371 s
Computing sims for pattern 5
Computed sims for pattern 5 in 6.8884875774383545 s
Computing sims for pattern 6
Computed sims for pattern 6 in 4.382553815841675 s
Computing sims for pattern 7
Computed sims for pattern 7 in 1.0662610530853271 s
Computing sims for pattern 8
Computed sims for pattern 8 in 10.258994817733765 s
Computing sims for pattern 9
Computed sims for pattern 9 in 9.76424241065979 s
Computing sims for pattern 10
Computed sims for pattern 10 in 9.907774209976196 s
Computing sims for pattern 11
Computed sims for pattern 11 in 7.601465940475464 s
Computing sims for pattern 12
Computed sims for pattern 12 in 6.77487850189209 s
Computing sims for pattern 13
Computed sims for pattern 13 in 5.551436424255371 s
Computing sims for pattern 14
Computed sims for pattern 14 in 4.897722959518433 s
Computing sims for pattern 15
Computed sims for pattern 15 in 1.4223370552062988 s
Computing sims for pattern 16
Computed sims for pattern 16 in 13.971957683563232 s
Computing sims for pattern 17
Computed sims for pattern 17 in 9.533486127853394 s
Computing sims for pattern 18
Computed sims for pattern 18 in 8.575215339660645 s
Computing sims for pattern 19
Computed sims for pattern 19 in 6.591685056686401 s
Computing sims for pattern 20
Computed sims for pattern 20 in 5.4846696853637695 s
Computing sims for pattern 21
Computed sims for pattern 21 in 0.937608003616333 s
Computing sims for pattern 22
Computed sims for pattern 22 in 9.6179518699646 s
Computing sims for pattern 23
Computed sims for pattern 23 in 9.245400428771973 s
Computing sims for pattern 24
Computed sims for pattern 24 in 8.580551147460938 s
Computing sims for pattern 25
Computed sims for pattern 25 in 7.441579818725586 s
Computing sims for pattern 26
Computed sims for pattern 26 in 6.475557804107666 s
Computing sims for pattern 27
Computed sims for pattern 27 in 5.5644402503967285 s
Computing sims for pattern 28
Computed sims for pattern 28 in 4.124691486358643 s
Computing sims for pattern 29
Computed sims for pattern 29 in 0.8317928314208984 s
Computing sims for pattern 30
Computed sims for pattern 30 in 11.756124496459961 s
Computing sims for pattern 31
Computed sims for pattern 31 in 9.026420593261719 s
Computing sims for pattern 32
Computed sims for pattern 32 in 7.013484477996826 s
Computing sims for pattern 33
Computed sims for pattern 33 in 6.308048725128174 s
Computing sims for pattern 34
Computed sims for pattern 34 in 5.295907497406006 s
Computing sims for pattern 35
Computed sims for pattern 35 in 5.002627372741699 s
Computing sims for pattern 36
Computed sims for pattern 36 in 3.6232428550720215 s
Computing sims for pattern 37
Computed sims for pattern 37 in 3.161175012588501 s
Computing sims for pattern 38
Computed sims for pattern 38 in 1.4396474361419678 s
Cluster sizes
[359 265 241 214 210 137  68   8 203 198 190 167 130 116  97  16 433 187
 177 126 117   6 192 182 179 156 146  90  70   2 225 183 141 119 110  96
  58  52  17]
Cross-contamination matrix:
[[1.   0.41 0.18 ... 0.2  0.21 0.38]
 [0.79 1.   0.5  ... 0.73 0.82 0.47]
 [0.41 0.47 1.   ... 0.27 0.52 0.1 ]
 ...
 [0.08 0.2  0.05 ... 1.   0.59 0.32]
 [0.1  0.28 0.17 ... 0.64 1.   0.29]
 [0.13 0.06 0.01 ... 0.19 0.16 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.8  0.5  ... 0.34 0.42 0.44]
 [0.8  1.   0.63 ... 0.3  0.57 0.29]
 [0.5  0.63 1.   ... 0.09 0.43 0.02]
 ...
 [0.34 0.3  0.09 ... 1.   0.77 0.6 ]
 [0.42 0.57 0.43 ... 0.77 1.   0.57]
 [0.44 0.29 0.02 ... 0.6  0.57 1.  ]]
Collapsing 13 & 19 with crosscontam 0.7160563296858813 and sim 0.9050621356864882
Collapsing 12 & 33 with crosscontam 0.7681905577888872 and sim 0.8781614014705842
Trimming eliminated 0 seqlets out of 242
Trimming eliminated 0 seqlets out of 249
Unmerged patterns remapping: OrderedDict([(0, 1), (1, 2), (2, 5), (3, 7), (4, 8), (5, 22), (6, 29), (7, 34), (8, 9), (9, 10), (10, 12), (11, 18), (14, 25), (15, 33), (16, 0), (17, 13), (18, 17), (20, 23), (21, 35), (22, 11), (23, 15), (24, 16), (25, 19), (26, 20), (27, 27), (28, 28), (29, 36), (30, 6), (31, 14), (32, 21), (34, 24), (35, 26), (36, 30), (37, 31), (38, 32)])
Time spent on merging iteration: 2.1274616718292236
On merging iteration 2
Numbers for each pattern pre-subsample: [433, 359, 265, 249, 242, 241, 225, 214, 210, 203, 198, 192, 190, 187, 183, 182, 179, 177, 167, 156, 146, 141, 137, 117, 110, 97, 96, 90, 70, 68, 58, 52, 17, 16, 8, 6, 2]
Numbers after subsampling: [300, 300, 265, 249, 242, 241, 225, 214, 210, 203, 198, 192, 190, 187, 183, 182, 179, 177, 167, 156, 146, 141, 137, 117, 110, 97, 96, 90, 70, 68, 58, 52, 17, 16, 8, 6, 2]
Computing sims for pattern 0
Computed sims for pattern 0 in 1.3275065422058105 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.8188929557800293 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.6704897880554199 s
Computing sims for pattern 3
Computed sims for pattern 3 in 9.389029502868652 s
Computing sims for pattern 4
Computed sims for pattern 4 in 9.573357582092285 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.5738193988800049 s
Computing sims for pattern 6
Computed sims for pattern 6 in 0.7141966819763184 s
Computing sims for pattern 7
Computed sims for pattern 7 in 0.6536393165588379 s
Computing sims for pattern 8
Computed sims for pattern 8 in 0.6223127841949463 s
Computing sims for pattern 9
Computed sims for pattern 9 in 0.6154153347015381 s
Computing sims for pattern 10
Computed sims for pattern 10 in 0.5844097137451172 s
Computing sims for pattern 11
Computed sims for pattern 11 in 0.5856099128723145 s
Computing sims for pattern 12
Computed sims for pattern 12 in 0.5718774795532227 s
Computing sims for pattern 13
Computed sims for pattern 13 in 0.5882184505462646 s
Computing sims for pattern 14
Computed sims for pattern 14 in 0.5555696487426758 s
Computing sims for pattern 15
Computed sims for pattern 15 in 0.9669115543365479 s
Computing sims for pattern 16
Computed sims for pattern 16 in 0.5297141075134277 s
Computing sims for pattern 17
Computed sims for pattern 17 in 0.5146827697753906 s
Computing sims for pattern 18
Computed sims for pattern 18 in 0.4996206760406494 s
Computing sims for pattern 19
Computed sims for pattern 19 in 0.4462127685546875 s
Computing sims for pattern 20
Computed sims for pattern 20 in 0.40874218940734863 s
Computing sims for pattern 21
Computed sims for pattern 21 in 0.46071362495422363 s
Computing sims for pattern 22
Computed sims for pattern 22 in 0.46162843704223633 s
Computing sims for pattern 23
Computed sims for pattern 23 in 0.38630080223083496 s
Computing sims for pattern 24
Computed sims for pattern 24 in 0.35010528564453125 s
Computing sims for pattern 25
Computed sims for pattern 25 in 0.30446910858154297 s
Computing sims for pattern 26
Computed sims for pattern 26 in 0.3018817901611328 s
Computing sims for pattern 27
Computed sims for pattern 27 in 0.335512638092041 s
Computing sims for pattern 28
Computed sims for pattern 28 in 0.2663414478302002 s
Computing sims for pattern 29
Computed sims for pattern 29 in 0.2530040740966797 s
Computing sims for pattern 30
Computed sims for pattern 30 in 0.22943878173828125 s
Computing sims for pattern 31
Computed sims for pattern 31 in 0.21262860298156738 s
Computing sims for pattern 32
Computed sims for pattern 32 in 0.10454869270324707 s
Computing sims for pattern 33
Computed sims for pattern 33 in 0.10266900062561035 s
Computing sims for pattern 34
Computed sims for pattern 34 in 0.08087682723999023 s
Computing sims for pattern 35
Computed sims for pattern 35 in 0.07684659957885742 s
Computing sims for pattern 36
Computed sims for pattern 36 in 0.06640052795410156 s
Cluster sizes
[433 359 265 249 242 241 225 214 210 203 198 192 190 187 183 182 179 177
 167 156 146 141 137 117 110  97  96  90  70  68  58  52  17  16   8   6
   2]
Cross-contamination matrix:
[[1.   0.28 0.4  ... 0.2  0.9  0.35]
 [0.12 1.   0.41 ... 0.3  0.05 0.18]
 [0.46 0.79 1.   ... 0.61 0.52 0.37]
 ...
 [0.01 0.14 0.13 ... 1.   0.04 0.  ]
 [0.2  0.01 0.08 ... 0.05 1.   0.2 ]
 [0.   0.   0.   ... 0.   0.   1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.31 0.34 ... 0.14 0.68 0.24]
 [0.31 1.   0.8  ... 0.55 0.26 0.23]
 [0.34 0.8  1.   ... 0.55 0.38 0.29]
 ...
 [0.14 0.55 0.55 ... 1.   0.25 0.34]
 [0.68 0.26 0.38 ... 0.25 1.   0.41]
 [0.24 0.23 0.29 ... 0.34 0.41 1.  ]]
Collapsing 3 & 12 with crosscontam 0.763398097419566 and sim 0.8706006703177286
Collapsing 3 & 9 with crosscontam 0.6115323985917533 and sim 0.8672113001733536
Trimming eliminated 0 seqlets out of 439
Removed 1 duplicate seqlets
Trimming eliminated 0 seqlets out of 641
Unmerged patterns remapping: OrderedDict([(0, 1), (1, 2), (2, 3), (4, 4), (5, 5), (6, 6), (7, 7), (8, 8), (10, 9), (11, 10), (13, 11), (14, 12), (15, 13), (16, 14), (17, 15), (18, 16), (19, 17), (20, 18), (21, 19), (22, 20), (23, 21), (24, 22), (25, 23), (26, 24), (27, 25), (28, 26), (29, 27), (30, 28), (31, 29), (32, 30), (33, 31), (34, 32), (35, 33), (36, 34)])
Time spent on merging iteration: 2.118953227996826
On merging iteration 3
Numbers for each pattern pre-subsample: [641, 433, 359, 265, 242, 241, 225, 214, 210, 198, 192, 187, 183, 182, 179, 177, 167, 156, 146, 141, 137, 117, 110, 97, 96, 90, 70, 68, 58, 52, 17, 16, 8, 6, 2]
Numbers after subsampling: [300, 300, 300, 265, 242, 241, 225, 214, 210, 198, 192, 187, 183, 182, 179, 177, 167, 156, 146, 141, 137, 117, 110, 97, 96, 90, 70, 68, 58, 52, 17, 16, 8, 6, 2]
Computing sims for pattern 0
Computed sims for pattern 0 in 12.743985891342163 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.43111515045166016 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.4299745559692383 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.3599586486816406 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.30840206146240234 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.2986445426940918 s
Computing sims for pattern 6
Computed sims for pattern 6 in 0.3661832809448242 s
Computing sims for pattern 7
Computed sims for pattern 7 in 0.33968257904052734 s
Computing sims for pattern 8
Computed sims for pattern 8 in 0.3380899429321289 s
Computing sims for pattern 9
Computed sims for pattern 9 in 0.31076478958129883 s
Computing sims for pattern 10
Computed sims for pattern 10 in 0.30847620964050293 s
Computing sims for pattern 11
Computed sims for pattern 11 in 0.2939727306365967 s
Computing sims for pattern 12
Computed sims for pattern 12 in 0.28221845626831055 s
Computing sims for pattern 13
Computed sims for pattern 13 in 0.28072142601013184 s
Computing sims for pattern 14
Computed sims for pattern 14 in 0.2769191265106201 s
Computing sims for pattern 15
Computed sims for pattern 15 in 0.270862340927124 s
Computing sims for pattern 16
Computed sims for pattern 16 in 0.25220799446105957 s
Computing sims for pattern 17
Computed sims for pattern 17 in 0.23128008842468262 s
Computing sims for pattern 18
Computed sims for pattern 18 in 0.2165234088897705 s
Computing sims for pattern 19
Computed sims for pattern 19 in 0.2310028076171875 s
Computing sims for pattern 20
Computed sims for pattern 20 in 0.22361254692077637 s
Computing sims for pattern 21
Computed sims for pattern 21 in 0.19457030296325684 s
Computing sims for pattern 22
Computed sims for pattern 22 in 0.17456841468811035 s
Computing sims for pattern 23
Computed sims for pattern 23 in 0.15572261810302734 s
Computing sims for pattern 24
Computed sims for pattern 24 in 0.15612173080444336 s
Computing sims for pattern 25
Computed sims for pattern 25 in 0.1774120330810547 s
Computing sims for pattern 26
Computed sims for pattern 26 in 0.1421363353729248 s
Computing sims for pattern 27
Computed sims for pattern 27 in 0.14083528518676758 s
Computing sims for pattern 28
Computed sims for pattern 28 in 0.12682104110717773 s
Computing sims for pattern 29
Computed sims for pattern 29 in 0.11160516738891602 s
Computing sims for pattern 30
Computed sims for pattern 30 in 0.4413332939147949 s
Computing sims for pattern 31
Computed sims for pattern 31 in 0.056915998458862305 s
Computing sims for pattern 32
Computed sims for pattern 32 in 0.04806232452392578 s
Computing sims for pattern 33
Computed sims for pattern 33 in 0.0446774959564209 s
Computing sims for pattern 34
Computed sims for pattern 34 in 0.04119586944580078 s
Cluster sizes
[641 433 359 265 242 241 225 214 210 198 192 187 183 182 179 177 167 156
 146 141 137 117 110  97  96  90  70  68  58  52  17  16   8   6   2]
Cross-contamination matrix:
[[1.   0.48 0.71 ... 0.1  0.42 0.47]
 [0.47 1.   0.28 ... 0.2  0.9  0.35]
 [0.39 0.12 1.   ... 0.3  0.05 0.18]
 ...
 [0.03 0.01 0.14 ... 1.   0.04 0.  ]
 [0.03 0.2  0.01 ... 0.05 1.   0.2 ]
 [0.   0.   0.   ... 0.   0.   1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.54 0.48 ... 0.12 0.41 0.27]
 [0.54 1.   0.31 ... 0.14 0.68 0.24]
 [0.48 0.31 1.   ... 0.55 0.26 0.23]
 ...
 [0.12 0.14 0.55 ... 1.   0.25 0.34]
 [0.41 0.68 0.26 ... 0.25 1.   0.41]
 [0.27 0.24 0.23 ... 0.34 0.41 1.  ]]
Collapsing 0 & 23 with crosscontam 0.5323422518251335 and sim 0.8579268438517176
Skipped 1 due to duplicates
Trimming eliminated 0 seqlets out of 737
Unmerged patterns remapping: OrderedDict([(1, 1), (2, 2), (3, 3), (4, 4), (5, 5), (6, 6), (7, 7), (8, 8), (9, 9), (10, 10), (11, 11), (12, 12), (13, 13), (14, 14), (15, 15), (16, 16), (17, 17), (18, 18), (19, 19), (20, 20), (21, 21), (22, 22), (24, 23), (25, 24), (26, 25), (27, 26), (28, 27), (29, 28), (30, 29), (31, 30), (32, 31), (33, 32), (34, 33)])
Time spent on merging iteration: 0.9284803867340088
On merging iteration 4
Numbers for each pattern pre-subsample: [737, 433, 359, 265, 242, 241, 225, 214, 210, 198, 192, 187, 183, 182, 179, 177, 167, 156, 146, 141, 137, 117, 110, 96, 90, 70, 68, 58, 52, 17, 16, 8, 6, 2]
Numbers after subsampling: [300, 300, 300, 265, 242, 241, 225, 214, 210, 198, 192, 187, 183, 182, 179, 177, 167, 156, 146, 141, 137, 117, 110, 96, 90, 70, 68, 58, 52, 17, 16, 8, 6, 2]
Computing sims for pattern 0
Computed sims for pattern 0 in 12.213181734085083 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.43277549743652344 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.4294455051422119 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.35707521438598633 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.30813050270080566 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.3088521957397461 s
Computing sims for pattern 6
Computed sims for pattern 6 in 0.3802604675292969 s
Computing sims for pattern 7
Computed sims for pattern 7 in 0.3521409034729004 s
Computing sims for pattern 8
Computed sims for pattern 8 in 0.33919453620910645 s
Computing sims for pattern 9
Computed sims for pattern 9 in 0.3186326026916504 s
Computing sims for pattern 10
Computed sims for pattern 10 in 0.3188669681549072 s
Computing sims for pattern 11
Computed sims for pattern 11 in 0.3072013854980469 s
Computing sims for pattern 12
Computed sims for pattern 12 in 0.3028290271759033 s
Computing sims for pattern 13
Computed sims for pattern 13 in 0.30498695373535156 s
Computing sims for pattern 14
Computed sims for pattern 14 in 0.28502941131591797 s
Computing sims for pattern 15
Computed sims for pattern 15 in 0.29219508171081543 s
Computing sims for pattern 16
Computed sims for pattern 16 in 0.26538991928100586 s
Computing sims for pattern 17
Computed sims for pattern 17 in 0.24894404411315918 s
Computing sims for pattern 18
Computed sims for pattern 18 in 0.22816038131713867 s
Computing sims for pattern 19
Computed sims for pattern 19 in 0.23758721351623535 s
Computing sims for pattern 20
Computed sims for pattern 20 in 0.21870183944702148 s
Computing sims for pattern 21
Computed sims for pattern 21 in 0.20003819465637207 s
Computing sims for pattern 22
Computed sims for pattern 22 in 0.19408774375915527 s
Computing sims for pattern 23
Computed sims for pattern 23 in 0.16048431396484375 s
Computing sims for pattern 24
Computed sims for pattern 24 in 0.17197585105895996 s
Computing sims for pattern 25
Computed sims for pattern 25 in 0.14260458946228027 s
Computing sims for pattern 26
Computed sims for pattern 26 in 0.13463783264160156 s
Computing sims for pattern 27
Computed sims for pattern 27 in 0.12328600883483887 s
Computing sims for pattern 28
Computed sims for pattern 28 in 0.43723154067993164 s
Computing sims for pattern 29
Computed sims for pattern 29 in 0.0603938102722168 s
Computing sims for pattern 30
Computed sims for pattern 30 in 0.05965900421142578 s
Computing sims for pattern 31
Computed sims for pattern 31 in 0.04798626899719238 s
Computing sims for pattern 32
Computed sims for pattern 32 in 0.04494285583496094 s
Computing sims for pattern 33
Computed sims for pattern 33 in 0.04059123992919922 s
Cluster sizes
[737 433 359 265 242 241 225 214 210 198 192 187 183 182 179 177 167 156
 146 141 137 117 110  96  90  70  68  58  52  17  16   8   6   2]
Cross-contamination matrix:
[[1.   0.49 0.73 ... 0.24 0.44 0.5 ]
 [0.46 1.   0.28 ... 0.2  0.9  0.35]
 [0.4  0.12 1.   ... 0.3  0.05 0.18]
 ...
 [0.04 0.01 0.14 ... 1.   0.04 0.  ]
 [0.03 0.2  0.01 ... 0.05 1.   0.2 ]
 [0.   0.   0.   ... 0.   0.   1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.54 0.48 ... 0.11 0.41 0.27]
 [0.54 1.   0.31 ... 0.14 0.68 0.24]
 [0.48 0.31 1.   ... 0.55 0.26 0.23]
 ...
 [0.11 0.14 0.55 ... 1.   0.25 0.34]
 [0.41 0.68 0.26 ... 0.25 1.   0.41]
 [0.27 0.24 0.23 ... 0.34 0.41 1.  ]]
Got 34 patterns after merging
2024-03-11 18:50:46.747026 MEMORY 2.460291072
Performing filtering
2024-03-11 18:50:46.747213 MEMORY 2.460291072
Got 29 patterns after filtering
2024-03-11 18:50:47.497476 MEMORY 2.460291072
Total time taken is 1029.46s
2024-03-11 18:50:47.497624 MEMORY 2.460291072
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 737 out of 737 | elapsed:    0.3s finished
/ru-auth/local/home/lzhao/anaconda3/envs/jupyter-ml-clone/lib/python3.9/site-packages/sklearn/manifold/_t_sne.py:691: FutureWarning: 'square_distances' has been introduced in 0.24 to help phase out legacy squaring behavior. The 'legacy' setting will be removed in 1.1 (renaming of 0.26), and the default setting will be changed to True. In 1.3, 'square_distances' will be removed altogether, and distances will be squared by default. Set 'square_distances'=True to silence this warning.
  warnings.warn(
/ru-auth/local/home/lzhao/anaconda3/envs/jupyter-ml-clone/lib/python3.9/site-packages/sklearn/neighbors/_base.py:175: EfficiencyWarning: Precomputed sparse input was not sorted by data.
  warnings.warn('Precomputed sparse input was not sorted by data.',
Applying subclustering to the final motifs
On pattern 0
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 737 samples in 0.005s...
[t-SNE] Computed neighbors for 737 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 737 / 737
[t-SNE] Mean sigma: 0.366146
[t-SNE] Computed conditional probabilities in 0.049s
[t-SNE] Iteration 50: error = 65.8711395, gradient norm = 0.4116737 (50 iterations in 0.105s)
[t-SNE] Iteration 100: error = 68.5657959, gradient norm = 0.3610316 (50 iterations in 0.111s)
[t-SNE] Iteration 150: error = 69.5175323, gradient norm = 0.3680377 (50 iterations in 0.112s)
[t-SNE] Iteration 200: error = 69.4638367, gradient norm = 0.3668920 (50 iterations in 0.066s)
[t-SNE] Iteration 250: error = 68.7953339, gradient norm = 0.3773228 (50 iterations in 0.067s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 68.795334
[t-SNE] Iteration 300: error = 1.7360938, gradient norm = 0.0033495 (50 iterations in 0.063s)
[t-SNE] Iteration 350: error = 1.6669246, gradient norm = 0.0007229 (50 iterations in 0.062s)
[t-SNE] Iteration 400: error = 1.6481732, gradient norm = 0.0003719 (50 iterations in 0.062s)
[t-SNE] Iteration 450: error = 1.6345826, gradient norm = 0.0004038 (50 iterations in 0.062s)
[t-SNE] Iteration 500: error = 1.6255766, gradient norm = 0.0002242 (50 iterations in 0.066s)
[t-SNE] Iteration 550: error = 1.6216195, gradient norm = 0.0001502 (50 iterations in 0.062s)
[t-SNE] Iteration 600: error = 1.6195991, gradient norm = 0.0001357 (50 iterations in 0.064s)
[t-SNE] Iteration 650: error = 1.6172105, gradient norm = 0.0001404 (50 iterations in 0.062s)
[t-SNE] Iteration 700: error = 1.6155055, gradient norm = 0.0001739 (50 iterations in 0.060s)
[t-SNE] Iteration 750: error = 1.6124882, gradient norm = 0.0000847 (50 iterations in 0.065s)
[t-SNE] Iteration 800: error = 1.6112076, gradient norm = 0.0000895 (50 iterations in 0.067s)
[t-SNE] Iteration 850: error = 1.6101935, gradient norm = 0.0001185 (50 iterations in 0.063s)
[t-SNE] Iteration 900: error = 1.6084901, gradient norm = 0.0000911 (50 iterations in 0.060s)
[t-SNE] Iteration 950: error = 1.6076691, gradient norm = 0.0001218 (50 iterations in 0.059s)
[t-SNE] Iteration 1000: error = 1.6073629, gradient norm = 0.0000598 (50 iterations in 0.059s)
[t-SNE] KL divergence after 1000 iterations: 1.607363
[t-SNE] Computed conditional probabilities for sample 737 / 737
[t-SNE] Mean sigma: 0.366146
Beginning preprocessing + Leiden
2024-03-11 18:50:50.028337 MEMORY 2.461495296
Affmat transformed
2024-03-11 18:50:50.036805 MEMORY 2.461495296
sources, targets, weights extracted
2024-03-11 18:50:50.041487 MEMORY 2.461495296
About to launch parallel Leiden runs
2024-03-11 18:50:50.091323 MEMORY 2.461495296
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.8s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    5.8s finished
Parallel Leiden runs finished
2024-03-11 18:50:55.847786 MEMORY 2.461495296
Quality: 0.4019493840808473
Quality: 0.4043655431178575
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 344 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 433 out of 433 | elapsed:    0.2s finished
Got subclusters: Counter({0: 151, 1: 138, 2: 124, 3: 116, 4: 61, 5: 57, 6: 52, 7: 38})
On pattern 1
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 433 samples in 0.003s...
[t-SNE] Computed neighbors for 433 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 433 / 433
[t-SNE] Mean sigma: 0.383616
[t-SNE] Computed conditional probabilities in 0.029s
[t-SNE] Iteration 50: error = 64.5732727, gradient norm = 0.5035056 (50 iterations in 0.046s)
[t-SNE] Iteration 100: error = 68.7470169, gradient norm = 0.4576191 (50 iterations in 0.043s)
[t-SNE] Iteration 150: error = 70.0505905, gradient norm = 0.4429442 (50 iterations in 0.044s)
[t-SNE] Iteration 200: error = 70.4644470, gradient norm = 0.4396972 (50 iterations in 0.045s)
[t-SNE] Iteration 250: error = 68.9152679, gradient norm = 0.4481919 (50 iterations in 0.045s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 68.915268
[t-SNE] Iteration 300: error = 1.4155912, gradient norm = 0.0034356 (50 iterations in 0.079s)
[t-SNE] Iteration 350: error = 1.3562667, gradient norm = 0.0019700 (50 iterations in 0.048s)
[t-SNE] Iteration 400: error = 1.3002824, gradient norm = 0.0011672 (50 iterations in 0.070s)
[t-SNE] Iteration 450: error = 1.2655859, gradient norm = 0.0007189 (50 iterations in 0.047s)
[t-SNE] Iteration 500: error = 1.2509840, gradient norm = 0.0008225 (50 iterations in 0.054s)
[t-SNE] Iteration 550: error = 1.2414703, gradient norm = 0.0011285 (50 iterations in 0.045s)
[t-SNE] Iteration 600: error = 1.2379192, gradient norm = 0.0002050 (50 iterations in 0.042s)
[t-SNE] Iteration 650: error = 1.2365420, gradient norm = 0.0001484 (50 iterations in 0.044s)
[t-SNE] Iteration 700: error = 1.2358521, gradient norm = 0.0002829 (50 iterations in 0.043s)
[t-SNE] Iteration 750: error = 1.2358694, gradient norm = 0.0000830 (50 iterations in 0.045s)
[t-SNE] Iteration 800: error = 1.2359074, gradient norm = 0.0000955 (50 iterations in 0.045s)
[t-SNE] Iteration 850: error = 1.2358762, gradient norm = 0.0000697 (50 iterations in 0.046s)
[t-SNE] Iteration 900: error = 1.2358750, gradient norm = 0.0000836 (50 iterations in 0.042s)
[t-SNE] Iteration 950: error = 1.2358527, gradient norm = 0.0000432 (50 iterations in 0.043s)
[t-SNE] Iteration 1000: error = 1.2359265, gradient norm = 0.0000220 (50 iterations in 0.043s)
[t-SNE] KL divergence after 1000 iterations: 1.235927
[t-SNE] Computed conditional probabilities for sample 433 / 433
[t-SNE] Mean sigma: 0.383616
Beginning preprocessing + Leiden
2024-03-11 18:50:57.603600 MEMORY 2.46151168
Affmat transformed
2024-03-11 18:50:57.609155 MEMORY 2.46151168
sources, targets, weights extracted
2024-03-11 18:50:57.611966 MEMORY 2.46151168
About to launch parallel Leiden runs
2024-03-11 18:50:57.660117 MEMORY 2.46151168
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.2s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    3.3s finished
Parallel Leiden runs finished
2024-03-11 18:51:00.987523 MEMORY 2.46151168
Quality: 0.3517955006222546
Quality: 0.3518026212468948
Quality: 0.3519488035963327
Quality: 0.3521174499940564
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 312 out of 359 | elapsed:    0.1s remaining:    0.0s
[Parallel(n_jobs=24)]: Done 359 out of 359 | elapsed:    0.1s finished
Got subclusters: Counter({0: 91, 1: 79, 2: 66, 3: 62, 4: 44, 5: 36, 6: 27, 7: 26, 8: 2})
On pattern 2
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 359 samples in 0.003s...
[t-SNE] Computed neighbors for 359 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 359 / 359
[t-SNE] Mean sigma: 0.364405
[t-SNE] Computed conditional probabilities in 0.024s
[t-SNE] Iteration 50: error = 66.4659195, gradient norm = 0.4968668 (50 iterations in 0.050s)
[t-SNE] Iteration 100: error = 71.1350250, gradient norm = 0.4535394 (50 iterations in 0.045s)
[t-SNE] Iteration 150: error = 71.6847076, gradient norm = 0.4746370 (50 iterations in 0.045s)
[t-SNE] Iteration 200: error = 70.5323944, gradient norm = 0.4586723 (50 iterations in 0.044s)
[t-SNE] Iteration 250: error = 73.6807938, gradient norm = 0.4315104 (50 iterations in 0.045s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 73.680794
[t-SNE] Iteration 300: error = 1.4515808, gradient norm = 0.0055388 (50 iterations in 0.044s)
[t-SNE] Iteration 350: error = 1.2562928, gradient norm = 0.0030732 (50 iterations in 0.039s)
[t-SNE] Iteration 400: error = 1.1726199, gradient norm = 0.0028202 (50 iterations in 0.040s)
[t-SNE] Iteration 450: error = 1.1444547, gradient norm = 0.0007208 (50 iterations in 0.040s)
[t-SNE] Iteration 500: error = 1.1386640, gradient norm = 0.0004894 (50 iterations in 0.042s)
[t-SNE] Iteration 550: error = 1.1314496, gradient norm = 0.0004294 (50 iterations in 0.041s)
[t-SNE] Iteration 600: error = 1.1308769, gradient norm = 0.0000996 (50 iterations in 0.040s)
[t-SNE] Iteration 650: error = 1.1309725, gradient norm = 0.0000836 (50 iterations in 0.037s)
[t-SNE] Iteration 700: error = 1.1304153, gradient norm = 0.0000887 (50 iterations in 0.040s)
[t-SNE] Iteration 750: error = 1.1306033, gradient norm = 0.0000593 (50 iterations in 0.040s)
[t-SNE] Iteration 800: error = 1.1306070, gradient norm = 0.0000749 (50 iterations in 0.039s)
[t-SNE] Iteration 850: error = 1.1306117, gradient norm = 0.0000610 (50 iterations in 0.040s)
[t-SNE] Iteration 900: error = 1.1308079, gradient norm = 0.0000691 (50 iterations in 0.039s)
[t-SNE] Iteration 950: error = 1.1307032, gradient norm = 0.0000711 (50 iterations in 0.040s)
[t-SNE] Iteration 1000: error = 1.1308435, gradient norm = 0.0000605 (50 iterations in 0.042s)
[t-SNE] KL divergence after 1000 iterations: 1.130844
[t-SNE] Computed conditional probabilities for sample 359 / 359
[t-SNE] Mean sigma: 0.364405
Beginning preprocessing + Leiden
2024-03-11 18:51:02.393182 MEMORY 2.46151168
Affmat transformed
2024-03-11 18:51:02.398817 MEMORY 2.46151168
sources, targets, weights extracted
2024-03-11 18:51:02.401223 MEMORY 2.46151168
About to launch parallel Leiden runs
2024-03-11 18:51:02.419841 MEMORY 2.46151168
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.1s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    3.2s finished
Parallel Leiden runs finished
2024-03-11 18:51:05.648028 MEMORY 2.46151168
Quality: 0.32838262074137714
Quality: 0.3293136200700869
Quality: 0.3301258763838935
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 265 out of 265 | elapsed:    0.1s finished
Got subclusters: Counter({0: 72, 1: 69, 2: 64, 3: 56, 4: 50, 5: 48})
On pattern 3
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 265 samples in 0.002s...
[t-SNE] Computed neighbors for 265 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 265 / 265
[t-SNE] Mean sigma: 0.440256
[t-SNE] Computed conditional probabilities in 0.018s
[t-SNE] Iteration 50: error = 59.9633751, gradient norm = 0.5324921 (50 iterations in 0.085s)
[t-SNE] Iteration 100: error = 59.7746887, gradient norm = 0.5335187 (50 iterations in 0.031s)
[t-SNE] Iteration 150: error = 59.7894058, gradient norm = 0.5056373 (50 iterations in 0.031s)
[t-SNE] Iteration 200: error = 62.3314323, gradient norm = 0.5229583 (50 iterations in 0.032s)
[t-SNE] Iteration 250: error = 60.4001923, gradient norm = 0.5017163 (50 iterations in 0.034s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 60.400192
[t-SNE] Iteration 300: error = 1.1324450, gradient norm = 0.0037302 (50 iterations in 0.035s)
[t-SNE] Iteration 350: error = 1.0811692, gradient norm = 0.0016892 (50 iterations in 0.033s)
[t-SNE] Iteration 400: error = 1.0608848, gradient norm = 0.0009109 (50 iterations in 0.032s)
[t-SNE] Iteration 450: error = 1.0552397, gradient norm = 0.0003228 (50 iterations in 0.031s)
[t-SNE] Iteration 500: error = 1.0545157, gradient norm = 0.0001867 (50 iterations in 0.030s)
[t-SNE] Iteration 550: error = 1.0543234, gradient norm = 0.0001414 (50 iterations in 0.030s)
[t-SNE] Iteration 600: error = 1.0541122, gradient norm = 0.0001593 (50 iterations in 0.032s)
[t-SNE] Iteration 650: error = 1.0543611, gradient norm = 0.0001518 (50 iterations in 0.030s)
[t-SNE] Iteration 700: error = 1.0542619, gradient norm = 0.0001272 (50 iterations in 0.031s)
[t-SNE] Iteration 750: error = 1.0544246, gradient norm = 0.0001162 (50 iterations in 0.031s)
[t-SNE] Iteration 800: error = 1.0544047, gradient norm = 0.0001266 (50 iterations in 0.031s)
[t-SNE] Iteration 850: error = 1.0542152, gradient norm = 0.0001440 (50 iterations in 0.031s)
[t-SNE] Iteration 900: error = 1.0541933, gradient norm = 0.0001555 (50 iterations in 0.032s)
[t-SNE] Iteration 950: error = 1.0542650, gradient norm = 0.0001396 (50 iterations in 0.032s)
[t-SNE] Iteration 950: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 950 iterations: 1.054265
[t-SNE] Computed conditional probabilities for sample 265 / 265
[t-SNE] Mean sigma: 0.440256
Beginning preprocessing + Leiden
2024-03-11 18:51:06.718150 MEMORY 2.46151168
Affmat transformed
2024-03-11 18:51:06.721641 MEMORY 2.46151168
sources, targets, weights extracted
2024-03-11 18:51:06.723148 MEMORY 2.46151168
About to launch parallel Leiden runs
2024-03-11 18:51:06.741757 MEMORY 2.46151168
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.9s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.4s finished
Parallel Leiden runs finished
2024-03-11 18:51:09.179096 MEMORY 2.46151168
Quality: 0.3253778595896854
Quality: 0.327867176432123
Quality: 0.3283047269392822
Quality: 0.3284319038207001
Quality: 0.32849532887573707
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 242 out of 242 | elapsed:    0.1s finished
Got subclusters: Counter({0: 69, 1: 55, 2: 34, 3: 33, 4: 30, 5: 28, 6: 11, 7: 5})
On pattern 4
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 242 samples in 0.002s...
[t-SNE] Computed neighbors for 242 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 242 / 242
[t-SNE] Mean sigma: 0.402105
[t-SNE] Computed conditional probabilities in 0.016s
[t-SNE] Iteration 50: error = 64.3031540, gradient norm = 0.5075520 (50 iterations in 0.031s)
[t-SNE] Iteration 100: error = 59.5618629, gradient norm = 0.5121689 (50 iterations in 0.030s)
[t-SNE] Iteration 150: error = 60.4760666, gradient norm = 0.5079129 (50 iterations in 0.032s)
[t-SNE] Iteration 200: error = 64.4610062, gradient norm = 0.4660710 (50 iterations in 0.030s)
[t-SNE] Iteration 250: error = 61.0452003, gradient norm = 0.5016201 (50 iterations in 0.030s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 61.045200
[t-SNE] Iteration 300: error = 1.1471775, gradient norm = 0.0047058 (50 iterations in 0.029s)
[t-SNE] Iteration 350: error = 1.0312647, gradient norm = 0.0021021 (50 iterations in 0.029s)
[t-SNE] Iteration 400: error = 1.0045916, gradient norm = 0.0015740 (50 iterations in 0.030s)
[t-SNE] Iteration 450: error = 1.0008961, gradient norm = 0.0003535 (50 iterations in 0.030s)
[t-SNE] Iteration 500: error = 0.9988887, gradient norm = 0.0009082 (50 iterations in 0.028s)
[t-SNE] Iteration 550: error = 0.9905788, gradient norm = 0.0014416 (50 iterations in 0.028s)
[t-SNE] Iteration 600: error = 0.9885524, gradient norm = 0.0002245 (50 iterations in 0.029s)
[t-SNE] Iteration 650: error = 0.9722241, gradient norm = 0.0010998 (50 iterations in 0.028s)
[t-SNE] Iteration 700: error = 0.9510533, gradient norm = 0.0016671 (50 iterations in 0.028s)
[t-SNE] Iteration 750: error = 0.9495643, gradient norm = 0.0003563 (50 iterations in 0.028s)
[t-SNE] Iteration 800: error = 0.9495556, gradient norm = 0.0000848 (50 iterations in 0.032s)
[t-SNE] Iteration 850: error = 0.9496614, gradient norm = 0.0000955 (50 iterations in 0.029s)
[t-SNE] Iteration 900: error = 0.9492754, gradient norm = 0.0001185 (50 iterations in 0.030s)
[t-SNE] Iteration 950: error = 0.9492611, gradient norm = 0.0000870 (50 iterations in 0.029s)
[t-SNE] Iteration 1000: error = 0.9492227, gradient norm = 0.0000800 (50 iterations in 0.029s)
[t-SNE] KL divergence after 1000 iterations: 0.949223
[t-SNE] Computed conditional probabilities for sample 242 / 242
[t-SNE] Mean sigma: 0.402105
Beginning preprocessing + Leiden
2024-03-11 18:51:10.137405 MEMORY 2.46151168
Affmat transformed
2024-03-11 18:51:10.140483 MEMORY 2.46151168
sources, targets, weights extracted
2024-03-11 18:51:10.141766 MEMORY 2.46151168
About to launch parallel Leiden runs
2024-03-11 18:51:10.266942 MEMORY 2.46151168
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.8s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.4s finished
Parallel Leiden runs finished
2024-03-11 18:51:12.690523 MEMORY 2.46151168
Quality: 0.29333675173264084
Quality: 0.29336676580933513
Quality: 0.2941584458757709
Quality: 0.29443351030202825
Quality: 0.2945267951716653
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 241 out of 241 | elapsed:    0.1s finished
Got subclusters: Counter({1: 43, 0: 43, 2: 38, 3: 36, 4: 32, 5: 30, 6: 20})
On pattern 5
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 241 samples in 0.002s...
[t-SNE] Computed neighbors for 241 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 241 / 241
[t-SNE] Mean sigma: 0.440945
[t-SNE] Computed conditional probabilities in 0.016s
[t-SNE] Iteration 50: error = 62.3408928, gradient norm = 0.4963115 (50 iterations in 0.031s)
[t-SNE] Iteration 100: error = 60.6166725, gradient norm = 0.5217722 (50 iterations in 0.031s)
[t-SNE] Iteration 150: error = 62.9693260, gradient norm = 0.4993993 (50 iterations in 0.030s)
[t-SNE] Iteration 200: error = 62.0581703, gradient norm = 0.5143671 (50 iterations in 0.029s)
[t-SNE] Iteration 250: error = 63.4845619, gradient norm = 0.4993643 (50 iterations in 0.030s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 63.484562
[t-SNE] Iteration 300: error = 1.1417660, gradient norm = 0.0062504 (50 iterations in 0.029s)
[t-SNE] Iteration 350: error = 0.9171890, gradient norm = 0.0063244 (50 iterations in 0.030s)
[t-SNE] Iteration 400: error = 0.8742226, gradient norm = 0.0009966 (50 iterations in 0.028s)
[t-SNE] Iteration 450: error = 0.8639582, gradient norm = 0.0006698 (50 iterations in 0.029s)
[t-SNE] Iteration 500: error = 0.8637654, gradient norm = 0.0001061 (50 iterations in 0.029s)
[t-SNE] Iteration 550: error = 0.8637223, gradient norm = 0.0000889 (50 iterations in 0.029s)
[t-SNE] Iteration 600: error = 0.8634194, gradient norm = 0.0002836 (50 iterations in 0.030s)
[t-SNE] Iteration 650: error = 0.8636982, gradient norm = 0.0001503 (50 iterations in 0.028s)
[t-SNE] Iteration 700: error = 0.8637413, gradient norm = 0.0001120 (50 iterations in 0.028s)
[t-SNE] Iteration 750: error = 0.8638323, gradient norm = 0.0001332 (50 iterations in 0.028s)
[t-SNE] Iteration 800: error = 0.8637161, gradient norm = 0.0001096 (50 iterations in 0.030s)
[t-SNE] Iteration 850: error = 0.8635640, gradient norm = 0.0001221 (50 iterations in 0.028s)
[t-SNE] Iteration 900: error = 0.8636839, gradient norm = 0.0000838 (50 iterations in 0.029s)
[t-SNE] Iteration 950: error = 0.8636710, gradient norm = 0.0000830 (50 iterations in 0.029s)
[t-SNE] Iteration 950: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 950 iterations: 0.863671
[t-SNE] Computed conditional probabilities for sample 241 / 241
[t-SNE] Mean sigma: 0.440945
Beginning preprocessing + Leiden
2024-03-11 18:51:13.614092 MEMORY 2.46151168
Affmat transformed
2024-03-11 18:51:13.617257 MEMORY 2.46151168
sources, targets, weights extracted
2024-03-11 18:51:13.618505 MEMORY 2.46151168
About to launch parallel Leiden runs
2024-03-11 18:51:13.649569 MEMORY 2.46151168
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.8s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.4s finished
Parallel Leiden runs finished
2024-03-11 18:51:16.047108 MEMORY 2.46151168
Quality: 0.3455750574353554
Quality: 0.3459613838495276
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 225 out of 225 | elapsed:    0.1s finished
Got subclusters: Counter({0: 66, 2: 61, 1: 61, 3: 23, 4: 18, 5: 12})
On pattern 6
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 225 samples in 0.002s...
[t-SNE] Computed neighbors for 225 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 225 / 225
[t-SNE] Mean sigma: 0.404968
[t-SNE] Computed conditional probabilities in 0.015s
[t-SNE] Iteration 50: error = 63.5243187, gradient norm = 0.4696544 (50 iterations in 0.032s)
[t-SNE] Iteration 100: error = 62.8895111, gradient norm = 0.4918706 (50 iterations in 0.030s)
[t-SNE] Iteration 150: error = 62.5915070, gradient norm = 0.5366802 (50 iterations in 0.035s)
[t-SNE] Iteration 200: error = 62.8041763, gradient norm = 0.4697756 (50 iterations in 0.031s)
[t-SNE] Iteration 250: error = 62.9690018, gradient norm = 0.4765514 (50 iterations in 0.030s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 62.969002
[t-SNE] Iteration 300: error = 1.0537031, gradient norm = 0.0064333 (50 iterations in 0.028s)
[t-SNE] Iteration 350: error = 0.8843421, gradient norm = 0.0045121 (50 iterations in 0.031s)
[t-SNE] Iteration 400: error = 0.8676331, gradient norm = 0.0008983 (50 iterations in 0.028s)
[t-SNE] Iteration 450: error = 0.8642554, gradient norm = 0.0001865 (50 iterations in 0.028s)
[t-SNE] Iteration 500: error = 0.8610591, gradient norm = 0.0005011 (50 iterations in 0.028s)
[t-SNE] Iteration 550: error = 0.8606549, gradient norm = 0.0001014 (50 iterations in 0.028s)
[t-SNE] Iteration 600: error = 0.8607824, gradient norm = 0.0000639 (50 iterations in 0.028s)
[t-SNE] Iteration 650: error = 0.8607580, gradient norm = 0.0000520 (50 iterations in 0.028s)
[t-SNE] Iteration 700: error = 0.8607138, gradient norm = 0.0000497 (50 iterations in 0.028s)
[t-SNE] Iteration 750: error = 0.8606134, gradient norm = 0.0000674 (50 iterations in 0.028s)
[t-SNE] Iteration 800: error = 0.8605971, gradient norm = 0.0000962 (50 iterations in 0.028s)
[t-SNE] Iteration 850: error = 0.8606133, gradient norm = 0.0000901 (50 iterations in 0.028s)
[t-SNE] Iteration 900: error = 0.8605968, gradient norm = 0.0000684 (50 iterations in 0.028s)
[t-SNE] Iteration 950: error = 0.8605884, gradient norm = 0.0000934 (50 iterations in 0.028s)
[t-SNE] Iteration 1000: error = 0.8606009, gradient norm = 0.0000769 (50 iterations in 0.028s)
[t-SNE] KL divergence after 1000 iterations: 0.860601
[t-SNE] Computed conditional probabilities for sample 225 / 225
[t-SNE] Mean sigma: 0.404968
Beginning preprocessing + Leiden
2024-03-11 18:51:17.005393 MEMORY 2.46151168
Affmat transformed
2024-03-11 18:51:17.008383 MEMORY 2.46151168
sources, targets, weights extracted
2024-03-11 18:51:17.009551 MEMORY 2.46151168
About to launch parallel Leiden runs
2024-03-11 18:51:17.017023 MEMORY 2.46151168
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.8s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.3s finished
Parallel Leiden runs finished
2024-03-11 18:51:19.346341 MEMORY 2.46151168
Quality: 0.3252516034365192
Quality: 0.3252731799932757
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 214 out of 214 | elapsed:    0.1s finished
Got subclusters: Counter({0: 53, 1: 44, 2: 35, 3: 33, 4: 32, 5: 28})
On pattern 7
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 214 samples in 0.002s...
[t-SNE] Computed neighbors for 214 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 214 / 214
[t-SNE] Mean sigma: 0.451465
[t-SNE] Computed conditional probabilities in 0.014s
[t-SNE] Iteration 50: error = 57.7648506, gradient norm = 0.5385328 (50 iterations in 0.030s)
[t-SNE] Iteration 100: error = 60.5370255, gradient norm = 0.5156246 (50 iterations in 0.028s)
[t-SNE] Iteration 150: error = 59.0800514, gradient norm = 0.5083410 (50 iterations in 0.027s)
[t-SNE] Iteration 200: error = 58.0356064, gradient norm = 0.5186958 (50 iterations in 0.027s)
[t-SNE] Iteration 250: error = 57.2700233, gradient norm = 0.5459485 (50 iterations in 0.027s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 57.270023
[t-SNE] Iteration 300: error = 0.9313526, gradient norm = 0.0040194 (50 iterations in 0.028s)
[t-SNE] Iteration 350: error = 0.8248155, gradient norm = 0.0053651 (50 iterations in 0.028s)
[t-SNE] Iteration 400: error = 0.7790926, gradient norm = 0.0017057 (50 iterations in 0.027s)
[t-SNE] Iteration 450: error = 0.7698994, gradient norm = 0.0002810 (50 iterations in 0.028s)
[t-SNE] Iteration 500: error = 0.7701266, gradient norm = 0.0001668 (50 iterations in 0.027s)
[t-SNE] Iteration 550: error = 0.7696844, gradient norm = 0.0001076 (50 iterations in 0.027s)
[t-SNE] Iteration 600: error = 0.7698879, gradient norm = 0.0001933 (50 iterations in 0.027s)
[t-SNE] Iteration 650: error = 0.7698885, gradient norm = 0.0000513 (50 iterations in 0.026s)
[t-SNE] Iteration 700: error = 0.7698076, gradient norm = 0.0000565 (50 iterations in 0.026s)
[t-SNE] Iteration 750: error = 0.7697796, gradient norm = 0.0000583 (50 iterations in 0.062s)
[t-SNE] Iteration 800: error = 0.7698020, gradient norm = 0.0000333 (50 iterations in 0.029s)
[t-SNE] Iteration 850: error = 0.7697961, gradient norm = 0.0000388 (50 iterations in 0.057s)
[t-SNE] Iteration 900: error = 0.7698025, gradient norm = 0.0000448 (50 iterations in 0.048s)
[t-SNE] Iteration 900: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 900 iterations: 0.769803
[t-SNE] Computed conditional probabilities for sample 214 / 214
[t-SNE] Mean sigma: 0.451465
Beginning preprocessing + Leiden
2024-03-11 18:51:20.285793 MEMORY 2.46151168
Affmat transformed
2024-03-11 18:51:20.288604 MEMORY 2.46151168
sources, targets, weights extracted
2024-03-11 18:51:20.289694 MEMORY 2.46151168
About to launch parallel Leiden runs
2024-03-11 18:51:20.336963 MEMORY 2.46151168
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.8s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.3s finished
Parallel Leiden runs finished
2024-03-11 18:51:22.645032 MEMORY 2.46151168
Quality: 0.3299693953771812
Quality: 0.33020942236718415
Quality: 0.3314521045083052
Quality: 0.331467904412114
Quality: 0.3315830338049675
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 210 out of 210 | elapsed:    0.1s finished
Got subclusters: Counter({0: 52, 1: 46, 2: 43, 3: 40, 4: 33})
On pattern 8
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 210 samples in 0.002s...
[t-SNE] Computed neighbors for 210 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 210 / 210
[t-SNE] Mean sigma: 0.432768
[t-SNE] Computed conditional probabilities in 0.014s
[t-SNE] Iteration 50: error = 61.8729515, gradient norm = 0.5140333 (50 iterations in 0.027s)
[t-SNE] Iteration 100: error = 59.3026733, gradient norm = 0.5213261 (50 iterations in 0.027s)
[t-SNE] Iteration 150: error = 61.2123070, gradient norm = 0.4957132 (50 iterations in 0.031s)
[t-SNE] Iteration 200: error = 61.2156296, gradient norm = 0.5273944 (50 iterations in 0.027s)
[t-SNE] Iteration 250: error = 59.4378204, gradient norm = 0.5194194 (50 iterations in 0.027s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 59.437820
[t-SNE] Iteration 300: error = 1.0659198, gradient norm = 0.0064191 (50 iterations in 0.026s)
[t-SNE] Iteration 350: error = 0.9195866, gradient norm = 0.0025106 (50 iterations in 0.026s)
[t-SNE] Iteration 400: error = 0.8931673, gradient norm = 0.0029537 (50 iterations in 0.028s)
[t-SNE] Iteration 450: error = 0.8754289, gradient norm = 0.0010179 (50 iterations in 0.063s)
[t-SNE] Iteration 500: error = 0.8478712, gradient norm = 0.0027764 (50 iterations in 0.029s)
[t-SNE] Iteration 550: error = 0.8335274, gradient norm = 0.0006553 (50 iterations in 0.027s)
[t-SNE] Iteration 600: error = 0.8326679, gradient norm = 0.0001424 (50 iterations in 0.053s)
[t-SNE] Iteration 650: error = 0.8325946, gradient norm = 0.0001595 (50 iterations in 0.027s)
[t-SNE] Iteration 700: error = 0.8325445, gradient norm = 0.0001941 (50 iterations in 0.029s)
[t-SNE] Iteration 750: error = 0.8322133, gradient norm = 0.0001169 (50 iterations in 0.038s)
[t-SNE] Iteration 800: error = 0.8323117, gradient norm = 0.0001919 (50 iterations in 0.028s)
[t-SNE] Iteration 850: error = 0.8322388, gradient norm = 0.0001840 (50 iterations in 0.027s)
[t-SNE] Iteration 900: error = 0.8321934, gradient norm = 0.0001577 (50 iterations in 0.028s)
[t-SNE] Iteration 950: error = 0.8323029, gradient norm = 0.0001524 (50 iterations in 0.026s)
[t-SNE] Iteration 1000: error = 0.8322660, gradient norm = 0.0001489 (50 iterations in 0.026s)
[t-SNE] KL divergence after 1000 iterations: 0.832266
[t-SNE] Computed conditional probabilities for sample 210 / 210
[t-SNE] Mean sigma: 0.432768
Beginning preprocessing + Leiden
2024-03-11 18:51:23.622782 MEMORY 2.46151168
Affmat transformed
2024-03-11 18:51:23.625507 MEMORY 2.46151168
sources, targets, weights extracted
2024-03-11 18:51:23.626624 MEMORY 2.46151168
About to launch parallel Leiden runs
2024-03-11 18:51:23.631221 MEMORY 2.46151168
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.8s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.3s finished
Parallel Leiden runs finished
2024-03-11 18:51:25.903153 MEMORY 2.46151168
Quality: 0.29805441411153444
Quality: 0.3007581553600381
Quality: 0.30144674777964003
Quality: 0.30249395694064374
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 198 out of 198 | elapsed:    0.1s finished
Got subclusters: Counter({0: 45, 1: 40, 2: 36, 3: 28, 4: 23, 5: 22, 6: 10, 7: 6})
On pattern 9
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 198 samples in 0.002s...
[t-SNE] Computed neighbors for 198 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 198 / 198
[t-SNE] Mean sigma: 0.388248
[t-SNE] Computed conditional probabilities in 0.013s
[t-SNE] Iteration 50: error = 59.9054375, gradient norm = 0.5140800 (50 iterations in 0.055s)
[t-SNE] Iteration 100: error = 62.6258049, gradient norm = 0.4850815 (50 iterations in 0.028s)
[t-SNE] Iteration 150: error = 58.5668678, gradient norm = 0.5582525 (50 iterations in 0.029s)
[t-SNE] Iteration 200: error = 59.8257751, gradient norm = 0.5324364 (50 iterations in 0.028s)
[t-SNE] Iteration 250: error = 61.1528320, gradient norm = 0.5137792 (50 iterations in 0.031s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 61.152832
[t-SNE] Iteration 300: error = 0.8568770, gradient norm = 0.0074226 (50 iterations in 0.031s)
[t-SNE] Iteration 350: error = 0.7640634, gradient norm = 0.0024976 (50 iterations in 0.106s)
[t-SNE] Iteration 400: error = 0.7415223, gradient norm = 0.0032020 (50 iterations in 0.039s)
[t-SNE] Iteration 450: error = 0.7323361, gradient norm = 0.0014305 (50 iterations in 0.030s)
[t-SNE] Iteration 500: error = 0.7316803, gradient norm = 0.0002802 (50 iterations in 0.027s)
[t-SNE] Iteration 550: error = 0.7315817, gradient norm = 0.0002578 (50 iterations in 0.028s)
[t-SNE] Iteration 600: error = 0.7315643, gradient norm = 0.0001819 (50 iterations in 0.030s)
[t-SNE] Iteration 650: error = 0.7318414, gradient norm = 0.0001647 (50 iterations in 0.032s)
[t-SNE] Iteration 700: error = 0.7318664, gradient norm = 0.0001512 (50 iterations in 0.031s)
[t-SNE] Iteration 750: error = 0.7315700, gradient norm = 0.0003871 (50 iterations in 0.030s)
[t-SNE] Iteration 800: error = 0.7296973, gradient norm = 0.0011263 (50 iterations in 0.028s)
[t-SNE] Iteration 850: error = 0.7285254, gradient norm = 0.0001723 (50 iterations in 0.028s)
[t-SNE] Iteration 900: error = 0.7287730, gradient norm = 0.0000865 (50 iterations in 0.028s)
[t-SNE] Iteration 950: error = 0.7288468, gradient norm = 0.0001084 (50 iterations in 0.028s)
[t-SNE] Iteration 1000: error = 0.7287676, gradient norm = 0.0001155 (50 iterations in 0.029s)
[t-SNE] KL divergence after 1000 iterations: 0.728768
[t-SNE] Computed conditional probabilities for sample 198 / 198
[t-SNE] Mean sigma: 0.388249
Beginning preprocessing + Leiden
2024-03-11 18:51:26.948893 MEMORY 2.46151168
Affmat transformed
2024-03-11 18:51:26.952024 MEMORY 2.46151168
sources, targets, weights extracted
2024-03-11 18:51:26.953221 MEMORY 2.46151168
About to launch parallel Leiden runs
2024-03-11 18:51:26.992268 MEMORY 2.46151168
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.1s finished
Parallel Leiden runs finished
2024-03-11 18:51:29.139244 MEMORY 2.46151168
Quality: 0.3219591058366448
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 192 out of 192 | elapsed:    0.1s finished
Got subclusters: Counter({0: 56, 3: 31, 1: 31, 2: 31, 4: 26, 5: 17, 6: 6})
On pattern 10
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 192 samples in 0.002s...
[t-SNE] Computed neighbors for 192 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 192 / 192
[t-SNE] Mean sigma: 0.400900
[t-SNE] Computed conditional probabilities in 0.013s
[t-SNE] Iteration 50: error = 61.8243294, gradient norm = 0.4707631 (50 iterations in 0.032s)
[t-SNE] Iteration 100: error = 61.0658951, gradient norm = 0.5360975 (50 iterations in 0.028s)
[t-SNE] Iteration 150: error = 65.0306015, gradient norm = 0.4341034 (50 iterations in 0.029s)
[t-SNE] Iteration 200: error = 67.3193665, gradient norm = 0.4916463 (50 iterations in 0.027s)
[t-SNE] Iteration 250: error = 62.3654213, gradient norm = 0.4828518 (50 iterations in 0.065s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 62.365421
[t-SNE] Iteration 300: error = 1.0657941, gradient norm = 0.0073383 (50 iterations in 0.028s)
[t-SNE] Iteration 350: error = 0.7330585, gradient norm = 0.0047407 (50 iterations in 0.028s)
[t-SNE] Iteration 400: error = 0.7183121, gradient norm = 0.0032133 (50 iterations in 0.050s)
[t-SNE] Iteration 450: error = 0.7155859, gradient norm = 0.0002388 (50 iterations in 0.027s)
[t-SNE] Iteration 500: error = 0.7155275, gradient norm = 0.0001358 (50 iterations in 0.027s)
[t-SNE] Iteration 550: error = 0.7155368, gradient norm = 0.0001427 (50 iterations in 0.025s)
[t-SNE] Iteration 600: error = 0.7155192, gradient norm = 0.0001977 (50 iterations in 0.055s)
[t-SNE] Iteration 650: error = 0.7155545, gradient norm = 0.0001848 (50 iterations in 0.030s)
[t-SNE] Iteration 700: error = 0.7155319, gradient norm = 0.0001691 (50 iterations in 0.027s)
[t-SNE] Iteration 750: error = 0.7154811, gradient norm = 0.0001419 (50 iterations in 0.026s)
[t-SNE] Iteration 800: error = 0.7154697, gradient norm = 0.0001645 (50 iterations in 0.027s)
[t-SNE] Iteration 850: error = 0.7154858, gradient norm = 0.0001213 (50 iterations in 0.027s)
[t-SNE] Iteration 900: error = 0.7155271, gradient norm = 0.0001785 (50 iterations in 0.028s)
[t-SNE] Iteration 950: error = 0.7155644, gradient norm = 0.0001617 (50 iterations in 0.029s)
[t-SNE] Iteration 1000: error = 0.7155352, gradient norm = 0.0001127 (50 iterations in 0.029s)
[t-SNE] KL divergence after 1000 iterations: 0.715535
[t-SNE] Computed conditional probabilities for sample 192 / 192
[t-SNE] Mean sigma: 0.400900
Beginning preprocessing + Leiden
2024-03-11 18:51:30.101360 MEMORY 2.46151168
Affmat transformed
2024-03-11 18:51:30.104407 MEMORY 2.46151168
sources, targets, weights extracted
2024-03-11 18:51:30.105499 MEMORY 2.46151168
About to launch parallel Leiden runs
2024-03-11 18:51:30.140394 MEMORY 2.46151168
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.8s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.2s finished
Parallel Leiden runs finished
2024-03-11 18:51:32.299806 MEMORY 2.46151168
Quality: 0.27250841043743745
Quality: 0.2731953512820266
Quality: 0.27376663010091307
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 140 out of 187 | elapsed:    0.1s remaining:    0.0s
[Parallel(n_jobs=24)]: Done 187 out of 187 | elapsed:    0.1s finished
Got subclusters: Counter({0: 55, 1: 44, 2: 41, 3: 26, 4: 26})
On pattern 11
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 187 samples in 0.002s...
[t-SNE] Computed neighbors for 187 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 187 / 187
[t-SNE] Mean sigma: 0.432613
[t-SNE] Computed conditional probabilities in 0.012s
[t-SNE] Iteration 50: error = 58.2459641, gradient norm = 0.4967669 (50 iterations in 0.029s)
[t-SNE] Iteration 100: error = 54.9349594, gradient norm = 0.4767306 (50 iterations in 0.028s)
[t-SNE] Iteration 150: error = 58.3036308, gradient norm = 0.5265542 (50 iterations in 0.028s)
[t-SNE] Iteration 200: error = 57.5887527, gradient norm = 0.4851469 (50 iterations in 0.026s)
[t-SNE] Iteration 250: error = 58.4802933, gradient norm = 0.5193048 (50 iterations in 0.026s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 58.480293
[t-SNE] Iteration 300: error = 0.9448191, gradient norm = 0.0058822 (50 iterations in 0.027s)
[t-SNE] Iteration 350: error = 0.7985665, gradient norm = 0.0026510 (50 iterations in 0.025s)
[t-SNE] Iteration 400: error = 0.7911213, gradient norm = 0.0002971 (50 iterations in 0.026s)
[t-SNE] Iteration 450: error = 0.7916030, gradient norm = 0.0002714 (50 iterations in 0.028s)
[t-SNE] Iteration 500: error = 0.7916300, gradient norm = 0.0002821 (50 iterations in 0.062s)
[t-SNE] Iteration 550: error = 0.7777621, gradient norm = 0.0023410 (50 iterations in 0.032s)
[t-SNE] Iteration 600: error = 0.7765408, gradient norm = 0.0001986 (50 iterations in 0.029s)
[t-SNE] Iteration 650: error = 0.7763169, gradient norm = 0.0000861 (50 iterations in 0.078s)
[t-SNE] Iteration 700: error = 0.7764133, gradient norm = 0.0001155 (50 iterations in 0.036s)
[t-SNE] Iteration 750: error = 0.7767482, gradient norm = 0.0002064 (50 iterations in 0.026s)
[t-SNE] Iteration 800: error = 0.7765855, gradient norm = 0.0002936 (50 iterations in 0.030s)
[t-SNE] Iteration 850: error = 0.7684194, gradient norm = 0.0007689 (50 iterations in 0.029s)
[t-SNE] Iteration 900: error = 0.7680153, gradient norm = 0.0001088 (50 iterations in 0.027s)
[t-SNE] Iteration 950: error = 0.7678081, gradient norm = 0.0001255 (50 iterations in 0.028s)
[t-SNE] Iteration 1000: error = 0.7679307, gradient norm = 0.0001645 (50 iterations in 0.034s)
[t-SNE] KL divergence after 1000 iterations: 0.767931
[t-SNE] Computed conditional probabilities for sample 187 / 187
[t-SNE] Mean sigma: 0.432613
Beginning preprocessing + Leiden
2024-03-11 18:51:33.286672 MEMORY 2.46151168
Affmat transformed
2024-03-11 18:51:33.290199 MEMORY 2.46151168
sources, targets, weights extracted
2024-03-11 18:51:33.291474 MEMORY 2.46151168
About to launch parallel Leiden runs
2024-03-11 18:51:33.310316 MEMORY 2.46151168
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.1s finished
Parallel Leiden runs finished
2024-03-11 18:51:35.446681 MEMORY 2.46151168
Quality: 0.2805134460835938
Quality: 0.2807118254050727
Quality: 0.28123171374269557
Quality: 0.2817549515886894
Quality: 0.2817761153526723
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 136 out of 183 | elapsed:    0.1s remaining:    0.0s
[Parallel(n_jobs=24)]: Done 183 out of 183 | elapsed:    0.1s finished
Got subclusters: Counter({0: 41, 1: 32, 3: 26, 2: 26, 4: 25, 5: 22, 6: 15})
On pattern 12
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 183 samples in 0.002s...
[t-SNE] Computed neighbors for 183 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 183 / 183
[t-SNE] Mean sigma: 0.407423
[t-SNE] Computed conditional probabilities in 0.013s
[t-SNE] Iteration 50: error = 58.9408226, gradient norm = 0.5707410 (50 iterations in 0.039s)
[t-SNE] Iteration 100: error = 60.1418343, gradient norm = 0.4768568 (50 iterations in 0.028s)
[t-SNE] Iteration 150: error = 56.8468742, gradient norm = 0.5165059 (50 iterations in 0.029s)
[t-SNE] Iteration 200: error = 59.1268501, gradient norm = 0.5084042 (50 iterations in 0.028s)
[t-SNE] Iteration 250: error = 63.1670609, gradient norm = 0.4709305 (50 iterations in 0.028s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 63.167061
[t-SNE] Iteration 300: error = 1.1957424, gradient norm = 0.0088950 (50 iterations in 0.026s)
[t-SNE] Iteration 350: error = 0.8475348, gradient norm = 0.0073631 (50 iterations in 0.025s)
[t-SNE] Iteration 400: error = 0.8178290, gradient norm = 0.0008095 (50 iterations in 0.025s)
[t-SNE] Iteration 450: error = 0.8116515, gradient norm = 0.0022122 (50 iterations in 0.025s)
[t-SNE] Iteration 500: error = 0.8094742, gradient norm = 0.0003063 (50 iterations in 0.027s)
[t-SNE] Iteration 550: error = 0.8094577, gradient norm = 0.0003519 (50 iterations in 0.025s)
[t-SNE] Iteration 600: error = 0.7944818, gradient norm = 0.0023238 (50 iterations in 0.029s)
[t-SNE] Iteration 650: error = 0.7840891, gradient norm = 0.0004317 (50 iterations in 0.027s)
[t-SNE] Iteration 700: error = 0.7839932, gradient norm = 0.0002982 (50 iterations in 0.028s)
[t-SNE] Iteration 750: error = 0.7843629, gradient norm = 0.0002811 (50 iterations in 0.029s)
[t-SNE] Iteration 800: error = 0.7842044, gradient norm = 0.0001409 (50 iterations in 0.059s)
[t-SNE] Iteration 850: error = 0.7841763, gradient norm = 0.0001387 (50 iterations in 0.026s)
[t-SNE] Iteration 900: error = 0.7843762, gradient norm = 0.0001563 (50 iterations in 0.027s)
[t-SNE] Iteration 950: error = 0.7840964, gradient norm = 0.0001031 (50 iterations in 0.140s)
[t-SNE] Iteration 1000: error = 0.7843184, gradient norm = 0.0001351 (50 iterations in 0.024s)
[t-SNE] KL divergence after 1000 iterations: 0.784318
[t-SNE] Computed conditional probabilities for sample 183 / 183
[t-SNE] Mean sigma: 0.407423
Beginning preprocessing + Leiden
2024-03-11 18:51:36.451936 MEMORY 2.46151168
Affmat transformed
2024-03-11 18:51:36.454436 MEMORY 2.46151168
sources, targets, weights extracted
2024-03-11 18:51:36.455407 MEMORY 2.46151168
About to launch parallel Leiden runs
2024-03-11 18:51:36.483407 MEMORY 2.46151168
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.3s finished
Parallel Leiden runs finished
2024-03-11 18:51:38.753433 MEMORY 2.46151168
Quality: 0.27356112033605146
Quality: 0.2740635577289149
Quality: 0.2745294380930137
Quality: 0.2749068399205191
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 182 out of 182 | elapsed:    0.1s finished
Got subclusters: Counter({0: 41, 1: 38, 2: 29, 3: 27, 4: 26, 5: 22})
On pattern 13
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 182 samples in 0.002s...
[t-SNE] Computed neighbors for 182 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 182 / 182
[t-SNE] Mean sigma: 0.433106
[t-SNE] Computed conditional probabilities in 0.012s
[t-SNE] Iteration 50: error = 59.8388557, gradient norm = 0.4908608 (50 iterations in 0.027s)
[t-SNE] Iteration 100: error = 57.8372955, gradient norm = 0.5271059 (50 iterations in 0.027s)
[t-SNE] Iteration 150: error = 56.9119873, gradient norm = 0.5093099 (50 iterations in 0.027s)
[t-SNE] Iteration 200: error = 58.8308868, gradient norm = 0.4452631 (50 iterations in 0.026s)
[t-SNE] Iteration 250: error = 59.1603127, gradient norm = 0.4431684 (50 iterations in 0.028s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 59.160313
[t-SNE] Iteration 300: error = 0.8788077, gradient norm = 0.0064073 (50 iterations in 0.027s)
[t-SNE] Iteration 350: error = 0.7055687, gradient norm = 0.0044682 (50 iterations in 0.025s)
[t-SNE] Iteration 400: error = 0.6967714, gradient norm = 0.0004680 (50 iterations in 0.026s)
[t-SNE] Iteration 450: error = 0.6974429, gradient norm = 0.0001926 (50 iterations in 0.027s)
[t-SNE] Iteration 500: error = 0.6968745, gradient norm = 0.0002017 (50 iterations in 0.027s)
[t-SNE] Iteration 550: error = 0.6969202, gradient norm = 0.0001460 (50 iterations in 0.024s)
[t-SNE] Iteration 600: error = 0.6969365, gradient norm = 0.0001151 (50 iterations in 0.024s)
[t-SNE] Iteration 650: error = 0.6969575, gradient norm = 0.0002440 (50 iterations in 0.024s)
[t-SNE] Iteration 700: error = 0.6971192, gradient norm = 0.0001467 (50 iterations in 0.024s)
[t-SNE] Iteration 750: error = 0.6969871, gradient norm = 0.0001939 (50 iterations in 0.026s)
[t-SNE] Iteration 750: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 750 iterations: 0.696987
[t-SNE] Computed conditional probabilities for sample 182 / 182
[t-SNE] Mean sigma: 0.433106
Beginning preprocessing + Leiden
2024-03-11 18:51:39.436002 MEMORY 2.46151168
Affmat transformed
2024-03-11 18:51:39.438318 MEMORY 2.46151168
sources, targets, weights extracted
2024-03-11 18:51:39.439218 MEMORY 2.46151168
About to launch parallel Leiden runs
2024-03-11 18:51:39.452653 MEMORY 2.46151168
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.1s finished
Parallel Leiden runs finished
2024-03-11 18:51:41.517906 MEMORY 2.46151168
Quality: 0.293423411237207
Quality: 0.29447302765233546
Quality: 0.29735479883677873
Quality: 0.2977402099689695
Quality: 0.2986745634570471
Quality: 0.29872378301331803
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 132 out of 179 | elapsed:    0.1s remaining:    0.0s
[Parallel(n_jobs=24)]: Done 179 out of 179 | elapsed:    0.1s finished
Got subclusters: Counter({0: 40, 1: 39, 2: 34, 3: 30, 4: 25, 5: 14})
On pattern 14
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 179 samples in 0.001s...
[t-SNE] Computed neighbors for 179 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 179 / 179
[t-SNE] Mean sigma: 0.423652
[t-SNE] Computed conditional probabilities in 0.012s
[t-SNE] Iteration 50: error = 60.2286606, gradient norm = 0.5067986 (50 iterations in 0.026s)
[t-SNE] Iteration 100: error = 58.8278618, gradient norm = 0.4970946 (50 iterations in 0.026s)
[t-SNE] Iteration 150: error = 58.3966637, gradient norm = 0.5205789 (50 iterations in 0.026s)
[t-SNE] Iteration 200: error = 56.2745667, gradient norm = 0.5763994 (50 iterations in 0.027s)
[t-SNE] Iteration 250: error = 57.7375488, gradient norm = 0.5194759 (50 iterations in 0.026s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 57.737549
[t-SNE] Iteration 300: error = 0.9541372, gradient norm = 0.0089444 (50 iterations in 0.025s)
[t-SNE] Iteration 350: error = 0.8008402, gradient norm = 0.0031796 (50 iterations in 0.024s)
[t-SNE] Iteration 400: error = 0.7724788, gradient norm = 0.0029093 (50 iterations in 0.024s)
[t-SNE] Iteration 450: error = 0.7658204, gradient norm = 0.0003327 (50 iterations in 0.024s)
[t-SNE] Iteration 500: error = 0.7206672, gradient norm = 0.0037354 (50 iterations in 0.024s)
[t-SNE] Iteration 550: error = 0.7188935, gradient norm = 0.0011949 (50 iterations in 0.024s)
[t-SNE] Iteration 600: error = 0.7068410, gradient norm = 0.0006846 (50 iterations in 0.026s)
[t-SNE] Iteration 650: error = 0.7068369, gradient norm = 0.0001276 (50 iterations in 0.024s)
[t-SNE] Iteration 700: error = 0.7069122, gradient norm = 0.0001860 (50 iterations in 0.024s)
[t-SNE] Iteration 750: error = 0.7068952, gradient norm = 0.0001511 (50 iterations in 0.024s)
[t-SNE] Iteration 800: error = 0.7068836, gradient norm = 0.0001812 (50 iterations in 0.024s)
[t-SNE] Iteration 850: error = 0.7067292, gradient norm = 0.0002467 (50 iterations in 0.024s)
[t-SNE] Iteration 900: error = 0.7068949, gradient norm = 0.0001855 (50 iterations in 0.024s)
[t-SNE] Iteration 950: error = 0.7067091, gradient norm = 0.0001766 (50 iterations in 0.025s)
[t-SNE] Iteration 1000: error = 0.7068540, gradient norm = 0.0002691 (50 iterations in 0.026s)
[t-SNE] KL divergence after 1000 iterations: 0.706854
[t-SNE] Computed conditional probabilities for sample 179 / 179
[t-SNE] Mean sigma: 0.423652
Beginning preprocessing + Leiden
2024-03-11 18:51:42.305464 MEMORY 2.46151168
Affmat transformed
2024-03-11 18:51:42.307808 MEMORY 2.46151168
sources, targets, weights extracted
2024-03-11 18:51:42.309080 MEMORY 2.46151168
About to launch parallel Leiden runs
2024-03-11 18:51:42.337703 MEMORY 2.46151168
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.1s finished
Parallel Leiden runs finished
2024-03-11 18:51:44.414748 MEMORY 2.46151168
Quality: 0.28160343270925436
Quality: 0.28208176558305875
Quality: 0.28311737435136936
Quality: 0.2844868940062068
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 130 out of 177 | elapsed:    0.1s remaining:    0.0s
[Parallel(n_jobs=24)]: Done 177 out of 177 | elapsed:    0.1s finished
Got subclusters: Counter({0: 52, 1: 47, 2: 35, 3: 32, 4: 13})
On pattern 15
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 177 samples in 0.002s...
[t-SNE] Computed neighbors for 177 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 177 / 177
[t-SNE] Mean sigma: 0.433767
[t-SNE] Computed conditional probabilities in 0.012s
[t-SNE] Iteration 50: error = 57.9161873, gradient norm = 0.5300504 (50 iterations in 0.049s)
[t-SNE] Iteration 100: error = 57.7022018, gradient norm = 0.5076603 (50 iterations in 0.031s)
[t-SNE] Iteration 150: error = 55.3925056, gradient norm = 0.5574193 (50 iterations in 0.027s)
[t-SNE] Iteration 200: error = 57.6075058, gradient norm = 0.4997747 (50 iterations in 0.026s)
[t-SNE] Iteration 250: error = 59.9319305, gradient norm = 0.5394674 (50 iterations in 0.026s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 59.931931
[t-SNE] Iteration 300: error = 1.0574538, gradient norm = 0.0090848 (50 iterations in 0.027s)
[t-SNE] Iteration 350: error = 0.7371045, gradient norm = 0.0047274 (50 iterations in 0.024s)
[t-SNE] Iteration 400: error = 0.7164751, gradient norm = 0.0003962 (50 iterations in 0.024s)
[t-SNE] Iteration 450: error = 0.7166895, gradient norm = 0.0001848 (50 iterations in 0.024s)
[t-SNE] Iteration 500: error = 0.7167102, gradient norm = 0.0001503 (50 iterations in 0.024s)
[t-SNE] Iteration 550: error = 0.7167625, gradient norm = 0.0002015 (50 iterations in 0.024s)
[t-SNE] Iteration 600: error = 0.7167051, gradient norm = 0.0002141 (50 iterations in 0.024s)
[t-SNE] Iteration 650: error = 0.7166545, gradient norm = 0.0001590 (50 iterations in 0.024s)
[t-SNE] Iteration 700: error = 0.7167917, gradient norm = 0.0001407 (50 iterations in 0.032s)
[t-SNE] Iteration 750: error = 0.7166957, gradient norm = 0.0001722 (50 iterations in 0.024s)
[t-SNE] Iteration 750: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 750 iterations: 0.716696
[t-SNE] Computed conditional probabilities for sample 177 / 177
[t-SNE] Mean sigma: 0.433767
Beginning preprocessing + Leiden
2024-03-11 18:51:45.111486 MEMORY 2.46151168
Affmat transformed
2024-03-11 18:51:45.114098 MEMORY 2.46151168
sources, targets, weights extracted
2024-03-11 18:51:45.115223 MEMORY 2.46151168
About to launch parallel Leiden runs
2024-03-11 18:51:45.137445 MEMORY 2.46151168
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.1s finished
Parallel Leiden runs finished
2024-03-11 18:51:47.249631 MEMORY 2.46151168
Quality: 0.28753158663285006
Quality: 0.29201765444241107
Quality: 0.29238185774785624
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 120 out of 167 | elapsed:    0.1s remaining:    0.0s
[Parallel(n_jobs=24)]: Done 167 out of 167 | elapsed:    0.1s finished
Got subclusters: Counter({0: 43, 1: 41, 2: 38, 3: 37, 4: 18})
On pattern 16
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 167 samples in 0.001s...
[t-SNE] Computed neighbors for 167 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 167 / 167
[t-SNE] Mean sigma: 0.418485
[t-SNE] Computed conditional probabilities in 0.011s
[t-SNE] Iteration 50: error = 62.4826164, gradient norm = 0.4883268 (50 iterations in 0.029s)
[t-SNE] Iteration 100: error = 62.2351761, gradient norm = 0.4672491 (50 iterations in 0.027s)
[t-SNE] Iteration 150: error = 62.4811516, gradient norm = 0.4734980 (50 iterations in 0.026s)
[t-SNE] Iteration 200: error = 60.2949257, gradient norm = 0.4944711 (50 iterations in 0.026s)
[t-SNE] Iteration 250: error = 59.3086090, gradient norm = 0.5176858 (50 iterations in 0.025s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 59.308609
[t-SNE] Iteration 300: error = 0.8659706, gradient norm = 0.0060523 (50 iterations in 0.024s)
[t-SNE] Iteration 350: error = 0.6564228, gradient norm = 0.0035379 (50 iterations in 0.024s)
[t-SNE] Iteration 400: error = 0.6526780, gradient norm = 0.0004995 (50 iterations in 0.026s)
[t-SNE] Iteration 450: error = 0.6357576, gradient norm = 0.0016491 (50 iterations in 0.025s)
[t-SNE] Iteration 500: error = 0.6271655, gradient norm = 0.0030013 (50 iterations in 0.025s)
[t-SNE] Iteration 550: error = 0.6055526, gradient norm = 0.0006925 (50 iterations in 0.023s)
[t-SNE] Iteration 600: error = 0.6053339, gradient norm = 0.0002460 (50 iterations in 0.023s)
[t-SNE] Iteration 650: error = 0.6036586, gradient norm = 0.0041770 (50 iterations in 0.025s)
[t-SNE] Iteration 700: error = 0.6007090, gradient norm = 0.0002305 (50 iterations in 0.024s)
[t-SNE] Iteration 750: error = 0.6005796, gradient norm = 0.0002281 (50 iterations in 0.025s)
[t-SNE] Iteration 800: error = 0.6004167, gradient norm = 0.0001750 (50 iterations in 0.023s)
[t-SNE] Iteration 850: error = 0.6004021, gradient norm = 0.0002154 (50 iterations in 0.023s)
[t-SNE] Iteration 900: error = 0.6003914, gradient norm = 0.0002365 (50 iterations in 0.023s)
[t-SNE] Iteration 950: error = 0.6005041, gradient norm = 0.0002431 (50 iterations in 0.023s)
[t-SNE] Iteration 1000: error = 0.6004767, gradient norm = 0.0001938 (50 iterations in 0.023s)
[t-SNE] KL divergence after 1000 iterations: 0.600477
[t-SNE] Computed conditional probabilities for sample 167 / 167
[t-SNE] Mean sigma: 0.418485
Beginning preprocessing + Leiden
2024-03-11 18:51:48.019572 MEMORY 2.46151168
Affmat transformed
2024-03-11 18:51:48.021765 MEMORY 2.46151168
sources, targets, weights extracted
2024-03-11 18:51:48.022610 MEMORY 2.46151168
About to launch parallel Leiden runs
2024-03-11 18:51:48.061377 MEMORY 2.46151168
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.0s finished
Parallel Leiden runs finished
2024-03-11 18:51:50.102613 MEMORY 2.46151168
Quality: 0.2876356237861375
Quality: 0.28764355089597604
Quality: 0.2880784715708593
Quality: 0.28881855483121854
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 156 out of 156 | elapsed:    0.1s finished
Got subclusters: Counter({0: 42, 1: 33, 2: 30, 3: 22, 4: 21, 5: 19})
On pattern 17
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 156 samples in 0.001s...
[t-SNE] Computed neighbors for 156 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 156 / 156
[t-SNE] Mean sigma: 0.439830
[t-SNE] Computed conditional probabilities in 0.010s
[t-SNE] Iteration 50: error = 57.6759491, gradient norm = 0.5109872 (50 iterations in 0.060s)
[t-SNE] Iteration 100: error = 57.5974464, gradient norm = 0.4783160 (50 iterations in 0.024s)
[t-SNE] Iteration 150: error = 59.4795761, gradient norm = 0.5383154 (50 iterations in 0.023s)
[t-SNE] Iteration 200: error = 57.0590248, gradient norm = 0.5228143 (50 iterations in 0.024s)
[t-SNE] Iteration 250: error = 57.7621574, gradient norm = 0.4931018 (50 iterations in 0.025s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 57.762157
[t-SNE] Iteration 300: error = 0.8426062, gradient norm = 0.0114607 (50 iterations in 0.022s)
[t-SNE] Iteration 350: error = 0.6822342, gradient norm = 0.0015983 (50 iterations in 0.024s)
[t-SNE] Iteration 400: error = 0.6801070, gradient norm = 0.0006413 (50 iterations in 0.022s)
[t-SNE] Iteration 450: error = 0.6801016, gradient norm = 0.0001774 (50 iterations in 0.022s)
[t-SNE] Iteration 500: error = 0.6800001, gradient norm = 0.0002087 (50 iterations in 0.022s)
[t-SNE] Iteration 550: error = 0.6799673, gradient norm = 0.0002540 (50 iterations in 0.023s)
[t-SNE] Iteration 600: error = 0.6799971, gradient norm = 0.0003676 (50 iterations in 0.023s)
[t-SNE] Iteration 650: error = 0.6799682, gradient norm = 0.0003023 (50 iterations in 0.022s)
[t-SNE] Iteration 700: error = 0.6800264, gradient norm = 0.0003911 (50 iterations in 0.023s)
[t-SNE] Iteration 750: error = 0.6800163, gradient norm = 0.0002538 (50 iterations in 0.023s)
[t-SNE] Iteration 800: error = 0.6799966, gradient norm = 0.0003007 (50 iterations in 0.022s)
[t-SNE] Iteration 850: error = 0.6800136, gradient norm = 0.0002231 (50 iterations in 0.023s)
[t-SNE] Iteration 900: error = 0.6800184, gradient norm = 0.0002291 (50 iterations in 0.023s)
[t-SNE] Iteration 900: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 900 iterations: 0.680018
[t-SNE] Computed conditional probabilities for sample 156 / 156
[t-SNE] Mean sigma: 0.439830
Beginning preprocessing + Leiden
2024-03-11 18:51:50.808534 MEMORY 2.46151168
Affmat transformed
2024-03-11 18:51:50.810642 MEMORY 2.46151168
sources, targets, weights extracted
2024-03-11 18:51:50.811410 MEMORY 2.46151168
About to launch parallel Leiden runs
2024-03-11 18:51:50.815457 MEMORY 2.46151168
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.0s finished
Parallel Leiden runs finished
2024-03-11 18:51:52.796637 MEMORY 2.46151168
Quality: 0.2661435831156429
Quality: 0.2667848062982007
Quality: 0.2673328631298594
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 146 out of 146 | elapsed:    0.1s finished
Got subclusters: Counter({0: 36, 1: 30, 2: 30, 3: 23, 4: 22, 5: 12, 6: 3})
On pattern 18
[t-SNE] Computing 145 nearest neighbors...
[t-SNE] Indexed 146 samples in 0.001s...
[t-SNE] Computed neighbors for 146 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 146 / 146
[t-SNE] Mean sigma: 0.442958
[t-SNE] Computed conditional probabilities in 0.009s
[t-SNE] Iteration 50: error = 61.9270401, gradient norm = 0.4572046 (50 iterations in 0.023s)
[t-SNE] Iteration 100: error = 57.3026390, gradient norm = 0.5321292 (50 iterations in 0.024s)
[t-SNE] Iteration 150: error = 56.2213516, gradient norm = 0.5044168 (50 iterations in 0.023s)
[t-SNE] Iteration 200: error = 52.8831024, gradient norm = 0.5131499 (50 iterations in 0.023s)
[t-SNE] Iteration 250: error = 58.5572891, gradient norm = 0.4560241 (50 iterations in 0.022s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 58.557289
[t-SNE] Iteration 300: error = 0.7793307, gradient norm = 0.0067516 (50 iterations in 0.022s)
[t-SNE] Iteration 350: error = 0.5272531, gradient norm = 0.0056346 (50 iterations in 0.021s)
[t-SNE] Iteration 400: error = 0.5093612, gradient norm = 0.0014594 (50 iterations in 0.021s)
[t-SNE] Iteration 450: error = 0.4996919, gradient norm = 0.0005748 (50 iterations in 0.022s)
[t-SNE] Iteration 500: error = 0.4999433, gradient norm = 0.0002944 (50 iterations in 0.023s)
[t-SNE] Iteration 550: error = 0.4998213, gradient norm = 0.0003692 (50 iterations in 0.022s)
[t-SNE] Iteration 600: error = 0.4984465, gradient norm = 0.0003543 (50 iterations in 0.023s)
[t-SNE] Iteration 650: error = 0.4985662, gradient norm = 0.0002865 (50 iterations in 0.022s)
[t-SNE] Iteration 700: error = 0.4982851, gradient norm = 0.0003363 (50 iterations in 0.022s)
[t-SNE] Iteration 750: error = 0.4985192, gradient norm = 0.0002539 (50 iterations in 0.022s)
[t-SNE] Iteration 800: error = 0.4984744, gradient norm = 0.0003183 (50 iterations in 0.022s)
[t-SNE] Iteration 850: error = 0.4984008, gradient norm = 0.0002999 (50 iterations in 0.025s)
[t-SNE] Iteration 900: error = 0.4986107, gradient norm = 0.0002736 (50 iterations in 0.022s)
[t-SNE] Iteration 950: error = 0.4985816, gradient norm = 0.0002567 (50 iterations in 0.021s)
[t-SNE] Iteration 1000: error = 0.4984692, gradient norm = 0.0002566 (50 iterations in 0.021s)
[t-SNE] KL divergence after 1000 iterations: 0.498469
[t-SNE] Computed conditional probabilities for sample 146 / 146
[t-SNE] Mean sigma: 0.442958
Beginning preprocessing + Leiden
2024-03-11 18:51:53.467029 MEMORY 2.46151168
Affmat transformed
2024-03-11 18:51:53.468988 MEMORY 2.46151168
sources, targets, weights extracted
2024-03-11 18:51:53.469686 MEMORY 2.46151168
About to launch parallel Leiden runs
2024-03-11 18:51:53.489016 MEMORY 2.46151168
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.9s finished
Parallel Leiden runs finished
2024-03-11 18:51:55.396212 MEMORY 2.46151168
Quality: 0.2554686841936541
Quality: 0.25555024734996884
Quality: 0.2556355947971388
Quality: 0.2566243750412392
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  94 out of 141 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=24)]: Done 141 out of 141 | elapsed:    0.1s finished
Got subclusters: Counter({0: 34, 1: 31, 2: 28, 3: 24, 4: 16, 5: 10, 6: 3})
On pattern 19
[t-SNE] Computing 140 nearest neighbors...
[t-SNE] Indexed 141 samples in 0.001s...
[t-SNE] Computed neighbors for 141 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 141 / 141
[t-SNE] Mean sigma: 0.422121
[t-SNE] Computed conditional probabilities in 0.009s
[t-SNE] Iteration 50: error = 61.2597885, gradient norm = 0.5145476 (50 iterations in 0.022s)
[t-SNE] Iteration 100: error = 67.3831024, gradient norm = 0.3615400 (50 iterations in 0.024s)
[t-SNE] Iteration 150: error = 61.4864540, gradient norm = 0.4400323 (50 iterations in 0.023s)
[t-SNE] Iteration 200: error = 61.3758354, gradient norm = 0.4460324 (50 iterations in 0.022s)
[t-SNE] Iteration 250: error = 56.8422356, gradient norm = 0.5867289 (50 iterations in 0.021s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 56.842236
[t-SNE] Iteration 300: error = 0.8073894, gradient norm = 0.0098560 (50 iterations in 0.021s)
[t-SNE] Iteration 350: error = 0.4975246, gradient norm = 0.0045294 (50 iterations in 0.023s)
[t-SNE] Iteration 400: error = 0.4926320, gradient norm = 0.0003720 (50 iterations in 0.039s)
[t-SNE] Iteration 450: error = 0.4927425, gradient norm = 0.0003326 (50 iterations in 0.041s)
[t-SNE] Iteration 500: error = 0.4926398, gradient norm = 0.0003998 (50 iterations in 0.052s)
[t-SNE] Iteration 550: error = 0.4926733, gradient norm = 0.0003863 (50 iterations in 0.021s)
[t-SNE] Iteration 600: error = 0.4927212, gradient norm = 0.0003704 (50 iterations in 0.040s)
[t-SNE] Iteration 650: error = 0.4926566, gradient norm = 0.0004228 (50 iterations in 0.021s)
[t-SNE] Iteration 700: error = 0.4925605, gradient norm = 0.0003817 (50 iterations in 0.021s)
[t-SNE] Iteration 750: error = 0.4927666, gradient norm = 0.0003936 (50 iterations in 0.022s)
[t-SNE] Iteration 800: error = 0.4927056, gradient norm = 0.0003870 (50 iterations in 0.023s)
[t-SNE] Iteration 850: error = 0.4926656, gradient norm = 0.0003926 (50 iterations in 0.023s)
[t-SNE] Iteration 900: error = 0.4926256, gradient norm = 0.0003810 (50 iterations in 0.027s)
[t-SNE] Iteration 950: error = 0.4926091, gradient norm = 0.0003555 (50 iterations in 0.022s)
[t-SNE] Iteration 1000: error = 0.4928150, gradient norm = 0.0007045 (50 iterations in 0.022s)
[t-SNE] KL divergence after 1000 iterations: 0.492815
[t-SNE] Computed conditional probabilities for sample 141 / 141
[t-SNE] Mean sigma: 0.422121
Beginning preprocessing + Leiden
2024-03-11 18:51:56.151397 MEMORY 2.46151168
Affmat transformed
2024-03-11 18:51:56.153263 MEMORY 2.46151168
sources, targets, weights extracted
2024-03-11 18:51:56.153925 MEMORY 2.46151168
About to launch parallel Leiden runs
2024-03-11 18:51:56.170940 MEMORY 2.46151168
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.0s finished
Parallel Leiden runs finished
2024-03-11 18:51:58.134004 MEMORY 2.46151168
Quality: 0.24493802335513742
Quality: 0.24554271972642847
Quality: 0.24576903338502137
Quality: 0.24585680604470062
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  90 out of 137 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=24)]: Done 137 out of 137 | elapsed:    0.1s finished
Got subclusters: Counter({0: 34, 2: 28, 1: 28, 3: 27, 4: 24})
On pattern 20
[t-SNE] Computing 136 nearest neighbors...
[t-SNE] Indexed 137 samples in 0.001s...
[t-SNE] Computed neighbors for 137 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 137 / 137
[t-SNE] Mean sigma: 0.436274
[t-SNE] Computed conditional probabilities in 0.008s
[t-SNE] Iteration 50: error = 59.4268303, gradient norm = 0.5336576 (50 iterations in 0.037s)
[t-SNE] Iteration 100: error = 53.3055191, gradient norm = 0.5747185 (50 iterations in 0.023s)
[t-SNE] Iteration 150: error = 61.3211937, gradient norm = 0.4790929 (50 iterations in 0.023s)
[t-SNE] Iteration 200: error = 52.4285736, gradient norm = 0.6099028 (50 iterations in 0.023s)
[t-SNE] Iteration 250: error = 55.8484764, gradient norm = 0.5060300 (50 iterations in 0.024s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 55.848476
[t-SNE] Iteration 300: error = 0.7937678, gradient norm = 0.0090151 (50 iterations in 0.024s)
[t-SNE] Iteration 350: error = 0.4687944, gradient norm = 0.0038435 (50 iterations in 0.024s)
[t-SNE] Iteration 400: error = 0.4664617, gradient norm = 0.0004558 (50 iterations in 0.022s)
[t-SNE] Iteration 450: error = 0.4647893, gradient norm = 0.0004668 (50 iterations in 0.026s)
[t-SNE] Iteration 500: error = 0.4648749, gradient norm = 0.0004724 (50 iterations in 0.021s)
[t-SNE] Iteration 550: error = 0.4649439, gradient norm = 0.0005661 (50 iterations in 0.021s)
[t-SNE] Iteration 600: error = 0.4649689, gradient norm = 0.0004767 (50 iterations in 0.021s)
[t-SNE] Iteration 650: error = 0.4649454, gradient norm = 0.0004939 (50 iterations in 0.027s)
[t-SNE] Iteration 700: error = 0.4650341, gradient norm = 0.0004526 (50 iterations in 0.023s)
[t-SNE] Iteration 750: error = 0.4648897, gradient norm = 0.0005428 (50 iterations in 0.022s)
[t-SNE] Iteration 800: error = 0.4649304, gradient norm = 0.0004766 (50 iterations in 0.023s)
[t-SNE] Iteration 800: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 800 iterations: 0.464930
[t-SNE] Computed conditional probabilities for sample 137 / 137
[t-SNE] Mean sigma: 0.436274
Beginning preprocessing + Leiden
2024-03-11 18:51:58.743346 MEMORY 2.46151168
Affmat transformed
2024-03-11 18:51:58.745260 MEMORY 2.46151168
sources, targets, weights extracted
2024-03-11 18:51:58.745977 MEMORY 2.46151168
About to launch parallel Leiden runs
2024-03-11 18:51:58.793479 MEMORY 2.46151168
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.9s finished
Parallel Leiden runs finished
2024-03-11 18:52:00.690022 MEMORY 2.46151168
Quality: 0.25488935263849005
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  70 out of 117 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=24)]: Done 117 out of 117 | elapsed:    0.0s finished
Got subclusters: Counter({0: 32, 1: 29, 2: 28, 3: 26, 4: 22})
On pattern 21
[t-SNE] Computing 116 nearest neighbors...
[t-SNE] Indexed 117 samples in 0.001s...
[t-SNE] Computed neighbors for 117 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 117 / 117
[t-SNE] Mean sigma: 0.463116
[t-SNE] Computed conditional probabilities in 0.006s
[t-SNE] Iteration 50: error = 53.8098946, gradient norm = 0.5202494 (50 iterations in 0.022s)
[t-SNE] Iteration 100: error = 55.5690422, gradient norm = 0.4909134 (50 iterations in 0.020s)
[t-SNE] Iteration 150: error = 54.2512054, gradient norm = 0.5236568 (50 iterations in 0.019s)
[t-SNE] Iteration 200: error = 55.8033600, gradient norm = 0.5330589 (50 iterations in 0.019s)
[t-SNE] Iteration 250: error = 58.6543198, gradient norm = 0.4610130 (50 iterations in 0.019s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 58.654320
[t-SNE] Iteration 300: error = 0.9902703, gradient norm = 0.0087514 (50 iterations in 0.020s)
[t-SNE] Iteration 350: error = 0.5441364, gradient norm = 0.0182266 (50 iterations in 0.021s)
[t-SNE] Iteration 400: error = 0.4793711, gradient norm = 0.0020081 (50 iterations in 0.021s)
[t-SNE] Iteration 450: error = 0.4788729, gradient norm = 0.0004970 (50 iterations in 0.022s)
[t-SNE] Iteration 500: error = 0.4791359, gradient norm = 0.0003334 (50 iterations in 0.021s)
[t-SNE] Iteration 550: error = 0.4788953, gradient norm = 0.0005379 (50 iterations in 0.022s)
[t-SNE] Iteration 600: error = 0.4792790, gradient norm = 0.0004369 (50 iterations in 0.021s)
[t-SNE] Iteration 650: error = 0.4791855, gradient norm = 0.0004545 (50 iterations in 0.021s)
[t-SNE] Iteration 700: error = 0.4789224, gradient norm = 0.0003455 (50 iterations in 0.021s)
[t-SNE] Iteration 750: error = 0.4791103, gradient norm = 0.0003470 (50 iterations in 0.021s)
[t-SNE] Iteration 800: error = 0.4790147, gradient norm = 0.0004496 (50 iterations in 0.023s)
[t-SNE] Iteration 800: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 800 iterations: 0.479015
[t-SNE] Computed conditional probabilities for sample 117 / 117
[t-SNE] Mean sigma: 0.463116
Beginning preprocessing + Leiden
2024-03-11 18:52:01.188394 MEMORY 2.46151168
Affmat transformed
2024-03-11 18:52:01.189882 MEMORY 2.46151168
sources, targets, weights extracted
2024-03-11 18:52:01.190459 MEMORY 2.46151168
About to launch parallel Leiden runs
2024-03-11 18:52:01.205076 MEMORY 2.46151168
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.6s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.8s finished
Parallel Leiden runs finished
2024-03-11 18:52:03.020882 MEMORY 2.46151168
Quality: 0.22871693394316187
Quality: 0.23010081447817482
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 110 out of 110 | elapsed:    0.0s finished
Got subclusters: Counter({0: 28, 1: 27, 2: 27, 3: 20, 4: 15})
On pattern 22
[t-SNE] Computing 109 nearest neighbors...
[t-SNE] Indexed 110 samples in 0.001s...
[t-SNE] Computed neighbors for 110 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 110 / 110
[t-SNE] Mean sigma: 0.474773
[t-SNE] Computed conditional probabilities in 0.005s
[t-SNE] Iteration 50: error = 59.4926720, gradient norm = 0.4707236 (50 iterations in 0.030s)
[t-SNE] Iteration 100: error = 53.8492088, gradient norm = 0.4933924 (50 iterations in 0.020s)
[t-SNE] Iteration 150: error = 55.0473976, gradient norm = 0.5094345 (50 iterations in 0.020s)
[t-SNE] Iteration 200: error = 58.0556068, gradient norm = 0.5095824 (50 iterations in 0.019s)
[t-SNE] Iteration 250: error = 53.2601662, gradient norm = 0.5876611 (50 iterations in 0.020s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 53.260166
[t-SNE] Iteration 300: error = 1.0607826, gradient norm = 0.0075254 (50 iterations in 0.019s)
[t-SNE] Iteration 350: error = 0.8111749, gradient norm = 0.0048223 (50 iterations in 0.020s)
[t-SNE] Iteration 400: error = 0.5221787, gradient norm = 0.0242787 (50 iterations in 0.017s)
[t-SNE] Iteration 450: error = 0.3706542, gradient norm = 0.0029478 (50 iterations in 0.017s)
[t-SNE] Iteration 500: error = 0.3696842, gradient norm = 0.0011540 (50 iterations in 0.018s)
[t-SNE] Iteration 550: error = 0.3684328, gradient norm = 0.0008536 (50 iterations in 0.018s)
[t-SNE] Iteration 600: error = 0.3681988, gradient norm = 0.0003606 (50 iterations in 0.018s)
[t-SNE] Iteration 650: error = 0.3682809, gradient norm = 0.0003704 (50 iterations in 0.018s)
[t-SNE] Iteration 700: error = 0.3682606, gradient norm = 0.0002191 (50 iterations in 0.022s)
[t-SNE] Iteration 750: error = 0.3684045, gradient norm = 0.0006069 (50 iterations in 0.017s)
[t-SNE] Iteration 800: error = 0.3682307, gradient norm = 0.0003100 (50 iterations in 0.019s)
[t-SNE] Iteration 850: error = 0.3683912, gradient norm = 0.0004755 (50 iterations in 0.019s)
[t-SNE] Iteration 900: error = 0.3684003, gradient norm = 0.0004977 (50 iterations in 0.019s)
[t-SNE] Iteration 950: error = 0.3681555, gradient norm = 0.0004585 (50 iterations in 0.020s)
[t-SNE] Iteration 1000: error = 0.3681849, gradient norm = 0.0003787 (50 iterations in 0.020s)
[t-SNE] KL divergence after 1000 iterations: 0.368185
[t-SNE] Computed conditional probabilities for sample 110 / 110
[t-SNE] Mean sigma: 0.474773
Beginning preprocessing + Leiden
2024-03-11 18:52:03.554405 MEMORY 2.46151168
Affmat transformed
2024-03-11 18:52:03.555907 MEMORY 2.46151168
sources, targets, weights extracted
2024-03-11 18:52:03.556443 MEMORY 2.46151168
About to launch parallel Leiden runs
2024-03-11 18:52:03.586147 MEMORY 2.46151168
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.6s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.8s finished
Parallel Leiden runs finished
2024-03-11 18:52:05.399775 MEMORY 2.46151168
Quality: 0.22561996703977039
Quality: 0.22710967713952773
Quality: 0.22890480754242368
Quality: 0.228977415734177
Quality: 0.22936698599631378
Quality: 0.23020165886463115
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  96 out of  96 | elapsed:    0.0s finished
Got subclusters: Counter({1: 28, 0: 28, 3: 26, 2: 26, 4: 2})
On pattern 23
[t-SNE] Computing 95 nearest neighbors...
[t-SNE] Indexed 96 samples in 0.001s...
[t-SNE] Computed neighbors for 96 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 96 / 96
[t-SNE] Mean sigma: 0.502018
[t-SNE] Computed conditional probabilities in 0.004s
[t-SNE] Iteration 50: error = 51.4162102, gradient norm = 0.4973153 (50 iterations in 0.023s)
[t-SNE] Iteration 100: error = 49.9306030, gradient norm = 0.5117143 (50 iterations in 0.019s)
[t-SNE] Iteration 150: error = 52.1536636, gradient norm = 0.4841768 (50 iterations in 0.018s)
[t-SNE] Iteration 200: error = 55.1679535, gradient norm = 0.4966618 (50 iterations in 0.019s)
[t-SNE] Iteration 250: error = 51.4871483, gradient norm = 0.4348173 (50 iterations in 0.019s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 51.487148
[t-SNE] Iteration 300: error = 0.4591682, gradient norm = 0.0137067 (50 iterations in 0.018s)
[t-SNE] Iteration 350: error = 0.3070185, gradient norm = 0.0046708 (50 iterations in 0.020s)
[t-SNE] Iteration 400: error = 0.3103915, gradient norm = 0.0082894 (50 iterations in 0.017s)
[t-SNE] Iteration 450: error = 0.3073329, gradient norm = 0.0066787 (50 iterations in 0.019s)
[t-SNE] Iteration 500: error = 0.3067081, gradient norm = 0.0063203 (50 iterations in 0.017s)
[t-SNE] Iteration 550: error = 0.3099701, gradient norm = 0.0085453 (50 iterations in 0.018s)
[t-SNE] Iteration 600: error = 0.3071842, gradient norm = 0.0068944 (50 iterations in 0.017s)
[t-SNE] Iteration 650: error = 0.3059228, gradient norm = 0.0043309 (50 iterations in 0.017s)
[t-SNE] Iteration 700: error = 0.3072070, gradient norm = 0.0068132 (50 iterations in 0.016s)
[t-SNE] Iteration 750: error = 0.3071496, gradient norm = 0.0073027 (50 iterations in 0.017s)
[t-SNE] Iteration 800: error = 0.3054094, gradient norm = 0.0014591 (50 iterations in 0.017s)
[t-SNE] Iteration 850: error = 0.3055016, gradient norm = 0.0003961 (50 iterations in 0.016s)
[t-SNE] Iteration 900: error = 0.3054924, gradient norm = 0.0003282 (50 iterations in 0.017s)
[t-SNE] Iteration 950: error = 0.3055676, gradient norm = 0.0004677 (50 iterations in 0.017s)
[t-SNE] Iteration 1000: error = 0.3056405, gradient norm = 0.0003533 (50 iterations in 0.017s)
[t-SNE] KL divergence after 1000 iterations: 0.305641
[t-SNE] Computed conditional probabilities for sample 96 / 96
[t-SNE] Mean sigma: 0.502018
Beginning preprocessing + Leiden
2024-03-11 18:52:05.879382 MEMORY 2.46151168
Affmat transformed
2024-03-11 18:52:05.880812 MEMORY 2.46151168
sources, targets, weights extracted
2024-03-11 18:52:05.881341 MEMORY 2.46151168
About to launch parallel Leiden runs
2024-03-11 18:52:05.905375 MEMORY 2.46151168
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.6s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.8s finished
Parallel Leiden runs finished
2024-03-11 18:52:07.667164 MEMORY 2.46151168
Quality: 0.20584902113797998
Quality: 0.2058877437463352
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  90 out of  90 | elapsed:    0.0s finished
Got subclusters: Counter({0: 26, 1: 25, 2: 18, 3: 17, 4: 10})
On pattern 24
[t-SNE] Computing 89 nearest neighbors...
[t-SNE] Indexed 90 samples in 0.001s...
[t-SNE] Computed neighbors for 90 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 90 / 90
[t-SNE] Mean sigma: 0.544373
[t-SNE] Computed conditional probabilities in 0.003s
[t-SNE] Iteration 50: error = 50.7752876, gradient norm = 0.6339515 (50 iterations in 0.021s)
[t-SNE] Iteration 100: error = 50.7602234, gradient norm = 0.5213067 (50 iterations in 0.018s)
[t-SNE] Iteration 150: error = 50.8942757, gradient norm = 0.5639270 (50 iterations in 0.018s)
[t-SNE] Iteration 200: error = 52.0094872, gradient norm = 0.5265024 (50 iterations in 0.018s)
[t-SNE] Iteration 250: error = 49.6033173, gradient norm = 0.5406494 (50 iterations in 0.018s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 49.603317
[t-SNE] Iteration 300: error = 0.6744226, gradient norm = 0.0106477 (50 iterations in 0.015s)
[t-SNE] Iteration 350: error = 0.3503694, gradient norm = 0.0232668 (50 iterations in 0.015s)
[t-SNE] Iteration 400: error = 0.2796192, gradient norm = 0.0142139 (50 iterations in 0.015s)
[t-SNE] Iteration 450: error = 0.2739882, gradient norm = 0.0090561 (50 iterations in 0.015s)
[t-SNE] Iteration 500: error = 0.2709742, gradient norm = 0.0019711 (50 iterations in 0.016s)
[t-SNE] Iteration 550: error = 0.2707772, gradient norm = 0.0006267 (50 iterations in 0.016s)
[t-SNE] Iteration 600: error = 0.2707873, gradient norm = 0.0005519 (50 iterations in 0.016s)
[t-SNE] Iteration 650: error = 0.2707728, gradient norm = 0.0006246 (50 iterations in 0.016s)
[t-SNE] Iteration 700: error = 0.2708766, gradient norm = 0.0006213 (50 iterations in 0.017s)
[t-SNE] Iteration 750: error = 0.2706503, gradient norm = 0.0005142 (50 iterations in 0.018s)
[t-SNE] Iteration 800: error = 0.2707941, gradient norm = 0.0006238 (50 iterations in 0.031s)
[t-SNE] Iteration 850: error = 0.2706716, gradient norm = 0.0006412 (50 iterations in 0.022s)
[t-SNE] Iteration 900: error = 0.2708516, gradient norm = 0.0006235 (50 iterations in 0.017s)
[t-SNE] Iteration 950: error = 0.2707652, gradient norm = 0.0004440 (50 iterations in 0.015s)
[t-SNE] Iteration 1000: error = 0.2708621, gradient norm = 0.0006179 (50 iterations in 0.016s)
[t-SNE] KL divergence after 1000 iterations: 0.270862
[t-SNE] Computed conditional probabilities for sample 90 / 90
[t-SNE] Mean sigma: 0.544373
Beginning preprocessing + Leiden
2024-03-11 18:52:08.138023 MEMORY 2.46151168
Affmat transformed
2024-03-11 18:52:08.139933 MEMORY 2.46151168
sources, targets, weights extracted
2024-03-11 18:52:08.140367 MEMORY 2.46151168
About to launch parallel Leiden runs
2024-03-11 18:52:08.166347 MEMORY 2.46151168
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.6s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.8s finished
Parallel Leiden runs finished
2024-03-11 18:52:09.932466 MEMORY 2.46151168
Quality: 0.1808233693270611
Quality: 0.18211545163505774
Quality: 0.1822730504339964
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  70 out of  70 | elapsed:    0.0s finished
Got subclusters: Counter({0: 28, 1: 24, 2: 18, 3: 16, 4: 4})
On pattern 25
[t-SNE] Computing 69 nearest neighbors...
[t-SNE] Indexed 70 samples in 0.001s...
[t-SNE] Computed neighbors for 70 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 70 / 70
[t-SNE] Mean sigma: 0.676262
[t-SNE] Computed conditional probabilities in 0.002s
[t-SNE] Iteration 50: error = 50.0847092, gradient norm = 0.5473640 (50 iterations in 0.017s)
[t-SNE] Iteration 100: error = 47.2483711, gradient norm = 0.6488406 (50 iterations in 0.019s)
[t-SNE] Iteration 150: error = 50.5599098, gradient norm = 0.5002617 (50 iterations in 0.017s)
[t-SNE] Iteration 200: error = 48.6210899, gradient norm = 0.4057399 (50 iterations in 0.015s)
[t-SNE] Iteration 250: error = 50.1094246, gradient norm = 0.4976745 (50 iterations in 0.017s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 50.109425
[t-SNE] Iteration 300: error = 0.8599445, gradient norm = 0.0024242 (50 iterations in 0.015s)
[t-SNE] Iteration 350: error = 0.7216274, gradient norm = 0.0010436 (50 iterations in 0.017s)
[t-SNE] Iteration 400: error = 0.6589931, gradient norm = 0.0008560 (50 iterations in 0.015s)
[t-SNE] Iteration 450: error = 0.6157626, gradient norm = 0.0008793 (50 iterations in 0.014s)
[t-SNE] Iteration 500: error = 0.5731326, gradient norm = 0.0008345 (50 iterations in 0.014s)
[t-SNE] Iteration 550: error = 0.5562586, gradient norm = 0.0007403 (50 iterations in 0.014s)
[t-SNE] Iteration 600: error = 0.5385044, gradient norm = 0.0004522 (50 iterations in 0.015s)
[t-SNE] Iteration 650: error = 0.5236505, gradient norm = 0.0004583 (50 iterations in 0.028s)
[t-SNE] Iteration 700: error = 0.8737471, gradient norm = 0.0589626 (50 iterations in 0.016s)
[t-SNE] Iteration 750: error = 0.6462337, gradient norm = 0.0012551 (50 iterations in 0.014s)
[t-SNE] Iteration 800: error = 0.5827198, gradient norm = 0.0004974 (50 iterations in 0.038s)
[t-SNE] Iteration 850: error = 0.5499662, gradient norm = 0.0004897 (50 iterations in 0.013s)
[t-SNE] Iteration 900: error = 0.5333227, gradient norm = 0.0002631 (50 iterations in 0.015s)
[t-SNE] Iteration 950: error = 0.5267688, gradient norm = 0.0001844 (50 iterations in 0.016s)
[t-SNE] Iteration 1000: error = 0.5208616, gradient norm = 0.0003781 (50 iterations in 0.015s)
[t-SNE] KL divergence after 1000 iterations: 0.520862
[t-SNE] Computed conditional probabilities for sample 70 / 70
[t-SNE] Mean sigma: 0.676262
Beginning preprocessing + Leiden
2024-03-11 18:52:10.369398 MEMORY 2.46151168
Affmat transformed
2024-03-11 18:52:10.370401 MEMORY 2.46151168
sources, targets, weights extracted
2024-03-11 18:52:10.370818 MEMORY 2.46151168
About to launch parallel Leiden runs
2024-03-11 18:52:10.381444 MEMORY 2.46151168
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.6s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.7s finished
Parallel Leiden runs finished
2024-03-11 18:52:12.075395 MEMORY 2.46151168
Quality: 0.12786064347259066
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  68 out of  68 | elapsed:    0.0s finished
Got subclusters: Counter({0: 23, 2: 16, 1: 16, 3: 15})
On pattern 26
[t-SNE] Computing 67 nearest neighbors...
[t-SNE] Indexed 68 samples in 0.001s...
[t-SNE] Computed neighbors for 68 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 68 / 68
[t-SNE] Mean sigma: 0.688001
[t-SNE] Computed conditional probabilities in 0.002s
[t-SNE] Iteration 50: error = 49.3533211, gradient norm = 0.6063241 (50 iterations in 0.015s)
[t-SNE] Iteration 100: error = 50.4294205, gradient norm = 0.5943276 (50 iterations in 0.017s)
[t-SNE] Iteration 150: error = 47.5144310, gradient norm = 0.4419873 (50 iterations in 0.015s)
[t-SNE] Iteration 200: error = 46.4059830, gradient norm = 0.5702021 (50 iterations in 0.015s)
[t-SNE] Iteration 250: error = 47.2220345, gradient norm = 0.5362114 (50 iterations in 0.015s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 47.222034
[t-SNE] Iteration 300: error = 0.9263557, gradient norm = 0.0016945 (50 iterations in 0.013s)
[t-SNE] Iteration 350: error = 0.8002713, gradient norm = 0.0007641 (50 iterations in 0.016s)
[t-SNE] Iteration 400: error = 0.7577407, gradient norm = 0.0005304 (50 iterations in 0.015s)
[t-SNE] Iteration 450: error = 0.7285581, gradient norm = 0.0004816 (50 iterations in 0.015s)
[t-SNE] Iteration 500: error = 0.6961882, gradient norm = 0.0003255 (50 iterations in 0.013s)
[t-SNE] Iteration 550: error = 0.6776468, gradient norm = 0.0008382 (50 iterations in 0.014s)
[t-SNE] Iteration 600: error = 0.6646262, gradient norm = 0.0002515 (50 iterations in 0.015s)
[t-SNE] Iteration 650: error = 0.6538661, gradient norm = 0.0002239 (50 iterations in 0.013s)
[t-SNE] Iteration 700: error = 0.6433136, gradient norm = 0.0001873 (50 iterations in 0.014s)
[t-SNE] Iteration 750: error = 0.6391025, gradient norm = 0.0001808 (50 iterations in 0.013s)
[t-SNE] Iteration 800: error = 0.6326646, gradient norm = 0.0003396 (50 iterations in 0.021s)
[t-SNE] Iteration 850: error = 0.6233691, gradient norm = 0.0005625 (50 iterations in 0.013s)
[t-SNE] Iteration 900: error = 1.0571226, gradient norm = 0.0027234 (50 iterations in 0.013s)
[t-SNE] Iteration 950: error = 0.9017022, gradient norm = 0.0005994 (50 iterations in 0.013s)
[t-SNE] Iteration 1000: error = 0.8188931, gradient norm = 0.0004594 (50 iterations in 0.013s)
[t-SNE] KL divergence after 1000 iterations: 0.818893
[t-SNE] Computed conditional probabilities for sample 68 / 68
[t-SNE] Mean sigma: 0.688001
Beginning preprocessing + Leiden
2024-03-11 18:52:12.458647 MEMORY 2.46151168
Affmat transformed
2024-03-11 18:52:12.459594 MEMORY 2.46151168
sources, targets, weights extracted
2024-03-11 18:52:12.459969 MEMORY 2.46151168
About to launch parallel Leiden runs
2024-03-11 18:52:12.545950 MEMORY 2.46151168
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.6s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.7s finished
Parallel Leiden runs finished
2024-03-11 18:52:14.249032 MEMORY 2.46151168
Quality: 0.13504170721951317
Quality: 0.13507026400725677
Quality: 0.13537797020416015
Quality: 0.13592518786706503
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  58 out of  58 | elapsed:    0.0s finished
Got subclusters: Counter({0: 23, 1: 21, 2: 13, 3: 11})
On pattern 27
[t-SNE] Computing 57 nearest neighbors...
[t-SNE] Indexed 58 samples in 0.001s...
[t-SNE] Computed neighbors for 58 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 58 / 58
[t-SNE] Mean sigma: 0.764546
[t-SNE] Computed conditional probabilities in 0.002s
[t-SNE] Iteration 50: error = 44.3456726, gradient norm = 0.4823919 (50 iterations in 0.015s)
[t-SNE] Iteration 100: error = 47.5373688, gradient norm = 0.3945483 (50 iterations in 0.015s)
[t-SNE] Iteration 150: error = 48.4286194, gradient norm = 0.4879658 (50 iterations in 0.014s)
[t-SNE] Iteration 200: error = 45.0801048, gradient norm = 0.4155088 (50 iterations in 0.013s)
[t-SNE] Iteration 250: error = 45.0933304, gradient norm = 0.4960983 (50 iterations in 0.021s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 45.093330
[t-SNE] Iteration 300: error = 0.6746441, gradient norm = 0.0010801 (50 iterations in 0.016s)
[t-SNE] Iteration 350: error = 0.6357729, gradient norm = 0.0004175 (50 iterations in 0.016s)
[t-SNE] Iteration 400: error = 0.6145751, gradient norm = 0.0005174 (50 iterations in 0.016s)
[t-SNE] Iteration 450: error = 0.5951108, gradient norm = 0.0003876 (50 iterations in 0.013s)
[t-SNE] Iteration 500: error = 0.5789740, gradient norm = 0.0004073 (50 iterations in 0.013s)
[t-SNE] Iteration 550: error = 0.5642385, gradient norm = 0.0004453 (50 iterations in 0.014s)
[t-SNE] Iteration 600: error = 0.5508693, gradient norm = 0.0003845 (50 iterations in 0.019s)
[t-SNE] Iteration 650: error = 0.5419008, gradient norm = 0.0004423 (50 iterations in 0.023s)
[t-SNE] Iteration 700: error = 0.5579726, gradient norm = 0.0355043 (50 iterations in 0.017s)
[t-SNE] Iteration 750: error = 0.7517040, gradient norm = 0.0009954 (50 iterations in 0.016s)
[t-SNE] Iteration 800: error = 0.6687309, gradient norm = 0.0003758 (50 iterations in 0.014s)
[t-SNE] Iteration 850: error = 0.6368614, gradient norm = 0.0003024 (50 iterations in 0.014s)
[t-SNE] Iteration 900: error = 0.6230950, gradient norm = 0.0002369 (50 iterations in 0.013s)
[t-SNE] Iteration 950: error = 0.6100096, gradient norm = 0.0001993 (50 iterations in 0.020s)
[t-SNE] Iteration 1000: error = 0.6016979, gradient norm = 0.0001404 (50 iterations in 0.014s)
[t-SNE] Iteration 1000: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 1000 iterations: 0.601698
[t-SNE] Computed conditional probabilities for sample 58 / 58
[t-SNE] Mean sigma: 0.764546
Beginning preprocessing + Leiden
2024-03-11 18:52:14.636018 MEMORY 2.46151168
Affmat transformed
2024-03-11 18:52:14.636919 MEMORY 2.46151168
sources, targets, weights extracted
2024-03-11 18:52:14.637274 MEMORY 2.46151168
About to launch parallel Leiden runs
2024-03-11 18:52:14.691855 MEMORY 2.46151168
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.6s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.7s finished
Parallel Leiden runs finished
2024-03-11 18:52:16.387070 MEMORY 2.46151168
Quality: 0.06649890337891051
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  52 out of  52 | elapsed:    0.0s finished
Got subclusters: Counter({0: 18, 1: 15, 2: 13, 3: 12})
On pattern 28
[t-SNE] Computing 51 nearest neighbors...
[t-SNE] Indexed 52 samples in 0.001s...
[t-SNE] Computed neighbors for 52 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 52 / 52
[t-SNE] Mean sigma: 1.340013
[t-SNE] Computed conditional probabilities in 0.001s
[t-SNE] Iteration 50: error = 42.0543022, gradient norm = 0.5382054 (50 iterations in 0.018s)
[t-SNE] Iteration 100: error = 43.1027527, gradient norm = 0.3965647 (50 iterations in 0.013s)
[t-SNE] Iteration 150: error = 46.6017494, gradient norm = 0.7223294 (50 iterations in 0.013s)
[t-SNE] Iteration 200: error = 43.8995781, gradient norm = 0.5151844 (50 iterations in 0.016s)
[t-SNE] Iteration 250: error = 42.0700340, gradient norm = 0.4960316 (50 iterations in 0.013s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 42.070034
[t-SNE] Iteration 300: error = 0.6488856, gradient norm = 0.0008814 (50 iterations in 0.096s)
[t-SNE] Iteration 350: error = 0.6211477, gradient norm = 0.0002041 (50 iterations in 0.012s)
[t-SNE] Iteration 400: error = 0.6128871, gradient norm = 0.0002312 (50 iterations in 0.013s)
[t-SNE] Iteration 450: error = 0.6125042, gradient norm = 0.0001349 (50 iterations in 0.014s)
[t-SNE] Iteration 500: error = 0.6007805, gradient norm = 0.0002438 (50 iterations in 0.014s)
[t-SNE] Iteration 550: error = 0.5962817, gradient norm = 0.0002221 (50 iterations in 0.012s)
[t-SNE] Iteration 600: error = 0.5944291, gradient norm = 0.0002087 (50 iterations in 0.012s)
[t-SNE] Iteration 650: error = 0.5892200, gradient norm = 0.0003606 (50 iterations in 0.012s)
[t-SNE] Iteration 700: error = 0.5685781, gradient norm = 0.0042216 (50 iterations in 0.012s)
[t-SNE] Iteration 750: error = 0.8587109, gradient norm = 0.0009676 (50 iterations in 0.013s)
[t-SNE] Iteration 800: error = 0.7365117, gradient norm = 0.0005046 (50 iterations in 0.012s)
[t-SNE] Iteration 850: error = 0.6455898, gradient norm = 0.0002346 (50 iterations in 0.012s)
[t-SNE] Iteration 900: error = 0.6252631, gradient norm = 0.0000864 (50 iterations in 0.012s)
[t-SNE] Iteration 950: error = 0.6218439, gradient norm = 0.0000493 (50 iterations in 0.012s)
[t-SNE] Iteration 1000: error = 0.6205516, gradient norm = 0.0000344 (50 iterations in 0.013s)
[t-SNE] KL divergence after 1000 iterations: 0.620552
[t-SNE] Computed conditional probabilities for sample 52 / 52
[t-SNE] Mean sigma: 1.340013
Beginning preprocessing + Leiden
2024-03-11 18:52:16.794555 MEMORY 2.46151168
Affmat transformed
2024-03-11 18:52:16.795345 MEMORY 2.46151168
sources, targets, weights extracted
2024-03-11 18:52:16.795693 MEMORY 2.46151168
About to launch parallel Leiden runs
2024-03-11 18:52:16.820926 MEMORY 2.46151168
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.6s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.7s finished
Parallel Leiden runs finished
2024-03-11 18:52:18.524403 MEMORY 2.46151168
Quality: 0.017710399562275075
Quality: 0.019536604547571446
Got subclusters: Counter({0: 29, 1: 23})
On metacluster 0
Metacluster size 8908
Relevant tasks:  ('head', 'testis')
Relevant signs:  (-1, -1)
TfModiscoSeqletsToPatternsFactory: seed=1234
(Round 1) num seqlets: 8908
(Round 1) Computing coarse affmat
2024-03-11 18:52:19.124400 MEMORY 2.460729344
Beginning embedding computation
MEMORY 2.460729344
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 152 tasks      | elapsed:    1.9s
[Parallel(n_jobs=24)]: Done 402 tasks      | elapsed:    4.6s
[Parallel(n_jobs=24)]: Done 752 tasks      | elapsed:    8.5s
[Parallel(n_jobs=24)]: Done 1202 tasks      | elapsed:   13.5s
[Parallel(n_jobs=24)]: Done 1752 tasks      | elapsed:   19.5s
[Parallel(n_jobs=24)]: Done 2402 tasks      | elapsed:   26.6s
[Parallel(n_jobs=24)]: Done 3152 tasks      | elapsed:   34.8s
[Parallel(n_jobs=24)]: Done 4002 tasks      | elapsed:   44.1s
[Parallel(n_jobs=24)]: Done 4952 tasks      | elapsed:   54.4s
[Parallel(n_jobs=24)]: Done 6002 tasks      | elapsed:  1.1min
[Parallel(n_jobs=24)]: Done 7152 tasks      | elapsed:  1.3min
[Parallel(n_jobs=24)]: Done 8402 tasks      | elapsed:  1.5min
[Parallel(n_jobs=24)]: Done 8908 out of 8908 | elapsed:  1.6min finished
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 152 tasks      | elapsed:    1.9s
[Parallel(n_jobs=24)]: Done 402 tasks      | elapsed:    4.5s
[Parallel(n_jobs=24)]: Done 752 tasks      | elapsed:    8.2s
[Parallel(n_jobs=24)]: Done 1202 tasks      | elapsed:   13.1s
[Parallel(n_jobs=24)]: Done 1752 tasks      | elapsed:   19.0s
[Parallel(n_jobs=24)]: Done 2402 tasks      | elapsed:   26.1s
[Parallel(n_jobs=24)]: Done 3152 tasks      | elapsed:   34.1s
[Parallel(n_jobs=24)]: Done 4002 tasks      | elapsed:   43.4s
[Parallel(n_jobs=24)]: Done 4952 tasks      | elapsed:   53.7s
[Parallel(n_jobs=24)]: Done 6002 tasks      | elapsed:  1.1min
[Parallel(n_jobs=24)]: Done 7152 tasks      | elapsed:  1.3min
[Parallel(n_jobs=24)]: Done 8402 tasks      | elapsed:  1.5min
[Parallel(n_jobs=24)]: Done 8908 out of 8908 | elapsed:  1.6min finished
At the beginning of embedding call
2024-03-11 18:52:19.124678 MEMORY 2.460729344
before computing embeddings fwd
2024-03-11 18:52:19.134153 MEMORY 2.460729344
after computing embeddings fwd
2024-03-11 18:53:56.189077 MEMORY 2.545348608
after computing embeddings rev
2024-03-11 18:55:32.547666 MEMORY 2.911428608
before computing sparse embeddings fwd
2024-03-11 18:55:32.547759 MEMORY 2.911428608
Constructing csr matrix...
csr matrix made in 1.058027744293213 s
after computing sparse embeddings fwd
2024-03-11 18:55:33.916180 MEMORY 2.965024768
before computing sparse embeddings rev
2024-03-11 18:55:33.916262 MEMORY 2.965024768
Constructing csr matrix...
csr matrix made in 1.0277507305145264 s
after computing sparse embeddings rev
2024-03-11 18:55:35.297856 MEMORY 3.018477568
Finished embedding computation in 196.89 s
MEMORY 2.696040448
Starting affinity matrix computations
MEMORY 2.695778304
Batching in slices of size 7533
  0%|          | 0/2 [00:00<?, ?it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:08<00:08,  8.80s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:11<00:00,  5.21s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:11<00:00,  5.75s/it]
Finished affinity matrix computations in 11.55 s
MEMORY 2.695274496
(Round 1) Computed coarse affmat
2024-03-11 18:55:47.869070 MEMORY 2.623864832
(Round 1) Computing affinity matrix on nearest neighbors
2024-03-11 18:55:47.869192 MEMORY 2.623864832
Launching nearest neighbors affmat calculation job
MEMORY 2.623864832
Parallel runs completed
MEMORY 2.703495168
Job completed in: 30.12 s
MEMORY 2.7014144
Launching nearest neighbors affmat calculation job
MEMORY 2.699169792
Parallel runs completed
MEMORY 2.758565888
Job completed in: 30.33 s
MEMORY 2.757255168
(Round 1) Computed affinity matrix on nearest neighbors in 62.53 s
2024-03-11 18:56:50.404614 MEMORY 2.668998656
Filtered down to 8225 of 8908
(Round 1) Retained 8225 rows out of 8908 after filtering
2024-03-11 18:56:54.890740 MEMORY 2.669101056
(Round 1) Computing density adapted affmat
2024-03-11 18:56:56.545001 MEMORY 2.669101056
Symmetrizing nearest neighbors
Computing betas for density adaptation
Computing normalizing denominators
(Round 1) Computing clustering
2024-03-11 18:58:06.228244 MEMORY 2.636333056
Beginning preprocessing + Leiden
2024-03-11 18:58:06.239405 MEMORY 2.636333056
Affmat transformed
2024-03-11 18:58:06.239546 MEMORY 2.636333056
sources, targets, weights extracted
2024-03-11 18:58:06.548484 MEMORY 2.728554496
About to launch parallel Leiden runs
2024-03-11 18:58:07.532497 MEMORY 2.68249088
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:   32.4s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:  2.2min finished
Parallel Leiden runs finished
2024-03-11 19:00:20.844631 MEMORY 2.68249088
Quality: 0.38284323274178644
Quality: 0.3828732124920414
Got 5 clusters after round 1
Counts:
{0: 2629, 1: 2011, 2: 1345, 3: 1141, 4: 1099}
2024-03-11 19:00:20.871635 MEMORY 2.544152576
(Round 1) Aggregating seqlets in each cluster
2024-03-11 19:00:20.871745 MEMORY 2.544152576
Aggregating for cluster 0 with 2629 seqlets
2024-03-11 19:00:20.874536 MEMORY 2.544152576
Skipped 22 due to duplicates
Trimming eliminated 0 seqlets out of 2607
Aggregating for cluster 1 with 2011 seqlets
2024-03-11 19:00:27.568141 MEMORY 2.544406528
Skipped 19 due to duplicates
Trimming eliminated 0 seqlets out of 1992
Aggregating for cluster 2 with 1345 seqlets
2024-03-11 19:00:32.287792 MEMORY 2.544406528
Skipped 2 due to duplicates
Trimming eliminated 0 seqlets out of 1343
WARNING: Probabilities don't sum to 1 in all the rows; this can be caused by zero-padding. Will renormalize. PPM:
[[0.33581534 0.15487714 0.16827997 0.34102755]
 [0.34549516 0.16306776 0.16679077 0.32464631]
 [0.31273269 0.17200298 0.16604617 0.34921817]
 [0.3172003  0.16679077 0.18912882 0.32688012]
 [0.35070737 0.1377513  0.17572599 0.33581534]
 [0.34177215 0.15413254 0.16679077 0.33730454]
 [0.3186895  0.19359643 0.17721519 0.31049888]
 [0.31124348 0.17125838 0.17498138 0.34251675]
 [0.29188384 0.18540581 0.16306776 0.35964259]
 [0.31347729 0.17572599 0.16827997 0.34251675]
 [0.3186895  0.17498138 0.17498138 0.33134773]
 [0.30677587 0.15115413 0.18763961 0.35443038]
 [0.33730454 0.1347729  0.17274758 0.35517498]
 [0.36113179 0.16008935 0.14594192 0.33283693]
 [0.43037975 0.15636634 0.14221891 0.271035  ]
 [0.33804914 0.19136262 0.19880864 0.2717796 ]
 [0.37453462 0.1801936  0.19508563 0.25018615]
 [0.58451229 0.12583768 0.183172   0.10647803]
 [0.47580045 0.20774386 0.07297096 0.24348474]
 [0.04169769 0.01935964 0.0022338  0.93670886]
 [0.01712584 0.0469099  0.00521221 0.93075205]
 [0.5904691  0.06329114 0.07520477 0.271035  ]
 [0.89798958 0.01414743 0.03797468 0.04988831]
 [0.34921817 0.05286672 0.15487714 0.44303797]
 [0.2732688  0.14966493 0.32762472 0.24944155]
 [0.41250931 0.15487714 0.16530156 0.26731199]
 [0.32390171 0.18540581 0.16679077 0.32390171]
 [0.33953835 0.15636634 0.19434103 0.30975428]
 [0.28369322 0.2256143  0.14966493 0.34102755]
 [0.31124348 0.17572599 0.15487714 0.35740879]
 [0.3172003  0.18689501 0.1809382  0.31422189]
 [0.34698436 0.15189873 0.15785555 0.34251675]
 [0.34475056 0.16306776 0.16008935 0.33134773]
 [0.32613552 0.15785555 0.17944899 0.33581534]
 [0.34102755 0.17349218 0.17349218 0.31124348]
 [0.28965004 0.19285182 0.17423678 0.34251675]
 [0.33655994 0.15264334 0.19061802 0.3194341 ]
 [0.33804914 0.1377513  0.16157856 0.3618764 ]
 [0.35443038 0.17647059 0.14519732 0.32315711]
 [0.33879375 0.19136262 0.16157856 0.30752048]]
Probability sums:
[1.        1.        1.        1.        1.        1.        1.
 1.        1.        1.        1.        1.        1.        1.
 1.        1.        1.        1.        1.        1.        1.
 1.        1.        1.        1.        1.        1.        1.
 1.        0.9992554 0.9992554 0.9992554 0.9992554 0.9992554 0.9992554
 0.9992554 0.9992554 0.9992554 0.9992554 0.9992554]
Aggregating for cluster 3 with 1141 seqlets
2024-03-11 19:00:35.549387 MEMORY 2.544406528
Skipped 10 due to duplicates
Trimming eliminated 0 seqlets out of 1131
Aggregating for cluster 4 with 1099 seqlets
2024-03-11 19:00:38.490103 MEMORY 2.544406528
Skipped 6 due to duplicates
Trimming eliminated 0 seqlets out of 1093
WARNING: Probabilities don't sum to 1 in all the rows; this can be caused by zero-padding. Will renormalize. PPM:
[[0.33943275 0.14730101 0.16193962 0.35041171]
 [0.30009149 0.16376944 0.16468435 0.3705398 ]
 [0.30924062 0.1610247  0.17017383 0.35864593]
 [0.33760293 0.14638609 0.15645014 0.35864593]
 [0.32021958 0.1537054  0.14455627 0.38060384]
 [0.31198536 0.1610247  0.18572736 0.34034767]
 [0.31290027 0.1399817  0.1884721  0.35773102]
 [0.27172919 0.16193962 0.14821592 0.41720037]
 [0.26532479 0.16010979 0.1610247  0.4126258 ]
 [0.3074108  0.14181153 0.14913083 0.40073193]
 [0.25800549 0.16010979 0.12168344 0.45928637]
 [0.30649588 0.12076853 0.14638609 0.42543458]
 [0.2589204  0.16376944 0.09972553 0.47758463]
 [0.24336688 0.15096066 0.13449222 0.47118024]
 [0.28728271 0.21225984 0.15462031 0.34583715]
 [0.23696249 0.19487649 0.09972553 0.4684355 ]
 [0.25617566 0.16010979 0.06861848 0.51509607]
 [0.11344922 0.28911253 0.02287283 0.57456542]
 [0.03934126 0.04483074 0.01097896 0.90484904]
 [0.02012809 0.01738335 0.021043   0.94144556]
 [0.10064044 0.0768527  0.10064044 0.72186642]
 [0.3778591  0.05306496 0.27538884 0.2936871 ]
 [0.15553522 0.10704483 0.19304666 0.54437328]
 [0.15096066 0.23879231 0.13906679 0.47118024]
 [0.23238792 0.12625801 0.20768527 0.4336688 ]
 [0.1326624  0.22781336 0.12625801 0.51326624]
 [0.22598353 0.14455627 0.1537054  0.4757548 ]
 [0.25800549 0.14364135 0.16010979 0.43824337]
 [0.25068618 0.15736505 0.15553522 0.43641354]
 [0.27721866 0.1399817  0.21225984 0.3705398 ]
 [0.29094236 0.16559927 0.17291857 0.3705398 ]
 [0.26898445 0.17108875 0.17840805 0.38151876]
 [0.32479414 0.16834401 0.18664227 0.32021958]
 [0.32479414 0.13723696 0.17291857 0.36505032]
 [0.29185727 0.14821592 0.17291857 0.38700823]
 [0.30466606 0.14730101 0.16834401 0.37968893]
 [0.32662397 0.15919488 0.1537054  0.36047575]
 [0.30375114 0.17657823 0.13449222 0.38517841]
 [0.31015554 0.17017383 0.14455627 0.37511436]]
Probability sums:
[0.99908509 0.99908509 0.99908509 0.99908509 0.99908509 0.99908509
 0.99908509 0.99908509 0.99908509 0.99908509 0.99908509 0.99908509
 1.         1.         1.         1.         1.         1.
 1.         1.         1.         1.         1.         1.
 1.         1.         1.         1.         1.         1.
 1.         1.         1.         1.         1.         1.
 1.         1.         1.        ]
(Round 2) num seqlets: 8163
(Round 2) Computing coarse affmat
2024-03-11 19:00:41.205081 MEMORY 2.544406528
Beginning embedding computation
MEMORY 2.544406528
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done 2400 tasks      | elapsed:    2.5s
[Parallel(n_jobs=24)]: Done 5200 tasks      | elapsed:    5.2s
[Parallel(n_jobs=24)]: Done 8114 tasks      | elapsed:    8.0s
[Parallel(n_jobs=24)]: Done 8163 out of 8163 | elapsed:    8.1s finished
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 368 tasks      | elapsed:    0.8s
[Parallel(n_jobs=24)]: Done 1368 tasks      | elapsed:    2.1s
[Parallel(n_jobs=24)]: Done 2768 tasks      | elapsed:    3.8s
[Parallel(n_jobs=24)]: Done 4568 tasks      | elapsed:    6.2s
[Parallel(n_jobs=24)]: Done 6768 tasks      | elapsed:    9.1s
[Parallel(n_jobs=24)]: Done 8163 out of 8163 | elapsed:   11.0s finished
At the beginning of embedding call
2024-03-11 19:00:41.205277 MEMORY 2.544406528
before computing embeddings fwd
2024-03-11 19:00:41.213653 MEMORY 2.544406528
after computing embeddings fwd
2024-03-11 19:00:49.316681 MEMORY 2.82998784
after computing embeddings rev
2024-03-11 19:01:00.361068 MEMORY 3.165196288
before computing sparse embeddings fwd
2024-03-11 19:01:00.361650 MEMORY 3.165196288
Constructing csr matrix...
csr matrix made in 0.8934445381164551 s
after computing sparse embeddings fwd
2024-03-11 19:01:01.756367 MEMORY 3.316199424
before computing sparse embeddings rev
2024-03-11 19:01:01.756434 MEMORY 3.316199424
Constructing csr matrix...
csr matrix made in 0.9031286239624023 s
after computing sparse embeddings rev
2024-03-11 19:01:03.144321 MEMORY 3.381403648
Finished embedding computation in 22.69 s
MEMORY 3.084918784
Starting affinity matrix computations
MEMORY 3.084394496
Batching in slices of size 8163
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:10<00:00, 10.29s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:10<00:00, 10.29s/it]
Finished affinity matrix computations in 10.33 s
MEMORY 3.116765184
(Round 2) Computed coarse affmat
2024-03-11 19:01:14.592720 MEMORY 2.883866624
(Round 2) Computing affinity matrix on nearest neighbors
2024-03-11 19:01:14.592855 MEMORY 2.883866624
Launching nearest neighbors affmat calculation job
MEMORY 2.88360448
Parallel runs completed
MEMORY 2.920660992
Job completed in: 13.56 s
MEMORY 2.920448
Launching nearest neighbors affmat calculation job
MEMORY 2.92032512
Parallel runs completed
MEMORY 2.96904704
Job completed in: 13.85 s
MEMORY 2.966933504
(Round 2) Computed affinity matrix on nearest neighbors in 29.32 s
2024-03-11 19:01:43.912885 MEMORY 2.96671232
Not applying filtering for rounds above first round
2024-03-11 19:01:43.913881 MEMORY 2.96671232
(Round 2) Computing density adapted affmat
2024-03-11 19:01:45.656050 MEMORY 2.993586176
Symmetrizing nearest neighbors
Computing betas for density adaptation
Computing normalizing denominators
(Round 2) Computing clustering
2024-03-11 19:02:57.947227 MEMORY 3.42091776
Beginning preprocessing + Leiden
2024-03-11 19:02:57.958755 MEMORY 3.42091776
Affmat transformed
2024-03-11 19:02:57.958871 MEMORY 3.42091776
sources, targets, weights extracted
2024-03-11 19:02:58.254352 MEMORY 3.42091776
About to launch parallel Leiden runs
2024-03-11 19:02:58.351061 MEMORY 3.42091776
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:   33.0s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:  1.7min finished
Parallel Leiden runs finished
2024-03-11 19:04:42.815070 MEMORY 3.421036544
Quality: 0.4520580155986935
Quality: 0.45206311272882044
Got 5 clusters after round 2
Counts:
{2: 1618, 1: 1670, 0: 2650, 4: 1007, 3: 1218}
2024-03-11 19:04:42.840965 MEMORY 3.421036544
(Round 2) Aggregating seqlets in each cluster
2024-03-11 19:04:42.841052 MEMORY 3.421036544
Aggregating for cluster 0 with 2650 seqlets
2024-03-11 19:04:42.843969 MEMORY 3.421036544
Skipped 7 due to duplicates
Trimming eliminated 0 seqlets out of 2643
Aggregating for cluster 1 with 1670 seqlets
2024-03-11 19:04:47.522902 MEMORY 3.421126656
Removed 1 duplicate seqlets
Skipped 9 due to duplicates
Trimming eliminated 0 seqlets out of 1660
Aggregating for cluster 2 with 1618 seqlets
2024-03-11 19:04:50.517817 MEMORY 3.421126656
Skipped 6 due to duplicates
Trimming eliminated 0 seqlets out of 1612
WARNING: Probabilities don't sum to 1 in all the rows; this can be caused by zero-padding. Will renormalize. PPM:
[[0.32630273 0.15384615 0.16501241 0.35421836]
 [0.3101737  0.1557072  0.18610422 0.34739454]
 [0.34057072 0.16811414 0.15756824 0.33312655]
 [0.34739454 0.1557072  0.17183623 0.32506203]
 [0.39330025 0.18114144 0.13337469 0.29218362]
 [0.38709677 0.18548387 0.17245658 0.25496278]
 [0.35794045 0.1898263  0.16811414 0.28411911]
 [0.5719603  0.13895782 0.15694789 0.132134  ]
 [0.59491315 0.20533499 0.06265509 0.13709677]
 [0.05210918 0.04094293 0.00992556 0.89702233]
 [0.00992556 0.01488834 0.00310174 0.97208437]
 [0.34801489 0.06761787 0.08188586 0.50248139]
 [0.84739454 0.02171216 0.07133995 0.05955335]
 [0.42493797 0.05024814 0.13523573 0.38957816]
 [0.27791563 0.16873449 0.24937965 0.30397022]
 [0.38895782 0.16997519 0.15942928 0.28163772]
 [0.32940447 0.18734491 0.17121588 0.31203474]
 [0.32444169 0.1792804  0.17183623 0.32444169]
 [0.30707196 0.19975186 0.15074442 0.34243176]
 [0.30148883 0.18734491 0.15012407 0.36042184]]
Probability sums:
[0.99937965 0.99937965 0.99937965 1.         1.         1.
 1.         1.         1.         1.         1.         1.
 1.         1.         1.         1.         1.         1.
 1.         0.99937965]
Aggregating for cluster 3 with 1218 seqlets
2024-03-11 19:04:53.167841 MEMORY 3.421126656
Skipped 7 due to duplicates
Trimming eliminated 0 seqlets out of 1211
Aggregating for cluster 4 with 1007 seqlets
2024-03-11 19:04:55.020678 MEMORY 3.421126656
Skipped 5 due to duplicates
Trimming eliminated 0 seqlets out of 1002
Got 5 clusters
Splitting into subclusters...
2024-03-11 19:04:56.975490 MEMORY 3.421126656
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 2643 out of 2643 | elapsed:    1.3s finished
Inspecting pattern 0 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 2643
[t-SNE] Computed conditional probabilities for sample 2000 / 2643
[t-SNE] Computed conditional probabilities for sample 2643 / 2643
[t-SNE] Mean sigma: 0.298890
Beginning preprocessing + Leiden
2024-03-11 19:05:00.939658 MEMORY 3.421609984
Affmat transformed
2024-03-11 19:05:00.969054 MEMORY 3.421609984
sources, targets, weights extracted
2024-03-11 19:05:00.990880 MEMORY 3.421609984
About to launch parallel Leiden runs
2024-03-11 19:05:01.027306 MEMORY 3.421609984
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    9.9s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   35.6s finished
Parallel Leiden runs finished
2024-03-11 19:05:36.661288 MEMORY 3.421609984
Quality: 0.45177140172774927
Got subclusters: Counter({0: 425, 1: 419, 2: 388, 3: 376, 4: 315, 5: 280, 6: 189, 7: 151, 8: 100})
On merging iteration 1
Numbers for each pattern pre-subsample: [425, 419, 388, 376, 315, 280, 189, 151, 100]
Numbers after subsampling: [300, 300, 300, 300, 300, 280, 189, 151, 100]
Computing sims for pattern 0
Computed sims for pattern 0 in 2.9139199256896973 s
Computing sims for pattern 1
Computed sims for pattern 1 in 2.9574437141418457 s
Computing sims for pattern 2
Computed sims for pattern 2 in 2.9557313919067383 s
Computing sims for pattern 3
Computed sims for pattern 3 in 3.485074520111084 s
Computing sims for pattern 4
Computed sims for pattern 4 in 3.095313549041748 s
Computing sims for pattern 5
Computed sims for pattern 5 in 2.759525775909424 s
Computing sims for pattern 6
Computed sims for pattern 6 in 2.196401357650757 s
Computing sims for pattern 7
Computed sims for pattern 7 in 1.7733731269836426 s
Computing sims for pattern 8
Computed sims for pattern 8 in 1.2899932861328125 s
Cluster sizes
[425 419 388 376 315 280 189 151 100]
Cross-contamination matrix:
[[1.   0.59 0.72 0.69 0.51 0.6  0.78 0.6  0.67]
 [0.84 1.   0.84 0.75 0.6  0.66 0.81 0.5  0.8 ]
 [0.78 0.64 1.   0.56 0.56 0.51 0.79 0.51 0.72]
 [0.82 0.63 0.63 1.   0.55 0.6  0.77 0.6  0.7 ]
 [0.78 0.62 0.78 0.68 1.   0.74 0.82 0.53 0.73]
 [0.73 0.54 0.57 0.59 0.59 1.   0.67 0.45 0.55]
 [0.72 0.5  0.67 0.58 0.49 0.49 1.   0.5  0.52]
 [0.94 0.62 0.79 0.82 0.63 0.67 0.9  1.   0.73]
 [0.77 0.65 0.76 0.66 0.57 0.54 0.67 0.49 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.88 0.94 0.88 0.81 0.84 0.92 0.9  0.89]
 [0.88 1.   0.88 0.79 0.72 0.83 0.84 0.76 0.85]
 [0.94 0.88 1.   0.78 0.8  0.8  0.91 0.85 0.89]
 [0.88 0.79 0.78 1.   0.76 0.77 0.82 0.84 0.83]
 [0.81 0.72 0.8  0.76 1.   0.79 0.78 0.76 0.83]
 [0.84 0.83 0.8  0.77 0.79 1.   0.77 0.72 0.8 ]
 [0.92 0.84 0.91 0.82 0.78 0.77 1.   0.84 0.83]
 [0.9  0.76 0.85 0.84 0.76 0.72 0.84 1.   0.8 ]
 [0.89 0.85 0.89 0.83 0.83 0.8  0.83 0.8  1.  ]]
Collapsing 0 & 2 with crosscontam 0.716763888888889 and sim 0.9397926797866829
Collapsing 0 & 6 with crosscontam 0.718927786761274 and sim 0.9212603206883985
Collapsing 2 & 6 with crosscontam 0.6698729379617374 and sim 0.9126129504158133
Collapsing 0 & 7 with crosscontam 0.5964573706156489 and sim 0.8954581094364816
Collapsing 0 & 8 with crosscontam 0.6728875807407406 and sim 0.8883047323932027
Collapsing 2 & 8 with crosscontam 0.7181499377777776 and sim 0.8875066751763012
Collapsing 0 & 3 with crosscontam 0.6854135407407407 and sim 0.8824686110410209
Collapsing 0 & 1 with crosscontam 0.5854829175308642 and sim 0.8818936709033067
Collapsing 1 & 2 with crosscontam 0.6422394197530863 and sim 0.8767501962554223
Collapsing 2 & 7 with crosscontam 0.5055543026735343 and sim 0.8525740851503338
Collapsing 1 & 8 with crosscontam 0.6453673466666665 and sim 0.8505733290103763
Trimming eliminated 0 seqlets out of 813
Removed 2 duplicate seqlets
Skipped 1 due to duplicates
Trimming eliminated 0 seqlets out of 999
Trimming eliminated 0 seqlets out of 1150
Trimming eliminated 0 seqlets out of 1250
Trimming eliminated 0 seqlets out of 1626
Removed 1 duplicate seqlets
Trimming eliminated 0 seqlets out of 2044
Unmerged patterns remapping: OrderedDict([(4, 1), (5, 2)])
Time spent on merging iteration: 11.924360036849976
On merging iteration 2
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 1660 out of 1660 | elapsed:    0.6s finished
Numbers for each pattern pre-subsample: [2044, 315, 280]
Numbers after subsampling: [300, 300, 280]
Computing sims for pattern 0
Computed sims for pattern 0 in 0.8206996917724609 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.40744662284851074 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.3847043514251709 s
Cluster sizes
[2044  315  280]
Cross-contamination matrix:
[[1.   0.83 0.85]
 [0.7  1.   0.74]
 [0.58 0.59 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.83 0.85]
 [0.83 1.   0.79]
 [0.85 0.79 1.  ]]
Inspecting pattern 1 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 1660
[t-SNE] Computed conditional probabilities for sample 1660 / 1660
[t-SNE] Mean sigma: 0.320334
Beginning preprocessing + Leiden
2024-03-11 19:06:15.368408 MEMORY 3.421618176
Affmat transformed
2024-03-11 19:06:15.387285 MEMORY 3.421618176
sources, targets, weights extracted
2024-03-11 19:06:15.400802 MEMORY 3.421618176
About to launch parallel Leiden runs
2024-03-11 19:06:15.438695 MEMORY 3.421618176
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    4.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   16.5s finished
Parallel Leiden runs finished
2024-03-11 19:06:31.935819 MEMORY 3.421618176
Quality: 0.4606431817535134
Quality: 0.46083918029531734
Quality: 0.4608497763975023
Quality: 0.462334825294056
Quality: 0.4625442124597225
Quality: 0.46316225679625134
Got subclusters: Counter({0: 392, 1: 280, 2: 258, 3: 252, 4: 189, 5: 141, 6: 100, 7: 46, 8: 2})
On merging iteration 1
Numbers for each pattern pre-subsample: [392, 280, 258, 252, 189, 141, 100, 46, 2]
Numbers after subsampling: [300, 280, 258, 252, 189, 141, 100, 46, 2]
Computing sims for pattern 0
Computed sims for pattern 0 in 2.638711452484131 s
Computing sims for pattern 1
Computed sims for pattern 1 in 2.519923686981201 s
Computing sims for pattern 2
Computed sims for pattern 2 in 2.2099368572235107 s
Computing sims for pattern 3
Computed sims for pattern 3 in 2.8456308841705322 s
Computing sims for pattern 4
Computed sims for pattern 4 in 1.9061756134033203 s
Computing sims for pattern 5
Computed sims for pattern 5 in 1.5447802543640137 s
Computing sims for pattern 6
Computed sims for pattern 6 in 1.080620527267456 s
Computing sims for pattern 7
Computed sims for pattern 7 in 0.6224081516265869 s
Computing sims for pattern 8
Computed sims for pattern 8 in 0.22735905647277832 s
Cluster sizes
[392 280 258 252 189 141 100  46   2]
Cross-contamination matrix:
[[1.   0.55 0.47 0.65 0.64 0.24 0.52 0.5  0.44]
 [0.81 1.   0.58 0.67 0.69 0.67 0.64 0.6  0.31]
 [0.75 0.62 1.   0.73 0.71 0.64 0.67 0.51 0.66]
 [0.8  0.57 0.59 1.   0.69 0.61 0.43 0.58 0.58]
 [0.85 0.67 0.63 0.75 1.   0.49 0.51 0.42 0.57]
 [0.46 0.72 0.65 0.76 0.57 1.   0.61 0.47 0.34]
 [0.7  0.66 0.4  0.55 0.55 0.45 1.   0.5  0.44]
 [0.67 0.49 0.43 0.61 0.4  0.38 0.59 1.   0.46]
 [0.   0.   0.   0.   0.   0.   0.   0.   1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.86 0.75 0.84 0.82 0.56 0.8  0.8  0.45]
 [0.86 1.   0.82 0.8  0.77 0.74 0.81 0.72 0.35]
 [0.75 0.82 1.   0.85 0.75 0.87 0.72 0.67 0.45]
 [0.84 0.8  0.85 1.   0.83 0.83 0.78 0.8  0.39]
 [0.82 0.77 0.75 0.83 1.   0.64 0.73 0.67 0.45]
 [0.56 0.74 0.87 0.83 0.64 1.   0.73 0.61 0.35]
 [0.8  0.81 0.72 0.78 0.73 0.73 1.   0.78 0.37]
 [0.8  0.72 0.67 0.8  0.67 0.61 0.78 1.   0.58]
 [0.45 0.35 0.45 0.39 0.45 0.35 0.37 0.58 1.  ]]
Collapsing 2 & 5 with crosscontam 0.637488426882991 and sim 0.866987733040494
Collapsing 0 & 1 with crosscontam 0.5453945010582011 and sim 0.8609264097654062
Collapsing 2 & 3 with crosscontam 0.5865612478032425 and sim 0.8506985748743273
Trimming eliminated 0 seqlets out of 399
Removed 1 duplicate seqlets
Trimming eliminated 0 seqlets out of 671
Trimming eliminated 0 seqlets out of 651
Unmerged patterns remapping: OrderedDict([(4, 2), (6, 3), (7, 4), (8, 5)])
Time spent on merging iteration: 2.799727439880371
On merging iteration 2
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 1612 out of 1612 | elapsed:    0.4s finished
Numbers for each pattern pre-subsample: [671, 651, 189, 100, 46, 2]
Numbers after subsampling: [300, 300, 189, 100, 46, 2]
Computing sims for pattern 0
Computed sims for pattern 0 in 1.6205425262451172 s
Computing sims for pattern 1
Computed sims for pattern 1 in 1.6669859886169434 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.6179437637329102 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.3621683120727539 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.22294998168945312 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.08351826667785645 s
Cluster sizes
[671 651 189 100  46   2]
Cross-contamination matrix:
[[1.   0.71 0.82 0.71 0.72 0.57]
 [0.88 1.   0.93 0.68 0.77 0.84]
 [0.7  0.65 1.   0.51 0.42 0.57]
 [0.53 0.48 0.55 1.   0.5  0.44]
 [0.57 0.47 0.4  0.59 1.   0.46]
 [0.   0.   0.   0.   0.   1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.84 0.8  0.78 0.8  0.43]
 [0.84 1.   0.79 0.78 0.75 0.43]
 [0.8  0.79 1.   0.73 0.67 0.45]
 [0.78 0.78 0.73 1.   0.78 0.37]
 [0.8  0.75 0.67 0.78 1.   0.58]
 [0.43 0.43 0.45 0.37 0.58 1.  ]]
Inspecting pattern 2 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 1612
[t-SNE] Computed conditional probabilities for sample 1612 / 1612
[t-SNE] Mean sigma: 0.317422
Beginning preprocessing + Leiden
2024-03-11 19:06:57.106207 MEMORY 3.421618176
Affmat transformed
2024-03-11 19:06:57.124436 MEMORY 3.421618176
sources, targets, weights extracted
2024-03-11 19:06:57.136678 MEMORY 3.421618176
About to launch parallel Leiden runs
2024-03-11 19:06:57.168086 MEMORY 3.421618176
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    4.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   18.0s finished
Parallel Leiden runs finished
2024-03-11 19:07:15.121655 MEMORY 3.421618176
Quality: 0.44479117440859345
Quality: 0.4451731899095253
Quality: 0.4457781043798422
Quality: 0.4459683870048507
Quality: 0.4461578724334338
Quality: 0.447086093012799
Quality: 0.44882836564296025
Got subclusters: Counter({0: 353, 1: 307, 2: 243, 3: 239, 4: 191, 5: 146, 6: 87, 7: 33, 8: 13})
On merging iteration 1
Numbers for each pattern pre-subsample: [353, 307, 243, 239, 191, 146, 87, 33, 13]
Numbers after subsampling: [300, 300, 243, 239, 191, 146, 87, 33, 13]
Computing sims for pattern 0
Computed sims for pattern 0 in 2.8642935752868652 s
Computing sims for pattern 1
Computed sims for pattern 1 in 2.9048516750335693 s
Computing sims for pattern 2
Computed sims for pattern 2 in 2.0364573001861572 s
Computing sims for pattern 3
Computed sims for pattern 3 in 2.747138738632202 s
Computing sims for pattern 4
Computed sims for pattern 4 in 2.105255365371704 s
Computing sims for pattern 5
Computed sims for pattern 5 in 1.5007846355438232 s
Computing sims for pattern 6
Computed sims for pattern 6 in 1.639632225036621 s
Computing sims for pattern 7
Computed sims for pattern 7 in 0.5266525745391846 s
Computing sims for pattern 8
Computed sims for pattern 8 in 0.33128809928894043 s
Cluster sizes
[353 307 243 239 191 146  87  33  13]
Cross-contamination matrix:
[[1.   0.41 0.58 0.3  0.6  0.66 0.52 0.51 0.4 ]
 [0.8  1.   0.69 0.78 0.67 0.81 0.62 0.57 0.6 ]
 [0.63 0.36 1.   0.56 0.73 0.59 0.45 0.65 0.57]
 [0.52 0.64 0.81 1.   0.83 0.74 0.6  0.4  0.74]
 [0.71 0.42 0.8  0.65 1.   0.54 0.6  0.6  0.61]
 [0.77 0.51 0.67 0.58 0.54 1.   0.59 0.5  0.47]
 [0.7  0.45 0.6  0.54 0.68 0.67 1.   0.49 0.54]
 [0.53 0.26 0.62 0.22 0.5  0.41 0.5  1.   0.31]
 [0.21 0.12 0.31 0.25 0.23 0.18 0.18 0.15 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.81 0.82 0.66 0.75 0.87 0.75 0.82 0.67]
 [0.81 1.   0.76 0.83 0.7  0.91 0.72 0.74 0.67]
 [0.82 0.76 1.   0.85 0.85 0.78 0.68 0.73 0.8 ]
 [0.66 0.83 0.85 1.   0.88 0.84 0.71 0.62 0.76]
 [0.75 0.7  0.85 0.88 1.   0.75 0.75 0.72 0.76]
 [0.87 0.91 0.78 0.84 0.75 1.   0.74 0.79 0.69]
 [0.75 0.72 0.68 0.71 0.75 0.74 1.   0.75 0.62]
 [0.82 0.74 0.73 0.62 0.72 0.79 0.75 1.   0.61]
 [0.67 0.67 0.8  0.76 0.76 0.69 0.62 0.61 1.  ]]
Collapsing 1 & 5 with crosscontam 0.5123457715215534 and sim 0.9102581398575922
Collapsing 3 & 4 with crosscontam 0.6525327487745396 and sim 0.8811954249007143
Collapsing 0 & 5 with crosscontam 0.6578380497209539 and sim 0.8727206508548553
Collapsing 2 & 3 with crosscontam 0.5643413786261906 and sim 0.8524400167719918
Trimming eliminated 0 seqlets out of 453
Trimming eliminated 0 seqlets out of 430
Trimming eliminated 0 seqlets out of 806
WARNING: Probabilities don't sum to 1 in all the rows; this can be caused by zero-padding. Will renormalize. PPM:
[[0.3101737  0.17121588 0.1662531  0.35111663]
 [0.32258065 0.15136476 0.17121588 0.35359801]
 [0.35359801 0.17990074 0.14764268 0.31761787]
 [0.33746898 0.1426799  0.16253102 0.3573201 ]
 [0.39702233 0.1662531  0.13275434 0.30397022]
 [0.35359801 0.20719603 0.13027295 0.308933  ]
 [0.34367246 0.21588089 0.15632754 0.28411911]
 [0.58808933 0.12531017 0.15508685 0.13151365]
 [0.49255583 0.27667494 0.04342432 0.18734491]
 [0.07568238 0.05459057 0.01612903 0.85359801]
 [0.00248139 0.00372208 0.00372208 0.99007444]
 [0.0955335  0.08188586 0.05086849 0.77171216]
 [0.78411911 0.04094293 0.11166253 0.06327543]
 [0.48883375 0.05210918 0.14019851 0.31885856]
 [0.29900744 0.15384615 0.22952854 0.31761787]
 [0.37593052 0.17245658 0.16997519 0.28163772]
 [0.33746898 0.16501241 0.16129032 0.33622829]
 [0.34119107 0.16501241 0.15880893 0.33498759]
 [0.30272953 0.18610422 0.14764268 0.36352357]
 [0.29900744 0.1662531  0.17245658 0.36104218]
 [0.30645161 0.16377171 0.15136476 0.37717122]
 [0.33498759 0.15384615 0.15260546 0.3573201 ]]
Probability sums:
[0.99875931 0.99875931 0.99875931 1.         1.         1.
 1.         1.         1.         1.         1.         1.
 1.         1.         1.         1.         1.         1.
 1.         0.99875931 0.99875931 0.99875931]
Skipped 1 due to duplicates
Trimming eliminated 0 seqlets out of 672
Unmerged patterns remapping: OrderedDict([(6, 2), (7, 3), (8, 4)])
Time spent on merging iteration: 4.300426721572876
On merging iteration 2
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 1164 out of 1211 | elapsed:    0.2s remaining:    0.0s
[Parallel(n_jobs=24)]: Done 1211 out of 1211 | elapsed:    0.2s finished
Numbers for each pattern pre-subsample: [806, 672, 87, 33, 13]
Numbers after subsampling: [300, 300, 87, 33, 13]
Computing sims for pattern 0
Computed sims for pattern 0 in 1.368762731552124 s
Computing sims for pattern 1
Computed sims for pattern 1 in 1.3277173042297363 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.34648633003234863 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.16633272171020508 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.11180973052978516 s
Cluster sizes
[806 672  87  33  13]
Cross-contamination matrix:
[[1.   0.84 0.81 0.79 0.76]
 [0.75 1.   0.75 0.56 0.87]
 [0.57 0.6  1.   0.49 0.54]
 [0.39 0.28 0.5  1.   0.31]
 [0.17 0.28 0.18 0.15 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.84 0.77 0.82 0.72]
 [0.84 1.   0.75 0.67 0.8 ]
 [0.77 0.75 1.   0.75 0.62]
 [0.82 0.67 0.75 1.   0.61]
 [0.72 0.8  0.62 0.61 1.  ]]
Inspecting pattern 3 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 1211
[t-SNE] Computed conditional probabilities for sample 1211 / 1211
[t-SNE] Mean sigma: 0.309438
Beginning preprocessing + Leiden
2024-03-11 19:07:40.988516 MEMORY 3.421618176
Affmat transformed
2024-03-11 19:07:41.002842 MEMORY 3.421618176
sources, targets, weights extracted
2024-03-11 19:07:41.012663 MEMORY 3.421618176
About to launch parallel Leiden runs
2024-03-11 19:07:41.033321 MEMORY 3.421618176
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    3.1s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   11.2s finished
Parallel Leiden runs finished
2024-03-11 19:07:52.203165 MEMORY 3.421618176
Quality: 0.4346257035818648
Quality: 0.43506900360508044
Quality: 0.43512759569375103
Quality: 0.43648210897730927
Got subclusters: Counter({0: 220, 1: 186, 2: 184, 3: 164, 4: 137, 5: 123, 6: 111, 7: 86})
On merging iteration 1
Numbers for each pattern pre-subsample: [220, 186, 184, 164, 137, 123, 111, 86]
Numbers after subsampling: [220, 186, 184, 164, 137, 123, 111, 86]
Computing sims for pattern 0
Computed sims for pattern 0 in 2.119020700454712 s
Computing sims for pattern 1
Computed sims for pattern 1 in 1.6883504390716553 s
Computing sims for pattern 2
Computed sims for pattern 2 in 1.656569004058838 s
Computing sims for pattern 3
Computed sims for pattern 3 in 1.478421688079834 s
Computing sims for pattern 4
Computed sims for pattern 4 in 1.3532593250274658 s
Computing sims for pattern 5
Computed sims for pattern 5 in 1.1832189559936523 s
Computing sims for pattern 6
Computed sims for pattern 6 in 1.5465619564056396 s
Computing sims for pattern 7
Computed sims for pattern 7 in 0.9383409023284912 s
Cluster sizes
[220 186 184 164 137 123 111  86]
Cross-contamination matrix:
[[1.   0.74 0.75 0.87 0.62 0.88 0.48 0.73]
 [0.31 1.   0.69 0.75 0.51 0.42 0.46 0.42]
 [0.39 0.76 1.   0.72 0.56 0.49 0.61 0.38]
 [0.44 0.81 0.7  1.   0.52 0.62 0.54 0.55]
 [0.48 0.82 0.78 0.77 1.   0.63 0.66 0.62]
 [0.67 0.69 0.68 0.86 0.6  1.   0.52 0.63]
 [0.39 0.78 0.86 0.82 0.69 0.58 1.   0.38]
 [0.64 0.78 0.63 0.87 0.69 0.73 0.42 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.77 0.76 0.82 0.75 0.88 0.64 0.91]
 [0.77 1.   0.89 0.92 0.84 0.78 0.81 0.84]
 [0.76 0.89 1.   0.88 0.85 0.78 0.83 0.81]
 [0.82 0.92 0.88 1.   0.83 0.88 0.85 0.89]
 [0.75 0.84 0.85 0.83 1.   0.77 0.78 0.81]
 [0.88 0.78 0.78 0.88 0.77 1.   0.72 0.86]
 [0.64 0.81 0.83 0.85 0.78 0.72 1.   0.71]
 [0.91 0.84 0.81 0.89 0.81 0.86 0.71 1.  ]]
Collapsing 1 & 3 with crosscontam 0.7480105226907952 and sim 0.9228713348307007
Collapsing 0 & 7 with crosscontam 0.6396457658959702 and sim 0.9119991865729995
Collapsing 1 & 2 with crosscontam 0.6928809825466313 and sim 0.8911771277103515
Collapsing 3 & 7 with crosscontam 0.5479736890366218 and sim 0.8910125252744612
Collapsing 2 & 3 with crosscontam 0.6951646217660672 and sim 0.8839782459798213
Collapsing 3 & 5 with crosscontam 0.6211269504038031 and sim 0.8821957304973191
Collapsing 0 & 5 with crosscontam 0.6716011602998153 and sim 0.8762951065685665
Collapsing 5 & 7 with crosscontam 0.6277728932079061 and sim 0.8638640404250623
Trimming eliminated 0 seqlets out of 350
Trimming eliminated 0 seqlets out of 306
Trimming eliminated 0 seqlets out of 534
Trimming eliminated 0 seqlets out of 840
Removed 1 duplicate seqlets
Trimming eliminated 0 seqlets out of 962
Unmerged patterns remapping: OrderedDict([(4, 1), (6, 2)])
Time spent on merging iteration: 5.397212743759155
On merging iteration 2
Numbers for each pattern pre-subsample: [962, 137, 111]
Numbers after subsampling: [300, 137, 111]
Computing sims for pattern 0
Computed sims for pattern 0 in 0.6881270408630371 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.22907209396362305 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.1789264678955078 s
Cluster sizes
[962 137 111]
Cross-contamination matrix:
[[1.   0.91 0.86]
 [0.67 1.   0.66]
 [0.65 0.69 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.88 0.82]
 [0.88 1.   0.78]
 [0.82 0.78 1.  ]]
Collapsing 0 & 1 with crosscontam 0.6712891928879465 and sim 0.8754788910075202
Removed 1 duplicate seqlets
Trimming eliminated 0 seqlets out of 1098
Unmerged patterns remapping: OrderedDict([(2, 1)])
Time spent on merging iteration: 1.6578452587127686
On merging iteration 3
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 930 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 1002 out of 1002 | elapsed:    0.2s finished
Numbers for each pattern pre-subsample: [1098, 111]
Numbers after subsampling: [300, 111]
Computing sims for pattern 0
Computed sims for pattern 0 in 1.0910439491271973 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.18105340003967285 s
Cluster sizes
[1098  111]
Cross-contamination matrix:
[[1.   0.85]
 [0.65 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.83]
 [0.83 1.  ]]
Inspecting pattern 4 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 1002
[t-SNE] Computed conditional probabilities for sample 1002 / 1002
[t-SNE] Mean sigma: 0.337250
Beginning preprocessing + Leiden
2024-03-11 19:08:14.148658 MEMORY 3.421618176
Affmat transformed
2024-03-11 19:08:14.160409 MEMORY 3.421618176
sources, targets, weights extracted
2024-03-11 19:08:14.167741 MEMORY 3.421618176
About to launch parallel Leiden runs
2024-03-11 19:08:14.204837 MEMORY 3.421618176
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    2.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    7.4s finished
Parallel Leiden runs finished
2024-03-11 19:08:21.567243 MEMORY 3.421618176
Quality: 0.43316446688680327
Quality: 0.4337465395360287
Quality: 0.43397731611646245
Quality: 0.43414801688217974
Quality: 0.43424575685256955
Quality: 0.4347662332375476
Got subclusters: Counter({0: 154, 1: 153, 2: 141, 3: 132, 4: 118, 5: 92, 6: 87, 7: 72, 8: 53})
On merging iteration 1
Numbers for each pattern pre-subsample: [154, 153, 141, 132, 118, 92, 87, 72, 53]
Numbers after subsampling: [154, 153, 141, 132, 118, 92, 87, 72, 53]
Computing sims for pattern 0
Computed sims for pattern 0 in 1.3634865283966064 s
Computing sims for pattern 1
Computed sims for pattern 1 in 1.3712522983551025 s
Computing sims for pattern 2
Computed sims for pattern 2 in 1.463979721069336 s
Computing sims for pattern 3
Computed sims for pattern 3 in 1.251356601715088 s
Computing sims for pattern 4
Computed sims for pattern 4 in 1.1707849502563477 s
Computing sims for pattern 5
Computed sims for pattern 5 in 1.0825786590576172 s
Computing sims for pattern 6
Computed sims for pattern 6 in 1.0353765487670898 s
Computing sims for pattern 7
Computed sims for pattern 7 in 0.8837685585021973 s
Computing sims for pattern 8
Computed sims for pattern 8 in 0.6444931030273438 s
Cluster sizes
[154 153 141 132 118  92  87  72  53]
Cross-contamination matrix:
[[1.   0.6  0.41 0.64 0.38 0.71 0.26 0.65 0.47]
 [0.72 1.   0.42 0.6  0.67 0.63 0.48 0.64 0.48]
 [0.65 0.56 1.   0.69 0.75 0.71 0.52 0.65 0.47]
 [0.67 0.63 0.57 1.   0.79 0.7  0.55 0.69 0.58]
 [0.41 0.57 0.5  0.65 1.   0.67 0.54 0.71 0.47]
 [0.73 0.57 0.51 0.62 0.71 1.   0.43 0.58 0.49]
 [0.55 0.68 0.58 0.71 0.83 0.66 1.   0.78 0.6 ]
 [0.57 0.48 0.36 0.5  0.64 0.48 0.43 1.   0.34]
 [0.66 0.61 0.45 0.66 0.69 0.65 0.51 0.44 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.87 0.71 0.84 0.71 0.84 0.68 0.75 0.83]
 [0.87 1.   0.73 0.83 0.84 0.81 0.79 0.77 0.79]
 [0.71 0.73 1.   0.78 0.83 0.8  0.7  0.67 0.64]
 [0.84 0.83 0.78 1.   0.88 0.83 0.72 0.77 0.72]
 [0.71 0.84 0.83 0.88 1.   0.81 0.81 0.82 0.72]
 [0.84 0.81 0.8  0.83 0.81 1.   0.71 0.7  0.7 ]
 [0.68 0.79 0.7  0.72 0.81 0.71 1.   0.65 0.69]
 [0.75 0.77 0.67 0.77 0.82 0.7  0.65 1.   0.63]
 [0.83 0.79 0.64 0.72 0.72 0.7  0.69 0.63 1.  ]]
Collapsing 3 & 4 with crosscontam 0.6517445500240724 and sim 0.8814622276205828
Collapsing 0 & 1 with crosscontam 0.5976155264796343 and sim 0.8699897176866316
Skipped 1 due to duplicates
Trimming eliminated 0 seqlets out of 249
Trimming eliminated 0 seqlets out of 307
Unmerged patterns remapping: OrderedDict([(2, 2), (5, 3), (6, 4), (7, 5), (8, 6)])
Time spent on merging iteration: 1.5963923931121826
On merging iteration 2
Numbers for each pattern pre-subsample: [307, 249, 141, 92, 87, 72, 53]
Numbers after subsampling: [300, 249, 141, 92, 87, 72, 53]
Computing sims for pattern 0
Computed sims for pattern 0 in 2.0242040157318115 s
Computing sims for pattern 1
Computed sims for pattern 1 in 1.51759934425354 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.4521031379699707 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.3561546802520752 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.33913683891296387 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.2885091304779053 s
Computing sims for pattern 6
Computed sims for pattern 6 in 0.868300199508667 s
Cluster sizes
[307 249 141  92  87  72  53]
Cross-contamination matrix:
[[1.   0.7  0.51 0.79 0.51 0.71 0.64]
 [0.82 1.   0.74 0.95 0.73 0.86 0.76]
 [0.56 0.68 1.   0.71 0.52 0.65 0.47]
 [0.59 0.63 0.51 1.   0.43 0.58 0.49]
 [0.61 0.71 0.58 0.66 1.   0.78 0.6 ]
 [0.5  0.52 0.36 0.48 0.43 1.   0.34]
 [0.64 0.62 0.45 0.65 0.51 0.44 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.86 0.72 0.83 0.76 0.79 0.79]
 [0.86 1.   0.82 0.89 0.76 0.78 0.73]
 [0.72 0.82 1.   0.8  0.7  0.67 0.64]
 [0.83 0.89 0.8  1.   0.71 0.7  0.7 ]
 [0.76 0.76 0.7  0.71 1.   0.65 0.69]
 [0.79 0.78 0.67 0.7  0.65 1.   0.63]
 [0.79 0.73 0.64 0.7  0.69 0.63 1.  ]]
Collapsing 1 & 3 with crosscontam 0.6280731539621129 and sim 0.8893744456422172
Collapsing 0 & 1 with crosscontam 0.6974990254350735 and sim 0.8566481616705244
Trimming eliminated 0 seqlets out of 341
Skipped 1 due to duplicates
Trimming eliminated 0 seqlets out of 647
Unmerged patterns remapping: OrderedDict([(2, 1), (4, 2), (5, 3), (6, 4)])
Time spent on merging iteration: 2.708383560180664
On merging iteration 3
Numbers for each pattern pre-subsample: [647, 141, 87, 72, 53]
Numbers after subsampling: [300, 141, 87, 72, 53]
Computing sims for pattern 0
Computed sims for pattern 0 in 1.3545103073120117 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.2382793426513672 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.17301416397094727 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.1424109935760498 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.11960983276367188 s
Cluster sizes
[647 141  87  72  53]
Cross-contamination matrix:
[[1.   0.84 0.8  0.93 0.84]
 [0.67 1.   0.52 0.65 0.47]
 [0.69 0.58 1.   0.78 0.6 ]
 [0.47 0.36 0.43 1.   0.34]
 [0.64 0.45 0.51 0.44 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.86 0.82 0.8  0.8 ]
 [0.86 1.   0.7  0.67 0.64]
 [0.82 0.7  1.   0.65 0.69]
 [0.8  0.67 0.65 1.   0.63]
 [0.8  0.64 0.69 0.63 1.  ]]
Collapsing 0 & 1 with crosscontam 0.667836658853036 and sim 0.8563674137371523
Trimming eliminated 0 seqlets out of 788
Unmerged patterns remapping: OrderedDict([(2, 1), (3, 2), (4, 3)])
Time spent on merging iteration: 1.8362209796905518
On merging iteration 4
Numbers for each pattern pre-subsample: [788, 87, 72, 53]
Numbers after subsampling: [300, 87, 72, 53]
Computing sims for pattern 0
Computed sims for pattern 0 in 0.9785425662994385 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.16607451438903809 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.14711284637451172 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.11419415473937988 s
Cluster sizes
[788  87  72  53]
Cross-contamination matrix:
[[1.   0.83 0.96 0.87]
 [0.67 1.   0.78 0.6 ]
 [0.45 0.43 1.   0.34]
 [0.61 0.51 0.44 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.82 0.8  0.79]
 [0.82 1.   0.65 0.69]
 [0.8  0.65 1.   0.63]
 [0.79 0.69 0.63 1.  ]]
Merging on 20 clusters
2024-03-11 19:08:45.915461 MEMORY 3.421618176
On merging iteration 1
Numbers for each pattern pre-subsample: [2044, 315, 280, 671, 651, 189, 100, 46, 2, 806, 672, 87, 33, 13, 1098, 111, 788, 87, 72, 53]
Numbers after subsampling: [300, 300, 280, 300, 300, 189, 100, 46, 2, 300, 300, 87, 33, 13, 300, 111, 300, 87, 72, 53]
Computing sims for pattern 0
Computed sims for pattern 0 in 6.844273567199707 s
Computing sims for pattern 1
Computed sims for pattern 1 in 6.859047889709473 s
Computing sims for pattern 2
Computed sims for pattern 2 in 6.693593263626099 s
Computing sims for pattern 3
Computed sims for pattern 3 in 6.870123386383057 s
Computing sims for pattern 4
Computed sims for pattern 4 in 7.064310789108276 s
Computing sims for pattern 5
Computed sims for pattern 5 in 4.720383644104004 s
Computing sims for pattern 6
Computed sims for pattern 6 in 3.14292049407959 s
Computing sims for pattern 7
Computed sims for pattern 7 in 1.439579963684082 s
Computing sims for pattern 8
Computed sims for pattern 8 in 0.51068115234375 s
Computing sims for pattern 9
Computed sims for pattern 9 in 6.967165470123291 s
Computing sims for pattern 10
Computed sims for pattern 10 in 6.94176173210144 s
Computing sims for pattern 11
Computed sims for pattern 11 in 2.6399335861206055 s
Computing sims for pattern 12
Computed sims for pattern 12 in 1.6725091934204102 s
Computing sims for pattern 13
Computed sims for pattern 13 in 0.7280752658843994 s
Computing sims for pattern 14
Computed sims for pattern 14 in 6.86187481880188 s
Computing sims for pattern 15
Computed sims for pattern 15 in 2.881572723388672 s
Computing sims for pattern 16
Computed sims for pattern 16 in 6.863710641860962 s
Computing sims for pattern 17
Computed sims for pattern 17 in 2.812086820602417 s
Computing sims for pattern 18
Computed sims for pattern 18 in 2.7854652404785156 s
Computing sims for pattern 19
Computed sims for pattern 19 in 1.7233302593231201 s
Cluster sizes
[2044  315  280  671  651  189  100   46    2  806  672   87   33   13
 1098  111  788   87   72   53]
Cross-contamination matrix:
[[1.   0.83 0.85 0.26 0.25 0.47 0.39 0.24 0.37 0.17 0.23 0.43 0.31 0.2
  0.82 0.61 0.29 0.39 0.32 0.46]
 [0.7  1.   0.74 0.09 0.1  0.32 0.22 0.09 0.51 0.17 0.16 0.28 0.09 0.26
  0.72 0.53 0.19 0.32 0.21 0.27]
 [0.58 0.59 1.   0.05 0.12 0.16 0.2  0.08 0.61 0.02 0.08 0.12 0.06 0.15
  0.31 0.17 0.09 0.24 0.03 0.26]
 [0.18 0.11 0.09 1.   0.71 0.82 0.71 0.72 0.57 0.68 0.49 0.51 0.52 0.57
  0.21 0.16 0.49 0.41 0.61 0.37]
 [0.17 0.18 0.25 0.88 1.   0.93 0.68 0.77 0.84 0.69 0.51 0.61 0.52 0.49
  0.21 0.21 0.68 0.57 0.82 0.57]
 [0.28 0.28 0.1  0.7  0.65 1.   0.51 0.42 0.57 0.45 0.32 0.43 0.57 0.35
  0.51 0.32 0.25 0.13 0.41 0.15]
 [0.24 0.19 0.23 0.53 0.48 0.55 1.   0.5  0.44 0.44 0.36 0.29 0.51 0.36
  0.12 0.19 0.28 0.24 0.41 0.19]
 [0.12 0.08 0.07 0.57 0.47 0.4  0.59 1.   0.46 0.34 0.36 0.27 0.48 0.3
  0.12 0.11 0.23 0.23 0.29 0.14]
 [0.   0.   0.   0.   0.   0.   0.   0.   1.   0.   0.   0.   0.   0.
  0.   0.   0.   0.   0.   0.  ]
 [0.16 0.27 0.06 0.81 0.67 0.66 0.59 0.55 0.58 1.   0.84 0.81 0.79 0.76
  0.2  0.32 0.68 0.54 0.68 0.53]
 [0.18 0.18 0.13 0.53 0.4  0.45 0.43 0.5  0.31 0.75 1.   0.75 0.56 0.87
  0.18 0.47 0.52 0.51 0.53 0.42]
 [0.27 0.23 0.15 0.43 0.4  0.46 0.27 0.3  0.38 0.57 0.6  1.   0.49 0.54
  0.31 0.32 0.46 0.41 0.39 0.34]
 [0.08 0.03 0.04 0.27 0.18 0.42 0.34 0.38 0.1  0.39 0.28 0.5  1.   0.31
  0.19 0.29 0.12 0.08 0.35 0.08]
 [0.01 0.05 0.03 0.15 0.06 0.08 0.08 0.09 0.51 0.17 0.28 0.18 0.15 1.
  0.01 0.06 0.09 0.09 0.07 0.15]
 [0.65 0.69 0.41 0.2  0.13 0.56 0.14 0.15 0.24 0.14 0.15 0.38 0.4  0.13
  1.   0.85 0.11 0.36 0.38 0.07]
 [0.29 0.34 0.14 0.08 0.06 0.24 0.1  0.09 0.25 0.13 0.28 0.14 0.35 0.23
  0.65 1.   0.04 0.4  0.46 0.12]
 [0.34 0.36 0.27 0.68 0.71 0.47 0.46 0.49 0.49 0.75 0.69 0.78 0.45 0.72
  0.22 0.18 1.   0.83 0.96 0.87]
 [0.32 0.37 0.39 0.45 0.48 0.36 0.34 0.36 0.27 0.45 0.53 0.54 0.23 0.56
  0.45 0.67 0.67 1.   0.78 0.6 ]
 [0.09 0.1  0.02 0.29 0.31 0.27 0.19 0.14 0.3  0.3  0.3  0.29 0.33 0.16
  0.19 0.21 0.45 0.43 1.   0.34]
 [0.26 0.21 0.27 0.39 0.4  0.19 0.19 0.19 0.76 0.39 0.38 0.42 0.2  0.66
  0.05 0.18 0.61 0.51 0.44 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.83 0.85 0.32 0.24 0.46 0.43 0.25 0.43 0.33 0.24 0.46 0.36 0.29
  0.8  0.56 0.32 0.44 0.26 0.46]
 [0.83 1.   0.79 0.19 0.24 0.31 0.32 0.2  0.53 0.34 0.27 0.36 0.3  0.26
  0.77 0.52 0.39 0.48 0.29 0.45]
 [0.85 0.79 1.   0.1  0.25 0.2  0.46 0.18 0.51 0.07 0.08 0.17 0.12 0.26
  0.56 0.37 0.13 0.37 0.06 0.45]
 [0.32 0.19 0.1  1.   0.84 0.8  0.78 0.8  0.43 0.83 0.63 0.63 0.68 0.65
  0.38 0.32 0.72 0.66 0.69 0.64]
 [0.24 0.24 0.25 0.84 1.   0.79 0.78 0.75 0.43 0.77 0.64 0.59 0.61 0.55
  0.31 0.31 0.8  0.74 0.75 0.7 ]
 [0.46 0.31 0.2  0.8  0.79 1.   0.73 0.67 0.45 0.68 0.53 0.65 0.75 0.57
  0.65 0.51 0.58 0.45 0.58 0.48]
 [0.43 0.32 0.46 0.78 0.78 0.73 1.   0.78 0.37 0.67 0.57 0.47 0.59 0.6
  0.28 0.24 0.59 0.46 0.53 0.5 ]
 [0.25 0.2  0.18 0.8  0.75 0.67 0.78 1.   0.58 0.63 0.61 0.48 0.67 0.52
  0.29 0.3  0.57 0.54 0.49 0.51]
 [0.43 0.53 0.51 0.43 0.43 0.45 0.37 0.58 1.   0.42 0.3  0.38 0.41 0.51
  0.39 0.39 0.44 0.39 0.43 0.71]
 [0.33 0.34 0.07 0.83 0.77 0.68 0.67 0.63 0.42 1.   0.84 0.77 0.82 0.72
  0.42 0.56 0.82 0.74 0.67 0.65]
 [0.24 0.27 0.08 0.63 0.64 0.53 0.57 0.61 0.3  0.84 1.   0.75 0.67 0.8
  0.29 0.66 0.7  0.7  0.55 0.58]
 [0.46 0.36 0.17 0.63 0.59 0.65 0.47 0.48 0.38 0.77 0.75 1.   0.75 0.62
  0.51 0.48 0.72 0.65 0.52 0.56]
 [0.36 0.3  0.12 0.68 0.61 0.75 0.59 0.67 0.41 0.82 0.67 0.75 1.   0.61
  0.55 0.66 0.54 0.48 0.51 0.43]
 [0.29 0.26 0.26 0.65 0.55 0.57 0.6  0.52 0.51 0.72 0.8  0.62 0.61 1.
  0.32 0.51 0.65 0.65 0.46 0.66]
 [0.8  0.77 0.56 0.38 0.31 0.65 0.28 0.29 0.39 0.42 0.29 0.51 0.55 0.32
  1.   0.83 0.4  0.47 0.44 0.23]
 [0.56 0.52 0.37 0.32 0.31 0.51 0.24 0.3  0.39 0.56 0.66 0.48 0.66 0.51
  0.83 1.   0.4  0.58 0.53 0.3 ]
 [0.32 0.39 0.13 0.72 0.8  0.58 0.59 0.57 0.44 0.82 0.7  0.72 0.54 0.65
  0.4  0.4  1.   0.82 0.8  0.79]
 [0.44 0.48 0.37 0.66 0.74 0.45 0.46 0.54 0.39 0.74 0.7  0.65 0.48 0.65
  0.47 0.58 0.82 1.   0.65 0.69]
 [0.26 0.29 0.06 0.69 0.75 0.58 0.53 0.49 0.43 0.67 0.55 0.52 0.51 0.46
  0.44 0.53 0.8  0.65 1.   0.63]
 [0.46 0.45 0.45 0.64 0.7  0.48 0.5  0.51 0.71 0.65 0.58 0.56 0.43 0.66
  0.23 0.3  0.79 0.69 0.63 1.  ]]
Got 20 patterns after merging
2024-03-11 19:10:13.961239 MEMORY 3.421618176
Performing filtering
2024-03-11 19:10:13.961490 MEMORY 3.421618176
Got 18 patterns after filtering
2024-03-11 19:10:15.013647 MEMORY 3.421618176
Total time taken is 1076.21s
2024-03-11 19:10:15.013794 MEMORY 3.421618176
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 2044 out of 2044 | elapsed:    0.8s finished
/ru-auth/local/home/lzhao/anaconda3/envs/jupyter-ml-clone/lib/python3.9/site-packages/sklearn/manifold/_t_sne.py:691: FutureWarning: 'square_distances' has been introduced in 0.24 to help phase out legacy squaring behavior. The 'legacy' setting will be removed in 1.1 (renaming of 0.26), and the default setting will be changed to True. In 1.3, 'square_distances' will be removed altogether, and distances will be squared by default. Set 'square_distances'=True to silence this warning.
  warnings.warn(
/ru-auth/local/home/lzhao/anaconda3/envs/jupyter-ml-clone/lib/python3.9/site-packages/sklearn/neighbors/_base.py:175: EfficiencyWarning: Precomputed sparse input was not sorted by data.
  warnings.warn('Precomputed sparse input was not sorted by data.',
Applying subclustering to the final motifs
On pattern 0
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 2044 samples in 0.013s...
[t-SNE] Computed neighbors for 2044 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 1000 / 2044
[t-SNE] Computed conditional probabilities for sample 2000 / 2044
[t-SNE] Computed conditional probabilities for sample 2044 / 2044
[t-SNE] Mean sigma: 0.301079
[t-SNE] Computed conditional probabilities in 0.137s
[t-SNE] Iteration 50: error = 70.5107880, gradient norm = 0.1044182 (50 iterations in 0.167s)
[t-SNE] Iteration 100: error = 70.6082458, gradient norm = 0.1150537 (50 iterations in 0.172s)
[t-SNE] Iteration 150: error = 70.6849442, gradient norm = 0.0986895 (50 iterations in 0.173s)
[t-SNE] Iteration 200: error = 70.7110596, gradient norm = 0.0937201 (50 iterations in 0.176s)
[t-SNE] Iteration 250: error = 70.8178406, gradient norm = 0.1077368 (50 iterations in 0.169s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 70.817841
[t-SNE] Iteration 300: error = 2.4062624, gradient norm = 0.0013141 (50 iterations in 0.196s)
[t-SNE] Iteration 350: error = 2.3166635, gradient norm = 0.0004562 (50 iterations in 0.219s)
[t-SNE] Iteration 400: error = 2.2739403, gradient norm = 0.0002684 (50 iterations in 0.146s)
[t-SNE] Iteration 450: error = 2.2530711, gradient norm = 0.0001855 (50 iterations in 0.151s)
[t-SNE] Iteration 500: error = 2.2419882, gradient norm = 0.0001262 (50 iterations in 0.148s)
[t-SNE] Iteration 550: error = 2.2348676, gradient norm = 0.0001161 (50 iterations in 0.154s)
[t-SNE] Iteration 600: error = 2.2315495, gradient norm = 0.0000869 (50 iterations in 0.149s)
[t-SNE] Iteration 650: error = 2.2287681, gradient norm = 0.0000703 (50 iterations in 0.152s)
[t-SNE] Iteration 700: error = 2.2263892, gradient norm = 0.0000711 (50 iterations in 0.152s)
[t-SNE] Iteration 750: error = 2.2249560, gradient norm = 0.0000567 (50 iterations in 0.149s)
[t-SNE] Iteration 800: error = 2.2233250, gradient norm = 0.0000750 (50 iterations in 0.151s)
[t-SNE] Iteration 850: error = 2.2226422, gradient norm = 0.0000420 (50 iterations in 0.149s)
[t-SNE] Iteration 900: error = 2.2215195, gradient norm = 0.0000407 (50 iterations in 0.148s)
[t-SNE] Iteration 950: error = 2.2205195, gradient norm = 0.0000394 (50 iterations in 0.150s)
[t-SNE] Iteration 1000: error = 2.2197247, gradient norm = 0.0000334 (50 iterations in 0.148s)
[t-SNE] KL divergence after 1000 iterations: 2.219725
[t-SNE] Computed conditional probabilities for sample 1000 / 2044
[t-SNE] Computed conditional probabilities for sample 2000 / 2044
[t-SNE] Computed conditional probabilities for sample 2044 / 2044
[t-SNE] Mean sigma: 0.301079
Beginning preprocessing + Leiden
2024-03-11 19:10:21.299557 MEMORY 3.421618176
Affmat transformed
2024-03-11 19:10:21.322087 MEMORY 3.421618176
sources, targets, weights extracted
2024-03-11 19:10:21.339583 MEMORY 3.421618176
About to launch parallel Leiden runs
2024-03-11 19:10:21.365359 MEMORY 3.421618176
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    7.1s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   23.6s finished
Parallel Leiden runs finished
2024-03-11 19:10:44.936645 MEMORY 3.421618176
Quality: 0.43543926235832975
Quality: 0.43680751755371855
Quality: 0.43763713446949815
Quality: 0.43880998668628407
Quality: 0.4393042455815813
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 930 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 1098 out of 1098 | elapsed:    0.3s finished
Got subclusters: Counter({0: 338, 1: 328, 2: 310, 3: 300, 4: 224, 5: 186, 6: 161, 7: 141, 8: 56})
On pattern 1
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 1098 samples in 0.007s...
[t-SNE] Computed neighbors for 1098 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 1000 / 1098
[t-SNE] Computed conditional probabilities for sample 1098 / 1098
[t-SNE] Mean sigma: 0.311102
[t-SNE] Computed conditional probabilities in 0.073s
[t-SNE] Iteration 50: error = 67.8219223, gradient norm = 0.2873567 (50 iterations in 0.095s)
[t-SNE] Iteration 100: error = 67.6967010, gradient norm = 0.2777250 (50 iterations in 0.097s)
[t-SNE] Iteration 150: error = 68.7434311, gradient norm = 0.2468503 (50 iterations in 0.112s)
[t-SNE] Iteration 200: error = 68.8189392, gradient norm = 0.2553486 (50 iterations in 0.160s)
[t-SNE] Iteration 250: error = 68.8003082, gradient norm = 0.2780633 (50 iterations in 0.116s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 68.800308
[t-SNE] Iteration 300: error = 1.7715170, gradient norm = 0.0030975 (50 iterations in 0.089s)
[t-SNE] Iteration 350: error = 1.7056289, gradient norm = 0.0003859 (50 iterations in 0.086s)
[t-SNE] Iteration 400: error = 1.6860087, gradient norm = 0.0002411 (50 iterations in 0.088s)
[t-SNE] Iteration 450: error = 1.6787096, gradient norm = 0.0002401 (50 iterations in 0.085s)
[t-SNE] Iteration 500: error = 1.6740876, gradient norm = 0.0000967 (50 iterations in 0.085s)
[t-SNE] Iteration 550: error = 1.6719260, gradient norm = 0.0000720 (50 iterations in 0.083s)
[t-SNE] Iteration 600: error = 1.6703569, gradient norm = 0.0000616 (50 iterations in 0.082s)
[t-SNE] Iteration 650: error = 1.6692227, gradient norm = 0.0000550 (50 iterations in 0.084s)
[t-SNE] Iteration 700: error = 1.6686784, gradient norm = 0.0000492 (50 iterations in 0.081s)
[t-SNE] Iteration 750: error = 1.6682317, gradient norm = 0.0000551 (50 iterations in 0.087s)
[t-SNE] Iteration 800: error = 1.6680835, gradient norm = 0.0000363 (50 iterations in 0.083s)
[t-SNE] Iteration 850: error = 1.6678253, gradient norm = 0.0000545 (50 iterations in 0.084s)
[t-SNE] Iteration 900: error = 1.6673830, gradient norm = 0.0000668 (50 iterations in 0.087s)
[t-SNE] Iteration 950: error = 1.6668001, gradient norm = 0.0000846 (50 iterations in 0.084s)
[t-SNE] Iteration 1000: error = 1.6667606, gradient norm = 0.0000274 (50 iterations in 0.087s)
[t-SNE] KL divergence after 1000 iterations: 1.666761
[t-SNE] Computed conditional probabilities for sample 1000 / 1098
[t-SNE] Computed conditional probabilities for sample 1098 / 1098
[t-SNE] Mean sigma: 0.311102
Beginning preprocessing + Leiden
2024-03-11 19:10:48.486388 MEMORY 3.421618176
Affmat transformed
2024-03-11 19:10:48.498544 MEMORY 3.421618176
sources, targets, weights extracted
2024-03-11 19:10:48.507461 MEMORY 3.421618176
About to launch parallel Leiden runs
2024-03-11 19:10:48.530049 MEMORY 3.421618176
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    2.8s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    9.0s finished
Parallel Leiden runs finished
2024-03-11 19:10:57.499802 MEMORY 3.421618176
Quality: 0.43813402593109246
Quality: 0.43819985999851974
Quality: 0.4392239014257563
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 806 out of 806 | elapsed:    0.4s finished
Got subclusters: Counter({0: 219, 1: 208, 2: 195, 3: 172, 4: 140, 5: 136, 6: 25, 7: 3})
On pattern 2
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 806 samples in 0.005s...
[t-SNE] Computed neighbors for 806 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 806 / 806
[t-SNE] Mean sigma: 0.335669
[t-SNE] Computed conditional probabilities in 0.055s
[t-SNE] Iteration 50: error = 66.3164291, gradient norm = 0.3812998 (50 iterations in 0.077s)
[t-SNE] Iteration 100: error = 67.5314407, gradient norm = 0.3542469 (50 iterations in 0.074s)
[t-SNE] Iteration 150: error = 69.5627670, gradient norm = 0.3410227 (50 iterations in 0.080s)
[t-SNE] Iteration 200: error = 69.0789185, gradient norm = 0.3587144 (50 iterations in 0.072s)
[t-SNE] Iteration 250: error = 68.5419083, gradient norm = 0.3621021 (50 iterations in 0.073s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 68.541908
[t-SNE] Iteration 300: error = 1.6798807, gradient norm = 0.0030143 (50 iterations in 0.067s)
[t-SNE] Iteration 350: error = 1.6164706, gradient norm = 0.0008169 (50 iterations in 0.067s)
[t-SNE] Iteration 400: error = 1.5899372, gradient norm = 0.0004255 (50 iterations in 0.065s)
[t-SNE] Iteration 450: error = 1.5786544, gradient norm = 0.0002566 (50 iterations in 0.070s)
[t-SNE] Iteration 500: error = 1.5705724, gradient norm = 0.0004439 (50 iterations in 0.071s)
[t-SNE] Iteration 550: error = 1.5648377, gradient norm = 0.0002850 (50 iterations in 0.068s)
[t-SNE] Iteration 600: error = 1.5595081, gradient norm = 0.0002481 (50 iterations in 0.067s)
[t-SNE] Iteration 650: error = 1.5557665, gradient norm = 0.0001435 (50 iterations in 0.070s)
[t-SNE] Iteration 700: error = 1.5532688, gradient norm = 0.0001331 (50 iterations in 0.066s)
[t-SNE] Iteration 750: error = 1.5508970, gradient norm = 0.0001076 (50 iterations in 0.066s)
[t-SNE] Iteration 800: error = 1.5492955, gradient norm = 0.0001127 (50 iterations in 0.070s)
[t-SNE] Iteration 850: error = 1.5484328, gradient norm = 0.0001018 (50 iterations in 0.069s)
[t-SNE] Iteration 900: error = 1.5469224, gradient norm = 0.0002477 (50 iterations in 0.068s)
[t-SNE] Iteration 950: error = 1.5464696, gradient norm = 0.0000391 (50 iterations in 0.066s)
[t-SNE] Iteration 1000: error = 1.5460063, gradient norm = 0.0000733 (50 iterations in 0.069s)
[t-SNE] KL divergence after 1000 iterations: 1.546006
[t-SNE] Computed conditional probabilities for sample 806 / 806
[t-SNE] Mean sigma: 0.335669
Beginning preprocessing + Leiden
2024-03-11 19:11:00.276033 MEMORY 3.421618176
Affmat transformed
2024-03-11 19:11:00.285521 MEMORY 3.421618176
sources, targets, weights extracted
2024-03-11 19:11:00.291535 MEMORY 3.421618176
About to launch parallel Leiden runs
2024-03-11 19:11:00.330416 MEMORY 3.421618176
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    2.0s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    6.8s finished
Parallel Leiden runs finished
2024-03-11 19:11:07.102873 MEMORY 3.421618176
Quality: 0.42504228908702235
Quality: 0.42916592236873674
Quality: 0.43003354771164276
Quality: 0.43009226532076267
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 788 out of 788 | elapsed:    0.4s finished
Got subclusters: Counter({0: 172, 1: 156, 2: 154, 3: 113, 4: 108, 5: 103})
On pattern 3
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 788 samples in 0.007s...
[t-SNE] Computed neighbors for 788 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 788 / 788
[t-SNE] Mean sigma: 0.345813
[t-SNE] Computed conditional probabilities in 0.053s
[t-SNE] Iteration 50: error = 66.5259399, gradient norm = 0.3923597 (50 iterations in 0.072s)
[t-SNE] Iteration 100: error = 67.1655655, gradient norm = 0.3712626 (50 iterations in 0.074s)
[t-SNE] Iteration 150: error = 67.7985458, gradient norm = 0.3613495 (50 iterations in 0.077s)
[t-SNE] Iteration 200: error = 69.3807831, gradient norm = 0.3380127 (50 iterations in 0.072s)
[t-SNE] Iteration 250: error = 69.9982758, gradient norm = 0.3315983 (50 iterations in 0.071s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 69.998276
[t-SNE] Iteration 300: error = 1.7277675, gradient norm = 0.0030374 (50 iterations in 0.068s)
[t-SNE] Iteration 350: error = 1.6704364, gradient norm = 0.0007692 (50 iterations in 0.067s)
[t-SNE] Iteration 400: error = 1.6477787, gradient norm = 0.0003285 (50 iterations in 0.067s)
[t-SNE] Iteration 450: error = 1.6325256, gradient norm = 0.0004560 (50 iterations in 0.066s)
[t-SNE] Iteration 500: error = 1.6223700, gradient norm = 0.0002958 (50 iterations in 0.066s)
[t-SNE] Iteration 550: error = 1.6182933, gradient norm = 0.0002532 (50 iterations in 0.065s)
[t-SNE] Iteration 600: error = 1.6148621, gradient norm = 0.0002635 (50 iterations in 0.065s)
[t-SNE] Iteration 650: error = 1.6066805, gradient norm = 0.0002099 (50 iterations in 0.065s)
[t-SNE] Iteration 700: error = 1.6009903, gradient norm = 0.0002143 (50 iterations in 0.066s)
[t-SNE] Iteration 750: error = 1.5982064, gradient norm = 0.0001556 (50 iterations in 0.068s)
[t-SNE] Iteration 800: error = 1.5969861, gradient norm = 0.0001727 (50 iterations in 0.064s)
[t-SNE] Iteration 850: error = 1.5941601, gradient norm = 0.0001592 (50 iterations in 0.064s)
[t-SNE] Iteration 900: error = 1.5935922, gradient norm = 0.0000646 (50 iterations in 0.067s)
[t-SNE] Iteration 950: error = 1.5933521, gradient norm = 0.0001060 (50 iterations in 0.064s)
[t-SNE] Iteration 1000: error = 1.5913643, gradient norm = 0.0001074 (50 iterations in 0.066s)
[t-SNE] KL divergence after 1000 iterations: 1.591364
[t-SNE] Computed conditional probabilities for sample 788 / 788
[t-SNE] Mean sigma: 0.345813
Beginning preprocessing + Leiden
2024-03-11 19:11:09.797267 MEMORY 3.421618176
Affmat transformed
2024-03-11 19:11:09.807048 MEMORY 3.421618176
sources, targets, weights extracted
2024-03-11 19:11:09.812571 MEMORY 3.421618176
About to launch parallel Leiden runs
2024-03-11 19:11:09.832310 MEMORY 3.421618176
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.9s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    6.0s finished
Parallel Leiden runs finished
2024-03-11 19:11:15.871117 MEMORY 3.421618176
Quality: 0.4267163321788615
Quality: 0.426878707843612
Quality: 0.4278331425773061
Quality: 0.42836121575932934
Quality: 0.4285151670689803
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 672 out of 672 | elapsed:    0.4s finished
Got subclusters: Counter({0: 173, 1: 121, 2: 114, 3: 106, 4: 98, 5: 95, 6: 46, 7: 35})
On pattern 4
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 672 samples in 0.005s...
[t-SNE] Computed neighbors for 672 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 672 / 672
[t-SNE] Mean sigma: 0.334718
[t-SNE] Computed conditional probabilities in 0.046s
[t-SNE] Iteration 50: error = 68.9952011, gradient norm = 0.4009674 (50 iterations in 0.072s)
[t-SNE] Iteration 100: error = 69.1847839, gradient norm = 0.4131687 (50 iterations in 0.065s)
[t-SNE] Iteration 150: error = 70.1924210, gradient norm = 0.3945543 (50 iterations in 0.066s)
[t-SNE] Iteration 200: error = 70.2988510, gradient norm = 0.4006436 (50 iterations in 0.071s)
[t-SNE] Iteration 250: error = 70.2625427, gradient norm = 0.3913068 (50 iterations in 0.069s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 70.262543
[t-SNE] Iteration 300: error = 1.6896530, gradient norm = 0.0029245 (50 iterations in 0.062s)
[t-SNE] Iteration 350: error = 1.6155376, gradient norm = 0.0013664 (50 iterations in 0.061s)
[t-SNE] Iteration 400: error = 1.5709312, gradient norm = 0.0006999 (50 iterations in 0.060s)
[t-SNE] Iteration 450: error = 1.5514466, gradient norm = 0.0012037 (50 iterations in 0.062s)
[t-SNE] Iteration 500: error = 1.5317487, gradient norm = 0.0005733 (50 iterations in 0.061s)
[t-SNE] Iteration 550: error = 1.5257398, gradient norm = 0.0001771 (50 iterations in 0.058s)
[t-SNE] Iteration 600: error = 1.5229449, gradient norm = 0.0002130 (50 iterations in 0.060s)
[t-SNE] Iteration 650: error = 1.5221982, gradient norm = 0.0001007 (50 iterations in 0.056s)
[t-SNE] Iteration 700: error = 1.5207704, gradient norm = 0.0001613 (50 iterations in 0.058s)
[t-SNE] Iteration 750: error = 1.5205472, gradient norm = 0.0000520 (50 iterations in 0.056s)
[t-SNE] Iteration 800: error = 1.5205055, gradient norm = 0.0000888 (50 iterations in 0.056s)
[t-SNE] Iteration 850: error = 1.5201612, gradient norm = 0.0000676 (50 iterations in 0.059s)
[t-SNE] Iteration 900: error = 1.5198953, gradient norm = 0.0000351 (50 iterations in 0.060s)
[t-SNE] Iteration 950: error = 1.5197848, gradient norm = 0.0000494 (50 iterations in 0.060s)
[t-SNE] Iteration 1000: error = 1.5198537, gradient norm = 0.0000439 (50 iterations in 0.060s)
[t-SNE] KL divergence after 1000 iterations: 1.519854
[t-SNE] Computed conditional probabilities for sample 672 / 672
[t-SNE] Mean sigma: 0.334718
Beginning preprocessing + Leiden
2024-03-11 19:11:18.246390 MEMORY 3.421630464
Affmat transformed
2024-03-11 19:11:18.254749 MEMORY 3.421630464
sources, targets, weights extracted
2024-03-11 19:11:18.259695 MEMORY 3.421630464
About to launch parallel Leiden runs
2024-03-11 19:11:18.292867 MEMORY 3.421630464
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    5.4s finished
Parallel Leiden runs finished
2024-03-11 19:11:23.664911 MEMORY 3.421630464
Quality: 0.4018038201580886
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 671 out of 671 | elapsed:    0.4s finished
Got subclusters: Counter({0: 191, 1: 181, 2: 93, 3: 84, 4: 71, 5: 47, 6: 5})
On pattern 5
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 671 samples in 0.004s...
[t-SNE] Computed neighbors for 671 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 671 / 671
[t-SNE] Mean sigma: 0.331780
[t-SNE] Computed conditional probabilities in 0.047s
[t-SNE] Iteration 50: error = 69.9878922, gradient norm = 0.3787030 (50 iterations in 0.065s)
[t-SNE] Iteration 100: error = 71.7392349, gradient norm = 0.3745069 (50 iterations in 0.067s)
[t-SNE] Iteration 150: error = 74.2134247, gradient norm = 0.3467297 (50 iterations in 0.066s)
[t-SNE] Iteration 200: error = 73.0543747, gradient norm = 0.3704723 (50 iterations in 0.064s)
[t-SNE] Iteration 250: error = 72.5049362, gradient norm = 0.3538955 (50 iterations in 0.064s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 72.504936
[t-SNE] Iteration 300: error = 1.5949119, gradient norm = 0.0032800 (50 iterations in 0.061s)
[t-SNE] Iteration 350: error = 1.5082991, gradient norm = 0.0016690 (50 iterations in 0.060s)
[t-SNE] Iteration 400: error = 1.4708424, gradient norm = 0.0010098 (50 iterations in 0.059s)
[t-SNE] Iteration 450: error = 1.4502943, gradient norm = 0.0004951 (50 iterations in 0.062s)
[t-SNE] Iteration 500: error = 1.4363049, gradient norm = 0.0004869 (50 iterations in 0.063s)
[t-SNE] Iteration 550: error = 1.4286244, gradient norm = 0.0003489 (50 iterations in 0.060s)
[t-SNE] Iteration 600: error = 1.4179376, gradient norm = 0.0004425 (50 iterations in 0.061s)
[t-SNE] Iteration 650: error = 1.4119593, gradient norm = 0.0004159 (50 iterations in 0.064s)
[t-SNE] Iteration 700: error = 1.4080787, gradient norm = 0.0001485 (50 iterations in 0.061s)
[t-SNE] Iteration 750: error = 1.4068413, gradient norm = 0.0001792 (50 iterations in 0.061s)
[t-SNE] Iteration 800: error = 1.4060299, gradient norm = 0.0003195 (50 iterations in 0.058s)
[t-SNE] Iteration 850: error = 1.4050320, gradient norm = 0.0001526 (50 iterations in 0.061s)
[t-SNE] Iteration 900: error = 1.4025403, gradient norm = 0.0003497 (50 iterations in 0.062s)
[t-SNE] Iteration 950: error = 1.3998952, gradient norm = 0.0002835 (50 iterations in 0.060s)
[t-SNE] Iteration 1000: error = 1.3851988, gradient norm = 0.0010867 (50 iterations in 0.061s)
[t-SNE] KL divergence after 1000 iterations: 1.385199
[t-SNE] Computed conditional probabilities for sample 671 / 671
[t-SNE] Mean sigma: 0.331780
Beginning preprocessing + Leiden
2024-03-11 19:11:26.079460 MEMORY 3.421650944
Affmat transformed
2024-03-11 19:11:26.087794 MEMORY 3.421650944
sources, targets, weights extracted
2024-03-11 19:11:26.093199 MEMORY 3.421650944
About to launch parallel Leiden runs
2024-03-11 19:11:26.141364 MEMORY 3.421650944
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    5.4s finished
Parallel Leiden runs finished
2024-03-11 19:11:31.540235 MEMORY 3.421650944
Quality: 0.4299650068344631
Quality: 0.43011363510777634
Quality: 0.4305275325483051
Quality: 0.4305771326349143
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 651 out of 651 | elapsed:    0.3s finished
Got subclusters: Counter({0: 164, 1: 157, 2: 140, 3: 86, 4: 77, 5: 38, 6: 9})
On pattern 6
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 651 samples in 0.004s...
[t-SNE] Computed neighbors for 651 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 651 / 651
[t-SNE] Mean sigma: 0.353891
[t-SNE] Computed conditional probabilities in 0.044s
[t-SNE] Iteration 50: error = 67.6123581, gradient norm = 0.4410762 (50 iterations in 0.065s)
[t-SNE] Iteration 100: error = 72.1984100, gradient norm = 0.3488040 (50 iterations in 0.068s)
[t-SNE] Iteration 150: error = 70.4134293, gradient norm = 0.3704316 (50 iterations in 0.066s)
[t-SNE] Iteration 200: error = 69.6851044, gradient norm = 0.3934594 (50 iterations in 0.066s)
[t-SNE] Iteration 250: error = 70.8344574, gradient norm = 0.3719397 (50 iterations in 0.068s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 70.834457
[t-SNE] Iteration 300: error = 1.4462028, gradient norm = 0.0031455 (50 iterations in 0.062s)
[t-SNE] Iteration 350: error = 1.3844126, gradient norm = 0.0007846 (50 iterations in 0.059s)
[t-SNE] Iteration 400: error = 1.3646514, gradient norm = 0.0004704 (50 iterations in 0.058s)
[t-SNE] Iteration 450: error = 1.3490671, gradient norm = 0.0006386 (50 iterations in 0.056s)
[t-SNE] Iteration 500: error = 1.3412129, gradient norm = 0.0003631 (50 iterations in 0.059s)
[t-SNE] Iteration 550: error = 1.3370482, gradient norm = 0.0001983 (50 iterations in 0.060s)
[t-SNE] Iteration 600: error = 1.3350754, gradient norm = 0.0002627 (50 iterations in 0.058s)
[t-SNE] Iteration 650: error = 1.3320754, gradient norm = 0.0001392 (50 iterations in 0.062s)
[t-SNE] Iteration 700: error = 1.3309518, gradient norm = 0.0001244 (50 iterations in 0.058s)
[t-SNE] Iteration 750: error = 1.3293257, gradient norm = 0.0002571 (50 iterations in 0.059s)
[t-SNE] Iteration 800: error = 1.3287537, gradient norm = 0.0001128 (50 iterations in 0.061s)
[t-SNE] Iteration 850: error = 1.3276442, gradient norm = 0.0000987 (50 iterations in 0.060s)
[t-SNE] Iteration 900: error = 1.3275199, gradient norm = 0.0000766 (50 iterations in 0.062s)
[t-SNE] Iteration 950: error = 1.3273004, gradient norm = 0.0000842 (50 iterations in 0.060s)
[t-SNE] Iteration 1000: error = 1.3270075, gradient norm = 0.0000498 (50 iterations in 0.061s)
[t-SNE] KL divergence after 1000 iterations: 1.327008
[t-SNE] Computed conditional probabilities for sample 651 / 651
[t-SNE] Mean sigma: 0.353891
Beginning preprocessing + Leiden
2024-03-11 19:11:33.836479 MEMORY 3.421708288
Affmat transformed
2024-03-11 19:11:33.844263 MEMORY 3.421708288
sources, targets, weights extracted
2024-03-11 19:11:33.849025 MEMORY 3.421708288
About to launch parallel Leiden runs
2024-03-11 19:11:33.870928 MEMORY 3.421708288
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    5.5s finished
Parallel Leiden runs finished
2024-03-11 19:11:39.409397 MEMORY 3.421708288
Quality: 0.43778338793656335
Quality: 0.44014102837438196
Quality: 0.44068008125004016
Quality: 0.4409520448617531
Quality: 0.4414763964186413
Quality: 0.4422140988763722
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 315 out of 315 | elapsed:    0.1s finished
Got subclusters: Counter({0: 154, 1: 143, 2: 105, 3: 88, 4: 70, 5: 57, 6: 32, 7: 2})
On pattern 7
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 315 samples in 0.002s...
[t-SNE] Computed neighbors for 315 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 315 / 315
[t-SNE] Mean sigma: 0.370016
[t-SNE] Computed conditional probabilities in 0.021s
[t-SNE] Iteration 50: error = 63.0371704, gradient norm = 0.5059633 (50 iterations in 0.044s)
[t-SNE] Iteration 100: error = 63.8958893, gradient norm = 0.5148352 (50 iterations in 0.042s)
[t-SNE] Iteration 150: error = 65.6143799, gradient norm = 0.4932671 (50 iterations in 0.039s)
[t-SNE] Iteration 200: error = 64.8760376, gradient norm = 0.4824569 (50 iterations in 0.039s)
[t-SNE] Iteration 250: error = 66.1712952, gradient norm = 0.4728079 (50 iterations in 0.042s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 66.171295
[t-SNE] Iteration 300: error = 1.1110166, gradient norm = 0.0053769 (50 iterations in 0.038s)
[t-SNE] Iteration 350: error = 0.9867780, gradient norm = 0.0027016 (50 iterations in 0.037s)
[t-SNE] Iteration 400: error = 0.9477894, gradient norm = 0.0010520 (50 iterations in 0.039s)
[t-SNE] Iteration 450: error = 0.8959895, gradient norm = 0.0013758 (50 iterations in 0.044s)
[t-SNE] Iteration 500: error = 0.8865464, gradient norm = 0.0005715 (50 iterations in 0.038s)
[t-SNE] Iteration 550: error = 0.8841667, gradient norm = 0.0001398 (50 iterations in 0.038s)
[t-SNE] Iteration 600: error = 0.8843206, gradient norm = 0.0001208 (50 iterations in 0.039s)
[t-SNE] Iteration 650: error = 0.8842388, gradient norm = 0.0000896 (50 iterations in 0.042s)
[t-SNE] Iteration 700: error = 0.8839735, gradient norm = 0.0002694 (50 iterations in 0.046s)
[t-SNE] Iteration 750: error = 0.8836237, gradient norm = 0.0001826 (50 iterations in 0.038s)
[t-SNE] Iteration 800: error = 0.8831587, gradient norm = 0.0000529 (50 iterations in 0.040s)
[t-SNE] Iteration 850: error = 0.8832213, gradient norm = 0.0000329 (50 iterations in 0.038s)
[t-SNE] Iteration 900: error = 0.8832862, gradient norm = 0.0000488 (50 iterations in 0.036s)
[t-SNE] Iteration 950: error = 0.8832770, gradient norm = 0.0000565 (50 iterations in 0.039s)
[t-SNE] Iteration 1000: error = 0.8832222, gradient norm = 0.0000556 (50 iterations in 0.040s)
[t-SNE] KL divergence after 1000 iterations: 0.883222
[t-SNE] Computed conditional probabilities for sample 315 / 315
[t-SNE] Mean sigma: 0.370016
Beginning preprocessing + Leiden
2024-03-11 19:11:40.804857 MEMORY 3.421708288
Affmat transformed
2024-03-11 19:11:40.809804 MEMORY 3.421708288
sources, targets, weights extracted
2024-03-11 19:11:40.812038 MEMORY 3.421708288
About to launch parallel Leiden runs
2024-03-11 19:11:40.825499 MEMORY 3.421708288
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.9s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.8s finished
Parallel Leiden runs finished
2024-03-11 19:11:43.640113 MEMORY 3.421708288
Quality: 0.38835873761138345
Quality: 0.3897551732976427
Quality: 0.38982083165151177
Quality: 0.3900224102313815
Quality: 0.3906911111266028
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 233 out of 280 | elapsed:    0.1s remaining:    0.0s
[Parallel(n_jobs=24)]: Done 280 out of 280 | elapsed:    0.1s finished
Got subclusters: Counter({0: 103, 1: 74, 2: 73, 3: 47, 4: 18})
On pattern 8
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 280 samples in 0.002s...
[t-SNE] Computed neighbors for 280 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 280 / 280
[t-SNE] Mean sigma: 0.357216
[t-SNE] Computed conditional probabilities in 0.019s
[t-SNE] Iteration 50: error = 62.8432312, gradient norm = 0.4581385 (50 iterations in 0.038s)
[t-SNE] Iteration 100: error = 62.6388283, gradient norm = 0.4932241 (50 iterations in 0.035s)
[t-SNE] Iteration 150: error = 62.5697060, gradient norm = 0.5213614 (50 iterations in 0.036s)
[t-SNE] Iteration 200: error = 66.4326019, gradient norm = 0.4877854 (50 iterations in 0.037s)
[t-SNE] Iteration 250: error = 67.6253128, gradient norm = 0.4734409 (50 iterations in 0.034s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 67.625313
[t-SNE] Iteration 300: error = 1.3102106, gradient norm = 0.0062625 (50 iterations in 0.034s)
[t-SNE] Iteration 350: error = 1.1602361, gradient norm = 0.0041837 (50 iterations in 0.034s)
[t-SNE] Iteration 400: error = 0.9899331, gradient norm = 0.0034734 (50 iterations in 0.033s)
[t-SNE] Iteration 450: error = 0.9587055, gradient norm = 0.0006145 (50 iterations in 0.037s)
[t-SNE] Iteration 500: error = 0.9557548, gradient norm = 0.0006547 (50 iterations in 0.035s)
[t-SNE] Iteration 550: error = 0.9524606, gradient norm = 0.0003971 (50 iterations in 0.034s)
[t-SNE] Iteration 600: error = 0.9493431, gradient norm = 0.0005349 (50 iterations in 0.034s)
[t-SNE] Iteration 650: error = 0.9479436, gradient norm = 0.0001543 (50 iterations in 0.033s)
[t-SNE] Iteration 700: error = 0.9470068, gradient norm = 0.0000947 (50 iterations in 0.035s)
[t-SNE] Iteration 750: error = 0.9469779, gradient norm = 0.0000698 (50 iterations in 0.036s)
[t-SNE] Iteration 800: error = 0.9469535, gradient norm = 0.0000802 (50 iterations in 0.034s)
[t-SNE] Iteration 850: error = 0.9470051, gradient norm = 0.0000672 (50 iterations in 0.036s)
[t-SNE] Iteration 900: error = 0.9470378, gradient norm = 0.0000655 (50 iterations in 0.037s)
[t-SNE] Iteration 950: error = 0.9469862, gradient norm = 0.0000799 (50 iterations in 0.033s)
[t-SNE] Iteration 1000: error = 0.9469968, gradient norm = 0.0000891 (50 iterations in 0.033s)
[t-SNE] KL divergence after 1000 iterations: 0.946997
[t-SNE] Computed conditional probabilities for sample 280 / 280
[t-SNE] Mean sigma: 0.357216
Beginning preprocessing + Leiden
2024-03-11 19:11:44.780403 MEMORY 3.421708288
Affmat transformed
2024-03-11 19:11:44.784044 MEMORY 3.421708288
sources, targets, weights extracted
2024-03-11 19:11:44.785758 MEMORY 3.421708288
About to launch parallel Leiden runs
2024-03-11 19:11:44.806479 MEMORY 3.421708288
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.9s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.5s finished
Parallel Leiden runs finished
2024-03-11 19:11:47.290324 MEMORY 3.421708288
Quality: 0.33047635347926396
Quality: 0.33146969536788196
Quality: 0.3315933120265014
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 142 out of 189 | elapsed:    0.1s remaining:    0.0s
[Parallel(n_jobs=24)]: Done 189 out of 189 | elapsed:    0.1s finished
Got subclusters: Counter({0: 56, 1: 54, 2: 54, 3: 39, 4: 38, 5: 37, 6: 2})
On pattern 9
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 189 samples in 0.002s...
[t-SNE] Computed neighbors for 189 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 189 / 189
[t-SNE] Mean sigma: 0.401473
[t-SNE] Computed conditional probabilities in 0.013s
[t-SNE] Iteration 50: error = 62.6609230, gradient norm = 0.5169262 (50 iterations in 0.028s)
[t-SNE] Iteration 100: error = 64.0262756, gradient norm = 0.4755217 (50 iterations in 0.027s)
[t-SNE] Iteration 150: error = 59.9978943, gradient norm = 0.5549477 (50 iterations in 0.028s)
[t-SNE] Iteration 200: error = 58.4191170, gradient norm = 0.5209856 (50 iterations in 0.029s)
[t-SNE] Iteration 250: error = 62.4834595, gradient norm = 0.5222309 (50 iterations in 0.028s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 62.483459
[t-SNE] Iteration 300: error = 0.9723675, gradient norm = 0.0065236 (50 iterations in 0.026s)
[t-SNE] Iteration 350: error = 0.7136571, gradient norm = 0.0067658 (50 iterations in 0.026s)
[t-SNE] Iteration 400: error = 0.6863170, gradient norm = 0.0010597 (50 iterations in 0.025s)
[t-SNE] Iteration 450: error = 0.6807315, gradient norm = 0.0006860 (50 iterations in 0.025s)
[t-SNE] Iteration 500: error = 0.6777169, gradient norm = 0.0014229 (50 iterations in 0.028s)
[t-SNE] Iteration 550: error = 0.6769127, gradient norm = 0.0001810 (50 iterations in 0.026s)
[t-SNE] Iteration 600: error = 0.6769686, gradient norm = 0.0000954 (50 iterations in 0.025s)
[t-SNE] Iteration 650: error = 0.6768833, gradient norm = 0.0001430 (50 iterations in 0.025s)
[t-SNE] Iteration 700: error = 0.6769112, gradient norm = 0.0001312 (50 iterations in 0.027s)
[t-SNE] Iteration 750: error = 0.6769599, gradient norm = 0.0001711 (50 iterations in 0.028s)
[t-SNE] Iteration 800: error = 0.6768863, gradient norm = 0.0001099 (50 iterations in 0.025s)
[t-SNE] Iteration 850: error = 0.6769471, gradient norm = 0.0001077 (50 iterations in 0.027s)
[t-SNE] Iteration 900: error = 0.6769555, gradient norm = 0.0000882 (50 iterations in 0.027s)
[t-SNE] Iteration 950: error = 0.6770904, gradient norm = 0.0001264 (50 iterations in 0.031s)
[t-SNE] Iteration 1000: error = 0.6769848, gradient norm = 0.0001337 (50 iterations in 0.026s)
[t-SNE] Iteration 1000: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 1000 iterations: 0.676985
[t-SNE] Computed conditional probabilities for sample 189 / 189
[t-SNE] Mean sigma: 0.401473
Beginning preprocessing + Leiden
2024-03-11 19:11:48.135860 MEMORY 3.421708288
Affmat transformed
2024-03-11 19:11:48.138765 MEMORY 3.421708288
sources, targets, weights extracted
2024-03-11 19:11:48.139800 MEMORY 3.421708288
About to launch parallel Leiden runs
2024-03-11 19:11:48.167744 MEMORY 3.421708288
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.2s finished
Parallel Leiden runs finished
2024-03-11 19:11:50.328738 MEMORY 3.421708288
Quality: 0.30097613380228716
Quality: 0.3025058890533075
Quality: 0.3027239618665138
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  64 out of 111 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=24)]: Done 111 out of 111 | elapsed:    0.0s finished
Got subclusters: Counter({0: 51, 1: 47, 2: 36, 3: 28, 4: 27})
On pattern 10
[t-SNE] Computing 110 nearest neighbors...
[t-SNE] Indexed 111 samples in 0.001s...
[t-SNE] Computed neighbors for 111 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 111 / 111
[t-SNE] Mean sigma: 0.458418
[t-SNE] Computed conditional probabilities in 0.005s
[t-SNE] Iteration 50: error = 55.6256561, gradient norm = 0.5240971 (50 iterations in 0.021s)
[t-SNE] Iteration 100: error = 53.4408646, gradient norm = 0.5970672 (50 iterations in 0.021s)
[t-SNE] Iteration 150: error = 54.6823769, gradient norm = 0.5342068 (50 iterations in 0.021s)
[t-SNE] Iteration 200: error = 56.7138748, gradient norm = 0.4828874 (50 iterations in 0.018s)
[t-SNE] Iteration 250: error = 53.8758774, gradient norm = 0.5222333 (50 iterations in 0.020s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 53.875877
[t-SNE] Iteration 300: error = 0.8090789, gradient norm = 0.0048400 (50 iterations in 0.021s)
[t-SNE] Iteration 350: error = 0.6718348, gradient norm = 0.0054474 (50 iterations in 0.021s)
[t-SNE] Iteration 400: error = 0.3912866, gradient norm = 0.0203236 (50 iterations in 0.021s)
[t-SNE] Iteration 450: error = 0.3212075, gradient norm = 0.0045384 (50 iterations in 0.020s)
[t-SNE] Iteration 500: error = 0.3187805, gradient norm = 0.0005333 (50 iterations in 0.019s)
[t-SNE] Iteration 550: error = 0.3182289, gradient norm = 0.0006590 (50 iterations in 0.021s)
[t-SNE] Iteration 600: error = 0.3185834, gradient norm = 0.0006126 (50 iterations in 0.018s)
[t-SNE] Iteration 650: error = 0.3185623, gradient norm = 0.0006054 (50 iterations in 0.018s)
[t-SNE] Iteration 700: error = 0.3186831, gradient norm = 0.0006174 (50 iterations in 0.019s)
[t-SNE] Iteration 750: error = 0.3185772, gradient norm = 0.0006838 (50 iterations in 0.019s)
[t-SNE] Iteration 800: error = 0.3183842, gradient norm = 0.0006663 (50 iterations in 0.018s)
[t-SNE] Iteration 850: error = 0.3186455, gradient norm = 0.0006948 (50 iterations in 0.020s)
[t-SNE] Iteration 900: error = 0.3180993, gradient norm = 0.0006964 (50 iterations in 0.018s)
[t-SNE] Iteration 950: error = 0.3185135, gradient norm = 0.0006318 (50 iterations in 0.018s)
[t-SNE] Iteration 1000: error = 0.3184947, gradient norm = 0.0007202 (50 iterations in 0.018s)
[t-SNE] KL divergence after 1000 iterations: 0.318495
[t-SNE] Computed conditional probabilities for sample 111 / 111
[t-SNE] Mean sigma: 0.458418
Beginning preprocessing + Leiden
2024-03-11 19:11:50.879271 MEMORY 3.421708288
Affmat transformed
2024-03-11 19:11:50.880686 MEMORY 3.421708288
sources, targets, weights extracted
2024-03-11 19:11:50.881220 MEMORY 3.421708288
About to launch parallel Leiden runs
2024-03-11 19:11:50.903375 MEMORY 3.421708288
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.6s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.8s finished
Parallel Leiden runs finished
2024-03-11 19:11:52.707639 MEMORY 3.421708288
Quality: 0.23908458241830285
Quality: 0.2391073860647372
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 100 out of 100 | elapsed:    0.0s finished
Got subclusters: Counter({1: 31, 0: 31, 2: 28, 3: 16, 4: 5})
On pattern 11
[t-SNE] Computing 99 nearest neighbors...
[t-SNE] Indexed 100 samples in 0.001s...
[t-SNE] Computed neighbors for 100 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 100 / 100
[t-SNE] Mean sigma: 0.521113
[t-SNE] Computed conditional probabilities in 0.004s
[t-SNE] Iteration 50: error = 51.9704552, gradient norm = 0.5337310 (50 iterations in 0.018s)
[t-SNE] Iteration 100: error = 54.2026863, gradient norm = 0.5131729 (50 iterations in 0.019s)
[t-SNE] Iteration 150: error = 51.3097572, gradient norm = 0.5254067 (50 iterations in 0.020s)
[t-SNE] Iteration 200: error = 53.9513321, gradient norm = 0.4282131 (50 iterations in 0.018s)
[t-SNE] Iteration 250: error = 53.0277176, gradient norm = 0.5335445 (50 iterations in 0.017s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 53.027718
[t-SNE] Iteration 300: error = 0.7764917, gradient norm = 0.0062516 (50 iterations in 0.018s)
[t-SNE] Iteration 350: error = 0.6473477, gradient norm = 0.0018596 (50 iterations in 0.019s)
[t-SNE] Iteration 400: error = 0.3665263, gradient norm = 0.0178853 (50 iterations in 0.019s)
[t-SNE] Iteration 450: error = 0.2832687, gradient norm = 0.0018082 (50 iterations in 0.019s)
[t-SNE] Iteration 500: error = 0.2830241, gradient norm = 0.0005268 (50 iterations in 0.018s)
[t-SNE] Iteration 550: error = 0.2833034, gradient norm = 0.0008331 (50 iterations in 0.019s)
[t-SNE] Iteration 600: error = 0.2830726, gradient norm = 0.0007121 (50 iterations in 0.019s)
[t-SNE] Iteration 650: error = 0.2827736, gradient norm = 0.0006116 (50 iterations in 0.018s)
[t-SNE] Iteration 700: error = 0.2831100, gradient norm = 0.0005795 (50 iterations in 0.018s)
[t-SNE] Iteration 750: error = 0.2826867, gradient norm = 0.0006690 (50 iterations in 0.017s)
[t-SNE] Iteration 800: error = 0.2830048, gradient norm = 0.0006056 (50 iterations in 0.018s)
[t-SNE] Iteration 850: error = 0.2827682, gradient norm = 0.0007889 (50 iterations in 0.018s)
[t-SNE] Iteration 900: error = 0.2830722, gradient norm = 0.0006300 (50 iterations in 0.018s)
[t-SNE] Iteration 950: error = 0.2829213, gradient norm = 0.0005935 (50 iterations in 0.019s)
[t-SNE] Iteration 1000: error = 0.2831303, gradient norm = 0.0005981 (50 iterations in 0.019s)
[t-SNE] KL divergence after 1000 iterations: 0.283130
[t-SNE] Computed conditional probabilities for sample 100 / 100
[t-SNE] Mean sigma: 0.521113
Beginning preprocessing + Leiden
2024-03-11 19:11:53.730891 MEMORY 3.421708288
Affmat transformed
2024-03-11 19:11:53.732045 MEMORY 3.421708288
sources, targets, weights extracted
2024-03-11 19:11:53.732491 MEMORY 3.421708288
About to launch parallel Leiden runs
2024-03-11 19:11:53.750410 MEMORY 3.421708288
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.6s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.8s finished
Parallel Leiden runs finished
2024-03-11 19:11:55.535546 MEMORY 3.421708288
Quality: 0.24297914598055798
Quality: 0.2437430515999455
Quality: 0.24380310360251042
Quality: 0.24386036974633488
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  87 out of  87 | elapsed:    0.0s finished
Got subclusters: Counter({0: 25, 1: 23, 2: 20, 3: 20, 4: 12})
On pattern 12
[t-SNE] Computing 86 nearest neighbors...
[t-SNE] Indexed 87 samples in 0.001s...
[t-SNE] Computed neighbors for 87 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 87 / 87
[t-SNE] Mean sigma: 0.523616
[t-SNE] Computed conditional probabilities in 0.003s
[t-SNE] Iteration 50: error = 49.7523689, gradient norm = 0.4347890 (50 iterations in 0.029s)
[t-SNE] Iteration 100: error = 51.6998482, gradient norm = 0.5201023 (50 iterations in 0.016s)
[t-SNE] Iteration 150: error = 51.9584312, gradient norm = 0.4903971 (50 iterations in 0.016s)
[t-SNE] Iteration 200: error = 51.1498680, gradient norm = 0.5124148 (50 iterations in 0.016s)
[t-SNE] Iteration 250: error = 49.5105324, gradient norm = 0.6093737 (50 iterations in 0.016s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 49.510532
[t-SNE] Iteration 300: error = 0.8227875, gradient norm = 0.0074862 (50 iterations in 0.016s)
[t-SNE] Iteration 350: error = 0.3478296, gradient norm = 0.0301066 (50 iterations in 0.018s)
[t-SNE] Iteration 400: error = 0.2378810, gradient norm = 0.0032708 (50 iterations in 0.017s)
[t-SNE] Iteration 450: error = 0.2372299, gradient norm = 0.0008542 (50 iterations in 0.017s)
[t-SNE] Iteration 500: error = 0.2372852, gradient norm = 0.0004747 (50 iterations in 0.017s)
[t-SNE] Iteration 550: error = 0.2373378, gradient norm = 0.0007380 (50 iterations in 0.017s)
[t-SNE] Iteration 600: error = 0.2373839, gradient norm = 0.0007213 (50 iterations in 0.016s)
[t-SNE] Iteration 650: error = 0.2374626, gradient norm = 0.0005797 (50 iterations in 0.018s)
[t-SNE] Iteration 700: error = 0.2373172, gradient norm = 0.0006817 (50 iterations in 0.016s)
[t-SNE] Iteration 750: error = 0.2373844, gradient norm = 0.0004848 (50 iterations in 0.017s)
[t-SNE] Iteration 800: error = 0.2373831, gradient norm = 0.0006159 (50 iterations in 0.017s)
[t-SNE] Iteration 800: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 800 iterations: 0.237383
[t-SNE] Computed conditional probabilities for sample 87 / 87
[t-SNE] Mean sigma: 0.523616
Beginning preprocessing + Leiden
2024-03-11 19:11:55.926146 MEMORY 3.421708288
Affmat transformed
2024-03-11 19:11:55.927239 MEMORY 3.421708288
sources, targets, weights extracted
2024-03-11 19:11:55.927723 MEMORY 3.421708288
About to launch parallel Leiden runs
2024-03-11 19:11:55.952020 MEMORY 3.421708288
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.6s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.7s finished
Parallel Leiden runs finished
2024-03-11 19:11:57.696627 MEMORY 3.421708288
Quality: 0.1722839379956997
Quality: 0.172677465123353
Quality: 0.17308921269381883
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  87 out of  87 | elapsed:    0.0s finished
Got subclusters: Counter({0: 29, 2: 22, 1: 22, 3: 8, 4: 6})
On pattern 13
[t-SNE] Computing 86 nearest neighbors...
[t-SNE] Indexed 87 samples in 0.001s...
[t-SNE] Computed neighbors for 87 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 87 / 87
[t-SNE] Mean sigma: 0.560133
[t-SNE] Computed conditional probabilities in 0.003s
[t-SNE] Iteration 50: error = 51.4536247, gradient norm = 0.4923694 (50 iterations in 0.045s)
[t-SNE] Iteration 100: error = 53.1237488, gradient norm = 0.4055785 (50 iterations in 0.017s)
[t-SNE] Iteration 150: error = 53.0355263, gradient norm = 0.5172287 (50 iterations in 0.018s)
[t-SNE] Iteration 200: error = 50.6473846, gradient norm = 0.5857871 (50 iterations in 0.016s)
[t-SNE] Iteration 250: error = 48.5468636, gradient norm = 0.6264092 (50 iterations in 0.015s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 48.546864
[t-SNE] Iteration 300: error = 0.9242156, gradient norm = 0.0058194 (50 iterations in 0.015s)
[t-SNE] Iteration 350: error = 0.7450671, gradient norm = 0.0059031 (50 iterations in 0.017s)
[t-SNE] Iteration 400: error = 0.5368415, gradient norm = 0.0122874 (50 iterations in 0.016s)
[t-SNE] Iteration 450: error = 0.2078260, gradient norm = 0.0065242 (50 iterations in 0.016s)
[t-SNE] Iteration 500: error = 0.2056735, gradient norm = 0.0008727 (50 iterations in 0.015s)
[t-SNE] Iteration 550: error = 0.2055903, gradient norm = 0.0009832 (50 iterations in 0.016s)
[t-SNE] Iteration 600: error = 0.2058952, gradient norm = 0.0007932 (50 iterations in 0.016s)
[t-SNE] Iteration 650: error = 0.2057675, gradient norm = 0.0007307 (50 iterations in 0.018s)
[t-SNE] Iteration 700: error = 0.2056679, gradient norm = 0.0009875 (50 iterations in 0.018s)
[t-SNE] Iteration 750: error = 0.2058000, gradient norm = 0.0007765 (50 iterations in 0.018s)
[t-SNE] Iteration 800: error = 0.2058806, gradient norm = 0.0004787 (50 iterations in 0.015s)
[t-SNE] Iteration 850: error = 0.2056977, gradient norm = 0.0010001 (50 iterations in 0.016s)
[t-SNE] Iteration 900: error = 0.2058037, gradient norm = 0.0010534 (50 iterations in 0.016s)
[t-SNE] Iteration 900: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 900 iterations: 0.205804
[t-SNE] Computed conditional probabilities for sample 87 / 87
[t-SNE] Mean sigma: 0.560133
Beginning preprocessing + Leiden
2024-03-11 19:11:58.136660 MEMORY 3.421708288
Affmat transformed
2024-03-11 19:11:58.137828 MEMORY 3.421708288
sources, targets, weights extracted
2024-03-11 19:11:58.138349 MEMORY 3.421708288
About to launch parallel Leiden runs
2024-03-11 19:11:58.175905 MEMORY 3.421708288
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.6s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.7s finished
Parallel Leiden runs finished
2024-03-11 19:11:59.921462 MEMORY 3.421708288
Quality: 0.2197320726382306
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  72 out of  72 | elapsed:    0.0s finished
Got subclusters: Counter({0: 30, 1: 24, 2: 19, 3: 14})
On pattern 14
[t-SNE] Computing 71 nearest neighbors...
[t-SNE] Indexed 72 samples in 0.001s...
[t-SNE] Computed neighbors for 72 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 72 / 72
[t-SNE] Mean sigma: 0.582808
[t-SNE] Computed conditional probabilities in 0.002s
[t-SNE] Iteration 50: error = 49.5815277, gradient norm = 0.5017164 (50 iterations in 0.039s)
[t-SNE] Iteration 100: error = 48.4512100, gradient norm = 0.5779881 (50 iterations in 0.019s)
[t-SNE] Iteration 150: error = 47.3988419, gradient norm = 0.5727420 (50 iterations in 0.016s)
[t-SNE] Iteration 200: error = 49.3692513, gradient norm = 0.5468960 (50 iterations in 0.105s)
[t-SNE] Iteration 250: error = 47.2582054, gradient norm = 0.5426579 (50 iterations in 0.016s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 47.258205
[t-SNE] Iteration 300: error = 0.7184936, gradient norm = 0.0034109 (50 iterations in 0.016s)
[t-SNE] Iteration 350: error = 0.6173863, gradient norm = 0.0029531 (50 iterations in 0.015s)
[t-SNE] Iteration 400: error = 0.5312870, gradient norm = 0.0023206 (50 iterations in 0.016s)
[t-SNE] Iteration 450: error = 0.4497373, gradient norm = 0.0096115 (50 iterations in 0.015s)
[t-SNE] Iteration 500: error = 0.1753765, gradient norm = 0.0242218 (50 iterations in 0.042s)
[t-SNE] Iteration 550: error = 0.1503588, gradient norm = 0.0092947 (50 iterations in 0.015s)
[t-SNE] Iteration 600: error = 0.1476074, gradient norm = 0.0016609 (50 iterations in 0.014s)
[t-SNE] Iteration 650: error = 0.1475345, gradient norm = 0.0006614 (50 iterations in 0.015s)
[t-SNE] Iteration 700: error = 0.1475603, gradient norm = 0.0006719 (50 iterations in 0.015s)
[t-SNE] Iteration 750: error = 0.1473225, gradient norm = 0.0005192 (50 iterations in 0.015s)
[t-SNE] Iteration 800: error = 0.1475496, gradient norm = 0.0004693 (50 iterations in 0.014s)
[t-SNE] Iteration 850: error = 0.1475729, gradient norm = 0.0004920 (50 iterations in 0.015s)
[t-SNE] Iteration 900: error = 0.1474701, gradient norm = 0.0008084 (50 iterations in 0.015s)
[t-SNE] Iteration 950: error = 0.1475343, gradient norm = 0.0003916 (50 iterations in 0.014s)
[t-SNE] Iteration 1000: error = 0.1475320, gradient norm = 0.0003828 (50 iterations in 0.014s)
[t-SNE] KL divergence after 1000 iterations: 0.147532
[t-SNE] Computed conditional probabilities for sample 72 / 72
[t-SNE] Mean sigma: 0.582808
Beginning preprocessing + Leiden
2024-03-11 19:12:00.450970 MEMORY 3.421708288
Affmat transformed
2024-03-11 19:12:00.452002 MEMORY 3.421708288
sources, targets, weights extracted
2024-03-11 19:12:00.452400 MEMORY 3.421708288
About to launch parallel Leiden runs
2024-03-11 19:12:00.479215 MEMORY 3.421708288
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.6s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.7s finished
Parallel Leiden runs finished
2024-03-11 19:12:02.174879 MEMORY 3.421708288
Quality: 0.16390106786569733
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  53 out of  53 | elapsed:    0.0s finished
Got subclusters: Counter({0: 22, 2: 18, 1: 18, 3: 14})
On pattern 15
[t-SNE] Computing 52 nearest neighbors...
[t-SNE] Indexed 53 samples in 0.000s...
[t-SNE] Computed neighbors for 53 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 53 / 53
[t-SNE] Mean sigma: 1.106445
[t-SNE] Computed conditional probabilities in 0.001s
[t-SNE] Iteration 50: error = 48.5666924, gradient norm = 0.4175309 (50 iterations in 0.013s)
[t-SNE] Iteration 100: error = 44.9955482, gradient norm = 0.6770618 (50 iterations in 0.013s)
[t-SNE] Iteration 150: error = 42.8198471, gradient norm = 0.3736241 (50 iterations in 0.015s)
[t-SNE] Iteration 200: error = 41.3387604, gradient norm = 0.4808565 (50 iterations in 0.013s)
[t-SNE] Iteration 250: error = 42.9021683, gradient norm = 0.5342615 (50 iterations in 0.014s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 42.902168
[t-SNE] Iteration 300: error = 0.7049258, gradient norm = 0.0014869 (50 iterations in 0.013s)
[t-SNE] Iteration 350: error = 0.6359292, gradient norm = 0.0002439 (50 iterations in 0.013s)
[t-SNE] Iteration 400: error = 0.6323724, gradient norm = 0.0001993 (50 iterations in 0.013s)
[t-SNE] Iteration 450: error = 0.6211443, gradient norm = 0.0002598 (50 iterations in 0.013s)
[t-SNE] Iteration 500: error = 0.6143842, gradient norm = 0.0001484 (50 iterations in 0.013s)
[t-SNE] Iteration 550: error = 0.6048942, gradient norm = 0.0003297 (50 iterations in 0.013s)
[t-SNE] Iteration 600: error = 0.5974339, gradient norm = 0.0002574 (50 iterations in 0.013s)
[t-SNE] Iteration 650: error = 0.5879713, gradient norm = 0.0002730 (50 iterations in 0.013s)
[t-SNE] Iteration 700: error = 0.5841914, gradient norm = 0.0001782 (50 iterations in 0.013s)
[t-SNE] Iteration 750: error = 0.5781804, gradient norm = 0.0003564 (50 iterations in 0.013s)
[t-SNE] Iteration 800: error = 0.5540276, gradient norm = 0.0015365 (50 iterations in 0.013s)
[t-SNE] Iteration 850: error = 0.6783482, gradient norm = 0.0014676 (50 iterations in 0.015s)
[t-SNE] Iteration 900: error = 0.6153017, gradient norm = 0.0003642 (50 iterations in 0.013s)
[t-SNE] Iteration 950: error = 0.6082616, gradient norm = 0.0001742 (50 iterations in 0.013s)
[t-SNE] Iteration 1000: error = 0.6022390, gradient norm = 0.0001132 (50 iterations in 0.013s)
[t-SNE] KL divergence after 1000 iterations: 0.602239
[t-SNE] Computed conditional probabilities for sample 53 / 53
[t-SNE] Mean sigma: 1.106447
Beginning preprocessing + Leiden
2024-03-11 19:12:02.498088 MEMORY 3.421708288
Affmat transformed
2024-03-11 19:12:02.498913 MEMORY 3.421708288
sources, targets, weights extracted
2024-03-11 19:12:02.499262 MEMORY 3.421708288
About to launch parallel Leiden runs
2024-03-11 19:12:02.503283 MEMORY 3.421708288
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.6s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.7s finished
Parallel Leiden runs finished
2024-03-11 19:12:04.160813 MEMORY 3.421708288
Quality: 0.03168780633210476
Quality: 0.032368809297208964
Quality: 0.032415409498185124
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done  46 out of  46 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=24)]: Done  46 out of  46 | elapsed:    0.0s finished
Got subclusters: Counter({0: 23, 1: 21, 2: 9})
On pattern 16
[t-SNE] Computing 45 nearest neighbors...
[t-SNE] Indexed 46 samples in 0.000s...
[t-SNE] Computed neighbors for 46 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 46 / 46
[t-SNE] Mean sigma: 11.313708
[t-SNE] Computed conditional probabilities in 0.001s
[t-SNE] Iteration 50: error = 42.7706718, gradient norm = 0.4770096 (50 iterations in 0.015s)
[t-SNE] Iteration 100: error = 44.3657608, gradient norm = 0.6001415 (50 iterations in 0.014s)
[t-SNE] Iteration 150: error = 46.0420609, gradient norm = 0.4605798 (50 iterations in 0.012s)
[t-SNE] Iteration 200: error = 42.8040962, gradient norm = 0.4270302 (50 iterations in 0.014s)
[t-SNE] Iteration 250: error = 44.2722397, gradient norm = 0.5612643 (50 iterations in 0.014s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 44.272240
[t-SNE] Iteration 300: error = 0.6605074, gradient norm = 0.0009750 (50 iterations in 0.012s)
[t-SNE] Iteration 350: error = 0.6016869, gradient norm = 0.0002003 (50 iterations in 0.013s)
[t-SNE] Iteration 400: error = 0.5969805, gradient norm = 0.0000758 (50 iterations in 0.013s)
[t-SNE] Iteration 450: error = 0.5965935, gradient norm = 0.0000494 (50 iterations in 0.012s)
[t-SNE] Iteration 500: error = 0.5960079, gradient norm = 0.0000323 (50 iterations in 0.013s)
[t-SNE] Iteration 550: error = 0.5962158, gradient norm = 0.0000276 (50 iterations in 0.012s)
[t-SNE] Iteration 600: error = 0.5948743, gradient norm = 0.0000866 (50 iterations in 0.012s)
[t-SNE] Iteration 650: error = 0.5933319, gradient norm = 0.0000659 (50 iterations in 0.014s)
[t-SNE] Iteration 700: error = 0.5931262, gradient norm = 0.0000863 (50 iterations in 0.014s)
[t-SNE] Iteration 750: error = 0.5918128, gradient norm = 0.0001813 (50 iterations in 0.012s)
[t-SNE] Iteration 800: error = 0.5804009, gradient norm = 0.0032503 (50 iterations in 0.014s)
[t-SNE] Iteration 850: error = 0.6156020, gradient norm = 0.0011269 (50 iterations in 0.015s)
[t-SNE] Iteration 900: error = 0.5974251, gradient norm = 0.0001154 (50 iterations in 0.013s)
[t-SNE] Iteration 950: error = 0.5956752, gradient norm = 0.0000708 (50 iterations in 0.013s)
[t-SNE] Iteration 1000: error = 0.5947292, gradient norm = 0.0001098 (50 iterations in 0.013s)
[t-SNE] KL divergence after 1000 iterations: 0.594729
[t-SNE] Computed conditional probabilities for sample 46 / 46
[t-SNE] Mean sigma: 1125899906842624.000000
Beginning preprocessing + Leiden
2024-03-11 19:12:04.478092 MEMORY 3.421708288
Affmat transformed
2024-03-11 19:12:04.478857 MEMORY 3.421708288
sources, targets, weights extracted
2024-03-11 19:12:04.479179 MEMORY 3.421708288
About to launch parallel Leiden runs
2024-03-11 19:12:04.524422 MEMORY 3.421708288
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.6s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.6s finished
Parallel Leiden runs finished
2024-03-11 19:12:06.153279 MEMORY 3.421708288
Quality: -5.4622972811555424e-14
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done  20 out of  33 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=24)]: Done  33 out of  33 | elapsed:    0.0s finished
Got subclusters: Counter({0: 46})
On pattern 17
[t-SNE] Computing 32 nearest neighbors...
[t-SNE] Indexed 33 samples in 0.000s...
[t-SNE] Computed neighbors for 33 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 33 / 33
[t-SNE] Mean sigma: 9.688481
[t-SNE] Computed conditional probabilities in 0.001s
[t-SNE] Iteration 50: error = 43.1535072, gradient norm = 0.4922124 (50 iterations in 0.023s)
[t-SNE] Iteration 100: error = 42.9558983, gradient norm = 0.5782665 (50 iterations in 0.013s)
[t-SNE] Iteration 150: error = 42.8226509, gradient norm = 0.6126812 (50 iterations in 0.012s)
[t-SNE] Iteration 200: error = 45.2882843, gradient norm = 0.4274459 (50 iterations in 0.013s)
[t-SNE] Iteration 250: error = 42.4741249, gradient norm = 0.4327228 (50 iterations in 0.013s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 42.474125
[t-SNE] Iteration 300: error = 0.6322339, gradient norm = 0.0011397 (50 iterations in 0.012s)
[t-SNE] Iteration 350: error = 0.5324671, gradient norm = 0.0002462 (50 iterations in 0.013s)
[t-SNE] Iteration 400: error = 0.5240490, gradient norm = 0.0000603 (50 iterations in 0.013s)
[t-SNE] Iteration 450: error = 0.5222703, gradient norm = 0.0000465 (50 iterations in 0.011s)
[t-SNE] Iteration 500: error = 0.5194813, gradient norm = 0.0000751 (50 iterations in 0.013s)
[t-SNE] Iteration 550: error = 0.5193321, gradient norm = 0.0000235 (50 iterations in 0.011s)
[t-SNE] Iteration 600: error = 0.5193027, gradient norm = 0.0000189 (50 iterations in 0.013s)
[t-SNE] Iteration 650: error = 0.5192835, gradient norm = 0.0000190 (50 iterations in 0.013s)
[t-SNE] Iteration 700: error = 0.5192524, gradient norm = 0.0000199 (50 iterations in 0.016s)
[t-SNE] Iteration 750: error = 0.5192455, gradient norm = 0.0000212 (50 iterations in 0.014s)
[t-SNE] Iteration 800: error = 0.5192710, gradient norm = 0.0000236 (50 iterations in 0.014s)
[t-SNE] Iteration 850: error = 0.5185397, gradient norm = 0.0000370 (50 iterations in 0.015s)
[t-SNE] Iteration 900: error = 0.5177370, gradient norm = 0.0000982 (50 iterations in 0.015s)
[t-SNE] Iteration 950: error = 0.5138083, gradient norm = 0.0008293 (50 iterations in 0.013s)
[t-SNE] Iteration 1000: error = 1.2417886, gradient norm = 0.0037501 (50 iterations in 0.013s)
[t-SNE] KL divergence after 1000 iterations: 1.241789
[t-SNE] Computed conditional probabilities for sample 33 / 33
[t-SNE] Mean sigma: 1125899906842624.000000
Beginning preprocessing + Leiden
2024-03-11 19:12:06.458870 MEMORY 3.421708288
Affmat transformed
2024-03-11 19:12:06.459593 MEMORY 3.421708288
sources, targets, weights extracted
2024-03-11 19:12:06.459919 MEMORY 3.421708288
About to launch parallel Leiden runs
2024-03-11 19:12:06.488492 MEMORY 3.421708288
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.6s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.6s finished
Parallel Leiden runs finished
2024-03-11 19:12:08.105732 MEMORY 3.421708288
Quality: -7.105427357600852e-15
Got subclusters: Counter({0: 33})
