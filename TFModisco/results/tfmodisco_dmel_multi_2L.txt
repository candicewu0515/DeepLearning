/ru-auth/local/home/xwu05/.local/lib/python3.9/site-packages/pandas/core/computation/expressions.py:21: UserWarning: Pandas requires version '2.8.0' or newer of 'numexpr' (version '2.7.3' currently installed).
  from pandas.core.computation.check import NUMEXPR_INSTALLED
/ru-auth/local/home/xwu05/.local/lib/python3.9/site-packages/pandas/core/arrays/masked.py:62: UserWarning: Pandas requires version '1.3.4' or newer of 'bottleneck' (version '1.3.2' currently installed).
  from pandas.core import (
[22;0t]0;IPython: detect_peaks_scripts/run_modelMEMORY 10.7218944
On task head
Computing windowed sums on original
Generating null dist
peak(mu)= 6.2118391166675335e-06
Computing threshold
Subsampling!
For increasing = True , the minimum IR precision was 0.40549246600914257 occurring at 0.0 implying a frac_neg of 0.6820644698766398
To be conservative, adjusted frac neg is 0.95
For increasing = False , the minimum IR precision was 0.39390649315310844 occurring at -6.064482249712455e-12 implying a frac_neg of 0.6499104324716272
To be conservative, adjusted frac neg is 0.95
Thresholds from null dist were -0.41596201384175835  and  0.4548954520147781 with frac passing 0.096091
Final raw thresholds are -0.41596201384175835  and  0.4548954520147781
Final transformed thresholds are -0.8982210261010564  and  0.9132133370500145
saving plot to figures/scoredist_0.png
Got 296288 coords
On task testis
Computing windowed sums on original
Generating null dist
peak(mu)= 2.6668791452671287e-06
Computing threshold
Subsampling!
For increasing = True , the minimum IR precision was 0.39816937540639435 occurring at 0.0 implying a frac_neg of 0.6615970659108013
To be conservative, adjusted frac neg is 0.95
For increasing = False , the minimum IR precision was 0.39905247427771545 occurring at -4.860112312599085e-12 implying a frac_neg of 0.6640388007223933
To be conservative, adjusted frac neg is 0.95
Thresholds from null dist were -0.5938741376122816  and  0.544208523147697 with frac passing 0.106538
Final raw thresholds are -0.5938741376122816  and  0.544208523147697
Final transformed thresholds are -0.9010329806723111  and  0.8844482919057938
saving plot to figures/scoredist_1.png
Got 330307 coords
After resolving overlaps, got 381251 seqlets
Across all tasks, the weakest transformed threshold used was: 0.8843482919057938
MEMORY 12.9542144
381251 identified in total
min_metacluster_size_frac * len(seqlets) = 3812 is more than min_metacluster_size=100.
Using it as a new min_metacluster_size
6 activity patterns with support >= 3812 out of 8 possible patterns
Metacluster sizes:  [178077, 131792, 31481, 19360, 12031, 8510]
Idx to activities:  {0: '-1,-1', 1: '1,1', 2: '0,1', 3: '-1,0', 4: '0,-1', 5: '1,0'}
MEMORY 12.880228352
On metacluster 5
Metacluster size 8510
Relevant tasks:  ('head',)
Relevant signs:  (1,)
TfModiscoSeqletsToPatternsFactory: seed=1234
(Round 1) num seqlets: 8510
(Round 1) Computing coarse affmat
2024-03-13 16:59:05.431352 MEMORY 12.87866368
Beginning embedding computation
MEMORY 12.87866368
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
At the beginning of embedding call
2024-03-13 16:59:05.431552 MEMORY 12.87866368
before computing embeddings fwd
2024-03-13 16:59:05.440349 MEMORY 12.878700544
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:   22.7s
[Parallel(n_jobs=24)]: Done 152 tasks      | elapsed:   24.5s
[Parallel(n_jobs=24)]: Done 402 tasks      | elapsed:   27.5s
[Parallel(n_jobs=24)]: Done 752 tasks      | elapsed:   31.4s
[Parallel(n_jobs=24)]: Done 1202 tasks      | elapsed:   36.3s
[Parallel(n_jobs=24)]: Done 1752 tasks      | elapsed:   42.4s
[Parallel(n_jobs=24)]: Done 2402 tasks      | elapsed:   49.5s
[Parallel(n_jobs=24)]: Done 3152 tasks      | elapsed:   57.6s
[Parallel(n_jobs=24)]: Done 4002 tasks      | elapsed:  1.1min
[Parallel(n_jobs=24)]: Done 4952 tasks      | elapsed:  1.3min
[Parallel(n_jobs=24)]: Done 6002 tasks      | elapsed:  1.5min
[Parallel(n_jobs=24)]: Done 7152 tasks      | elapsed:  1.7min
[Parallel(n_jobs=24)]: Done 8402 tasks      | elapsed:  1.9min
[Parallel(n_jobs=24)]: Done 8510 out of 8510 | elapsed:  1.9min finished
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 152 tasks      | elapsed:    1.9s
[Parallel(n_jobs=24)]: Done 402 tasks      | elapsed:    4.7s
[Parallel(n_jobs=24)]: Done 752 tasks      | elapsed:    8.5s
[Parallel(n_jobs=24)]: Done 1202 tasks      | elapsed:   13.4s
[Parallel(n_jobs=24)]: Done 1752 tasks      | elapsed:   19.4s
[Parallel(n_jobs=24)]: Done 2402 tasks      | elapsed:   26.6s
[Parallel(n_jobs=24)]: Done 3152 tasks      | elapsed:   34.9s
[Parallel(n_jobs=24)]: Done 4002 tasks      | elapsed:   44.2s
[Parallel(n_jobs=24)]: Done 4952 tasks      | elapsed:   54.7s
[Parallel(n_jobs=24)]: Done 6002 tasks      | elapsed:  1.1min
[Parallel(n_jobs=24)]: Done 7152 tasks      | elapsed:  1.3min
[Parallel(n_jobs=24)]: Done 8402 tasks      | elapsed:  1.5min
[Parallel(n_jobs=24)]: Done 8510 out of 8510 | elapsed:  1.6min finished
after computing embeddings fwd
2024-03-13 17:01:01.706294 MEMORY 13.174624256
after computing embeddings rev
2024-03-13 17:02:35.356324 MEMORY 13.522292736
before computing sparse embeddings fwd
2024-03-13 17:02:35.356419 MEMORY 13.522292736
Constructing csr matrix...
csr matrix made in 1.2388088703155518 s
after computing sparse embeddings fwd
2024-03-13 17:02:37.013043 MEMORY 13.55669504
before computing sparse embeddings rev
2024-03-13 17:02:37.013127 MEMORY 13.55669504
Constructing csr matrix...
csr matrix made in 1.0030725002288818 s
after computing sparse embeddings rev
2024-03-13 17:02:38.413758 MEMORY 13.607759872
Finished embedding computation in 216.76 s
MEMORY 13.240393728
Starting affinity matrix computations
MEMORY 13.23986944
Batching in slices of size 7885
  0%|          | 0/2 [00:00<?, ?it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:07<00:07,  7.44s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:09<00:00,  4.22s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:09<00:00,  4.70s/it]
Finished affinity matrix computations in 9.51 s
MEMORY 13.320011776
(Round 1) Computed coarse affmat
2024-03-13 17:02:53.893779 MEMORY 13.234905088
(Round 1) Computing affinity matrix on nearest neighbors
2024-03-13 17:02:53.894017 MEMORY 13.234905088
Launching nearest neighbors affmat calculation job
MEMORY 13.234905088
Parallel runs completed
MEMORY 13.402517504
Job completed in: 28.37 s
MEMORY 13.402968064
Launching nearest neighbors affmat calculation job
MEMORY 13.399744512
Parallel runs completed
MEMORY 13.517324288
Job completed in: 26.83 s
MEMORY 13.515825152
(Round 1) Computed affinity matrix on nearest neighbors in 58.13 s
2024-03-13 17:03:52.023203 MEMORY 13.514399744
Filtered down to 7788 of 8510
(Round 1) Retained 7788 rows out of 8510 after filtering
2024-03-13 17:03:56.376809 MEMORY 13.516685312
(Round 1) Computing density adapted affmat
2024-03-13 17:03:59.404736 MEMORY 13.563957248
Symmetrizing nearest neighbors
Computing betas for density adaptation
Computing normalizing denominators
(Round 1) Computing clustering
2024-03-13 17:04:57.169044 MEMORY 13.809422336
Beginning preprocessing + Leiden
2024-03-13 17:04:57.178544 MEMORY 13.809422336
Affmat transformed
2024-03-13 17:04:57.178655 MEMORY 13.809422336
sources, targets, weights extracted
2024-03-13 17:04:57.581861 MEMORY 13.829025792
About to launch parallel Leiden runs
2024-03-13 17:04:57.673219 MEMORY 13.829025792
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:   26.3s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:  1.6min finished
Parallel Leiden runs finished
2024-03-13 17:06:33.110508 MEMORY 13.828907008
Quality: 0.33907977588234084
Quality: 0.3390821133089326
Quality: 0.33908816173599843
Quality: 0.33935734901984305
Got 5 clusters after round 1
Counts:
{2: 1475, 0: 1802, 1: 1796, 3: 1416, 4: 1299}
2024-03-13 17:06:33.147321 MEMORY 13.828907008
(Round 1) Aggregating seqlets in each cluster
2024-03-13 17:06:33.147417 MEMORY 13.828907008
Aggregating for cluster 0 with 1802 seqlets
2024-03-13 17:06:33.154817 MEMORY 13.828907008
Removed 1 duplicate seqlets
Skipped 1 seqlets that went over sequence edge during flank expansion
Trimming eliminated 0 seqlets out of 1800
Aggregating for cluster 1 with 1796 seqlets
2024-03-13 17:06:37.860878 MEMORY 13.82914048
Skipped 8 due to duplicates
Trimming eliminated 0 seqlets out of 1788
Aggregating for cluster 2 with 1475 seqlets
2024-03-13 17:06:41.567341 MEMORY 13.829144576
Trimming eliminated 0 seqlets out of 1475
Aggregating for cluster 3 with 1416 seqlets
2024-03-13 17:06:45.033173 MEMORY 13.829152768
Skipped 5 due to duplicates
Trimming eliminated 0 seqlets out of 1411
Aggregating for cluster 4 with 1299 seqlets
2024-03-13 17:06:48.355006 MEMORY 13.829152768
Skipped 4 due to duplicates
Trimming eliminated 0 seqlets out of 1295
(Round 2) num seqlets: 7769
(Round 2) Computing coarse affmat
2024-03-13 17:06:53.289200 MEMORY 13.829156864
Beginning embedding computation
MEMORY 13.829156864
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 368 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done 1368 tasks      | elapsed:    2.0s
[Parallel(n_jobs=24)]: Done 2768 tasks      | elapsed:    3.8s
[Parallel(n_jobs=24)]: Done 4568 tasks      | elapsed:    6.2s
[Parallel(n_jobs=24)]: Done 6768 tasks      | elapsed:    9.1s
[Parallel(n_jobs=24)]: Done 7722 out of 7769 | elapsed:   10.4s remaining:    0.1s
[Parallel(n_jobs=24)]: Done 7769 out of 7769 | elapsed:   10.5s finished
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 368 tasks      | elapsed:    0.8s
[Parallel(n_jobs=24)]: Done 1368 tasks      | elapsed:    2.1s
[Parallel(n_jobs=24)]: Done 2768 tasks      | elapsed:    4.1s
[Parallel(n_jobs=24)]: Done 4568 tasks      | elapsed:    6.6s
[Parallel(n_jobs=24)]: Done 6768 tasks      | elapsed:    9.5s
[Parallel(n_jobs=24)]: Done 7722 out of 7769 | elapsed:   10.8s remaining:    0.1s
[Parallel(n_jobs=24)]: Done 7769 out of 7769 | elapsed:   10.9s finished
At the beginning of embedding call
2024-03-13 17:06:53.289400 MEMORY 13.829156864
before computing embeddings fwd
2024-03-13 17:06:53.298126 MEMORY 13.829156864
after computing embeddings fwd
2024-03-13 17:07:03.758961 MEMORY 14.102089728
after computing embeddings rev
2024-03-13 17:07:14.645698 MEMORY 14.420451328
before computing sparse embeddings fwd
2024-03-13 17:07:14.645786 MEMORY 14.420451328
Constructing csr matrix...
csr matrix made in 0.88934326171875 s
after computing sparse embeddings fwd
2024-03-13 17:07:15.948206 MEMORY 14.478741504
before computing sparse embeddings rev
2024-03-13 17:07:15.948294 MEMORY 14.478741504
Constructing csr matrix...
csr matrix made in 0.8593704700469971 s
after computing sparse embeddings rev
2024-03-13 17:07:17.158037 MEMORY 14.603010048
Finished embedding computation in 26.19 s
MEMORY 14.338015232
Starting affinity matrix computations
MEMORY 14.338015232
Batching in slices of size 7769
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:08<00:00,  8.75s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:08<00:00,  8.75s/it]
Finished affinity matrix computations in 8.79 s
MEMORY 14.338035712
(Round 2) Computed coarse affmat
2024-03-13 17:07:30.093335 MEMORY 14.135783424
(Round 2) Computing affinity matrix on nearest neighbors
2024-03-13 17:07:30.093471 MEMORY 14.135783424
Launching nearest neighbors affmat calculation job
MEMORY 14.135783424
Parallel runs completed
MEMORY 14.153080832
Job completed in: 12.96 s
MEMORY 14.152945664
Launching nearest neighbors affmat calculation job
MEMORY 14.150578176
Parallel runs completed
MEMORY 14.175240192
Job completed in: 12.89 s
MEMORY 14.17506816
(Round 2) Computed affinity matrix on nearest neighbors in 28.64 s
2024-03-13 17:07:58.734180 MEMORY 14.172889088
Not applying filtering for rounds above first round
2024-03-13 17:07:58.735015 MEMORY 14.172889088
(Round 2) Computing density adapted affmat
2024-03-13 17:08:01.751261 MEMORY 14.181863424
Symmetrizing nearest neighbors
Computing betas for density adaptation
Computing normalizing denominators
(Round 2) Computing clustering
2024-03-13 17:09:02.967799 MEMORY 14.371303424
Beginning preprocessing + Leiden
2024-03-13 17:09:02.978421 MEMORY 14.371303424
Affmat transformed
2024-03-13 17:09:02.978551 MEMORY 14.371303424
sources, targets, weights extracted
2024-03-13 17:09:03.224387 MEMORY 14.371315712
About to launch parallel Leiden runs
2024-03-13 17:09:03.296539 MEMORY 14.371315712
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:   20.5s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:  1.3min finished
Parallel Leiden runs finished
2024-03-13 17:10:21.009632 MEMORY 14.371319808
Quality: 0.44538827994730396
Got 6 clusters after round 2
Counts:
{3: 1339, 1: 1749, 5: 326, 2: 1639, 0: 1785, 4: 931}
2024-03-13 17:10:21.031301 MEMORY 14.371319808
(Round 2) Aggregating seqlets in each cluster
2024-03-13 17:10:21.031391 MEMORY 14.371319808
Aggregating for cluster 0 with 1785 seqlets
2024-03-13 17:10:21.035821 MEMORY 14.371319808
Skipped 1 due to duplicates
Trimming eliminated 0 seqlets out of 1784
Aggregating for cluster 1 with 1749 seqlets
2024-03-13 17:10:23.929850 MEMORY 14.371319808
Skipped 1 due to duplicates
Trimming eliminated 0 seqlets out of 1748
Aggregating for cluster 2 with 1639 seqlets
2024-03-13 17:10:26.628483 MEMORY 14.371323904
Skipped 2 due to duplicates
Trimming eliminated 0 seqlets out of 1637
Aggregating for cluster 3 with 1339 seqlets
2024-03-13 17:10:29.060056 MEMORY 14.371323904
Trimming eliminated 0 seqlets out of 1339
Aggregating for cluster 4 with 931 seqlets
2024-03-13 17:10:31.190805 MEMORY 14.371323904
Skipped 3 due to duplicates
Trimming eliminated 0 seqlets out of 928
Aggregating for cluster 5 with 326 seqlets
2024-03-13 17:10:32.661947 MEMORY 14.371323904
Trimming eliminated 0 seqlets out of 326
Dropping cluster 5 with 326 seqlets due to sign disagreement
Got 5 clusters
Splitting into subclusters...
2024-03-13 17:10:33.189389 MEMORY 14.371323904
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 1650 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 1784 out of 1784 | elapsed:    0.3s finished
Inspecting pattern 0 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 1784
[t-SNE] Computed conditional probabilities for sample 1784 / 1784
[t-SNE] Mean sigma: 0.325094
Beginning preprocessing + Leiden
2024-03-13 17:10:35.369344 MEMORY 14.371360768
Affmat transformed
2024-03-13 17:10:35.413261 MEMORY 14.37136896
sources, targets, weights extracted
2024-03-13 17:10:35.427491 MEMORY 14.371373056
About to launch parallel Leiden runs
2024-03-13 17:10:35.438486 MEMORY 14.371373056
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    6.0s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   18.0s finished
Parallel Leiden runs finished
2024-03-13 17:10:53.413870 MEMORY 14.371373056
Quality: 0.42500439534651185
Quality: 0.42560965764945125
Quality: 0.42566893345913487
Quality: 0.42576116241594064
Got subclusters: Counter({0: 254, 1: 243, 2: 232, 3: 221, 4: 194, 5: 171, 6: 138, 7: 130, 8: 107, 9: 94})
On merging iteration 1
Numbers for each pattern pre-subsample: [254, 243, 232, 221, 194, 171, 138, 130, 107, 94]
Numbers after subsampling: [254, 243, 232, 221, 194, 171, 138, 130, 107, 94]
Computing sims for pattern 0
Computed sims for pattern 0 in 2.0520029067993164 s
Computing sims for pattern 1
Computed sims for pattern 1 in 1.8577837944030762 s
Computing sims for pattern 2
Computed sims for pattern 2 in 2.329521656036377 s
Computing sims for pattern 3
Computed sims for pattern 3 in 5.320480823516846 s
Computing sims for pattern 4
Computed sims for pattern 4 in 1.9071319103240967 s
Computing sims for pattern 5
Computed sims for pattern 5 in 1.6482150554656982 s
Computing sims for pattern 6
Computed sims for pattern 6 in 1.4260423183441162 s
Computing sims for pattern 7
Computed sims for pattern 7 in 1.3728160858154297 s
Computing sims for pattern 8
Computed sims for pattern 8 in 1.0304310321807861 s
Computing sims for pattern 9
Computed sims for pattern 9 in 1.005608081817627 s
Cluster sizes
[254 243 232 221 194 171 138 130 107  94]
Cross-contamination matrix:
[[1.   0.82 0.61 0.68 0.72 0.66 0.66 0.61 0.63 0.54]
 [0.45 1.   0.62 0.59 0.54 0.5  0.46 0.49 0.54 0.33]
 [0.55 0.94 1.   0.68 0.54 0.74 0.65 0.63 0.63 0.55]
 [0.6  0.89 0.67 1.   0.69 0.67 0.5  0.61 0.67 0.46]
 [0.51 0.83 0.47 0.57 1.   0.55 0.53 0.46 0.72 0.24]
 [0.55 0.77 0.7  0.67 0.56 1.   0.63 0.56 0.6  0.44]
 [0.63 0.82 0.72 0.57 0.62 0.71 1.   0.59 0.55 0.51]
 [0.46 0.79 0.61 0.6  0.46 0.54 0.37 1.   0.44 0.49]
 [0.51 0.8  0.57 0.62 0.7  0.59 0.46 0.55 1.   0.36]
 [0.62 0.75 0.74 0.64 0.44 0.63 0.62 0.7  0.54 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.83 0.81 0.84 0.79 0.78 0.79 0.8  0.85 0.77]
 [0.83 1.   0.94 0.86 0.82 0.85 0.79 0.79 0.82 0.72]
 [0.81 0.94 1.   0.89 0.8  0.86 0.82 0.83 0.85 0.81]
 [0.84 0.86 0.89 1.   0.81 0.84 0.76 0.79 0.87 0.75]
 [0.79 0.82 0.8  0.81 1.   0.83 0.77 0.75 0.86 0.71]
 [0.78 0.85 0.86 0.84 0.83 1.   0.81 0.84 0.84 0.72]
 [0.79 0.79 0.82 0.76 0.77 0.81 1.   0.74 0.82 0.75]
 [0.8  0.79 0.83 0.79 0.75 0.84 0.74 1.   0.8  0.78]
 [0.85 0.82 0.85 0.87 0.86 0.84 0.82 0.8  1.   0.82]
 [0.77 0.72 0.81 0.75 0.71 0.72 0.75 0.78 0.82 1.  ]]
Collapsing 1 & 2 with crosscontam 0.6159872688897321 and sim 0.9367707436764501
Collapsing 2 & 3 with crosscontam 0.6665208504902096 and sim 0.8918445603127405
Collapsing 3 & 8 with crosscontam 0.6162264438086786 and sim 0.8730371922224067
Collapsing 2 & 5 with crosscontam 0.699009012164514 and sim 0.8635338730525803
Collapsing 4 & 8 with crosscontam 0.7033209547510855 and sim 0.8630768899734854
Collapsing 1 & 3 with crosscontam 0.5874678949445591 and sim 0.8599938864209985
Collapsing 2 & 8 with crosscontam 0.567727108917528 and sim 0.8510534564001344
Trimming eliminated 0 seqlets out of 475
Trimming eliminated 0 seqlets out of 696
Trimming eliminated 0 seqlets out of 803
Trimming eliminated 0 seqlets out of 974
Trimming eliminated 0 seqlets out of 1168
Unmerged patterns remapping: OrderedDict([(0, 1), (6, 2), (7, 3), (9, 4)])
Time spent on merging iteration: 6.452230930328369
On merging iteration 2
Numbers for each pattern pre-subsample: [1168, 254, 138, 130, 94]
Numbers after subsampling: [300, 254, 138, 130, 94]
Computing sims for pattern 0
Computed sims for pattern 0 in 1.1749792098999023 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.26711273193359375 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.1853468418121338 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.17160272598266602 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.13338160514831543 s
Cluster sizes
[1168  254  138  130   94]
Cross-contamination matrix:
[[1.   0.79 0.78 0.86 0.64]
 [0.69 1.   0.66 0.61 0.54]
 [0.65 0.63 1.   0.59 0.51]
 [0.63 0.46 0.37 1.   0.49]
 [0.64 0.62 0.62 0.7  1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.86 0.83 0.85 0.79]
 [0.86 1.   0.79 0.8  0.77]
 [0.83 0.79 1.   0.74 0.75]
 [0.85 0.8  0.74 1.   0.78]
 [0.79 0.77 0.75 0.78 1.  ]]
Collapsing 0 & 1 with crosscontam 0.6889157561517223 and sim 0.8638144678819568
Trimming eliminated 0 seqlets out of 1422
Unmerged patterns remapping: OrderedDict([(2, 1), (3, 2), (4, 3)])
Time spent on merging iteration: 2.0381321907043457
On merging iteration 3
Numbers for each pattern pre-subsample: [1422, 138, 130, 94]
Numbers after subsampling: [300, 138, 130, 94]
Computing sims for pattern 0
Computed sims for pattern 0 in 0.8580195903778076 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.1815509796142578 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.17870378494262695 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.13354134559631348 s
Cluster sizes
[1422  138  130   94]
Cross-contamination matrix:
[[1.   0.79 0.87 0.66]
 [0.65 1.   0.59 0.51]
 [0.64 0.37 1.   0.49]
 [0.65 0.62 0.7  1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.83 0.85 0.8 ]
 [0.83 1.   0.74 0.75]
 [0.85 0.74 1.   0.78]
 [0.8  0.75 0.78 1.  ]]
Collapsing 0 & 2 with crosscontam 0.63752862388105 and sim 0.8506806516679113
Trimming eliminated 0 seqlets out of 1552
Unmerged patterns remapping: OrderedDict([(1, 1), (3, 2)])
Time spent on merging iteration: 1.9609320163726807
On merging iteration 4
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 1650 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 1748 out of 1748 | elapsed:    0.3s finished
Numbers for each pattern pre-subsample: [1552, 138, 94]
Numbers after subsampling: [300, 138, 94]
Computing sims for pattern 0
Computed sims for pattern 0 in 0.5517008304595947 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.18145751953125 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.1281421184539795 s
Cluster sizes
[1552  138   94]
Cross-contamination matrix:
[[1.   0.81 0.71]
 [0.6  1.   0.51]
 [0.62 0.62 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.83 0.81]
 [0.83 1.   0.75]
 [0.81 0.75 1.  ]]
Inspecting pattern 1 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 1748
[t-SNE] Computed conditional probabilities for sample 1748 / 1748
[t-SNE] Mean sigma: 0.366734
Beginning preprocessing + Leiden
2024-03-13 17:11:29.323045 MEMORY 14.371414016
Affmat transformed
2024-03-13 17:11:29.342293 MEMORY 14.371414016
sources, targets, weights extracted
2024-03-13 17:11:29.353061 MEMORY 14.371414016
About to launch parallel Leiden runs
2024-03-13 17:11:29.369945 MEMORY 14.371414016
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    5.4s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   17.2s finished
Parallel Leiden runs finished
2024-03-13 17:11:46.554065 MEMORY 14.371414016
Quality: 0.4599879577012646
Quality: 0.46217000759593313
Quality: 0.46427086349319674
Quality: 0.46442288621827144
Quality: 0.4646037736154012
Quality: 0.46490149454580526
Quality: 0.4651295313306437
Got subclusters: Counter({0: 365, 1: 350, 2: 319, 3: 271, 4: 154, 5: 146, 6: 143})
On merging iteration 1
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 1637 out of 1637 | elapsed:    0.7s finished
Numbers for each pattern pre-subsample: [365, 350, 319, 271, 154, 146, 143]
Numbers after subsampling: [300, 300, 300, 271, 154, 146, 143]
Computing sims for pattern 0
Computed sims for pattern 0 in 1.9777476787567139 s
Computing sims for pattern 1
Computed sims for pattern 1 in 1.9382293224334717 s
Computing sims for pattern 2
Computed sims for pattern 2 in 1.9219048023223877 s
Computing sims for pattern 3
Computed sims for pattern 3 in 1.6646738052368164 s
Computing sims for pattern 4
Computed sims for pattern 4 in 1.0119154453277588 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.9837555885314941 s
Computing sims for pattern 6
Computed sims for pattern 6 in 1.106982707977295 s
Cluster sizes
[365 350 319 271 154 146 143]
Cross-contamination matrix:
[[1.   0.36 0.67 0.66 0.63 0.53 0.73]
 [0.32 1.   0.67 0.38 0.63 0.69 0.52]
 [0.53 0.56 1.   0.47 0.34 0.53 0.55]
 [0.77 0.5  0.7  1.   0.56 0.68 0.63]
 [0.67 0.73 0.65 0.5  1.   0.59 0.68]
 [0.5  0.71 0.5  0.53 0.5  1.   0.36]
 [0.65 0.5  0.61 0.46 0.55 0.29 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.4  0.61 0.83 0.62 0.52 0.76]
 [0.4  1.   0.76 0.48 0.73 0.73 0.56]
 [0.61 0.76 1.   0.66 0.59 0.56 0.59]
 [0.83 0.48 0.66 1.   0.7  0.55 0.69]
 [0.62 0.73 0.59 0.7  1.   0.49 0.73]
 [0.52 0.73 0.56 0.55 0.49 1.   0.47]
 [0.76 0.56 0.59 0.69 0.73 0.47 1.  ]]
Inspecting pattern 2 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 1637
[t-SNE] Computed conditional probabilities for sample 1637 / 1637
[t-SNE] Mean sigma: 0.340181
Beginning preprocessing + Leiden
2024-03-13 17:11:59.968484 MEMORY 14.373445632
Affmat transformed
2024-03-13 17:11:59.987140 MEMORY 14.373445632
sources, targets, weights extracted
2024-03-13 17:12:00.000354 MEMORY 14.373445632
About to launch parallel Leiden runs
2024-03-13 17:12:00.009081 MEMORY 14.373445632
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    5.8s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   18.0s finished
Parallel Leiden runs finished
2024-03-13 17:12:18.004406 MEMORY 14.373445632
Quality: 0.44528116048012867
Quality: 0.44590751092493536
Quality: 0.44634970485082803
Quality: 0.44641936499268986
Got subclusters: Counter({0: 304, 1: 300, 2: 278, 3: 256, 4: 171, 5: 169, 6: 152, 7: 5, 8: 2})
On merging iteration 1
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 1290 tasks      | elapsed:    0.6s
[Parallel(n_jobs=24)]: Done 1339 out of 1339 | elapsed:    0.6s finished
Numbers for each pattern pre-subsample: [304, 300, 278, 256, 171, 169, 152, 5, 2]
Numbers after subsampling: [300, 300, 278, 256, 171, 169, 152, 5, 2]
Computing sims for pattern 0
Computed sims for pattern 0 in 2.38393497467041 s
Computing sims for pattern 1
Computed sims for pattern 1 in 2.3743808269500732 s
Computing sims for pattern 2
Computed sims for pattern 2 in 2.176327705383301 s
Computing sims for pattern 3
Computed sims for pattern 3 in 1.8854501247406006 s
Computing sims for pattern 4
Computed sims for pattern 4 in 4.158223867416382 s
Computing sims for pattern 5
Computed sims for pattern 5 in 1.421250581741333 s
Computing sims for pattern 6
Computed sims for pattern 6 in 1.2365808486938477 s
Computing sims for pattern 7
Computed sims for pattern 7 in 0.16524887084960938 s
Computing sims for pattern 8
Computed sims for pattern 8 in 0.13962697982788086 s
Cluster sizes
[304 300 278 256 171 169 152   5   2]
Cross-contamination matrix:
[[1.   0.87 0.55 0.35 0.36 0.6  0.55 0.57 0.2 ]
 [0.58 1.   0.4  0.59 0.39 0.57 0.5  0.39 0.2 ]
 [0.62 0.74 1.   0.55 0.55 0.77 0.46 0.3  0.32]
 [0.37 0.89 0.5  1.   0.53 0.66 0.64 0.64 0.27]
 [0.6  0.93 0.75 0.79 1.   0.56 0.76 0.65 0.39]
 [0.6  0.86 0.68 0.48 0.46 1.   0.56 0.51 0.25]
 [0.63 0.88 0.47 0.7  0.58 0.64 1.   0.7  0.31]
 [0.01 0.02 0.   0.02 0.   0.02 0.02 1.   0.  ]
 [0.   0.   0.   0.   0.   0.   0.   0.   1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.81 0.71 0.65 0.71 0.7  0.77 0.58 0.35]
 [0.81 1.   0.74 0.83 0.79 0.79 0.82 0.5  0.44]
 [0.71 0.74 1.   0.65 0.79 0.82 0.8  0.46 0.48]
 [0.65 0.83 0.65 1.   0.83 0.7  0.69 0.59 0.47]
 [0.71 0.79 0.79 0.83 1.   0.64 0.82 0.54 0.42]
 [0.7  0.79 0.82 0.7  0.64 1.   0.68 0.48 0.37]
 [0.77 0.82 0.8  0.69 0.82 0.68 1.   0.61 0.45]
 [0.58 0.5  0.46 0.59 0.54 0.48 0.61 1.   0.26]
 [0.35 0.44 0.48 0.47 0.42 0.37 0.45 0.26 1.  ]]
Inspecting pattern 3 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 1339
[t-SNE] Computed conditional probabilities for sample 1339 / 1339
[t-SNE] Mean sigma: 0.344697
Beginning preprocessing + Leiden
2024-03-13 17:12:36.400717 MEMORY 14.373449728
Affmat transformed
2024-03-13 17:12:36.416249 MEMORY 14.373449728
sources, targets, weights extracted
2024-03-13 17:12:36.426539 MEMORY 14.373449728
About to launch parallel Leiden runs
2024-03-13 17:12:36.434127 MEMORY 14.373449728
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    4.2s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   15.7s finished
Parallel Leiden runs finished
2024-03-13 17:12:52.097616 MEMORY 14.373449728
Quality: 0.3901204228024244
Quality: 0.3925584817849077
Quality: 0.3927315016302848
Quality: 0.39502832009545763
Quality: 0.3954450473496049
Quality: 0.3955487451520933
Quality: 0.3957513507454404
Quality: 0.3964350222738333
Quality: 0.3965868658015358
Got subclusters: Counter({0: 237, 1: 218, 2: 208, 3: 170, 4: 160, 5: 133, 6: 109, 7: 104})
On merging iteration 1
Numbers for each pattern pre-subsample: [237, 218, 208, 170, 160, 133, 109, 104]
Numbers after subsampling: [237, 218, 208, 170, 160, 133, 109, 104]
Computing sims for pattern 0
Computed sims for pattern 0 in 1.8933436870574951 s
Computing sims for pattern 1
Computed sims for pattern 1 in 1.742187261581421 s
Computing sims for pattern 2
Computed sims for pattern 2 in 1.6521844863891602 s
Computing sims for pattern 3
Computed sims for pattern 3 in 1.2076408863067627 s
Computing sims for pattern 4
Computed sims for pattern 4 in 1.1256365776062012 s
Computing sims for pattern 5
Computed sims for pattern 5 in 1.0171990394592285 s
Computing sims for pattern 6
Computed sims for pattern 6 in 0.833543062210083 s
Computing sims for pattern 7
Computed sims for pattern 7 in 0.7596189975738525 s
Cluster sizes
[237 218 208 170 160 133 109 104]
Cross-contamination matrix:
[[1.   0.73 0.58 0.81 0.72 0.61 0.89 0.72]
 [0.42 1.   0.44 0.73 0.62 0.6  0.58 0.58]
 [0.44 0.72 1.   0.78 0.72 0.68 0.82 0.72]
 [0.38 0.76 0.49 1.   0.55 0.56 0.56 0.51]
 [0.52 0.78 0.58 0.69 1.   0.33 0.71 0.67]
 [0.6  0.91 0.66 0.82 0.5  1.   0.49 0.69]
 [0.5  0.59 0.51 0.55 0.55 0.53 1.   0.51]
 [0.49 0.82 0.66 0.75 0.75 0.62 0.76 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.82 0.77 0.76 0.77 0.76 0.85 0.76]
 [0.82 1.   0.8  0.86 0.81 0.81 0.77 0.84]
 [0.77 0.8  1.   0.84 0.79 0.79 0.84 0.9 ]
 [0.76 0.86 0.84 1.   0.81 0.81 0.79 0.83]
 [0.77 0.81 0.79 0.81 1.   0.72 0.87 0.89]
 [0.76 0.81 0.79 0.81 0.72 1.   0.73 0.81]
 [0.85 0.77 0.84 0.79 0.87 0.73 1.   0.86]
 [0.76 0.84 0.9  0.83 0.89 0.81 0.86 1.  ]]
Collapsing 2 & 7 with crosscontam 0.657843696933756 and sim 0.8960894663712603
Collapsing 4 & 7 with crosscontam 0.6681826735276442 and sim 0.8884698670865312
Collapsing 4 & 6 with crosscontam 0.5519628324925543 and sim 0.8736069034383188
Collapsing 6 & 7 with crosscontam 0.513052544056483 and sim 0.8606741696762749
Collapsing 1 & 3 with crosscontam 0.7346266467891498 and sim 0.8586921119894203
Trimming eliminated 0 seqlets out of 312
Skipped 1 due to duplicates
Trimming eliminated 0 seqlets out of 471
Trimming eliminated 0 seqlets out of 580
Trimming eliminated 0 seqlets out of 388
Unmerged patterns remapping: OrderedDict([(0, 2), (5, 3)])
Time spent on merging iteration: 3.4299216270446777
On merging iteration 2
Numbers for each pattern pre-subsample: [580, 388, 237, 133]
Numbers after subsampling: [300, 300, 237, 133]
Computing sims for pattern 0
Computed sims for pattern 0 in 0.932589054107666 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.9351446628570557 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.6122903823852539 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.3468759059906006 s
Cluster sizes
[580 388 237 133]
Cross-contamination matrix:
[[1.   0.99 0.67 0.91]
 [0.68 1.   0.61 0.74]
 [0.62 0.72 1.   0.61]
 [0.66 0.75 0.6  1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.89 0.77 0.84]
 [0.89 1.   0.83 0.83]
 [0.77 0.83 1.   0.76]
 [0.84 0.83 0.76 1.  ]]
Collapsing 0 & 1 with crosscontam 0.6817968948148148 and sim 0.8897275799858758
Trimming eliminated 0 seqlets out of 968
Unmerged patterns remapping: OrderedDict([(2, 1), (3, 2)])
Time spent on merging iteration: 1.9772791862487793
On merging iteration 3
Numbers for each pattern pre-subsample: [968, 237, 133]
Numbers after subsampling: [300, 237, 133]
Computing sims for pattern 0
Computed sims for pattern 0 in 0.6097569465637207 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.31411194801330566 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.177656888961792 s
Cluster sizes
[968 237 133]
Cross-contamination matrix:
[[1.   0.76 0.95]
 [0.65 1.   0.61]
 [0.68 0.6  1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.79 0.85]
 [0.79 1.   0.76]
 [0.85 0.76 1.  ]]
Collapsing 0 & 2 with crosscontam 0.6757699494935543 and sim 0.851590550118408
Trimming eliminated 0 seqlets out of 1101
Unmerged patterns remapping: OrderedDict([(1, 1)])
Time spent on merging iteration: 1.9567863941192627
On merging iteration 4
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 928 out of 928 | elapsed:    0.4s finished
Numbers for each pattern pre-subsample: [1101, 237]
Numbers after subsampling: [300, 237]
Computing sims for pattern 0
Computed sims for pattern 0 in 0.32749462127685547 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.3161201477050781 s
Cluster sizes
[1101  237]
Cross-contamination matrix:
[[1.   0.75]
 [0.68 1.  ]]
Pattern-to-pattern sim matrix:
[[1.  0.8]
 [0.8 1. ]]
Inspecting pattern 4 for spurious merging
Warning: each seqlet is not its own nearest neighbor; there may be duplicates
[t-SNE] Computed conditional probabilities for sample 928 / 928
[t-SNE] Mean sigma: 0.350940
Beginning preprocessing + Leiden
2024-03-13 17:13:14.785945 MEMORY 14.373449728
Affmat transformed
2024-03-13 17:13:14.797245 MEMORY 14.373449728
sources, targets, weights extracted
2024-03-13 17:13:14.804584 MEMORY 14.373449728
About to launch parallel Leiden runs
2024-03-13 17:13:14.841420 MEMORY 14.373449728
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    2.4s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    7.6s finished
Parallel Leiden runs finished
2024-03-13 17:13:22.414173 MEMORY 14.373449728
Quality: 0.3937238986631603
Quality: 0.39416106032930315
Quality: 0.3956290191397558
Quality: 0.39590177223646367
Quality: 0.39660741032377855
Got subclusters: Counter({0: 193, 1: 156, 2: 125, 3: 121, 4: 110, 5: 97, 6: 78, 7: 48})
On merging iteration 1
Numbers for each pattern pre-subsample: [193, 156, 125, 121, 110, 97, 78, 48]
Numbers after subsampling: [193, 156, 125, 121, 110, 97, 78, 48]
Computing sims for pattern 0
Computed sims for pattern 0 in 1.3129851818084717 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.9627954959869385 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.8462128639221191 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.8022983074188232 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.6841526031494141 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.5610747337341309 s
Computing sims for pattern 6
Computed sims for pattern 6 in 0.5495362281799316 s
Computing sims for pattern 7
Computed sims for pattern 7 in 0.34912776947021484 s
Cluster sizes
[193 156 125 121 110  97  78  48]
Cross-contamination matrix:
[[1.   0.84 0.73 0.73 0.7  0.87 0.86 0.82]
 [0.67 1.   0.69 0.7  0.55 0.73 0.8  0.49]
 [0.5  0.57 1.   0.69 0.67 0.68 0.8  0.59]
 [0.48 0.61 0.76 1.   0.56 0.59 0.71 0.59]
 [0.51 0.6  0.82 0.64 1.   0.6  0.81 0.55]
 [0.65 0.7  0.73 0.62 0.51 1.   0.78 0.55]
 [0.49 0.58 0.68 0.49 0.54 0.61 1.   0.5 ]
 [0.72 0.55 0.75 0.7  0.59 0.67 0.7  1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.87 0.74 0.7  0.67 0.83 0.72 0.8 ]
 [0.87 1.   0.72 0.79 0.65 0.79 0.72 0.61]
 [0.74 0.72 1.   0.81 0.83 0.78 0.79 0.76]
 [0.7  0.79 0.81 1.   0.73 0.71 0.73 0.72]
 [0.67 0.65 0.83 0.73 1.   0.63 0.78 0.72]
 [0.83 0.79 0.78 0.71 0.63 1.   0.74 0.71]
 [0.72 0.72 0.79 0.73 0.78 0.74 1.   0.68]
 [0.8  0.61 0.76 0.72 0.72 0.71 0.68 1.  ]]
Collapsing 0 & 1 with crosscontam 0.6702950902064861 and sim 0.8650316098270411
Trimming eliminated 0 seqlets out of 349
Unmerged patterns remapping: OrderedDict([(2, 1), (3, 2), (4, 3), (5, 4), (6, 5), (7, 6)])
Time spent on merging iteration: 0.8341560363769531
On merging iteration 2
Numbers for each pattern pre-subsample: [349, 125, 121, 110, 97, 78, 48]
Numbers after subsampling: [300, 125, 121, 110, 97, 78, 48]
Computing sims for pattern 0
Computed sims for pattern 0 in 1.5572514533996582 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.15407371520996094 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.14415884017944336 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.13509011268615723 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.11074423789978027 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.10488176345825195 s
Computing sims for pattern 6
Computed sims for pattern 6 in 0.07072186470031738 s
Cluster sizes
[349 125 121 110  97  78  48]
Cross-contamination matrix:
[[1.   0.86 0.84 0.73 0.91 0.97 0.83]
 [0.53 1.   0.69 0.67 0.68 0.8  0.59]
 [0.52 0.76 1.   0.56 0.59 0.71 0.59]
 [0.47 0.82 0.64 1.   0.6  0.81 0.55]
 [0.61 0.73 0.62 0.51 1.   0.78 0.55]
 [0.51 0.68 0.49 0.54 0.61 1.   0.5 ]
 [0.65 0.75 0.7  0.59 0.67 0.7  1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.76 0.72 0.64 0.83 0.75 0.75]
 [0.76 1.   0.81 0.83 0.78 0.79 0.76]
 [0.72 0.81 1.   0.73 0.71 0.73 0.72]
 [0.64 0.83 0.73 1.   0.63 0.78 0.72]
 [0.83 0.78 0.71 0.63 1.   0.74 0.71]
 [0.75 0.79 0.73 0.78 0.74 1.   0.68]
 [0.75 0.76 0.72 0.72 0.71 0.68 1.  ]]
Merging on 28 clusters
2024-03-13 17:13:31.465383 MEMORY 14.373449728
On merging iteration 1
Numbers for each pattern pre-subsample: [1552, 138, 94, 365, 350, 319, 271, 154, 146, 143, 304, 300, 278, 256, 171, 169, 152, 5, 2, 1101, 237, 349, 125, 121, 110, 97, 78, 48]
Numbers after subsampling: [300, 138, 94, 300, 300, 300, 271, 154, 146, 143, 300, 300, 278, 256, 171, 169, 152, 5, 2, 300, 237, 300, 125, 121, 110, 97, 78, 48]
Computing sims for pattern 0
Computed sims for pattern 0 in 7.83942174911499 s
Computing sims for pattern 1
Computed sims for pattern 1 in 4.041773796081543 s
Computing sims for pattern 2
Computed sims for pattern 2 in 2.8815226554870605 s
Computing sims for pattern 3
Computed sims for pattern 3 in 7.961040496826172 s
Computing sims for pattern 4
Computed sims for pattern 4 in 12.159073829650879 s
Computing sims for pattern 5
Computed sims for pattern 5 in 8.013836860656738 s
Computing sims for pattern 6
Computed sims for pattern 6 in 6.777242183685303 s
Computing sims for pattern 7
Computed sims for pattern 7 in 4.263453960418701 s
Computing sims for pattern 8
Computed sims for pattern 8 in 3.8514671325683594 s
Computing sims for pattern 9
Computed sims for pattern 9 in 4.373924970626831 s
Computing sims for pattern 10
Computed sims for pattern 10 in 7.950366973876953 s
Computing sims for pattern 11
Computed sims for pattern 11 in 8.009636878967285 s
Computing sims for pattern 12
Computed sims for pattern 12 in 7.1220338344573975 s
Computing sims for pattern 13
Computed sims for pattern 13 in 6.349400520324707 s
Computing sims for pattern 14
Computed sims for pattern 14 in 4.850070238113403 s
Computing sims for pattern 15
Computed sims for pattern 15 in 4.7755725383758545 s
Computing sims for pattern 16
Computed sims for pattern 16 in 4.189397811889648 s
Computing sims for pattern 17
Computed sims for pattern 17 in 0.5440137386322021 s
Computing sims for pattern 18
Computed sims for pattern 18 in 0.4678611755371094 s
Computing sims for pattern 19
Computed sims for pattern 19 in 8.190919876098633 s
Computing sims for pattern 20
Computed sims for pattern 20 in 7.533883333206177 s
Computing sims for pattern 21
Computed sims for pattern 21 in 11.990102052688599 s
Computing sims for pattern 22
Computed sims for pattern 22 in 3.8326690196990967 s
Computing sims for pattern 23
Computed sims for pattern 23 in 3.7058963775634766 s
Computing sims for pattern 24
Computed sims for pattern 24 in 3.3308868408203125 s
Computing sims for pattern 25
Computed sims for pattern 25 in 2.53440260887146 s
Computing sims for pattern 26
Computed sims for pattern 26 in 2.4827213287353516 s
Computing sims for pattern 27
Computed sims for pattern 27 in 1.6482689380645752 s
Cluster sizes
[1552  138   94  365  350  319  271  154  146  143  304  300  278  256
  171  169  152    5    2 1101  237  349  125  121  110   97   78   48]
Cross-contamination matrix:
[[1.   0.81 0.71 0.28 0.4  0.37 0.21 0.24 0.37 0.15 0.36 0.35 0.37 0.42
  0.47 0.3  0.38 0.23 0.13 0.57 0.79 0.5  0.33 0.77 0.25 0.5  0.63 0.51]
 [0.6  1.   0.51 0.16 0.14 0.15 0.1  0.07 0.23 0.06 0.2  0.15 0.21 0.24
  0.33 0.17 0.27 0.13 0.08 0.34 0.5  0.22 0.31 0.51 0.3  0.27 0.54 0.37]
 [0.62 0.62 1.   0.15 0.23 0.22 0.11 0.09 0.29 0.06 0.28 0.32 0.34 0.26
  0.37 0.36 0.46 0.35 0.26 0.43 0.51 0.33 0.19 0.37 0.27 0.33 0.43 0.25]
 [0.36 0.37 0.24 1.   0.36 0.67 0.66 0.63 0.53 0.73 0.37 0.47 0.59 0.45
  0.29 0.61 0.31 0.13 0.56 0.2  0.23 0.31 0.23 0.26 0.23 0.4  0.33 0.24]
 [0.47 0.28 0.33 0.32 1.   0.67 0.38 0.63 0.69 0.52 0.73 0.35 0.65 0.39
  0.39 0.71 0.39 0.25 0.21 0.3  0.35 0.32 0.19 0.33 0.29 0.27 0.36 0.28]
 [0.36 0.24 0.26 0.53 0.56 1.   0.47 0.34 0.53 0.55 0.33 0.45 0.41 0.42
  0.42 0.74 0.35 0.15 0.23 0.16 0.16 0.26 0.1  0.12 0.2  0.3  0.26 0.14]
 [0.36 0.29 0.22 0.77 0.5  0.7  1.   0.56 0.68 0.63 0.34 0.38 0.48 0.23
  0.3  0.52 0.24 0.17 0.51 0.23 0.18 0.17 0.2  0.18 0.19 0.26 0.2  0.19]
 [0.37 0.22 0.18 0.67 0.73 0.65 0.5  1.   0.59 0.68 0.47 0.38 0.7  0.29
  0.31 0.68 0.27 0.3  0.39 0.25 0.25 0.18 0.11 0.4  0.29 0.18 0.34 0.18]
 [0.45 0.44 0.42 0.5  0.71 0.5  0.53 0.5  1.   0.36 0.58 0.55 0.72 0.31
  0.4  0.66 0.36 0.24 0.39 0.3  0.34 0.39 0.28 0.37 0.54 0.28 0.3  0.57]
 [0.17 0.12 0.09 0.65 0.5  0.61 0.46 0.55 0.29 1.   0.22 0.24 0.28 0.06
  0.12 0.38 0.13 0.05 0.31 0.1  0.11 0.09 0.05 0.1  0.13 0.07 0.11 0.09]
 [0.24 0.21 0.2  0.18 0.47 0.22 0.12 0.22 0.36 0.12 1.   0.87 0.55 0.35
  0.36 0.6  0.55 0.57 0.2  0.17 0.18 0.14 0.15 0.12 0.19 0.13 0.13 0.19]
 [0.12 0.08 0.13 0.13 0.09 0.17 0.05 0.14 0.18 0.08 0.58 1.   0.4  0.59
  0.39 0.57 0.5  0.39 0.2  0.07 0.1  0.15 0.05 0.1  0.07 0.18 0.1  0.07]
 [0.29 0.27 0.31 0.38 0.46 0.15 0.22 0.44 0.53 0.19 0.62 0.74 1.   0.55
  0.55 0.77 0.46 0.3  0.32 0.23 0.25 0.36 0.22 0.16 0.17 0.35 0.21 0.2 ]
 [0.3  0.27 0.22 0.26 0.22 0.35 0.09 0.14 0.17 0.12 0.37 0.89 0.5  1.
  0.53 0.66 0.64 0.64 0.27 0.2  0.29 0.42 0.26 0.4  0.16 0.55 0.36 0.28]
 [0.56 0.62 0.56 0.27 0.4  0.54 0.23 0.26 0.41 0.12 0.6  0.93 0.75 0.79
  1.   0.56 0.76 0.65 0.39 0.42 0.52 0.48 0.28 0.37 0.22 0.43 0.27 0.44]
 [0.19 0.18 0.25 0.34 0.45 0.59 0.21 0.36 0.44 0.22 0.6  0.86 0.68 0.48
  0.46 1.   0.56 0.51 0.25 0.14 0.17 0.27 0.1  0.27 0.25 0.35 0.18 0.24]
 [0.31 0.37 0.46 0.16 0.27 0.31 0.11 0.15 0.25 0.09 0.63 0.88 0.47 0.7
  0.58 0.64 1.   0.7  0.31 0.3  0.29 0.38 0.11 0.15 0.12 0.34 0.16 0.19]
 [0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.01 0.02 0.   0.02
  0.   0.02 0.02 1.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.
  0.   0.   0.   0.   1.   0.   0.   0.   0.   0.   0.   0.   0.   0.  ]
 [0.77 0.72 0.75 0.27 0.43 0.33 0.27 0.32 0.43 0.19 0.45 0.38 0.48 0.4
  0.44 0.43 0.46 0.34 0.28 1.   0.75 0.43 0.37 0.6  0.39 0.46 0.44 0.44]
 [0.84 0.78 0.64 0.19 0.33 0.21 0.12 0.17 0.3  0.11 0.31 0.36 0.35 0.46
  0.49 0.31 0.4  0.26 0.22 0.68 1.   0.38 0.4  0.71 0.37 0.2  0.41 0.46]
 [0.5  0.36 0.41 0.26 0.27 0.29 0.11 0.12 0.33 0.09 0.22 0.38 0.44 0.54
  0.39 0.38 0.44 0.27 0.34 0.28 0.38 1.   0.86 0.84 0.73 0.91 0.97 0.83]
 [0.15 0.24 0.09 0.08 0.06 0.05 0.05 0.04 0.11 0.01 0.09 0.06 0.13 0.17
  0.09 0.07 0.06 0.09 0.14 0.13 0.21 0.53 1.   0.69 0.67 0.68 0.8  0.59]
 [0.48 0.44 0.2  0.08 0.12 0.05 0.03 0.12 0.14 0.03 0.07 0.12 0.09 0.26
  0.13 0.19 0.08 0.06 0.11 0.25 0.42 0.52 0.76 1.   0.56 0.59 0.71 0.59]
 [0.14 0.28 0.19 0.08 0.22 0.12 0.05 0.15 0.27 0.07 0.19 0.16 0.14 0.13
  0.15 0.3  0.16 0.1  0.16 0.19 0.23 0.47 0.82 0.64 1.   0.6  0.81 0.55]
 [0.27 0.2  0.19 0.16 0.09 0.15 0.06 0.03 0.09 0.02 0.09 0.21 0.22 0.4
  0.15 0.25 0.21 0.19 0.13 0.12 0.21 0.61 0.73 0.62 0.51 1.   0.78 0.55]
 [0.26 0.35 0.23 0.08 0.1  0.08 0.02 0.07 0.06 0.02 0.06 0.1  0.07 0.18
  0.05 0.13 0.06 0.03 0.07 0.07 0.09 0.51 0.68 0.49 0.54 0.61 1.   0.5 ]
 [0.36 0.41 0.2  0.12 0.14 0.11 0.06 0.06 0.36 0.04 0.17 0.12 0.17 0.27
  0.26 0.15 0.16 0.15 0.13 0.2  0.33 0.65 0.75 0.7  0.59 0.67 0.7  1.  ]]
Pattern-to-pattern sim matrix:
[[ 1.    0.83  0.81  0.28  0.58  0.51  0.32  0.29  0.49  0.15  0.53  0.39
   0.47  0.56  0.65  0.39  0.5   0.33  0.22  0.8   0.9   0.5   0.4   0.78
   0.34  0.5   0.57  0.54]
 [ 0.83  1.    0.75  0.2   0.42  0.42  0.2   0.14  0.53  0.03  0.57  0.4
   0.5   0.64  0.72  0.34  0.6   0.41  0.38  0.77  0.83  0.51  0.56  0.73
   0.47  0.55  0.67  0.61]
 [ 0.81  0.75  1.    0.05  0.41  0.38  0.08  0.12  0.35 -0.06  0.47  0.33
   0.39  0.47  0.58  0.39  0.56  0.45  0.3   0.76  0.81  0.42  0.33  0.63
   0.32  0.4   0.56  0.39]
 [ 0.28  0.2   0.05  1.    0.4   0.61  0.83  0.62  0.52  0.76  0.25  0.37
   0.47  0.32  0.28  0.51  0.31  0.08  0.44  0.09  0.1   0.21  0.11  0.08
   0.13  0.28  0.21  0.15]
 [ 0.58  0.42  0.41  0.4   1.    0.76  0.48  0.73  0.73  0.56  0.71  0.45
   0.63  0.56  0.58  0.69  0.47  0.37  0.21  0.43  0.51  0.32  0.3   0.33
   0.32  0.3   0.3   0.4 ]
 [ 0.51  0.42  0.38  0.61  0.76  1.    0.66  0.59  0.56  0.59  0.48  0.57
   0.38  0.61  0.72  0.7   0.55  0.25  0.31  0.21  0.21  0.32  0.25  0.24
   0.23  0.32  0.3   0.34]
 [ 0.32  0.2   0.08  0.83  0.48  0.66  1.    0.7   0.55  0.69  0.28  0.25
   0.29  0.17  0.34  0.42  0.27  0.07  0.52  0.12  0.03  0.15  0.05  0.07
   0.19  0.19  0.22  0.13]
 [ 0.29  0.14  0.12  0.62  0.73  0.59  0.7   1.    0.49  0.73  0.35  0.3
   0.52  0.29  0.3   0.58  0.25  0.23  0.38  0.16  0.21  0.13  0.03  0.18
   0.23  0.18  0.19  0.12]
 [ 0.49  0.53  0.35  0.52  0.73  0.56  0.55  0.49  1.    0.47  0.61  0.48
   0.63  0.47  0.5   0.58  0.38  0.29  0.3   0.4   0.46  0.38  0.41  0.46
   0.51  0.38  0.32  0.66]
 [ 0.15  0.03 -0.06  0.76  0.56  0.59  0.69  0.73  0.47  1.    0.21  0.14
   0.3   0.06  0.07  0.42  0.07  0.    0.33 -0.02  0.01  0.03 -0.1   0.01
   0.07  0.06  0.07  0.09]
 [ 0.53  0.57  0.47  0.25  0.71  0.48  0.28  0.35  0.61  0.21  1.    0.81
   0.71  0.65  0.71  0.7   0.77  0.58  0.35  0.56  0.48  0.39  0.43  0.38
   0.41  0.4   0.37  0.46]
 [ 0.39  0.4   0.33  0.37  0.45  0.57  0.25  0.3   0.48  0.14  0.81  1.
   0.74  0.83  0.79  0.79  0.82  0.5   0.44  0.39  0.39  0.39  0.25  0.27
   0.29  0.49  0.26  0.31]
 [ 0.47  0.5   0.39  0.47  0.63  0.38  0.29  0.52  0.63  0.3   0.71  0.74
   1.    0.65  0.79  0.82  0.8   0.46  0.48  0.43  0.48  0.45  0.4   0.35
   0.3   0.48  0.33  0.43]
 [ 0.56  0.64  0.47  0.32  0.56  0.61  0.17  0.29  0.47  0.06  0.65  0.83
   0.65  1.    0.83  0.7   0.69  0.59  0.47  0.49  0.59  0.57  0.5   0.48
   0.37  0.7   0.44  0.54]
 [ 0.65  0.72  0.58  0.28  0.58  0.72  0.34  0.3   0.5   0.07  0.71  0.79
   0.79  0.83  1.    0.64  0.82  0.54  0.42  0.56  0.66  0.46  0.45  0.52
   0.36  0.53  0.35  0.53]
 [ 0.39  0.34  0.39  0.51  0.69  0.7   0.42  0.58  0.58  0.42  0.7   0.79
   0.82  0.7   0.64  1.    0.68  0.48  0.37  0.37  0.41  0.38  0.22  0.36
   0.37  0.48  0.28  0.31]
 [ 0.5   0.6   0.56  0.31  0.47  0.55  0.27  0.25  0.38  0.07  0.77  0.82
   0.8   0.69  0.82  0.68  1.    0.61  0.45  0.61  0.53  0.42  0.4   0.41
   0.32  0.4   0.38  0.46]
 [ 0.33  0.41  0.45  0.08  0.37  0.25  0.07  0.23  0.29  0.    0.58  0.5
   0.46  0.59  0.54  0.48  0.61  1.    0.26  0.45  0.38  0.39  0.38  0.37
   0.32  0.48  0.35  0.41]
 [ 0.22  0.38  0.3   0.44  0.21  0.31  0.52  0.38  0.3   0.33  0.35  0.44
   0.48  0.47  0.42  0.37  0.45  0.26  1.    0.3   0.29  0.39  0.35  0.3
   0.33  0.46  0.39  0.29]
 [ 0.8   0.77  0.76  0.09  0.43  0.21  0.12  0.16  0.4  -0.02  0.56  0.39
   0.43  0.49  0.56  0.37  0.61  0.45  0.3   1.    0.8   0.45  0.43  0.66
   0.39  0.43  0.32  0.47]
 [ 0.9   0.83  0.81  0.1   0.51  0.21  0.03  0.21  0.46  0.01  0.48  0.39
   0.48  0.59  0.66  0.41  0.53  0.38  0.29  0.8   1.    0.53  0.51  0.76
   0.46  0.51  0.4   0.54]
 [ 0.5   0.51  0.42  0.21  0.32  0.32  0.15  0.13  0.38  0.03  0.39  0.39
   0.45  0.57  0.46  0.38  0.42  0.39  0.39  0.45  0.53  1.    0.76  0.72
   0.64  0.83  0.75  0.75]
 [ 0.4   0.56  0.33  0.11  0.3   0.25  0.05  0.03  0.41 -0.1   0.43  0.25
   0.4   0.5   0.45  0.22  0.4   0.38  0.35  0.43  0.51  0.76  1.    0.81
   0.83  0.78  0.79  0.76]
 [ 0.78  0.73  0.63  0.08  0.33  0.24  0.07  0.18  0.46  0.01  0.38  0.27
   0.35  0.48  0.52  0.36  0.41  0.37  0.3   0.66  0.76  0.72  0.81  1.
   0.73  0.71  0.73  0.72]
 [ 0.34  0.47  0.32  0.13  0.32  0.23  0.19  0.23  0.51  0.07  0.41  0.29
   0.3   0.37  0.36  0.37  0.32  0.32  0.33  0.39  0.46  0.64  0.83  0.73
   1.    0.63  0.78  0.72]
 [ 0.5   0.55  0.4   0.28  0.3   0.32  0.19  0.18  0.38  0.06  0.4   0.49
   0.48  0.7   0.53  0.48  0.4   0.48  0.46  0.43  0.51  0.83  0.78  0.71
   0.63  1.    0.74  0.71]
 [ 0.57  0.67  0.56  0.21  0.3   0.3   0.22  0.19  0.32  0.07  0.37  0.26
   0.33  0.44  0.35  0.28  0.38  0.35  0.39  0.32  0.4   0.75  0.79  0.73
   0.78  0.74  1.    0.68]
 [ 0.54  0.61  0.39  0.15  0.4   0.34  0.13  0.12  0.66  0.09  0.46  0.31
   0.43  0.54  0.53  0.31  0.46  0.41  0.29  0.47  0.54  0.75  0.76  0.72
   0.72  0.71  0.68  1.  ]]
Collapsing 0 & 20 with crosscontam 0.7910158762306609 and sim 0.9042066360765109
Trimming eliminated 0 seqlets out of 1789
Unmerged patterns remapping: OrderedDict([(1, 17), (2, 22), (3, 2), (4, 3), (5, 5), (6, 9), (7, 13), (8, 15), (9, 16), (10, 6), (11, 7), (12, 8), (13, 10), (14, 11), (15, 12), (16, 14), (17, 25), (18, 26), (19, 1), (21, 4), (22, 18), (23, 19), (24, 20), (25, 21), (26, 23), (27, 24)])
Time spent on merging iteration: 4.899245977401733
On merging iteration 2
Numbers for each pattern pre-subsample: [1789, 1101, 365, 350, 349, 319, 304, 300, 278, 271, 256, 171, 169, 154, 152, 146, 143, 138, 125, 121, 110, 97, 94, 78, 48, 5, 2]
Numbers after subsampling: [300, 300, 300, 300, 300, 300, 300, 300, 278, 271, 256, 171, 169, 154, 152, 146, 143, 138, 125, 121, 110, 97, 94, 78, 48, 5, 2]
Computing sims for pattern 0
Computed sims for pattern 0 in 7.949512720108032 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.3537464141845703 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.34786009788513184 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.3407576084136963 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.34912824630737305 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.36027979850769043 s
Computing sims for pattern 6
Computed sims for pattern 6 in 0.3490598201751709 s
Computing sims for pattern 7
Computed sims for pattern 7 in 0.34607648849487305 s
Computing sims for pattern 8
Computed sims for pattern 8 in 0.30517005920410156 s
Computing sims for pattern 9
Computed sims for pattern 9 in 0.29906439781188965 s
Computing sims for pattern 10
Computed sims for pattern 10 in 0.28636908531188965 s
Computing sims for pattern 11
Computed sims for pattern 11 in 0.2210392951965332 s
Computing sims for pattern 12
Computed sims for pattern 12 in 0.20619869232177734 s
Computing sims for pattern 13
Computed sims for pattern 13 in 0.19192719459533691 s
Computing sims for pattern 14
Computed sims for pattern 14 in 0.18885231018066406 s
Computing sims for pattern 15
Computed sims for pattern 15 in 0.20767974853515625 s
Computing sims for pattern 16
Computed sims for pattern 16 in 0.2039346694946289 s
Computing sims for pattern 17
Computed sims for pattern 17 in 0.239304780960083 s
Computing sims for pattern 18
Computed sims for pattern 18 in 0.17691659927368164 s
Computing sims for pattern 19
Computed sims for pattern 19 in 0.16903162002563477 s
Computing sims for pattern 20
Computed sims for pattern 20 in 0.15631604194641113 s
Computing sims for pattern 21
Computed sims for pattern 21 in 0.11866378784179688 s
Computing sims for pattern 22
Computed sims for pattern 22 in 0.14042210578918457 s
Computing sims for pattern 23
Computed sims for pattern 23 in 0.11891841888427734 s
Computing sims for pattern 24
Computed sims for pattern 24 in 0.07737922668457031 s
Computing sims for pattern 25
Computed sims for pattern 25 in 0.03251314163208008 s
Computing sims for pattern 26
Computed sims for pattern 26 in 0.02681422233581543 s
Cluster sizes
[1789 1101  365  350  349  319  304  300  278  271  256  171  169  154
  152  146  143  138  125  121  110   97   94   78   48    5    2]
Cross-contamination matrix:
[[1.   0.55 0.22 0.34 0.44 0.32 0.32 0.28 0.32 0.17 0.38 0.44 0.24 0.19
  0.34 0.32 0.11 0.81 0.3  0.71 0.22 0.43 0.67 0.59 0.45 0.19 0.09]
 [0.81 1.   0.27 0.43 0.43 0.33 0.45 0.38 0.48 0.27 0.4  0.44 0.43 0.32
  0.46 0.43 0.19 0.72 0.37 0.6  0.39 0.46 0.75 0.44 0.44 0.34 0.28]
 [0.33 0.2  1.   0.36 0.31 0.67 0.37 0.47 0.59 0.66 0.45 0.29 0.61 0.63
  0.31 0.53 0.73 0.37 0.23 0.26 0.23 0.4  0.24 0.33 0.24 0.13 0.56]
 [0.46 0.3  0.32 1.   0.32 0.67 0.73 0.35 0.65 0.38 0.39 0.39 0.71 0.63
  0.39 0.69 0.52 0.28 0.19 0.33 0.29 0.27 0.33 0.36 0.28 0.25 0.21]
 [0.49 0.28 0.26 0.27 1.   0.29 0.22 0.38 0.44 0.11 0.54 0.39 0.38 0.12
  0.44 0.33 0.09 0.36 0.86 0.84 0.73 0.91 0.41 0.97 0.83 0.27 0.34]
 [0.35 0.16 0.53 0.56 0.26 1.   0.33 0.45 0.41 0.47 0.42 0.42 0.74 0.34
  0.35 0.53 0.55 0.24 0.1  0.12 0.2  0.3  0.26 0.26 0.14 0.15 0.23]
 [0.25 0.17 0.18 0.47 0.14 0.22 1.   0.87 0.55 0.12 0.35 0.36 0.6  0.22
  0.55 0.36 0.12 0.21 0.15 0.12 0.19 0.13 0.2  0.13 0.19 0.57 0.2 ]
 [0.11 0.07 0.13 0.09 0.15 0.17 0.58 1.   0.4  0.05 0.59 0.39 0.57 0.14
  0.5  0.18 0.08 0.08 0.05 0.1  0.07 0.18 0.13 0.1  0.07 0.39 0.2 ]
 [0.29 0.23 0.38 0.46 0.36 0.15 0.62 0.74 1.   0.22 0.55 0.55 0.77 0.44
  0.46 0.53 0.19 0.27 0.22 0.16 0.17 0.35 0.31 0.21 0.2  0.3  0.32]
 [0.35 0.23 0.77 0.5  0.17 0.7  0.34 0.38 0.48 1.   0.23 0.3  0.52 0.56
  0.24 0.68 0.63 0.29 0.2  0.18 0.19 0.26 0.22 0.2  0.19 0.17 0.51]
 [0.31 0.2  0.26 0.22 0.42 0.35 0.37 0.89 0.5  0.09 1.   0.53 0.66 0.14
  0.64 0.17 0.12 0.27 0.26 0.4  0.16 0.55 0.22 0.36 0.28 0.64 0.27]
 [0.58 0.42 0.27 0.4  0.48 0.54 0.6  0.93 0.75 0.23 0.79 1.   0.56 0.26
  0.76 0.41 0.12 0.62 0.28 0.37 0.22 0.43 0.56 0.27 0.44 0.65 0.39]
 [0.18 0.14 0.34 0.45 0.27 0.59 0.6  0.86 0.68 0.21 0.48 0.46 1.   0.36
  0.56 0.44 0.22 0.18 0.1  0.27 0.25 0.35 0.25 0.18 0.24 0.51 0.25]
 [0.36 0.25 0.67 0.73 0.18 0.65 0.47 0.38 0.7  0.5  0.29 0.31 0.68 1.
  0.27 0.59 0.68 0.22 0.11 0.4  0.29 0.18 0.18 0.34 0.18 0.3  0.39]
 [0.33 0.3  0.16 0.27 0.38 0.31 0.63 0.88 0.47 0.11 0.7  0.58 0.64 0.15
  1.   0.25 0.09 0.37 0.11 0.15 0.12 0.34 0.46 0.16 0.19 0.7  0.31]
 [0.45 0.3  0.5  0.71 0.39 0.5  0.58 0.55 0.72 0.53 0.31 0.4  0.66 0.5
  0.36 1.   0.36 0.44 0.28 0.37 0.54 0.28 0.42 0.3  0.57 0.24 0.39]
 [0.15 0.1  0.65 0.5  0.09 0.61 0.22 0.24 0.28 0.46 0.06 0.12 0.38 0.55
  0.13 0.29 1.   0.12 0.05 0.1  0.13 0.07 0.09 0.11 0.09 0.05 0.31]
 [0.64 0.34 0.16 0.14 0.22 0.15 0.2  0.15 0.21 0.1  0.24 0.33 0.17 0.07
  0.27 0.23 0.06 1.   0.31 0.51 0.3  0.27 0.51 0.54 0.37 0.13 0.08]
 [0.16 0.13 0.08 0.06 0.53 0.05 0.09 0.06 0.13 0.05 0.17 0.09 0.07 0.04
  0.06 0.11 0.01 0.24 1.   0.69 0.67 0.68 0.09 0.8  0.59 0.09 0.14]
 [0.47 0.25 0.08 0.12 0.52 0.05 0.07 0.12 0.09 0.03 0.26 0.13 0.19 0.12
  0.08 0.14 0.03 0.44 0.76 1.   0.56 0.59 0.2  0.71 0.59 0.06 0.11]
 [0.15 0.19 0.08 0.22 0.47 0.12 0.19 0.16 0.14 0.05 0.13 0.15 0.3  0.15
  0.16 0.27 0.07 0.28 0.82 0.64 1.   0.6  0.19 0.81 0.55 0.1  0.16]
 [0.25 0.12 0.16 0.09 0.61 0.15 0.09 0.21 0.22 0.06 0.4  0.15 0.25 0.03
  0.21 0.09 0.02 0.2  0.73 0.62 0.51 1.   0.19 0.78 0.55 0.19 0.13]
 [0.63 0.43 0.15 0.23 0.33 0.22 0.28 0.32 0.34 0.11 0.26 0.37 0.36 0.09
  0.46 0.29 0.06 0.62 0.19 0.37 0.27 0.33 1.   0.43 0.25 0.35 0.26]
 [0.25 0.07 0.08 0.1  0.51 0.08 0.06 0.1  0.07 0.02 0.18 0.05 0.13 0.07
  0.06 0.06 0.02 0.35 0.68 0.49 0.54 0.61 0.23 1.   0.5  0.03 0.07]
 [0.35 0.2  0.12 0.14 0.65 0.11 0.17 0.12 0.17 0.06 0.27 0.26 0.15 0.06
  0.16 0.36 0.04 0.41 0.75 0.7  0.59 0.67 0.2  0.7  1.   0.15 0.13]
 [0.   0.   0.   0.   0.   0.   0.01 0.02 0.   0.   0.02 0.   0.02 0.
  0.02 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   1.   0.  ]
 [0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.
  0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   1.  ]]
Pattern-to-pattern sim matrix:
[[ 1.    0.81  0.26  0.58  0.5   0.51  0.54  0.4   0.48  0.3   0.57  0.66
   0.39  0.28  0.51  0.49  0.14  0.83  0.41  0.78  0.35  0.5   0.81  0.56
   0.53  0.35  0.23]
 [ 0.81  1.    0.09  0.43  0.45  0.21  0.56  0.39  0.43  0.12  0.49  0.56
   0.37  0.16  0.61  0.4  -0.02  0.77  0.43  0.66  0.39  0.43  0.76  0.32
   0.47  0.45  0.3 ]
 [ 0.26  0.09  1.    0.4   0.21  0.61  0.25  0.37  0.47  0.83  0.32  0.28
   0.51  0.62  0.31  0.52  0.76  0.2   0.11  0.08  0.13  0.28  0.05  0.21
   0.15  0.08  0.44]
 [ 0.58  0.43  0.4   1.    0.32  0.76  0.71  0.45  0.63  0.48  0.56  0.58
   0.69  0.73  0.47  0.73  0.56  0.42  0.3   0.33  0.32  0.3   0.41  0.3
   0.4   0.37  0.21]
 [ 0.5   0.45  0.21  0.32  1.    0.32  0.39  0.39  0.45  0.15  0.57  0.46
   0.38  0.13  0.42  0.38  0.03  0.51  0.76  0.72  0.64  0.83  0.42  0.75
   0.75  0.39  0.39]
 [ 0.51  0.21  0.61  0.76  0.32  1.    0.48  0.57  0.38  0.66  0.61  0.72
   0.7   0.59  0.55  0.56  0.59  0.42  0.25  0.24  0.23  0.32  0.38  0.3
   0.34  0.25  0.31]
 [ 0.54  0.56  0.25  0.71  0.39  0.48  1.    0.81  0.71  0.28  0.65  0.71
   0.7   0.35  0.77  0.61  0.21  0.57  0.43  0.38  0.41  0.4   0.47  0.37
   0.46  0.58  0.35]
 [ 0.4   0.39  0.37  0.45  0.39  0.57  0.81  1.    0.74  0.25  0.83  0.79
   0.79  0.3   0.82  0.48  0.14  0.4   0.25  0.27  0.29  0.49  0.33  0.26
   0.31  0.5   0.44]
 [ 0.48  0.43  0.47  0.63  0.45  0.38  0.71  0.74  1.    0.29  0.65  0.79
   0.82  0.52  0.8   0.63  0.3   0.5   0.4   0.35  0.3   0.48  0.39  0.33
   0.43  0.46  0.48]
 [ 0.3   0.12  0.83  0.48  0.15  0.66  0.28  0.25  0.29  1.    0.17  0.34
   0.42  0.7   0.27  0.55  0.69  0.2   0.05  0.07  0.19  0.19  0.08  0.22
   0.13  0.07  0.52]
 [ 0.57  0.49  0.32  0.56  0.57  0.61  0.65  0.83  0.65  0.17  1.    0.83
   0.7   0.29  0.69  0.47  0.06  0.64  0.5   0.48  0.37  0.7   0.47  0.44
   0.54  0.59  0.47]
 [ 0.66  0.56  0.28  0.58  0.46  0.72  0.71  0.79  0.79  0.34  0.83  1.
   0.64  0.3   0.82  0.5   0.07  0.72  0.45  0.52  0.36  0.53  0.58  0.35
   0.53  0.54  0.42]
 [ 0.39  0.37  0.51  0.69  0.38  0.7   0.7   0.79  0.82  0.42  0.7   0.64
   1.    0.58  0.68  0.58  0.42  0.34  0.22  0.36  0.37  0.48  0.39  0.28
   0.31  0.48  0.37]
 [ 0.28  0.16  0.62  0.73  0.13  0.59  0.35  0.3   0.52  0.7   0.29  0.3
   0.58  1.    0.25  0.49  0.73  0.14  0.03  0.18  0.23  0.18  0.12  0.19
   0.12  0.23  0.38]
 [ 0.51  0.61  0.31  0.47  0.42  0.55  0.77  0.82  0.8   0.27  0.69  0.82
   0.68  0.25  1.    0.38  0.07  0.6   0.4   0.41  0.32  0.4   0.56  0.38
   0.46  0.61  0.45]
 [ 0.49  0.4   0.52  0.73  0.38  0.56  0.61  0.48  0.63  0.55  0.47  0.5
   0.58  0.49  0.38  1.    0.47  0.53  0.41  0.46  0.51  0.38  0.35  0.32
   0.66  0.29  0.3 ]
 [ 0.14 -0.02  0.76  0.56  0.03  0.59  0.21  0.14  0.3   0.69  0.06  0.07
   0.42  0.73  0.07  0.47  1.    0.03 -0.1   0.01  0.07  0.06 -0.06  0.07
   0.09  0.    0.33]
 [ 0.83  0.77  0.2   0.42  0.51  0.42  0.57  0.4   0.5   0.2   0.64  0.72
   0.34  0.14  0.6   0.53  0.03  1.    0.56  0.73  0.47  0.55  0.75  0.67
   0.61  0.41  0.38]
 [ 0.41  0.43  0.11  0.3   0.76  0.25  0.43  0.25  0.4   0.05  0.5   0.45
   0.22  0.03  0.4   0.41 -0.1   0.56  1.    0.81  0.83  0.78  0.33  0.79
   0.76  0.38  0.35]
 [ 0.78  0.66  0.08  0.33  0.72  0.24  0.38  0.27  0.35  0.07  0.48  0.52
   0.36  0.18  0.41  0.46  0.01  0.73  0.81  1.    0.73  0.71  0.63  0.73
   0.72  0.37  0.3 ]
 [ 0.35  0.39  0.13  0.32  0.64  0.23  0.41  0.29  0.3   0.19  0.37  0.36
   0.37  0.23  0.32  0.51  0.07  0.47  0.83  0.73  1.    0.63  0.32  0.78
   0.72  0.32  0.33]
 [ 0.5   0.43  0.28  0.3   0.83  0.32  0.4   0.49  0.48  0.19  0.7   0.53
   0.48  0.18  0.4   0.38  0.06  0.55  0.78  0.71  0.63  1.    0.4   0.74
   0.71  0.48  0.46]
 [ 0.81  0.76  0.05  0.41  0.42  0.38  0.47  0.33  0.39  0.08  0.47  0.58
   0.39  0.12  0.56  0.35 -0.06  0.75  0.33  0.63  0.32  0.4   1.    0.56
   0.39  0.45  0.3 ]
 [ 0.56  0.32  0.21  0.3   0.75  0.3   0.37  0.26  0.33  0.22  0.44  0.35
   0.28  0.19  0.38  0.32  0.07  0.67  0.79  0.73  0.78  0.74  0.56  1.
   0.68  0.35  0.39]
 [ 0.53  0.47  0.15  0.4   0.75  0.34  0.46  0.31  0.43  0.13  0.54  0.53
   0.31  0.12  0.46  0.66  0.09  0.61  0.76  0.72  0.72  0.71  0.39  0.68
   1.    0.41  0.29]
 [ 0.35  0.45  0.08  0.37  0.39  0.25  0.58  0.5   0.46  0.07  0.59  0.54
   0.48  0.23  0.61  0.29  0.    0.41  0.38  0.37  0.32  0.48  0.45  0.35
   0.41  1.    0.26]
 [ 0.23  0.3   0.44  0.21  0.39  0.31  0.35  0.44  0.48  0.52  0.47  0.42
   0.37  0.38  0.45  0.3   0.33  0.38  0.35  0.3   0.33  0.46  0.3   0.39
   0.29  0.26  1.  ]]
Got 27 patterns after merging
2024-03-13 17:16:21.321444 MEMORY 14.373552128
Performing filtering
2024-03-13 17:16:21.321639 MEMORY 14.373552128
Got 25 patterns after filtering
2024-03-13 17:16:22.485578 MEMORY 14.373552128
Total time taken is 1038.56s
2024-03-13 17:16:22.485739 MEMORY 14.373552128
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 1650 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 1789 out of 1789 | elapsed:    0.3s finished
/ru-auth/local/home/lzhao/anaconda3/envs/jupyter-ml-clone/lib/python3.9/site-packages/sklearn/manifold/_t_sne.py:691: FutureWarning: 'square_distances' has been introduced in 0.24 to help phase out legacy squaring behavior. The 'legacy' setting will be removed in 1.1 (renaming of 0.26), and the default setting will be changed to True. In 1.3, 'square_distances' will be removed altogether, and distances will be squared by default. Set 'square_distances'=True to silence this warning.
  warnings.warn(
/ru-auth/local/home/lzhao/anaconda3/envs/jupyter-ml-clone/lib/python3.9/site-packages/sklearn/neighbors/_base.py:175: EfficiencyWarning: Precomputed sparse input was not sorted by data.
  warnings.warn('Precomputed sparse input was not sorted by data.',
Applying subclustering to the final motifs
On pattern 0
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 1789 samples in 0.052s...
[t-SNE] Computed neighbors for 1789 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 1000 / 1789
[t-SNE] Computed conditional probabilities for sample 1789 / 1789
[t-SNE] Mean sigma: 0.323452
[t-SNE] Computed conditional probabilities in 0.124s
[t-SNE] Iteration 50: error = 69.8318558, gradient norm = 0.1146848 (50 iterations in 6.501s)
[t-SNE] Iteration 100: error = 69.8809891, gradient norm = 0.1169034 (50 iterations in 0.307s)
[t-SNE] Iteration 150: error = 70.8475647, gradient norm = 0.1040009 (50 iterations in 0.161s)
[t-SNE] Iteration 200: error = 70.1389008, gradient norm = 0.1204300 (50 iterations in 0.150s)
[t-SNE] Iteration 250: error = 70.0031509, gradient norm = 0.1311818 (50 iterations in 0.165s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 70.003151
[t-SNE] Iteration 300: error = 2.3589556, gradient norm = 0.0012819 (50 iterations in 0.147s)
[t-SNE] Iteration 350: error = 2.2706726, gradient norm = 0.0004725 (50 iterations in 0.131s)
[t-SNE] Iteration 400: error = 2.2344203, gradient norm = 0.0002238 (50 iterations in 0.128s)
[t-SNE] Iteration 450: error = 2.2164993, gradient norm = 0.0001613 (50 iterations in 0.127s)
[t-SNE] Iteration 500: error = 2.2086351, gradient norm = 0.0001186 (50 iterations in 0.127s)
[t-SNE] Iteration 550: error = 2.2043176, gradient norm = 0.0000987 (50 iterations in 0.127s)
[t-SNE] Iteration 600: error = 2.2004855, gradient norm = 0.0001454 (50 iterations in 0.129s)
[t-SNE] Iteration 650: error = 2.1986339, gradient norm = 0.0000928 (50 iterations in 0.129s)
[t-SNE] Iteration 700: error = 2.1973312, gradient norm = 0.0000632 (50 iterations in 0.128s)
[t-SNE] Iteration 750: error = 2.1960042, gradient norm = 0.0000452 (50 iterations in 0.127s)
[t-SNE] Iteration 800: error = 2.1946552, gradient norm = 0.0000521 (50 iterations in 0.156s)
[t-SNE] Iteration 850: error = 2.1936603, gradient norm = 0.0000397 (50 iterations in 0.127s)
[t-SNE] Iteration 900: error = 2.1927671, gradient norm = 0.0000353 (50 iterations in 0.128s)
[t-SNE] Iteration 950: error = 2.1920002, gradient norm = 0.0000328 (50 iterations in 0.127s)
[t-SNE] Iteration 1000: error = 2.1915684, gradient norm = 0.0000290 (50 iterations in 0.131s)
[t-SNE] KL divergence after 1000 iterations: 2.191568
[t-SNE] Computed conditional probabilities for sample 1000 / 1789
[t-SNE] Computed conditional probabilities for sample 1789 / 1789
[t-SNE] Mean sigma: 0.323452
Beginning preprocessing + Leiden
2024-03-13 17:16:34.216553 MEMORY 14.388076544
Affmat transformed
2024-03-13 17:16:34.237303 MEMORY 14.388076544
sources, targets, weights extracted
2024-03-13 17:16:34.251587 MEMORY 14.388076544
About to launch parallel Leiden runs
2024-03-13 17:16:34.283408 MEMORY 14.388076544
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    6.1s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   21.6s finished
Parallel Leiden runs finished
2024-03-13 17:16:55.934584 MEMORY 14.388076544
Quality: 0.4136894640956707
Quality: 0.4137186338896923
Quality: 0.41673353868402657
Quality: 0.4169645617131982
Quality: 0.41904639648328174
Quality: 0.4198399928845056
Quality: 0.4202150619225851
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 930 tasks      | elapsed:    0.5s
[Parallel(n_jobs=24)]: Done 1101 out of 1101 | elapsed:    0.6s finished
Got subclusters: Counter({0: 371, 1: 353, 2: 279, 3: 250, 4: 186, 5: 175, 6: 119, 7: 51, 8: 5})
On pattern 1
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 1101 samples in 0.031s...
[t-SNE] Computed neighbors for 1101 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 1000 / 1101
[t-SNE] Computed conditional probabilities for sample 1101 / 1101
[t-SNE] Mean sigma: 0.355582
[t-SNE] Computed conditional probabilities in 0.075s
[t-SNE] Iteration 50: error = 65.9935532, gradient norm = 0.2773385 (50 iterations in 0.088s)
[t-SNE] Iteration 100: error = 66.5890198, gradient norm = 0.2604609 (50 iterations in 0.088s)
[t-SNE] Iteration 150: error = 67.0738373, gradient norm = 0.2366808 (50 iterations in 0.095s)
[t-SNE] Iteration 200: error = 67.0755997, gradient norm = 0.2451777 (50 iterations in 0.089s)
[t-SNE] Iteration 250: error = 66.6833115, gradient norm = 0.2695228 (50 iterations in 0.090s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 66.683311
[t-SNE] Iteration 300: error = 1.9792933, gradient norm = 0.0019370 (50 iterations in 0.083s)
[t-SNE] Iteration 350: error = 1.9321002, gradient norm = 0.0003752 (50 iterations in 0.081s)
[t-SNE] Iteration 400: error = 1.9113460, gradient norm = 0.0002768 (50 iterations in 0.081s)
[t-SNE] Iteration 450: error = 1.9035711, gradient norm = 0.0001710 (50 iterations in 0.081s)
[t-SNE] Iteration 500: error = 1.9001976, gradient norm = 0.0001333 (50 iterations in 0.080s)
[t-SNE] Iteration 550: error = 1.8977586, gradient norm = 0.0000964 (50 iterations in 0.083s)
[t-SNE] Iteration 600: error = 1.8962477, gradient norm = 0.0001288 (50 iterations in 0.081s)
[t-SNE] Iteration 650: error = 1.8945312, gradient norm = 0.0000999 (50 iterations in 0.082s)
[t-SNE] Iteration 700: error = 1.8930902, gradient norm = 0.0000982 (50 iterations in 0.086s)
[t-SNE] Iteration 750: error = 1.8922977, gradient norm = 0.0000492 (50 iterations in 0.088s)
[t-SNE] Iteration 800: error = 1.8914580, gradient norm = 0.0000690 (50 iterations in 0.079s)
[t-SNE] Iteration 850: error = 1.8910048, gradient norm = 0.0000449 (50 iterations in 0.081s)
[t-SNE] Iteration 900: error = 1.8905542, gradient norm = 0.0000463 (50 iterations in 0.088s)
[t-SNE] Iteration 950: error = 1.8903549, gradient norm = 0.0000279 (50 iterations in 0.096s)
[t-SNE] Iteration 1000: error = 1.8899978, gradient norm = 0.0000436 (50 iterations in 0.084s)
[t-SNE] KL divergence after 1000 iterations: 1.889998
[t-SNE] Computed conditional probabilities for sample 1000 / 1101
[t-SNE] Computed conditional probabilities for sample 1101 / 1101
[t-SNE] Mean sigma: 0.355582
Beginning preprocessing + Leiden
2024-03-13 17:16:59.709439 MEMORY 14.38808064
Affmat transformed
2024-03-13 17:16:59.723370 MEMORY 14.38808064
sources, targets, weights extracted
2024-03-13 17:16:59.731805 MEMORY 14.38808064
About to launch parallel Leiden runs
2024-03-13 17:16:59.739452 MEMORY 14.38808064
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    3.1s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   11.4s finished
Parallel Leiden runs finished
2024-03-13 17:17:11.168809 MEMORY 14.38808064
Quality: 0.39339366000891685
Quality: 0.39425594760803023
Quality: 0.39445657693199504
Quality: 0.39572737379648004
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 365 out of 365 | elapsed:    0.1s finished
Got subclusters: Counter({0: 249, 1: 198, 2: 176, 4: 145, 3: 145, 5: 109, 6: 79})
On pattern 2
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 365 samples in 0.003s...
[t-SNE] Computed neighbors for 365 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 365 / 365
[t-SNE] Mean sigma: 0.407696
[t-SNE] Computed conditional probabilities in 0.025s
[t-SNE] Iteration 50: error = 64.4818497, gradient norm = 0.4864232 (50 iterations in 0.037s)
[t-SNE] Iteration 100: error = 65.4163742, gradient norm = 0.4952834 (50 iterations in 0.038s)
[t-SNE] Iteration 150: error = 65.3416595, gradient norm = 0.5019314 (50 iterations in 0.040s)
[t-SNE] Iteration 200: error = 64.9302673, gradient norm = 0.4891639 (50 iterations in 0.039s)
[t-SNE] Iteration 250: error = 65.2136383, gradient norm = 0.5153853 (50 iterations in 0.040s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 65.213638
[t-SNE] Iteration 300: error = 1.5093881, gradient norm = 0.0043502 (50 iterations in 0.042s)
[t-SNE] Iteration 350: error = 1.3173654, gradient norm = 0.0031776 (50 iterations in 0.037s)
[t-SNE] Iteration 400: error = 1.2628618, gradient norm = 0.0029239 (50 iterations in 0.038s)
[t-SNE] Iteration 450: error = 1.2234952, gradient norm = 0.0011892 (50 iterations in 0.035s)
[t-SNE] Iteration 500: error = 1.2199471, gradient norm = 0.0003406 (50 iterations in 0.035s)
[t-SNE] Iteration 550: error = 1.1908230, gradient norm = 0.0007970 (50 iterations in 0.035s)
[t-SNE] Iteration 600: error = 1.1797040, gradient norm = 0.0007525 (50 iterations in 0.035s)
[t-SNE] Iteration 650: error = 1.1775736, gradient norm = 0.0003408 (50 iterations in 0.037s)
[t-SNE] Iteration 700: error = 1.1777440, gradient norm = 0.0001147 (50 iterations in 0.035s)
[t-SNE] Iteration 750: error = 1.1775146, gradient norm = 0.0000785 (50 iterations in 0.038s)
[t-SNE] Iteration 800: error = 1.1775790, gradient norm = 0.0000907 (50 iterations in 0.035s)
[t-SNE] Iteration 850: error = 1.1776229, gradient norm = 0.0000893 (50 iterations in 0.038s)
[t-SNE] Iteration 900: error = 1.1776068, gradient norm = 0.0000642 (50 iterations in 0.035s)
[t-SNE] Iteration 950: error = 1.1775481, gradient norm = 0.0000928 (50 iterations in 0.035s)
[t-SNE] Iteration 1000: error = 1.1775210, gradient norm = 0.0000751 (50 iterations in 0.035s)
[t-SNE] KL divergence after 1000 iterations: 1.177521
[t-SNE] Computed conditional probabilities for sample 365 / 365
[t-SNE] Mean sigma: 0.407696
Beginning preprocessing + Leiden
2024-03-13 17:17:12.605418 MEMORY 14.38808064
Affmat transformed
2024-03-13 17:17:12.610301 MEMORY 14.38808064
sources, targets, weights extracted
2024-03-13 17:17:12.612554 MEMORY 14.38808064
About to launch parallel Leiden runs
2024-03-13 17:17:12.636801 MEMORY 14.38808064
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.1s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.9s finished
Parallel Leiden runs finished
2024-03-13 17:17:15.572164 MEMORY 14.38808064
Quality: 0.36385246607416316
Quality: 0.3647191157849245
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 350 out of 350 | elapsed:    0.1s finished
Got subclusters: Counter({0: 100, 1: 68, 2: 61, 3: 59, 4: 47, 5: 30})
On pattern 3
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 350 samples in 0.003s...
[t-SNE] Computed neighbors for 350 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 350 / 350
[t-SNE] Mean sigma: 0.400922
[t-SNE] Computed conditional probabilities in 0.023s
[t-SNE] Iteration 50: error = 61.7431450, gradient norm = 0.5355955 (50 iterations in 0.039s)
[t-SNE] Iteration 100: error = 62.8893433, gradient norm = 0.5213847 (50 iterations in 0.035s)
[t-SNE] Iteration 150: error = 64.1704178, gradient norm = 0.4974853 (50 iterations in 0.035s)
[t-SNE] Iteration 200: error = 64.3848267, gradient norm = 0.4891945 (50 iterations in 0.036s)
[t-SNE] Iteration 250: error = 65.6197891, gradient norm = 0.4748642 (50 iterations in 0.036s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 65.619789
[t-SNE] Iteration 300: error = 1.3591508, gradient norm = 0.0033413 (50 iterations in 0.036s)
[t-SNE] Iteration 350: error = 1.2934740, gradient norm = 0.0020340 (50 iterations in 0.037s)
[t-SNE] Iteration 400: error = 1.2361000, gradient norm = 0.0012865 (50 iterations in 0.036s)
[t-SNE] Iteration 450: error = 1.2250007, gradient norm = 0.0003656 (50 iterations in 0.035s)
[t-SNE] Iteration 500: error = 1.2227285, gradient norm = 0.0003836 (50 iterations in 0.038s)
[t-SNE] Iteration 550: error = 1.2187471, gradient norm = 0.0002890 (50 iterations in 0.034s)
[t-SNE] Iteration 600: error = 1.2170752, gradient norm = 0.0000924 (50 iterations in 0.034s)
[t-SNE] Iteration 650: error = 1.2168097, gradient norm = 0.0000891 (50 iterations in 0.034s)
[t-SNE] Iteration 700: error = 1.2168132, gradient norm = 0.0000977 (50 iterations in 0.034s)
[t-SNE] Iteration 750: error = 1.2168229, gradient norm = 0.0001070 (50 iterations in 0.034s)
[t-SNE] Iteration 800: error = 1.2167240, gradient norm = 0.0000846 (50 iterations in 0.038s)
[t-SNE] Iteration 850: error = 1.2168851, gradient norm = 0.0000874 (50 iterations in 0.034s)
[t-SNE] Iteration 900: error = 1.2169192, gradient norm = 0.0000756 (50 iterations in 0.034s)
[t-SNE] Iteration 950: error = 1.2169998, gradient norm = 0.0000615 (50 iterations in 0.034s)
[t-SNE] Iteration 1000: error = 1.2167771, gradient norm = 0.0000783 (50 iterations in 0.034s)
[t-SNE] KL divergence after 1000 iterations: 1.216777
[t-SNE] Computed conditional probabilities for sample 350 / 350
[t-SNE] Mean sigma: 0.400922
Beginning preprocessing + Leiden
2024-03-13 17:17:16.768582 MEMORY 14.38808064
Affmat transformed
2024-03-13 17:17:16.776458 MEMORY 14.38808064
sources, targets, weights extracted
2024-03-13 17:17:16.778674 MEMORY 14.38808064
About to launch parallel Leiden runs
2024-03-13 17:17:16.783693 MEMORY 14.38808064
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.1s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    3.1s finished
Parallel Leiden runs finished
2024-03-13 17:17:19.869949 MEMORY 14.38808064
Quality: 0.33581942176775686
Quality: 0.34201433989768765
Quality: 0.3424729479544773
Quality: 0.34248302383544577
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 349 out of 349 | elapsed:    0.1s finished
Got subclusters: Counter({0: 62, 1: 55, 2: 54, 3: 52, 4: 44, 5: 43, 6: 40})
On pattern 4
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 349 samples in 0.003s...
[t-SNE] Computed neighbors for 349 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 349 / 349
[t-SNE] Mean sigma: 0.392668
[t-SNE] Computed conditional probabilities in 0.023s
[t-SNE] Iteration 50: error = 65.1521072, gradient norm = 0.4879773 (50 iterations in 0.036s)
[t-SNE] Iteration 100: error = 65.6059494, gradient norm = 0.5080435 (50 iterations in 0.038s)
[t-SNE] Iteration 150: error = 68.5820694, gradient norm = 0.4685110 (50 iterations in 0.037s)
[t-SNE] Iteration 200: error = 67.0700302, gradient norm = 0.4809970 (50 iterations in 0.037s)
[t-SNE] Iteration 250: error = 68.2611160, gradient norm = 0.4508356 (50 iterations in 0.037s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 68.261116
[t-SNE] Iteration 300: error = 1.3154025, gradient norm = 0.0048011 (50 iterations in 0.036s)
[t-SNE] Iteration 350: error = 1.2056886, gradient norm = 0.0023667 (50 iterations in 0.035s)
[t-SNE] Iteration 400: error = 1.1501055, gradient norm = 0.0018320 (50 iterations in 0.035s)
[t-SNE] Iteration 450: error = 1.1036965, gradient norm = 0.0017965 (50 iterations in 0.035s)
[t-SNE] Iteration 500: error = 1.0849726, gradient norm = 0.0008391 (50 iterations in 0.035s)
[t-SNE] Iteration 550: error = 1.0820163, gradient norm = 0.0002133 (50 iterations in 0.035s)
[t-SNE] Iteration 600: error = 1.0819880, gradient norm = 0.0001129 (50 iterations in 0.035s)
[t-SNE] Iteration 650: error = 1.0799361, gradient norm = 0.0004634 (50 iterations in 0.035s)
[t-SNE] Iteration 700: error = 1.0766833, gradient norm = 0.0002436 (50 iterations in 0.035s)
[t-SNE] Iteration 750: error = 1.0769953, gradient norm = 0.0000960 (50 iterations in 0.035s)
[t-SNE] Iteration 800: error = 1.0769117, gradient norm = 0.0000996 (50 iterations in 0.035s)
[t-SNE] Iteration 850: error = 1.0768244, gradient norm = 0.0001260 (50 iterations in 0.035s)
[t-SNE] Iteration 900: error = 1.0766470, gradient norm = 0.0000796 (50 iterations in 0.035s)
[t-SNE] Iteration 950: error = 1.0768214, gradient norm = 0.0000837 (50 iterations in 0.035s)
[t-SNE] Iteration 1000: error = 1.0766797, gradient norm = 0.0000839 (50 iterations in 0.035s)
[t-SNE] KL divergence after 1000 iterations: 1.076680
Warning: each seqlet is not its own nearest neighbor; there may be duplicates
[t-SNE] Computed conditional probabilities for sample 349 / 349
[t-SNE] Mean sigma: 0.392668
Beginning preprocessing + Leiden
2024-03-13 17:17:21.108883 MEMORY 14.38808064
Affmat transformed
2024-03-13 17:17:21.113635 MEMORY 14.38808064
sources, targets, weights extracted
2024-03-13 17:17:21.115976 MEMORY 14.38808064
About to launch parallel Leiden runs
2024-03-13 17:17:21.120970 MEMORY 14.38808064
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.0s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    3.0s finished
Parallel Leiden runs finished
2024-03-13 17:17:24.146386 MEMORY 14.38808064
Quality: 0.3584938489568542
Quality: 0.3605403655580972
Quality: 0.3608940968832734
Quality: 0.3609837920432461
Quality: 0.3612755294299437
Quality: 0.3619114812236404
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 272 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 319 out of 319 | elapsed:    0.1s finished
Got subclusters: Counter({0: 77, 1: 63, 2: 57, 3: 45, 4: 39, 5: 38, 6: 30})
On pattern 5
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 319 samples in 0.002s...
[t-SNE] Computed neighbors for 319 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 319 / 319
[t-SNE] Mean sigma: 0.399444
[t-SNE] Computed conditional probabilities in 0.021s
[t-SNE] Iteration 50: error = 61.3887138, gradient norm = 0.5384417 (50 iterations in 1.262s)
[t-SNE] Iteration 100: error = 61.5403175, gradient norm = 0.5266111 (50 iterations in 0.380s)
[t-SNE] Iteration 150: error = 65.4333344, gradient norm = 0.4931352 (50 iterations in 0.035s)
[t-SNE] Iteration 200: error = 63.3125114, gradient norm = 0.5034020 (50 iterations in 0.035s)
[t-SNE] Iteration 250: error = 60.2383690, gradient norm = 0.5462800 (50 iterations in 0.035s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 60.238369
[t-SNE] Iteration 300: error = 1.2952619, gradient norm = 0.0038899 (50 iterations in 0.394s)
[t-SNE] Iteration 350: error = 1.2310871, gradient norm = 0.0026217 (50 iterations in 2.027s)
[t-SNE] Iteration 400: error = 1.1931502, gradient norm = 0.0018269 (50 iterations in 1.007s)
[t-SNE] Iteration 450: error = 1.1813686, gradient norm = 0.0008517 (50 iterations in 0.036s)
[t-SNE] Iteration 500: error = 1.1727020, gradient norm = 0.0007814 (50 iterations in 0.120s)
[t-SNE] Iteration 550: error = 1.1721638, gradient norm = 0.0001357 (50 iterations in 0.042s)
[t-SNE] Iteration 600: error = 1.1720655, gradient norm = 0.0001335 (50 iterations in 0.035s)
[t-SNE] Iteration 650: error = 1.1720959, gradient norm = 0.0000656 (50 iterations in 0.035s)
[t-SNE] Iteration 700: error = 1.1723039, gradient norm = 0.0000551 (50 iterations in 0.035s)
[t-SNE] Iteration 750: error = 1.1722357, gradient norm = 0.0000706 (50 iterations in 0.036s)
[t-SNE] Iteration 800: error = 1.1722344, gradient norm = 0.0000536 (50 iterations in 0.035s)
[t-SNE] Iteration 850: error = 1.1722616, gradient norm = 0.0000533 (50 iterations in 0.035s)
[t-SNE] Iteration 900: error = 1.1722686, gradient norm = 0.0000401 (50 iterations in 0.035s)
[t-SNE] Iteration 950: error = 1.1722962, gradient norm = 0.0000836 (50 iterations in 0.042s)
[t-SNE] Iteration 950: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 950 iterations: 1.172296
[t-SNE] Computed conditional probabilities for sample 319 / 319
[t-SNE] Mean sigma: 0.399444
Beginning preprocessing + Leiden
2024-03-13 17:17:30.377621 MEMORY 14.38808064
Affmat transformed
2024-03-13 17:17:30.382485 MEMORY 14.38808064
sources, targets, weights extracted
2024-03-13 17:17:30.384671 MEMORY 14.38808064
About to launch parallel Leiden runs
2024-03-13 17:17:30.395389 MEMORY 14.38808064
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.0s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    3.0s finished
Parallel Leiden runs finished
2024-03-13 17:17:33.391865 MEMORY 14.38808064
Quality: 0.3148832046653154
Quality: 0.31761510856867414
Quality: 0.3189633895952019
Quality: 0.32019138686299997
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 304 out of 304 | elapsed:    0.1s finished
Got subclusters: Counter({0: 61, 1: 55, 2: 54, 3: 49, 4: 47, 5: 27, 6: 26})
On pattern 6
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 304 samples in 0.003s...
[t-SNE] Computed neighbors for 304 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 304 / 304
[t-SNE] Mean sigma: 0.389714
[t-SNE] Computed conditional probabilities in 0.020s
[t-SNE] Iteration 50: error = 64.7758865, gradient norm = 0.5050006 (50 iterations in 0.078s)
[t-SNE] Iteration 100: error = 67.9450912, gradient norm = 0.4728398 (50 iterations in 0.034s)
[t-SNE] Iteration 150: error = 66.6012344, gradient norm = 0.4680486 (50 iterations in 0.035s)
[t-SNE] Iteration 200: error = 65.8763809, gradient norm = 0.5047976 (50 iterations in 0.034s)
[t-SNE] Iteration 250: error = 65.5740891, gradient norm = 0.4720974 (50 iterations in 0.034s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 65.574089
[t-SNE] Iteration 300: error = 1.2330098, gradient norm = 0.0052069 (50 iterations in 0.033s)
[t-SNE] Iteration 350: error = 1.1215237, gradient norm = 0.0014826 (50 iterations in 0.032s)
[t-SNE] Iteration 400: error = 1.0682502, gradient norm = 0.0024296 (50 iterations in 0.032s)
[t-SNE] Iteration 450: error = 1.0481925, gradient norm = 0.0004443 (50 iterations in 0.032s)
[t-SNE] Iteration 500: error = 1.0441248, gradient norm = 0.0004214 (50 iterations in 0.032s)
[t-SNE] Iteration 550: error = 1.0250102, gradient norm = 0.0013846 (50 iterations in 0.032s)
[t-SNE] Iteration 600: error = 1.0141373, gradient norm = 0.0006290 (50 iterations in 0.035s)
[t-SNE] Iteration 650: error = 1.0111181, gradient norm = 0.0004988 (50 iterations in 0.032s)
[t-SNE] Iteration 700: error = 1.0088066, gradient norm = 0.0002836 (50 iterations in 0.032s)
[t-SNE] Iteration 750: error = 1.0086125, gradient norm = 0.0001259 (50 iterations in 0.032s)
[t-SNE] Iteration 800: error = 1.0080836, gradient norm = 0.0001051 (50 iterations in 0.032s)
[t-SNE] Iteration 850: error = 1.0081762, gradient norm = 0.0000565 (50 iterations in 0.032s)
[t-SNE] Iteration 900: error = 1.0082990, gradient norm = 0.0000657 (50 iterations in 0.033s)
[t-SNE] Iteration 950: error = 1.0083913, gradient norm = 0.0000868 (50 iterations in 0.032s)
[t-SNE] Iteration 1000: error = 1.0083538, gradient norm = 0.0000749 (50 iterations in 0.032s)
[t-SNE] KL divergence after 1000 iterations: 1.008354
[t-SNE] Computed conditional probabilities for sample 304 / 304
[t-SNE] Mean sigma: 0.389714
Beginning preprocessing + Leiden
2024-03-13 17:17:34.610833 MEMORY 14.38808064
Affmat transformed
2024-03-13 17:17:34.615156 MEMORY 14.38808064
sources, targets, weights extracted
2024-03-13 17:17:34.617177 MEMORY 14.38808064
About to launch parallel Leiden runs
2024-03-13 17:17:34.622063 MEMORY 14.38808064
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.9s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.7s finished
Parallel Leiden runs finished
2024-03-13 17:17:37.304254 MEMORY 14.38808064
Quality: 0.36039311987247075
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 300 out of 300 | elapsed:    0.1s finished
Got subclusters: Counter({0: 69, 2: 59, 1: 59, 3: 46, 4: 36, 5: 35})
On pattern 7
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 300 samples in 0.002s...
[t-SNE] Computed neighbors for 300 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 300 / 300
[t-SNE] Mean sigma: 0.354774
[t-SNE] Computed conditional probabilities in 0.020s
[t-SNE] Iteration 50: error = 66.5075302, gradient norm = 0.4780283 (50 iterations in 0.052s)
[t-SNE] Iteration 100: error = 65.1035309, gradient norm = 0.5026745 (50 iterations in 0.033s)
[t-SNE] Iteration 150: error = 66.6260452, gradient norm = 0.4722215 (50 iterations in 0.033s)
[t-SNE] Iteration 200: error = 65.8673401, gradient norm = 0.4966680 (50 iterations in 0.033s)
[t-SNE] Iteration 250: error = 67.8538818, gradient norm = 0.4723159 (50 iterations in 0.037s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 67.853882
[t-SNE] Iteration 300: error = 1.1891849, gradient norm = 0.0037858 (50 iterations in 0.032s)
[t-SNE] Iteration 350: error = 1.0631161, gradient norm = 0.0024123 (50 iterations in 0.032s)
[t-SNE] Iteration 400: error = 1.0236963, gradient norm = 0.0010409 (50 iterations in 0.032s)
[t-SNE] Iteration 450: error = 1.0192868, gradient norm = 0.0007987 (50 iterations in 0.032s)
[t-SNE] Iteration 500: error = 1.0052969, gradient norm = 0.0004682 (50 iterations in 0.035s)
[t-SNE] Iteration 550: error = 1.0008924, gradient norm = 0.0009282 (50 iterations in 0.032s)
[t-SNE] Iteration 600: error = 1.0001926, gradient norm = 0.0001028 (50 iterations in 0.032s)
[t-SNE] Iteration 650: error = 1.0002850, gradient norm = 0.0000683 (50 iterations in 0.032s)
[t-SNE] Iteration 700: error = 1.0003086, gradient norm = 0.0000737 (50 iterations in 0.032s)
[t-SNE] Iteration 750: error = 1.0003083, gradient norm = 0.0000867 (50 iterations in 0.032s)
[t-SNE] Iteration 800: error = 1.0003374, gradient norm = 0.0000832 (50 iterations in 0.032s)
[t-SNE] Iteration 850: error = 1.0003492, gradient norm = 0.0001085 (50 iterations in 0.032s)
[t-SNE] Iteration 900: error = 1.0000619, gradient norm = 0.0000888 (50 iterations in 0.032s)
[t-SNE] Iteration 950: error = 1.0003747, gradient norm = 0.0001152 (50 iterations in 0.032s)
[t-SNE] Iteration 1000: error = 0.9919156, gradient norm = 0.0010053 (50 iterations in 0.032s)
[t-SNE] KL divergence after 1000 iterations: 0.991916
[t-SNE] Computed conditional probabilities for sample 300 / 300
[t-SNE] Mean sigma: 0.354774
Beginning preprocessing + Leiden
2024-03-13 17:17:38.472902 MEMORY 14.38808064
Affmat transformed
2024-03-13 17:17:38.477084 MEMORY 14.38808064
sources, targets, weights extracted
2024-03-13 17:17:38.479386 MEMORY 14.38808064
About to launch parallel Leiden runs
2024-03-13 17:17:38.484160 MEMORY 14.38808064
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.0s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.9s finished
Parallel Leiden runs finished
2024-03-13 17:17:41.399630 MEMORY 14.38808064
Quality: 0.3116199147152887
Quality: 0.31185247751825507
Quality: 0.31186606504118697
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 278 out of 278 | elapsed:    0.1s finished
Got subclusters: Counter({0: 68, 1: 61, 2: 54, 3: 36, 4: 28, 5: 27, 6: 26})
On pattern 8
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 278 samples in 0.002s...
[t-SNE] Computed neighbors for 278 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 278 / 278
[t-SNE] Mean sigma: 0.403727
[t-SNE] Computed conditional probabilities in 0.019s
[t-SNE] Iteration 50: error = 61.5918884, gradient norm = 0.5176234 (50 iterations in 0.035s)
[t-SNE] Iteration 100: error = 62.3284721, gradient norm = 0.5257959 (50 iterations in 0.031s)
[t-SNE] Iteration 150: error = 58.8134041, gradient norm = 0.5659858 (50 iterations in 0.031s)
[t-SNE] Iteration 200: error = 64.0192032, gradient norm = 0.4974189 (50 iterations in 0.031s)
[t-SNE] Iteration 250: error = 62.4052811, gradient norm = 0.4939010 (50 iterations in 0.031s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 62.405281
[t-SNE] Iteration 300: error = 1.1831138, gradient norm = 0.0058718 (50 iterations in 0.030s)
[t-SNE] Iteration 350: error = 1.0656865, gradient norm = 0.0020084 (50 iterations in 0.030s)
[t-SNE] Iteration 400: error = 1.0301912, gradient norm = 0.0021244 (50 iterations in 0.030s)
[t-SNE] Iteration 450: error = 1.0146918, gradient norm = 0.0007560 (50 iterations in 0.033s)
[t-SNE] Iteration 500: error = 1.0132955, gradient norm = 0.0002444 (50 iterations in 0.030s)
[t-SNE] Iteration 550: error = 1.0126082, gradient norm = 0.0001433 (50 iterations in 0.030s)
[t-SNE] Iteration 600: error = 1.0119530, gradient norm = 0.0001671 (50 iterations in 0.030s)
[t-SNE] Iteration 650: error = 1.0122868, gradient norm = 0.0000925 (50 iterations in 0.030s)
[t-SNE] Iteration 700: error = 1.0122198, gradient norm = 0.0001008 (50 iterations in 0.031s)
[t-SNE] Iteration 750: error = 1.0122420, gradient norm = 0.0001060 (50 iterations in 0.030s)
[t-SNE] Iteration 800: error = 1.0122410, gradient norm = 0.0000792 (50 iterations in 0.030s)
[t-SNE] Iteration 850: error = 1.0120631, gradient norm = 0.0001742 (50 iterations in 0.030s)
[t-SNE] Iteration 900: error = 1.0121241, gradient norm = 0.0001206 (50 iterations in 0.030s)
[t-SNE] Iteration 950: error = 1.0120413, gradient norm = 0.0001602 (50 iterations in 0.030s)
[t-SNE] Iteration 950: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 950 iterations: 1.012041
[t-SNE] Computed conditional probabilities for sample 278 / 278
[t-SNE] Mean sigma: 0.403727
Beginning preprocessing + Leiden
2024-03-13 17:17:42.413606 MEMORY 14.38808064
Affmat transformed
2024-03-13 17:17:42.417473 MEMORY 14.38808064
sources, targets, weights extracted
2024-03-13 17:17:42.419095 MEMORY 14.38808064
About to launch parallel Leiden runs
2024-03-13 17:17:42.431596 MEMORY 14.38808064
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.0s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.7s finished
Parallel Leiden runs finished
2024-03-13 17:17:45.089546 MEMORY 14.38808064
Quality: 0.35357102984388084
Quality: 0.35617925935993655
Quality: 0.35927975604181944
Quality: 0.35952191508601655
Quality: 0.35990998915507133
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 224 out of 271 | elapsed:    0.1s remaining:    0.0s
[Parallel(n_jobs=24)]: Done 271 out of 271 | elapsed:    0.1s finished
Got subclusters: Counter({0: 68, 1: 61, 2: 60, 3: 53, 4: 36})
On pattern 9
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 271 samples in 0.002s...
[t-SNE] Computed neighbors for 271 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 271 / 271
[t-SNE] Mean sigma: 0.440945
[t-SNE] Computed conditional probabilities in 0.018s
[t-SNE] Iteration 50: error = 61.9032669, gradient norm = 0.5136738 (50 iterations in 0.037s)
[t-SNE] Iteration 100: error = 60.3039246, gradient norm = 0.5028145 (50 iterations in 0.032s)
[t-SNE] Iteration 150: error = 61.6044502, gradient norm = 0.4927622 (50 iterations in 0.031s)
[t-SNE] Iteration 200: error = 60.1642075, gradient norm = 0.4937453 (50 iterations in 0.031s)
[t-SNE] Iteration 250: error = 58.7991524, gradient norm = 0.5355604 (50 iterations in 0.031s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 58.799152
[t-SNE] Iteration 300: error = 1.1552913, gradient norm = 0.0031760 (50 iterations in 0.030s)
[t-SNE] Iteration 350: error = 1.1278615, gradient norm = 0.0008627 (50 iterations in 0.030s)
[t-SNE] Iteration 400: error = 1.1223398, gradient norm = 0.0008712 (50 iterations in 0.030s)
[t-SNE] Iteration 450: error = 1.1126348, gradient norm = 0.0006559 (50 iterations in 0.030s)
[t-SNE] Iteration 500: error = 1.1044768, gradient norm = 0.0006333 (50 iterations in 0.033s)
[t-SNE] Iteration 550: error = 1.1017431, gradient norm = 0.0003541 (50 iterations in 0.030s)
[t-SNE] Iteration 600: error = 1.0873969, gradient norm = 0.0006552 (50 iterations in 0.030s)
[t-SNE] Iteration 650: error = 1.0846987, gradient norm = 0.0001942 (50 iterations in 0.032s)
[t-SNE] Iteration 700: error = 1.0847729, gradient norm = 0.0001102 (50 iterations in 0.030s)
[t-SNE] Iteration 750: error = 1.0848875, gradient norm = 0.0000967 (50 iterations in 0.030s)
[t-SNE] Iteration 800: error = 1.0847856, gradient norm = 0.0000752 (50 iterations in 0.030s)
[t-SNE] Iteration 850: error = 1.0847682, gradient norm = 0.0001299 (50 iterations in 0.030s)
[t-SNE] Iteration 900: error = 1.0848043, gradient norm = 0.0001863 (50 iterations in 0.030s)
[t-SNE] Iteration 950: error = 1.0848280, gradient norm = 0.0001142 (50 iterations in 0.030s)
[t-SNE] Iteration 1000: error = 1.0848315, gradient norm = 0.0000925 (50 iterations in 0.030s)
[t-SNE] Iteration 1000: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 1000 iterations: 1.084831
[t-SNE] Computed conditional probabilities for sample 271 / 271
[t-SNE] Mean sigma: 0.440945
Beginning preprocessing + Leiden
2024-03-13 17:17:46.110798 MEMORY 14.38808064
Affmat transformed
2024-03-13 17:17:46.114762 MEMORY 14.38808064
sources, targets, weights extracted
2024-03-13 17:17:46.116398 MEMORY 14.38808064
About to launch parallel Leiden runs
2024-03-13 17:17:46.121500 MEMORY 14.38808064
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.9s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.6s finished
Parallel Leiden runs finished
2024-03-13 17:17:48.735225 MEMORY 14.38808064
Quality: 0.3252856612632596
Quality: 0.3284030827621764
Quality: 0.32977027198088726
Quality: 0.3299672069932071
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 256 out of 256 | elapsed:    0.1s finished
Got subclusters: Counter({0: 61, 1: 55, 2: 53, 3: 48, 4: 47, 5: 7})
On pattern 10
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 256 samples in 0.002s...
[t-SNE] Computed neighbors for 256 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 256 / 256
[t-SNE] Mean sigma: 0.398063
[t-SNE] Computed conditional probabilities in 0.018s
[t-SNE] Iteration 50: error = 62.4905205, gradient norm = 0.4796746 (50 iterations in 0.032s)
[t-SNE] Iteration 100: error = 61.9357529, gradient norm = 0.4898911 (50 iterations in 0.032s)
[t-SNE] Iteration 150: error = 63.6283913, gradient norm = 0.5023105 (50 iterations in 0.031s)
[t-SNE] Iteration 200: error = 65.8751755, gradient norm = 0.4699903 (50 iterations in 0.031s)
[t-SNE] Iteration 250: error = 62.1238213, gradient norm = 0.5209385 (50 iterations in 0.031s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 62.123821
[t-SNE] Iteration 300: error = 1.0963042, gradient norm = 0.0059769 (50 iterations in 0.031s)
[t-SNE] Iteration 350: error = 0.9658178, gradient norm = 0.0029439 (50 iterations in 0.030s)
[t-SNE] Iteration 400: error = 0.9276283, gradient norm = 0.0012378 (50 iterations in 0.030s)
[t-SNE] Iteration 450: error = 0.9021879, gradient norm = 0.0022048 (50 iterations in 0.030s)
[t-SNE] Iteration 500: error = 0.8986093, gradient norm = 0.0001157 (50 iterations in 0.030s)
[t-SNE] Iteration 550: error = 0.8986652, gradient norm = 0.0000858 (50 iterations in 0.030s)
[t-SNE] Iteration 600: error = 0.8985938, gradient norm = 0.0000531 (50 iterations in 0.030s)
[t-SNE] Iteration 650: error = 0.8985921, gradient norm = 0.0000703 (50 iterations in 0.030s)
[t-SNE] Iteration 700: error = 0.8985551, gradient norm = 0.0000829 (50 iterations in 0.030s)
[t-SNE] Iteration 750: error = 0.8985865, gradient norm = 0.0000638 (50 iterations in 0.030s)
[t-SNE] Iteration 800: error = 0.8985386, gradient norm = 0.0000634 (50 iterations in 0.030s)
[t-SNE] Iteration 850: error = 0.8985606, gradient norm = 0.0000497 (50 iterations in 0.030s)
[t-SNE] Iteration 900: error = 0.8985745, gradient norm = 0.0000606 (50 iterations in 0.030s)
[t-SNE] Iteration 950: error = 0.8985386, gradient norm = 0.0000829 (50 iterations in 0.030s)
[t-SNE] Iteration 1000: error = 0.8985819, gradient norm = 0.0000610 (50 iterations in 0.030s)
[t-SNE] KL divergence after 1000 iterations: 0.898582
[t-SNE] Computed conditional probabilities for sample 256 / 256
[t-SNE] Mean sigma: 0.398063
Beginning preprocessing + Leiden
2024-03-13 17:17:49.742255 MEMORY 14.38808064
Affmat transformed
2024-03-13 17:17:49.745919 MEMORY 14.38808064
sources, targets, weights extracted
2024-03-13 17:17:49.747469 MEMORY 14.38808064
About to launch parallel Leiden runs
2024-03-13 17:17:49.752358 MEMORY 14.38808064
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.9s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.5s finished
Parallel Leiden runs finished
2024-03-13 17:17:52.289184 MEMORY 14.38808064
Quality: 0.3361558894803105
Quality: 0.3391645070836726
Quality: 0.33919991617857453
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 124 out of 171 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=24)]: Done 171 out of 171 | elapsed:    0.1s finished
Got subclusters: Counter({0: 63, 1: 60, 2: 58, 3: 46, 4: 27, 5: 2})
On pattern 11
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 171 samples in 0.002s...
[t-SNE] Computed neighbors for 171 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 171 / 171
[t-SNE] Mean sigma: 0.467859
[t-SNE] Computed conditional probabilities in 0.011s
[t-SNE] Iteration 50: error = 56.8121376, gradient norm = 0.4723495 (50 iterations in 0.034s)
[t-SNE] Iteration 100: error = 58.2320099, gradient norm = 0.5124608 (50 iterations in 0.024s)
[t-SNE] Iteration 150: error = 57.1436768, gradient norm = 0.5384317 (50 iterations in 0.023s)
[t-SNE] Iteration 200: error = 57.2925224, gradient norm = 0.5562552 (50 iterations in 0.023s)
[t-SNE] Iteration 250: error = 60.7155266, gradient norm = 0.4879102 (50 iterations in 0.024s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 60.715527
[t-SNE] Iteration 300: error = 0.9632871, gradient norm = 0.0106987 (50 iterations in 0.023s)
[t-SNE] Iteration 350: error = 0.7449545, gradient norm = 0.0038129 (50 iterations in 0.022s)
[t-SNE] Iteration 400: error = 0.7109003, gradient norm = 0.0013769 (50 iterations in 0.022s)
[t-SNE] Iteration 450: error = 0.6926556, gradient norm = 0.0024835 (50 iterations in 0.022s)
[t-SNE] Iteration 500: error = 0.6821012, gradient norm = 0.0003819 (50 iterations in 0.022s)
[t-SNE] Iteration 550: error = 0.6809440, gradient norm = 0.0003145 (50 iterations in 0.022s)
[t-SNE] Iteration 600: error = 0.6813685, gradient norm = 0.0002388 (50 iterations in 0.022s)
[t-SNE] Iteration 650: error = 0.6809702, gradient norm = 0.0003076 (50 iterations in 0.022s)
[t-SNE] Iteration 700: error = 0.6808171, gradient norm = 0.0002904 (50 iterations in 0.022s)
[t-SNE] Iteration 750: error = 0.6808108, gradient norm = 0.0002591 (50 iterations in 0.022s)
[t-SNE] Iteration 800: error = 0.6809592, gradient norm = 0.0003437 (50 iterations in 0.022s)
[t-SNE] Iteration 850: error = 0.6807534, gradient norm = 0.0003117 (50 iterations in 0.022s)
[t-SNE] Iteration 900: error = 0.6809909, gradient norm = 0.0003082 (50 iterations in 0.022s)
[t-SNE] Iteration 950: error = 0.6814762, gradient norm = 0.0002950 (50 iterations in 0.022s)
[t-SNE] Iteration 1000: error = 0.6814565, gradient norm = 0.0001474 (50 iterations in 0.025s)
[t-SNE] KL divergence after 1000 iterations: 0.681457
[t-SNE] Computed conditional probabilities for sample 171 / 171
[t-SNE] Mean sigma: 0.467859
Beginning preprocessing + Leiden
2024-03-13 17:17:53.048819 MEMORY 14.38808064
Affmat transformed
2024-03-13 17:17:53.051639 MEMORY 14.38808064
sources, targets, weights extracted
2024-03-13 17:17:53.052659 MEMORY 14.38808064
About to launch parallel Leiden runs
2024-03-13 17:17:53.057376 MEMORY 14.38808064
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.2s finished
Parallel Leiden runs finished
2024-03-13 17:17:55.223121 MEMORY 14.38808064
Quality: 0.29003121768640244
Quality: 0.29075779320189993
Quality: 0.2943912372156351
Quality: 0.2944886268010426
Quality: 0.2946082955803198
Quality: 0.29502747309557925
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 122 out of 169 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=24)]: Done 169 out of 169 | elapsed:    0.1s finished
Got subclusters: Counter({0: 43, 1: 40, 2: 34, 3: 26, 4: 15, 5: 8, 6: 5})
On pattern 12
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 169 samples in 0.002s...
[t-SNE] Computed neighbors for 169 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 169 / 169
[t-SNE] Mean sigma: 0.444214
[t-SNE] Computed conditional probabilities in 0.011s
[t-SNE] Iteration 50: error = 57.4763489, gradient norm = 0.4938785 (50 iterations in 0.027s)
[t-SNE] Iteration 100: error = 59.8170738, gradient norm = 0.4613967 (50 iterations in 0.024s)
[t-SNE] Iteration 150: error = 58.4171944, gradient norm = 0.4665985 (50 iterations in 0.024s)
[t-SNE] Iteration 200: error = 55.4794464, gradient norm = 0.5614702 (50 iterations in 0.023s)
[t-SNE] Iteration 250: error = 58.6293716, gradient norm = 0.5104198 (50 iterations in 0.026s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 58.629372
[t-SNE] Iteration 300: error = 0.8662192, gradient norm = 0.0096015 (50 iterations in 0.023s)
[t-SNE] Iteration 350: error = 0.6407074, gradient norm = 0.0032478 (50 iterations in 0.022s)
[t-SNE] Iteration 400: error = 0.6180711, gradient norm = 0.0011094 (50 iterations in 0.024s)
[t-SNE] Iteration 450: error = 0.6102255, gradient norm = 0.0009077 (50 iterations in 0.023s)
[t-SNE] Iteration 500: error = 0.6105288, gradient norm = 0.0001919 (50 iterations in 0.022s)
[t-SNE] Iteration 550: error = 0.6105518, gradient norm = 0.0001667 (50 iterations in 0.025s)
[t-SNE] Iteration 600: error = 0.6106544, gradient norm = 0.0001853 (50 iterations in 0.022s)
[t-SNE] Iteration 650: error = 0.6104836, gradient norm = 0.0002473 (50 iterations in 0.022s)
[t-SNE] Iteration 700: error = 0.6106037, gradient norm = 0.0001708 (50 iterations in 0.022s)
[t-SNE] Iteration 750: error = 0.6105025, gradient norm = 0.0001903 (50 iterations in 0.025s)
[t-SNE] Iteration 800: error = 0.6104900, gradient norm = 0.0001994 (50 iterations in 0.022s)
[t-SNE] Iteration 800: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 800 iterations: 0.610490
[t-SNE] Computed conditional probabilities for sample 169 / 169
[t-SNE] Mean sigma: 0.444214
Beginning preprocessing + Leiden
2024-03-13 17:17:55.858829 MEMORY 14.38808064
Affmat transformed
2024-03-13 17:17:55.861295 MEMORY 14.38808064
sources, targets, weights extracted
2024-03-13 17:17:55.862296 MEMORY 14.38808064
About to launch parallel Leiden runs
2024-03-13 17:17:55.932405 MEMORY 14.38808064
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.8s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.2s finished
Parallel Leiden runs finished
2024-03-13 17:17:58.103032 MEMORY 14.38808064
Quality: 0.3097090798358885
Quality: 0.30981307563985755
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 154 out of 154 | elapsed:    0.0s finished
Got subclusters: Counter({0: 41, 1: 38, 2: 37, 3: 35, 4: 18})
On pattern 13
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 154 samples in 0.005s...
[t-SNE] Computed neighbors for 154 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 154 / 154
[t-SNE] Mean sigma: 0.496376
[t-SNE] Computed conditional probabilities in 0.010s
[t-SNE] Iteration 50: error = 57.1408615, gradient norm = 0.4720441 (50 iterations in 0.022s)
[t-SNE] Iteration 100: error = 55.3252068, gradient norm = 0.5218440 (50 iterations in 0.021s)
[t-SNE] Iteration 150: error = 54.9123421, gradient norm = 0.5104765 (50 iterations in 0.021s)
[t-SNE] Iteration 200: error = 53.8736343, gradient norm = 0.5389772 (50 iterations in 0.021s)
[t-SNE] Iteration 250: error = 57.1712379, gradient norm = 0.5108503 (50 iterations in 0.021s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 57.171238
[t-SNE] Iteration 300: error = 0.7501605, gradient norm = 0.0116333 (50 iterations in 0.024s)
[t-SNE] Iteration 350: error = 0.6124806, gradient norm = 0.0027274 (50 iterations in 0.021s)
[t-SNE] Iteration 400: error = 0.6091263, gradient norm = 0.0004513 (50 iterations in 0.021s)
[t-SNE] Iteration 450: error = 0.6094002, gradient norm = 0.0001726 (50 iterations in 0.021s)
[t-SNE] Iteration 500: error = 0.6091132, gradient norm = 0.0002511 (50 iterations in 0.021s)
[t-SNE] Iteration 550: error = 0.6091406, gradient norm = 0.0002008 (50 iterations in 0.024s)
[t-SNE] Iteration 600: error = 0.6092113, gradient norm = 0.0002166 (50 iterations in 0.021s)
[t-SNE] Iteration 650: error = 0.6092207, gradient norm = 0.0002214 (50 iterations in 0.021s)
[t-SNE] Iteration 700: error = 0.6091769, gradient norm = 0.0002409 (50 iterations in 0.021s)
[t-SNE] Iteration 750: error = 0.6092570, gradient norm = 0.0002239 (50 iterations in 0.021s)
[t-SNE] Iteration 800: error = 0.6091387, gradient norm = 0.0002149 (50 iterations in 0.021s)
[t-SNE] Iteration 850: error = 0.6091633, gradient norm = 0.0002911 (50 iterations in 0.021s)
[t-SNE] Iteration 850: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 850 iterations: 0.609163
[t-SNE] Computed conditional probabilities for sample 154 / 154
[t-SNE] Mean sigma: 0.496376
Beginning preprocessing + Leiden
2024-03-13 17:17:58.709037 MEMORY 14.38808064
Affmat transformed
2024-03-13 17:17:58.711150 MEMORY 14.38808064
sources, targets, weights extracted
2024-03-13 17:17:58.711973 MEMORY 14.38808064
About to launch parallel Leiden runs
2024-03-13 17:17:58.716553 MEMORY 14.38808064
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.1s finished
Parallel Leiden runs finished
2024-03-13 17:18:00.781156 MEMORY 14.38808064
Quality: 0.28098495322229844
Quality: 0.2810635498478734
Quality: 0.2824080422438929
Quality: 0.2826529156346436
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 152 out of 152 | elapsed:    0.0s finished
Got subclusters: Counter({0: 41, 1: 31, 2: 31, 3: 28, 4: 23})
On pattern 14
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 152 samples in 0.001s...
[t-SNE] Computed neighbors for 152 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 152 / 152
[t-SNE] Mean sigma: 0.463338
[t-SNE] Computed conditional probabilities in 0.010s
[t-SNE] Iteration 50: error = 57.2977676, gradient norm = 0.4664843 (50 iterations in 0.022s)
[t-SNE] Iteration 100: error = 55.2722626, gradient norm = 0.5435830 (50 iterations in 0.021s)
[t-SNE] Iteration 150: error = 55.3502045, gradient norm = 0.5055254 (50 iterations in 0.021s)
[t-SNE] Iteration 200: error = 53.0905991, gradient norm = 0.6028762 (50 iterations in 0.021s)
[t-SNE] Iteration 250: error = 55.4186020, gradient norm = 0.5781227 (50 iterations in 0.021s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 55.418602
[t-SNE] Iteration 300: error = 0.7767411, gradient norm = 0.0090149 (50 iterations in 0.020s)
[t-SNE] Iteration 350: error = 0.6068996, gradient norm = 0.0028917 (50 iterations in 0.021s)
[t-SNE] Iteration 400: error = 0.6016104, gradient norm = 0.0009308 (50 iterations in 0.021s)
[t-SNE] Iteration 450: error = 0.5749745, gradient norm = 0.0018222 (50 iterations in 0.020s)
[t-SNE] Iteration 500: error = 0.5722730, gradient norm = 0.0003362 (50 iterations in 0.020s)
[t-SNE] Iteration 550: error = 0.5723326, gradient norm = 0.0002223 (50 iterations in 0.020s)
[t-SNE] Iteration 600: error = 0.5726109, gradient norm = 0.0002039 (50 iterations in 0.020s)
[t-SNE] Iteration 650: error = 0.5723860, gradient norm = 0.0002712 (50 iterations in 0.020s)
[t-SNE] Iteration 700: error = 0.5724127, gradient norm = 0.0002622 (50 iterations in 0.020s)
[t-SNE] Iteration 750: error = 0.5723860, gradient norm = 0.0002450 (50 iterations in 0.020s)
[t-SNE] Iteration 800: error = 0.5723887, gradient norm = 0.0003365 (50 iterations in 0.020s)
[t-SNE] Iteration 850: error = 0.5723606, gradient norm = 0.0002488 (50 iterations in 0.020s)
[t-SNE] Iteration 850: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 850 iterations: 0.572361
[t-SNE] Computed conditional probabilities for sample 152 / 152
[t-SNE] Mean sigma: 0.463338
Beginning preprocessing + Leiden
2024-03-13 17:18:01.360704 MEMORY 14.38808064
Affmat transformed
2024-03-13 17:18:01.362725 MEMORY 14.38808064
sources, targets, weights extracted
2024-03-13 17:18:01.363454 MEMORY 14.38808064
About to launch parallel Leiden runs
2024-03-13 17:18:01.380467 MEMORY 14.38808064
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.1s finished
Parallel Leiden runs finished
2024-03-13 17:18:03.434774 MEMORY 14.38808064
Quality: 0.2926673435910974
Quality: 0.2951579528745831
Quality: 0.29608092578769585
Quality: 0.29623893318294925
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 146 out of 146 | elapsed:    0.0s finished
Got subclusters: Counter({0: 50, 1: 29, 2: 27, 3: 23, 4: 17, 5: 3, 6: 3})
On pattern 15
[t-SNE] Computing 145 nearest neighbors...
[t-SNE] Indexed 146 samples in 0.001s...
[t-SNE] Computed neighbors for 146 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 146 / 146
[t-SNE] Mean sigma: 0.492924
[t-SNE] Computed conditional probabilities in 0.009s
[t-SNE] Iteration 50: error = 57.7266159, gradient norm = 0.4936254 (50 iterations in 0.033s)
[t-SNE] Iteration 100: error = 54.9368134, gradient norm = 0.4968837 (50 iterations in 0.022s)
[t-SNE] Iteration 150: error = 55.7583580, gradient norm = 0.4625404 (50 iterations in 0.021s)
[t-SNE] Iteration 200: error = 55.3784447, gradient norm = 0.5535067 (50 iterations in 0.021s)
[t-SNE] Iteration 250: error = 56.2294769, gradient norm = 0.4802341 (50 iterations in 0.021s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 56.229477
[t-SNE] Iteration 300: error = 0.8219382, gradient norm = 0.0102263 (50 iterations in 0.020s)
[t-SNE] Iteration 350: error = 0.6240093, gradient norm = 0.0072103 (50 iterations in 0.020s)
[t-SNE] Iteration 400: error = 0.5916601, gradient norm = 0.0012583 (50 iterations in 0.020s)
[t-SNE] Iteration 450: error = 0.5910308, gradient norm = 0.0003538 (50 iterations in 0.020s)
[t-SNE] Iteration 500: error = 0.5910279, gradient norm = 0.0005228 (50 iterations in 0.020s)
[t-SNE] Iteration 550: error = 0.5911020, gradient norm = 0.0002282 (50 iterations in 0.020s)
[t-SNE] Iteration 600: error = 0.5911373, gradient norm = 0.0001906 (50 iterations in 0.020s)
[t-SNE] Iteration 650: error = 0.5911450, gradient norm = 0.0002036 (50 iterations in 0.020s)
[t-SNE] Iteration 700: error = 0.5911642, gradient norm = 0.0002646 (50 iterations in 0.020s)
[t-SNE] Iteration 750: error = 0.5911571, gradient norm = 0.0002116 (50 iterations in 0.020s)
[t-SNE] Iteration 800: error = 0.5911686, gradient norm = 0.0002428 (50 iterations in 0.020s)
[t-SNE] Iteration 850: error = 0.5911130, gradient norm = 0.0004069 (50 iterations in 0.020s)
[t-SNE] Iteration 850: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 850 iterations: 0.591113
[t-SNE] Computed conditional probabilities for sample 146 / 146
[t-SNE] Mean sigma: 0.492924
Beginning preprocessing + Leiden
2024-03-13 17:18:04.034453 MEMORY 14.38808064
Affmat transformed
2024-03-13 17:18:04.036376 MEMORY 14.38808064
sources, targets, weights extracted
2024-03-13 17:18:04.037170 MEMORY 14.38808064
About to launch parallel Leiden runs
2024-03-13 17:18:04.042535 MEMORY 14.38808064
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.0s finished
Parallel Leiden runs finished
2024-03-13 17:18:06.043704 MEMORY 14.38808064
Quality: 0.2765513825597919
Quality: 0.28082438200683196
Quality: 0.28127710904323283
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 143 out of 143 | elapsed:    0.1s finished
Got subclusters: Counter({0: 38, 1: 33, 2: 22, 3: 21, 4: 20, 5: 12})
On pattern 16
[t-SNE] Computing 142 nearest neighbors...
[t-SNE] Indexed 143 samples in 0.001s...
[t-SNE] Computed neighbors for 143 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 143 / 143
[t-SNE] Mean sigma: 0.492987
[t-SNE] Computed conditional probabilities in 0.009s
[t-SNE] Iteration 50: error = 55.8674088, gradient norm = 0.5592223 (50 iterations in 0.061s)
[t-SNE] Iteration 100: error = 56.7837181, gradient norm = 0.5265415 (50 iterations in 0.020s)
[t-SNE] Iteration 150: error = 55.4395294, gradient norm = 0.4531683 (50 iterations in 0.020s)
[t-SNE] Iteration 200: error = 56.0401649, gradient norm = 0.5127787 (50 iterations in 0.020s)
[t-SNE] Iteration 250: error = 59.0417671, gradient norm = 0.4979751 (50 iterations in 0.020s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 59.041767
[t-SNE] Iteration 300: error = 1.0514921, gradient norm = 0.0095166 (50 iterations in 0.019s)
[t-SNE] Iteration 350: error = 0.5364823, gradient norm = 0.0100606 (50 iterations in 0.019s)
[t-SNE] Iteration 400: error = 0.4940280, gradient norm = 0.0007919 (50 iterations in 0.019s)
[t-SNE] Iteration 450: error = 0.4935767, gradient norm = 0.0001978 (50 iterations in 0.019s)
[t-SNE] Iteration 500: error = 0.4927015, gradient norm = 0.0002821 (50 iterations in 0.019s)
[t-SNE] Iteration 550: error = 0.4927991, gradient norm = 0.0002360 (50 iterations in 0.019s)
[t-SNE] Iteration 600: error = 0.4928353, gradient norm = 0.0002739 (50 iterations in 0.019s)
[t-SNE] Iteration 650: error = 0.4928002, gradient norm = 0.0001499 (50 iterations in 0.019s)
[t-SNE] Iteration 700: error = 0.4928277, gradient norm = 0.0002794 (50 iterations in 0.019s)
[t-SNE] Iteration 750: error = 0.4928961, gradient norm = 0.0003370 (50 iterations in 0.019s)
[t-SNE] Iteration 800: error = 0.4927642, gradient norm = 0.0002031 (50 iterations in 0.019s)
[t-SNE] Iteration 850: error = 0.4927211, gradient norm = 0.0002235 (50 iterations in 0.019s)
[t-SNE] Iteration 850: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 850 iterations: 0.492721
[t-SNE] Computed conditional probabilities for sample 143 / 143
[t-SNE] Mean sigma: 0.492987
Beginning preprocessing + Leiden
2024-03-13 17:18:06.652022 MEMORY 14.38808064
Affmat transformed
2024-03-13 17:18:06.653846 MEMORY 14.38808064
sources, targets, weights extracted
2024-03-13 17:18:06.654566 MEMORY 14.38808064
About to launch parallel Leiden runs
2024-03-13 17:18:06.658743 MEMORY 14.38808064
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.9s finished
Parallel Leiden runs finished
2024-03-13 17:18:08.602722 MEMORY 14.38808064
Quality: 0.30850990805365713
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 138 out of 138 | elapsed:    0.1s finished
Got subclusters: Counter({0: 40, 1: 36, 2: 34, 3: 33})
On pattern 17
[t-SNE] Computing 137 nearest neighbors...
[t-SNE] Indexed 138 samples in 0.001s...
[t-SNE] Computed neighbors for 138 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 138 / 138
[t-SNE] Mean sigma: 0.454433
[t-SNE] Computed conditional probabilities in 0.008s
[t-SNE] Iteration 50: error = 53.0259933, gradient norm = 0.5178038 (50 iterations in 0.023s)
[t-SNE] Iteration 100: error = 57.6145325, gradient norm = 0.4943995 (50 iterations in 0.019s)
[t-SNE] Iteration 150: error = 53.8829956, gradient norm = 0.5993799 (50 iterations in 0.020s)
[t-SNE] Iteration 200: error = 56.9237251, gradient norm = 0.4399995 (50 iterations in 0.020s)
[t-SNE] Iteration 250: error = 53.7765007, gradient norm = 0.5573741 (50 iterations in 0.019s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 53.776501
[t-SNE] Iteration 300: error = 0.7342638, gradient norm = 0.0118858 (50 iterations in 0.019s)
[t-SNE] Iteration 350: error = 0.5230364, gradient norm = 0.0048422 (50 iterations in 0.019s)
[t-SNE] Iteration 400: error = 0.5083964, gradient norm = 0.0004625 (50 iterations in 0.019s)
[t-SNE] Iteration 450: error = 0.5082603, gradient norm = 0.0003378 (50 iterations in 0.019s)
[t-SNE] Iteration 500: error = 0.5083095, gradient norm = 0.0002145 (50 iterations in 0.019s)
[t-SNE] Iteration 550: error = 0.5081812, gradient norm = 0.0002801 (50 iterations in 0.019s)
[t-SNE] Iteration 600: error = 0.5081467, gradient norm = 0.0002966 (50 iterations in 0.019s)
[t-SNE] Iteration 650: error = 0.5082282, gradient norm = 0.0002027 (50 iterations in 0.019s)
[t-SNE] Iteration 700: error = 0.5081859, gradient norm = 0.0003198 (50 iterations in 0.019s)
[t-SNE] Iteration 750: error = 0.5081778, gradient norm = 0.0002835 (50 iterations in 0.019s)
[t-SNE] Iteration 800: error = 0.5082046, gradient norm = 0.0001822 (50 iterations in 0.019s)
[t-SNE] Iteration 850: error = 0.5083227, gradient norm = 0.0002500 (50 iterations in 0.019s)
[t-SNE] Iteration 900: error = 0.5081886, gradient norm = 0.0002297 (50 iterations in 0.019s)
[t-SNE] Iteration 950: error = 0.5081943, gradient norm = 0.0002878 (50 iterations in 0.019s)
[t-SNE] Iteration 950: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 950 iterations: 0.508194
[t-SNE] Computed conditional probabilities for sample 138 / 138
[t-SNE] Mean sigma: 0.454433
Beginning preprocessing + Leiden
2024-03-13 17:18:09.180097 MEMORY 14.388166656
Affmat transformed
2024-03-13 17:18:09.182033 MEMORY 14.388166656
sources, targets, weights extracted
2024-03-13 17:18:09.182751 MEMORY 14.388166656
About to launch parallel Leiden runs
2024-03-13 17:18:09.187176 MEMORY 14.388166656
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.0s finished
Parallel Leiden runs finished
2024-03-13 17:18:11.197923 MEMORY 14.388166656
Quality: 0.27211459806752547
Quality: 0.2732938655095235
Quality: 0.2736401297401218
Quality: 0.2740137771759121
Quality: 0.2748470166641002
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  78 out of 125 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=24)]: Done 125 out of 125 | elapsed:    0.0s finished
Got subclusters: Counter({0: 37, 1: 33, 2: 25, 3: 24, 4: 19})
On pattern 18
[t-SNE] Computing 124 nearest neighbors...
[t-SNE] Indexed 125 samples in 0.001s...
[t-SNE] Computed neighbors for 125 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 125 / 125
[t-SNE] Mean sigma: 0.459718
[t-SNE] Computed conditional probabilities in 0.007s
[t-SNE] Iteration 50: error = 58.2470093, gradient norm = 0.4621256 (50 iterations in 0.018s)
[t-SNE] Iteration 100: error = 60.9090462, gradient norm = 0.4914301 (50 iterations in 0.018s)
[t-SNE] Iteration 150: error = 56.9863853, gradient norm = 0.5175755 (50 iterations in 0.018s)
[t-SNE] Iteration 200: error = 61.3827820, gradient norm = 0.4687680 (50 iterations in 0.018s)
[t-SNE] Iteration 250: error = 52.7238464, gradient norm = 0.6160580 (50 iterations in 0.018s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 52.723846
[t-SNE] Iteration 300: error = 0.9151157, gradient norm = 0.0070342 (50 iterations in 0.017s)
[t-SNE] Iteration 350: error = 0.4552549, gradient norm = 0.0107416 (50 iterations in 0.018s)
[t-SNE] Iteration 400: error = 0.4134056, gradient norm = 0.0021005 (50 iterations in 0.017s)
[t-SNE] Iteration 450: error = 0.4126302, gradient norm = 0.0003345 (50 iterations in 0.017s)
[t-SNE] Iteration 500: error = 0.4124229, gradient norm = 0.0003295 (50 iterations in 0.017s)
[t-SNE] Iteration 550: error = 0.4126731, gradient norm = 0.0003257 (50 iterations in 0.017s)
[t-SNE] Iteration 600: error = 0.4125579, gradient norm = 0.0004129 (50 iterations in 0.017s)
[t-SNE] Iteration 650: error = 0.4123640, gradient norm = 0.0003808 (50 iterations in 0.017s)
[t-SNE] Iteration 700: error = 0.4123607, gradient norm = 0.0003833 (50 iterations in 0.017s)
[t-SNE] Iteration 750: error = 0.4127255, gradient norm = 0.0003061 (50 iterations in 0.017s)
[t-SNE] Iteration 800: error = 0.4123337, gradient norm = 0.0004334 (50 iterations in 0.017s)
[t-SNE] Iteration 850: error = 0.4126207, gradient norm = 0.0005269 (50 iterations in 0.017s)
[t-SNE] Iteration 900: error = 0.4126228, gradient norm = 0.0003708 (50 iterations in 0.017s)
[t-SNE] Iteration 950: error = 0.4124448, gradient norm = 0.0003818 (50 iterations in 0.017s)
[t-SNE] Iteration 1000: error = 0.4125949, gradient norm = 0.0003588 (50 iterations in 0.017s)
[t-SNE] KL divergence after 1000 iterations: 0.412595
[t-SNE] Computed conditional probabilities for sample 125 / 125
[t-SNE] Mean sigma: 0.459718
Beginning preprocessing + Leiden
2024-03-13 17:18:11.724871 MEMORY 14.388166656
Affmat transformed
2024-03-13 17:18:11.726430 MEMORY 14.388166656
sources, targets, weights extracted
2024-03-13 17:18:11.726988 MEMORY 14.388166656
About to launch parallel Leiden runs
2024-03-13 17:18:11.767568 MEMORY 14.388166656
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.9s finished
Parallel Leiden runs finished
2024-03-13 17:18:13.680712 MEMORY 14.388166656
Quality: 0.21795314220835968
Quality: 0.2182208409432461
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  74 out of 121 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=24)]: Done 121 out of 121 | elapsed:    0.0s finished
Got subclusters: Counter({0: 34, 1: 30, 2: 24, 3: 22, 4: 15})
On pattern 19
[t-SNE] Computing 120 nearest neighbors...
[t-SNE] Indexed 121 samples in 0.001s...
[t-SNE] Computed neighbors for 121 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 121 / 121
[t-SNE] Mean sigma: 0.463650
[t-SNE] Computed conditional probabilities in 0.006s
[t-SNE] Iteration 50: error = 55.3369141, gradient norm = 0.5223952 (50 iterations in 0.018s)
[t-SNE] Iteration 100: error = 54.6317520, gradient norm = 0.5214167 (50 iterations in 0.018s)
[t-SNE] Iteration 150: error = 54.2151337, gradient norm = 0.4837253 (50 iterations in 0.018s)
[t-SNE] Iteration 200: error = 56.3363457, gradient norm = 0.4729269 (50 iterations in 0.018s)
[t-SNE] Iteration 250: error = 52.3522606, gradient norm = 0.6300626 (50 iterations in 0.018s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 52.352261
[t-SNE] Iteration 300: error = 0.9120997, gradient norm = 0.0097481 (50 iterations in 0.018s)
[t-SNE] Iteration 350: error = 0.4762753, gradient norm = 0.0099597 (50 iterations in 0.017s)
[t-SNE] Iteration 400: error = 0.4615419, gradient norm = 0.0008067 (50 iterations in 0.017s)
[t-SNE] Iteration 450: error = 0.4610919, gradient norm = 0.0002367 (50 iterations in 0.017s)
[t-SNE] Iteration 500: error = 0.4611594, gradient norm = 0.0001691 (50 iterations in 0.017s)
[t-SNE] Iteration 550: error = 0.4611608, gradient norm = 0.0002304 (50 iterations in 0.017s)
[t-SNE] Iteration 600: error = 0.4611540, gradient norm = 0.0001481 (50 iterations in 0.019s)
[t-SNE] Iteration 650: error = 0.4611707, gradient norm = 0.0001768 (50 iterations in 0.017s)
[t-SNE] Iteration 700: error = 0.4611668, gradient norm = 0.0001619 (50 iterations in 0.017s)
[t-SNE] Iteration 750: error = 0.4611759, gradient norm = 0.0001787 (50 iterations in 0.017s)
[t-SNE] Iteration 800: error = 0.4611754, gradient norm = 0.0002334 (50 iterations in 0.017s)
[t-SNE] Iteration 800: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 800 iterations: 0.461175
[t-SNE] Computed conditional probabilities for sample 121 / 121
[t-SNE] Mean sigma: 0.463651
Beginning preprocessing + Leiden
2024-03-13 17:18:14.128690 MEMORY 14.38828544
Affmat transformed
2024-03-13 17:18:14.130274 MEMORY 14.38828544
sources, targets, weights extracted
2024-03-13 17:18:14.130868 MEMORY 14.38828544
About to launch parallel Leiden runs
2024-03-13 17:18:14.135210 MEMORY 14.38828544
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.9s finished
Parallel Leiden runs finished
2024-03-13 17:18:16.010059 MEMORY 14.38828544
Quality: 0.22991399208579108
Quality: 0.22998179659948728
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 110 out of 110 | elapsed:    0.0s finished
Got subclusters: Counter({0: 34, 1: 33, 2: 30, 3: 17, 4: 7})
On pattern 20
[t-SNE] Computing 109 nearest neighbors...
[t-SNE] Indexed 110 samples in 0.001s...
[t-SNE] Computed neighbors for 110 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 110 / 110
[t-SNE] Mean sigma: 0.496451
[t-SNE] Computed conditional probabilities in 0.005s
[t-SNE] Iteration 50: error = 53.6455345, gradient norm = 0.5423556 (50 iterations in 0.019s)
[t-SNE] Iteration 100: error = 53.7826080, gradient norm = 0.5147127 (50 iterations in 0.017s)
[t-SNE] Iteration 150: error = 57.6833534, gradient norm = 0.4393678 (50 iterations in 0.016s)
[t-SNE] Iteration 200: error = 55.0489998, gradient norm = 0.5498894 (50 iterations in 0.016s)
[t-SNE] Iteration 250: error = 55.9814644, gradient norm = 0.4952838 (50 iterations in 0.017s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 55.981464
[t-SNE] Iteration 300: error = 0.8557659, gradient norm = 0.0062081 (50 iterations in 0.016s)
[t-SNE] Iteration 350: error = 0.6021644, gradient norm = 0.0117019 (50 iterations in 0.016s)
[t-SNE] Iteration 400: error = 0.3881387, gradient norm = 0.0027998 (50 iterations in 0.016s)
[t-SNE] Iteration 450: error = 0.3825259, gradient norm = 0.0013513 (50 iterations in 0.017s)
[t-SNE] Iteration 500: error = 0.3818029, gradient norm = 0.0005299 (50 iterations in 0.016s)
[t-SNE] Iteration 550: error = 0.3826157, gradient norm = 0.0003771 (50 iterations in 0.016s)
[t-SNE] Iteration 600: error = 0.3826226, gradient norm = 0.0000893 (50 iterations in 0.015s)
[t-SNE] Iteration 650: error = 0.3826123, gradient norm = 0.0001477 (50 iterations in 0.015s)
[t-SNE] Iteration 700: error = 0.3827017, gradient norm = 0.0000892 (50 iterations in 0.016s)
[t-SNE] Iteration 750: error = 0.3825931, gradient norm = 0.0001582 (50 iterations in 0.015s)
[t-SNE] Iteration 800: error = 0.3825840, gradient norm = 0.0001496 (50 iterations in 0.015s)
[t-SNE] Iteration 850: error = 0.3826907, gradient norm = 0.0001325 (50 iterations in 0.015s)
[t-SNE] Iteration 850: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 850 iterations: 0.382691
[t-SNE] Computed conditional probabilities for sample 110 / 110
[t-SNE] Mean sigma: 0.496451
Beginning preprocessing + Leiden
2024-03-13 17:18:16.427394 MEMORY 14.38828544
Affmat transformed
2024-03-13 17:18:16.428759 MEMORY 14.38828544
sources, targets, weights extracted
2024-03-13 17:18:16.429319 MEMORY 14.38828544
About to launch parallel Leiden runs
2024-03-13 17:18:16.433150 MEMORY 14.38828544
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.9s finished
Parallel Leiden runs finished
2024-03-13 17:18:18.312560 MEMORY 14.38828544
Quality: 0.2315154806241984
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  50 out of  97 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=24)]: Done  97 out of  97 | elapsed:    0.0s finished
Got subclusters: Counter({0: 33, 1: 30, 2: 22, 3: 18, 4: 7})
On pattern 21
[t-SNE] Computing 96 nearest neighbors...
[t-SNE] Indexed 97 samples in 0.001s...
[t-SNE] Computed neighbors for 97 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 97 / 97
[t-SNE] Mean sigma: 0.516561
[t-SNE] Computed conditional probabilities in 0.004s
[t-SNE] Iteration 50: error = 54.8431358, gradient norm = 0.5119913 (50 iterations in 0.015s)
[t-SNE] Iteration 100: error = 52.2552147, gradient norm = 0.4220826 (50 iterations in 0.015s)
[t-SNE] Iteration 150: error = 49.4709282, gradient norm = 0.5577937 (50 iterations in 0.015s)
[t-SNE] Iteration 200: error = 51.5699539, gradient norm = 0.5683700 (50 iterations in 0.014s)
[t-SNE] Iteration 250: error = 48.8229065, gradient norm = 0.5605718 (50 iterations in 0.015s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 48.822906
[t-SNE] Iteration 300: error = 0.5837103, gradient norm = 0.0155921 (50 iterations in 0.018s)
[t-SNE] Iteration 350: error = 0.3558484, gradient norm = 0.0080286 (50 iterations in 0.015s)
[t-SNE] Iteration 400: error = 0.3265011, gradient norm = 0.0031524 (50 iterations in 0.014s)
[t-SNE] Iteration 450: error = 0.3263173, gradient norm = 0.0006747 (50 iterations in 0.015s)
[t-SNE] Iteration 500: error = 0.3263710, gradient norm = 0.0005950 (50 iterations in 0.015s)
[t-SNE] Iteration 550: error = 0.3263070, gradient norm = 0.0007648 (50 iterations in 0.015s)
[t-SNE] Iteration 600: error = 0.3265372, gradient norm = 0.0004322 (50 iterations in 0.015s)
[t-SNE] Iteration 650: error = 0.3264863, gradient norm = 0.0007435 (50 iterations in 0.014s)
[t-SNE] Iteration 700: error = 0.3264316, gradient norm = 0.0006064 (50 iterations in 0.014s)
[t-SNE] Iteration 750: error = 0.3265059, gradient norm = 0.0006184 (50 iterations in 0.015s)
[t-SNE] Iteration 800: error = 0.3264659, gradient norm = 0.0004197 (50 iterations in 0.014s)
[t-SNE] Iteration 850: error = 0.3261182, gradient norm = 0.0004545 (50 iterations in 0.014s)
[t-SNE] Iteration 900: error = 0.3264771, gradient norm = 0.0004179 (50 iterations in 0.015s)
[t-SNE] Iteration 950: error = 0.3264869, gradient norm = 0.0004596 (50 iterations in 0.015s)
[t-SNE] Iteration 1000: error = 0.3265443, gradient norm = 0.0007529 (50 iterations in 0.016s)
[t-SNE] KL divergence after 1000 iterations: 0.326544
[t-SNE] Computed conditional probabilities for sample 97 / 97
[t-SNE] Mean sigma: 0.516561
Beginning preprocessing + Leiden
2024-03-13 17:18:18.718578 MEMORY 14.388314112
Affmat transformed
2024-03-13 17:18:18.719725 MEMORY 14.388314112
sources, targets, weights extracted
2024-03-13 17:18:18.720177 MEMORY 14.388314112
About to launch parallel Leiden runs
2024-03-13 17:18:18.724527 MEMORY 14.388314112
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.6s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.8s finished
Parallel Leiden runs finished
2024-03-13 17:18:20.523981 MEMORY 14.388314112
Quality: 0.21608916745659693
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  94 out of  94 | elapsed:    0.0s finished
Got subclusters: Counter({0: 32, 1: 22, 2: 17, 3: 16, 4: 10})
On pattern 22
[t-SNE] Computing 93 nearest neighbors...
[t-SNE] Indexed 94 samples in 0.001s...
[t-SNE] Computed neighbors for 94 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 94 / 94
[t-SNE] Mean sigma: 0.556803
[t-SNE] Computed conditional probabilities in 0.004s
[t-SNE] Iteration 50: error = 53.7979126, gradient norm = 0.4617498 (50 iterations in 0.014s)
[t-SNE] Iteration 100: error = 50.0961266, gradient norm = 0.5327702 (50 iterations in 0.014s)
[t-SNE] Iteration 150: error = 52.5029945, gradient norm = 0.4740950 (50 iterations in 0.014s)
[t-SNE] Iteration 200: error = 54.2330513, gradient norm = 0.5951873 (50 iterations in 0.014s)
[t-SNE] Iteration 250: error = 50.7491379, gradient norm = 0.5463991 (50 iterations in 0.017s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 50.749138
[t-SNE] Iteration 300: error = 0.8490020, gradient norm = 0.0061570 (50 iterations in 0.014s)
[t-SNE] Iteration 350: error = 0.3746263, gradient norm = 0.0202927 (50 iterations in 0.014s)
[t-SNE] Iteration 400: error = 0.2836202, gradient norm = 0.0032041 (50 iterations in 0.014s)
[t-SNE] Iteration 450: error = 0.2834757, gradient norm = 0.0004137 (50 iterations in 0.014s)
[t-SNE] Iteration 500: error = 0.2835025, gradient norm = 0.0004377 (50 iterations in 0.014s)
[t-SNE] Iteration 550: error = 0.2835007, gradient norm = 0.0004636 (50 iterations in 0.014s)
[t-SNE] Iteration 600: error = 0.2833558, gradient norm = 0.0006007 (50 iterations in 0.017s)
[t-SNE] Iteration 650: error = 0.2834800, gradient norm = 0.0004639 (50 iterations in 0.014s)
[t-SNE] Iteration 700: error = 0.2834842, gradient norm = 0.0002894 (50 iterations in 0.014s)
[t-SNE] Iteration 750: error = 0.2832856, gradient norm = 0.0004127 (50 iterations in 0.014s)
[t-SNE] Iteration 800: error = 0.2832638, gradient norm = 0.0004674 (50 iterations in 0.014s)
[t-SNE] Iteration 850: error = 0.2833739, gradient norm = 0.0007257 (50 iterations in 0.014s)
[t-SNE] Iteration 900: error = 0.2832519, gradient norm = 0.0005239 (50 iterations in 0.014s)
[t-SNE] Iteration 950: error = 0.2832672, gradient norm = 0.0005585 (50 iterations in 0.014s)
[t-SNE] Iteration 1000: error = 0.2834481, gradient norm = 0.0004308 (50 iterations in 0.014s)
[t-SNE] KL divergence after 1000 iterations: 0.283448
[t-SNE] Computed conditional probabilities for sample 94 / 94
[t-SNE] Mean sigma: 0.556803
Beginning preprocessing + Leiden
2024-03-13 17:18:20.929399 MEMORY 14.388314112
Affmat transformed
2024-03-13 17:18:20.930506 MEMORY 14.388314112
sources, targets, weights extracted
2024-03-13 17:18:20.930955 MEMORY 14.388314112
About to launch parallel Leiden runs
2024-03-13 17:18:20.935133 MEMORY 14.388314112
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.6s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.8s finished
Parallel Leiden runs finished
2024-03-13 17:18:22.765828 MEMORY 14.388314112
Quality: 0.231233119242025
Quality: 0.2332103138588707
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  78 out of  78 | elapsed:    0.0s finished
Got subclusters: Counter({0: 27, 1: 24, 2: 20, 3: 14, 4: 9})
On pattern 23
[t-SNE] Computing 77 nearest neighbors...
[t-SNE] Indexed 78 samples in 0.001s...
[t-SNE] Computed neighbors for 78 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 78 / 78
[t-SNE] Mean sigma: 0.569241
[t-SNE] Computed conditional probabilities in 0.003s
[t-SNE] Iteration 50: error = 51.7805214, gradient norm = 0.5016094 (50 iterations in 0.013s)
[t-SNE] Iteration 100: error = 51.9385376, gradient norm = 0.5037911 (50 iterations in 0.013s)
[t-SNE] Iteration 150: error = 49.1410828, gradient norm = 0.5569999 (50 iterations in 0.013s)
[t-SNE] Iteration 200: error = 50.9171982, gradient norm = 0.4425682 (50 iterations in 0.013s)
[t-SNE] Iteration 250: error = 54.2569389, gradient norm = 0.5051604 (50 iterations in 0.013s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 54.256939
[t-SNE] Iteration 300: error = 0.9504637, gradient norm = 0.0025678 (50 iterations in 0.016s)
[t-SNE] Iteration 350: error = 0.8118808, gradient norm = 0.0015638 (50 iterations in 0.012s)
[t-SNE] Iteration 400: error = 0.7567323, gradient norm = 0.0011713 (50 iterations in 0.012s)
[t-SNE] Iteration 450: error = 0.6849622, gradient norm = 0.0011747 (50 iterations in 0.012s)
[t-SNE] Iteration 500: error = 0.6226753, gradient norm = 0.0015031 (50 iterations in 0.012s)
[t-SNE] Iteration 550: error = 0.5539491, gradient norm = 0.0017277 (50 iterations in 0.012s)
[t-SNE] Iteration 600: error = 0.5222952, gradient norm = 0.0008135 (50 iterations in 0.012s)
[t-SNE] Iteration 650: error = 0.5087828, gradient norm = 0.0006218 (50 iterations in 0.012s)
[t-SNE] Iteration 700: error = 0.4292347, gradient norm = 0.0149340 (50 iterations in 0.012s)
[t-SNE] Iteration 750: error = 0.1813632, gradient norm = 0.0072125 (50 iterations in 0.012s)
[t-SNE] Iteration 800: error = 0.1792901, gradient norm = 0.0013836 (50 iterations in 0.012s)
[t-SNE] Iteration 850: error = 0.1791540, gradient norm = 0.0009060 (50 iterations in 0.012s)
[t-SNE] Iteration 900: error = 0.1793794, gradient norm = 0.0006890 (50 iterations in 0.012s)
[t-SNE] Iteration 950: error = 0.1793785, gradient norm = 0.0008677 (50 iterations in 0.012s)
[t-SNE] Iteration 1000: error = 0.1789641, gradient norm = 0.0008447 (50 iterations in 0.012s)
[t-SNE] KL divergence after 1000 iterations: 0.178964
[t-SNE] Computed conditional probabilities for sample 78 / 78
[t-SNE] Mean sigma: 0.569241
Beginning preprocessing + Leiden
2024-03-13 17:18:23.116544 MEMORY 14.388314112
Affmat transformed
2024-03-13 17:18:23.117505 MEMORY 14.388314112
sources, targets, weights extracted
2024-03-13 17:18:23.117908 MEMORY 14.388314112
About to launch parallel Leiden runs
2024-03-13 17:18:23.121636 MEMORY 14.388314112
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.9s finished
Parallel Leiden runs finished
2024-03-13 17:18:24.982932 MEMORY 14.388314112
Quality: 0.17115013542932989
Quality: 0.1724907931393495
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done  48 out of  48 | elapsed:    0.0s finished
Got subclusters: Counter({0: 22, 1: 19, 2: 19, 3: 18})
On pattern 24
[t-SNE] Computing 47 nearest neighbors...
[t-SNE] Indexed 48 samples in 0.000s...
[t-SNE] Computed neighbors for 48 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 48 / 48
[t-SNE] Mean sigma: 11.816783
[t-SNE] Computed conditional probabilities in 0.001s
[t-SNE] Iteration 50: error = 42.6274338, gradient norm = 0.5343498 (50 iterations in 0.011s)
[t-SNE] Iteration 100: error = 42.2001915, gradient norm = 0.5266153 (50 iterations in 0.012s)
[t-SNE] Iteration 150: error = 43.3578072, gradient norm = 0.3453353 (50 iterations in 0.013s)
[t-SNE] Iteration 200: error = 41.9621124, gradient norm = 0.4378380 (50 iterations in 0.012s)
[t-SNE] Iteration 250: error = 41.8998184, gradient norm = 0.4875803 (50 iterations in 0.011s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 41.899818
[t-SNE] Iteration 300: error = 0.8385696, gradient norm = 0.0015103 (50 iterations in 0.011s)
[t-SNE] Iteration 350: error = 0.7045983, gradient norm = 0.0005517 (50 iterations in 0.010s)
[t-SNE] Iteration 400: error = 0.6454062, gradient norm = 0.0002501 (50 iterations in 0.011s)
[t-SNE] Iteration 450: error = 0.6073129, gradient norm = 0.0000915 (50 iterations in 0.010s)
[t-SNE] Iteration 500: error = 0.6061340, gradient norm = 0.0000351 (50 iterations in 0.011s)
[t-SNE] Iteration 550: error = 0.6060147, gradient norm = 0.0000193 (50 iterations in 0.010s)
[t-SNE] Iteration 600: error = 0.6056930, gradient norm = 0.0000149 (50 iterations in 0.010s)
[t-SNE] Iteration 650: error = 0.6056332, gradient norm = 0.0000202 (50 iterations in 0.010s)
[t-SNE] Iteration 700: error = 0.6056730, gradient norm = 0.0000138 (50 iterations in 0.010s)
[t-SNE] Iteration 750: error = 0.6056642, gradient norm = 0.0000150 (50 iterations in 0.014s)
[t-SNE] Iteration 800: error = 0.6056532, gradient norm = 0.0000195 (50 iterations in 0.010s)
[t-SNE] Iteration 850: error = 0.6056585, gradient norm = 0.0000189 (50 iterations in 0.010s)
[t-SNE] Iteration 900: error = 0.6056679, gradient norm = 0.0000165 (50 iterations in 0.010s)
[t-SNE] Iteration 950: error = 0.6056285, gradient norm = 0.0000194 (50 iterations in 0.010s)
[t-SNE] Iteration 1000: error = 0.6056125, gradient norm = 0.0000201 (50 iterations in 0.010s)
[t-SNE] KL divergence after 1000 iterations: 0.605612
[t-SNE] Computed conditional probabilities for sample 48 / 48
[t-SNE] Mean sigma: 1125899906842624.000000
Beginning preprocessing + Leiden
2024-03-13 17:18:25.254810 MEMORY 14.388314112
Affmat transformed
2024-03-13 17:18:25.255548 MEMORY 14.388314112
sources, targets, weights extracted
2024-03-13 17:18:25.255861 MEMORY 14.388314112
About to launch parallel Leiden runs
2024-03-13 17:18:25.259616 MEMORY 14.388314112
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.6s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.7s finished
Parallel Leiden runs finished
2024-03-13 17:18:26.947114 MEMORY 14.388314112
Quality: 8.88178419700137e-16
Got subclusters: Counter({0: 48})
On metacluster 4
Metacluster size 12031
Relevant tasks:  ('testis',)
Relevant signs:  (-1,)
TfModiscoSeqletsToPatternsFactory: seed=1234
(Round 1) num seqlets: 12031
(Round 1) Computing coarse affmat
2024-03-13 17:18:30.602796 MEMORY 14.289793024
Beginning embedding computation
MEMORY 14.289793024
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 152 tasks      | elapsed:    1.9s
[Parallel(n_jobs=24)]: Done 402 tasks      | elapsed:    4.8s
[Parallel(n_jobs=24)]: Done 752 tasks      | elapsed:    8.7s
[Parallel(n_jobs=24)]: Done 1202 tasks      | elapsed:   13.5s
[Parallel(n_jobs=24)]: Done 1752 tasks      | elapsed:   19.5s
[Parallel(n_jobs=24)]: Done 2402 tasks      | elapsed:   26.7s
[Parallel(n_jobs=24)]: Done 3152 tasks      | elapsed:   34.8s
[Parallel(n_jobs=24)]: Done 4002 tasks      | elapsed:   44.2s
[Parallel(n_jobs=24)]: Done 4952 tasks      | elapsed:   54.6s
[Parallel(n_jobs=24)]: Done 6002 tasks      | elapsed:  1.1min
[Parallel(n_jobs=24)]: Done 7152 tasks      | elapsed:  1.3min
[Parallel(n_jobs=24)]: Done 8402 tasks      | elapsed:  1.5min
[Parallel(n_jobs=24)]: Done 9752 tasks      | elapsed:  1.8min
[Parallel(n_jobs=24)]: Done 11202 tasks      | elapsed:  2.1min
[Parallel(n_jobs=24)]: Done 12031 out of 12031 | elapsed:  2.2min finished
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 152 tasks      | elapsed:    1.9s
[Parallel(n_jobs=24)]: Done 402 tasks      | elapsed:    4.6s
[Parallel(n_jobs=24)]: Done 752 tasks      | elapsed:    8.5s
[Parallel(n_jobs=24)]: Done 1202 tasks      | elapsed:   13.5s
[Parallel(n_jobs=24)]: Done 1752 tasks      | elapsed:   19.5s
[Parallel(n_jobs=24)]: Done 2402 tasks      | elapsed:   26.7s
[Parallel(n_jobs=24)]: Done 3152 tasks      | elapsed:   34.9s
[Parallel(n_jobs=24)]: Done 4002 tasks      | elapsed:   44.3s
[Parallel(n_jobs=24)]: Done 4952 tasks      | elapsed:   54.7s
[Parallel(n_jobs=24)]: Done 6002 tasks      | elapsed:  1.1min
[Parallel(n_jobs=24)]: Done 7152 tasks      | elapsed:  1.3min
[Parallel(n_jobs=24)]: Done 8402 tasks      | elapsed:  1.5min
[Parallel(n_jobs=24)]: Done 9752 tasks      | elapsed:  1.8min
[Parallel(n_jobs=24)]: Done 11202 tasks      | elapsed:  2.1min
[Parallel(n_jobs=24)]: Done 12031 out of 12031 | elapsed:  2.2min finished
At the beginning of embedding call
2024-03-13 17:18:30.603074 MEMORY 14.289793024
before computing embeddings fwd
2024-03-13 17:18:30.612055 MEMORY 14.289793024
after computing embeddings fwd
2024-03-13 17:20:42.677512 MEMORY 14.317965312
after computing embeddings rev
2024-03-13 17:22:54.951534 MEMORY 14.807465984
before computing sparse embeddings fwd
2024-03-13 17:22:54.951636 MEMORY 14.807465984
Constructing csr matrix...
csr matrix made in 1.4869999885559082 s
after computing sparse embeddings fwd
2024-03-13 17:22:57.087964 MEMORY 14.855716864
before computing sparse embeddings rev
2024-03-13 17:22:57.088060 MEMORY 14.855716864
Constructing csr matrix...
csr matrix made in 1.5059168338775635 s
after computing sparse embeddings rev
2024-03-13 17:22:59.166976 MEMORY 14.904107008
Finished embedding computation in 272.32 s
MEMORY 14.5156096
Starting affinity matrix computations
MEMORY 14.515085312
Batching in slices of size 5577
  0%|          | 0/3 [00:00<?, ?it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 1/3 [00:09<00:19,  9.66s/it] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 2/3 [00:18<00:09,  9.30s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:21<00:00,  6.36s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:21<00:00,  7.19s/it]
Finished affinity matrix computations in 21.63 s
MEMORY 14.563012608
(Round 1) Computed coarse affmat
2024-03-13 17:23:27.613352 MEMORY 14.466494464
(Round 1) Computing affinity matrix on nearest neighbors
2024-03-13 17:23:27.613561 MEMORY 14.466494464
Launching nearest neighbors affmat calculation job
MEMORY 14.466494464
Parallel runs completed
MEMORY 14.660841472
Job completed in: 37.96 s
MEMORY 14.659817472
Launching nearest neighbors affmat calculation job
MEMORY 14.659817472
Parallel runs completed
MEMORY 14.803505152
Job completed in: 37.15 s
MEMORY 14.804557824
(Round 1) Computed affinity matrix on nearest neighbors in 78.66 s
2024-03-13 17:24:46.279396 MEMORY 14.805020672
Filtered down to 10154 of 12031
(Round 1) Retained 10154 rows out of 12031 after filtering
2024-03-13 17:24:52.363728 MEMORY 14.80503296
(Round 1) Computing density adapted affmat
2024-03-13 17:24:56.070526 MEMORY 14.80503296
Symmetrizing nearest neighbors
Computing betas for density adaptation
Computing normalizing denominators
(Round 1) Computing clustering
2024-03-13 17:26:17.170585 MEMORY 14.763094016
Beginning preprocessing + Leiden
2024-03-13 17:26:17.188092 MEMORY 14.763094016
Affmat transformed
2024-03-13 17:26:17.188244 MEMORY 14.763094016
sources, targets, weights extracted
2024-03-13 17:26:17.545014 MEMORY 14.86968832
About to launch parallel Leiden runs
2024-03-13 17:26:17.627483 MEMORY 14.816464896
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:   44.6s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:  3.1min finished
Parallel Leiden runs finished
2024-03-13 17:29:23.509024 MEMORY 14.816464896
Quality: 0.4294003479587093
Quality: 0.4294089060325069
Got 4 clusters after round 1
Counts:
{2: 2445, 3: 1733, 1: 2869, 0: 3107}
2024-03-13 17:29:23.547276 MEMORY 14.629797888
(Round 1) Aggregating seqlets in each cluster
2024-03-13 17:29:23.547374 MEMORY 14.629797888
Aggregating for cluster 0 with 3107 seqlets
2024-03-13 17:29:23.557217 MEMORY 14.629797888
Trimming eliminated 0 seqlets out of 3107
Aggregating for cluster 1 with 2869 seqlets
2024-03-13 17:29:30.402907 MEMORY 14.629818368
Skipped 2 due to duplicates
Trimming eliminated 0 seqlets out of 2867
Aggregating for cluster 2 with 2445 seqlets
2024-03-13 17:29:38.663684 MEMORY 14.629818368
Removed 1 duplicate seqlets
Skipped 2 due to duplicates
Trimming eliminated 0 seqlets out of 2442
Removed 1 duplicate seqlets
Aggregating for cluster 3 with 1733 seqlets
2024-03-13 17:29:43.881304 MEMORY 14.629818368
Trimming eliminated 0 seqlets out of 1733
(Round 2) num seqlets: 10148
(Round 2) Computing coarse affmat
2024-03-13 17:29:50.563969 MEMORY 14.629818368
Beginning embedding computation
MEMORY 14.629818368
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 368 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done 1368 tasks      | elapsed:    2.1s
[Parallel(n_jobs=24)]: Done 2768 tasks      | elapsed:    4.1s
[Parallel(n_jobs=24)]: Done 4568 tasks      | elapsed:    6.6s
[Parallel(n_jobs=24)]: Done 6768 tasks      | elapsed:    9.8s
[Parallel(n_jobs=24)]: Done 9368 tasks      | elapsed:   13.5s
[Parallel(n_jobs=24)]: Done 10148 out of 10148 | elapsed:   14.5s finished
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 368 tasks      | elapsed:    0.8s
[Parallel(n_jobs=24)]: Done 1368 tasks      | elapsed:    2.1s
[Parallel(n_jobs=24)]: Done 2768 tasks      | elapsed:    4.1s
[Parallel(n_jobs=24)]: Done 4568 tasks      | elapsed:    6.6s
[Parallel(n_jobs=24)]: Done 6768 tasks      | elapsed:    9.7s
[Parallel(n_jobs=24)]: Done 9368 tasks      | elapsed:   13.4s
[Parallel(n_jobs=24)]: Done 10148 out of 10148 | elapsed:   14.5s finished
At the beginning of embedding call
2024-03-13 17:29:50.564211 MEMORY 14.629818368
before computing embeddings fwd
2024-03-13 17:29:50.573246 MEMORY 14.629818368
after computing embeddings fwd
2024-03-13 17:30:05.056572 MEMORY 14.862475264
after computing embeddings rev
2024-03-13 17:30:19.541687 MEMORY 15.278768128
before computing sparse embeddings fwd
2024-03-13 17:30:19.541774 MEMORY 15.278768128
Constructing csr matrix...
csr matrix made in 1.161543846130371 s
after computing sparse embeddings fwd
2024-03-13 17:30:21.247949 MEMORY 15.46821632
before computing sparse embeddings rev
2024-03-13 17:30:21.248030 MEMORY 15.46821632
Constructing csr matrix...
csr matrix made in 1.1337060928344727 s
after computing sparse embeddings rev
2024-03-13 17:30:22.831518 MEMORY 15.539621888
Finished embedding computation in 35.04 s
MEMORY 15.20224256
Starting affinity matrix computations
MEMORY 15.201718272
Batching in slices of size 6613
  0%|          | 0/2 [00:00<?, ?it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:11<00:11, 11.12s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:18<00:00,  8.68s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:18<00:00,  9.05s/it]
Finished affinity matrix computations in 18.14 s
MEMORY 15.231778816
(Round 2) Computed coarse affmat
2024-03-13 17:30:45.779030 MEMORY 15.00153856
(Round 2) Computing affinity matrix on nearest neighbors
2024-03-13 17:30:45.779180 MEMORY 15.00153856
Launching nearest neighbors affmat calculation job
MEMORY 15.00153856
Parallel runs completed
MEMORY 15.013883904
Job completed in: 16.38 s
MEMORY 15.013687296
Launching nearest neighbors affmat calculation job
MEMORY 15.013490688
Parallel runs completed
MEMORY 15.01566976
Job completed in: 16.25 s
MEMORY 15.015473152
(Round 2) Computed affinity matrix on nearest neighbors in 36.04 s
2024-03-13 17:31:21.836969 MEMORY 15.015276544
Not applying filtering for rounds above first round
2024-03-13 17:31:21.838415 MEMORY 15.015276544
(Round 2) Computing density adapted affmat
2024-03-13 17:31:25.763590 MEMORY 15.019593728
Symmetrizing nearest neighbors
Computing betas for density adaptation
Computing normalizing denominators
(Round 2) Computing clustering
2024-03-13 17:32:51.690809 MEMORY 15.516127232
Beginning preprocessing + Leiden
2024-03-13 17:32:51.705424 MEMORY 15.516127232
Affmat transformed
2024-03-13 17:32:51.705547 MEMORY 15.516127232
sources, targets, weights extracted
2024-03-13 17:32:52.076228 MEMORY 15.516127232
About to launch parallel Leiden runs
2024-03-13 17:32:52.171112 MEMORY 15.516127232
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:   35.3s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:  2.5min finished
Parallel Leiden runs finished
2024-03-13 17:35:22.612239 MEMORY 15.516266496
Quality: 0.5000157316501285
Quality: 0.5000169732745984
Got 4 clusters after round 2
Counts:
{0: 3223, 2: 2512, 3: 1839, 1: 2574}
2024-03-13 17:35:22.643800 MEMORY 15.516266496
(Round 2) Aggregating seqlets in each cluster
2024-03-13 17:35:22.643912 MEMORY 15.516266496
Aggregating for cluster 0 with 3223 seqlets
2024-03-13 17:35:22.650041 MEMORY 15.516266496
Skipped 2 due to duplicates
Trimming eliminated 0 seqlets out of 3221
Aggregating for cluster 1 with 2574 seqlets
2024-03-13 17:35:30.086043 MEMORY 15.515742208
Trimming eliminated 0 seqlets out of 2574
Aggregating for cluster 2 with 2512 seqlets
2024-03-13 17:35:33.935841 MEMORY 15.515734016
Skipped 1 due to duplicates
Trimming eliminated 0 seqlets out of 2511
Aggregating for cluster 3 with 1839 seqlets
2024-03-13 17:35:38.027438 MEMORY 15.515734016
Trimming eliminated 0 seqlets out of 1839
Got 4 clusters
Splitting into subclusters...
2024-03-13 17:35:40.720367 MEMORY 15.515734016
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 2952 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done 3221 out of 3221 | elapsed:    0.7s finished
Inspecting pattern 0 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 3221
[t-SNE] Computed conditional probabilities for sample 2000 / 3221
[t-SNE] Computed conditional probabilities for sample 3000 / 3221
[t-SNE] Computed conditional probabilities for sample 3221 / 3221
[t-SNE] Mean sigma: 0.306096
Beginning preprocessing + Leiden
2024-03-13 17:35:44.794925 MEMORY 15.515734016
Affmat transformed
2024-03-13 17:35:44.830831 MEMORY 15.515734016
sources, targets, weights extracted
2024-03-13 17:35:44.856030 MEMORY 15.515734016
About to launch parallel Leiden runs
2024-03-13 17:35:44.869831 MEMORY 15.515734016
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:   12.2s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   43.2s finished
Parallel Leiden runs finished
2024-03-13 17:36:28.120716 MEMORY 15.515734016
Quality: 0.5025767412603669
Quality: 0.5042047925295392
Quality: 0.5049548569409092
Quality: 0.5054245013018306
Got subclusters: Counter({0: 670, 1: 622, 2: 579, 3: 437, 4: 308, 5: 278, 6: 278, 7: 49})
On merging iteration 1
Numbers for each pattern pre-subsample: [670, 622, 579, 437, 308, 278, 278, 49]
Numbers after subsampling: [300, 300, 300, 300, 300, 278, 278, 49]
Computing sims for pattern 0
Computed sims for pattern 0 in 2.0355398654937744 s
Computing sims for pattern 1
Computed sims for pattern 1 in 2.042289972305298 s
Computing sims for pattern 2
Computed sims for pattern 2 in 2.0991315841674805 s
Computing sims for pattern 3
Computed sims for pattern 3 in 2.0474917888641357 s
Computing sims for pattern 4
Computed sims for pattern 4 in 2.098897933959961 s
Computing sims for pattern 5
Computed sims for pattern 5 in 1.8922133445739746 s
Computing sims for pattern 6
Computed sims for pattern 6 in 1.8732192516326904 s
Computing sims for pattern 7
Computed sims for pattern 7 in 0.48302769660949707 s
Cluster sizes
[670 622 579 437 308 278 278  49]
Cross-contamination matrix:
[[1.   0.61 0.51 0.78 0.63 0.61 0.64 0.52]
 [0.43 1.   0.51 0.6  0.35 0.65 0.63 0.53]
 [0.61 0.81 1.   0.71 0.53 0.72 0.75 0.56]
 [0.66 0.67 0.48 1.   0.47 0.72 0.61 0.53]
 [0.88 0.76 0.66 0.84 1.   0.74 0.73 0.62]
 [0.5  0.71 0.5  0.71 0.4  1.   0.51 0.39]
 [0.62 0.82 0.61 0.71 0.47 0.6  1.   0.6 ]
 [0.4  0.58 0.35 0.52 0.3  0.37 0.48 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.79 0.74 0.91 0.89 0.78 0.8  0.79]
 [0.79 1.   0.77 0.85 0.72 0.82 0.85 0.78]
 [0.74 0.77 1.   0.78 0.68 0.75 0.76 0.68]
 [0.91 0.85 0.78 1.   0.83 0.84 0.84 0.8 ]
 [0.89 0.72 0.68 0.83 1.   0.74 0.73 0.72]
 [0.78 0.82 0.75 0.84 0.74 1.   0.73 0.68]
 [0.8  0.85 0.76 0.84 0.73 0.73 1.   0.76]
 [0.79 0.78 0.68 0.8  0.72 0.68 0.76 1.  ]]
Collapsing 0 & 3 with crosscontam 0.6623085871604939 and sim 0.9116876736652363
Collapsing 0 & 4 with crosscontam 0.6300719456790123 and sim 0.888983775840266
Collapsing 1 & 6 with crosscontam 0.6349429560351718 and sim 0.8537366686653844
Collapsing 1 & 3 with crosscontam 0.602130446419753 and sim 0.8503324665850835
Trimming eliminated 0 seqlets out of 1107
Trimming eliminated 0 seqlets out of 1415
Trimming eliminated 0 seqlets out of 900
Trimming eliminated 0 seqlets out of 2315
Unmerged patterns remapping: OrderedDict([(2, 1), (5, 2), (7, 3)])
Time spent on merging iteration: 11.730093002319336
On merging iteration 2
Numbers for each pattern pre-subsample: [2315, 579, 278, 49]
Numbers after subsampling: [300, 300, 278, 49]
Computing sims for pattern 0
Computed sims for pattern 0 in 0.8870606422424316 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.3378567695617676 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.2961118221282959 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.0769796371459961 s
Cluster sizes
[2315  579  278   49]
Cross-contamination matrix:
[[1.   0.79 0.94 0.85]
 [0.69 1.   0.72 0.56]
 [0.58 0.5  1.   0.39]
 [0.49 0.35 0.37 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.81 0.85 0.83]
 [0.81 1.   0.75 0.68]
 [0.85 0.75 1.   0.68]
 [0.83 0.68 0.68 1.  ]]
Collapsing 0 & 2 with crosscontam 0.5841263013604436 and sim 0.8516462131607017
Trimming eliminated 0 seqlets out of 2593
Unmerged patterns remapping: OrderedDict([(1, 1), (3, 2)])
Time spent on merging iteration: 2.2088470458984375
On merging iteration 3
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 2146 tasks      | elapsed:    0.5s
[Parallel(n_jobs=24)]: Done 2574 out of 2574 | elapsed:    0.6s finished
Numbers for each pattern pre-subsample: [2593, 579, 49]
Numbers after subsampling: [300, 300, 49]
Computing sims for pattern 0
Computed sims for pattern 0 in 0.5724530220031738 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.333773136138916 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.08245563507080078 s
Cluster sizes
[2593  579   49]
Cross-contamination matrix:
[[1.   0.81 0.86]
 [0.67 1.   0.56]
 [0.46 0.35 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.81 0.83]
 [0.81 1.   0.68]
 [0.83 0.68 1.  ]]
Inspecting pattern 1 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 2574
[t-SNE] Computed conditional probabilities for sample 2000 / 2574
[t-SNE] Computed conditional probabilities for sample 2574 / 2574
[t-SNE] Mean sigma: 0.311315
Beginning preprocessing + Leiden
2024-03-13 17:37:03.006023 MEMORY 15.515742208
Affmat transformed
2024-03-13 17:37:03.035920 MEMORY 15.515742208
sources, targets, weights extracted
2024-03-13 17:37:03.056179 MEMORY 15.515742208
About to launch parallel Leiden runs
2024-03-13 17:37:03.072277 MEMORY 15.515742208
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    8.8s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   31.6s finished
Parallel Leiden runs finished
2024-03-13 17:37:34.695161 MEMORY 15.515742208
Quality: 0.4770079082738218
Quality: 0.4771569436268817
Quality: 0.4773118586234856
Quality: 0.4777075789771611
Got subclusters: Counter({0: 513, 1: 402, 2: 351, 3: 338, 4: 255, 5: 228, 6: 211, 7: 180, 8: 76, 9: 20})
On merging iteration 1
Numbers for each pattern pre-subsample: [513, 402, 351, 338, 255, 228, 211, 180, 76, 20]
Numbers after subsampling: [300, 300, 300, 300, 255, 228, 211, 180, 76, 20]
Computing sims for pattern 0
Computed sims for pattern 0 in 2.8828189373016357 s
Computing sims for pattern 1
Computed sims for pattern 1 in 2.9064223766326904 s
Computing sims for pattern 2
Computed sims for pattern 2 in 2.9030919075012207 s
Computing sims for pattern 3
Computed sims for pattern 3 in 2.939377784729004 s
Computing sims for pattern 4
Computed sims for pattern 4 in 2.2588493824005127 s
Computing sims for pattern 5
Computed sims for pattern 5 in 2.5782008171081543 s
Computing sims for pattern 6
Computed sims for pattern 6 in 2.354048728942871 s
Computing sims for pattern 7
Computed sims for pattern 7 in 1.9831981658935547 s
Computing sims for pattern 8
Computed sims for pattern 8 in 0.9368083477020264 s
Computing sims for pattern 9
Computed sims for pattern 9 in 0.3682742118835449 s
Cluster sizes
[513 402 351 338 255 228 211 180  76  20]
Cross-contamination matrix:
[[1.   0.74 0.6  0.5  0.73 0.4  0.54 0.64 0.28 0.09]
 [0.69 1.   0.74 0.55 0.74 0.38 0.66 0.43 0.23 0.06]
 [0.57 0.76 1.   0.56 0.68 0.49 0.66 0.44 0.21 0.08]
 [0.84 0.94 0.94 1.   0.87 0.71 0.87 0.71 0.45 0.3 ]
 [0.67 0.72 0.54 0.49 1.   0.42 0.68 0.41 0.19 0.14]
 [0.56 0.59 0.74 0.53 0.59 1.   0.53 0.76 0.38 0.18]
 [0.57 0.71 0.72 0.56 0.77 0.42 1.   0.44 0.26 0.1 ]
 [0.53 0.39 0.39 0.32 0.53 0.43 0.33 1.   0.11 0.09]
 [0.78 0.76 0.73 0.68 0.79 0.75 0.76 0.65 1.   0.95]
 [0.07 0.06 0.07 0.11 0.08 0.09 0.09 0.12 0.44 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.91 0.84 0.85 0.85 0.77 0.77 0.81 0.6  0.38]
 [0.91 1.   0.92 0.88 0.87 0.81 0.84 0.8  0.59 0.33]
 [0.84 0.92 1.   0.87 0.85 0.76 0.83 0.79 0.57 0.37]
 [0.85 0.88 0.87 1.   0.82 0.88 0.79 0.82 0.62 0.37]
 [0.85 0.87 0.85 0.82 1.   0.83 0.79 0.76 0.52 0.33]
 [0.77 0.81 0.76 0.88 0.83 1.   0.74 0.78 0.71 0.53]
 [0.77 0.84 0.83 0.79 0.79 0.74 1.   0.74 0.58 0.35]
 [0.81 0.8  0.79 0.82 0.76 0.78 0.74 1.   0.5  0.37]
 [0.6  0.59 0.57 0.62 0.52 0.71 0.58 0.5  1.   0.79]
 [0.38 0.33 0.37 0.37 0.33 0.53 0.35 0.37 0.79 1.  ]]
Collapsing 1 & 2 with crosscontam 0.738729289382716 and sim 0.9155672112147604
Collapsing 0 & 1 with crosscontam 0.6859719476543211 and sim 0.9085572328386808
Collapsing 1 & 3 with crosscontam 0.5460531614814816 and sim 0.8781850499609095
Collapsing 3 & 5 with crosscontam 0.530671808149696 and sim 0.8756606898841119
Collapsing 2 & 3 with crosscontam 0.5647566503703705 and sim 0.870537032838015
Collapsing 1 & 4 with crosscontam 0.7236962387015551 and sim 0.8667418329207537
Collapsing 2 & 4 with crosscontam 0.543757428239013 and sim 0.854545241146857
Trimming eliminated 0 seqlets out of 753
Trimming eliminated 0 seqlets out of 1266
Trimming eliminated 0 seqlets out of 1604
Trimming eliminated 0 seqlets out of 1832
Trimming eliminated 0 seqlets out of 2087
Unmerged patterns remapping: OrderedDict([(6, 1), (7, 2), (8, 3), (9, 4)])
Time spent on merging iteration: 18.255458116531372
On merging iteration 2
Numbers for each pattern pre-subsample: [2087, 211, 180, 76, 20]
Numbers after subsampling: [300, 211, 180, 76, 20]
Computing sims for pattern 0
Computed sims for pattern 0 in 1.204695463180542 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.3058490753173828 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.26366233825683594 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.11616396903991699 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.0507814884185791 s
Cluster sizes
[2087  211  180   76   20]
Cross-contamination matrix:
[[1.   0.96 0.85 0.45 0.3 ]
 [0.62 1.   0.44 0.26 0.1 ]
 [0.4  0.33 1.   0.11 0.09]
 [0.69 0.76 0.65 1.   0.95]
 [0.09 0.09 0.12 0.44 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.85 0.84 0.59 0.36]
 [0.85 1.   0.74 0.58 0.35]
 [0.84 0.74 1.   0.5  0.37]
 [0.59 0.58 0.5  1.   0.79]
 [0.36 0.35 0.37 0.79 1.  ]]
Collapsing 0 & 1 with crosscontam 0.6240588978848862 and sim 0.8540210910866404
Skipped 1 due to duplicates
Trimming eliminated 0 seqlets out of 2297
Unmerged patterns remapping: OrderedDict([(2, 1), (3, 2), (4, 3)])
Time spent on merging iteration: 2.9262495040893555
On merging iteration 3
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 2394 tasks      | elapsed:    0.4s
[Parallel(n_jobs=24)]: Done 2511 out of 2511 | elapsed:    0.5s finished
Numbers for each pattern pre-subsample: [2297, 180, 76, 20]
Numbers after subsampling: [300, 180, 76, 20]
Computing sims for pattern 0
Computed sims for pattern 0 in 0.8627192974090576 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.2517826557159424 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.11755132675170898 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.04973149299621582 s
Cluster sizes
[2297  180   76   20]
Cross-contamination matrix:
[[1.   0.79 0.43 0.27]
 [0.4  1.   0.11 0.09]
 [0.71 0.65 1.   0.95]
 [0.1  0.12 0.44 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.84 0.59 0.35]
 [0.84 1.   0.5  0.37]
 [0.59 0.5  1.   0.79]
 [0.35 0.37 0.79 1.  ]]
Inspecting pattern 2 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 2511
[t-SNE] Computed conditional probabilities for sample 2000 / 2511
[t-SNE] Computed conditional probabilities for sample 2511 / 2511
[t-SNE] Mean sigma: 0.306320
Beginning preprocessing + Leiden
2024-03-13 17:38:24.726119 MEMORY 15.515742208
Affmat transformed
2024-03-13 17:38:24.755942 MEMORY 15.515742208
sources, targets, weights extracted
2024-03-13 17:38:24.776988 MEMORY 15.515742208
About to launch parallel Leiden runs
2024-03-13 17:38:24.810719 MEMORY 15.515742208
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    9.5s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   28.9s finished
Parallel Leiden runs finished
2024-03-13 17:38:53.726651 MEMORY 15.515742208
Quality: 0.4970944819295271
Quality: 0.49761537183190246
Quality: 0.49824059033831236
Quality: 0.4995544850542221
Quality: 0.49981670552133856
Got subclusters: Counter({0: 439, 1: 406, 2: 392, 3: 386, 4: 326, 5: 276, 6: 263, 7: 23})
On merging iteration 1
Numbers for each pattern pre-subsample: [439, 406, 392, 386, 326, 276, 263, 23]
Numbers after subsampling: [300, 300, 300, 300, 300, 276, 263, 23]
Computing sims for pattern 0
Computed sims for pattern 0 in 2.5054991245269775 s
Computing sims for pattern 1
Computed sims for pattern 1 in 2.4638054370880127 s
Computing sims for pattern 2
Computed sims for pattern 2 in 2.402453899383545 s
Computing sims for pattern 3
Computed sims for pattern 3 in 2.4638073444366455 s
Computing sims for pattern 4
Computed sims for pattern 4 in 2.4176924228668213 s
Computing sims for pattern 5
Computed sims for pattern 5 in 2.1494624614715576 s
Computing sims for pattern 6
Computed sims for pattern 6 in 2.0328056812286377 s
Computing sims for pattern 7
Computed sims for pattern 7 in 0.34706568717956543 s
Cluster sizes
[439 406 392 386 326 276 263  23]
Cross-contamination matrix:
[[1.   0.52 0.74 0.35 0.56 0.51 0.53 0.74]
 [0.77 1.   0.68 0.61 0.68 0.64 0.68 0.91]
 [0.85 0.52 1.   0.69 0.68 0.59 0.7  0.76]
 [0.57 0.46 0.67 1.   0.53 0.66 0.42 0.75]
 [0.82 0.68 0.82 0.68 1.   0.82 0.65 0.44]
 [0.68 0.38 0.64 0.75 0.74 1.   0.7  0.68]
 [0.64 0.55 0.71 0.46 0.52 0.65 1.   0.71]
 [0.28 0.26 0.22 0.2  0.11 0.14 0.12 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.78 0.93 0.76 0.84 0.78 0.81 0.75]
 [0.78 1.   0.79 0.8  0.83 0.79 0.77 0.72]
 [0.93 0.79 1.   0.8  0.81 0.81 0.81 0.71]
 [0.76 0.8  0.8  1.   0.71 0.86 0.79 0.75]
 [0.84 0.83 0.81 0.71 1.   0.89 0.72 0.65]
 [0.78 0.79 0.81 0.86 0.89 1.   0.82 0.64]
 [0.81 0.77 0.81 0.79 0.72 0.82 1.   0.76]
 [0.75 0.72 0.71 0.75 0.65 0.64 0.76 1.  ]]
Collapsing 0 & 2 with crosscontam 0.7369953891358023 and sim 0.9310868728734625
Collapsing 4 & 5 with crosscontam 0.7369498095942577 and sim 0.8864732812804974
Collapsing 3 & 5 with crosscontam 0.6626638078368223 and sim 0.8617358715819139
Trimming eliminated 0 seqlets out of 831
Trimming eliminated 0 seqlets out of 602
Trimming eliminated 0 seqlets out of 988
Unmerged patterns remapping: OrderedDict([(1, 2), (6, 3), (7, 4)])
Time spent on merging iteration: 8.00466799736023
On merging iteration 2
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 1650 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 1839 out of 1839 | elapsed:    0.3s finished
Numbers for each pattern pre-subsample: [988, 831, 406, 263, 23]
Numbers after subsampling: [300, 300, 300, 263, 23]
Computing sims for pattern 0
Computed sims for pattern 0 in 1.326683521270752 s
Computing sims for pattern 1
Computed sims for pattern 1 in 1.2922229766845703 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.6992478370666504 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.6172375679016113 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.1385054588317871 s
Cluster sizes
[988 831 406 263  23]
Cross-contamination matrix:
[[1.   0.9  0.85 0.98 0.95]
 [0.54 1.   0.64 0.69 0.84]
 [0.57 0.75 1.   0.68 0.91]
 [0.57 0.67 0.55 1.   0.71]
 [0.1  0.26 0.26 0.12 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.82 0.77 0.84 0.63]
 [0.82 1.   0.81 0.84 0.74]
 [0.77 0.81 1.   0.77 0.72]
 [0.84 0.84 0.77 1.   0.76]
 [0.63 0.74 0.72 0.76 1.  ]]
Inspecting pattern 3 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 1839
[t-SNE] Computed conditional probabilities for sample 1839 / 1839
[t-SNE] Mean sigma: 0.294171
Beginning preprocessing + Leiden
2024-03-13 17:39:25.624401 MEMORY 15.515742208
Affmat transformed
2024-03-13 17:39:25.655057 MEMORY 15.515742208
sources, targets, weights extracted
2024-03-13 17:39:25.671889 MEMORY 15.515742208
About to launch parallel Leiden runs
2024-03-13 17:39:25.683250 MEMORY 15.51572992
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    7.0s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   21.6s finished
Parallel Leiden runs finished
2024-03-13 17:39:47.317248 MEMORY 15.51572992
Quality: 0.4449634837583015
Quality: 0.44828403913055953
Quality: 0.4492028077725613
Quality: 0.45015641801830175
Quality: 0.45023263342581216
Quality: 0.4508710708276096
Got subclusters: Counter({0: 400, 1: 312, 2: 277, 3: 262, 4: 237, 5: 182, 6: 91, 7: 78})
On merging iteration 1
Numbers for each pattern pre-subsample: [400, 312, 277, 262, 237, 182, 91, 78]
Numbers after subsampling: [300, 300, 277, 262, 237, 182, 91, 78]
Computing sims for pattern 0
Computed sims for pattern 0 in 2.2593493461608887 s
Computing sims for pattern 1
Computed sims for pattern 1 in 2.2024435997009277 s
Computing sims for pattern 2
Computed sims for pattern 2 in 1.9366230964660645 s
Computing sims for pattern 3
Computed sims for pattern 3 in 1.825049877166748 s
Computing sims for pattern 4
Computed sims for pattern 4 in 2.0339040756225586 s
Computing sims for pattern 5
Computed sims for pattern 5 in 1.4780328273773193 s
Computing sims for pattern 6
Computed sims for pattern 6 in 0.8257808685302734 s
Computing sims for pattern 7
Computed sims for pattern 7 in 0.7007269859313965 s
Cluster sizes
[400 312 277 262 237 182  91  78]
Cross-contamination matrix:
[[1.   0.63 0.53 0.52 0.28 0.68 0.57 0.55]
 [0.9  1.   0.69 0.55 0.49 0.81 0.7  0.62]
 [0.78 0.69 1.   0.74 0.49 0.89 0.85 0.73]
 [0.81 0.57 0.78 1.   0.47 0.92 0.81 0.75]
 [0.72 0.71 0.7  0.68 1.   0.95 0.83 0.74]
 [0.61 0.49 0.56 0.54 0.36 1.   0.62 0.6 ]
 [0.61 0.5  0.63 0.57 0.39 0.72 1.   0.6 ]
 [0.78 0.62 0.73 0.71 0.52 0.89 0.79 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.94 0.89 0.89 0.8  0.92 0.85 0.88]
 [0.94 1.   0.89 0.89 0.86 0.93 0.85 0.89]
 [0.89 0.89 1.   0.93 0.84 0.93 0.91 0.86]
 [0.89 0.89 0.93 1.   0.83 0.94 0.89 0.87]
 [0.8  0.86 0.84 0.83 1.   0.85 0.81 0.79]
 [0.92 0.93 0.93 0.94 0.85 1.   0.89 0.89]
 [0.85 0.85 0.91 0.89 0.81 0.89 1.   0.83]
 [0.88 0.89 0.86 0.87 0.79 0.89 0.83 1.  ]]
Collapsing 0 & 1 with crosscontam 0.6322402977777777 and sim 0.9367481747968514
Collapsing 3 & 5 with crosscontam 0.5379212939518374 and sim 0.935476237740084
Collapsing 2 & 3 with crosscontam 0.7430139459813954 and sim 0.9328387371836845
Collapsing 2 & 5 with crosscontam 0.564145836607655 and sim 0.9319225236309151
Collapsing 1 & 5 with crosscontam 0.4933126938271246 and sim 0.9309554562236386
Collapsing 0 & 5 with crosscontam 0.6080562769356392 and sim 0.9247182003102085
Collapsing 2 & 6 with crosscontam 0.6306609626357282 and sim 0.9086289771639642
Collapsing 0 & 3 with crosscontam 0.5190368114221091 and sim 0.894711588017327
Collapsing 1 & 3 with crosscontam 0.5486538009612665 and sim 0.8942099549598018
Collapsing 5 & 6 with crosscontam 0.6175951160949258 and sim 0.8925675620934393
Collapsing 0 & 2 with crosscontam 0.5256261473459021 and sim 0.8900806661970899
Collapsing 3 & 6 with crosscontam 0.5656267606690308 and sim 0.8889977171165506
Collapsing 1 & 7 with crosscontam 0.6173947358069647 and sim 0.888821846789718
Collapsing 1 & 2 with crosscontam 0.6885015982688945 and sim 0.8862883252039597
Collapsing 5 & 7 with crosscontam 0.5963337672672293 and sim 0.8860198748084489
Collapsing 0 & 7 with crosscontam 0.5474810883190881 and sim 0.8836999129700858
Collapsing 3 & 7 with crosscontam 0.7144606229817847 and sim 0.8741295637117015
Collapsing 2 & 7 with crosscontam 0.7276679360074998 and sim 0.8608077503719229
Trimming eliminated 0 seqlets out of 712
Trimming eliminated 0 seqlets out of 444
Trimming eliminated 0 seqlets out of 721
Trimming eliminated 0 seqlets out of 1433
Trimming eliminated 0 seqlets out of 1524
Trimming eliminated 0 seqlets out of 1602
Unmerged patterns remapping: OrderedDict([(4, 1)])
Time spent on merging iteration: 8.454005241394043
On merging iteration 2
Numbers for each pattern pre-subsample: [1602, 237]
Numbers after subsampling: [300, 237]
Computing sims for pattern 0
Computed sims for pattern 0 in 0.3371279239654541 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.31938695907592773 s
Cluster sizes
[1602  237]
Cross-contamination matrix:
[[1.   0.62]
 [0.77 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.87]
 [0.87 1.  ]]
Collapsing 0 & 1 with crosscontam 0.6166454446007188 and sim 0.8657089311619234
Trimming eliminated 0 seqlets out of 1839
Unmerged patterns remapping: OrderedDict()
Time spent on merging iteration: 2.812257766723633
On merging iteration 3
Numbers for each pattern pre-subsample: [1839]
Numbers after subsampling: [300]
Computing sims for pattern 0
Computed sims for pattern 0 in 6.198883056640625e-06 s
Cluster sizes
[1839]
Cross-contamination matrix:
[[1.]]
Pattern-to-pattern sim matrix:
[[1.]]
Merging on 13 clusters
2024-03-13 17:40:11.999428 MEMORY 15.51572992
On merging iteration 1
Numbers for each pattern pre-subsample: [2593, 579, 49, 2297, 180, 76, 20, 988, 831, 406, 263, 23, 1839]
Numbers after subsampling: [300, 300, 49, 300, 180, 76, 20, 300, 300, 300, 263, 23, 300]
Computing sims for pattern 0
Computed sims for pattern 0 in 3.6986422538757324 s
Computing sims for pattern 1
Computed sims for pattern 1 in 3.7548577785491943 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.7987198829650879 s
Computing sims for pattern 3
Computed sims for pattern 3 in 3.789311170578003 s
Computing sims for pattern 4
Computed sims for pattern 4 in 2.41835618019104 s
Computing sims for pattern 5
Computed sims for pattern 5 in 1.1668202877044678 s
Computing sims for pattern 6
Computed sims for pattern 6 in 0.44672560691833496 s
Computing sims for pattern 7
Computed sims for pattern 7 in 3.741262674331665 s
Computing sims for pattern 8
Computed sims for pattern 8 in 3.765441656112671 s
Computing sims for pattern 9
Computed sims for pattern 9 in 3.7454659938812256 s
Computing sims for pattern 10
Computed sims for pattern 10 in 3.066218137741089 s
Computing sims for pattern 11
Computed sims for pattern 11 in 0.4780161380767822 s
Computing sims for pattern 12
Computed sims for pattern 12 in 3.7300338745117188 s
Cluster sizes
[2593  579   49 2297  180   76   20  988  831  406  263   23 1839]
Cross-contamination matrix:
[[1.   0.81 0.86 0.38 0.69 0.19 0.1  0.29 0.3  0.35 0.38 0.36 0.73]
 [0.67 1.   0.56 0.18 0.31 0.11 0.08 0.13 0.16 0.16 0.2  0.22 0.28]
 [0.46 0.35 1.   0.11 0.3  0.11 0.09 0.12 0.09 0.08 0.1  0.18 0.29]
 [0.3  0.22 0.23 1.   0.79 0.43 0.27 0.58 0.81 0.79 0.93 0.89 0.28]
 [0.27 0.1  0.22 0.4  1.   0.11 0.09 0.31 0.34 0.39 0.37 0.24 0.33]
 [0.37 0.34 0.49 0.71 0.65 1.   0.95 0.57 0.62 0.66 0.69 0.79 0.35]
 [0.04 0.03 0.08 0.1  0.12 0.44 1.   0.12 0.09 0.08 0.09 0.19 0.04]
 [0.25 0.15 0.27 0.57 0.66 0.32 0.29 1.   0.9  0.85 0.98 0.95 0.49]
 [0.13 0.1  0.12 0.5  0.42 0.17 0.12 0.54 1.   0.64 0.69 0.84 0.19]
 [0.15 0.1  0.1  0.58 0.56 0.22 0.1  0.57 0.75 1.   0.68 0.91 0.32]
 [0.14 0.11 0.09 0.59 0.4  0.18 0.08 0.57 0.67 0.55 1.   0.71 0.05]
 [0.01 0.   0.01 0.1  0.03 0.03 0.03 0.1  0.26 0.26 0.12 1.   0.01]
 [0.53 0.26 0.45 0.22 0.59 0.1  0.09 0.37 0.3  0.39 0.15 0.23 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.81 0.83 0.45 0.65 0.35 0.26 0.35 0.33 0.4  0.44 0.32 0.72]
 [0.81 1.   0.68 0.32 0.45 0.29 0.24 0.27 0.29 0.34 0.33 0.28 0.45]
 [0.83 0.68 1.   0.36 0.56 0.43 0.33 0.36 0.3  0.33 0.36 0.33 0.69]
 [0.45 0.32 0.36 1.   0.84 0.59 0.35 0.64 0.76 0.78 0.9  0.72 0.37]
 [0.65 0.45 0.56 0.84 1.   0.5  0.37 0.59 0.62 0.75 0.75 0.59 0.72]
 [0.35 0.29 0.43 0.59 0.5  1.   0.79 0.46 0.45 0.45 0.56 0.53 0.32]
 [0.26 0.24 0.33 0.35 0.37 0.79 1.   0.38 0.34 0.41 0.39 0.46 0.28]
 [0.35 0.27 0.36 0.64 0.59 0.46 0.38 1.   0.82 0.77 0.84 0.63 0.54]
 [0.33 0.29 0.3  0.76 0.62 0.45 0.34 0.82 1.   0.81 0.84 0.74 0.44]
 [0.4  0.34 0.33 0.78 0.75 0.45 0.41 0.77 0.81 1.   0.77 0.72 0.59]
 [0.44 0.33 0.36 0.9  0.75 0.56 0.39 0.84 0.84 0.77 1.   0.76 0.31]
 [0.32 0.28 0.33 0.72 0.59 0.53 0.46 0.63 0.74 0.72 0.76 1.   0.28]
 [0.72 0.45 0.69 0.37 0.72 0.32 0.28 0.54 0.44 0.59 0.31 0.28 1.  ]]
Collapsing 3 & 10 with crosscontam 0.5920847036888635 and sim 0.9043400019759016
Trimming eliminated 0 seqlets out of 2560
Unmerged patterns remapping: OrderedDict([(0, 0), (1, 5), (2, 9), (4, 7), (5, 8), (6, 11), (7, 3), (8, 4), (9, 6), (11, 10), (12, 2)])
Time spent on merging iteration: 8.227020978927612
On merging iteration 2
Numbers for each pattern pre-subsample: [2593, 2560, 1839, 988, 831, 579, 406, 180, 76, 49, 23, 20]
Numbers after subsampling: [300, 300, 300, 300, 300, 300, 300, 180, 76, 49, 23, 20]
Computing sims for pattern 0
Computed sims for pattern 0 in 0.354325532913208 s
Computing sims for pattern 1
Computed sims for pattern 1 in 3.3592782020568848 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.3444235324859619 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.3427236080169678 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.34379124641418457 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.34386777877807617 s
Computing sims for pattern 6
Computed sims for pattern 6 in 0.3491404056549072 s
Computing sims for pattern 7
Computed sims for pattern 7 in 0.22204065322875977 s
Computing sims for pattern 8
Computed sims for pattern 8 in 0.10975289344787598 s
Computing sims for pattern 9
Computed sims for pattern 9 in 0.07745981216430664 s
Computing sims for pattern 10
Computed sims for pattern 10 in 0.04745602607727051 s
Computing sims for pattern 11
Computed sims for pattern 11 in 0.04453563690185547 s
Cluster sizes
[2593 2560 1839  988  831  579  406  180   76   49   23   20]
Cross-contamination matrix:
[[1.   0.37 0.73 0.29 0.3  0.81 0.35 0.69 0.19 0.86 0.36 0.1 ]
 [0.36 1.   0.36 0.66 0.9  0.29 0.88 0.85 0.49 0.3  0.97 0.34]
 [0.53 0.23 1.   0.37 0.3  0.26 0.39 0.59 0.1  0.45 0.23 0.09]
 [0.25 0.62 0.49 1.   0.9  0.15 0.85 0.66 0.32 0.27 0.95 0.29]
 [0.13 0.51 0.19 0.54 1.   0.1  0.64 0.42 0.17 0.12 0.84 0.12]
 [0.67 0.19 0.28 0.13 0.16 1.   0.16 0.31 0.11 0.56 0.22 0.08]
 [0.15 0.58 0.32 0.57 0.75 0.1  1.   0.56 0.22 0.1  0.91 0.1 ]
 [0.27 0.4  0.33 0.31 0.34 0.1  0.39 1.   0.11 0.22 0.24 0.09]
 [0.37 0.7  0.35 0.57 0.62 0.34 0.66 0.65 1.   0.49 0.79 0.95]
 [0.46 0.11 0.29 0.12 0.09 0.35 0.08 0.3  0.11 1.   0.18 0.09]
 [0.01 0.1  0.01 0.1  0.26 0.   0.26 0.03 0.03 0.01 1.   0.03]
 [0.04 0.1  0.04 0.12 0.09 0.03 0.08 0.12 0.44 0.08 0.19 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.45 0.72 0.35 0.33 0.81 0.4  0.65 0.35 0.83 0.32 0.26]
 [0.45 1.   0.36 0.66 0.78 0.32 0.79 0.84 0.6  0.36 0.72 0.36]
 [0.72 0.36 1.   0.54 0.44 0.45 0.59 0.72 0.32 0.69 0.28 0.28]
 [0.35 0.66 0.54 1.   0.82 0.27 0.77 0.59 0.46 0.36 0.63 0.38]
 [0.33 0.78 0.44 0.82 1.   0.29 0.81 0.62 0.45 0.3  0.74 0.34]
 [0.81 0.32 0.45 0.27 0.29 1.   0.34 0.45 0.29 0.68 0.28 0.24]
 [0.4  0.79 0.59 0.77 0.81 0.34 1.   0.75 0.45 0.33 0.72 0.41]
 [0.65 0.84 0.72 0.59 0.62 0.45 0.75 1.   0.5  0.56 0.59 0.37]
 [0.35 0.6  0.32 0.46 0.45 0.29 0.45 0.5  1.   0.43 0.53 0.79]
 [0.83 0.36 0.69 0.36 0.3  0.68 0.33 0.56 0.43 1.   0.33 0.33]
 [0.32 0.72 0.28 0.63 0.74 0.28 0.72 0.59 0.53 0.33 1.   0.46]
 [0.26 0.36 0.28 0.38 0.34 0.24 0.41 0.37 0.79 0.33 0.46 1.  ]]
Got 12 patterns after merging
2024-03-13 17:41:01.332543 MEMORY 15.515742208
Performing filtering
2024-03-13 17:41:01.332736 MEMORY 15.515742208
Got 10 patterns after filtering
2024-03-13 17:41:02.709217 MEMORY 15.515742208
Total time taken is 1354.81s
2024-03-13 17:41:02.709370 MEMORY 15.515742208
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 2208 tasks      | elapsed:    0.5s
[Parallel(n_jobs=24)]: Done 2593 out of 2593 | elapsed:    0.5s finished
/ru-auth/local/home/lzhao/anaconda3/envs/jupyter-ml-clone/lib/python3.9/site-packages/sklearn/manifold/_t_sne.py:691: FutureWarning: 'square_distances' has been introduced in 0.24 to help phase out legacy squaring behavior. The 'legacy' setting will be removed in 1.1 (renaming of 0.26), and the default setting will be changed to True. In 1.3, 'square_distances' will be removed altogether, and distances will be squared by default. Set 'square_distances'=True to silence this warning.
  warnings.warn(
/ru-auth/local/home/lzhao/anaconda3/envs/jupyter-ml-clone/lib/python3.9/site-packages/sklearn/neighbors/_base.py:175: EfficiencyWarning: Precomputed sparse input was not sorted by data.
  warnings.warn('Precomputed sparse input was not sorted by data.',
Applying subclustering to the final motifs
On pattern 0
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 2593 samples in 0.017s...
[t-SNE] Computed neighbors for 2593 samples in 0.002s...
[t-SNE] Computed conditional probabilities for sample 1000 / 2593
[t-SNE] Computed conditional probabilities for sample 2000 / 2593
[t-SNE] Computed conditional probabilities for sample 2593 / 2593
[t-SNE] Mean sigma: 0.308382
[t-SNE] Computed conditional probabilities in 0.174s
[t-SNE] Iteration 50: error = 73.8758469, gradient norm = 0.0235726 (50 iterations in 0.204s)
[t-SNE] Iteration 100: error = 73.8755722, gradient norm = 0.0222705 (50 iterations in 0.212s)
[t-SNE] Iteration 150: error = 73.8746185, gradient norm = 0.0194111 (50 iterations in 0.220s)
[t-SNE] Iteration 200: error = 73.8732147, gradient norm = 0.0137240 (50 iterations in 0.216s)
[t-SNE] Iteration 250: error = 73.8757706, gradient norm = 0.0233130 (50 iterations in 0.206s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 73.875771
[t-SNE] Iteration 300: error = 2.4269335, gradient norm = 0.0012778 (50 iterations in 0.185s)
[t-SNE] Iteration 350: error = 2.2995553, gradient norm = 0.0004313 (50 iterations in 0.170s)
[t-SNE] Iteration 400: error = 2.2446020, gradient norm = 0.0002565 (50 iterations in 0.175s)
[t-SNE] Iteration 450: error = 2.2182605, gradient norm = 0.0001392 (50 iterations in 0.171s)
[t-SNE] Iteration 500: error = 2.2029471, gradient norm = 0.0001180 (50 iterations in 0.174s)
[t-SNE] Iteration 550: error = 2.1942842, gradient norm = 0.0000849 (50 iterations in 0.171s)
[t-SNE] Iteration 600: error = 2.1883914, gradient norm = 0.0000829 (50 iterations in 0.173s)
[t-SNE] Iteration 650: error = 2.1851587, gradient norm = 0.0000591 (50 iterations in 0.173s)
[t-SNE] Iteration 700: error = 2.1825981, gradient norm = 0.0000524 (50 iterations in 0.172s)
[t-SNE] Iteration 750: error = 2.1804390, gradient norm = 0.0000553 (50 iterations in 0.175s)
[t-SNE] Iteration 800: error = 2.1789899, gradient norm = 0.0000441 (50 iterations in 0.173s)
[t-SNE] Iteration 850: error = 2.1776669, gradient norm = 0.0000423 (50 iterations in 0.172s)
[t-SNE] Iteration 900: error = 2.1764975, gradient norm = 0.0000449 (50 iterations in 0.174s)
[t-SNE] Iteration 950: error = 2.1754282, gradient norm = 0.0000374 (50 iterations in 0.176s)
[t-SNE] Iteration 1000: error = 2.1746662, gradient norm = 0.0000374 (50 iterations in 0.182s)
[t-SNE] KL divergence after 1000 iterations: 2.174666
[t-SNE] Computed conditional probabilities for sample 1000 / 2593
[t-SNE] Computed conditional probabilities for sample 2000 / 2593
[t-SNE] Computed conditional probabilities for sample 2593 / 2593
[t-SNE] Mean sigma: 0.308382
Beginning preprocessing + Leiden
2024-03-13 17:41:09.785522 MEMORY 15.515742208
Affmat transformed
2024-03-13 17:41:09.814483 MEMORY 15.515742208
sources, targets, weights extracted
2024-03-13 17:41:09.833674 MEMORY 15.515742208
About to launch parallel Leiden runs
2024-03-13 17:41:09.847270 MEMORY 15.515742208
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    9.0s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   28.3s finished
Parallel Leiden runs finished
2024-03-13 17:41:38.140421 MEMORY 15.515742208
Quality: 0.508132077696418
Quality: 0.5088623251670621
Quality: 0.5092829334954692
Quality: 0.5094116713883303
Quality: 0.5094402695490242
Quality: 0.5097894845531011
Quality: 0.5097953477350263
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 2208 tasks      | elapsed:    0.5s
[Parallel(n_jobs=24)]: Done 2560 out of 2560 | elapsed:    0.5s finished
Got subclusters: Counter({0: 485, 1: 420, 2: 414, 3: 362, 4: 291, 5: 284, 6: 220, 7: 117})
On pattern 1
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 2560 samples in 0.016s...
[t-SNE] Computed neighbors for 2560 samples in 0.002s...
[t-SNE] Computed conditional probabilities for sample 1000 / 2560
[t-SNE] Computed conditional probabilities for sample 2000 / 2560
[t-SNE] Computed conditional probabilities for sample 2560 / 2560
[t-SNE] Mean sigma: 0.308607
[t-SNE] Computed conditional probabilities in 0.172s
[t-SNE] Iteration 50: error = 73.7155914, gradient norm = 0.0301292 (50 iterations in 0.219s)
[t-SNE] Iteration 100: error = 73.7115555, gradient norm = 0.0185139 (50 iterations in 0.214s)
[t-SNE] Iteration 150: error = 73.7105637, gradient norm = 0.0145365 (50 iterations in 0.227s)
[t-SNE] Iteration 200: error = 73.7100906, gradient norm = 0.0120332 (50 iterations in 0.202s)
[t-SNE] Iteration 250: error = 73.7135544, gradient norm = 0.0244061 (50 iterations in 0.203s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 73.713554
[t-SNE] Iteration 300: error = 2.5608995, gradient norm = 0.0013569 (50 iterations in 0.176s)
[t-SNE] Iteration 350: error = 2.4281030, gradient norm = 0.0005982 (50 iterations in 0.170s)
[t-SNE] Iteration 400: error = 2.3697515, gradient norm = 0.0002543 (50 iterations in 0.170s)
[t-SNE] Iteration 450: error = 2.3393652, gradient norm = 0.0002304 (50 iterations in 0.167s)
[t-SNE] Iteration 500: error = 2.3237844, gradient norm = 0.0001283 (50 iterations in 0.167s)
[t-SNE] Iteration 550: error = 2.3137231, gradient norm = 0.0001018 (50 iterations in 0.168s)
[t-SNE] Iteration 600: error = 2.3071532, gradient norm = 0.0000873 (50 iterations in 0.167s)
[t-SNE] Iteration 650: error = 2.3031516, gradient norm = 0.0000757 (50 iterations in 0.168s)
[t-SNE] Iteration 700: error = 2.3008082, gradient norm = 0.0000799 (50 iterations in 0.171s)
[t-SNE] Iteration 750: error = 2.2992465, gradient norm = 0.0000597 (50 iterations in 0.170s)
[t-SNE] Iteration 800: error = 2.2974572, gradient norm = 0.0000513 (50 iterations in 0.168s)
[t-SNE] Iteration 850: error = 2.2955167, gradient norm = 0.0000539 (50 iterations in 0.167s)
[t-SNE] Iteration 900: error = 2.2940686, gradient norm = 0.0000405 (50 iterations in 0.169s)
[t-SNE] Iteration 950: error = 2.2926164, gradient norm = 0.0000437 (50 iterations in 0.168s)
[t-SNE] Iteration 1000: error = 2.2915552, gradient norm = 0.0000510 (50 iterations in 0.169s)
[t-SNE] KL divergence after 1000 iterations: 2.291555
[t-SNE] Computed conditional probabilities for sample 1000 / 2560
[t-SNE] Computed conditional probabilities for sample 2000 / 2560
[t-SNE] Computed conditional probabilities for sample 2560 / 2560
[t-SNE] Mean sigma: 0.308607
Beginning preprocessing + Leiden
2024-03-13 17:41:45.382260 MEMORY 15.515742208
Affmat transformed
2024-03-13 17:41:45.410471 MEMORY 15.515742208
sources, targets, weights extracted
2024-03-13 17:41:45.429730 MEMORY 15.515742208
About to launch parallel Leiden runs
2024-03-13 17:41:45.441022 MEMORY 15.515742208
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    8.1s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   31.2s finished
Parallel Leiden runs finished
2024-03-13 17:42:16.606793 MEMORY 15.515742208
Quality: 0.4771814638958999
Quality: 0.48094375105188514
Quality: 0.4826045380819004
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 1650 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 1839 out of 1839 | elapsed:    0.3s finished
Got subclusters: Counter({0: 437, 1: 420, 2: 380, 3: 376, 4: 355, 5: 218, 6: 189, 7: 185})
On pattern 2
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 1839 samples in 0.011s...
[t-SNE] Computed neighbors for 1839 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 1000 / 1839
[t-SNE] Computed conditional probabilities for sample 1839 / 1839
[t-SNE] Mean sigma: 0.295220
[t-SNE] Computed conditional probabilities in 0.123s
[t-SNE] Iteration 50: error = 69.7420120, gradient norm = 0.0668877 (50 iterations in 0.193s)
[t-SNE] Iteration 100: error = 69.7793579, gradient norm = 0.0579570 (50 iterations in 0.198s)
[t-SNE] Iteration 150: error = 69.5905151, gradient norm = 0.0657776 (50 iterations in 0.164s)
[t-SNE] Iteration 200: error = 69.5928955, gradient norm = 0.0703470 (50 iterations in 0.152s)
[t-SNE] Iteration 250: error = 69.5927505, gradient norm = 0.0684945 (50 iterations in 0.146s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 69.592751
[t-SNE] Iteration 300: error = 2.3021879, gradient norm = 0.0012579 (50 iterations in 0.135s)
[t-SNE] Iteration 350: error = 2.2065940, gradient norm = 0.0004651 (50 iterations in 0.130s)
[t-SNE] Iteration 400: error = 2.1625447, gradient norm = 0.0003171 (50 iterations in 0.131s)
[t-SNE] Iteration 450: error = 2.1381660, gradient norm = 0.0002318 (50 iterations in 0.131s)
[t-SNE] Iteration 500: error = 2.1270061, gradient norm = 0.0001587 (50 iterations in 0.131s)
[t-SNE] Iteration 550: error = 2.1198187, gradient norm = 0.0001106 (50 iterations in 0.130s)
[t-SNE] Iteration 600: error = 2.1151252, gradient norm = 0.0000996 (50 iterations in 0.133s)
[t-SNE] Iteration 650: error = 2.1118450, gradient norm = 0.0000710 (50 iterations in 0.129s)
[t-SNE] Iteration 700: error = 2.1091523, gradient norm = 0.0001088 (50 iterations in 0.132s)
[t-SNE] Iteration 750: error = 2.1074488, gradient norm = 0.0000650 (50 iterations in 0.132s)
[t-SNE] Iteration 800: error = 2.1064575, gradient norm = 0.0000641 (50 iterations in 0.131s)
[t-SNE] Iteration 850: error = 2.1056776, gradient norm = 0.0000607 (50 iterations in 0.138s)
[t-SNE] Iteration 900: error = 2.1049163, gradient norm = 0.0000447 (50 iterations in 0.134s)
[t-SNE] Iteration 950: error = 2.1042929, gradient norm = 0.0000554 (50 iterations in 0.141s)
[t-SNE] Iteration 1000: error = 2.1035681, gradient norm = 0.0000691 (50 iterations in 0.133s)
[t-SNE] KL divergence after 1000 iterations: 2.103568
[t-SNE] Computed conditional probabilities for sample 1000 / 1839
[t-SNE] Computed conditional probabilities for sample 1839 / 1839
[t-SNE] Mean sigma: 0.295219
Beginning preprocessing + Leiden
2024-03-13 17:42:22.128637 MEMORY 15.515742208
Affmat transformed
2024-03-13 17:42:22.151207 MEMORY 15.515742208
sources, targets, weights extracted
2024-03-13 17:42:22.167176 MEMORY 15.515742208
About to launch parallel Leiden runs
2024-03-13 17:42:22.190878 MEMORY 15.515742208
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    6.1s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   21.1s finished
Parallel Leiden runs finished
2024-03-13 17:42:43.261045 MEMORY 15.515742208
Quality: 0.4459700669724193
Quality: 0.4516736569530986
Quality: 0.452684109752389
Quality: 0.45276546432686265
Quality: 0.4528015215322046
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 930 tasks      | elapsed:    0.4s
[Parallel(n_jobs=24)]: Done 988 out of 988 | elapsed:    0.5s finished
Got subclusters: Counter({0: 339, 1: 319, 2: 293, 3: 281, 4: 264, 5: 116, 6: 114, 7: 113})
On pattern 3
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 988 samples in 0.008s...
[t-SNE] Computed neighbors for 988 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 988 / 988
[t-SNE] Mean sigma: 0.337632
[t-SNE] Computed conditional probabilities in 0.068s
[t-SNE] Iteration 50: error = 66.9558868, gradient norm = 0.3079163 (50 iterations in 0.084s)
[t-SNE] Iteration 100: error = 68.3950500, gradient norm = 0.2780545 (50 iterations in 0.083s)
[t-SNE] Iteration 150: error = 67.7045135, gradient norm = 0.2957950 (50 iterations in 0.085s)
[t-SNE] Iteration 200: error = 68.3229218, gradient norm = 0.2806051 (50 iterations in 0.091s)
[t-SNE] Iteration 250: error = 68.4501953, gradient norm = 0.2710249 (50 iterations in 0.084s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 68.450195
[t-SNE] Iteration 300: error = 1.6340168, gradient norm = 0.0019465 (50 iterations in 0.084s)
[t-SNE] Iteration 350: error = 1.5641192, gradient norm = 0.0005360 (50 iterations in 0.078s)
[t-SNE] Iteration 400: error = 1.5328456, gradient norm = 0.0003378 (50 iterations in 0.075s)
[t-SNE] Iteration 450: error = 1.5169933, gradient norm = 0.0003844 (50 iterations in 0.075s)
[t-SNE] Iteration 500: error = 1.5074464, gradient norm = 0.0003240 (50 iterations in 0.076s)
[t-SNE] Iteration 550: error = 1.5005070, gradient norm = 0.0002893 (50 iterations in 0.075s)
[t-SNE] Iteration 600: error = 1.4973161, gradient norm = 0.0001904 (50 iterations in 0.075s)
[t-SNE] Iteration 650: error = 1.4963021, gradient norm = 0.0000955 (50 iterations in 0.077s)
[t-SNE] Iteration 700: error = 1.4958804, gradient norm = 0.0000734 (50 iterations in 0.075s)
[t-SNE] Iteration 750: error = 1.4953226, gradient norm = 0.0000699 (50 iterations in 0.075s)
[t-SNE] Iteration 800: error = 1.4949965, gradient norm = 0.0001130 (50 iterations in 0.076s)
[t-SNE] Iteration 850: error = 1.4924278, gradient norm = 0.0002095 (50 iterations in 0.076s)
[t-SNE] Iteration 900: error = 1.4904064, gradient norm = 0.0001115 (50 iterations in 0.075s)
[t-SNE] Iteration 950: error = 1.4890975, gradient norm = 0.0001277 (50 iterations in 0.078s)
[t-SNE] Iteration 1000: error = 1.4861988, gradient norm = 0.0001143 (50 iterations in 0.075s)
[t-SNE] KL divergence after 1000 iterations: 1.486199
[t-SNE] Computed conditional probabilities for sample 988 / 988
[t-SNE] Mean sigma: 0.337632
Beginning preprocessing + Leiden
2024-03-13 17:42:46.587816 MEMORY 15.515742208
Affmat transformed
2024-03-13 17:42:46.600636 MEMORY 15.515742208
sources, targets, weights extracted
2024-03-13 17:42:46.608517 MEMORY 15.515742208
About to launch parallel Leiden runs
2024-03-13 17:42:46.618443 MEMORY 15.515742208
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    2.3s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    8.1s finished
Parallel Leiden runs finished
2024-03-13 17:42:54.721489 MEMORY 15.515742208
Quality: 0.4927544904788151
Quality: 0.49319791712519656
Quality: 0.4933224492426114
Quality: 0.493324789933192
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 831 out of 831 | elapsed:    0.3s finished
Got subclusters: Counter({0: 215, 1: 205, 2: 161, 3: 156, 4: 111, 5: 81, 6: 59})
On pattern 4
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 831 samples in 0.006s...
[t-SNE] Computed neighbors for 831 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 831 / 831
[t-SNE] Mean sigma: 0.311283
[t-SNE] Computed conditional probabilities in 0.058s
[t-SNE] Iteration 50: error = 67.6478119, gradient norm = 0.3590798 (50 iterations in 0.073s)
[t-SNE] Iteration 100: error = 69.4973984, gradient norm = 0.3500948 (50 iterations in 0.075s)
[t-SNE] Iteration 150: error = 70.0684128, gradient norm = 0.3178896 (50 iterations in 0.075s)
[t-SNE] Iteration 200: error = 69.4217911, gradient norm = 0.3574179 (50 iterations in 0.072s)
[t-SNE] Iteration 250: error = 71.1293106, gradient norm = 0.3247884 (50 iterations in 0.072s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 71.129311
[t-SNE] Iteration 300: error = 1.6437188, gradient norm = 0.0031552 (50 iterations in 0.068s)
[t-SNE] Iteration 350: error = 1.5758440, gradient norm = 0.0007362 (50 iterations in 0.066s)
[t-SNE] Iteration 400: error = 1.5568141, gradient norm = 0.0004492 (50 iterations in 0.068s)
[t-SNE] Iteration 450: error = 1.5457574, gradient norm = 0.0003790 (50 iterations in 0.066s)
[t-SNE] Iteration 500: error = 1.5391742, gradient norm = 0.0003359 (50 iterations in 0.066s)
[t-SNE] Iteration 550: error = 1.5349619, gradient norm = 0.0001393 (50 iterations in 0.066s)
[t-SNE] Iteration 600: error = 1.5328970, gradient norm = 0.0001643 (50 iterations in 0.066s)
[t-SNE] Iteration 650: error = 1.5317436, gradient norm = 0.0000923 (50 iterations in 0.066s)
[t-SNE] Iteration 700: error = 1.5307735, gradient norm = 0.0000768 (50 iterations in 0.066s)
[t-SNE] Iteration 750: error = 1.5305754, gradient norm = 0.0000598 (50 iterations in 0.066s)
[t-SNE] Iteration 800: error = 1.5301766, gradient norm = 0.0000694 (50 iterations in 0.066s)
[t-SNE] Iteration 850: error = 1.5301957, gradient norm = 0.0000425 (50 iterations in 0.067s)
[t-SNE] Iteration 900: error = 1.5300916, gradient norm = 0.0000408 (50 iterations in 0.066s)
[t-SNE] Iteration 950: error = 1.5299966, gradient norm = 0.0000612 (50 iterations in 0.066s)
[t-SNE] Iteration 1000: error = 1.5299512, gradient norm = 0.0000447 (50 iterations in 0.066s)
[t-SNE] KL divergence after 1000 iterations: 1.529951
[t-SNE] Computed conditional probabilities for sample 831 / 831
[t-SNE] Mean sigma: 0.311283
Beginning preprocessing + Leiden
2024-03-13 17:42:57.357099 MEMORY 15.515766784
Affmat transformed
2024-03-13 17:42:57.367917 MEMORY 15.515766784
sources, targets, weights extracted
2024-03-13 17:42:57.375128 MEMORY 15.515766784
About to launch parallel Leiden runs
2024-03-13 17:42:57.382168 MEMORY 15.515766784
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    2.1s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    7.3s finished
Parallel Leiden runs finished
2024-03-13 17:43:04.713404 MEMORY 15.515766784
Quality: 0.4058491049239041
Quality: 0.40610779063471997
Quality: 0.40775936910967464
Quality: 0.4079149156292894
Quality: 0.40830432130871763
Quality: 0.4083268421688458
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 579 out of 579 | elapsed:    0.2s finished
Got subclusters: Counter({0: 221, 1: 165, 2: 139, 3: 133, 4: 71, 5: 54, 6: 48})
On pattern 5
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 579 samples in 0.005s...
[t-SNE] Computed neighbors for 579 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 579 / 579
[t-SNE] Mean sigma: 0.346345
[t-SNE] Computed conditional probabilities in 0.039s
[t-SNE] Iteration 50: error = 67.5749207, gradient norm = 0.4384965 (50 iterations in 0.055s)
[t-SNE] Iteration 100: error = 70.2608566, gradient norm = 0.4162701 (50 iterations in 0.055s)
[t-SNE] Iteration 150: error = 70.7725143, gradient norm = 0.4124509 (50 iterations in 0.056s)
[t-SNE] Iteration 200: error = 69.6183167, gradient norm = 0.4240475 (50 iterations in 0.056s)
[t-SNE] Iteration 250: error = 68.5370255, gradient norm = 0.4317590 (50 iterations in 0.056s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 68.537025
[t-SNE] Iteration 300: error = 1.5042499, gradient norm = 0.0024640 (50 iterations in 0.055s)
[t-SNE] Iteration 350: error = 1.4265275, gradient norm = 0.0010706 (50 iterations in 0.057s)
[t-SNE] Iteration 400: error = 1.4029291, gradient norm = 0.0008790 (50 iterations in 0.053s)
[t-SNE] Iteration 450: error = 1.3854662, gradient norm = 0.0004317 (50 iterations in 0.053s)
[t-SNE] Iteration 500: error = 1.3745720, gradient norm = 0.0006962 (50 iterations in 0.053s)
[t-SNE] Iteration 550: error = 1.3684055, gradient norm = 0.0003015 (50 iterations in 0.055s)
[t-SNE] Iteration 600: error = 1.3655095, gradient norm = 0.0002398 (50 iterations in 0.053s)
[t-SNE] Iteration 650: error = 1.3630829, gradient norm = 0.0001227 (50 iterations in 0.053s)
[t-SNE] Iteration 700: error = 1.3625951, gradient norm = 0.0001976 (50 iterations in 0.056s)
[t-SNE] Iteration 750: error = 1.3621427, gradient norm = 0.0000668 (50 iterations in 0.053s)
[t-SNE] Iteration 800: error = 1.3620013, gradient norm = 0.0000637 (50 iterations in 0.053s)
[t-SNE] Iteration 850: error = 1.3619287, gradient norm = 0.0000570 (50 iterations in 0.053s)
[t-SNE] Iteration 900: error = 1.3618654, gradient norm = 0.0000519 (50 iterations in 0.055s)
[t-SNE] Iteration 950: error = 1.3617233, gradient norm = 0.0000387 (50 iterations in 0.053s)
[t-SNE] Iteration 1000: error = 1.3617398, gradient norm = 0.0000410 (50 iterations in 0.053s)
[t-SNE] KL divergence after 1000 iterations: 1.361740
[t-SNE] Computed conditional probabilities for sample 579 / 579
[t-SNE] Mean sigma: 0.346345
Beginning preprocessing + Leiden
2024-03-13 17:43:06.688066 MEMORY 15.515807744
Affmat transformed
2024-03-13 17:43:06.695835 MEMORY 15.515807744
sources, targets, weights extracted
2024-03-13 17:43:06.700526 MEMORY 15.515807744
About to launch parallel Leiden runs
2024-03-13 17:43:06.706153 MEMORY 15.515807744
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.5s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    4.9s finished
Parallel Leiden runs finished
2024-03-13 17:43:11.568425 MEMORY 15.515807744
Quality: 0.40926464346956265
Quality: 0.4120355565240415
Quality: 0.41246351692045674
Quality: 0.41272225695838605
Quality: 0.413023821827823
Quality: 0.414162705391934
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 344 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 406 out of 406 | elapsed:    0.1s finished
Got subclusters: Counter({0: 115, 1: 92, 2: 86, 3: 84, 4: 77, 5: 76, 6: 47, 7: 2})
On pattern 6
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 406 samples in 0.003s...
[t-SNE] Computed neighbors for 406 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 406 / 406
[t-SNE] Mean sigma: 0.347408
[t-SNE] Computed conditional probabilities in 0.028s
[t-SNE] Iteration 50: error = 65.7064896, gradient norm = 0.4947014 (50 iterations in 0.044s)
[t-SNE] Iteration 100: error = 68.2596054, gradient norm = 0.4644107 (50 iterations in 0.044s)
[t-SNE] Iteration 150: error = 70.0953751, gradient norm = 0.4656790 (50 iterations in 0.044s)
[t-SNE] Iteration 200: error = 71.7414780, gradient norm = 0.4451306 (50 iterations in 0.044s)
[t-SNE] Iteration 250: error = 69.9824753, gradient norm = 0.4563792 (50 iterations in 0.050s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 69.982475
[t-SNE] Iteration 300: error = 1.4807947, gradient norm = 0.0044719 (50 iterations in 0.043s)
[t-SNE] Iteration 350: error = 1.3913709, gradient norm = 0.0026379 (50 iterations in 0.043s)
[t-SNE] Iteration 400: error = 1.3544024, gradient norm = 0.0015096 (50 iterations in 0.043s)
[t-SNE] Iteration 450: error = 1.3329377, gradient norm = 0.0012636 (50 iterations in 0.043s)
[t-SNE] Iteration 500: error = 1.2825156, gradient norm = 0.0009035 (50 iterations in 0.043s)
[t-SNE] Iteration 550: error = 1.2728668, gradient norm = 0.0004951 (50 iterations in 0.043s)
[t-SNE] Iteration 600: error = 1.2678341, gradient norm = 0.0014263 (50 iterations in 0.042s)
[t-SNE] Iteration 650: error = 1.2658609, gradient norm = 0.0001498 (50 iterations in 0.043s)
[t-SNE] Iteration 700: error = 1.2656813, gradient norm = 0.0000599 (50 iterations in 0.043s)
[t-SNE] Iteration 750: error = 1.2657696, gradient norm = 0.0000750 (50 iterations in 0.042s)
[t-SNE] Iteration 800: error = 1.2656976, gradient norm = 0.0000702 (50 iterations in 0.042s)
[t-SNE] Iteration 850: error = 1.2656205, gradient norm = 0.0000756 (50 iterations in 0.042s)
[t-SNE] Iteration 900: error = 1.2655627, gradient norm = 0.0000284 (50 iterations in 0.042s)
[t-SNE] Iteration 950: error = 1.2654485, gradient norm = 0.0000428 (50 iterations in 0.042s)
[t-SNE] Iteration 1000: error = 1.2654629, gradient norm = 0.0000583 (50 iterations in 0.042s)
[t-SNE] KL divergence after 1000 iterations: 1.265463
[t-SNE] Computed conditional probabilities for sample 406 / 406
[t-SNE] Mean sigma: 0.347408
Beginning preprocessing + Leiden
2024-03-13 17:43:13.052807 MEMORY 15.515807744
Affmat transformed
2024-03-13 17:43:13.058053 MEMORY 15.515807744
sources, targets, weights extracted
2024-03-13 17:43:13.060943 MEMORY 15.515807744
About to launch parallel Leiden runs
2024-03-13 17:43:13.066774 MEMORY 15.515807744
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.1s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    3.5s finished
Parallel Leiden runs finished
2024-03-13 17:43:16.590054 MEMORY 15.515807744
Quality: 0.3729074672130189
Quality: 0.3729181146050366
Quality: 0.37293846017967547
Quality: 0.373054837915033
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 180 out of 180 | elapsed:    0.1s finished
Got subclusters: Counter({0: 92, 1: 82, 2: 66, 4: 50, 3: 50, 5: 47, 6: 19})
On pattern 7
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 180 samples in 0.002s...
[t-SNE] Computed neighbors for 180 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 180 / 180
[t-SNE] Mean sigma: 0.382354
[t-SNE] Computed conditional probabilities in 0.012s
[t-SNE] Iteration 50: error = 59.1029968, gradient norm = 0.4917731 (50 iterations in 0.029s)
[t-SNE] Iteration 100: error = 62.3108253, gradient norm = 0.4844429 (50 iterations in 0.026s)
[t-SNE] Iteration 150: error = 56.7923050, gradient norm = 0.5482752 (50 iterations in 0.026s)
[t-SNE] Iteration 200: error = 59.6225090, gradient norm = 0.5155041 (50 iterations in 0.026s)
[t-SNE] Iteration 250: error = 58.8247299, gradient norm = 0.4964139 (50 iterations in 0.025s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 58.824730
[t-SNE] Iteration 300: error = 0.8903147, gradient norm = 0.0069610 (50 iterations in 0.031s)
[t-SNE] Iteration 350: error = 0.7760987, gradient norm = 0.0029349 (50 iterations in 0.029s)
[t-SNE] Iteration 400: error = 0.7138960, gradient norm = 0.0066951 (50 iterations in 0.029s)
[t-SNE] Iteration 450: error = 0.6936713, gradient norm = 0.0004027 (50 iterations in 0.029s)
[t-SNE] Iteration 500: error = 0.6935915, gradient norm = 0.0001842 (50 iterations in 0.031s)
[t-SNE] Iteration 550: error = 0.6934002, gradient norm = 0.0007394 (50 iterations in 0.029s)
[t-SNE] Iteration 600: error = 0.6933932, gradient norm = 0.0001678 (50 iterations in 0.028s)
[t-SNE] Iteration 650: error = 0.6934688, gradient norm = 0.0002590 (50 iterations in 0.031s)
[t-SNE] Iteration 700: error = 0.6935887, gradient norm = 0.0002043 (50 iterations in 0.028s)
[t-SNE] Iteration 750: error = 0.6936169, gradient norm = 0.0001585 (50 iterations in 0.029s)
[t-SNE] Iteration 800: error = 0.6936537, gradient norm = 0.0001448 (50 iterations in 0.032s)
[t-SNE] Iteration 850: error = 0.6936495, gradient norm = 0.0001987 (50 iterations in 0.029s)
[t-SNE] Iteration 900: error = 0.6936610, gradient norm = 0.0001512 (50 iterations in 0.029s)
[t-SNE] Iteration 950: error = 0.6937070, gradient norm = 0.0001025 (50 iterations in 0.028s)
[t-SNE] Iteration 950: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 950 iterations: 0.693707
[t-SNE] Computed conditional probabilities for sample 180 / 180
[t-SNE] Mean sigma: 0.382354
Beginning preprocessing + Leiden
2024-03-13 17:43:17.433765 MEMORY 15.515807744
Affmat transformed
2024-03-13 17:43:17.436292 MEMORY 15.515807744
sources, targets, weights extracted
2024-03-13 17:43:17.437355 MEMORY 15.515807744
About to launch parallel Leiden runs
2024-03-13 17:43:17.441998 MEMORY 15.515807744
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.8s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.2s finished
Parallel Leiden runs finished
2024-03-13 17:43:19.601840 MEMORY 15.515807744
Quality: 0.3009858337914436
Quality: 0.30332837037549676
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  76 out of  76 | elapsed:    0.0s finished
Got subclusters: Counter({0: 43, 1: 35, 2: 31, 3: 28, 4: 24, 5: 19})
On pattern 8
[t-SNE] Computing 75 nearest neighbors...
[t-SNE] Indexed 76 samples in 0.001s...
[t-SNE] Computed neighbors for 76 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 76 / 76
[t-SNE] Mean sigma: 0.790770
[t-SNE] Computed conditional probabilities in 0.003s
[t-SNE] Iteration 50: error = 47.8676147, gradient norm = 0.5515448 (50 iterations in 0.014s)
[t-SNE] Iteration 100: error = 47.0189209, gradient norm = 0.5434943 (50 iterations in 0.014s)
[t-SNE] Iteration 150: error = 45.8080750, gradient norm = 0.5000992 (50 iterations in 0.014s)
[t-SNE] Iteration 200: error = 45.7981033, gradient norm = 0.6569819 (50 iterations in 0.014s)
[t-SNE] Iteration 250: error = 50.0400887, gradient norm = 0.4997057 (50 iterations in 0.014s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 50.040089
[t-SNE] Iteration 300: error = 0.7015042, gradient norm = 0.0049529 (50 iterations in 0.015s)
[t-SNE] Iteration 350: error = 0.5222373, gradient norm = 0.0015793 (50 iterations in 0.014s)
[t-SNE] Iteration 400: error = 0.4725034, gradient norm = 0.0013368 (50 iterations in 0.014s)
[t-SNE] Iteration 450: error = 0.4499328, gradient norm = 0.0022033 (50 iterations in 0.014s)
[t-SNE] Iteration 500: error = 0.5798044, gradient norm = 0.0025562 (50 iterations in 0.015s)
[t-SNE] Iteration 550: error = 0.4967309, gradient norm = 0.0008501 (50 iterations in 0.014s)
[t-SNE] Iteration 600: error = 0.4825737, gradient norm = 0.0107117 (50 iterations in 0.014s)
[t-SNE] Iteration 650: error = 0.6779178, gradient norm = 0.0011544 (50 iterations in 0.014s)
[t-SNE] Iteration 700: error = 0.5493662, gradient norm = 0.0005266 (50 iterations in 0.014s)
[t-SNE] Iteration 750: error = 0.4966164, gradient norm = 0.0003651 (50 iterations in 0.014s)
[t-SNE] Iteration 800: error = 0.4487680, gradient norm = 0.0002729 (50 iterations in 0.016s)
[t-SNE] Iteration 850: error = 0.4434995, gradient norm = 0.0001247 (50 iterations in 0.014s)
[t-SNE] Iteration 900: error = 0.4401695, gradient norm = 0.0000986 (50 iterations in 0.014s)
[t-SNE] Iteration 950: error = 0.4335463, gradient norm = 0.0003282 (50 iterations in 0.014s)
[t-SNE] Iteration 1000: error = 0.4242864, gradient norm = 0.0001532 (50 iterations in 0.014s)
[t-SNE] KL divergence after 1000 iterations: 0.424286
[t-SNE] Computed conditional probabilities for sample 76 / 76
[t-SNE] Mean sigma: 0.790770
Beginning preprocessing + Leiden
2024-03-13 17:43:19.981750 MEMORY 15.515807744
Affmat transformed
2024-03-13 17:43:19.982780 MEMORY 15.515807744
sources, targets, weights extracted
2024-03-13 17:43:19.983205 MEMORY 15.515807744
About to launch parallel Leiden runs
2024-03-13 17:43:19.988375 MEMORY 15.515807744
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.6s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.7s finished
Parallel Leiden runs finished
2024-03-13 17:43:21.732178 MEMORY 15.515807744
Quality: 0.243684068208265
Quality: 0.24395611183971216
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  49 out of  49 | elapsed:    0.0s finished
Got subclusters: Counter({0: 47, 1: 23, 2: 6})
On pattern 9
[t-SNE] Computing 48 nearest neighbors...
[t-SNE] Indexed 49 samples in 0.000s...
[t-SNE] Computed neighbors for 49 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 49 / 49
[t-SNE] Mean sigma: 10.630570
[t-SNE] Computed conditional probabilities in 0.001s
[t-SNE] Iteration 50: error = 42.8315544, gradient norm = 0.5376643 (50 iterations in 0.011s)
[t-SNE] Iteration 100: error = 43.5387497, gradient norm = 0.5841828 (50 iterations in 0.011s)
[t-SNE] Iteration 150: error = 43.9048958, gradient norm = 0.4936933 (50 iterations in 0.011s)
[t-SNE] Iteration 200: error = 45.2758484, gradient norm = 0.5667684 (50 iterations in 0.011s)
[t-SNE] Iteration 250: error = 44.7902908, gradient norm = 0.3939206 (50 iterations in 0.011s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 44.790291
[t-SNE] Iteration 300: error = 0.6907025, gradient norm = 0.0012475 (50 iterations in 0.011s)
[t-SNE] Iteration 350: error = 0.6148632, gradient norm = 0.0002327 (50 iterations in 0.011s)
[t-SNE] Iteration 400: error = 0.6128332, gradient norm = 0.0000696 (50 iterations in 0.010s)
[t-SNE] Iteration 450: error = 0.6111299, gradient norm = 0.0000621 (50 iterations in 0.010s)
[t-SNE] Iteration 500: error = 0.6104587, gradient norm = 0.0000393 (50 iterations in 0.010s)
[t-SNE] Iteration 550: error = 0.6099401, gradient norm = 0.0000286 (50 iterations in 0.010s)
[t-SNE] Iteration 600: error = 0.6091090, gradient norm = 0.0000486 (50 iterations in 0.010s)
[t-SNE] Iteration 650: error = 0.6089577, gradient norm = 0.0000516 (50 iterations in 0.010s)
[t-SNE] Iteration 700: error = 0.6071576, gradient norm = 0.0001210 (50 iterations in 0.010s)
[t-SNE] Iteration 750: error = 0.6035656, gradient norm = 0.0003014 (50 iterations in 0.010s)
[t-SNE] Iteration 800: error = 0.9054316, gradient norm = 0.0026258 (50 iterations in 0.011s)
[t-SNE] Iteration 850: error = 0.6961917, gradient norm = 0.0005774 (50 iterations in 0.011s)
[t-SNE] Iteration 900: error = 0.6234180, gradient norm = 0.0001785 (50 iterations in 0.011s)
[t-SNE] Iteration 950: error = 0.6144051, gradient norm = 0.0000931 (50 iterations in 0.010s)
[t-SNE] Iteration 1000: error = 0.6128201, gradient norm = 0.0000561 (50 iterations in 0.010s)
[t-SNE] KL divergence after 1000 iterations: 0.612820
[t-SNE] Computed conditional probabilities for sample 49 / 49
[t-SNE] Mean sigma: 1125899906842624.000000
Beginning preprocessing + Leiden
2024-03-13 17:43:21.995293 MEMORY 15.515807744
Affmat transformed
2024-03-13 17:43:21.996049 MEMORY 15.515807744
sources, targets, weights extracted
2024-03-13 17:43:21.996366 MEMORY 15.515807744
About to launch parallel Leiden runs
2024-03-13 17:43:22.000927 MEMORY 15.515807744
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.6s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.7s finished
Parallel Leiden runs finished
2024-03-13 17:43:23.726084 MEMORY 15.515807744
Quality: 2.4868995751602976e-13
Got subclusters: Counter({0: 49})
On metacluster 3
Metacluster size 19360
Relevant tasks:  ('head',)
Relevant signs:  (-1,)
TfModiscoSeqletsToPatternsFactory: seed=1234
(Round 1) num seqlets: 19360
(Round 1) Computing coarse affmat
2024-03-13 17:43:27.072801 MEMORY 15.515283456
Beginning embedding computation
MEMORY 15.515283456
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 152 tasks      | elapsed:    1.9s
[Parallel(n_jobs=24)]: Done 402 tasks      | elapsed:    4.6s
[Parallel(n_jobs=24)]: Done 752 tasks      | elapsed:    8.5s
[Parallel(n_jobs=24)]: Done 1202 tasks      | elapsed:   13.4s
[Parallel(n_jobs=24)]: Done 1752 tasks      | elapsed:   19.4s
[Parallel(n_jobs=24)]: Done 2402 tasks      | elapsed:   26.5s
[Parallel(n_jobs=24)]: Done 3152 tasks      | elapsed:   34.7s
[Parallel(n_jobs=24)]: Done 4002 tasks      | elapsed:   44.0s
[Parallel(n_jobs=24)]: Done 4952 tasks      | elapsed:   54.3s
[Parallel(n_jobs=24)]: Done 6002 tasks      | elapsed:  1.1min
[Parallel(n_jobs=24)]: Done 7152 tasks      | elapsed:  1.3min
[Parallel(n_jobs=24)]: Done 8402 tasks      | elapsed:  1.5min
[Parallel(n_jobs=24)]: Done 9752 tasks      | elapsed:  1.8min
[Parallel(n_jobs=24)]: Done 11202 tasks      | elapsed:  2.0min
[Parallel(n_jobs=24)]: Done 12752 tasks      | elapsed:  2.3min
[Parallel(n_jobs=24)]: Done 14402 tasks      | elapsed:  2.6min
[Parallel(n_jobs=24)]: Done 16152 tasks      | elapsed:  2.9min
[Parallel(n_jobs=24)]: Done 18002 tasks      | elapsed:  3.3min
[Parallel(n_jobs=24)]: Done 19360 out of 19360 | elapsed:  3.5min finished
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 152 tasks      | elapsed:    1.9s
[Parallel(n_jobs=24)]: Done 402 tasks      | elapsed:    4.7s
[Parallel(n_jobs=24)]: Done 752 tasks      | elapsed:    8.5s
[Parallel(n_jobs=24)]: Done 1202 tasks      | elapsed:   13.4s
[Parallel(n_jobs=24)]: Done 1752 tasks      | elapsed:   19.3s
[Parallel(n_jobs=24)]: Done 2402 tasks      | elapsed:   26.5s
[Parallel(n_jobs=24)]: Done 3152 tasks      | elapsed:   34.7s
[Parallel(n_jobs=24)]: Done 4002 tasks      | elapsed:   44.0s
[Parallel(n_jobs=24)]: Done 4952 tasks      | elapsed:   54.4s
[Parallel(n_jobs=24)]: Done 6002 tasks      | elapsed:  1.1min
[Parallel(n_jobs=24)]: Done 7152 tasks      | elapsed:  1.3min
[Parallel(n_jobs=24)]: Done 8402 tasks      | elapsed:  1.5min
[Parallel(n_jobs=24)]: Done 9752 tasks      | elapsed:  1.8min
[Parallel(n_jobs=24)]: Done 11202 tasks      | elapsed:  2.1min
[Parallel(n_jobs=24)]: Done 12752 tasks      | elapsed:  2.3min
[Parallel(n_jobs=24)]: Done 14402 tasks      | elapsed:  2.6min
[Parallel(n_jobs=24)]: Done 16152 tasks      | elapsed:  3.0min
[Parallel(n_jobs=24)]: Done 18002 tasks      | elapsed:  3.3min
[Parallel(n_jobs=24)]: Done 19360 out of 19360 | elapsed:  3.5min finished
At the beginning of embedding call
2024-03-13 17:43:27.073074 MEMORY 15.515283456
before computing embeddings fwd
2024-03-13 17:43:27.081772 MEMORY 15.515283456
after computing embeddings fwd
2024-03-13 17:46:58.316888 MEMORY 15.658573824
after computing embeddings rev
2024-03-13 17:50:30.671241 MEMORY 16.449445888
before computing sparse embeddings fwd
2024-03-13 17:50:30.671376 MEMORY 16.449445888
Constructing csr matrix...
csr matrix made in 2.4477055072784424 s
after computing sparse embeddings fwd
2024-03-13 17:50:34.042759 MEMORY 16.526983168
before computing sparse embeddings rev
2024-03-13 17:50:34.042852 MEMORY 16.526983168
Constructing csr matrix...
csr matrix made in 2.2411746978759766 s
after computing sparse embeddings rev
2024-03-13 17:50:37.077774 MEMORY 16.643411968
Finished embedding computation in 432.88 s
MEMORY 15.969701888
Starting affinity matrix computations
MEMORY 15.969701888
Batching in slices of size 3466
  0%|          | 0/6 [00:00<?, ?it/s] 17%|â–ˆâ–‹        | 1/6 [00:08<00:43,  8.64s/it] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 2/6 [00:17<00:34,  8.66s/it] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 3/6 [00:25<00:25,  8.61s/it] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 4/6 [00:34<00:17,  8.59s/it] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 5/6 [00:43<00:08,  8.63s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:49<00:00,  7.80s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:49<00:00,  8.22s/it]
Finished affinity matrix computations in 49.42 s
MEMORY 15.969701888
(Round 1) Computed coarse affmat
2024-03-13 17:51:31.700622 MEMORY 15.775830016
(Round 1) Computing affinity matrix on nearest neighbors
2024-03-13 17:51:31.700753 MEMORY 15.775830016
Launching nearest neighbors affmat calculation job
MEMORY 15.775830016
Parallel runs completed
MEMORY 15.800029184
Job completed in: 58.03 s
MEMORY 15.799783424
Launching nearest neighbors affmat calculation job
MEMORY 15.799611392
Parallel runs completed
MEMORY 15.941484544
Job completed in: 59.79 s
MEMORY 15.942250496
(Round 1) Computed affinity matrix on nearest neighbors in 123.51 s
2024-03-13 17:53:35.221325 MEMORY 15.942250496
Filtered down to 18119 of 19360
(Round 1) Retained 18119 rows out of 19360 after filtering
2024-03-13 17:53:45.054978 MEMORY 15.942250496
(Round 1) Computing density adapted affmat
2024-03-13 17:53:51.399801 MEMORY 15.942250496
Symmetrizing nearest neighbors
Computing betas for density adaptation
Computing normalizing denominators
(Round 1) Computing clustering
2024-03-13 17:56:31.185919 MEMORY 15.919972352
Beginning preprocessing + Leiden
2024-03-13 17:56:31.210400 MEMORY 15.919972352
Affmat transformed
2024-03-13 17:56:31.210558 MEMORY 15.919972352
sources, targets, weights extracted
2024-03-13 17:56:31.923062 MEMORY 16.125341696
About to launch parallel Leiden runs
2024-03-13 17:56:32.079746 MEMORY 15.919960064
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:  1.9min
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:  7.5min finished
Parallel Leiden runs finished
2024-03-13 18:04:05.055087 MEMORY 15.926972416
Quality: 0.394577555345308
Quality: 0.39542995647164786
Quality: 0.39574354221603114
Quality: 0.39574550636657563
Quality: 0.3957462813158852
Quality: 0.39574636388581047
Got 6 clusters after round 1
Counts:
{0: 4277, 3: 2911, 4: 2878, 2: 3679, 1: 4071, 5: 303}
2024-03-13 18:04:05.112424 MEMORY 15.772946432
(Round 1) Aggregating seqlets in each cluster
2024-03-13 18:04:05.112528 MEMORY 15.772946432
Aggregating for cluster 0 with 4277 seqlets
2024-03-13 18:04:05.127832 MEMORY 15.772946432
Skipped 13 due to duplicates
Trimming eliminated 0 seqlets out of 4264
Aggregating for cluster 1 with 4071 seqlets
2024-03-13 18:04:18.717908 MEMORY 15.772758016
Skipped 10 due to duplicates
Trimming eliminated 0 seqlets out of 4061
Aggregating for cluster 2 with 3679 seqlets
2024-03-13 18:04:27.541277 MEMORY 15.772737536
Removed 1 duplicate seqlets
Skipped 15 due to duplicates
Trimming eliminated 0 seqlets out of 3663
Aggregating for cluster 3 with 2911 seqlets
2024-03-13 18:04:35.764538 MEMORY 15.772745728
Skipped 9 due to duplicates
Trimming eliminated 0 seqlets out of 2902
Aggregating for cluster 4 with 2878 seqlets
2024-03-13 18:04:41.982361 MEMORY 15.772745728
Skipped 7 due to duplicates
Trimming eliminated 0 seqlets out of 2871
Aggregating for cluster 5 with 303 seqlets
2024-03-13 18:04:48.924485 MEMORY 15.772745728
Trimming eliminated 0 seqlets out of 303
(Round 2) num seqlets: 18061
(Round 2) Computing coarse affmat
2024-03-13 18:04:55.272080 MEMORY 15.772762112
Beginning embedding computation
MEMORY 15.772762112
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 320 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done 2256 tasks      | elapsed:    3.1s
[Parallel(n_jobs=24)]: Done 5056 tasks      | elapsed:    6.6s
[Parallel(n_jobs=24)]: Done 8656 tasks      | elapsed:   10.7s
[Parallel(n_jobs=24)]: Done 13056 tasks      | elapsed:   15.6s
[Parallel(n_jobs=24)]: Done 18061 out of 18061 | elapsed:   20.9s finished
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 368 tasks      | elapsed:    0.8s
[Parallel(n_jobs=24)]: Done 1368 tasks      | elapsed:    2.3s
[Parallel(n_jobs=24)]: Done 2768 tasks      | elapsed:    4.3s
[Parallel(n_jobs=24)]: Done 4568 tasks      | elapsed:    6.9s
[Parallel(n_jobs=24)]: Done 6768 tasks      | elapsed:   10.0s
[Parallel(n_jobs=24)]: Done 9368 tasks      | elapsed:   13.6s
[Parallel(n_jobs=24)]: Done 12368 tasks      | elapsed:   17.8s
[Parallel(n_jobs=24)]: Done 15768 tasks      | elapsed:   22.5s
[Parallel(n_jobs=24)]: Done 18061 out of 18061 | elapsed:   25.8s finished
At the beginning of embedding call
2024-03-13 18:04:55.272367 MEMORY 15.772762112
before computing embeddings fwd
2024-03-13 18:04:55.281869 MEMORY 15.772762112
after computing embeddings fwd
2024-03-13 18:05:16.167810 MEMORY 16.34930688
after computing embeddings rev
2024-03-13 18:05:42.000077 MEMORY 17.085575168
before computing sparse embeddings fwd
2024-03-13 18:05:42.000169 MEMORY 17.085575168
Constructing csr matrix...
csr matrix made in 2.0969221591949463 s
after computing sparse embeddings fwd
2024-03-13 18:05:45.071709 MEMORY 17.221763072
before computing sparse embeddings rev
2024-03-13 18:05:45.071793 MEMORY 17.221763072
Constructing csr matrix...
csr matrix made in 2.0681240558624268 s
after computing sparse embeddings rev
2024-03-13 18:05:48.078053 MEMORY 17.330212864
Finished embedding computation in 56.39 s
MEMORY 16.714698752
Starting affinity matrix computations
MEMORY 16.714698752
Batching in slices of size 3715
  0%|          | 0/5 [00:00<?, ?it/s] 20%|â–ˆâ–ˆ        | 1/5 [00:09<00:38,  9.59s/it] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [00:18<00:27,  9.18s/it] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [00:27<00:18,  9.32s/it] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [00:37<00:09,  9.28s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [00:45<00:00,  9.00s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [00:45<00:00,  9.14s/it]
Finished affinity matrix computations in 45.85 s
MEMORY 16.714698752
(Round 2) Computed coarse affmat
2024-03-13 18:06:40.324555 MEMORY 16.497729536
(Round 2) Computing affinity matrix on nearest neighbors
2024-03-13 18:06:40.324694 MEMORY 16.497729536
Launching nearest neighbors affmat calculation job
MEMORY 16.497729536
Parallel runs completed
MEMORY 16.51265536
Job completed in: 31.06 s
MEMORY 16.512536576
Launching nearest neighbors affmat calculation job
MEMORY 16.51021824
Parallel runs completed
MEMORY 16.522678272
Job completed in: 29.12 s
MEMORY 16.522682368
(Round 2) Computed affinity matrix on nearest neighbors in 65.14 s
2024-03-13 18:07:45.470438 MEMORY 16.522461184
Not applying filtering for rounds above first round
2024-03-13 18:07:45.472433 MEMORY 16.522461184
(Round 2) Computing density adapted affmat
2024-03-13 18:07:51.228511 MEMORY 16.54728704
Symmetrizing nearest neighbors
Computing betas for density adaptation
Computing normalizing denominators
(Round 2) Computing clustering
2024-03-13 18:10:22.022871 MEMORY 16.910901248
Beginning preprocessing + Leiden
2024-03-13 18:10:22.047066 MEMORY 16.910901248
Affmat transformed
2024-03-13 18:10:22.047200 MEMORY 16.910901248
sources, targets, weights extracted
2024-03-13 18:10:22.726416 MEMORY 17.112367104
About to launch parallel Leiden runs
2024-03-13 18:10:22.906975 MEMORY 16.910729216
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:  1.4min
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:  4.7min finished
Parallel Leiden runs finished
2024-03-13 18:15:06.385853 MEMORY 16.910262272
Quality: 0.5648658782105641
Quality: 0.5648683477994819
Got 5 clusters after round 2
Counts:
{4: 3104, 1: 3784, 3: 3263, 2: 3755, 0: 4155}
2024-03-13 18:15:06.431748 MEMORY 16.759025664
(Round 2) Aggregating seqlets in each cluster
2024-03-13 18:15:06.431841 MEMORY 16.759025664
Aggregating for cluster 0 with 4155 seqlets
2024-03-13 18:15:06.442774 MEMORY 16.759025664
Skipped 2 due to duplicates
Trimming eliminated 0 seqlets out of 4153
Aggregating for cluster 1 with 3784 seqlets
2024-03-13 18:15:15.600314 MEMORY 16.759283712
Trimming eliminated 0 seqlets out of 3784
Aggregating for cluster 2 with 3755 seqlets
2024-03-13 18:15:21.410595 MEMORY 16.759283712
Skipped 3 due to duplicates
Trimming eliminated 0 seqlets out of 3752
Aggregating for cluster 3 with 3263 seqlets
2024-03-13 18:15:27.454952 MEMORY 16.759283712
Skipped 1 due to duplicates
Trimming eliminated 0 seqlets out of 3262
Aggregating for cluster 4 with 3104 seqlets
2024-03-13 18:15:32.593788 MEMORY 16.759291904
Skipped 3 due to duplicates
Trimming eliminated 0 seqlets out of 3101
Got 5 clusters
Splitting into subclusters...
2024-03-13 18:15:36.976625 MEMORY 16.759291904
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 3758 tasks      | elapsed:    1.2s
[Parallel(n_jobs=24)]: Done 4153 out of 4153 | elapsed:    1.3s finished
Inspecting pattern 0 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 4153
[t-SNE] Computed conditional probabilities for sample 2000 / 4153
[t-SNE] Computed conditional probabilities for sample 3000 / 4153
[t-SNE] Computed conditional probabilities for sample 4000 / 4153
[t-SNE] Computed conditional probabilities for sample 4153 / 4153
[t-SNE] Mean sigma: 0.283657
Beginning preprocessing + Leiden
2024-03-13 18:15:42.502875 MEMORY 16.7593984
Affmat transformed
2024-03-13 18:15:42.548938 MEMORY 16.7593984
sources, targets, weights extracted
2024-03-13 18:15:42.585045 MEMORY 16.7593984
About to launch parallel Leiden runs
2024-03-13 18:15:42.865483 MEMORY 16.759353344
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:   16.8s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   58.2s finished
Parallel Leiden runs finished
2024-03-13 18:16:41.046221 MEMORY 16.759140352
Quality: 0.49710136200558747
Got subclusters: Counter({0: 743, 1: 629, 2: 592, 3: 585, 4: 561, 5: 344, 6: 256, 7: 229, 8: 153, 9: 61})
On merging iteration 1
Numbers for each pattern pre-subsample: [743, 629, 592, 585, 561, 344, 256, 229, 153, 61]
Numbers after subsampling: [300, 300, 300, 300, 300, 300, 256, 229, 153, 61]
Computing sims for pattern 0
Computed sims for pattern 0 in 2.430662155151367 s
Computing sims for pattern 1
Computed sims for pattern 1 in 2.576631546020508 s
Computing sims for pattern 2
Computed sims for pattern 2 in 2.6097238063812256 s
Computing sims for pattern 3
Computed sims for pattern 3 in 2.6066951751708984 s
Computing sims for pattern 4
Computed sims for pattern 4 in 2.6207785606384277 s
Computing sims for pattern 5
Computed sims for pattern 5 in 5.608914375305176 s
Computing sims for pattern 6
Computed sims for pattern 6 in 2.219844341278076 s
Computing sims for pattern 7
Computed sims for pattern 7 in 2.5287210941314697 s
Computing sims for pattern 8
Computed sims for pattern 8 in 1.600724697113037 s
Computing sims for pattern 9
Computed sims for pattern 9 in 0.8007428646087646 s
Cluster sizes
[743 629 592 585 561 344 256 229 153  61]
Cross-contamination matrix:
[[1.   0.69 0.75 0.72 0.82 0.79 0.75 0.28 0.41 0.42]
 [0.68 1.   0.64 0.69 0.76 0.81 0.77 0.28 0.21 0.45]
 [0.83 0.73 1.   0.71 0.74 0.85 0.75 0.42 0.36 0.46]
 [0.71 0.68 0.62 1.   0.77 0.67 0.77 0.32 0.44 0.41]
 [0.72 0.67 0.58 0.69 1.   0.71 0.73 0.24 0.27 0.34]
 [0.8  0.83 0.78 0.7  0.82 1.   0.82 0.34 0.27 0.43]
 [0.67 0.7  0.59 0.7  0.74 0.72 1.   0.25 0.26 0.38]
 [0.68 0.7  0.8  0.75 0.69 0.76 0.72 1.   0.38 0.39]
 [0.71 0.43 0.58 0.76 0.61 0.49 0.58 0.26 1.   0.33]
 [0.63 0.66 0.59 0.63 0.61 0.61 0.66 0.21 0.27 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.88 0.91 0.85 0.89 0.87 0.87 0.63 0.72 0.74]
 [0.88 1.   0.88 0.86 0.93 0.92 0.92 0.69 0.53 0.72]
 [0.91 0.88 1.   0.79 0.83 0.91 0.87 0.73 0.67 0.67]
 [0.85 0.86 0.79 1.   0.88 0.81 0.88 0.63 0.69 0.72]
 [0.89 0.93 0.83 0.88 1.   0.92 0.92 0.69 0.5  0.7 ]
 [0.87 0.92 0.91 0.81 0.92 1.   0.93 0.77 0.55 0.6 ]
 [0.87 0.92 0.87 0.88 0.92 0.93 1.   0.71 0.55 0.68]
 [0.63 0.69 0.73 0.63 0.69 0.77 0.71 1.   0.29 0.31]
 [0.72 0.53 0.67 0.69 0.5  0.55 0.55 0.29 1.   0.54]
 [0.74 0.72 0.67 0.72 0.7  0.6  0.68 0.31 0.54 1.  ]]
Collapsing 5 & 6 with crosscontam 0.7220393006006878 and sim 0.9269139672610364
Collapsing 1 & 4 with crosscontam 0.6720044943209877 and sim 0.9265578809381094
Collapsing 1 & 5 with crosscontam 0.807864898271605 and sim 0.9207055437631165
Collapsing 1 & 6 with crosscontam 0.6957981053988138 and sim 0.9194052511278439
Collapsing 4 & 5 with crosscontam 0.7134532716049382 and sim 0.9166666050645207
Collapsing 4 & 6 with crosscontam 0.7255035983796296 and sim 0.9157068911176096
Collapsing 2 & 5 with crosscontam 0.781381714074074 and sim 0.9148560585665171
Collapsing 0 & 2 with crosscontam 0.7475686469135803 and sim 0.9082275513435956
Collapsing 0 & 4 with crosscontam 0.7216489525925924 and sim 0.8927108783343031
Collapsing 0 & 1 with crosscontam 0.6806694785185186 and sim 0.8832590308285976
Collapsing 3 & 6 with crosscontam 0.702528928120931 and sim 0.877395108404463
Collapsing 3 & 4 with crosscontam 0.6946241654320988 and sim 0.8768914947650575
Collapsing 1 & 2 with crosscontam 0.6404317041975309 and sim 0.8762807592795444
Collapsing 0 & 5 with crosscontam 0.7881380241975309 and sim 0.8701010510516691
Collapsing 0 & 6 with crosscontam 0.6708635489145913 and sim 0.8682920624853774
Collapsing 2 & 6 with crosscontam 0.5875357206662497 and sim 0.8669673645965328
Collapsing 1 & 3 with crosscontam 0.6807364637037034 and sim 0.8580758552635319
Trimming eliminated 0 seqlets out of 600
Trimming eliminated 0 seqlets out of 1190
Trimming eliminated 0 seqlets out of 1790
Trimming eliminated 0 seqlets out of 2382
Trimming eliminated 0 seqlets out of 3125
Trimming eliminated 0 seqlets out of 3710
Unmerged patterns remapping: OrderedDict([(7, 1), (8, 2), (9, 3)])
Time spent on merging iteration: 21.073626279830933
On merging iteration 2
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 3366 tasks      | elapsed:    1.0s
[Parallel(n_jobs=24)]: Done 3784 out of 3784 | elapsed:    1.2s finished
Numbers for each pattern pre-subsample: [3710, 229, 153, 61]
Numbers after subsampling: [300, 229, 153, 61]
Computing sims for pattern 0
Computed sims for pattern 0 in 0.8546442985534668 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.2938239574432373 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.17464613914489746 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.09087204933166504 s
Cluster sizes
[3710  229  153   61]
Cross-contamination matrix:
[[1.   0.49 0.53 0.63]
 [0.74 1.   0.38 0.39]
 [0.61 0.26 1.   0.33]
 [0.62 0.21 0.27 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.72 0.64 0.74]
 [0.72 1.   0.29 0.31]
 [0.64 0.29 1.   0.54]
 [0.74 0.31 0.54 1.  ]]
Inspecting pattern 1 for spurious merging
Warning: each seqlet is not its own nearest neighbor; there may be duplicates
[t-SNE] Computed conditional probabilities for sample 1000 / 3784
[t-SNE] Computed conditional probabilities for sample 2000 / 3784
[t-SNE] Computed conditional probabilities for sample 3000 / 3784
[t-SNE] Computed conditional probabilities for sample 3784 / 3784
[t-SNE] Mean sigma: 0.280315
Beginning preprocessing + Leiden
2024-03-13 18:17:34.392924 MEMORY 16.75933696
Affmat transformed
2024-03-13 18:17:34.435361 MEMORY 16.75933696
sources, targets, weights extracted
2024-03-13 18:17:34.467066 MEMORY 16.759349248
About to launch parallel Leiden runs
2024-03-13 18:17:34.482878 MEMORY 16.759361536
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:   13.2s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   47.9s finished
Parallel Leiden runs finished
2024-03-13 18:18:22.369698 MEMORY 16.759361536
Quality: 0.5110656634503031
Quality: 0.5114406110374334
Got subclusters: Counter({0: 707, 1: 565, 2: 490, 3: 473, 4: 403, 5: 296, 6: 284, 7: 241, 8: 199, 9: 126})
On merging iteration 1
Numbers for each pattern pre-subsample: [707, 565, 490, 473, 403, 296, 284, 241, 199, 126]
Numbers after subsampling: [300, 300, 300, 300, 300, 296, 284, 241, 199, 126]
Computing sims for pattern 0
Computed sims for pattern 0 in 2.993908643722534 s
Computing sims for pattern 1
Computed sims for pattern 1 in 3.0768685340881348 s
Computing sims for pattern 2
Computed sims for pattern 2 in 3.092256546020508 s
Computing sims for pattern 3
Computed sims for pattern 3 in 3.0389275550842285 s
Computing sims for pattern 4
Computed sims for pattern 4 in 3.0903866291046143 s
Computing sims for pattern 5
Computed sims for pattern 5 in 3.00915265083313 s
Computing sims for pattern 6
Computed sims for pattern 6 in 2.866154909133911 s
Computing sims for pattern 7
Computed sims for pattern 7 in 2.23724627494812 s
Computing sims for pattern 8
Computed sims for pattern 8 in 2.2935903072357178 s
Computing sims for pattern 9
Computed sims for pattern 9 in 1.5729546546936035 s
Cluster sizes
[707 565 490 473 403 296 284 241 199 126]
Cross-contamination matrix:
[[1.   0.51 0.68 0.43 0.71 0.61 0.66 0.44 0.52 0.35]
 [0.17 1.   0.4  0.82 0.39 0.17 0.21 0.53 0.38 0.35]
 [0.76 0.95 1.   0.85 0.77 0.66 0.69 0.79 0.76 0.56]
 [0.16 0.85 0.35 1.   0.36 0.11 0.2  0.56 0.32 0.33]
 [0.67 0.84 0.65 0.76 1.   0.55 0.52 0.6  0.52 0.59]
 [0.87 0.73 0.83 0.34 0.83 1.   0.77 0.53 0.71 0.56]
 [0.84 0.76 0.79 0.67 0.73 0.69 1.   0.7  0.66 0.65]
 [0.4  0.94 0.65 0.94 0.58 0.29 0.48 1.   0.56 0.58]
 [0.65 0.96 0.81 0.83 0.68 0.6  0.63 0.74 1.   0.59]
 [0.53 0.98 0.66 0.92 0.8  0.52 0.66 0.82 0.63 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.69 0.89 0.62 0.87 0.91 0.9  0.71 0.78 0.65]
 [0.69 1.   0.85 0.95 0.84 0.63 0.8  0.9  0.83 0.87]
 [0.89 0.85 1.   0.79 0.9  0.85 0.89 0.88 0.89 0.79]
 [0.62 0.95 0.79 1.   0.79 0.52 0.74 0.9  0.76 0.84]
 [0.87 0.84 0.9  0.79 1.   0.86 0.84 0.79 0.78 0.8 ]
 [0.91 0.63 0.85 0.52 0.86 1.   0.8  0.6  0.77 0.61]
 [0.9  0.8  0.89 0.74 0.84 0.8  1.   0.83 0.83 0.82]
 [0.71 0.9  0.88 0.9  0.79 0.6  0.83 1.   0.82 0.86]
 [0.78 0.83 0.89 0.76 0.78 0.77 0.83 0.82 1.   0.75]
 [0.65 0.87 0.79 0.84 0.8  0.61 0.82 0.86 0.75 1.  ]]
Collapsing 1 & 3 with crosscontam 0.8185611590123456 and sim 0.94898526689401
Collapsing 0 & 5 with crosscontam 0.6121747407407407 and sim 0.9099422568723051
Collapsing 1 & 7 with crosscontam 0.5288492011679728 and sim 0.9004979003028589
Collapsing 2 & 4 with crosscontam 0.6548870962962963 and sim 0.8991246787972123
Collapsing 3 & 7 with crosscontam 0.5566842434301522 and sim 0.8969773492695445
Collapsing 0 & 6 with crosscontam 0.657125181011998 and sim 0.896131295643103
Collapsing 0 & 2 with crosscontam 0.6770756879012347 and sim 0.8947766094272905
Collapsing 2 & 6 with crosscontam 0.6922071992696923 and sim 0.8896117967861071
Collapsing 2 & 8 with crosscontam 0.7622447355294992 and sim 0.8875584657366544
Collapsing 2 & 7 with crosscontam 0.6511421977267737 and sim 0.8837510596426955
Aborting collapse as 0 & 1 have cross-contam 0.3390142671604939 and sim 0.6853179523634031
Aborting collapse as 3 & 5 have cross-contam 0.22820071028543154 and sim 0.5190014369281581
Collapsing 0 & 4 with crosscontam 0.6748019965432097 and sim 0.867562806698963
Collapsing 7 & 9 with crosscontam 0.5806196365453251 and sim 0.8619512920921899
Collapsing 4 & 5 with crosscontam 0.5459882902902904 and sim 0.8578743716592833
Collapsing 2 & 5 with crosscontam 0.6601341311311311 and sim 0.853972498332241
Trimming eliminated 0 seqlets out of 1038
Trimming eliminated 0 seqlets out of 1003
Trimming eliminated 0 seqlets out of 1279
Trimming eliminated 0 seqlets out of 893
Trimming eliminated 0 seqlets out of 1287
Trimming eliminated 0 seqlets out of 2180
Removed 1 duplicate seqlets
Trimming eliminated 0 seqlets out of 2378
Trimming eliminated 0 seqlets out of 1405
Unmerged patterns remapping: OrderedDict()
Time spent on merging iteration: 22.26697039604187
On merging iteration 2
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 3366 tasks      | elapsed:    1.0s
[Parallel(n_jobs=24)]: Done 3705 out of 3752 | elapsed:    1.1s remaining:    0.0s
[Parallel(n_jobs=24)]: Done 3752 out of 3752 | elapsed:    1.1s finished
Numbers for each pattern pre-subsample: [2378, 1405]
Numbers after subsampling: [300, 300]
Computing sims for pattern 0
Computed sims for pattern 0 in 0.3643620014190674 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.36257219314575195 s
Cluster sizes
[2378 1405]
Cross-contamination matrix:
[[1.   0.87]
 [0.45 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.79]
 [0.79 1.  ]]
Inspecting pattern 2 for spurious merging
Warning: each seqlet is not its own nearest neighbor; there may be duplicates
[t-SNE] Computed conditional probabilities for sample 1000 / 3752
[t-SNE] Computed conditional probabilities for sample 2000 / 3752
[t-SNE] Computed conditional probabilities for sample 3000 / 3752
[t-SNE] Computed conditional probabilities for sample 3752 / 3752
[t-SNE] Mean sigma: 0.318986
Beginning preprocessing + Leiden
2024-03-13 18:19:17.044441 MEMORY 16.759361536
Affmat transformed
2024-03-13 18:19:17.086094 MEMORY 16.759361536
sources, targets, weights extracted
2024-03-13 18:19:17.114748 MEMORY 16.759361536
About to launch parallel Leiden runs
2024-03-13 18:19:17.130242 MEMORY 16.759361536
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:   13.2s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   48.2s finished
Parallel Leiden runs finished
2024-03-13 18:20:05.367450 MEMORY 16.759361536
Quality: 0.5480651149727367
Quality: 0.5481797350456877
Quality: 0.5512616344062342
Quality: 0.5513992451393628
Quality: 0.5527847858253929
Quality: 0.5528313498266838
Got subclusters: Counter({0: 554, 1: 532, 2: 507, 3: 485, 4: 419, 5: 409, 6: 398, 7: 280, 8: 168})
On merging iteration 1
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 2983 tasks      | elapsed:    0.9s
[Parallel(n_jobs=24)]: Done 3262 out of 3262 | elapsed:    0.9s finished
Numbers for each pattern pre-subsample: [554, 532, 507, 485, 419, 409, 398, 280, 168]
Numbers after subsampling: [300, 300, 300, 300, 300, 300, 300, 280, 168]
Computing sims for pattern 0
Computed sims for pattern 0 in 2.778622627258301 s
Computing sims for pattern 1
Computed sims for pattern 1 in 2.7649993896484375 s
Computing sims for pattern 2
Computed sims for pattern 2 in 2.733816385269165 s
Computing sims for pattern 3
Computed sims for pattern 3 in 2.7530517578125 s
Computing sims for pattern 4
Computed sims for pattern 4 in 2.799133539199829 s
Computing sims for pattern 5
Computed sims for pattern 5 in 2.7603023052215576 s
Computing sims for pattern 6
Computed sims for pattern 6 in 2.769010543823242 s
Computing sims for pattern 7
Computed sims for pattern 7 in 2.4377403259277344 s
Computing sims for pattern 8
Computed sims for pattern 8 in 1.659984827041626 s
Cluster sizes
[554 532 507 485 419 409 398 280 168]
Cross-contamination matrix:
[[1.   0.46 0.85 0.7  0.75 0.66 0.62 0.62 0.25]
 [0.25 1.   0.62 0.48 0.54 0.78 0.48 0.66 0.4 ]
 [0.56 0.66 1.   0.47 0.49 0.75 0.41 0.5  0.41]
 [0.44 0.68 0.62 1.   0.76 0.57 0.56 0.66 0.3 ]
 [0.63 0.74 0.65 0.75 1.   0.7  0.82 0.7  0.37]
 [0.29 0.68 0.6  0.28 0.41 1.   0.69 0.48 0.4 ]
 [0.15 0.24 0.17 0.22 0.32 0.48 1.   0.18 0.17]
 [0.53 0.89 0.66 0.66 0.7  0.79 0.57 1.   0.31]
 [0.2  0.51 0.48 0.28 0.33 0.6  0.49 0.27 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.47 0.79 0.71 0.75 0.62 0.57 0.59 0.37]
 [0.47 1.   0.75 0.63 0.62 0.8  0.61 0.83 0.63]
 [0.79 0.75 1.   0.63 0.66 0.83 0.57 0.67 0.62]
 [0.71 0.63 0.63 1.   0.83 0.64 0.63 0.7  0.4 ]
 [0.75 0.62 0.66 0.83 1.   0.69 0.75 0.75 0.53]
 [0.62 0.8  0.83 0.64 0.69 1.   0.74 0.71 0.67]
 [0.57 0.61 0.57 0.63 0.75 0.74 1.   0.55 0.61]
 [0.59 0.83 0.67 0.7  0.75 0.71 0.55 1.   0.43]
 [0.37 0.63 0.62 0.4  0.53 0.67 0.61 0.43 1.  ]]
Inspecting pattern 3 for spurious merging
Warning: each seqlet is not its own nearest neighbor; there may be duplicates
[t-SNE] Computed conditional probabilities for sample 1000 / 3262
[t-SNE] Computed conditional probabilities for sample 2000 / 3262
[t-SNE] Computed conditional probabilities for sample 3000 / 3262
[t-SNE] Computed conditional probabilities for sample 3262 / 3262
[t-SNE] Mean sigma: 0.305313
Beginning preprocessing + Leiden
2024-03-13 18:20:34.123282 MEMORY 16.759361536
Affmat transformed
2024-03-13 18:20:34.159969 MEMORY 16.759361536
sources, targets, weights extracted
2024-03-13 18:20:34.183006 MEMORY 16.759361536
About to launch parallel Leiden runs
2024-03-13 18:20:34.198605 MEMORY 16.759361536
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:   10.6s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   34.0s finished
Parallel Leiden runs finished
2024-03-13 18:21:08.207745 MEMORY 16.759361536
Quality: 0.5127741571748228
Quality: 0.5140090512398352
Quality: 0.5140244500278869
Quality: 0.5140523419475427
Quality: 0.5145946668254484
Quality: 0.5149259381359429
Got subclusters: Counter({0: 588, 1: 427, 2: 392, 3: 369, 4: 368, 5: 318, 6: 300, 7: 273, 8: 123, 9: 102, 10: 2})
On merging iteration 1
Numbers for each pattern pre-subsample: [588, 427, 392, 369, 368, 318, 300, 273, 123, 102, 2]
Numbers after subsampling: [300, 300, 300, 300, 300, 300, 300, 273, 123, 102, 2]
Computing sims for pattern 0
Computed sims for pattern 0 in 3.331355571746826 s
Computing sims for pattern 1
Computed sims for pattern 1 in 3.2827045917510986 s
Computing sims for pattern 2
Computed sims for pattern 2 in 3.285737991333008 s
Computing sims for pattern 3
Computed sims for pattern 3 in 3.3043179512023926 s
Computing sims for pattern 4
Computed sims for pattern 4 in 3.2915544509887695 s
Computing sims for pattern 5
Computed sims for pattern 5 in 3.332961082458496 s
Computing sims for pattern 6
Computed sims for pattern 6 in 7.310035228729248 s
Computing sims for pattern 7
Computed sims for pattern 7 in 2.7943804264068604 s
Computing sims for pattern 8
Computed sims for pattern 8 in 1.53532075881958 s
Computing sims for pattern 9
Computed sims for pattern 9 in 1.2564053535461426 s
Computing sims for pattern 10
Computed sims for pattern 10 in 0.2193310260772705 s
Cluster sizes
[588 427 392 369 368 318 300 273 123 102   2]
Cross-contamination matrix:
[[1.   0.63 0.71 0.72 0.63 0.55 0.73 0.52 0.66 0.56 0.52]
 [0.59 1.   0.72 0.61 0.71 0.52 0.51 0.59 0.7  0.39 0.54]
 [0.7  0.71 1.   0.53 0.61 0.68 0.65 0.69 0.68 0.51 0.48]
 [0.65 0.58 0.59 1.   0.54 0.59 0.66 0.45 0.55 0.39 0.4 ]
 [0.66 0.78 0.65 0.64 1.   0.48 0.63 0.62 0.61 0.43 0.57]
 [0.51 0.5  0.48 0.6  0.47 1.   0.6  0.55 0.43 0.37 0.35]
 [0.68 0.57 0.62 0.68 0.56 0.62 1.   0.77 0.76 0.49 0.37]
 [0.36 0.46 0.52 0.36 0.43 0.45 0.65 1.   0.62 0.3  0.38]
 [0.48 0.56 0.5  0.45 0.45 0.33 0.63 0.6  1.   0.31 0.27]
 [0.67 0.53 0.63 0.55 0.51 0.53 0.63 0.56 0.58 1.   0.5 ]
 [0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.87 0.89 0.82 0.82 0.82 0.89 0.78 0.82 0.8  0.56]
 [0.87 1.   0.9  0.83 0.89 0.83 0.78 0.83 0.87 0.74 0.59]
 [0.89 0.9  1.   0.8  0.83 0.84 0.82 0.82 0.83 0.8  0.56]
 [0.82 0.83 0.8  1.   0.79 0.77 0.8  0.74 0.73 0.68 0.5 ]
 [0.82 0.89 0.83 0.79 1.   0.78 0.79 0.82 0.79 0.74 0.61]
 [0.82 0.83 0.84 0.77 0.78 1.   0.77 0.73 0.78 0.69 0.52]
 [0.89 0.78 0.82 0.8  0.79 0.77 1.   0.87 0.83 0.78 0.52]
 [0.78 0.83 0.82 0.74 0.82 0.73 0.87 1.   0.82 0.75 0.57]
 [0.82 0.87 0.83 0.73 0.79 0.78 0.83 0.82 1.   0.74 0.47]
 [0.8  0.74 0.8  0.68 0.74 0.69 0.78 0.75 0.74 1.   0.57]
 [0.56 0.59 0.56 0.5  0.61 0.52 0.52 0.57 0.47 0.57 1.  ]]
Collapsing 1 & 2 with crosscontam 0.7121524666666668 and sim 0.8968597368099802
Collapsing 1 & 4 with crosscontam 0.7055741135802469 and sim 0.8944621301219993
Collapsing 0 & 2 with crosscontam 0.6988886913580246 and sim 0.8902101320043598
Collapsing 0 & 6 with crosscontam 0.6833339432098766 and sim 0.8863909728154137
Collapsing 6 & 7 with crosscontam 0.6508926972252658 and sim 0.8731223245491521
Collapsing 1 & 8 with crosscontam 0.5598725038740904 and sim 0.8716575080291498
Collapsing 0 & 1 with crosscontam 0.5946018962962962 and sim 0.8687296493459086
Trimming eliminated 0 seqlets out of 819
Trimming eliminated 0 seqlets out of 1187
Trimming eliminated 0 seqlets out of 1775
Skipped 1 due to duplicates
Trimming eliminated 0 seqlets out of 2074
Trimming eliminated 0 seqlets out of 2347
Trimming eliminated 0 seqlets out of 2470
Unmerged patterns remapping: OrderedDict([(3, 1), (5, 2), (9, 3), (10, 4)])
Time spent on merging iteration: 14.309936046600342
On merging iteration 2
Numbers for each pattern pre-subsample: [2470, 369, 318, 102, 2]
Numbers after subsampling: [300, 300, 300, 102, 2]
Computing sims for pattern 0
Computed sims for pattern 0 in 1.1991510391235352 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.3378913402557373 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.34011173248291016 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.13511967658996582 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.027124404907226562 s
Cluster sizes
[2470  369  318  102    2]
Cross-contamination matrix:
[[1.   0.95 0.84 0.59 0.66]
 [0.59 1.   0.59 0.39 0.4 ]
 [0.48 0.6  1.   0.37 0.35]
 [0.46 0.55 0.53 1.   0.5 ]
 [0.   0.   0.   0.   1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.88 0.88 0.72 0.56]
 [0.88 1.   0.77 0.68 0.5 ]
 [0.88 0.77 1.   0.69 0.52]
 [0.72 0.68 0.69 1.   0.57]
 [0.56 0.5  0.52 0.57 1.  ]]
Collapsing 0 & 1 with crosscontam 0.5949168380246914 and sim 0.8830898076806639
Trimming eliminated 0 seqlets out of 2839
Unmerged patterns remapping: OrderedDict([(2, 1), (3, 2), (4, 3)])
Time spent on merging iteration: 6.24630331993103
On merging iteration 3
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 3101 out of 3101 | elapsed:    0.8s finished
Numbers for each pattern pre-subsample: [2839, 318, 102, 2]
Numbers after subsampling: [300, 300, 102, 2]
Computing sims for pattern 0
Computed sims for pattern 0 in 0.8174924850463867 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.32980918884277344 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.1339402198791504 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.031627655029296875 s
Cluster sizes
[2839  318  102    2]
Cross-contamination matrix:
[[1.   0.9  0.62 0.64]
 [0.46 1.   0.37 0.35]
 [0.47 0.53 1.   0.5 ]
 [0.   0.   0.   1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.88 0.71 0.55]
 [0.88 1.   0.69 0.52]
 [0.71 0.69 1.   0.57]
 [0.55 0.52 0.57 1.  ]]
Inspecting pattern 4 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 3101
[t-SNE] Computed conditional probabilities for sample 2000 / 3101
[t-SNE] Computed conditional probabilities for sample 3000 / 3101
[t-SNE] Computed conditional probabilities for sample 3101 / 3101
[t-SNE] Mean sigma: 0.303973
Beginning preprocessing + Leiden
2024-03-13 18:22:09.818773 MEMORY 16.759361536
Affmat transformed
2024-03-13 18:22:09.854105 MEMORY 16.759361536
sources, targets, weights extracted
2024-03-13 18:22:09.880154 MEMORY 16.759361536
About to launch parallel Leiden runs
2024-03-13 18:22:09.921985 MEMORY 16.754683904
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:   10.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   44.2s finished
Parallel Leiden runs finished
2024-03-13 18:22:54.129484 MEMORY 16.751419392
Quality: 0.5075776010049758
Quality: 0.5117992993630492
Quality: 0.5148515347075533
Quality: 0.5158470205930082
Quality: 0.5160529804459417
Quality: 0.5168821872557525
Got subclusters: Counter({0: 563, 1: 506, 2: 497, 3: 368, 4: 351, 5: 315, 6: 294, 7: 178, 8: 29})
On merging iteration 1
Numbers for each pattern pre-subsample: [563, 506, 497, 368, 351, 315, 294, 178, 29]
Numbers after subsampling: [300, 300, 300, 300, 300, 300, 294, 178, 29]
Computing sims for pattern 0
Computed sims for pattern 0 in 2.606462240219116 s
Computing sims for pattern 1
Computed sims for pattern 1 in 2.686357259750366 s
Computing sims for pattern 2
Computed sims for pattern 2 in 2.601153612136841 s
Computing sims for pattern 3
Computed sims for pattern 3 in 2.527461051940918 s
Computing sims for pattern 4
Computed sims for pattern 4 in 2.510606050491333 s
Computing sims for pattern 5
Computed sims for pattern 5 in 2.4797704219818115 s
Computing sims for pattern 6
Computed sims for pattern 6 in 2.425140380859375 s
Computing sims for pattern 7
Computed sims for pattern 7 in 1.585864543914795 s
Computing sims for pattern 8
Computed sims for pattern 8 in 0.41037797927856445 s
Cluster sizes
[563 506 497 368 351 315 294 178  29]
Cross-contamination matrix:
[[1.   0.66 0.58 0.62 0.53 0.52 0.38 0.54 0.55]
 [0.51 1.   0.42 0.55 0.6  0.54 0.44 0.41 0.52]
 [0.8  0.78 1.   0.64 0.62 0.74 0.55 0.62 0.67]
 [0.62 0.71 0.45 1.   0.66 0.51 0.41 0.34 0.38]
 [0.61 0.87 0.5  0.75 1.   0.6  0.57 0.47 0.37]
 [0.73 0.93 0.75 0.73 0.74 1.   0.68 0.56 0.62]
 [0.68 0.96 0.68 0.74 0.84 0.81 1.   0.55 0.64]
 [0.79 0.81 0.64 0.71 0.64 0.59 0.48 1.   0.6 ]
 [0.43 0.54 0.37 0.29 0.24 0.33 0.26 0.29 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.78 0.8  0.75 0.79 0.79 0.71 0.78 0.71]
 [0.78 1.   0.81 0.8  0.87 0.91 0.82 0.79 0.82]
 [0.8  0.81 1.   0.78 0.8  0.88 0.81 0.77 0.72]
 [0.75 0.8  0.78 1.   0.83 0.83 0.72 0.7  0.67]
 [0.79 0.87 0.8  0.83 1.   0.86 0.82 0.73 0.6 ]
 [0.79 0.91 0.88 0.83 0.86 1.   0.88 0.76 0.77]
 [0.71 0.82 0.81 0.72 0.82 0.88 1.   0.65 0.65]
 [0.78 0.79 0.77 0.7  0.73 0.76 0.65 1.   0.73]
 [0.71 0.82 0.72 0.67 0.6  0.77 0.65 0.73 1.  ]]
Collapsing 1 & 5 with crosscontam 0.5393078844444446 and sim 0.9148196719656171
Collapsing 2 & 5 with crosscontam 0.7399093575308642 and sim 0.8805234828857778
Collapsing 5 & 6 with crosscontam 0.6804498085159991 and sim 0.8757984598776797
Collapsing 1 & 4 with crosscontam 0.5967121298765432 and sim 0.866588353794607
Collapsing 4 & 5 with crosscontam 0.6041888582716051 and sim 0.8633870481522989
Trimming eliminated 0 seqlets out of 821
Trimming eliminated 0 seqlets out of 1318
Trimming eliminated 0 seqlets out of 1612
Trimming eliminated 0 seqlets out of 1963
Unmerged patterns remapping: OrderedDict([(0, 1), (3, 2), (7, 3), (8, 4)])
Time spent on merging iteration: 8.830371379852295
On merging iteration 2
Numbers for each pattern pre-subsample: [1963, 563, 368, 178, 29]
Numbers after subsampling: [300, 300, 300, 178, 29]
Computing sims for pattern 0
Computed sims for pattern 0 in 1.193878173828125 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.3221259117126465 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.3248765468597412 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.2125394344329834 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.05617165565490723 s
Cluster sizes
[1963  563  368  178   29]
Cross-contamination matrix:
[[1.   0.96 0.95 0.76 0.86]
 [0.54 1.   0.62 0.54 0.55]
 [0.55 0.62 1.   0.34 0.38]
 [0.63 0.79 0.71 1.   0.6 ]
 [0.36 0.43 0.29 0.29 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.88 0.89 0.75 0.78]
 [0.88 1.   0.75 0.78 0.71]
 [0.89 0.75 1.   0.7  0.67]
 [0.75 0.78 0.7  1.   0.73]
 [0.78 0.71 0.67 0.73 1.  ]]
Collapsing 0 & 2 with crosscontam 0.5536388454320988 and sim 0.8879528259352114
Collapsing 0 & 1 with crosscontam 0.5440249170370368 and sim 0.8797355948516183
Trimming eliminated 0 seqlets out of 2331
Trimming eliminated 0 seqlets out of 2894
Unmerged patterns remapping: OrderedDict([(3, 1), (4, 2)])
Time spent on merging iteration: 10.460628509521484
On merging iteration 3
Numbers for each pattern pre-subsample: [2894, 178, 29]
Numbers after subsampling: [300, 178, 29]
Computing sims for pattern 0
Computed sims for pattern 0 in 0.514786958694458 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.2056736946105957 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.05631852149963379 s
Cluster sizes
[2894  178   29]
Cross-contamination matrix:
[[1.   0.8  0.86]
 [0.65 1.   0.6 ]
 [0.37 0.29 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.78 0.79]
 [0.78 1.   0.73]
 [0.79 0.73 1.  ]]
Merging on 22 clusters
2024-03-13 18:23:36.617613 MEMORY 16.751419392
On merging iteration 1
Numbers for each pattern pre-subsample: [3710, 229, 153, 61, 2378, 1405, 554, 532, 507, 485, 419, 409, 398, 280, 168, 2839, 318, 102, 2, 2894, 178, 29]
Numbers after subsampling: [300, 229, 153, 61, 300, 300, 300, 300, 300, 300, 300, 300, 300, 280, 168, 300, 300, 102, 2, 300, 178, 29]
Computing sims for pattern 0
Computed sims for pattern 0 in 6.36542534828186 s
Computing sims for pattern 1
Computed sims for pattern 1 in 5.570239067077637 s
Computing sims for pattern 2
Computed sims for pattern 2 in 3.257260322570801 s
Computing sims for pattern 3
Computed sims for pattern 3 in 1.6236941814422607 s
Computing sims for pattern 4
Computed sims for pattern 4 in 6.252402305603027 s
Computing sims for pattern 5
Computed sims for pattern 5 in 6.185498476028442 s
Computing sims for pattern 6
Computed sims for pattern 6 in 6.190922975540161 s
Computing sims for pattern 7
Computed sims for pattern 7 in 6.088983774185181 s
Computing sims for pattern 8
Computed sims for pattern 8 in 6.052643537521362 s
Computing sims for pattern 9
Computed sims for pattern 9 in 6.035879135131836 s
Computing sims for pattern 10
Computed sims for pattern 10 in 6.079055547714233 s
Computing sims for pattern 11
Computed sims for pattern 11 in 9.177551746368408 s
Computing sims for pattern 12
Computed sims for pattern 12 in 6.113499641418457 s
Computing sims for pattern 13
Computed sims for pattern 13 in 5.42353892326355 s
Computing sims for pattern 14
Computed sims for pattern 14 in 3.5891354084014893 s
Computing sims for pattern 15
Computed sims for pattern 15 in 6.074688673019409 s
Computing sims for pattern 16
Computed sims for pattern 16 in 6.135535717010498 s
Computing sims for pattern 17
Computed sims for pattern 17 in 2.3195714950561523 s
Computing sims for pattern 18
Computed sims for pattern 18 in 0.43517303466796875 s
Computing sims for pattern 19
Computed sims for pattern 19 in 6.195462226867676 s
Computing sims for pattern 20
Computed sims for pattern 20 in 3.981442928314209 s
Computing sims for pattern 21
Computed sims for pattern 21 in 0.9640035629272461 s
Cluster sizes
[3710  229  153   61 2378 1405  554  532  507  485  419  409  398  280
  168 2839  318  102    2 2894  178   29]
Cross-contamination matrix:
[[1.   0.49 0.53 0.63 0.38 0.94 0.11 0.18 0.18 0.11 0.16 0.15 0.2  0.16
  0.06 0.29 0.29 0.14 0.08 0.67 0.39 0.79]
 [0.74 1.   0.38 0.39 0.43 0.66 0.1  0.21 0.18 0.1  0.15 0.21 0.16 0.29
  0.2  0.24 0.54 0.36 0.19 0.49 0.47 0.49]
 [0.61 0.26 1.   0.33 0.21 0.17 0.12 0.21 0.29 0.12 0.16 0.19 0.09 0.25
  0.09 0.16 0.21 0.19 0.07 0.23 0.18 0.37]
 [0.62 0.21 0.27 1.   0.12 0.54 0.18 0.28 0.22 0.26 0.16 0.22 0.28 0.25
  0.08 0.23 0.23 0.09 0.07 0.43 0.26 0.38]
 [0.41 0.28 0.18 0.19 1.   0.87 0.13 0.33 0.19 0.07 0.08 0.26 0.06 0.34
  0.1  0.53 0.6  0.38 0.59 0.43 0.46 0.58]
 [0.57 0.21 0.17 0.26 0.45 1.   0.06 0.18 0.1  0.04 0.04 0.19 0.07 0.1
  0.11 0.38 0.37 0.18 0.18 0.43 0.14 0.61]
 [0.21 0.12 0.21 0.36 0.2  0.22 1.   0.46 0.85 0.7  0.75 0.66 0.62 0.62
  0.25 0.23 0.21 0.19 0.2  0.42 0.29 0.21]
 [0.17 0.11 0.18 0.29 0.23 0.28 0.25 1.   0.62 0.48 0.54 0.78 0.48 0.66
  0.4  0.3  0.29 0.32 0.45 0.23 0.15 0.12]
 [0.18 0.1  0.26 0.23 0.17 0.2  0.56 0.66 1.   0.47 0.49 0.75 0.41 0.5
  0.41 0.33 0.35 0.41 0.3  0.26 0.17 0.17]
 [0.15 0.07 0.15 0.39 0.07 0.09 0.44 0.68 0.62 1.   0.76 0.57 0.56 0.66
  0.3  0.12 0.07 0.08 0.14 0.24 0.23 0.06]
 [0.24 0.13 0.23 0.32 0.11 0.12 0.63 0.74 0.65 0.75 1.   0.7  0.82 0.7
  0.37 0.21 0.12 0.24 0.11 0.46 0.41 0.2 ]
 [0.1  0.07 0.11 0.16 0.14 0.22 0.29 0.68 0.6  0.28 0.41 1.   0.69 0.48
  0.4  0.24 0.25 0.22 0.24 0.22 0.1  0.05]
 [0.07 0.03 0.02 0.13 0.01 0.05 0.15 0.24 0.17 0.22 0.32 0.48 1.   0.18
  0.17 0.02 0.03 0.04 0.01 0.17 0.11 0.03]
 [0.25 0.28 0.33 0.39 0.36 0.29 0.53 0.89 0.66 0.66 0.7  0.79 0.57 1.
  0.31 0.3  0.21 0.24 0.35 0.33 0.31 0.29]
 [0.11 0.16 0.13 0.11 0.14 0.3  0.2  0.51 0.48 0.28 0.33 0.6  0.49 0.27
  1.   0.21 0.39 0.34 0.24 0.14 0.13 0.08]
 [0.42 0.22 0.22 0.36 0.69 0.95 0.21 0.52 0.48 0.14 0.24 0.56 0.1  0.3
  0.22 1.   0.9  0.62 0.64 0.41 0.38 0.59]
 [0.15 0.24 0.07 0.14 0.41 0.5  0.05 0.21 0.21 0.02 0.02 0.27 0.03 0.06
  0.17 0.46 1.   0.37 0.35 0.06 0.06 0.07]
 [0.12 0.21 0.16 0.07 0.37 0.38 0.08 0.33 0.4  0.04 0.23 0.33 0.11 0.11
  0.27 0.47 0.53 1.   0.5  0.11 0.21 0.12]
 [0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.
  0.   0.   0.   0.   1.   0.   0.   0.  ]
 [0.84 0.47 0.31 0.61 0.53 0.9  0.36 0.38 0.35 0.28 0.48 0.32 0.55 0.31
  0.16 0.36 0.16 0.22 0.41 1.   0.8  0.86]
 [0.41 0.36 0.17 0.34 0.48 0.38 0.16 0.18 0.19 0.17 0.3  0.18 0.28 0.22
  0.05 0.3  0.13 0.28 0.35 0.65 1.   0.6 ]
 [0.45 0.18 0.12 0.18 0.23 0.55 0.04 0.04 0.06 0.01 0.05 0.02 0.04 0.07
  0.01 0.13 0.03 0.06 0.02 0.37 0.29 1.  ]]
Pattern-to-pattern sim matrix:
[[ 1.    0.72  0.64  0.74  0.53  0.86  0.24  0.27  0.35  0.26  0.3   0.25
   0.27  0.31  0.17  0.5   0.37  0.32  0.18  0.8   0.61  0.83]
 [ 0.72  1.    0.29  0.31  0.53  0.67  0.02  0.25  0.25 -0.02  0.03  0.26
  -0.06  0.4   0.13  0.38  0.57  0.38  0.18  0.63  0.69  0.65]
 [ 0.64  0.29  1.    0.54  0.33  0.31  0.43  0.46  0.61  0.42  0.52  0.48
   0.33  0.5   0.26  0.31  0.27  0.43  0.32  0.26  0.31  0.3 ]
 [ 0.74  0.31  0.54  1.    0.25  0.63  0.41  0.4   0.51  0.49  0.36  0.41
   0.38  0.37  0.33  0.44  0.34  0.32  0.19  0.6   0.55  0.52]
 [ 0.53  0.53  0.33  0.25  1.    0.79  0.15  0.35  0.37  0.15  0.12  0.37
   0.05  0.43  0.16  0.68  0.71  0.61  0.5   0.64  0.75  0.72]
 [ 0.86  0.67  0.31  0.63  0.79  1.    0.17  0.43  0.38  0.1   0.14  0.47
   0.16  0.39  0.29  0.82  0.72  0.54  0.42  0.82  0.64  0.86]
 [ 0.24  0.02  0.43  0.41  0.15  0.17  1.    0.47  0.79  0.71  0.75  0.62
   0.57  0.59  0.37  0.19  0.14  0.27  0.33  0.47  0.27  0.15]
 [ 0.27  0.25  0.46  0.4   0.35  0.43  0.47  1.    0.75  0.63  0.62  0.8
   0.61  0.83  0.63  0.57  0.49  0.58  0.5   0.33  0.28  0.3 ]
 [ 0.35  0.25  0.61  0.51  0.37  0.38  0.79  0.75  1.    0.63  0.66  0.83
   0.57  0.67  0.62  0.55  0.47  0.61  0.39  0.37  0.39  0.35]
 [ 0.26 -0.02  0.42  0.49  0.15  0.1   0.71  0.63  0.63  1.    0.83  0.64
   0.63  0.7   0.4   0.13  0.09  0.24  0.35  0.39  0.25  0.08]
 [ 0.3   0.03  0.52  0.36  0.12  0.14  0.75  0.62  0.66  0.83  1.    0.69
   0.75  0.75  0.53  0.18  0.14  0.34  0.29  0.52  0.37  0.14]
 [ 0.25  0.26  0.48  0.41  0.37  0.47  0.62  0.8   0.83  0.64  0.69  1.
   0.74  0.71  0.67  0.56  0.54  0.55  0.38  0.4   0.3   0.22]
 [ 0.27 -0.06  0.33  0.38  0.05  0.16  0.57  0.61  0.57  0.63  0.75  0.74
   1.    0.55  0.61  0.08  0.07  0.21  0.2   0.45  0.29  0.14]
 [ 0.31  0.4   0.5   0.37  0.43  0.39  0.59  0.83  0.67  0.7   0.75  0.71
   0.55  1.    0.43  0.33  0.27  0.29  0.39  0.34  0.38  0.43]
 [ 0.17  0.13  0.26  0.33  0.16  0.29  0.37  0.63  0.62  0.4   0.53  0.67
   0.61  0.43  1.    0.3   0.43  0.5   0.31  0.19  0.15  0.12]
 [ 0.5   0.38  0.31  0.44  0.68  0.82  0.19  0.57  0.55  0.13  0.18  0.56
   0.08  0.33  0.3   1.    0.88  0.71  0.55  0.59  0.65  0.63]
 [ 0.37  0.57  0.27  0.34  0.71  0.72  0.14  0.49  0.47  0.09  0.14  0.54
   0.07  0.27  0.43  0.88  1.    0.69  0.52  0.32  0.36  0.24]
 [ 0.32  0.38  0.43  0.32  0.61  0.54  0.27  0.58  0.61  0.24  0.34  0.55
   0.21  0.29  0.5   0.71  0.69  1.    0.57  0.36  0.48  0.43]
 [ 0.18  0.18  0.32  0.19  0.5   0.42  0.33  0.5   0.39  0.35  0.29  0.38
   0.2   0.39  0.31  0.55  0.52  0.57  1.    0.34  0.3   0.31]
 [ 0.8   0.63  0.26  0.6   0.64  0.82  0.47  0.33  0.37  0.39  0.52  0.4
   0.45  0.34  0.19  0.59  0.32  0.36  0.34  1.    0.78  0.79]
 [ 0.61  0.69  0.31  0.55  0.75  0.64  0.27  0.28  0.39  0.25  0.37  0.3
   0.29  0.38  0.15  0.65  0.36  0.48  0.3   0.78  1.    0.73]
 [ 0.83  0.65  0.3   0.52  0.72  0.86  0.15  0.3   0.35  0.08  0.14  0.22
   0.14  0.43  0.12  0.63  0.24  0.43  0.31  0.79  0.73  1.  ]]
Collapsing 0 & 5 with crosscontam 0.5666027901234567 and sim 0.8582350554264249
Collapsing 5 & 21 with crosscontam 0.5457793814151188 and sim 0.8561595827201559
Skipped 1 due to duplicates
Trimming eliminated 0 seqlets out of 5114
Trimming eliminated 0 seqlets out of 5143
Unmerged patterns remapping: OrderedDict([(1, 13), (2, 16), (3, 18), (4, 3), (6, 4), (7, 5), (8, 6), (9, 7), (10, 8), (11, 9), (12, 10), (13, 12), (14, 15), (15, 2), (16, 11), (17, 17), (18, 19), (19, 1), (20, 14)])
Time spent on merging iteration: 16.60774540901184
On merging iteration 2
Numbers for each pattern pre-subsample: [5143, 2894, 2839, 2378, 554, 532, 507, 485, 419, 409, 398, 318, 280, 229, 178, 168, 153, 102, 61, 2]
Numbers after subsampling: [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 280, 229, 178, 168, 153, 102, 61, 2]
Computing sims for pattern 0
Computed sims for pattern 0 in 5.717700481414795 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.31221604347229004 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.3220336437225342 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.3290131092071533 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.3152461051940918 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.3196864128112793 s
Computing sims for pattern 6
Computed sims for pattern 6 in 0.3223435878753662 s
Computing sims for pattern 7
Computed sims for pattern 7 in 0.3161733150482178 s
Computing sims for pattern 8
Computed sims for pattern 8 in 0.3218679428100586 s
Computing sims for pattern 9
Computed sims for pattern 9 in 0.31644153594970703 s
Computing sims for pattern 10
Computed sims for pattern 10 in 0.31821489334106445 s
Computing sims for pattern 11
Computed sims for pattern 11 in 0.3139791488647461 s
Computing sims for pattern 12
Computed sims for pattern 12 in 0.28401970863342285 s
Computing sims for pattern 13
Computed sims for pattern 13 in 0.28007936477661133 s
Computing sims for pattern 14
Computed sims for pattern 14 in 0.19884705543518066 s
Computing sims for pattern 15
Computed sims for pattern 15 in 0.18559479713439941 s
Computing sims for pattern 16
Computed sims for pattern 16 in 0.1674036979675293 s
Computing sims for pattern 17
Computed sims for pattern 17 in 0.12245488166809082 s
Computing sims for pattern 18
Computed sims for pattern 18 in 0.08655071258544922 s
Computing sims for pattern 19
Computed sims for pattern 19 in 0.026047468185424805 s
Cluster sizes
[5143 2894 2839 2378  554  532  507  485  419  409  398  318  280  229
  178  168  153  102   61    2]
Cross-contamination matrix:
[[1.   0.71 0.4  0.5  0.16 0.17 0.18 0.12 0.16 0.15 0.2  0.39 0.19 0.49
  0.42 0.09 0.5  0.16 0.63 0.13]
 [0.85 1.   0.36 0.53 0.36 0.38 0.35 0.28 0.48 0.32 0.55 0.16 0.31 0.47
  0.8  0.16 0.31 0.22 0.61 0.41]
 [0.54 0.41 1.   0.69 0.21 0.52 0.48 0.14 0.24 0.56 0.1  0.9  0.3  0.22
  0.38 0.22 0.22 0.62 0.36 0.64]
 [0.51 0.43 0.53 1.   0.13 0.33 0.19 0.07 0.08 0.26 0.06 0.6  0.34 0.28
  0.46 0.1  0.18 0.38 0.19 0.59]
 [0.25 0.42 0.23 0.2  1.   0.46 0.85 0.7  0.75 0.66 0.62 0.21 0.62 0.12
  0.29 0.25 0.21 0.19 0.36 0.2 ]
 [0.15 0.23 0.3  0.23 0.25 1.   0.62 0.48 0.54 0.78 0.48 0.29 0.66 0.11
  0.15 0.4  0.18 0.32 0.29 0.45]
 [0.16 0.26 0.33 0.17 0.56 0.66 1.   0.47 0.49 0.75 0.41 0.35 0.5  0.1
  0.17 0.41 0.26 0.41 0.23 0.3 ]
 [0.15 0.24 0.12 0.07 0.44 0.68 0.62 1.   0.76 0.57 0.56 0.07 0.66 0.07
  0.23 0.3  0.15 0.08 0.39 0.14]
 [0.22 0.46 0.21 0.11 0.63 0.74 0.65 0.75 1.   0.7  0.82 0.12 0.7  0.13
  0.41 0.37 0.23 0.24 0.32 0.11]
 [0.09 0.22 0.24 0.14 0.29 0.68 0.6  0.28 0.41 1.   0.69 0.25 0.48 0.07
  0.1  0.4  0.11 0.22 0.16 0.24]
 [0.07 0.17 0.02 0.01 0.15 0.24 0.17 0.22 0.32 0.48 1.   0.03 0.18 0.03
  0.11 0.17 0.02 0.04 0.13 0.01]
 [0.21 0.06 0.46 0.41 0.05 0.21 0.21 0.02 0.02 0.27 0.03 1.   0.06 0.24
  0.06 0.17 0.07 0.37 0.14 0.35]
 [0.26 0.33 0.3  0.36 0.53 0.89 0.66 0.66 0.7  0.79 0.57 0.21 1.   0.28
  0.31 0.31 0.33 0.24 0.39 0.35]
 [0.71 0.49 0.24 0.43 0.1  0.21 0.18 0.1  0.15 0.21 0.16 0.54 0.29 1.
  0.47 0.2  0.38 0.36 0.39 0.19]
 [0.42 0.65 0.3  0.48 0.16 0.18 0.19 0.17 0.3  0.18 0.28 0.13 0.22 0.36
  1.   0.05 0.17 0.28 0.34 0.35]
 [0.14 0.14 0.21 0.14 0.2  0.51 0.48 0.28 0.33 0.6  0.49 0.39 0.27 0.16
  0.13 1.   0.13 0.34 0.11 0.24]
 [0.55 0.23 0.16 0.21 0.12 0.21 0.29 0.12 0.16 0.19 0.09 0.21 0.25 0.26
  0.18 0.09 1.   0.19 0.33 0.07]
 [0.12 0.11 0.47 0.37 0.08 0.33 0.4  0.04 0.23 0.33 0.11 0.53 0.11 0.21
  0.21 0.27 0.16 1.   0.07 0.5 ]
 [0.59 0.43 0.23 0.12 0.18 0.28 0.22 0.26 0.16 0.22 0.28 0.23 0.25 0.21
  0.26 0.08 0.27 0.09 1.   0.07]
 [0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.
  0.   0.   0.   0.   0.   1.  ]]
Pattern-to-pattern sim matrix:
[[ 1.    0.82  0.61  0.63  0.2   0.22  0.32  0.22  0.24  0.23  0.25  0.48
   0.34  0.72  0.63  0.18  0.56  0.34  0.73  0.24]
 [ 0.82  1.    0.59  0.64  0.47  0.33  0.37  0.39  0.52  0.4   0.45  0.32
   0.34  0.63  0.78  0.19  0.26  0.36  0.6   0.34]
 [ 0.61  0.59  1.    0.68  0.19  0.57  0.55  0.13  0.18  0.56  0.08  0.88
   0.33  0.38  0.65  0.3   0.31  0.71  0.44  0.55]
 [ 0.63  0.64  0.68  1.    0.15  0.35  0.37  0.15  0.12  0.37  0.05  0.71
   0.43  0.53  0.75  0.16  0.33  0.61  0.25  0.5 ]
 [ 0.2   0.47  0.19  0.15  1.    0.47  0.79  0.71  0.75  0.62  0.57  0.14
   0.59  0.02  0.27  0.37  0.43  0.27  0.41  0.33]
 [ 0.22  0.33  0.57  0.35  0.47  1.    0.75  0.63  0.62  0.8   0.61  0.49
   0.83  0.25  0.28  0.63  0.46  0.58  0.4   0.5 ]
 [ 0.32  0.37  0.55  0.37  0.79  0.75  1.    0.63  0.66  0.83  0.57  0.47
   0.67  0.25  0.39  0.62  0.61  0.61  0.51  0.39]
 [ 0.22  0.39  0.13  0.15  0.71  0.63  0.63  1.    0.83  0.64  0.63  0.09
   0.7  -0.02  0.25  0.4   0.42  0.24  0.49  0.35]
 [ 0.24  0.52  0.18  0.12  0.75  0.62  0.66  0.83  1.    0.69  0.75  0.14
   0.75  0.03  0.37  0.53  0.52  0.34  0.36  0.29]
 [ 0.23  0.4   0.56  0.37  0.62  0.8   0.83  0.64  0.69  1.    0.74  0.54
   0.71  0.26  0.3   0.67  0.48  0.55  0.41  0.38]
 [ 0.25  0.45  0.08  0.05  0.57  0.61  0.57  0.63  0.75  0.74  1.    0.07
   0.55 -0.06  0.29  0.61  0.33  0.21  0.38  0.2 ]
 [ 0.48  0.32  0.88  0.71  0.14  0.49  0.47  0.09  0.14  0.54  0.07  1.
   0.27  0.57  0.36  0.43  0.27  0.69  0.34  0.52]
 [ 0.34  0.34  0.33  0.43  0.59  0.83  0.67  0.7   0.75  0.71  0.55  0.27
   1.    0.4   0.38  0.43  0.5   0.29  0.37  0.39]
 [ 0.72  0.63  0.38  0.53  0.02  0.25  0.25 -0.02  0.03  0.26 -0.06  0.57
   0.4   1.    0.69  0.13  0.29  0.38  0.31  0.18]
 [ 0.63  0.78  0.65  0.75  0.27  0.28  0.39  0.25  0.37  0.3   0.29  0.36
   0.38  0.69  1.    0.15  0.31  0.48  0.55  0.3 ]
 [ 0.18  0.19  0.3   0.16  0.37  0.63  0.62  0.4   0.53  0.67  0.61  0.43
   0.43  0.13  0.15  1.    0.26  0.5   0.33  0.31]
 [ 0.56  0.26  0.31  0.33  0.43  0.46  0.61  0.42  0.52  0.48  0.33  0.27
   0.5   0.29  0.31  0.26  1.    0.43  0.54  0.32]
 [ 0.34  0.36  0.71  0.61  0.27  0.58  0.61  0.24  0.34  0.55  0.21  0.69
   0.29  0.38  0.48  0.5   0.43  1.    0.32  0.57]
 [ 0.73  0.6   0.44  0.25  0.41  0.4   0.51  0.49  0.36  0.41  0.38  0.34
   0.37  0.31  0.55  0.33  0.54  0.32  1.    0.19]
 [ 0.24  0.34  0.55  0.5   0.33  0.5   0.39  0.35  0.29  0.38  0.2   0.52
   0.39  0.18  0.3   0.31  0.32  0.57  0.19  1.  ]]
Got 20 patterns after merging
2024-03-13 18:25:55.492047 MEMORY 16.751419392
Performing filtering
2024-03-13 18:25:55.492252 MEMORY 16.751419392
Got 19 patterns after filtering
2024-03-13 18:25:57.867428 MEMORY 16.751419392
Total time taken is 2553.11s
2024-03-13 18:25:57.867634 MEMORY 16.751419392
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 4572 tasks      | elapsed:    1.7s
[Parallel(n_jobs=24)]: Done 5096 out of 5143 | elapsed:    1.9s remaining:    0.0s
[Parallel(n_jobs=24)]: Done 5143 out of 5143 | elapsed:    1.9s finished
/ru-auth/local/home/lzhao/anaconda3/envs/jupyter-ml-clone/lib/python3.9/site-packages/sklearn/manifold/_t_sne.py:691: FutureWarning: 'square_distances' has been introduced in 0.24 to help phase out legacy squaring behavior. The 'legacy' setting will be removed in 1.1 (renaming of 0.26), and the default setting will be changed to True. In 1.3, 'square_distances' will be removed altogether, and distances will be squared by default. Set 'square_distances'=True to silence this warning.
  warnings.warn(
/ru-auth/local/home/lzhao/anaconda3/envs/jupyter-ml-clone/lib/python3.9/site-packages/sklearn/neighbors/_base.py:175: EfficiencyWarning: Precomputed sparse input was not sorted by data.
  warnings.warn('Precomputed sparse input was not sorted by data.',
Applying subclustering to the final motifs
On pattern 0
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 5143 samples in 0.031s...
[t-SNE] Computed neighbors for 5143 samples in 0.003s...
[t-SNE] Computed conditional probabilities for sample 1000 / 5143
[t-SNE] Computed conditional probabilities for sample 2000 / 5143
[t-SNE] Computed conditional probabilities for sample 3000 / 5143
[t-SNE] Computed conditional probabilities for sample 4000 / 5143
[t-SNE] Computed conditional probabilities for sample 5000 / 5143
[t-SNE] Computed conditional probabilities for sample 5143 / 5143
[t-SNE] Mean sigma: 0.272511
[t-SNE] Computed conditional probabilities in 0.351s
[t-SNE] Iteration 50: error = 81.1514130, gradient norm = 0.0000001 (50 iterations in 0.557s)
[t-SNE] Iteration 100: error = 81.1513901, gradient norm = 0.0000000 (50 iterations in 0.449s)
[t-SNE] Iteration 100: gradient norm 0.000000. Finished.
[t-SNE] KL divergence after 100 iterations with early exaggeration: 81.151390
[t-SNE] Iteration 150: error = 3.1810260, gradient norm = 0.0026003 (50 iterations in 0.396s)
[t-SNE] Iteration 200: error = 2.8408706, gradient norm = 0.0006447 (50 iterations in 0.373s)
[t-SNE] Iteration 250: error = 2.7438929, gradient norm = 0.0003175 (50 iterations in 0.375s)
[t-SNE] Iteration 300: error = 2.6871376, gradient norm = 0.0001917 (50 iterations in 0.367s)
[t-SNE] Iteration 350: error = 2.6513622, gradient norm = 0.0001373 (50 iterations in 0.366s)
[t-SNE] Iteration 400: error = 2.6275284, gradient norm = 0.0001091 (50 iterations in 0.370s)
[t-SNE] Iteration 450: error = 2.6111958, gradient norm = 0.0000866 (50 iterations in 0.369s)
[t-SNE] Iteration 500: error = 2.5990925, gradient norm = 0.0000864 (50 iterations in 0.371s)
[t-SNE] Iteration 550: error = 2.5897291, gradient norm = 0.0000649 (50 iterations in 0.367s)
[t-SNE] Iteration 600: error = 2.5833783, gradient norm = 0.0000569 (50 iterations in 0.369s)
[t-SNE] Iteration 650: error = 2.5784054, gradient norm = 0.0000509 (50 iterations in 0.372s)
[t-SNE] Iteration 700: error = 2.5742831, gradient norm = 0.0000464 (50 iterations in 0.372s)
[t-SNE] Iteration 750: error = 2.5710261, gradient norm = 0.0000409 (50 iterations in 0.369s)
[t-SNE] Iteration 800: error = 2.5682583, gradient norm = 0.0000385 (50 iterations in 0.369s)
[t-SNE] Iteration 850: error = 2.5661495, gradient norm = 0.0000409 (50 iterations in 0.370s)
[t-SNE] Iteration 900: error = 2.5646782, gradient norm = 0.0000369 (50 iterations in 0.374s)
[t-SNE] Iteration 950: error = 2.5633512, gradient norm = 0.0000340 (50 iterations in 0.370s)
[t-SNE] Iteration 1000: error = 2.5622151, gradient norm = 0.0000325 (50 iterations in 0.370s)
[t-SNE] KL divergence after 1000 iterations: 2.562215
[t-SNE] Computed conditional probabilities for sample 1000 / 5143
[t-SNE] Computed conditional probabilities for sample 2000 / 5143
[t-SNE] Computed conditional probabilities for sample 3000 / 5143
[t-SNE] Computed conditional probabilities for sample 4000 / 5143
[t-SNE] Computed conditional probabilities for sample 5000 / 5143
[t-SNE] Computed conditional probabilities for sample 5143 / 5143
[t-SNE] Mean sigma: 0.272511
Beginning preprocessing + Leiden
2024-03-13 18:26:13.038810 MEMORY 16.751747072
Affmat transformed
2024-03-13 18:26:13.096296 MEMORY 16.751747072
sources, targets, weights extracted
2024-03-13 18:26:13.142113 MEMORY 16.751747072
About to launch parallel Leiden runs
2024-03-13 18:26:13.182069 MEMORY 16.75165696
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:   18.8s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:  1.2min finished
Parallel Leiden runs finished
2024-03-13 18:27:22.814385 MEMORY 16.75165696
Quality: 0.5267201332888999
Quality: 0.5286880340221616
Quality: 0.5287535981939611
Quality: 0.5288730798145769
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 2322 tasks      | elapsed:    0.6s
[Parallel(n_jobs=24)]: Done 2894 out of 2894 | elapsed:    0.7s finished
Got subclusters: Counter({0: 1065, 1: 830, 2: 782, 3: 655, 4: 645, 5: 492, 6: 433, 7: 232, 8: 9})
On pattern 1
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 2894 samples in 0.017s...
[t-SNE] Computed neighbors for 2894 samples in 0.002s...
[t-SNE] Computed conditional probabilities for sample 1000 / 2894
[t-SNE] Computed conditional probabilities for sample 2000 / 2894
[t-SNE] Computed conditional probabilities for sample 2894 / 2894
[t-SNE] Mean sigma: 0.305209
[t-SNE] Computed conditional probabilities in 0.194s
[t-SNE] Iteration 50: error = 74.7063370, gradient norm = 0.0155752 (50 iterations in 0.268s)
[t-SNE] Iteration 100: error = 74.7060699, gradient norm = 0.0142879 (50 iterations in 0.250s)
[t-SNE] Iteration 150: error = 74.7063293, gradient norm = 0.0152029 (50 iterations in 0.250s)
[t-SNE] Iteration 200: error = 74.7066116, gradient norm = 0.0162582 (50 iterations in 0.260s)
[t-SNE] Iteration 250: error = 74.7057037, gradient norm = 0.0125923 (50 iterations in 0.249s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 74.705704
[t-SNE] Iteration 300: error = 2.4501631, gradient norm = 0.0012316 (50 iterations in 0.206s)
[t-SNE] Iteration 350: error = 2.3161960, gradient norm = 0.0004200 (50 iterations in 0.194s)
[t-SNE] Iteration 400: error = 2.2592402, gradient norm = 0.0002306 (50 iterations in 0.194s)
[t-SNE] Iteration 450: error = 2.2307792, gradient norm = 0.0001475 (50 iterations in 0.197s)
[t-SNE] Iteration 500: error = 2.2148538, gradient norm = 0.0001179 (50 iterations in 0.195s)
[t-SNE] Iteration 550: error = 2.2050619, gradient norm = 0.0000833 (50 iterations in 0.196s)
[t-SNE] Iteration 600: error = 2.1995163, gradient norm = 0.0000924 (50 iterations in 0.197s)
[t-SNE] Iteration 650: error = 2.1966512, gradient norm = 0.0000606 (50 iterations in 0.198s)
[t-SNE] Iteration 700: error = 2.1935227, gradient norm = 0.0000534 (50 iterations in 0.195s)
[t-SNE] Iteration 750: error = 2.1907921, gradient norm = 0.0000677 (50 iterations in 0.194s)
[t-SNE] Iteration 800: error = 2.1885724, gradient norm = 0.0000517 (50 iterations in 0.194s)
[t-SNE] Iteration 850: error = 2.1868358, gradient norm = 0.0000395 (50 iterations in 0.194s)
[t-SNE] Iteration 900: error = 2.1852145, gradient norm = 0.0000407 (50 iterations in 0.193s)
[t-SNE] Iteration 950: error = 2.1840878, gradient norm = 0.0000363 (50 iterations in 0.194s)
[t-SNE] Iteration 1000: error = 2.1832712, gradient norm = 0.0000417 (50 iterations in 0.195s)
[t-SNE] KL divergence after 1000 iterations: 2.183271
[t-SNE] Computed conditional probabilities for sample 1000 / 2894
[t-SNE] Computed conditional probabilities for sample 2000 / 2894
[t-SNE] Computed conditional probabilities for sample 2894 / 2894
[t-SNE] Mean sigma: 0.305209
Beginning preprocessing + Leiden
2024-03-13 18:27:31.446600 MEMORY 16.751747072
Affmat transformed
2024-03-13 18:27:31.478834 MEMORY 16.751747072
sources, targets, weights extracted
2024-03-13 18:27:31.501880 MEMORY 16.751747072
About to launch parallel Leiden runs
2024-03-13 18:27:31.530551 MEMORY 16.751747072
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    9.4s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   38.1s finished
Parallel Leiden runs finished
2024-03-13 18:28:09.616790 MEMORY 16.751747072
Quality: 0.510131520182078
Quality: 0.5104206912787809
Quality: 0.5128676677241687
Quality: 0.513131669776489
Quality: 0.5137195032274459
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 2472 tasks      | elapsed:    0.6s
[Parallel(n_jobs=24)]: Done 2792 out of 2839 | elapsed:    0.7s remaining:    0.0s
[Parallel(n_jobs=24)]: Done 2839 out of 2839 | elapsed:    0.7s finished
Got subclusters: Counter({0: 524, 1: 488, 2: 461, 3: 344, 4: 335, 5: 278, 6: 246, 7: 218})
On pattern 2
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 2839 samples in 0.020s...
[t-SNE] Computed neighbors for 2839 samples in 0.002s...
[t-SNE] Computed conditional probabilities for sample 1000 / 2839
[t-SNE] Computed conditional probabilities for sample 2000 / 2839
[t-SNE] Computed conditional probabilities for sample 2839 / 2839
[t-SNE] Mean sigma: 0.305749
[t-SNE] Computed conditional probabilities in 0.193s
[t-SNE] Iteration 50: error = 75.1532288, gradient norm = 0.0114601 (50 iterations in 0.241s)
[t-SNE] Iteration 100: error = 75.1529388, gradient norm = 0.0097707 (50 iterations in 0.228s)
[t-SNE] Iteration 150: error = 75.1532059, gradient norm = 0.0113611 (50 iterations in 0.232s)
[t-SNE] Iteration 200: error = 75.1524582, gradient norm = 0.0052882 (50 iterations in 0.229s)
[t-SNE] Iteration 250: error = 75.1546173, gradient norm = 0.0170695 (50 iterations in 0.234s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 75.154617
[t-SNE] Iteration 300: error = 2.5480940, gradient norm = 0.0012590 (50 iterations in 0.198s)
[t-SNE] Iteration 350: error = 2.4171259, gradient norm = 0.0004497 (50 iterations in 0.188s)
[t-SNE] Iteration 400: error = 2.3593168, gradient norm = 0.0002204 (50 iterations in 0.186s)
[t-SNE] Iteration 450: error = 2.3322320, gradient norm = 0.0001521 (50 iterations in 0.186s)
[t-SNE] Iteration 500: error = 2.3174715, gradient norm = 0.0001310 (50 iterations in 0.189s)
[t-SNE] Iteration 550: error = 2.3096297, gradient norm = 0.0001040 (50 iterations in 0.187s)
[t-SNE] Iteration 600: error = 2.3035369, gradient norm = 0.0001165 (50 iterations in 0.190s)
[t-SNE] Iteration 650: error = 2.3007197, gradient norm = 0.0000739 (50 iterations in 0.188s)
[t-SNE] Iteration 700: error = 2.2974358, gradient norm = 0.0000682 (50 iterations in 0.186s)
[t-SNE] Iteration 750: error = 2.2947049, gradient norm = 0.0000551 (50 iterations in 0.186s)
[t-SNE] Iteration 800: error = 2.2920671, gradient norm = 0.0000477 (50 iterations in 0.188s)
[t-SNE] Iteration 850: error = 2.2896914, gradient norm = 0.0000434 (50 iterations in 0.186s)
[t-SNE] Iteration 900: error = 2.2878580, gradient norm = 0.0000396 (50 iterations in 0.186s)
[t-SNE] Iteration 950: error = 2.2862844, gradient norm = 0.0000380 (50 iterations in 0.186s)
[t-SNE] Iteration 1000: error = 2.2850077, gradient norm = 0.0000412 (50 iterations in 0.187s)
[t-SNE] KL divergence after 1000 iterations: 2.285008
Warning: each seqlet is not its own nearest neighbor; there may be duplicates
[t-SNE] Computed conditional probabilities for sample 1000 / 2839
[t-SNE] Computed conditional probabilities for sample 2000 / 2839
[t-SNE] Computed conditional probabilities for sample 2839 / 2839
[t-SNE] Mean sigma: 0.305749
Beginning preprocessing + Leiden
2024-03-13 18:28:17.715719 MEMORY 16.75175936
Affmat transformed
2024-03-13 18:28:17.747510 MEMORY 16.75175936
sources, targets, weights extracted
2024-03-13 18:28:17.768164 MEMORY 16.75175936
About to launch parallel Leiden runs
2024-03-13 18:28:17.780166 MEMORY 16.75175936
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:   11.5s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   40.8s finished
Parallel Leiden runs finished
2024-03-13 18:28:58.588667 MEMORY 16.75175936
Quality: 0.49663919033249626
Quality: 0.5020931501606777
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 2378 out of 2378 | elapsed:    0.5s finished
Got subclusters: Counter({0: 495, 1: 491, 2: 476, 3: 373, 4: 353, 5: 330, 6: 321})
On pattern 3
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 2378 samples in 0.014s...
[t-SNE] Computed neighbors for 2378 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 1000 / 2378
[t-SNE] Computed conditional probabilities for sample 2000 / 2378
[t-SNE] Computed conditional probabilities for sample 2378 / 2378
[t-SNE] Mean sigma: 0.301023
[t-SNE] Computed conditional probabilities in 0.163s
[t-SNE] Iteration 50: error = 72.8337631, gradient norm = 0.0474633 (50 iterations in 0.207s)
[t-SNE] Iteration 100: error = 72.8274689, gradient norm = 0.0384785 (50 iterations in 0.202s)
[t-SNE] Iteration 150: error = 72.8202591, gradient norm = 0.0239831 (50 iterations in 0.215s)
[t-SNE] Iteration 200: error = 72.8268890, gradient norm = 0.0395603 (50 iterations in 0.227s)
[t-SNE] Iteration 250: error = 72.9675598, gradient norm = 0.0273192 (50 iterations in 0.218s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 72.967560
[t-SNE] Iteration 300: error = 2.4638541, gradient norm = 0.0010702 (50 iterations in 0.170s)
[t-SNE] Iteration 350: error = 2.3487875, gradient norm = 0.0004724 (50 iterations in 0.165s)
[t-SNE] Iteration 400: error = 2.3013506, gradient norm = 0.0002103 (50 iterations in 0.164s)
[t-SNE] Iteration 450: error = 2.2778749, gradient norm = 0.0001378 (50 iterations in 0.167s)
[t-SNE] Iteration 500: error = 2.2651446, gradient norm = 0.0001158 (50 iterations in 0.171s)
[t-SNE] Iteration 550: error = 2.2576761, gradient norm = 0.0000855 (50 iterations in 0.167s)
[t-SNE] Iteration 600: error = 2.2527647, gradient norm = 0.0000857 (50 iterations in 0.169s)
[t-SNE] Iteration 650: error = 2.2493808, gradient norm = 0.0000587 (50 iterations in 0.165s)
[t-SNE] Iteration 700: error = 2.2458327, gradient norm = 0.0000770 (50 iterations in 0.166s)
[t-SNE] Iteration 750: error = 2.2435946, gradient norm = 0.0000589 (50 iterations in 0.166s)
[t-SNE] Iteration 800: error = 2.2420998, gradient norm = 0.0000461 (50 iterations in 0.172s)
[t-SNE] Iteration 850: error = 2.2408259, gradient norm = 0.0000590 (50 iterations in 0.160s)
[t-SNE] Iteration 900: error = 2.2396629, gradient norm = 0.0000439 (50 iterations in 0.161s)
[t-SNE] Iteration 950: error = 2.2387264, gradient norm = 0.0000446 (50 iterations in 0.165s)
[t-SNE] Iteration 1000: error = 2.2378805, gradient norm = 0.0000350 (50 iterations in 0.162s)
[t-SNE] KL divergence after 1000 iterations: 2.237880
Warning: each seqlet is not its own nearest neighbor; there may be duplicates
[t-SNE] Computed conditional probabilities for sample 1000 / 2378
[t-SNE] Computed conditional probabilities for sample 2000 / 2378
[t-SNE] Computed conditional probabilities for sample 2378 / 2378
[t-SNE] Mean sigma: 0.301023
Beginning preprocessing + Leiden
2024-03-13 18:29:05.639343 MEMORY 16.751845376
Affmat transformed
2024-03-13 18:29:05.667036 MEMORY 16.751845376
sources, targets, weights extracted
2024-03-13 18:29:05.685436 MEMORY 16.751845376
About to launch parallel Leiden runs
2024-03-13 18:29:05.726762 MEMORY 16.751845376
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    8.6s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   27.6s finished
Parallel Leiden runs finished
2024-03-13 18:29:33.374410 MEMORY 16.751845376
Quality: 0.4738814968014382
Quality: 0.47778390753278627
Quality: 0.4779634519975536
Quality: 0.4780744134692885
Quality: 0.4785835820616689
Quality: 0.47875459061034725
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 554 out of 554 | elapsed:    0.1s finished
Got subclusters: Counter({0: 469, 1: 459, 2: 351, 3: 263, 4: 240, 5: 228, 6: 223, 7: 106, 8: 39})
On pattern 4
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 554 samples in 0.004s...
[t-SNE] Computed neighbors for 554 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 554 / 554
[t-SNE] Mean sigma: 0.370136
[t-SNE] Computed conditional probabilities in 0.037s
[t-SNE] Iteration 50: error = 69.0426559, gradient norm = 0.4219593 (50 iterations in 0.054s)
[t-SNE] Iteration 100: error = 70.1384735, gradient norm = 0.4302056 (50 iterations in 0.055s)
[t-SNE] Iteration 150: error = 68.3568802, gradient norm = 0.4394521 (50 iterations in 0.057s)
[t-SNE] Iteration 200: error = 68.6565399, gradient norm = 0.4442692 (50 iterations in 0.055s)
[t-SNE] Iteration 250: error = 70.0614090, gradient norm = 0.4282681 (50 iterations in 0.055s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 70.061409
[t-SNE] Iteration 300: error = 1.5595785, gradient norm = 0.0047938 (50 iterations in 0.052s)
[t-SNE] Iteration 350: error = 1.4604534, gradient norm = 0.0014475 (50 iterations in 0.052s)
[t-SNE] Iteration 400: error = 1.4253308, gradient norm = 0.0010052 (50 iterations in 0.052s)
[t-SNE] Iteration 450: error = 1.4073161, gradient norm = 0.0003232 (50 iterations in 0.052s)
[t-SNE] Iteration 500: error = 1.3966465, gradient norm = 0.0005677 (50 iterations in 0.052s)
[t-SNE] Iteration 550: error = 1.3852181, gradient norm = 0.0005400 (50 iterations in 0.052s)
[t-SNE] Iteration 600: error = 1.3817824, gradient norm = 0.0003655 (50 iterations in 0.052s)
[t-SNE] Iteration 650: error = 1.3752475, gradient norm = 0.0001477 (50 iterations in 0.051s)
[t-SNE] Iteration 700: error = 1.3732439, gradient norm = 0.0000893 (50 iterations in 0.052s)
[t-SNE] Iteration 750: error = 1.3730426, gradient norm = 0.0000460 (50 iterations in 0.054s)
[t-SNE] Iteration 800: error = 1.3728690, gradient norm = 0.0000570 (50 iterations in 0.051s)
[t-SNE] Iteration 850: error = 1.3728639, gradient norm = 0.0000518 (50 iterations in 0.051s)
[t-SNE] Iteration 900: error = 1.3728459, gradient norm = 0.0000284 (50 iterations in 0.051s)
[t-SNE] Iteration 950: error = 1.3727894, gradient norm = 0.0000421 (50 iterations in 0.052s)
[t-SNE] Iteration 1000: error = 1.3727219, gradient norm = 0.0000683 (50 iterations in 0.051s)
[t-SNE] KL divergence after 1000 iterations: 1.372722
[t-SNE] Computed conditional probabilities for sample 554 / 554
[t-SNE] Mean sigma: 0.370136
Beginning preprocessing + Leiden
2024-03-13 18:29:35.385220 MEMORY 16.751845376
Affmat transformed
2024-03-13 18:29:35.392145 MEMORY 16.751845376
sources, targets, weights extracted
2024-03-13 18:29:35.395786 MEMORY 16.751845376
About to launch parallel Leiden runs
2024-03-13 18:29:35.401724 MEMORY 16.751845376
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.5s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    4.5s finished
Parallel Leiden runs finished
2024-03-13 18:29:39.900573 MEMORY 16.751845376
Quality: 0.4034281168841178
Quality: 0.40406765484839907
Quality: 0.4043921923450959
Quality: 0.40515167299072635
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 532 out of 532 | elapsed:    0.1s finished
Got subclusters: Counter({0: 152, 1: 105, 2: 87, 3: 84, 5: 63, 4: 63})
On pattern 5
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 532 samples in 0.004s...
[t-SNE] Computed neighbors for 532 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 532 / 532
[t-SNE] Mean sigma: 0.340493
[t-SNE] Computed conditional probabilities in 0.036s
[t-SNE] Iteration 50: error = 68.5010223, gradient norm = 0.4544257 (50 iterations in 0.053s)
[t-SNE] Iteration 100: error = 71.5544586, gradient norm = 0.4029940 (50 iterations in 0.054s)
[t-SNE] Iteration 150: error = 70.2926636, gradient norm = 0.4265901 (50 iterations in 0.054s)
[t-SNE] Iteration 200: error = 69.0552826, gradient norm = 0.4284154 (50 iterations in 0.056s)
[t-SNE] Iteration 250: error = 69.1752853, gradient norm = 0.4473798 (50 iterations in 0.054s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 69.175285
[t-SNE] Iteration 300: error = 1.4173732, gradient norm = 0.0027928 (50 iterations in 0.052s)
[t-SNE] Iteration 350: error = 1.3770686, gradient norm = 0.0007177 (50 iterations in 0.051s)
[t-SNE] Iteration 400: error = 1.3579961, gradient norm = 0.0007722 (50 iterations in 0.051s)
[t-SNE] Iteration 450: error = 1.3429141, gradient norm = 0.0005364 (50 iterations in 0.050s)
[t-SNE] Iteration 500: error = 1.3306012, gradient norm = 0.0005015 (50 iterations in 0.051s)
[t-SNE] Iteration 550: error = 1.2947730, gradient norm = 0.0016595 (50 iterations in 0.050s)
[t-SNE] Iteration 600: error = 1.2731589, gradient norm = 0.0003763 (50 iterations in 0.051s)
[t-SNE] Iteration 650: error = 1.2632269, gradient norm = 0.0003700 (50 iterations in 0.050s)
[t-SNE] Iteration 700: error = 1.2576632, gradient norm = 0.0003173 (50 iterations in 0.051s)
[t-SNE] Iteration 750: error = 1.2530749, gradient norm = 0.0002561 (50 iterations in 0.050s)
[t-SNE] Iteration 800: error = 1.2509559, gradient norm = 0.0002797 (50 iterations in 0.050s)
[t-SNE] Iteration 850: error = 1.2458550, gradient norm = 0.0001031 (50 iterations in 0.052s)
[t-SNE] Iteration 900: error = 1.2456104, gradient norm = 0.0000758 (50 iterations in 0.051s)
[t-SNE] Iteration 950: error = 1.2452035, gradient norm = 0.0000721 (50 iterations in 0.050s)
[t-SNE] Iteration 1000: error = 1.2451780, gradient norm = 0.0000354 (50 iterations in 0.050s)
[t-SNE] KL divergence after 1000 iterations: 1.245178
[t-SNE] Computed conditional probabilities for sample 532 / 532
[t-SNE] Mean sigma: 0.340493
Beginning preprocessing + Leiden
2024-03-13 18:29:41.707343 MEMORY 16.751853568
Affmat transformed
2024-03-13 18:29:41.714165 MEMORY 16.751853568
sources, targets, weights extracted
2024-03-13 18:29:41.718402 MEMORY 16.751853568
About to launch parallel Leiden runs
2024-03-13 18:29:41.724052 MEMORY 16.751853568
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.4s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    4.4s finished
Parallel Leiden runs finished
2024-03-13 18:29:46.150751 MEMORY 16.751853568
Quality: 0.3972442372005879
Quality: 0.39726542091541817
Quality: 0.3979754828603388
Quality: 0.3993131251148163
Quality: 0.3994099697751717
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 344 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 507 out of 507 | elapsed:    0.2s finished
Got subclusters: Counter({0: 112, 1: 103, 2: 91, 3: 89, 4: 69, 5: 41, 6: 23, 7: 4})
On pattern 6
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 507 samples in 0.003s...
[t-SNE] Computed neighbors for 507 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 507 / 507
[t-SNE] Mean sigma: 0.339703
[t-SNE] Computed conditional probabilities in 0.034s
[t-SNE] Iteration 50: error = 67.9610367, gradient norm = 0.4636256 (50 iterations in 0.055s)
[t-SNE] Iteration 100: error = 71.0805359, gradient norm = 0.4359754 (50 iterations in 0.052s)
[t-SNE] Iteration 150: error = 70.4903412, gradient norm = 0.4528395 (50 iterations in 0.053s)
[t-SNE] Iteration 200: error = 71.4687271, gradient norm = 0.4211606 (50 iterations in 0.053s)
[t-SNE] Iteration 250: error = 72.8920670, gradient norm = 0.4139146 (50 iterations in 0.055s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 72.892067
[t-SNE] Iteration 300: error = 1.4465839, gradient norm = 0.0039192 (50 iterations in 0.050s)
[t-SNE] Iteration 350: error = 1.3818238, gradient norm = 0.0014592 (50 iterations in 0.050s)
[t-SNE] Iteration 400: error = 1.3580796, gradient norm = 0.0007909 (50 iterations in 0.050s)
[t-SNE] Iteration 450: error = 1.3380848, gradient norm = 0.0011161 (50 iterations in 0.050s)
[t-SNE] Iteration 500: error = 1.3195342, gradient norm = 0.0006793 (50 iterations in 0.050s)
[t-SNE] Iteration 550: error = 1.3044655, gradient norm = 0.0013805 (50 iterations in 0.051s)
[t-SNE] Iteration 600: error = 1.2938821, gradient norm = 0.0002651 (50 iterations in 0.051s)
[t-SNE] Iteration 650: error = 1.2923934, gradient norm = 0.0002683 (50 iterations in 0.050s)
[t-SNE] Iteration 700: error = 1.2914697, gradient norm = 0.0002256 (50 iterations in 0.052s)
[t-SNE] Iteration 750: error = 1.2903519, gradient norm = 0.0001113 (50 iterations in 0.051s)
[t-SNE] Iteration 800: error = 1.2899734, gradient norm = 0.0000696 (50 iterations in 0.050s)
[t-SNE] Iteration 850: error = 1.2901269, gradient norm = 0.0000718 (50 iterations in 0.050s)
[t-SNE] Iteration 900: error = 1.2899712, gradient norm = 0.0000766 (50 iterations in 0.050s)
[t-SNE] Iteration 950: error = 1.2899699, gradient norm = 0.0000607 (50 iterations in 0.050s)
[t-SNE] Iteration 1000: error = 1.2900137, gradient norm = 0.0000527 (50 iterations in 0.049s)
[t-SNE] KL divergence after 1000 iterations: 1.290014
[t-SNE] Computed conditional probabilities for sample 507 / 507
[t-SNE] Mean sigma: 0.339703
Beginning preprocessing + Leiden
2024-03-13 18:29:47.965844 MEMORY 16.751890432
Affmat transformed
2024-03-13 18:29:47.972381 MEMORY 16.751890432
sources, targets, weights extracted
2024-03-13 18:29:47.976245 MEMORY 16.751890432
About to launch parallel Leiden runs
2024-03-13 18:29:48.000857 MEMORY 16.751890432
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.4s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    4.4s finished
Parallel Leiden runs finished
2024-03-13 18:29:52.381677 MEMORY 16.751890432
Quality: 0.3644123476939278
Quality: 0.3713576042941361
Quality: 0.37204944987319966
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 344 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 485 out of 485 | elapsed:    0.2s finished
Got subclusters: Counter({0: 123, 1: 88, 2: 86, 3: 75, 4: 57, 5: 56, 6: 22})
On pattern 7
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 485 samples in 0.003s...
[t-SNE] Computed neighbors for 485 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 485 / 485
[t-SNE] Mean sigma: 0.369399
[t-SNE] Computed conditional probabilities in 0.032s
[t-SNE] Iteration 50: error = 67.0736923, gradient norm = 0.4764017 (50 iterations in 0.054s)
[t-SNE] Iteration 100: error = 68.5777435, gradient norm = 0.4520477 (50 iterations in 0.050s)
[t-SNE] Iteration 150: error = 68.7384415, gradient norm = 0.4669131 (50 iterations in 0.050s)
[t-SNE] Iteration 200: error = 69.4555511, gradient norm = 0.4244225 (50 iterations in 0.053s)
[t-SNE] Iteration 250: error = 67.6606140, gradient norm = 0.4753618 (50 iterations in 0.049s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 67.660614
[t-SNE] Iteration 300: error = 1.4213027, gradient norm = 0.0028658 (50 iterations in 0.050s)
[t-SNE] Iteration 350: error = 1.3414799, gradient norm = 0.0016159 (50 iterations in 0.047s)
[t-SNE] Iteration 400: error = 1.3156397, gradient norm = 0.0015393 (50 iterations in 0.048s)
[t-SNE] Iteration 450: error = 1.3097587, gradient norm = 0.0002296 (50 iterations in 0.047s)
[t-SNE] Iteration 500: error = 1.3066797, gradient norm = 0.0002631 (50 iterations in 0.047s)
[t-SNE] Iteration 550: error = 1.3030807, gradient norm = 0.0004373 (50 iterations in 0.050s)
[t-SNE] Iteration 600: error = 1.3004613, gradient norm = 0.0002160 (50 iterations in 0.047s)
[t-SNE] Iteration 650: error = 1.2969612, gradient norm = 0.0002149 (50 iterations in 0.047s)
[t-SNE] Iteration 700: error = 1.2946159, gradient norm = 0.0002283 (50 iterations in 0.049s)
[t-SNE] Iteration 750: error = 1.2936517, gradient norm = 0.0001729 (50 iterations in 0.047s)
[t-SNE] Iteration 800: error = 1.2935202, gradient norm = 0.0000616 (50 iterations in 0.048s)
[t-SNE] Iteration 850: error = 1.2934155, gradient norm = 0.0000647 (50 iterations in 0.047s)
[t-SNE] Iteration 900: error = 1.2934287, gradient norm = 0.0000583 (50 iterations in 0.047s)
[t-SNE] Iteration 950: error = 1.2932088, gradient norm = 0.0000848 (50 iterations in 0.047s)
[t-SNE] Iteration 1000: error = 1.2929277, gradient norm = 0.0000463 (50 iterations in 0.047s)
[t-SNE] KL divergence after 1000 iterations: 1.292928
[t-SNE] Computed conditional probabilities for sample 485 / 485
[t-SNE] Mean sigma: 0.369399
Beginning preprocessing + Leiden
2024-03-13 18:29:54.089304 MEMORY 16.751890432
Affmat transformed
2024-03-13 18:29:54.095401 MEMORY 16.751890432
sources, targets, weights extracted
2024-03-13 18:29:54.098558 MEMORY 16.751890432
About to launch parallel Leiden runs
2024-03-13 18:29:54.146917 MEMORY 16.75188224
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.3s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    4.0s finished
Parallel Leiden runs finished
2024-03-13 18:29:58.186899 MEMORY 16.75188224
Quality: 0.3965236869182974
Quality: 0.397839030739222
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 344 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 419 out of 419 | elapsed:    0.1s finished
Got subclusters: Counter({0: 132, 1: 109, 2: 93, 3: 75, 4: 54, 5: 15, 6: 7})
On pattern 8
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 419 samples in 0.003s...
[t-SNE] Computed neighbors for 419 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 419 / 419
[t-SNE] Mean sigma: 0.369119
[t-SNE] Computed conditional probabilities in 0.028s
[t-SNE] Iteration 50: error = 64.6429672, gradient norm = 0.4827132 (50 iterations in 0.045s)
[t-SNE] Iteration 100: error = 65.1612396, gradient norm = 0.4974604 (50 iterations in 0.044s)
[t-SNE] Iteration 150: error = 67.8394165, gradient norm = 0.4682052 (50 iterations in 0.045s)
[t-SNE] Iteration 200: error = 68.7353745, gradient norm = 0.4581877 (50 iterations in 0.046s)
[t-SNE] Iteration 250: error = 67.5692825, gradient norm = 0.4664075 (50 iterations in 0.044s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 67.569283
[t-SNE] Iteration 300: error = 1.3514038, gradient norm = 0.0038926 (50 iterations in 0.042s)
[t-SNE] Iteration 350: error = 1.2524054, gradient norm = 0.0017962 (50 iterations in 0.042s)
[t-SNE] Iteration 400: error = 1.2190329, gradient norm = 0.0011260 (50 iterations in 0.042s)
[t-SNE] Iteration 450: error = 1.1970909, gradient norm = 0.0008722 (50 iterations in 0.041s)
[t-SNE] Iteration 500: error = 1.1815330, gradient norm = 0.0005246 (50 iterations in 0.042s)
[t-SNE] Iteration 550: error = 1.1660042, gradient norm = 0.0015949 (50 iterations in 0.042s)
[t-SNE] Iteration 600: error = 1.1457124, gradient norm = 0.0011449 (50 iterations in 0.042s)
[t-SNE] Iteration 650: error = 1.1329668, gradient norm = 0.0005418 (50 iterations in 0.042s)
[t-SNE] Iteration 700: error = 1.1300889, gradient norm = 0.0004175 (50 iterations in 0.042s)
[t-SNE] Iteration 750: error = 1.1264508, gradient norm = 0.0001575 (50 iterations in 0.042s)
[t-SNE] Iteration 800: error = 1.1252679, gradient norm = 0.0001534 (50 iterations in 0.042s)
[t-SNE] Iteration 850: error = 1.1235992, gradient norm = 0.0003256 (50 iterations in 0.042s)
[t-SNE] Iteration 900: error = 1.1238049, gradient norm = 0.0001242 (50 iterations in 0.041s)
[t-SNE] Iteration 950: error = 1.1232105, gradient norm = 0.0000917 (50 iterations in 0.042s)
[t-SNE] Iteration 1000: error = 1.1230028, gradient norm = 0.0000525 (50 iterations in 0.041s)
[t-SNE] KL divergence after 1000 iterations: 1.123003
[t-SNE] Computed conditional probabilities for sample 419 / 419
[t-SNE] Mean sigma: 0.369119
Beginning preprocessing + Leiden
2024-03-13 18:29:59.663036 MEMORY 16.75188224
Affmat transformed
2024-03-13 18:29:59.668474 MEMORY 16.75188224
sources, targets, weights extracted
2024-03-13 18:29:59.671213 MEMORY 16.75188224
About to launch parallel Leiden runs
2024-03-13 18:29:59.696914 MEMORY 16.751886336
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.2s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    3.7s finished
Parallel Leiden runs finished
2024-03-13 18:30:03.415214 MEMORY 16.751886336
Quality: 0.3737009719799285
Quality: 0.37373332068746856
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 344 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 409 out of 409 | elapsed:    0.1s finished
Got subclusters: Counter({0: 96, 1: 96, 2: 68, 3: 62, 4: 58, 5: 39})
On pattern 9
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 409 samples in 0.003s...
[t-SNE] Computed neighbors for 409 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 409 / 409
[t-SNE] Mean sigma: 0.343828
[t-SNE] Computed conditional probabilities in 0.027s
[t-SNE] Iteration 50: error = 64.0522385, gradient norm = 0.5273188 (50 iterations in 0.068s)
[t-SNE] Iteration 100: error = 68.5439301, gradient norm = 0.4618277 (50 iterations in 0.047s)
[t-SNE] Iteration 150: error = 68.8740845, gradient norm = 0.4500173 (50 iterations in 0.046s)
[t-SNE] Iteration 200: error = 67.5222397, gradient norm = 0.4805569 (50 iterations in 0.046s)
[t-SNE] Iteration 250: error = 67.6535034, gradient norm = 0.4749334 (50 iterations in 0.046s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 67.653503
[t-SNE] Iteration 300: error = 1.2448583, gradient norm = 0.0043734 (50 iterations in 0.044s)
[t-SNE] Iteration 350: error = 1.1490408, gradient norm = 0.0015684 (50 iterations in 0.044s)
[t-SNE] Iteration 400: error = 1.1169002, gradient norm = 0.0009007 (50 iterations in 0.043s)
[t-SNE] Iteration 450: error = 1.0880371, gradient norm = 0.0007315 (50 iterations in 0.043s)
[t-SNE] Iteration 500: error = 1.0523999, gradient norm = 0.0010445 (50 iterations in 0.043s)
[t-SNE] Iteration 550: error = 1.0281786, gradient norm = 0.0007857 (50 iterations in 0.043s)
[t-SNE] Iteration 600: error = 1.0175409, gradient norm = 0.0004019 (50 iterations in 0.043s)
[t-SNE] Iteration 650: error = 1.0161614, gradient norm = 0.0001492 (50 iterations in 0.043s)
[t-SNE] Iteration 700: error = 1.0159105, gradient norm = 0.0001009 (50 iterations in 0.044s)
[t-SNE] Iteration 750: error = 1.0160218, gradient norm = 0.0000331 (50 iterations in 0.045s)
[t-SNE] Iteration 800: error = 1.0159618, gradient norm = 0.0000541 (50 iterations in 0.043s)
[t-SNE] Iteration 850: error = 1.0159466, gradient norm = 0.0000343 (50 iterations in 0.043s)
[t-SNE] Iteration 900: error = 1.0159253, gradient norm = 0.0000438 (50 iterations in 0.043s)
[t-SNE] Iteration 950: error = 1.0159458, gradient norm = 0.0000530 (50 iterations in 0.043s)
[t-SNE] Iteration 1000: error = 1.0159092, gradient norm = 0.0000407 (50 iterations in 0.045s)
[t-SNE] KL divergence after 1000 iterations: 1.015909
[t-SNE] Computed conditional probabilities for sample 409 / 409
[t-SNE] Mean sigma: 0.343828
Beginning preprocessing + Leiden
2024-03-13 18:30:04.960000 MEMORY 16.75190272
Affmat transformed
2024-03-13 18:30:04.966071 MEMORY 16.75190272
sources, targets, weights extracted
2024-03-13 18:30:04.969265 MEMORY 16.75190272
About to launch parallel Leiden runs
2024-03-13 18:30:04.974397 MEMORY 16.75190272
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.1s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    3.4s finished
Parallel Leiden runs finished
2024-03-13 18:30:08.330782 MEMORY 16.75190272
Quality: 0.38775595144685293
Quality: 0.39160372576443675
Quality: 0.39287681857199935
Quality: 0.393289431525837
Quality: 0.39344282663457425
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 344 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 398 out of 398 | elapsed:    0.1s finished
Got subclusters: Counter({0: 104, 1: 87, 2: 85, 3: 80, 4: 51, 5: 2})
On pattern 10
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 398 samples in 0.003s...
[t-SNE] Computed neighbors for 398 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 398 / 398
[t-SNE] Mean sigma: 0.326243
[t-SNE] Computed conditional probabilities in 0.028s
[t-SNE] Iteration 50: error = 61.9031754, gradient norm = 0.5017064 (50 iterations in 0.046s)
[t-SNE] Iteration 100: error = 64.7389832, gradient norm = 0.4855879 (50 iterations in 0.046s)
[t-SNE] Iteration 150: error = 65.5356140, gradient norm = 0.4965384 (50 iterations in 0.047s)
[t-SNE] Iteration 200: error = 66.3981934, gradient norm = 0.4725685 (50 iterations in 0.046s)
[t-SNE] Iteration 250: error = 64.9422531, gradient norm = 0.4875298 (50 iterations in 0.047s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 64.942253
[t-SNE] Iteration 300: error = 1.1126055, gradient norm = 0.0044241 (50 iterations in 0.047s)
[t-SNE] Iteration 350: error = 0.9824873, gradient norm = 0.0019703 (50 iterations in 0.046s)
[t-SNE] Iteration 400: error = 0.9067176, gradient norm = 0.0018978 (50 iterations in 0.046s)
[t-SNE] Iteration 450: error = 0.8818038, gradient norm = 0.0007706 (50 iterations in 0.048s)
[t-SNE] Iteration 500: error = 0.8784890, gradient norm = 0.0001906 (50 iterations in 0.045s)
[t-SNE] Iteration 550: error = 0.8778903, gradient norm = 0.0001673 (50 iterations in 0.045s)
[t-SNE] Iteration 600: error = 0.8765250, gradient norm = 0.0000870 (50 iterations in 0.045s)
[t-SNE] Iteration 650: error = 0.8766788, gradient norm = 0.0000902 (50 iterations in 0.045s)
[t-SNE] Iteration 700: error = 0.8759993, gradient norm = 0.0005407 (50 iterations in 0.046s)
[t-SNE] Iteration 750: error = 0.8749277, gradient norm = 0.0002491 (50 iterations in 0.046s)
[t-SNE] Iteration 800: error = 0.8746612, gradient norm = 0.0000732 (50 iterations in 0.046s)
[t-SNE] Iteration 850: error = 0.8745648, gradient norm = 0.0000594 (50 iterations in 0.045s)
[t-SNE] Iteration 900: error = 0.8744140, gradient norm = 0.0000483 (50 iterations in 0.042s)
[t-SNE] Iteration 950: error = 0.8744032, gradient norm = 0.0000829 (50 iterations in 0.042s)
[t-SNE] Iteration 1000: error = 0.8744777, gradient norm = 0.0000463 (50 iterations in 0.042s)
[t-SNE] KL divergence after 1000 iterations: 0.874478
Warning: each seqlet is not its own nearest neighbor; there may be duplicates
[t-SNE] Computed conditional probabilities for sample 398 / 398
[t-SNE] Mean sigma: 0.326243
Beginning preprocessing + Leiden
2024-03-13 18:30:09.835740 MEMORY 16.751910912
Affmat transformed
2024-03-13 18:30:09.841456 MEMORY 16.751910912
sources, targets, weights extracted
2024-03-13 18:30:09.844318 MEMORY 16.751910912
About to launch parallel Leiden runs
2024-03-13 18:30:09.849858 MEMORY 16.751910912
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.1s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    3.3s finished
Parallel Leiden runs finished
2024-03-13 18:30:13.147779 MEMORY 16.751910912
Quality: 0.4254355492450362
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 318 out of 318 | elapsed:    0.1s finished
Got subclusters: Counter({0: 98, 1: 77, 2: 60, 3: 50, 4: 39, 5: 38, 6: 36})
On pattern 11
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 318 samples in 0.002s...
[t-SNE] Computed neighbors for 318 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 318 / 318
[t-SNE] Mean sigma: 0.350589
[t-SNE] Computed conditional probabilities in 0.022s
[t-SNE] Iteration 50: error = 64.7307281, gradient norm = 0.4859181 (50 iterations in 0.037s)
[t-SNE] Iteration 100: error = 67.6295547, gradient norm = 0.4677234 (50 iterations in 0.037s)
[t-SNE] Iteration 150: error = 65.7844467, gradient norm = 0.5048775 (50 iterations in 0.037s)
[t-SNE] Iteration 200: error = 65.7155914, gradient norm = 0.4808934 (50 iterations in 0.037s)
[t-SNE] Iteration 250: error = 65.7370453, gradient norm = 0.4819158 (50 iterations in 0.038s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 65.737045
[t-SNE] Iteration 300: error = 1.2509816, gradient norm = 0.0052646 (50 iterations in 0.041s)
[t-SNE] Iteration 350: error = 1.1373564, gradient norm = 0.0024738 (50 iterations in 0.035s)
[t-SNE] Iteration 400: error = 1.0898871, gradient norm = 0.0014185 (50 iterations in 0.035s)
[t-SNE] Iteration 450: error = 1.0766358, gradient norm = 0.0006091 (50 iterations in 0.036s)
[t-SNE] Iteration 500: error = 1.0729091, gradient norm = 0.0003329 (50 iterations in 0.035s)
[t-SNE] Iteration 550: error = 1.0711339, gradient norm = 0.0003631 (50 iterations in 0.035s)
[t-SNE] Iteration 600: error = 1.0690677, gradient norm = 0.0003578 (50 iterations in 0.038s)
[t-SNE] Iteration 650: error = 1.0627669, gradient norm = 0.0010161 (50 iterations in 0.035s)
[t-SNE] Iteration 700: error = 1.0574921, gradient norm = 0.0001761 (50 iterations in 0.035s)
[t-SNE] Iteration 750: error = 1.0571235, gradient norm = 0.0001181 (50 iterations in 0.035s)
[t-SNE] Iteration 800: error = 1.0572444, gradient norm = 0.0001075 (50 iterations in 0.035s)
[t-SNE] Iteration 850: error = 1.0571649, gradient norm = 0.0000910 (50 iterations in 0.038s)
[t-SNE] Iteration 900: error = 1.0571792, gradient norm = 0.0000827 (50 iterations in 0.035s)
[t-SNE] Iteration 950: error = 1.0572320, gradient norm = 0.0000649 (50 iterations in 0.035s)
[t-SNE] Iteration 1000: error = 1.0570991, gradient norm = 0.0000809 (50 iterations in 0.038s)
[t-SNE] KL divergence after 1000 iterations: 1.057099
[t-SNE] Computed conditional probabilities for sample 318 / 318
[t-SNE] Mean sigma: 0.350589
Beginning preprocessing + Leiden
2024-03-13 18:30:14.387558 MEMORY 16.75194368
Affmat transformed
2024-03-13 18:30:14.391899 MEMORY 16.75194368
sources, targets, weights extracted
2024-03-13 18:30:14.393989 MEMORY 16.75194368
About to launch parallel Leiden runs
2024-03-13 18:30:14.399060 MEMORY 16.75194368
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.0s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    3.0s finished
Parallel Leiden runs finished
2024-03-13 18:30:17.402483 MEMORY 16.75194368
Quality: 0.34269756917783856
Quality: 0.34371732115949055
Quality: 0.34529273763891016
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 280 out of 280 | elapsed:    0.1s finished
Got subclusters: Counter({0: 64, 1: 63, 2: 56, 3: 45, 4: 43, 5: 24, 6: 23})
On pattern 12
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 280 samples in 0.002s...
[t-SNE] Computed neighbors for 280 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 280 / 280
[t-SNE] Mean sigma: 0.394168
[t-SNE] Computed conditional probabilities in 0.019s
[t-SNE] Iteration 50: error = 62.6343422, gradient norm = 0.4940147 (50 iterations in 0.037s)
[t-SNE] Iteration 100: error = 62.8698997, gradient norm = 0.5129691 (50 iterations in 0.035s)
[t-SNE] Iteration 150: error = 64.5165634, gradient norm = 0.4748128 (50 iterations in 0.035s)
[t-SNE] Iteration 200: error = 65.9681549, gradient norm = 0.4798625 (50 iterations in 0.037s)
[t-SNE] Iteration 250: error = 62.6805305, gradient norm = 0.5048211 (50 iterations in 0.034s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 62.680531
[t-SNE] Iteration 300: error = 1.0053579, gradient norm = 0.0049510 (50 iterations in 0.033s)
[t-SNE] Iteration 350: error = 0.8977808, gradient norm = 0.0015072 (50 iterations in 0.036s)
[t-SNE] Iteration 400: error = 0.8592385, gradient norm = 0.0019082 (50 iterations in 0.033s)
[t-SNE] Iteration 450: error = 0.8451366, gradient norm = 0.0002613 (50 iterations in 0.033s)
[t-SNE] Iteration 500: error = 0.8451385, gradient norm = 0.0000622 (50 iterations in 0.033s)
[t-SNE] Iteration 550: error = 0.8451815, gradient norm = 0.0000681 (50 iterations in 0.033s)
[t-SNE] Iteration 600: error = 0.8452153, gradient norm = 0.0000940 (50 iterations in 0.033s)
[t-SNE] Iteration 650: error = 0.8452891, gradient norm = 0.0000713 (50 iterations in 0.033s)
[t-SNE] Iteration 700: error = 0.8452917, gradient norm = 0.0000874 (50 iterations in 0.033s)
[t-SNE] Iteration 750: error = 0.8453066, gradient norm = 0.0000561 (50 iterations in 0.033s)
[t-SNE] Iteration 800: error = 0.8453636, gradient norm = 0.0000812 (50 iterations in 0.033s)
[t-SNE] Iteration 800: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 800 iterations: 0.845364
[t-SNE] Computed conditional probabilities for sample 280 / 280
[t-SNE] Mean sigma: 0.394168
Beginning preprocessing + Leiden
2024-03-13 18:30:18.370052 MEMORY 16.75194368
Affmat transformed
2024-03-13 18:30:18.373795 MEMORY 16.75194368
sources, targets, weights extracted
2024-03-13 18:30:18.375557 MEMORY 16.75194368
About to launch parallel Leiden runs
2024-03-13 18:30:18.396458 MEMORY 16.75194368
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.9s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.8s finished
Parallel Leiden runs finished
2024-03-13 18:30:21.202493 MEMORY 16.75194368
Quality: 0.35234664052109477
Quality: 0.3571768162692451
Quality: 0.3575860457400661
Quality: 0.3584203204290828
Quality: 0.3590227263558792
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 229 out of 229 | elapsed:    0.1s finished
Got subclusters: Counter({0: 87, 1: 74, 2: 62, 3: 38, 4: 19})
On pattern 13
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 229 samples in 0.002s...
[t-SNE] Computed neighbors for 229 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 229 / 229
[t-SNE] Mean sigma: 0.427566
[t-SNE] Computed conditional probabilities in 0.015s
[t-SNE] Iteration 50: error = 61.3098488, gradient norm = 0.5022959 (50 iterations in 0.031s)
[t-SNE] Iteration 100: error = 61.1071091, gradient norm = 0.5142456 (50 iterations in 0.029s)
[t-SNE] Iteration 150: error = 59.9699860, gradient norm = 0.5341928 (50 iterations in 0.029s)
[t-SNE] Iteration 200: error = 60.5953445, gradient norm = 0.5182948 (50 iterations in 0.030s)
[t-SNE] Iteration 250: error = 62.5334282, gradient norm = 0.4635452 (50 iterations in 0.029s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 62.533428
[t-SNE] Iteration 300: error = 1.0068848, gradient norm = 0.0068223 (50 iterations in 0.029s)
[t-SNE] Iteration 350: error = 0.8070930, gradient norm = 0.0020545 (50 iterations in 0.029s)
[t-SNE] Iteration 400: error = 0.7984520, gradient norm = 0.0002749 (50 iterations in 0.029s)
[t-SNE] Iteration 450: error = 0.7944951, gradient norm = 0.0010536 (50 iterations in 0.029s)
[t-SNE] Iteration 500: error = 0.7940273, gradient norm = 0.0000990 (50 iterations in 0.029s)
[t-SNE] Iteration 550: error = 0.7940819, gradient norm = 0.0001015 (50 iterations in 0.029s)
[t-SNE] Iteration 600: error = 0.7940558, gradient norm = 0.0000977 (50 iterations in 0.029s)
[t-SNE] Iteration 650: error = 0.7940845, gradient norm = 0.0001319 (50 iterations in 0.029s)
[t-SNE] Iteration 700: error = 0.7940883, gradient norm = 0.0001137 (50 iterations in 0.029s)
[t-SNE] Iteration 750: error = 0.7940798, gradient norm = 0.0001476 (50 iterations in 0.029s)
[t-SNE] Iteration 800: error = 0.7940775, gradient norm = 0.0001430 (50 iterations in 0.029s)
[t-SNE] Iteration 850: error = 0.7940341, gradient norm = 0.0000939 (50 iterations in 0.029s)
[t-SNE] Iteration 850: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 850 iterations: 0.794034
[t-SNE] Computed conditional probabilities for sample 229 / 229
[t-SNE] Mean sigma: 0.427565
Beginning preprocessing + Leiden
2024-03-13 18:30:22.068646 MEMORY 16.75194368
Affmat transformed
2024-03-13 18:30:22.071851 MEMORY 16.75194368
sources, targets, weights extracted
2024-03-13 18:30:22.073064 MEMORY 16.75194368
About to launch parallel Leiden runs
2024-03-13 18:30:22.077638 MEMORY 16.75194368
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.8s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.3s finished
Parallel Leiden runs finished
2024-03-13 18:30:24.386152 MEMORY 16.75194368
Quality: 0.38126613004943444
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 178 out of 178 | elapsed:    0.1s finished
Got subclusters: Counter({0: 65, 1: 57, 2: 56, 3: 51})
On pattern 14
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 178 samples in 0.002s...
[t-SNE] Computed neighbors for 178 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 178 / 178
[t-SNE] Mean sigma: 0.430830
[t-SNE] Computed conditional probabilities in 0.012s
[t-SNE] Iteration 50: error = 59.4738960, gradient norm = 0.4531594 (50 iterations in 0.026s)
[t-SNE] Iteration 100: error = 59.3646889, gradient norm = 0.4570219 (50 iterations in 0.026s)
[t-SNE] Iteration 150: error = 56.9189148, gradient norm = 0.5595261 (50 iterations in 0.026s)
[t-SNE] Iteration 200: error = 58.4424438, gradient norm = 0.5480605 (50 iterations in 0.026s)
[t-SNE] Iteration 250: error = 59.2482758, gradient norm = 0.5098552 (50 iterations in 0.026s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 59.248276
[t-SNE] Iteration 300: error = 0.7770737, gradient norm = 0.0082843 (50 iterations in 0.025s)
[t-SNE] Iteration 350: error = 0.6227444, gradient norm = 0.0067624 (50 iterations in 0.025s)
[t-SNE] Iteration 400: error = 0.5918527, gradient norm = 0.0027394 (50 iterations in 0.025s)
[t-SNE] Iteration 450: error = 0.5886648, gradient norm = 0.0008840 (50 iterations in 0.026s)
[t-SNE] Iteration 500: error = 0.5763868, gradient norm = 0.0002977 (50 iterations in 0.025s)
[t-SNE] Iteration 550: error = 0.5762601, gradient norm = 0.0002078 (50 iterations in 0.025s)
[t-SNE] Iteration 600: error = 0.5762014, gradient norm = 0.0002092 (50 iterations in 0.025s)
[t-SNE] Iteration 650: error = 0.5763955, gradient norm = 0.0002509 (50 iterations in 0.025s)
[t-SNE] Iteration 700: error = 0.5762541, gradient norm = 0.0003785 (50 iterations in 0.025s)
[t-SNE] Iteration 750: error = 0.5763212, gradient norm = 0.0002269 (50 iterations in 0.025s)
[t-SNE] Iteration 800: error = 0.5763606, gradient norm = 0.0001785 (50 iterations in 0.025s)
[t-SNE] Iteration 850: error = 0.5762540, gradient norm = 0.0001899 (50 iterations in 0.025s)
[t-SNE] Iteration 900: error = 0.5762836, gradient norm = 0.0001947 (50 iterations in 0.025s)
[t-SNE] Iteration 950: error = 0.5760261, gradient norm = 0.0002037 (50 iterations in 0.025s)
[t-SNE] Iteration 1000: error = 0.5763038, gradient norm = 0.0001900 (50 iterations in 0.025s)
[t-SNE] KL divergence after 1000 iterations: 0.576304
[t-SNE] Computed conditional probabilities for sample 178 / 178
[t-SNE] Mean sigma: 0.430830
Beginning preprocessing + Leiden
2024-03-13 18:30:25.174199 MEMORY 16.75194368
Affmat transformed
2024-03-13 18:30:25.176790 MEMORY 16.75194368
sources, targets, weights extracted
2024-03-13 18:30:25.177761 MEMORY 16.75194368
About to launch parallel Leiden runs
2024-03-13 18:30:25.195399 MEMORY 16.75194368
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.1s finished
Parallel Leiden runs finished
2024-03-13 18:30:27.335534 MEMORY 16.75194368
Quality: 0.34612087825834387
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 168 out of 168 | elapsed:    0.1s finished
Got subclusters: Counter({0: 43, 1: 41, 2: 36, 3: 33, 4: 25})
On pattern 15
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 168 samples in 0.001s...
[t-SNE] Computed neighbors for 168 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 168 / 168
[t-SNE] Mean sigma: 0.438926
[t-SNE] Computed conditional probabilities in 0.011s
[t-SNE] Iteration 50: error = 57.3980103, gradient norm = 0.5155212 (50 iterations in 0.028s)
[t-SNE] Iteration 100: error = 55.9403992, gradient norm = 0.5123174 (50 iterations in 0.025s)
[t-SNE] Iteration 150: error = 54.9391136, gradient norm = 0.4886172 (50 iterations in 0.025s)
[t-SNE] Iteration 200: error = 56.8056755, gradient norm = 0.4976542 (50 iterations in 0.026s)
[t-SNE] Iteration 250: error = 55.8524208, gradient norm = 0.5481812 (50 iterations in 0.025s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 55.852421
[t-SNE] Iteration 300: error = 0.7319728, gradient norm = 0.0054415 (50 iterations in 0.026s)
[t-SNE] Iteration 350: error = 0.5720187, gradient norm = 0.0028606 (50 iterations in 0.026s)
[t-SNE] Iteration 400: error = 0.5390519, gradient norm = 0.0014185 (50 iterations in 0.026s)
[t-SNE] Iteration 450: error = 0.5287452, gradient norm = 0.0004752 (50 iterations in 0.025s)
[t-SNE] Iteration 500: error = 0.5291645, gradient norm = 0.0001982 (50 iterations in 0.026s)
[t-SNE] Iteration 550: error = 0.5291100, gradient norm = 0.0001087 (50 iterations in 0.026s)
[t-SNE] Iteration 600: error = 0.5291460, gradient norm = 0.0001409 (50 iterations in 0.025s)
[t-SNE] Iteration 650: error = 0.5291447, gradient norm = 0.0001436 (50 iterations in 0.025s)
[t-SNE] Iteration 700: error = 0.5290845, gradient norm = 0.0001465 (50 iterations in 0.025s)
[t-SNE] Iteration 750: error = 0.5291372, gradient norm = 0.0001427 (50 iterations in 0.027s)
[t-SNE] Iteration 800: error = 0.5292220, gradient norm = 0.0002342 (50 iterations in 0.028s)
[t-SNE] Iteration 800: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 800 iterations: 0.529222
[t-SNE] Computed conditional probabilities for sample 168 / 168
[t-SNE] Mean sigma: 0.438926
Beginning preprocessing + Leiden
2024-03-13 18:30:28.021796 MEMORY 16.75194368
Affmat transformed
2024-03-13 18:30:28.024630 MEMORY 16.75194368
sources, targets, weights extracted
2024-03-13 18:30:28.025605 MEMORY 16.75194368
About to launch parallel Leiden runs
2024-03-13 18:30:28.053382 MEMORY 16.75194368
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.1s finished
Parallel Leiden runs finished
2024-03-13 18:30:30.192024 MEMORY 16.75194368
Quality: 0.31080697146667224
Quality: 0.3121505290250521
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 106 out of 153 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=24)]: Done 153 out of 153 | elapsed:    0.1s finished
Got subclusters: Counter({0: 48, 1: 36, 2: 35, 3: 27, 4: 22})
On pattern 16
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 153 samples in 0.001s...
[t-SNE] Computed neighbors for 153 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 153 / 153
[t-SNE] Mean sigma: 0.436130
[t-SNE] Computed conditional probabilities in 0.010s
[t-SNE] Iteration 50: error = 56.0189896, gradient norm = 0.5395110 (50 iterations in 0.026s)
[t-SNE] Iteration 100: error = 55.7777290, gradient norm = 0.5497505 (50 iterations in 0.024s)
[t-SNE] Iteration 150: error = 56.5519562, gradient norm = 0.5257254 (50 iterations in 0.024s)
[t-SNE] Iteration 200: error = 55.2865753, gradient norm = 0.5786511 (50 iterations in 0.024s)
[t-SNE] Iteration 250: error = 57.3898430, gradient norm = 0.4867751 (50 iterations in 0.024s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 57.389843
[t-SNE] Iteration 300: error = 0.7638336, gradient norm = 0.0103984 (50 iterations in 0.024s)
[t-SNE] Iteration 350: error = 0.5829352, gradient norm = 0.0021377 (50 iterations in 0.023s)
[t-SNE] Iteration 400: error = 0.5821181, gradient norm = 0.0003144 (50 iterations in 0.023s)
[t-SNE] Iteration 450: error = 0.5819373, gradient norm = 0.0003723 (50 iterations in 0.023s)
[t-SNE] Iteration 500: error = 0.5818025, gradient norm = 0.0003201 (50 iterations in 0.023s)
[t-SNE] Iteration 550: error = 0.5819515, gradient norm = 0.0002278 (50 iterations in 0.023s)
[t-SNE] Iteration 600: error = 0.5818412, gradient norm = 0.0003065 (50 iterations in 0.023s)
[t-SNE] Iteration 650: error = 0.5818754, gradient norm = 0.0003559 (50 iterations in 0.023s)
[t-SNE] Iteration 700: error = 0.5819847, gradient norm = 0.0003445 (50 iterations in 0.023s)
[t-SNE] Iteration 750: error = 0.5820156, gradient norm = 0.0002588 (50 iterations in 0.023s)
[t-SNE] Iteration 800: error = 0.5819371, gradient norm = 0.0002273 (50 iterations in 0.024s)
[t-SNE] Iteration 850: error = 0.5818337, gradient norm = 0.0003582 (50 iterations in 0.023s)
[t-SNE] Iteration 850: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 850 iterations: 0.581834
[t-SNE] Computed conditional probabilities for sample 153 / 153
[t-SNE] Mean sigma: 0.436130
Beginning preprocessing + Leiden
2024-03-13 18:30:30.827262 MEMORY 16.75194368
Affmat transformed
2024-03-13 18:30:30.829492 MEMORY 16.75194368
sources, targets, weights extracted
2024-03-13 18:30:30.830265 MEMORY 16.75194368
About to launch parallel Leiden runs
2024-03-13 18:30:30.834931 MEMORY 16.75194368
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.0s finished
Parallel Leiden runs finished
2024-03-13 18:30:32.837105 MEMORY 16.75194368
Quality: 0.27093317662774247
Quality: 0.27348560285757206
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 102 out of 102 | elapsed:    0.0s finished
Got subclusters: Counter({0: 43, 1: 30, 2: 26, 3: 21, 4: 19, 5: 14})
On pattern 17
[t-SNE] Computing 101 nearest neighbors...
[t-SNE] Indexed 102 samples in 0.001s...
[t-SNE] Computed neighbors for 102 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 102 / 102
[t-SNE] Mean sigma: 0.503927
[t-SNE] Computed conditional probabilities in 0.005s
[t-SNE] Iteration 50: error = 50.4467392, gradient norm = 0.5282806 (50 iterations in 0.018s)
[t-SNE] Iteration 100: error = 48.1527290, gradient norm = 0.5423961 (50 iterations in 0.017s)
[t-SNE] Iteration 150: error = 52.6188774, gradient norm = 0.5027309 (50 iterations in 0.017s)
[t-SNE] Iteration 200: error = 49.8580437, gradient norm = 0.5679951 (50 iterations in 0.017s)
[t-SNE] Iteration 250: error = 52.3706284, gradient norm = 0.5354521 (50 iterations in 0.017s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 52.370628
[t-SNE] Iteration 300: error = 0.7180662, gradient norm = 0.0080341 (50 iterations in 0.018s)
[t-SNE] Iteration 350: error = 0.3373069, gradient norm = 0.0112485 (50 iterations in 0.019s)
[t-SNE] Iteration 400: error = 0.3248494, gradient norm = 0.0010424 (50 iterations in 0.020s)
[t-SNE] Iteration 450: error = 0.3241366, gradient norm = 0.0003812 (50 iterations in 0.019s)
[t-SNE] Iteration 500: error = 0.3240032, gradient norm = 0.0002698 (50 iterations in 0.018s)
[t-SNE] Iteration 550: error = 0.3240952, gradient norm = 0.0002799 (50 iterations in 0.018s)
[t-SNE] Iteration 600: error = 0.3240739, gradient norm = 0.0003528 (50 iterations in 0.018s)
[t-SNE] Iteration 650: error = 0.3241583, gradient norm = 0.0003908 (50 iterations in 0.018s)
[t-SNE] Iteration 700: error = 0.3240516, gradient norm = 0.0004191 (50 iterations in 0.018s)
[t-SNE] Iteration 750: error = 0.3239058, gradient norm = 0.0006725 (50 iterations in 0.018s)
[t-SNE] Iteration 800: error = 0.3240199, gradient norm = 0.0003069 (50 iterations in 0.018s)
[t-SNE] Iteration 850: error = 0.3239875, gradient norm = 0.0003335 (50 iterations in 0.018s)
[t-SNE] Iteration 900: error = 0.3239827, gradient norm = 0.0001910 (50 iterations in 0.018s)
[t-SNE] Iteration 950: error = 0.3239784, gradient norm = 0.0004315 (50 iterations in 0.018s)
[t-SNE] Iteration 1000: error = 0.3241427, gradient norm = 0.0003418 (50 iterations in 0.018s)
[t-SNE] KL divergence after 1000 iterations: 0.324143
[t-SNE] Computed conditional probabilities for sample 102 / 102
[t-SNE] Mean sigma: 0.503927
Beginning preprocessing + Leiden
2024-03-13 18:30:33.330449 MEMORY 16.75194368
Affmat transformed
2024-03-13 18:30:33.331753 MEMORY 16.75194368
sources, targets, weights extracted
2024-03-13 18:30:33.332299 MEMORY 16.75194368
About to launch parallel Leiden runs
2024-03-13 18:30:33.336640 MEMORY 16.75194368
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.8s finished
Parallel Leiden runs finished
2024-03-13 18:30:35.162576 MEMORY 16.75194368
Quality: 0.24621488093911276
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  61 out of  61 | elapsed:    0.0s finished
Got subclusters: Counter({0: 39, 1: 31, 2: 24, 3: 8})
On pattern 18
[t-SNE] Computing 60 nearest neighbors...
[t-SNE] Indexed 61 samples in 0.000s...
[t-SNE] Computed neighbors for 61 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 61 / 61
[t-SNE] Mean sigma: 0.765452
[t-SNE] Computed conditional probabilities in 0.002s
[t-SNE] Iteration 50: error = 43.0541153, gradient norm = 0.5504846 (50 iterations in 0.012s)
[t-SNE] Iteration 100: error = 45.4295502, gradient norm = 0.5347272 (50 iterations in 0.012s)
[t-SNE] Iteration 150: error = 47.2947922, gradient norm = 0.5934532 (50 iterations in 0.012s)
[t-SNE] Iteration 200: error = 44.2140961, gradient norm = 0.4301787 (50 iterations in 0.012s)
[t-SNE] Iteration 250: error = 48.0582390, gradient norm = 0.4062219 (50 iterations in 0.012s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 48.058239
[t-SNE] Iteration 300: error = 0.7795258, gradient norm = 0.0010394 (50 iterations in 0.011s)
[t-SNE] Iteration 350: error = 0.7302531, gradient norm = 0.0005189 (50 iterations in 0.011s)
[t-SNE] Iteration 400: error = 0.7021241, gradient norm = 0.0005632 (50 iterations in 0.011s)
[t-SNE] Iteration 450: error = 0.6690953, gradient norm = 0.0004854 (50 iterations in 0.011s)
[t-SNE] Iteration 500: error = 0.6382752, gradient norm = 0.0006420 (50 iterations in 0.011s)
[t-SNE] Iteration 550: error = 0.5945469, gradient norm = 0.0007793 (50 iterations in 0.011s)
[t-SNE] Iteration 600: error = 0.5664734, gradient norm = 0.0008247 (50 iterations in 0.011s)
[t-SNE] Iteration 650: error = 0.5431843, gradient norm = 0.0004188 (50 iterations in 0.011s)
[t-SNE] Iteration 700: error = 0.5205441, gradient norm = 0.0009004 (50 iterations in 0.011s)
[t-SNE] Iteration 750: error = 0.4955341, gradient norm = 0.0015557 (50 iterations in 0.011s)
[t-SNE] Iteration 800: error = 0.3112843, gradient norm = 0.0341438 (50 iterations in 0.011s)
[t-SNE] Iteration 850: error = 0.0659355, gradient norm = 0.0107276 (50 iterations in 0.012s)
[t-SNE] Iteration 900: error = 0.0619265, gradient norm = 0.0020417 (50 iterations in 0.012s)
[t-SNE] Iteration 950: error = 0.0618774, gradient norm = 0.0011207 (50 iterations in 0.011s)
[t-SNE] Iteration 1000: error = 0.0619308, gradient norm = 0.0013576 (50 iterations in 0.011s)
[t-SNE] KL divergence after 1000 iterations: 0.061931
[t-SNE] Computed conditional probabilities for sample 61 / 61
[t-SNE] Mean sigma: 0.765452
Beginning preprocessing + Leiden
2024-03-13 18:30:35.456104 MEMORY 16.75194368
Affmat transformed
2024-03-13 18:30:35.456960 MEMORY 16.75194368
sources, targets, weights extracted
2024-03-13 18:30:35.457303 MEMORY 16.75194368
About to launch parallel Leiden runs
2024-03-13 18:30:35.493617 MEMORY 16.75194368
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.6s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.8s finished
Parallel Leiden runs finished
2024-03-13 18:30:37.247188 MEMORY 16.75194368
Quality: 0.12973186822096242
Got subclusters: Counter({0: 30, 1: 20, 2: 11})
On metacluster 2
Metacluster size 31481 limited to 20000
Relevant tasks:  ('testis',)
Relevant signs:  (1,)
TfModiscoSeqletsToPatternsFactory: seed=1234
(Round 1) num seqlets: 20000
(Round 1) Computing coarse affmat
2024-03-13 18:30:41.268496 MEMORY 16.751161344
Beginning embedding computation
MEMORY 16.751161344
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 152 tasks      | elapsed:    2.0s
[Parallel(n_jobs=24)]: Done 402 tasks      | elapsed:    4.8s
[Parallel(n_jobs=24)]: Done 752 tasks      | elapsed:    8.7s
[Parallel(n_jobs=24)]: Done 1202 tasks      | elapsed:   13.7s
[Parallel(n_jobs=24)]: Done 1752 tasks      | elapsed:   19.8s
[Parallel(n_jobs=24)]: Done 2402 tasks      | elapsed:   27.0s
[Parallel(n_jobs=24)]: Done 3152 tasks      | elapsed:   35.2s
[Parallel(n_jobs=24)]: Done 4002 tasks      | elapsed:   44.6s
[Parallel(n_jobs=24)]: Done 4952 tasks      | elapsed:   55.1s
[Parallel(n_jobs=24)]: Done 6002 tasks      | elapsed:  1.1min
[Parallel(n_jobs=24)]: Done 7152 tasks      | elapsed:  1.3min
[Parallel(n_jobs=24)]: Done 8402 tasks      | elapsed:  1.5min
[Parallel(n_jobs=24)]: Done 9752 tasks      | elapsed:  1.8min
[Parallel(n_jobs=24)]: Done 11202 tasks      | elapsed:  2.1min
[Parallel(n_jobs=24)]: Done 12752 tasks      | elapsed:  2.3min
[Parallel(n_jobs=24)]: Done 14402 tasks      | elapsed:  2.6min
[Parallel(n_jobs=24)]: Done 16152 tasks      | elapsed:  3.0min
[Parallel(n_jobs=24)]: Done 18002 tasks      | elapsed:  3.3min
[Parallel(n_jobs=24)]: Done 19952 tasks      | elapsed:  3.6min
[Parallel(n_jobs=24)]: Done 20000 out of 20000 | elapsed:  3.7min finished
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 152 tasks      | elapsed:    1.9s
[Parallel(n_jobs=24)]: Done 402 tasks      | elapsed:    4.6s
[Parallel(n_jobs=24)]: Done 752 tasks      | elapsed:    8.4s
[Parallel(n_jobs=24)]: Done 1202 tasks      | elapsed:   13.4s
[Parallel(n_jobs=24)]: Done 1752 tasks      | elapsed:   19.4s
[Parallel(n_jobs=24)]: Done 2402 tasks      | elapsed:   26.7s
[Parallel(n_jobs=24)]: Done 3152 tasks      | elapsed:   35.0s
[Parallel(n_jobs=24)]: Done 4002 tasks      | elapsed:   44.3s
[Parallel(n_jobs=24)]: Done 4952 tasks      | elapsed:   54.7s
[Parallel(n_jobs=24)]: Done 6002 tasks      | elapsed:  1.1min
[Parallel(n_jobs=24)]: Done 7152 tasks      | elapsed:  1.3min
[Parallel(n_jobs=24)]: Done 8402 tasks      | elapsed:  1.5min
[Parallel(n_jobs=24)]: Done 9752 tasks      | elapsed:  1.8min
[Parallel(n_jobs=24)]: Done 11202 tasks      | elapsed:  2.1min
[Parallel(n_jobs=24)]: Done 12752 tasks      | elapsed:  2.3min
[Parallel(n_jobs=24)]: Done 14402 tasks      | elapsed:  2.6min
[Parallel(n_jobs=24)]: Done 16152 tasks      | elapsed:  3.0min
[Parallel(n_jobs=24)]: Done 18002 tasks      | elapsed:  3.3min
[Parallel(n_jobs=24)]: Done 19952 tasks      | elapsed:  3.6min
[Parallel(n_jobs=24)]: Done 20000 out of 20000 | elapsed:  3.7min finished
At the beginning of embedding call
2024-03-13 18:30:41.268727 MEMORY 16.751161344
before computing embeddings fwd
2024-03-13 18:30:41.277563 MEMORY 16.751161344
after computing embeddings fwd
2024-03-13 18:34:20.652650 MEMORY 16.751161344
after computing embeddings rev
2024-03-13 18:37:59.820596 MEMORY 17.20696832
before computing sparse embeddings fwd
2024-03-13 18:37:59.820695 MEMORY 17.20696832
Constructing csr matrix...
csr matrix made in 2.5276176929473877 s
after computing sparse embeddings fwd
2024-03-13 18:38:03.195235 MEMORY 17.347969024
before computing sparse embeddings rev
2024-03-13 18:38:03.195345 MEMORY 17.347969024
Constructing csr matrix...
csr matrix made in 2.4230587482452393 s
after computing sparse embeddings rev
2024-03-13 18:38:06.674844 MEMORY 17.468235776
Finished embedding computation in 449.08 s
MEMORY 17.128497152
Starting affinity matrix computations
MEMORY 17.128497152
Batching in slices of size 3355
  0%|          | 0/6 [00:00<?, ?it/s] 17%|â–ˆâ–‹        | 1/6 [00:08<00:40,  8.12s/it] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 2/6 [00:16<00:32,  8.09s/it] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 3/6 [00:24<00:24,  8.08s/it] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 4/6 [00:32<00:16,  8.05s/it] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 5/6 [00:40<00:07,  7.99s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:47<00:00,  7.78s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:47<00:00,  7.92s/it]
Finished affinity matrix computations in 47.68 s
MEMORY 17.128566784
(Round 1) Computed coarse affmat
2024-03-13 18:39:00.779585 MEMORY 16.88803328
(Round 1) Computing affinity matrix on nearest neighbors
2024-03-13 18:39:00.779722 MEMORY 16.88803328
Launching nearest neighbors affmat calculation job
MEMORY 16.975704064
Parallel runs completed
MEMORY 17.012957184
Job completed in: 59.5 s
MEMORY 17.008566272
Launching nearest neighbors affmat calculation job
MEMORY 17.006215168
Parallel runs completed
MEMORY 17.047465984
Job completed in: 58.92 s
MEMORY 17.04740864
(Round 1) Computed affinity matrix on nearest neighbors in 123.69 s
2024-03-13 18:41:04.473088 MEMORY 16.904204288
Filtered down to 17226 of 20000
(Round 1) Retained 17226 rows out of 20000 after filtering
2024-03-13 18:41:14.613053 MEMORY 16.904298496
(Round 1) Computing density adapted affmat
2024-03-13 18:41:20.470019 MEMORY 16.904298496
Symmetrizing nearest neighbors
Computing betas for density adaptation
Computing normalizing denominators
(Round 1) Computing clustering
2024-03-13 18:43:31.533320 MEMORY 17.025511424
Beginning preprocessing + Leiden
2024-03-13 18:43:31.556021 MEMORY 17.025511424
Affmat transformed
2024-03-13 18:43:31.556172 MEMORY 17.025511424
sources, targets, weights extracted
2024-03-13 18:43:32.167165 MEMORY 17.161347072
About to launch parallel Leiden runs
2024-03-13 18:43:32.308104 MEMORY 17.025503232
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:  2.0min
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:  6.9min finished
Parallel Leiden runs finished
2024-03-13 18:50:25.370691 MEMORY 17.025490944
Quality: 0.39421701880906135
Quality: 0.3942467548772711
Quality: 0.3951828069425502
Got 6 clusters after round 1
Counts:
{0: 4163, 1: 3668, 5: 489, 3: 3415, 2: 3485, 4: 2006}
2024-03-13 18:50:25.421571 MEMORY 16.889561088
(Round 1) Aggregating seqlets in each cluster
2024-03-13 18:50:25.421669 MEMORY 16.889561088
Aggregating for cluster 0 with 4163 seqlets
2024-03-13 18:50:25.426955 MEMORY 16.889561088
Removed 1 duplicate seqlets
Skipped 17 due to duplicates
Trimming eliminated 0 seqlets out of 4145
Aggregating for cluster 1 with 3668 seqlets
2024-03-13 18:50:35.323378 MEMORY 16.889561088
Skipped 9 due to duplicates
Trimming eliminated 0 seqlets out of 3659
Aggregating for cluster 2 with 3485 seqlets
2024-03-13 18:50:43.606544 MEMORY 16.889561088
Skipped 8 due to duplicates
Trimming eliminated 0 seqlets out of 3477
Aggregating for cluster 3 with 3415 seqlets
2024-03-13 18:50:51.332036 MEMORY 16.889561088
Skipped 18 due to duplicates
Trimming eliminated 0 seqlets out of 3397
Aggregating for cluster 4 with 2006 seqlets
2024-03-13 18:51:01.856676 MEMORY 16.889581568
Skipped 1 seqlets that went over sequence edge during flank expansion
Skipped 5 due to duplicates
Trimming eliminated 0 seqlets out of 2000
Aggregating for cluster 5 with 489 seqlets
2024-03-13 18:51:06.474347 MEMORY 16.889581568
Skipped 3 due to duplicates
Trimming eliminated 0 seqlets out of 486
Dropping cluster 5 with 486 seqlets due to sign disagreement
(Round 2) num seqlets: 16671
(Round 2) Computing coarse affmat
2024-03-13 18:51:10.217002 MEMORY 16.889581568
Beginning embedding computation
MEMORY 16.889581568
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 320 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done 2256 tasks      | elapsed:    3.0s
[Parallel(n_jobs=24)]: Done 5056 tasks      | elapsed:    6.3s
[Parallel(n_jobs=24)]: Done 8656 tasks      | elapsed:   10.5s
[Parallel(n_jobs=24)]: Done 13056 tasks      | elapsed:   15.6s
[Parallel(n_jobs=24)]: Done 16671 out of 16671 | elapsed:   19.8s finished
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 256 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done 1176 tasks      | elapsed:    2.1s
[Parallel(n_jobs=24)]: Done 2576 tasks      | elapsed:    4.2s
[Parallel(n_jobs=24)]: Done 4376 tasks      | elapsed:    6.7s
[Parallel(n_jobs=24)]: Done 6576 tasks      | elapsed:    9.7s
[Parallel(n_jobs=24)]: Done 9176 tasks      | elapsed:   13.5s
[Parallel(n_jobs=24)]: Done 12176 tasks      | elapsed:   17.6s
[Parallel(n_jobs=24)]: Done 15576 tasks      | elapsed:   22.4s
[Parallel(n_jobs=24)]: Done 16671 out of 16671 | elapsed:   23.9s finished
At the beginning of embedding call
2024-03-13 18:51:10.217221 MEMORY 16.889581568
before computing embeddings fwd
2024-03-13 18:51:10.225945 MEMORY 16.889581568
after computing embeddings fwd
2024-03-13 18:51:30.031163 MEMORY 16.889581568
after computing embeddings rev
2024-03-13 18:51:53.967926 MEMORY 17.502564352
before computing sparse embeddings fwd
2024-03-13 18:51:53.968015 MEMORY 17.502564352
Constructing csr matrix...
csr matrix made in 2.064361333847046 s
after computing sparse embeddings fwd
2024-03-13 18:51:56.693776 MEMORY 17.613234176
before computing sparse embeddings rev
2024-03-13 18:51:56.694286 MEMORY 17.613234176
Constructing csr matrix...
csr matrix made in 1.946296215057373 s
after computing sparse embeddings rev
2024-03-13 18:51:59.342231 MEMORY 17.724440576
Finished embedding computation in 53.38 s
MEMORY 17.21745408
Starting affinity matrix computations
MEMORY 17.215881216
Batching in slices of size 4025
  0%|          | 0/5 [00:00<?, ?it/s] 20%|â–ˆâ–ˆ        | 1/5 [00:09<00:37,  9.26s/it] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [00:19<00:28,  9.58s/it] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [00:28<00:18,  9.38s/it] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [00:36<00:09,  9.14s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [00:39<00:00,  6.68s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [00:39<00:00,  7.86s/it]
Finished affinity matrix computations in 39.4 s
MEMORY 17.249337344
(Round 2) Computed coarse affmat
2024-03-13 18:52:46.049880 MEMORY 16.949092352
(Round 2) Computing affinity matrix on nearest neighbors
2024-03-13 18:52:46.050040 MEMORY 16.949092352
Launching nearest neighbors affmat calculation job
MEMORY 16.949092352
Parallel runs completed
MEMORY 16.967237632
Job completed in: 26.44 s
MEMORY 16.964943872
Launching nearest neighbors affmat calculation job
MEMORY 16.96477184
Parallel runs completed
MEMORY 16.983220224
Job completed in: 25.04 s
MEMORY 16.978804736
(Round 2) Computed affinity matrix on nearest neighbors in 56.32 s
2024-03-13 18:53:42.373995 MEMORY 16.976560128
Not applying filtering for rounds above first round
2024-03-13 18:53:42.376306 MEMORY 16.976560128
(Round 2) Computing density adapted affmat
2024-03-13 18:53:48.074374 MEMORY 16.976560128
Symmetrizing nearest neighbors
Computing betas for density adaptation
Computing normalizing denominators
(Round 2) Computing clustering
2024-03-13 18:56:13.044000 MEMORY 17.062035456
Beginning preprocessing + Leiden
2024-03-13 18:56:13.071290 MEMORY 17.062035456
Affmat transformed
2024-03-13 18:56:13.071431 MEMORY 17.062035456
sources, targets, weights extracted
2024-03-13 18:56:13.731972 MEMORY 17.255886848
About to launch parallel Leiden runs
2024-03-13 18:56:13.889507 MEMORY 17.062035456
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:  1.5min
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:  5.2min finished
Parallel Leiden runs finished
2024-03-13 19:01:27.531987 MEMORY 17.062035456
Quality: 0.46253667799603937
Quality: 0.4634799480881112
Quality: 0.4634802083562451
Quality: 0.4637004198439234
Quality: 0.4637025886281548
Got 5 clusters after round 2
Counts:
{0: 4092, 3: 2996, 2: 3551, 1: 3778, 4: 2254}
2024-03-13 19:01:27.581636 MEMORY 16.916525056
(Round 2) Aggregating seqlets in each cluster
2024-03-13 19:01:27.581735 MEMORY 16.916525056
Aggregating for cluster 0 with 4092 seqlets
2024-03-13 19:01:27.591142 MEMORY 16.916525056
Skipped 9 due to duplicates
Trimming eliminated 0 seqlets out of 4083
Aggregating for cluster 1 with 3778 seqlets
2024-03-13 19:01:34.070156 MEMORY 16.916525056
Skipped 14 due to duplicates
Trimming eliminated 0 seqlets out of 3764
Aggregating for cluster 2 with 3551 seqlets
2024-03-13 19:01:39.965438 MEMORY 16.916525056
Skipped 8 due to duplicates
Trimming eliminated 0 seqlets out of 3543
Aggregating for cluster 3 with 2996 seqlets
2024-03-13 19:01:45.584444 MEMORY 16.916525056
Skipped 5 due to duplicates
Trimming eliminated 0 seqlets out of 2991
Aggregating for cluster 4 with 2254 seqlets
2024-03-13 19:01:53.573394 MEMORY 16.916525056
Skipped 3 due to duplicates
Trimming eliminated 0 seqlets out of 2251
Got 5 clusters
Splitting into subclusters...
2024-03-13 19:01:57.503528 MEMORY 16.916525056
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 3727 tasks      | elapsed:    1.1s
[Parallel(n_jobs=24)]: Done 4083 out of 4083 | elapsed:    1.2s finished
Inspecting pattern 0 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 4083
[t-SNE] Computed conditional probabilities for sample 2000 / 4083
[t-SNE] Computed conditional probabilities for sample 3000 / 4083
[t-SNE] Computed conditional probabilities for sample 4000 / 4083
[t-SNE] Computed conditional probabilities for sample 4083 / 4083
[t-SNE] Mean sigma: 0.318872
Beginning preprocessing + Leiden
2024-03-13 19:02:02.980625 MEMORY 16.952307712
Affmat transformed
2024-03-13 19:02:03.028383 MEMORY 16.952307712
sources, targets, weights extracted
2024-03-13 19:02:03.059725 MEMORY 16.952307712
About to launch parallel Leiden runs
2024-03-13 19:02:03.089005 MEMORY 16.952307712
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:   17.5s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   57.8s finished
Parallel Leiden runs finished
2024-03-13 19:03:00.914307 MEMORY 16.952307712
Quality: 0.49163293160385707
Quality: 0.4935399946934425
Quality: 0.4940929161860227
Quality: 0.494279903380983
Got subclusters: Counter({0: 736, 1: 604, 2: 548, 3: 500, 4: 493, 5: 489, 6: 457, 7: 256})
On merging iteration 1
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 3366 tasks      | elapsed:    1.0s
[Parallel(n_jobs=24)]: Done 3717 out of 3764 | elapsed:    1.1s remaining:    0.0s
[Parallel(n_jobs=24)]: Done 3764 out of 3764 | elapsed:    1.2s finished
Numbers for each pattern pre-subsample: [736, 604, 548, 500, 493, 489, 457, 256]
Numbers after subsampling: [300, 300, 300, 300, 300, 300, 300, 256]
Computing sims for pattern 0
Computed sims for pattern 0 in 2.2788374423980713 s
Computing sims for pattern 1
Computed sims for pattern 1 in 2.259977340698242 s
Computing sims for pattern 2
Computed sims for pattern 2 in 2.2620511054992676 s
Computing sims for pattern 3
Computed sims for pattern 3 in 2.270815134048462 s
Computing sims for pattern 4
Computed sims for pattern 4 in 2.2216084003448486 s
Computing sims for pattern 5
Computed sims for pattern 5 in 2.2273242473602295 s
Computing sims for pattern 6
Computed sims for pattern 6 in 2.260277509689331 s
Computing sims for pattern 7
Computed sims for pattern 7 in 1.8310577869415283 s
Cluster sizes
[736 604 548 500 493 489 457 256]
Cross-contamination matrix:
[[1.   0.67 0.7  0.46 0.62 0.55 0.53 0.59]
 [0.73 1.   0.85 0.7  0.85 0.71 0.7  0.75]
 [0.53 0.59 1.   0.44 0.64 0.68 0.69 0.74]
 [0.53 0.69 0.67 1.   0.78 0.71 0.67 0.84]
 [0.45 0.56 0.61 0.51 1.   0.32 0.65 0.58]
 [0.45 0.54 0.76 0.55 0.58 1.   0.67 0.58]
 [0.44 0.4  0.77 0.52 0.75 0.66 1.   0.75]
 [0.4  0.49 0.72 0.56 0.6  0.48 0.64 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.81 0.67 0.7  0.73 0.74 0.65 0.57]
 [0.81 1.   0.73 0.74 0.74 0.6  0.64 0.72]
 [0.67 0.73 1.   0.62 0.7  0.75 0.85 0.84]
 [0.7  0.74 0.62 1.   0.7  0.69 0.68 0.75]
 [0.73 0.74 0.7  0.7  1.   0.56 0.74 0.74]
 [0.74 0.6  0.75 0.69 0.56 1.   0.67 0.56]
 [0.65 0.64 0.85 0.68 0.74 0.67 1.   0.8 ]
 [0.57 0.72 0.84 0.75 0.74 0.56 0.8  1.  ]]
Inspecting pattern 1 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 3764
[t-SNE] Computed conditional probabilities for sample 2000 / 3764
[t-SNE] Computed conditional probabilities for sample 3000 / 3764
[t-SNE] Computed conditional probabilities for sample 3764 / 3764
[t-SNE] Mean sigma: 0.309563
Beginning preprocessing + Leiden
2024-03-13 19:03:24.622932 MEMORY 16.943108096
Affmat transformed
2024-03-13 19:03:24.668186 MEMORY 16.949809152
sources, targets, weights extracted
2024-03-13 19:03:24.697626 MEMORY 16.949809152
About to launch parallel Leiden runs
2024-03-13 19:03:24.712760 MEMORY 16.949833728
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:   16.1s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   49.4s finished
Parallel Leiden runs finished
2024-03-13 19:04:14.077711 MEMORY 16.949833728
Quality: 0.4877415188706444
Quality: 0.4888991108907852
Got subclusters: Counter({0: 758, 1: 566, 2: 531, 3: 416, 4: 387, 5: 381, 6: 380, 7: 339, 8: 6})
On merging iteration 1
Numbers for each pattern pre-subsample: [758, 566, 531, 416, 387, 381, 380, 339, 6]
Numbers after subsampling: [300, 300, 300, 300, 300, 300, 300, 300, 6]
Computing sims for pattern 0
Computed sims for pattern 0 in 2.6307034492492676 s
Computing sims for pattern 1
Computed sims for pattern 1 in 2.610360622406006 s
Computing sims for pattern 2
Computed sims for pattern 2 in 2.6887474060058594 s
Computing sims for pattern 3
Computed sims for pattern 3 in 2.686751365661621 s
Computing sims for pattern 4
Computed sims for pattern 4 in 2.727715015411377 s
Computing sims for pattern 5
Computed sims for pattern 5 in 2.7522246837615967 s
Computing sims for pattern 6
Computed sims for pattern 6 in 2.7495439052581787 s
Computing sims for pattern 7
Computed sims for pattern 7 in 2.7359392642974854 s
Computing sims for pattern 8
Computed sims for pattern 8 in 0.24110627174377441 s
Cluster sizes
[758 566 531 416 387 381 380 339   6]
Cross-contamination matrix:
[[1.   0.78 0.47 0.64 0.72 0.61 0.54 0.6  0.04]
 [0.75 1.   0.67 0.6  0.42 0.46 0.41 0.73 0.03]
 [0.47 0.71 1.   0.53 0.4  0.77 0.38 0.8  0.05]
 [0.65 0.64 0.7  1.   0.72 0.7  0.63 0.77 0.06]
 [0.69 0.45 0.38 0.68 1.   0.69 0.57 0.53 0.11]
 [0.51 0.48 0.76 0.68 0.71 1.   0.44 0.57 0.13]
 [0.74 0.75 0.57 0.83 0.79 0.71 1.   0.65 0.14]
 [0.51 0.65 0.68 0.54 0.47 0.47 0.38 1.   0.03]
 [0.   0.02 0.   0.   0.02 0.03 0.01 0.   1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.84 0.72 0.75 0.71 0.68 0.81 0.77 0.3 ]
 [0.84 1.   0.8  0.76 0.6  0.66 0.76 0.79 0.24]
 [0.72 0.8  1.   0.79 0.68 0.82 0.72 0.8  0.36]
 [0.75 0.76 0.79 1.   0.77 0.78 0.91 0.82 0.42]
 [0.71 0.6  0.68 0.77 1.   0.69 0.84 0.71 0.32]
 [0.68 0.66 0.82 0.78 0.69 1.   0.78 0.79 0.36]
 [0.81 0.76 0.72 0.91 0.84 0.78 1.   0.84 0.33]
 [0.77 0.79 0.8  0.82 0.71 0.79 0.84 1.   0.33]
 [0.3  0.24 0.36 0.42 0.32 0.36 0.33 0.33 1.  ]]
Collapsing 3 & 6 with crosscontam 0.6298323318518517 and sim 0.9082322959636883
Trimming eliminated 0 seqlets out of 796
Unmerged patterns remapping: OrderedDict([(0, 1), (1, 2), (2, 3), (4, 4), (5, 5), (7, 6), (8, 7)])
Time spent on merging iteration: 1.7460923194885254
On merging iteration 2
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 3192 tasks      | elapsed:    0.9s
[Parallel(n_jobs=24)]: Done 3496 out of 3543 | elapsed:    1.0s remaining:    0.0s
[Parallel(n_jobs=24)]: Done 3543 out of 3543 | elapsed:    1.0s finished
Numbers for each pattern pre-subsample: [796, 758, 566, 531, 387, 381, 339, 6]
Numbers after subsampling: [300, 300, 300, 300, 300, 300, 300, 6]
Computing sims for pattern 0
Computed sims for pattern 0 in 2.3771047592163086 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.35920119285583496 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.36522674560546875 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.3705117702484131 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.35251569747924805 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.341827392578125 s
Computing sims for pattern 6
Computed sims for pattern 6 in 0.36778998374938965 s
Computing sims for pattern 7
Computed sims for pattern 7 in 0.03373146057128906 s
Cluster sizes
[796 758 566 531 387 381 339   6]
Cross-contamination matrix:
[[1.   0.85 0.86 0.84 0.86 0.87 0.9  0.22]
 [0.58 1.   0.78 0.47 0.72 0.61 0.6  0.04]
 [0.55 0.75 1.   0.67 0.42 0.46 0.73 0.03]
 [0.5  0.47 0.71 1.   0.4  0.77 0.8  0.05]
 [0.57 0.69 0.45 0.38 1.   0.69 0.53 0.11]
 [0.54 0.51 0.48 0.76 0.71 1.   0.57 0.13]
 [0.49 0.51 0.65 0.68 0.47 0.47 1.   0.03]
 [0.02 0.   0.02 0.   0.02 0.03 0.   1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.79 0.78 0.79 0.8  0.79 0.84 0.39]
 [0.79 1.   0.84 0.72 0.71 0.68 0.77 0.3 ]
 [0.78 0.84 1.   0.8  0.6  0.66 0.79 0.24]
 [0.79 0.72 0.8  1.   0.68 0.82 0.8  0.36]
 [0.8  0.71 0.6  0.68 1.   0.69 0.71 0.32]
 [0.79 0.68 0.66 0.82 0.69 1.   0.79 0.36]
 [0.84 0.77 0.79 0.8  0.71 0.79 1.   0.33]
 [0.39 0.3  0.24 0.36 0.32 0.36 0.33 1.  ]]
Inspecting pattern 2 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 3543
[t-SNE] Computed conditional probabilities for sample 2000 / 3543
[t-SNE] Computed conditional probabilities for sample 3000 / 3543
[t-SNE] Computed conditional probabilities for sample 3543 / 3543
[t-SNE] Mean sigma: 0.298684
Beginning preprocessing + Leiden
2024-03-13 19:04:48.051701 MEMORY 16.938893312
Affmat transformed
2024-03-13 19:04:48.094284 MEMORY 16.952303616
sources, targets, weights extracted
2024-03-13 19:04:48.124420 MEMORY 16.95248384
About to launch parallel Leiden runs
2024-03-13 19:04:48.178964 MEMORY 16.95248384
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:   14.0s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   46.9s finished
Parallel Leiden runs finished
2024-03-13 19:05:35.054451 MEMORY 16.95248384
Quality: 0.48555664567713297
Quality: 0.48590826607212195
Quality: 0.4869138500775807
Quality: 0.4869489167520615
Got subclusters: Counter({0: 616, 1: 612, 2: 571, 3: 434, 4: 346, 5: 327, 6: 326, 7: 256, 8: 42, 9: 13})
On merging iteration 1
Numbers for each pattern pre-subsample: [616, 612, 571, 434, 346, 327, 326, 256, 42, 13]
Numbers after subsampling: [300, 300, 300, 300, 300, 300, 300, 256, 42, 13]
Computing sims for pattern 0
Computed sims for pattern 0 in 2.8806772232055664 s
Computing sims for pattern 1
Computed sims for pattern 1 in 2.9236907958984375 s
Computing sims for pattern 2
Computed sims for pattern 2 in 2.9064321517944336 s
Computing sims for pattern 3
Computed sims for pattern 3 in 2.9609763622283936 s
Computing sims for pattern 4
Computed sims for pattern 4 in 2.8983242511749268 s
Computing sims for pattern 5
Computed sims for pattern 5 in 2.928445339202881 s
Computing sims for pattern 6
Computed sims for pattern 6 in 2.9130866527557373 s
Computing sims for pattern 7
Computed sims for pattern 7 in 2.2711973190307617 s
Computing sims for pattern 8
Computed sims for pattern 8 in 0.5836100578308105 s
Computing sims for pattern 9
Computed sims for pattern 9 in 0.3019850254058838 s
Cluster sizes
[616 612 571 434 346 327 326 256  42  13]
Cross-contamination matrix:
[[1.   0.51 0.56 0.55 0.7  0.76 0.83 0.85 0.87 0.47]
 [0.73 1.   0.71 0.67 0.81 0.44 0.87 0.9  0.81 0.51]
 [0.51 0.58 1.   0.35 0.81 0.57 0.71 0.9  0.73 0.49]
 [0.76 0.53 0.55 1.   0.71 0.63 0.8  0.87 0.61 0.26]
 [0.54 0.64 0.7  0.59 1.   0.68 0.77 0.9  0.79 0.34]
 [0.69 0.41 0.56 0.62 0.77 1.   0.67 0.87 0.71 0.44]
 [0.61 0.64 0.56 0.63 0.71 0.53 1.   0.73 0.69 0.33]
 [0.37 0.31 0.45 0.45 0.58 0.44 0.54 1.   0.56 0.23]
 [0.3  0.24 0.14 0.23 0.37 0.24 0.36 0.44 1.   0.1 ]
 [0.17 0.18 0.21 0.12 0.17 0.19 0.22 0.27 0.15 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.78 0.7  0.84 0.77 0.83 0.83 0.74 0.79 0.72]
 [0.78 1.   0.85 0.78 0.85 0.72 0.87 0.8  0.77 0.69]
 [0.7  0.85 1.   0.72 0.91 0.77 0.82 0.88 0.72 0.62]
 [0.84 0.78 0.72 1.   0.78 0.79 0.83 0.77 0.7  0.59]
 [0.77 0.85 0.91 0.78 1.   0.84 0.87 0.89 0.77 0.55]
 [0.83 0.72 0.77 0.79 0.84 1.   0.75 0.8  0.73 0.64]
 [0.83 0.87 0.82 0.83 0.87 0.75 1.   0.81 0.77 0.6 ]
 [0.74 0.8  0.88 0.77 0.89 0.8  0.81 1.   0.75 0.61]
 [0.79 0.77 0.72 0.7  0.77 0.73 0.77 0.75 1.   0.61]
 [0.72 0.69 0.62 0.59 0.55 0.64 0.6  0.61 0.61 1.  ]]
Collapsing 2 & 4 with crosscontam 0.6976725051851851 and sim 0.910412113263603
Collapsing 4 & 7 with crosscontam 0.5795193763573965 and sim 0.8918060087004827
Collapsing 1 & 6 with crosscontam 0.6395976019753085 and sim 0.8674058342909237
Collapsing 4 & 6 with crosscontam 0.7082702637037037 and sim 0.8670867969018429
Collapsing 1 & 4 with crosscontam 0.6424162024691358 and sim 0.8548996183187645
Collapsing 1 & 2 with crosscontam 0.5826679170370368 and sim 0.850019257622237
Trimming eliminated 0 seqlets out of 917
Skipped 1 due to duplicates
Trimming eliminated 0 seqlets out of 1172
Trimming eliminated 0 seqlets out of 938
Skipped 4 due to duplicates
Trimming eliminated 0 seqlets out of 2106
Unmerged patterns remapping: OrderedDict([(0, 1), (3, 2), (5, 3), (8, 4), (9, 5)])
Time spent on merging iteration: 12.24817419052124
On merging iteration 2
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 2670 tasks      | elapsed:    0.5s
[Parallel(n_jobs=24)]: Done 2991 out of 2991 | elapsed:    0.6s finished
Numbers for each pattern pre-subsample: [2106, 616, 434, 327, 42, 13]
Numbers after subsampling: [300, 300, 300, 300, 42, 13]
Computing sims for pattern 0
Computed sims for pattern 0 in 1.512089490890503 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.34424734115600586 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.3514676094055176 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.3601112365722656 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.07244348526000977 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.038361549377441406 s
Cluster sizes
[2106  616  434  327   42   13]
Cross-contamination matrix:
[[1.   0.84 0.75 0.87 1.   0.64]
 [0.61 1.   0.55 0.76 0.87 0.47]
 [0.58 0.76 1.   0.63 0.61 0.26]
 [0.56 0.69 0.62 1.   0.71 0.44]
 [0.21 0.3  0.23 0.24 1.   0.1 ]
 [0.16 0.17 0.12 0.19 0.15 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.77 0.76 0.77 0.79 0.6 ]
 [0.77 1.   0.84 0.83 0.79 0.72]
 [0.76 0.84 1.   0.79 0.7  0.59]
 [0.77 0.83 0.79 1.   0.73 0.64]
 [0.79 0.79 0.7  0.73 1.   0.61]
 [0.6  0.72 0.59 0.64 0.61 1.  ]]
Inspecting pattern 3 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 2991
[t-SNE] Computed conditional probabilities for sample 2000 / 2991
[t-SNE] Computed conditional probabilities for sample 2991 / 2991
[t-SNE] Mean sigma: 0.335311
Beginning preprocessing + Leiden
2024-03-13 19:06:18.039695 MEMORY 16.923512832
Affmat transformed
2024-03-13 19:06:18.075281 MEMORY 16.931262464
sources, targets, weights extracted
2024-03-13 19:06:18.094801 MEMORY 16.931262464
About to launch parallel Leiden runs
2024-03-13 19:06:18.111196 MEMORY 16.931315712
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:   10.0s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   35.4s finished
Parallel Leiden runs finished
2024-03-13 19:06:53.516590 MEMORY 16.931315712
Quality: 0.5039698439640595
Quality: 0.5082416745407906
Quality: 0.5085760729730251
Quality: 0.5103058257802423
Got subclusters: Counter({0: 607, 1: 540, 2: 490, 3: 424, 4: 332, 5: 323, 6: 275})
On merging iteration 1
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 1974 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 2251 out of 2251 | elapsed:    0.4s finished
Numbers for each pattern pre-subsample: [607, 540, 490, 424, 332, 323, 275]
Numbers after subsampling: [300, 300, 300, 300, 300, 300, 275]
Computing sims for pattern 0
Computed sims for pattern 0 in 2.1279189586639404 s
Computing sims for pattern 1
Computed sims for pattern 1 in 2.092802047729492 s
Computing sims for pattern 2
Computed sims for pattern 2 in 2.080165147781372 s
Computing sims for pattern 3
Computed sims for pattern 3 in 2.1136229038238525 s
Computing sims for pattern 4
Computed sims for pattern 4 in 2.100651264190674 s
Computing sims for pattern 5
Computed sims for pattern 5 in 2.1127781867980957 s
Computing sims for pattern 6
Computed sims for pattern 6 in 1.8353793621063232 s
Cluster sizes
[607 540 490 424 332 323 275]
Cross-contamination matrix:
[[1.   0.52 0.65 0.62 0.61 0.71 0.5 ]
 [0.64 1.   0.56 0.57 0.36 0.5  0.62]
 [0.65 0.45 1.   0.56 0.64 0.8  0.5 ]
 [0.7  0.54 0.59 1.   0.66 0.66 0.59]
 [0.76 0.47 0.79 0.78 1.   0.79 0.75]
 [0.55 0.26 0.53 0.47 0.47 1.   0.35]
 [0.73 0.55 0.72 0.79 0.84 0.62 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.62 0.73 0.72 0.78 0.68 0.69]
 [0.62 1.   0.57 0.76 0.7  0.56 0.7 ]
 [0.73 0.57 1.   0.71 0.78 0.75 0.66]
 [0.72 0.76 0.71 1.   0.83 0.68 0.81]
 [0.78 0.7  0.78 0.83 1.   0.69 0.85]
 [0.68 0.56 0.75 0.68 0.69 1.   0.58]
 [0.69 0.7  0.66 0.81 0.85 0.58 1.  ]]
Inspecting pattern 4 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 2251
[t-SNE] Computed conditional probabilities for sample 2000 / 2251
[t-SNE] Computed conditional probabilities for sample 2251 / 2251
[t-SNE] Mean sigma: 0.341004
Beginning preprocessing + Leiden
2024-03-13 19:07:11.438845 MEMORY 16.931315712
Affmat transformed
2024-03-13 19:07:11.464311 MEMORY 16.931315712
sources, targets, weights extracted
2024-03-13 19:07:11.479507 MEMORY 16.931315712
About to launch parallel Leiden runs
2024-03-13 19:07:11.489919 MEMORY 16.931315712
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    6.9s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   23.7s finished
Parallel Leiden runs finished
2024-03-13 19:07:35.224700 MEMORY 16.931315712
Quality: 0.5203255301567393
Quality: 0.5206612253213496
Got subclusters: Counter({0: 491, 1: 378, 2: 343, 3: 308, 4: 299, 5: 265, 6: 167})
On merging iteration 1
Numbers for each pattern pre-subsample: [491, 378, 343, 308, 299, 265, 167]
Numbers after subsampling: [300, 300, 300, 300, 299, 265, 167]
Computing sims for pattern 0
Computed sims for pattern 0 in 2.029146194458008 s
Computing sims for pattern 1
Computed sims for pattern 1 in 2.0990941524505615 s
Computing sims for pattern 2
Computed sims for pattern 2 in 2.036064386367798 s
Computing sims for pattern 3
Computed sims for pattern 3 in 2.059692621231079 s
Computing sims for pattern 4
Computed sims for pattern 4 in 2.0592098236083984 s
Computing sims for pattern 5
Computed sims for pattern 5 in 1.6830775737762451 s
Computing sims for pattern 6
Computed sims for pattern 6 in 1.2427902221679688 s
Cluster sizes
[491 378 343 308 299 265 167]
Cross-contamination matrix:
[[1.   0.25 0.21 0.12 0.54 0.08 0.8 ]
 [0.63 1.   0.53 0.47 0.7  0.6  0.41]
 [0.77 0.76 1.   0.65 0.95 0.68 0.71]
 [0.38 0.51 0.48 1.   0.46 0.44 0.33]
 [0.9  0.56 0.56 0.32 1.   0.26 0.73]
 [0.34 0.74 0.6  0.52 0.46 1.   0.33]
 [0.85 0.17 0.22 0.13 0.44 0.1  1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.66 0.67 0.46 0.77 0.57 0.84]
 [0.66 1.   0.63 0.48 0.69 0.75 0.53]
 [0.67 0.63 1.   0.61 0.8  0.66 0.58]
 [0.46 0.48 0.61 1.   0.56 0.51 0.4 ]
 [0.77 0.69 0.8  0.56 1.   0.66 0.64]
 [0.57 0.75 0.66 0.51 0.66 1.   0.52]
 [0.84 0.53 0.58 0.4  0.64 0.52 1.  ]]
Collapsing 0 & 6 with crosscontam 0.8043746852960745 and sim 0.8367706561202441
Trimming eliminated 0 seqlets out of 658
Unmerged patterns remapping: OrderedDict([(1, 1), (2, 2), (3, 3), (4, 4), (5, 5)])
Time spent on merging iteration: 2.2610363960266113
On merging iteration 2
Numbers for each pattern pre-subsample: [658, 378, 343, 308, 299, 265]
Numbers after subsampling: [300, 300, 300, 300, 299, 265]
Computing sims for pattern 0
Computed sims for pattern 0 in 1.7901349067687988 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.3548297882080078 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.35632777214050293 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.3524661064147949 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.3437349796295166 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.2828032970428467 s
Cluster sizes
[658 378 343 308 299 265]
Cross-contamination matrix:
[[1.   0.29 0.25 0.15 0.6  0.1 ]
 [0.59 1.   0.53 0.47 0.7  0.6 ]
 [0.73 0.76 1.   0.65 0.95 0.68]
 [0.35 0.51 0.48 1.   0.46 0.44]
 [0.86 0.56 0.56 0.32 1.   0.26]
 [0.33 0.74 0.6  0.52 0.46 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.65 0.66 0.44 0.76 0.57]
 [0.65 1.   0.63 0.48 0.69 0.75]
 [0.66 0.63 1.   0.61 0.8  0.66]
 [0.44 0.48 0.61 1.   0.56 0.51]
 [0.76 0.69 0.8  0.56 1.   0.66]
 [0.57 0.75 0.66 0.51 0.66 1.  ]]
Merging on 35 clusters
2024-03-13 19:07:53.648304 MEMORY 16.931315712
On merging iteration 1
Numbers for each pattern pre-subsample: [736, 604, 548, 500, 493, 489, 457, 256, 796, 758, 566, 531, 387, 381, 339, 6, 2106, 616, 434, 327, 42, 13, 607, 540, 490, 424, 332, 323, 275, 658, 378, 343, 308, 299, 265]
Numbers after subsampling: [300, 300, 300, 300, 300, 300, 300, 256, 300, 300, 300, 300, 300, 300, 300, 6, 300, 300, 300, 300, 42, 13, 300, 300, 300, 300, 300, 300, 275, 300, 300, 300, 300, 299, 265]
Computing sims for pattern 0
Computed sims for pattern 0 in 11.545058250427246 s
Computing sims for pattern 1
Computed sims for pattern 1 in 11.523441553115845 s
Computing sims for pattern 2
Computed sims for pattern 2 in 16.495716333389282 s
Computing sims for pattern 3
Computed sims for pattern 3 in 11.671844959259033 s
Computing sims for pattern 4
Computed sims for pattern 4 in 11.646733045578003 s
Computing sims for pattern 5
Computed sims for pattern 5 in 11.453719139099121 s
Computing sims for pattern 6
Computed sims for pattern 6 in 11.562241077423096 s
Computing sims for pattern 7
Computed sims for pattern 7 in 9.064342021942139 s
Computing sims for pattern 8
Computed sims for pattern 8 in 11.42323350906372 s
Computing sims for pattern 9
Computed sims for pattern 9 in 11.324522495269775 s
Computing sims for pattern 10
Computed sims for pattern 10 in 11.378448009490967 s
Computing sims for pattern 11
Computed sims for pattern 11 in 11.307658195495605 s
Computing sims for pattern 12
Computed sims for pattern 12 in 11.270851373672485 s
Computing sims for pattern 13
Computed sims for pattern 13 in 11.233719825744629 s
Computing sims for pattern 14
Computed sims for pattern 14 in 17.033177852630615 s
Computing sims for pattern 15
Computed sims for pattern 15 in 0.9290800094604492 s
Computing sims for pattern 16
Computed sims for pattern 16 in 11.413487434387207 s
Computing sims for pattern 17
Computed sims for pattern 17 in 11.46504259109497 s
Computing sims for pattern 18
Computed sims for pattern 18 in 11.441384315490723 s
Computing sims for pattern 19
Computed sims for pattern 19 in 11.32207179069519 s
Computing sims for pattern 20
Computed sims for pattern 20 in 2.2324318885803223 s
Computing sims for pattern 21
Computed sims for pattern 21 in 1.152780294418335 s
Computing sims for pattern 22
Computed sims for pattern 22 in 11.402697086334229 s
Computing sims for pattern 23
Computed sims for pattern 23 in 11.393373012542725 s
Computing sims for pattern 24
Computed sims for pattern 24 in 11.353683471679688 s
Computing sims for pattern 25
Computed sims for pattern 25 in 11.432324171066284 s
Computing sims for pattern 26
Computed sims for pattern 26 in 11.491315126419067 s
Computing sims for pattern 27
Computed sims for pattern 27 in 11.497900485992432 s
Computing sims for pattern 28
Computed sims for pattern 28 in 13.829770565032959 s
Computing sims for pattern 29
Computed sims for pattern 29 in 11.297956466674805 s
Computing sims for pattern 30
Computed sims for pattern 30 in 11.527934789657593 s
Computing sims for pattern 31
Computed sims for pattern 31 in 11.494245052337646 s
Computing sims for pattern 32
Computed sims for pattern 32 in 11.512280941009521 s
Computing sims for pattern 33
Computed sims for pattern 33 in 11.392051458358765 s
Computing sims for pattern 34
Computed sims for pattern 34 in 9.475954055786133 s
Cluster sizes
[ 736  604  548  500  493  489  457  256  796  758  566  531  387  381
  339    6 2106  616  434  327   42   13  607  540  490  424  332  323
  275  658  378  343  308  299  265]
Cross-contamination matrix:
[[1.   0.67 0.7  ... 0.27 0.06 0.15]
 [0.73 1.   0.85 ... 0.36 0.09 0.18]
 [0.53 0.59 1.   ... 0.27 0.06 0.14]
 ...
 [0.38 0.42 0.42 ... 1.   0.46 0.44]
 [0.05 0.06 0.08 ... 0.32 1.   0.26]
 [0.17 0.19 0.26 ... 0.52 0.46 1.  ]]
Pattern-to-pattern sim matrix:
[[ 1.    0.81  0.67 ...  0.19 -0.06  0.18]
 [ 0.81  1.    0.73 ...  0.38  0.14  0.22]
 [ 0.67  0.73  1.   ...  0.37  0.07  0.41]
 ...
 [ 0.19  0.38  0.37 ...  1.    0.56  0.51]
 [-0.06  0.14  0.07 ...  0.56  1.    0.66]
 [ 0.18  0.22  0.41 ...  0.51  0.66  1.  ]]
Collapsing 6 & 9 with crosscontam 0.6789492437037037 and sim 0.879607738070951
Collapsing 16 & 24 with crosscontam 0.6983530523456789 and sim 0.8625202537036599
Collapsing 4 & 16 with crosscontam 0.5318290335802471 and sim 0.862085185185766
Skipped 2 due to duplicates
Trimming eliminated 0 seqlets out of 1213
Skipped 2 due to duplicates
Trimming eliminated 0 seqlets out of 2594
Skipped 7 due to duplicates
Trimming eliminated 0 seqlets out of 3080
Unmerged patterns remapping: OrderedDict([(0, 3), (1, 7), (2, 9), (3, 12), (5, 13), (7, 28), (8, 2), (10, 8), (11, 11), (12, 16), (13, 17), (14, 20), (15, 31), (17, 5), (18, 14), (19, 22), (20, 29), (21, 30), (22, 6), (23, 10), (25, 15), (26, 21), (27, 23), (28, 26), (29, 4), (30, 18), (31, 19), (32, 24), (33, 25), (34, 27)])
Time spent on merging iteration: 26.984670639038086
On merging iteration 2
Numbers for each pattern pre-subsample: [3080, 1213, 796, 736, 658, 616, 607, 604, 566, 548, 540, 531, 500, 489, 434, 424, 387, 381, 378, 343, 339, 332, 327, 323, 308, 299, 275, 265, 256, 42, 13, 6]
Numbers after subsampling: [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 299, 275, 265, 256, 42, 13, 6]
Computing sims for pattern 0
Computed sims for pattern 0 in 10.427530288696289 s
Computing sims for pattern 1
Computed sims for pattern 1 in 10.615800619125366 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.7183840274810791 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.7228870391845703 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.6951990127563477 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.6996071338653564 s
Computing sims for pattern 6
Computed sims for pattern 6 in 0.7009522914886475 s
Computing sims for pattern 7
Computed sims for pattern 7 in 0.7190828323364258 s
Computing sims for pattern 8
Computed sims for pattern 8 in 0.7312421798706055 s
Computing sims for pattern 9
Computed sims for pattern 9 in 0.7142469882965088 s
Computing sims for pattern 10
Computed sims for pattern 10 in 0.7046680450439453 s
Computing sims for pattern 11
Computed sims for pattern 11 in 0.7159345149993896 s
Computing sims for pattern 12
Computed sims for pattern 12 in 0.6939940452575684 s
Computing sims for pattern 13
Computed sims for pattern 13 in 0.7180056571960449 s
Computing sims for pattern 14
Computed sims for pattern 14 in 0.729511022567749 s
Computing sims for pattern 15
Computed sims for pattern 15 in 0.7084195613861084 s
Computing sims for pattern 16
Computed sims for pattern 16 in 0.7158091068267822 s
Computing sims for pattern 17
Computed sims for pattern 17 in 0.7026636600494385 s
Computing sims for pattern 18
Computed sims for pattern 18 in 0.6983096599578857 s
Computing sims for pattern 19
Computed sims for pattern 19 in 0.7279391288757324 s
Computing sims for pattern 20
Computed sims for pattern 20 in 0.7267496585845947 s
Computing sims for pattern 21
Computed sims for pattern 21 in 0.7249658107757568 s
Computing sims for pattern 22
Computed sims for pattern 22 in 0.707054615020752 s
Computing sims for pattern 23
Computed sims for pattern 23 in 0.7260925769805908 s
Computing sims for pattern 24
Computed sims for pattern 24 in 0.7154006958007812 s
Computing sims for pattern 25
Computed sims for pattern 25 in 0.7055332660675049 s
Computing sims for pattern 26
Computed sims for pattern 26 in 0.6189684867858887 s
Computing sims for pattern 27
Computed sims for pattern 27 in 0.5728561878204346 s
Computing sims for pattern 28
Computed sims for pattern 28 in 0.5550282001495361 s
Computing sims for pattern 29
Computed sims for pattern 29 in 0.13776779174804688 s
Computing sims for pattern 30
Computed sims for pattern 30 in 0.0747830867767334 s
Computing sims for pattern 31
Computed sims for pattern 31 in 0.057900428771972656 s
Cluster sizes
[3080 1213  796  736  658  616  607  604  566  548  540  531  500  489
  434  424  387  381  378  343  339  332  327  323  308  299  275  265
  256   42   13    6]
Cross-contamination matrix:
[[1.   0.84 0.62 ... 1.   0.74 0.24]
 [0.67 1.   0.73 ... 0.87 0.26 0.11]
 [0.4  0.78 1.   ... 0.41 0.31 0.22]
 ...
 [0.19 0.18 0.08 ... 1.   0.1  0.  ]
 [0.13 0.02 0.05 ... 0.15 1.   0.  ]
 [0.02 0.   0.02 ... 0.   0.02 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.77 0.55 ... 0.77 0.61 0.29]
 [0.77 1.   0.77 ... 0.7  0.52 0.3 ]
 [0.55 0.77 1.   ... 0.55 0.5  0.39]
 ...
 [0.77 0.7  0.55 ... 1.   0.61 0.2 ]
 [0.61 0.52 0.5  ... 0.61 1.   0.35]
 [0.29 0.3  0.39 ... 0.2  0.35 1.  ]]
Got 32 patterns after merging
2024-03-13 19:15:13.702887 MEMORY 16.931315712
Performing filtering
2024-03-13 19:15:13.703196 MEMORY 16.931315712
Got 30 patterns after filtering
2024-03-13 19:15:15.962366 MEMORY 16.931315712
Total time taken is 2677.65s
2024-03-13 19:15:15.962532 MEMORY 16.931315712
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 3080 out of 3080 | elapsed:    0.7s finished
/ru-auth/local/home/lzhao/anaconda3/envs/jupyter-ml-clone/lib/python3.9/site-packages/sklearn/manifold/_t_sne.py:691: FutureWarning: 'square_distances' has been introduced in 0.24 to help phase out legacy squaring behavior. The 'legacy' setting will be removed in 1.1 (renaming of 0.26), and the default setting will be changed to True. In 1.3, 'square_distances' will be removed altogether, and distances will be squared by default. Set 'square_distances'=True to silence this warning.
  warnings.warn(
/ru-auth/local/home/lzhao/anaconda3/envs/jupyter-ml-clone/lib/python3.9/site-packages/sklearn/neighbors/_base.py:175: EfficiencyWarning: Precomputed sparse input was not sorted by data.
  warnings.warn('Precomputed sparse input was not sorted by data.',
Applying subclustering to the final motifs
On pattern 0
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 3080 samples in 0.019s...
[t-SNE] Computed neighbors for 3080 samples in 0.002s...
[t-SNE] Computed conditional probabilities for sample 1000 / 3080
[t-SNE] Computed conditional probabilities for sample 2000 / 3080
[t-SNE] Computed conditional probabilities for sample 3000 / 3080
[t-SNE] Computed conditional probabilities for sample 3080 / 3080
[t-SNE] Mean sigma: 0.310437
[t-SNE] Computed conditional probabilities in 0.208s
[t-SNE] Iteration 50: error = 75.3839722, gradient norm = 0.0110091 (50 iterations in 0.282s)
[t-SNE] Iteration 100: error = 75.3831100, gradient norm = 0.0018440 (50 iterations in 0.316s)
[t-SNE] Iteration 150: error = 75.3831863, gradient norm = 0.0034199 (50 iterations in 0.330s)
[t-SNE] Iteration 200: error = 75.3831711, gradient norm = 0.0030497 (50 iterations in 0.299s)
[t-SNE] Iteration 250: error = 75.3832855, gradient norm = 0.0048630 (50 iterations in 0.261s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 75.383286
[t-SNE] Iteration 300: error = 2.6182454, gradient norm = 0.0014858 (50 iterations in 0.222s)
[t-SNE] Iteration 350: error = 2.4637711, gradient norm = 0.0004667 (50 iterations in 0.211s)
[t-SNE] Iteration 400: error = 2.3996332, gradient norm = 0.0002240 (50 iterations in 0.209s)
[t-SNE] Iteration 450: error = 2.3655419, gradient norm = 0.0001720 (50 iterations in 0.211s)
[t-SNE] Iteration 500: error = 2.3462660, gradient norm = 0.0001202 (50 iterations in 0.212s)
[t-SNE] Iteration 550: error = 2.3348825, gradient norm = 0.0000905 (50 iterations in 0.210s)
[t-SNE] Iteration 600: error = 2.3276267, gradient norm = 0.0000768 (50 iterations in 0.235s)
[t-SNE] Iteration 650: error = 2.3224905, gradient norm = 0.0000717 (50 iterations in 0.226s)
[t-SNE] Iteration 700: error = 2.3188601, gradient norm = 0.0000571 (50 iterations in 0.216s)
[t-SNE] Iteration 750: error = 2.3163152, gradient norm = 0.0000552 (50 iterations in 0.214s)
[t-SNE] Iteration 800: error = 2.3142056, gradient norm = 0.0000474 (50 iterations in 0.213s)
[t-SNE] Iteration 850: error = 2.3122826, gradient norm = 0.0000444 (50 iterations in 0.213s)
[t-SNE] Iteration 900: error = 2.3107076, gradient norm = 0.0000400 (50 iterations in 0.213s)
[t-SNE] Iteration 950: error = 2.3095260, gradient norm = 0.0000539 (50 iterations in 0.215s)
[t-SNE] Iteration 1000: error = 2.3090849, gradient norm = 0.0000470 (50 iterations in 0.217s)
[t-SNE] KL divergence after 1000 iterations: 2.309085
[t-SNE] Computed conditional probabilities for sample 1000 / 3080
[t-SNE] Computed conditional probabilities for sample 2000 / 3080
[t-SNE] Computed conditional probabilities for sample 3000 / 3080
[t-SNE] Computed conditional probabilities for sample 3080 / 3080
[t-SNE] Mean sigma: 0.310437
Beginning preprocessing + Leiden
2024-03-13 19:15:24.860951 MEMORY 16.931323904
Affmat transformed
2024-03-13 19:15:24.898045 MEMORY 16.940044288
sources, targets, weights extracted
2024-03-13 19:15:24.923335 MEMORY 16.940244992
About to launch parallel Leiden runs
2024-03-13 19:15:24.953629 MEMORY 16.940150784
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:   11.3s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   38.7s finished
Parallel Leiden runs finished
2024-03-13 19:16:03.666289 MEMORY 16.940007424
Quality: 0.4902353235315546
Quality: 0.49076876395000313
Quality: 0.49130838006947636
Quality: 0.4916421834964672
Quality: 0.49273809196211915
Quality: 0.4928388409879843
Quality: 0.4928746583707837
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 1213 out of 1213 | elapsed:    0.4s finished
Got subclusters: Counter({0: 575, 1: 490, 2: 378, 3: 374, 4: 315, 5: 246, 6: 228, 7: 200, 8: 141, 9: 133})
On pattern 1
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 1213 samples in 0.008s...
[t-SNE] Computed neighbors for 1213 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 1000 / 1213
[t-SNE] Computed conditional probabilities for sample 1213 / 1213
[t-SNE] Mean sigma: 0.330080
[t-SNE] Computed conditional probabilities in 0.084s
[t-SNE] Iteration 50: error = 67.1657867, gradient norm = 0.2327931 (50 iterations in 0.102s)
[t-SNE] Iteration 100: error = 68.1419830, gradient norm = 0.2157474 (50 iterations in 0.102s)
[t-SNE] Iteration 150: error = 68.6771317, gradient norm = 0.2236057 (50 iterations in 0.103s)
[t-SNE] Iteration 200: error = 67.3188553, gradient norm = 0.2432385 (50 iterations in 0.103s)
[t-SNE] Iteration 250: error = 67.7933426, gradient norm = 0.2242769 (50 iterations in 0.100s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 67.793343
[t-SNE] Iteration 300: error = 1.8913357, gradient norm = 0.0015184 (50 iterations in 0.093s)
[t-SNE] Iteration 350: error = 1.8308539, gradient norm = 0.0003921 (50 iterations in 0.090s)
[t-SNE] Iteration 400: error = 1.8059427, gradient norm = 0.0002208 (50 iterations in 0.091s)
[t-SNE] Iteration 450: error = 1.7964631, gradient norm = 0.0001397 (50 iterations in 0.090s)
[t-SNE] Iteration 500: error = 1.7913791, gradient norm = 0.0001248 (50 iterations in 0.090s)
[t-SNE] Iteration 550: error = 1.7872682, gradient norm = 0.0001492 (50 iterations in 0.091s)
[t-SNE] Iteration 600: error = 1.7843304, gradient norm = 0.0001008 (50 iterations in 0.090s)
[t-SNE] Iteration 650: error = 1.7826321, gradient norm = 0.0000869 (50 iterations in 0.090s)
[t-SNE] Iteration 700: error = 1.7816324, gradient norm = 0.0001018 (50 iterations in 0.090s)
[t-SNE] Iteration 750: error = 1.7806318, gradient norm = 0.0000626 (50 iterations in 0.090s)
[t-SNE] Iteration 800: error = 1.7794260, gradient norm = 0.0000968 (50 iterations in 0.090s)
[t-SNE] Iteration 850: error = 1.7786269, gradient norm = 0.0000591 (50 iterations in 0.090s)
[t-SNE] Iteration 900: error = 1.7780240, gradient norm = 0.0000551 (50 iterations in 0.090s)
[t-SNE] Iteration 950: error = 1.7770026, gradient norm = 0.0000718 (50 iterations in 0.091s)
[t-SNE] Iteration 1000: error = 1.7762960, gradient norm = 0.0000455 (50 iterations in 0.091s)
[t-SNE] KL divergence after 1000 iterations: 1.776296
[t-SNE] Computed conditional probabilities for sample 1000 / 1213
[t-SNE] Computed conditional probabilities for sample 1213 / 1213
[t-SNE] Mean sigma: 0.330080
Beginning preprocessing + Leiden
2024-03-13 19:16:07.618659 MEMORY 16.94001152
Affmat transformed
2024-03-13 19:16:07.634395 MEMORY 16.94001152
sources, targets, weights extracted
2024-03-13 19:16:07.643501 MEMORY 16.94001152
About to launch parallel Leiden runs
2024-03-13 19:16:07.651075 MEMORY 16.94001152
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    3.4s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   10.4s finished
Parallel Leiden runs finished
2024-03-13 19:16:18.060138 MEMORY 16.940015616
Quality: 0.45243850049858536
Quality: 0.4528089602036647
Quality: 0.4532255992185067
Quality: 0.4540231525664812
Quality: 0.4549031956615497
Quality: 0.4550078117571516
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 796 out of 796 | elapsed:    0.2s finished
Got subclusters: Counter({0: 276, 1: 221, 2: 179, 3: 157, 4: 127, 5: 124, 6: 123, 8: 3, 7: 3})
On pattern 2
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 796 samples in 0.006s...
[t-SNE] Computed neighbors for 796 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 796 / 796
[t-SNE] Mean sigma: 0.354427
[t-SNE] Computed conditional probabilities in 0.056s
[t-SNE] Iteration 50: error = 66.4457779, gradient norm = 0.3483562 (50 iterations in 0.548s)
[t-SNE] Iteration 100: error = 67.1007843, gradient norm = 0.3565681 (50 iterations in 0.071s)
[t-SNE] Iteration 150: error = 67.7196503, gradient norm = 0.3476531 (50 iterations in 0.075s)
[t-SNE] Iteration 200: error = 68.1629028, gradient norm = 0.3492305 (50 iterations in 0.074s)
[t-SNE] Iteration 250: error = 68.0314865, gradient norm = 0.3452548 (50 iterations in 0.071s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 68.031487
[t-SNE] Iteration 300: error = 1.6884887, gradient norm = 0.0024457 (50 iterations in 0.068s)
[t-SNE] Iteration 350: error = 1.5977871, gradient norm = 0.0007085 (50 iterations in 0.066s)
[t-SNE] Iteration 400: error = 1.5704221, gradient norm = 0.0004087 (50 iterations in 0.066s)
[t-SNE] Iteration 450: error = 1.5601751, gradient norm = 0.0003761 (50 iterations in 0.069s)
[t-SNE] Iteration 500: error = 1.5523371, gradient norm = 0.0002952 (50 iterations in 0.066s)
[t-SNE] Iteration 550: error = 1.5467552, gradient norm = 0.0002491 (50 iterations in 0.069s)
[t-SNE] Iteration 600: error = 1.5428057, gradient norm = 0.0002232 (50 iterations in 0.068s)
[t-SNE] Iteration 650: error = 1.5404468, gradient norm = 0.0000997 (50 iterations in 0.066s)
[t-SNE] Iteration 700: error = 1.5379616, gradient norm = 0.0001857 (50 iterations in 0.073s)
[t-SNE] Iteration 750: error = 1.5357288, gradient norm = 0.0002349 (50 iterations in 0.158s)
[t-SNE] Iteration 800: error = 1.5345386, gradient norm = 0.0001131 (50 iterations in 0.069s)
[t-SNE] Iteration 850: error = 1.5337214, gradient norm = 0.0000823 (50 iterations in 0.066s)
[t-SNE] Iteration 900: error = 1.5327430, gradient norm = 0.0001081 (50 iterations in 0.066s)
[t-SNE] Iteration 950: error = 1.5321856, gradient norm = 0.0000894 (50 iterations in 0.066s)
[t-SNE] Iteration 1000: error = 1.5315924, gradient norm = 0.0000886 (50 iterations in 0.067s)
[t-SNE] KL divergence after 1000 iterations: 1.531592
[t-SNE] Computed conditional probabilities for sample 796 / 796
[t-SNE] Mean sigma: 0.354427
Beginning preprocessing + Leiden
2024-03-13 19:16:21.293387 MEMORY 16.940023808
Affmat transformed
2024-03-13 19:16:21.303543 MEMORY 16.940023808
sources, targets, weights extracted
2024-03-13 19:16:21.309593 MEMORY 16.940023808
About to launch parallel Leiden runs
2024-03-13 19:16:21.331872 MEMORY 16.939855872
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    2.0s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    6.2s finished
Parallel Leiden runs finished
2024-03-13 19:16:27.590229 MEMORY 16.939855872
Quality: 0.4379511901150769
Quality: 0.4379591394496423
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 689 out of 736 | elapsed:    0.2s remaining:    0.0s
[Parallel(n_jobs=24)]: Done 736 out of 736 | elapsed:    0.2s finished
Got subclusters: Counter({0: 165, 1: 149, 2: 142, 3: 124, 4: 107, 5: 61, 6: 48})
On pattern 3
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 736 samples in 0.005s...
[t-SNE] Computed neighbors for 736 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 736 / 736
[t-SNE] Mean sigma: 0.349197
[t-SNE] Computed conditional probabilities in 0.052s
[t-SNE] Iteration 50: error = 68.1853943, gradient norm = 0.3767245 (50 iterations in 0.067s)
[t-SNE] Iteration 100: error = 68.4191818, gradient norm = 0.3786009 (50 iterations in 0.068s)
[t-SNE] Iteration 150: error = 69.8986130, gradient norm = 0.3774265 (50 iterations in 0.069s)
[t-SNE] Iteration 200: error = 70.6520538, gradient norm = 0.3657724 (50 iterations in 0.073s)
[t-SNE] Iteration 250: error = 70.6111069, gradient norm = 0.3706153 (50 iterations in 0.069s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 70.611107
[t-SNE] Iteration 300: error = 1.7418227, gradient norm = 0.0031216 (50 iterations in 0.064s)
[t-SNE] Iteration 350: error = 1.6583834, gradient norm = 0.0009532 (50 iterations in 0.066s)
[t-SNE] Iteration 400: error = 1.6427222, gradient norm = 0.0003602 (50 iterations in 0.063s)
[t-SNE] Iteration 450: error = 1.6315830, gradient norm = 0.0002852 (50 iterations in 0.063s)
[t-SNE] Iteration 500: error = 1.6265770, gradient norm = 0.0001759 (50 iterations in 0.062s)
[t-SNE] Iteration 550: error = 1.6237726, gradient norm = 0.0001784 (50 iterations in 0.065s)
[t-SNE] Iteration 600: error = 1.6209385, gradient norm = 0.0003050 (50 iterations in 0.081s)
[t-SNE] Iteration 650: error = 1.6190354, gradient norm = 0.0000906 (50 iterations in 0.068s)
[t-SNE] Iteration 700: error = 1.6155756, gradient norm = 0.0003686 (50 iterations in 0.067s)
[t-SNE] Iteration 750: error = 1.6148475, gradient norm = 0.0000881 (50 iterations in 0.065s)
[t-SNE] Iteration 800: error = 1.6140729, gradient norm = 0.0000981 (50 iterations in 0.063s)
[t-SNE] Iteration 850: error = 1.6128885, gradient norm = 0.0000898 (50 iterations in 0.063s)
[t-SNE] Iteration 900: error = 1.6125108, gradient norm = 0.0000624 (50 iterations in 0.063s)
[t-SNE] Iteration 950: error = 1.6124338, gradient norm = 0.0000562 (50 iterations in 0.064s)
[t-SNE] Iteration 1000: error = 1.6122251, gradient norm = 0.0000497 (50 iterations in 0.064s)
[t-SNE] KL divergence after 1000 iterations: 1.612225
[t-SNE] Computed conditional probabilities for sample 736 / 736
[t-SNE] Mean sigma: 0.349197
Beginning preprocessing + Leiden
2024-03-13 19:16:30.164211 MEMORY 16.939982848
Affmat transformed
2024-03-13 19:16:30.173654 MEMORY 16.939982848
sources, targets, weights extracted
2024-03-13 19:16:30.178976 MEMORY 16.939982848
About to launch parallel Leiden runs
2024-03-13 19:16:30.220610 MEMORY 16.939995136
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.8s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    5.5s finished
Parallel Leiden runs finished
2024-03-13 19:16:35.704946 MEMORY 16.939995136
Quality: 0.39179872855779996
Quality: 0.39221597936544594
Quality: 0.3929824620002208
Quality: 0.39298317741151806
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 658 out of 658 | elapsed:    0.2s finished
Got subclusters: Counter({0: 170, 1: 143, 2: 133, 3: 118, 4: 97, 5: 75})
On pattern 4
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 658 samples in 0.005s...
[t-SNE] Computed neighbors for 658 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 658 / 658
[t-SNE] Mean sigma: 0.315440
[t-SNE] Computed conditional probabilities in 0.045s
[t-SNE] Iteration 50: error = 70.6147461, gradient norm = 0.4007095 (50 iterations in 0.064s)
[t-SNE] Iteration 100: error = 71.9637985, gradient norm = 0.3768568 (50 iterations in 0.063s)
[t-SNE] Iteration 150: error = 70.9092484, gradient norm = 0.4045978 (50 iterations in 0.064s)
[t-SNE] Iteration 200: error = 73.3219223, gradient norm = 0.3781330 (50 iterations in 0.074s)
[t-SNE] Iteration 250: error = 72.5112762, gradient norm = 0.3906212 (50 iterations in 0.064s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 72.511276
[t-SNE] Iteration 300: error = 1.5749207, gradient norm = 0.0040655 (50 iterations in 0.062s)
[t-SNE] Iteration 350: error = 1.4863871, gradient norm = 0.0007609 (50 iterations in 0.062s)
[t-SNE] Iteration 400: error = 1.4704168, gradient norm = 0.0006800 (50 iterations in 0.059s)
[t-SNE] Iteration 450: error = 1.4586593, gradient norm = 0.0009306 (50 iterations in 0.059s)
[t-SNE] Iteration 500: error = 1.4537835, gradient norm = 0.0003138 (50 iterations in 0.059s)
[t-SNE] Iteration 550: error = 1.4531474, gradient norm = 0.0001560 (50 iterations in 0.061s)
[t-SNE] Iteration 600: error = 1.4521639, gradient norm = 0.0001472 (50 iterations in 0.058s)
[t-SNE] Iteration 650: error = 1.4476073, gradient norm = 0.0002055 (50 iterations in 0.062s)
[t-SNE] Iteration 700: error = 1.4444859, gradient norm = 0.0001221 (50 iterations in 0.062s)
[t-SNE] Iteration 750: error = 1.4415357, gradient norm = 0.0003327 (50 iterations in 0.059s)
[t-SNE] Iteration 800: error = 1.4406601, gradient norm = 0.0002077 (50 iterations in 0.062s)
[t-SNE] Iteration 850: error = 1.4397846, gradient norm = 0.0000983 (50 iterations in 0.059s)
[t-SNE] Iteration 900: error = 1.4388429, gradient norm = 0.0001149 (50 iterations in 0.061s)
[t-SNE] Iteration 950: error = 1.4373955, gradient norm = 0.0000736 (50 iterations in 0.059s)
[t-SNE] Iteration 1000: error = 1.4373536, gradient norm = 0.0000484 (50 iterations in 0.061s)
[t-SNE] KL divergence after 1000 iterations: 1.437354
[t-SNE] Computed conditional probabilities for sample 658 / 658
[t-SNE] Mean sigma: 0.315440
Beginning preprocessing + Leiden
2024-03-13 19:16:38.065387 MEMORY 16.940003328
Affmat transformed
2024-03-13 19:16:38.073919 MEMORY 16.940003328
sources, targets, weights extracted
2024-03-13 19:16:38.079191 MEMORY 16.940003328
About to launch parallel Leiden runs
2024-03-13 19:16:38.099240 MEMORY 16.940003328
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    5.6s finished
Parallel Leiden runs finished
2024-03-13 19:16:43.729988 MEMORY 16.940003328
Quality: 0.40462719874713216
Quality: 0.4061977069429136
Quality: 0.40628054888783904
Quality: 0.4065399502088473
Quality: 0.4068012981077799
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 616 out of 616 | elapsed:    0.2s finished
Got subclusters: Counter({0: 169, 1: 163, 2: 149, 3: 99, 4: 78})
On pattern 5
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 616 samples in 0.004s...
[t-SNE] Computed neighbors for 616 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 616 / 616
[t-SNE] Mean sigma: 0.336550
[t-SNE] Computed conditional probabilities in 0.042s
[t-SNE] Iteration 50: error = 68.5970001, gradient norm = 0.4138123 (50 iterations in 0.059s)
[t-SNE] Iteration 100: error = 70.3875809, gradient norm = 0.3987256 (50 iterations in 0.060s)
[t-SNE] Iteration 150: error = 70.1222610, gradient norm = 0.4237991 (50 iterations in 0.060s)
[t-SNE] Iteration 200: error = 72.3556442, gradient norm = 0.3992717 (50 iterations in 0.060s)
[t-SNE] Iteration 250: error = 71.7474518, gradient norm = 0.3780353 (50 iterations in 0.060s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 71.747452
[t-SNE] Iteration 300: error = 1.5643473, gradient norm = 0.0038408 (50 iterations in 0.058s)
[t-SNE] Iteration 350: error = 1.4918871, gradient norm = 0.0009639 (50 iterations in 0.062s)
[t-SNE] Iteration 400: error = 1.4575498, gradient norm = 0.0007922 (50 iterations in 0.057s)
[t-SNE] Iteration 450: error = 1.4385178, gradient norm = 0.0005304 (50 iterations in 0.064s)
[t-SNE] Iteration 500: error = 1.4263841, gradient norm = 0.0004020 (50 iterations in 0.057s)
[t-SNE] Iteration 550: error = 1.4185727, gradient norm = 0.0004728 (50 iterations in 0.063s)
[t-SNE] Iteration 600: error = 1.4149452, gradient norm = 0.0003096 (50 iterations in 0.057s)
[t-SNE] Iteration 650: error = 1.4111465, gradient norm = 0.0001719 (50 iterations in 0.057s)
[t-SNE] Iteration 700: error = 1.4072962, gradient norm = 0.0002721 (50 iterations in 0.058s)
[t-SNE] Iteration 750: error = 1.4053566, gradient norm = 0.0001207 (50 iterations in 0.056s)
[t-SNE] Iteration 800: error = 1.4046930, gradient norm = 0.0001486 (50 iterations in 0.056s)
[t-SNE] Iteration 850: error = 1.4006951, gradient norm = 0.0004316 (50 iterations in 0.056s)
[t-SNE] Iteration 900: error = 1.3947346, gradient norm = 0.0002154 (50 iterations in 0.057s)
[t-SNE] Iteration 950: error = 1.3943310, gradient norm = 0.0000815 (50 iterations in 0.056s)
[t-SNE] Iteration 1000: error = 1.3938897, gradient norm = 0.0002028 (50 iterations in 0.061s)
[t-SNE] KL divergence after 1000 iterations: 1.393890
[t-SNE] Computed conditional probabilities for sample 616 / 616
[t-SNE] Mean sigma: 0.336550
Beginning preprocessing + Leiden
2024-03-13 19:16:45.868886 MEMORY 16.940003328
Affmat transformed
2024-03-13 19:16:45.878368 MEMORY 16.940003328
sources, targets, weights extracted
2024-03-13 19:16:45.883151 MEMORY 16.940003328
About to launch parallel Leiden runs
2024-03-13 19:16:45.895072 MEMORY 16.940003328
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.8s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    5.2s finished
Parallel Leiden runs finished
2024-03-13 19:16:51.109256 MEMORY 16.940003328
Quality: 0.3913882094233253
Quality: 0.39208907408614024
Quality: 0.3931641877986332
Quality: 0.3932943962224072
Quality: 0.3934074763180538
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 607 out of 607 | elapsed:    0.2s finished
Got subclusters: Counter({0: 143, 1: 111, 2: 109, 3: 80, 4: 72, 5: 63, 6: 38})
On pattern 6
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 607 samples in 0.004s...
[t-SNE] Computed neighbors for 607 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 607 / 607
[t-SNE] Mean sigma: 0.356183
[t-SNE] Computed conditional probabilities in 0.041s
[t-SNE] Iteration 50: error = 67.1393127, gradient norm = 0.4344441 (50 iterations in 0.059s)
[t-SNE] Iteration 100: error = 69.8182983, gradient norm = 0.4190685 (50 iterations in 0.061s)
[t-SNE] Iteration 150: error = 67.5684128, gradient norm = 0.4438362 (50 iterations in 0.067s)
[t-SNE] Iteration 200: error = 71.2489243, gradient norm = 0.3988438 (50 iterations in 0.069s)
[t-SNE] Iteration 250: error = 70.6121750, gradient norm = 0.3979503 (50 iterations in 0.060s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 70.612175
[t-SNE] Iteration 300: error = 1.5604191, gradient norm = 0.0028529 (50 iterations in 0.073s)
[t-SNE] Iteration 350: error = 1.4942484, gradient norm = 0.0009189 (50 iterations in 0.086s)
[t-SNE] Iteration 400: error = 1.4468212, gradient norm = 0.0010099 (50 iterations in 0.096s)
[t-SNE] Iteration 450: error = 1.4347054, gradient norm = 0.0002636 (50 iterations in 0.057s)
[t-SNE] Iteration 500: error = 1.4307232, gradient norm = 0.0002894 (50 iterations in 0.087s)
[t-SNE] Iteration 550: error = 1.4255856, gradient norm = 0.0004174 (50 iterations in 0.086s)
[t-SNE] Iteration 600: error = 1.4234753, gradient norm = 0.0002489 (50 iterations in 0.082s)
[t-SNE] Iteration 650: error = 1.4214963, gradient norm = 0.0001876 (50 iterations in 0.058s)
[t-SNE] Iteration 700: error = 1.4204264, gradient norm = 0.0002072 (50 iterations in 0.085s)
[t-SNE] Iteration 750: error = 1.4202291, gradient norm = 0.0000929 (50 iterations in 0.059s)
[t-SNE] Iteration 800: error = 1.4199313, gradient norm = 0.0001079 (50 iterations in 0.057s)
[t-SNE] Iteration 850: error = 1.4152291, gradient norm = 0.0003130 (50 iterations in 0.059s)
[t-SNE] Iteration 900: error = 1.4092948, gradient norm = 0.0002624 (50 iterations in 0.058s)
[t-SNE] Iteration 950: error = 1.4075265, gradient norm = 0.0003343 (50 iterations in 0.057s)
[t-SNE] Iteration 1000: error = 1.4071051, gradient norm = 0.0000763 (50 iterations in 0.057s)
[t-SNE] KL divergence after 1000 iterations: 1.407105
[t-SNE] Computed conditional probabilities for sample 607 / 607
[t-SNE] Mean sigma: 0.356183
Beginning preprocessing + Leiden
2024-03-13 19:16:53.420806 MEMORY 16.940027904
Affmat transformed
2024-03-13 19:16:53.428243 MEMORY 16.940027904
sources, targets, weights extracted
2024-03-13 19:16:53.432131 MEMORY 16.940027904
About to launch parallel Leiden runs
2024-03-13 19:16:53.437759 MEMORY 16.940027904
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.5s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    4.9s finished
Parallel Leiden runs finished
2024-03-13 19:16:58.322199 MEMORY 16.940027904
Quality: 0.4038941497328544
Quality: 0.4039105472776706
Quality: 0.40425323251868533
Quality: 0.4048929721675606
Quality: 0.40502549258927795
Quality: 0.4058889798849083
Quality: 0.40607571811108717
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 604 out of 604 | elapsed:    0.2s finished
Got subclusters: Counter({0: 124, 1: 122, 2: 107, 3: 103, 4: 95, 5: 56})
On pattern 7
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 604 samples in 0.004s...
[t-SNE] Computed neighbors for 604 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 604 / 604
[t-SNE] Mean sigma: 0.368420
[t-SNE] Computed conditional probabilities in 0.041s
[t-SNE] Iteration 50: error = 68.8986664, gradient norm = 0.4203741 (50 iterations in 0.060s)
[t-SNE] Iteration 100: error = 70.8254776, gradient norm = 0.4104508 (50 iterations in 0.060s)
[t-SNE] Iteration 150: error = 71.4674072, gradient norm = 0.3790850 (50 iterations in 0.060s)
[t-SNE] Iteration 200: error = 69.5015411, gradient norm = 0.4102627 (50 iterations in 0.063s)
[t-SNE] Iteration 250: error = 71.7051544, gradient norm = 0.3969922 (50 iterations in 0.059s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 71.705154
[t-SNE] Iteration 300: error = 1.6085498, gradient norm = 0.0033433 (50 iterations in 0.056s)
[t-SNE] Iteration 350: error = 1.5492920, gradient norm = 0.0008572 (50 iterations in 0.055s)
[t-SNE] Iteration 400: error = 1.5246392, gradient norm = 0.0006081 (50 iterations in 0.055s)
[t-SNE] Iteration 450: error = 1.5144089, gradient norm = 0.0002842 (50 iterations in 0.054s)
[t-SNE] Iteration 500: error = 1.5098300, gradient norm = 0.0002836 (50 iterations in 0.055s)
[t-SNE] Iteration 550: error = 1.5051653, gradient norm = 0.0003207 (50 iterations in 0.055s)
[t-SNE] Iteration 600: error = 1.5027161, gradient norm = 0.0003238 (50 iterations in 0.054s)
[t-SNE] Iteration 650: error = 1.5007720, gradient norm = 0.0001456 (50 iterations in 0.055s)
[t-SNE] Iteration 700: error = 1.4981985, gradient norm = 0.0001967 (50 iterations in 0.055s)
[t-SNE] Iteration 750: error = 1.4978747, gradient norm = 0.0000856 (50 iterations in 0.054s)
[t-SNE] Iteration 800: error = 1.4971133, gradient norm = 0.0000758 (50 iterations in 0.054s)
[t-SNE] Iteration 850: error = 1.4968641, gradient norm = 0.0000745 (50 iterations in 0.054s)
[t-SNE] Iteration 900: error = 1.4968592, gradient norm = 0.0000562 (50 iterations in 0.054s)
[t-SNE] Iteration 950: error = 1.4969261, gradient norm = 0.0000536 (50 iterations in 0.055s)
[t-SNE] Iteration 1000: error = 1.4969118, gradient norm = 0.0000365 (50 iterations in 0.054s)
[t-SNE] KL divergence after 1000 iterations: 1.496912
[t-SNE] Computed conditional probabilities for sample 604 / 604
[t-SNE] Mean sigma: 0.368420
Beginning preprocessing + Leiden
2024-03-13 19:17:00.376983 MEMORY 16.940036096
Affmat transformed
2024-03-13 19:17:00.384571 MEMORY 16.940036096
sources, targets, weights extracted
2024-03-13 19:17:00.388803 MEMORY 16.940036096
About to launch parallel Leiden runs
2024-03-13 19:17:00.394723 MEMORY 16.940036096
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    5.4s finished
Parallel Leiden runs finished
2024-03-13 19:17:05.841405 MEMORY 16.940036096
Quality: 0.40233811606134223
Quality: 0.40274741565285826
Quality: 0.40448469038714646
Quality: 0.40469605739276926
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 566 out of 566 | elapsed:    0.1s finished
Got subclusters: Counter({0: 126, 1: 99, 2: 92, 3: 90, 4: 70, 5: 69, 6: 58})
On pattern 8
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 566 samples in 0.004s...
[t-SNE] Computed neighbors for 566 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 566 / 566
[t-SNE] Mean sigma: 0.344144
[t-SNE] Computed conditional probabilities in 0.039s
[t-SNE] Iteration 50: error = 67.6253052, gradient norm = 0.4329978 (50 iterations in 0.059s)
[t-SNE] Iteration 100: error = 68.4101868, gradient norm = 0.4553627 (50 iterations in 0.059s)
[t-SNE] Iteration 150: error = 70.8851395, gradient norm = 0.4043179 (50 iterations in 0.057s)
[t-SNE] Iteration 200: error = 70.9482574, gradient norm = 0.4090775 (50 iterations in 0.056s)
[t-SNE] Iteration 250: error = 70.9318008, gradient norm = 0.4063742 (50 iterations in 0.058s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 70.931801
[t-SNE] Iteration 300: error = 1.5037434, gradient norm = 0.0032764 (50 iterations in 0.054s)
[t-SNE] Iteration 350: error = 1.4488161, gradient norm = 0.0011045 (50 iterations in 0.053s)
[t-SNE] Iteration 400: error = 1.4294893, gradient norm = 0.0005408 (50 iterations in 0.053s)
[t-SNE] Iteration 450: error = 1.4200486, gradient norm = 0.0005300 (50 iterations in 0.053s)
[t-SNE] Iteration 500: error = 1.4111778, gradient norm = 0.0003733 (50 iterations in 0.053s)
[t-SNE] Iteration 550: error = 1.4078442, gradient norm = 0.0001506 (50 iterations in 0.053s)
[t-SNE] Iteration 600: error = 1.4055730, gradient norm = 0.0002620 (50 iterations in 0.053s)
[t-SNE] Iteration 650: error = 1.4045146, gradient norm = 0.0001411 (50 iterations in 0.053s)
[t-SNE] Iteration 700: error = 1.4025193, gradient norm = 0.0003599 (50 iterations in 0.053s)
[t-SNE] Iteration 750: error = 1.3897988, gradient norm = 0.0002364 (50 iterations in 0.053s)
[t-SNE] Iteration 800: error = 1.3864776, gradient norm = 0.0003382 (50 iterations in 0.055s)
[t-SNE] Iteration 850: error = 1.3786522, gradient norm = 0.0004507 (50 iterations in 0.055s)
[t-SNE] Iteration 900: error = 1.3729979, gradient norm = 0.0003495 (50 iterations in 0.053s)
[t-SNE] Iteration 950: error = 1.3727965, gradient norm = 0.0001393 (50 iterations in 0.053s)
[t-SNE] Iteration 1000: error = 1.3683066, gradient norm = 0.0003965 (50 iterations in 0.053s)
[t-SNE] KL divergence after 1000 iterations: 1.368307
[t-SNE] Computed conditional probabilities for sample 566 / 566
[t-SNE] Mean sigma: 0.344144
Beginning preprocessing + Leiden
2024-03-13 19:17:07.745583 MEMORY 16.940036096
Affmat transformed
2024-03-13 19:17:07.752881 MEMORY 16.940036096
sources, targets, weights extracted
2024-03-13 19:17:07.757352 MEMORY 16.940036096
About to launch parallel Leiden runs
2024-03-13 19:17:07.773469 MEMORY 16.940036096
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.5s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    4.5s finished
Parallel Leiden runs finished
2024-03-13 19:17:12.312138 MEMORY 16.940036096
Quality: 0.3759535987328351
Quality: 0.38051366039444623
Quality: 0.3812098057384266
Quality: 0.3833864375040983
Quality: 0.38352219080684974
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 548 out of 548 | elapsed:    0.1s finished
Got subclusters: Counter({0: 118, 1: 114, 2: 99, 3: 92, 4: 84, 5: 59})
On pattern 9
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 548 samples in 0.004s...
[t-SNE] Computed neighbors for 548 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 548 / 548
[t-SNE] Mean sigma: 0.349150
[t-SNE] Computed conditional probabilities in 0.037s
[t-SNE] Iteration 50: error = 69.4958878, gradient norm = 0.4396561 (50 iterations in 0.075s)
[t-SNE] Iteration 100: error = 71.7263870, gradient norm = 0.4120415 (50 iterations in 0.056s)
[t-SNE] Iteration 150: error = 73.6335068, gradient norm = 0.3859208 (50 iterations in 0.057s)
[t-SNE] Iteration 200: error = 70.9048309, gradient norm = 0.4155859 (50 iterations in 0.056s)
[t-SNE] Iteration 250: error = 72.1242218, gradient norm = 0.4105149 (50 iterations in 0.056s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 72.124222
[t-SNE] Iteration 300: error = 1.5952883, gradient norm = 0.0031875 (50 iterations in 0.056s)
[t-SNE] Iteration 350: error = 1.5123345, gradient norm = 0.0008376 (50 iterations in 0.053s)
[t-SNE] Iteration 400: error = 1.4775512, gradient norm = 0.0009085 (50 iterations in 0.052s)
[t-SNE] Iteration 450: error = 1.4590907, gradient norm = 0.0005870 (50 iterations in 0.052s)
[t-SNE] Iteration 500: error = 1.4455558, gradient norm = 0.0007237 (50 iterations in 0.053s)
[t-SNE] Iteration 550: error = 1.4386728, gradient norm = 0.0003192 (50 iterations in 0.052s)
[t-SNE] Iteration 600: error = 1.4320734, gradient norm = 0.0003354 (50 iterations in 0.052s)
[t-SNE] Iteration 650: error = 1.4285953, gradient norm = 0.0003484 (50 iterations in 0.052s)
[t-SNE] Iteration 700: error = 1.4252272, gradient norm = 0.0002913 (50 iterations in 0.052s)
[t-SNE] Iteration 750: error = 1.4240185, gradient norm = 0.0001917 (50 iterations in 0.052s)
[t-SNE] Iteration 800: error = 1.4199539, gradient norm = 0.0004505 (50 iterations in 0.052s)
[t-SNE] Iteration 850: error = 1.4171740, gradient norm = 0.0001314 (50 iterations in 0.052s)
[t-SNE] Iteration 900: error = 1.4164194, gradient norm = 0.0003477 (50 iterations in 0.052s)
[t-SNE] Iteration 950: error = 1.4160925, gradient norm = 0.0000496 (50 iterations in 0.052s)
[t-SNE] Iteration 1000: error = 1.4162728, gradient norm = 0.0000431 (50 iterations in 0.052s)
[t-SNE] KL divergence after 1000 iterations: 1.416273
[t-SNE] Computed conditional probabilities for sample 548 / 548
[t-SNE] Mean sigma: 0.349149
Beginning preprocessing + Leiden
2024-03-13 19:17:14.225340 MEMORY 16.940036096
Affmat transformed
2024-03-13 19:17:14.232455 MEMORY 16.940036096
sources, targets, weights extracted
2024-03-13 19:17:14.236661 MEMORY 16.940036096
About to launch parallel Leiden runs
2024-03-13 19:17:14.242179 MEMORY 16.940036096
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.4s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    4.5s finished
Parallel Leiden runs finished
2024-03-13 19:17:18.758203 MEMORY 16.940036096
Quality: 0.3807553248206827
Quality: 0.38196415432540193
Quality: 0.3824143527642725
Quality: 0.38247335543866035
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 540 out of 540 | elapsed:    0.1s finished
Got subclusters: Counter({0: 127, 1: 114, 2: 105, 3: 70, 4: 66, 5: 62, 6: 4})
On pattern 10
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 540 samples in 0.004s...
[t-SNE] Computed neighbors for 540 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 540 / 540
[t-SNE] Mean sigma: 0.374947
[t-SNE] Computed conditional probabilities in 0.036s
[t-SNE] Iteration 50: error = 65.7489700, gradient norm = 0.4729214 (50 iterations in 0.055s)
[t-SNE] Iteration 100: error = 66.0850067, gradient norm = 0.4743030 (50 iterations in 0.055s)
[t-SNE] Iteration 150: error = 68.7325668, gradient norm = 0.4301265 (50 iterations in 0.055s)
[t-SNE] Iteration 200: error = 68.9221191, gradient norm = 0.4312453 (50 iterations in 0.057s)
[t-SNE] Iteration 250: error = 69.7367706, gradient norm = 0.4243377 (50 iterations in 0.055s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 69.736771
[t-SNE] Iteration 300: error = 1.4762640, gradient norm = 0.0031777 (50 iterations in 0.055s)
[t-SNE] Iteration 350: error = 1.4101985, gradient norm = 0.0012023 (50 iterations in 0.053s)
[t-SNE] Iteration 400: error = 1.3916081, gradient norm = 0.0005481 (50 iterations in 0.053s)
[t-SNE] Iteration 450: error = 1.3832524, gradient norm = 0.0002091 (50 iterations in 0.054s)
[t-SNE] Iteration 500: error = 1.3799800, gradient norm = 0.0002821 (50 iterations in 0.053s)
[t-SNE] Iteration 550: error = 1.3726927, gradient norm = 0.0002126 (50 iterations in 0.052s)
[t-SNE] Iteration 600: error = 1.3691505, gradient norm = 0.0003390 (50 iterations in 0.051s)
[t-SNE] Iteration 650: error = 1.3682063, gradient norm = 0.0001344 (50 iterations in 0.055s)
[t-SNE] Iteration 700: error = 1.3677908, gradient norm = 0.0000872 (50 iterations in 0.054s)
[t-SNE] Iteration 750: error = 1.3674231, gradient norm = 0.0000873 (50 iterations in 0.054s)
[t-SNE] Iteration 800: error = 1.3673246, gradient norm = 0.0001558 (50 iterations in 0.051s)
[t-SNE] Iteration 850: error = 1.3662040, gradient norm = 0.0001510 (50 iterations in 0.055s)
[t-SNE] Iteration 900: error = 1.3655522, gradient norm = 0.0001069 (50 iterations in 0.053s)
[t-SNE] Iteration 950: error = 1.3649462, gradient norm = 0.0001069 (50 iterations in 0.057s)
[t-SNE] Iteration 1000: error = 1.3638560, gradient norm = 0.0000775 (50 iterations in 0.053s)
[t-SNE] KL divergence after 1000 iterations: 1.363856
[t-SNE] Computed conditional probabilities for sample 540 / 540
[t-SNE] Mean sigma: 0.374947
Beginning preprocessing + Leiden
2024-03-13 19:17:20.594229 MEMORY 16.940044288
Affmat transformed
2024-03-13 19:17:20.601267 MEMORY 16.940044288
sources, targets, weights extracted
2024-03-13 19:17:20.605341 MEMORY 16.940044288
About to launch parallel Leiden runs
2024-03-13 19:17:20.660178 MEMORY 16.940044288
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.4s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    4.2s finished
Parallel Leiden runs finished
2024-03-13 19:17:24.832421 MEMORY 16.940044288
Quality: 0.41743928341593006
Quality: 0.4177971066589553
Quality: 0.4179845270841768
Quality: 0.4182970063983987
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 531 out of 531 | elapsed:    0.1s finished
Got subclusters: Counter({0: 111, 1: 101, 2: 98, 3: 84, 4: 70, 5: 50, 6: 17, 7: 9})
On pattern 11
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 531 samples in 0.004s...
[t-SNE] Computed neighbors for 531 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 531 / 531
[t-SNE] Mean sigma: 0.350245
[t-SNE] Computed conditional probabilities in 0.037s
[t-SNE] Iteration 50: error = 67.1871948, gradient norm = 0.4694045 (50 iterations in 0.058s)
[t-SNE] Iteration 100: error = 69.1841278, gradient norm = 0.4388412 (50 iterations in 0.055s)
[t-SNE] Iteration 150: error = 70.1520081, gradient norm = 0.4185680 (50 iterations in 0.055s)
[t-SNE] Iteration 200: error = 70.8273849, gradient norm = 0.4498127 (50 iterations in 0.057s)
[t-SNE] Iteration 250: error = 72.2254944, gradient norm = 0.4313347 (50 iterations in 0.055s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 72.225494
[t-SNE] Iteration 300: error = 1.5597675, gradient norm = 0.0035414 (50 iterations in 0.054s)
[t-SNE] Iteration 350: error = 1.4177915, gradient norm = 0.0012529 (50 iterations in 0.052s)
[t-SNE] Iteration 400: error = 1.3904474, gradient norm = 0.0014979 (50 iterations in 0.053s)
[t-SNE] Iteration 450: error = 1.3535472, gradient norm = 0.0006840 (50 iterations in 0.056s)
[t-SNE] Iteration 500: error = 1.3383003, gradient norm = 0.0010144 (50 iterations in 0.052s)
[t-SNE] Iteration 550: error = 1.3264663, gradient norm = 0.0003432 (50 iterations in 0.054s)
[t-SNE] Iteration 600: error = 1.3237596, gradient norm = 0.0002679 (50 iterations in 0.051s)
[t-SNE] Iteration 650: error = 1.3119099, gradient norm = 0.0006880 (50 iterations in 0.051s)
[t-SNE] Iteration 700: error = 1.3092263, gradient norm = 0.0002542 (50 iterations in 0.054s)
[t-SNE] Iteration 750: error = 1.3007592, gradient norm = 0.0009348 (50 iterations in 0.054s)
[t-SNE] Iteration 800: error = 1.2979213, gradient norm = 0.0002951 (50 iterations in 0.051s)
[t-SNE] Iteration 850: error = 1.2969284, gradient norm = 0.0001651 (50 iterations in 0.056s)
[t-SNE] Iteration 900: error = 1.2967515, gradient norm = 0.0000955 (50 iterations in 0.052s)
[t-SNE] Iteration 950: error = 1.2965652, gradient norm = 0.0000687 (50 iterations in 0.054s)
[t-SNE] Iteration 1000: error = 1.2966131, gradient norm = 0.0000354 (50 iterations in 0.051s)
[t-SNE] KL divergence after 1000 iterations: 1.296613
[t-SNE] Computed conditional probabilities for sample 531 / 531
[t-SNE] Mean sigma: 0.350245
Beginning preprocessing + Leiden
2024-03-13 19:17:26.669605 MEMORY 16.94005248
Affmat transformed
2024-03-13 19:17:26.676819 MEMORY 16.94005248
sources, targets, weights extracted
2024-03-13 19:17:26.680648 MEMORY 16.94005248
About to launch parallel Leiden runs
2024-03-13 19:17:26.701465 MEMORY 16.94005248
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.4s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    4.1s finished
Parallel Leiden runs finished
2024-03-13 19:17:30.825730 MEMORY 16.94005248
Quality: 0.40442241006176854
Quality: 0.40461784867812545
Quality: 0.4046957980545133
Quality: 0.40473064544725984
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 344 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 500 out of 500 | elapsed:    0.2s finished
Got subclusters: Counter({0: 105, 1: 105, 2: 97, 3: 86, 4: 72, 5: 44, 6: 12, 7: 10})
On pattern 12
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 500 samples in 0.004s...
[t-SNE] Computed neighbors for 500 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 500 / 500
[t-SNE] Mean sigma: 0.368848
[t-SNE] Computed conditional probabilities in 0.034s
[t-SNE] Iteration 50: error = 66.6286316, gradient norm = 0.4796522 (50 iterations in 0.052s)
[t-SNE] Iteration 100: error = 67.7842407, gradient norm = 0.4602169 (50 iterations in 0.053s)
[t-SNE] Iteration 150: error = 69.3674774, gradient norm = 0.4537892 (50 iterations in 0.053s)
[t-SNE] Iteration 200: error = 69.9529724, gradient norm = 0.4271145 (50 iterations in 0.053s)
[t-SNE] Iteration 250: error = 67.9761810, gradient norm = 0.4665921 (50 iterations in 0.052s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 67.976181
[t-SNE] Iteration 300: error = 1.4468573, gradient norm = 0.0035003 (50 iterations in 0.050s)
[t-SNE] Iteration 350: error = 1.4017615, gradient norm = 0.0008935 (50 iterations in 0.050s)
[t-SNE] Iteration 400: error = 1.3877366, gradient norm = 0.0005775 (50 iterations in 0.049s)
[t-SNE] Iteration 450: error = 1.3725595, gradient norm = 0.0005234 (50 iterations in 0.049s)
[t-SNE] Iteration 500: error = 1.3658377, gradient norm = 0.0003745 (50 iterations in 0.049s)
[t-SNE] Iteration 550: error = 1.3639754, gradient norm = 0.0001246 (50 iterations in 0.049s)
[t-SNE] Iteration 600: error = 1.3614680, gradient norm = 0.0001821 (50 iterations in 0.049s)
[t-SNE] Iteration 650: error = 1.3597784, gradient norm = 0.0001869 (50 iterations in 0.049s)
[t-SNE] Iteration 700: error = 1.3581442, gradient norm = 0.0002078 (50 iterations in 0.051s)
[t-SNE] Iteration 750: error = 1.3576566, gradient norm = 0.0000800 (50 iterations in 0.049s)
[t-SNE] Iteration 800: error = 1.3577794, gradient norm = 0.0000755 (50 iterations in 0.054s)
[t-SNE] Iteration 850: error = 1.3576001, gradient norm = 0.0002793 (50 iterations in 0.051s)
[t-SNE] Iteration 900: error = 1.3576379, gradient norm = 0.0000850 (50 iterations in 0.050s)
[t-SNE] Iteration 950: error = 1.3575658, gradient norm = 0.0000416 (50 iterations in 0.049s)
[t-SNE] Iteration 1000: error = 1.3575372, gradient norm = 0.0000404 (50 iterations in 0.051s)
[t-SNE] KL divergence after 1000 iterations: 1.357537
[t-SNE] Computed conditional probabilities for sample 500 / 500
[t-SNE] Mean sigma: 0.368848
Beginning preprocessing + Leiden
2024-03-13 19:17:32.684826 MEMORY 16.94005248
Affmat transformed
2024-03-13 19:17:32.691412 MEMORY 16.94005248
sources, targets, weights extracted
2024-03-13 19:17:32.694891 MEMORY 16.94005248
About to launch parallel Leiden runs
2024-03-13 19:17:32.701196 MEMORY 16.94005248
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.4s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    4.5s finished
Parallel Leiden runs finished
2024-03-13 19:17:37.165356 MEMORY 16.94005248
Quality: 0.36379782577295267
Quality: 0.36510461404021877
Quality: 0.36687227175700293
Quality: 0.3672418405941036
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 344 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 489 out of 489 | elapsed:    0.2s finished
Got subclusters: Counter({0: 105, 1: 94, 2: 93, 3: 76, 4: 61, 5: 50, 6: 21})
On pattern 13
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 489 samples in 0.003s...
[t-SNE] Computed neighbors for 489 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 489 / 489
[t-SNE] Mean sigma: 0.366039
[t-SNE] Computed conditional probabilities in 0.032s
[t-SNE] Iteration 50: error = 66.3992386, gradient norm = 0.4787329 (50 iterations in 0.050s)
[t-SNE] Iteration 100: error = 68.9754944, gradient norm = 0.4454705 (50 iterations in 0.052s)
[t-SNE] Iteration 150: error = 67.5074234, gradient norm = 0.4619263 (50 iterations in 0.050s)
[t-SNE] Iteration 200: error = 68.1828842, gradient norm = 0.4522294 (50 iterations in 0.051s)
[t-SNE] Iteration 250: error = 67.4520416, gradient norm = 0.4646121 (50 iterations in 0.051s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 67.452042
[t-SNE] Iteration 300: error = 1.3672122, gradient norm = 0.0035300 (50 iterations in 0.052s)
[t-SNE] Iteration 350: error = 1.3167301, gradient norm = 0.0011824 (50 iterations in 0.051s)
[t-SNE] Iteration 400: error = 1.3025006, gradient norm = 0.0004874 (50 iterations in 0.051s)
[t-SNE] Iteration 450: error = 1.2908542, gradient norm = 0.0003818 (50 iterations in 0.053s)
[t-SNE] Iteration 500: error = 1.2811904, gradient norm = 0.0003315 (50 iterations in 0.053s)
[t-SNE] Iteration 550: error = 1.2787009, gradient norm = 0.0003171 (50 iterations in 0.051s)
[t-SNE] Iteration 600: error = 1.2761074, gradient norm = 0.0001842 (50 iterations in 0.051s)
[t-SNE] Iteration 650: error = 1.2757859, gradient norm = 0.0001010 (50 iterations in 0.051s)
[t-SNE] Iteration 700: error = 1.2759252, gradient norm = 0.0001303 (50 iterations in 0.052s)
[t-SNE] Iteration 750: error = 1.2750647, gradient norm = 0.0001014 (50 iterations in 0.051s)
[t-SNE] Iteration 800: error = 1.2747140, gradient norm = 0.0002741 (50 iterations in 0.052s)
[t-SNE] Iteration 850: error = 1.2725167, gradient norm = 0.0000724 (50 iterations in 0.051s)
[t-SNE] Iteration 900: error = 1.2725174, gradient norm = 0.0000482 (50 iterations in 0.051s)
[t-SNE] Iteration 950: error = 1.2724155, gradient norm = 0.0000697 (50 iterations in 0.051s)
[t-SNE] Iteration 1000: error = 1.2724913, gradient norm = 0.0000488 (50 iterations in 0.052s)
[t-SNE] KL divergence after 1000 iterations: 1.272491
[t-SNE] Computed conditional probabilities for sample 489 / 489
[t-SNE] Mean sigma: 0.366039
Beginning preprocessing + Leiden
2024-03-13 19:17:38.973446 MEMORY 16.940060672
Affmat transformed
2024-03-13 19:17:38.979355 MEMORY 16.940060672
sources, targets, weights extracted
2024-03-13 19:17:38.982606 MEMORY 16.940060672
About to launch parallel Leiden runs
2024-03-13 19:17:39.007354 MEMORY 16.940060672
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.3s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    4.0s finished
Parallel Leiden runs finished
2024-03-13 19:17:43.026165 MEMORY 16.940572672
Quality: 0.38623697777018684
Quality: 0.38707472952805766
Quality: 0.38877916085813913
Quality: 0.38890957836803947
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 344 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 434 out of 434 | elapsed:    0.1s finished
Got subclusters: Counter({0: 95, 1: 83, 2: 79, 3: 74, 4: 65, 5: 53, 6: 40})
On pattern 14
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 434 samples in 0.003s...
[t-SNE] Computed neighbors for 434 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 434 / 434
[t-SNE] Mean sigma: 0.356033
[t-SNE] Computed conditional probabilities in 0.030s
[t-SNE] Iteration 50: error = 68.3879929, gradient norm = 0.4717655 (50 iterations in 0.048s)
[t-SNE] Iteration 100: error = 71.4504395, gradient norm = 0.4514084 (50 iterations in 0.047s)
[t-SNE] Iteration 150: error = 71.5871811, gradient norm = 0.4447333 (50 iterations in 0.047s)
[t-SNE] Iteration 200: error = 71.5211716, gradient norm = 0.4450602 (50 iterations in 0.047s)
[t-SNE] Iteration 250: error = 73.1721420, gradient norm = 0.4346749 (50 iterations in 0.048s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 73.172142
[t-SNE] Iteration 300: error = 1.5374339, gradient norm = 0.0034414 (50 iterations in 0.048s)
[t-SNE] Iteration 350: error = 1.3632673, gradient norm = 0.0027215 (50 iterations in 0.046s)
[t-SNE] Iteration 400: error = 1.2916118, gradient norm = 0.0014576 (50 iterations in 0.046s)
[t-SNE] Iteration 450: error = 1.2114079, gradient norm = 0.0012165 (50 iterations in 0.046s)
[t-SNE] Iteration 500: error = 1.1909157, gradient norm = 0.0005292 (50 iterations in 0.045s)
[t-SNE] Iteration 550: error = 1.1757679, gradient norm = 0.0010542 (50 iterations in 0.045s)
[t-SNE] Iteration 600: error = 1.1704605, gradient norm = 0.0003794 (50 iterations in 0.045s)
[t-SNE] Iteration 650: error = 1.1665100, gradient norm = 0.0003612 (50 iterations in 0.045s)
[t-SNE] Iteration 700: error = 1.1658406, gradient norm = 0.0000931 (50 iterations in 0.045s)
[t-SNE] Iteration 750: error = 1.1648589, gradient norm = 0.0007031 (50 iterations in 0.046s)
[t-SNE] Iteration 800: error = 1.1640829, gradient norm = 0.0000917 (50 iterations in 0.045s)
[t-SNE] Iteration 850: error = 1.1639223, gradient norm = 0.0000727 (50 iterations in 0.047s)
[t-SNE] Iteration 900: error = 1.1638441, gradient norm = 0.0000815 (50 iterations in 0.045s)
[t-SNE] Iteration 950: error = 1.1637955, gradient norm = 0.0000786 (50 iterations in 0.045s)
[t-SNE] Iteration 1000: error = 1.1612865, gradient norm = 0.0002894 (50 iterations in 0.045s)
[t-SNE] KL divergence after 1000 iterations: 1.161286
[t-SNE] Computed conditional probabilities for sample 434 / 434
[t-SNE] Mean sigma: 0.356033
Beginning preprocessing + Leiden
2024-03-13 19:17:44.621848 MEMORY 16.940572672
Affmat transformed
2024-03-13 19:17:44.627403 MEMORY 16.940572672
sources, targets, weights extracted
2024-03-13 19:17:44.630415 MEMORY 16.940572672
About to launch parallel Leiden runs
2024-03-13 19:17:44.651979 MEMORY 16.940572672
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.2s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    3.5s finished
Parallel Leiden runs finished
2024-03-13 19:17:48.175158 MEMORY 16.940572672
Quality: 0.39944737389861684
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 344 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 424 out of 424 | elapsed:    0.1s finished
Got subclusters: Counter({0: 95, 1: 81, 2: 69, 3: 57, 4: 53, 5: 48, 6: 31})
On pattern 15
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 424 samples in 0.003s...
[t-SNE] Computed neighbors for 424 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 424 / 424
[t-SNE] Mean sigma: 0.382347
[t-SNE] Computed conditional probabilities in 0.028s
[t-SNE] Iteration 50: error = 63.3258591, gradient norm = 0.5189253 (50 iterations in 0.044s)
[t-SNE] Iteration 100: error = 67.3834610, gradient norm = 0.4677086 (50 iterations in 0.047s)
[t-SNE] Iteration 150: error = 66.0780258, gradient norm = 0.4933512 (50 iterations in 0.044s)
[t-SNE] Iteration 200: error = 69.5464859, gradient norm = 0.4484716 (50 iterations in 0.047s)
[t-SNE] Iteration 250: error = 68.2787933, gradient norm = 0.4510680 (50 iterations in 0.045s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 68.278793
[t-SNE] Iteration 300: error = 1.2792211, gradient norm = 0.0031852 (50 iterations in 0.043s)
[t-SNE] Iteration 350: error = 1.2522213, gradient norm = 0.0005530 (50 iterations in 0.042s)
[t-SNE] Iteration 400: error = 1.2432872, gradient norm = 0.0005124 (50 iterations in 0.043s)
[t-SNE] Iteration 450: error = 1.2274827, gradient norm = 0.0007865 (50 iterations in 0.043s)
[t-SNE] Iteration 500: error = 1.2072694, gradient norm = 0.0008268 (50 iterations in 0.042s)
[t-SNE] Iteration 550: error = 1.1891059, gradient norm = 0.0010256 (50 iterations in 0.042s)
[t-SNE] Iteration 600: error = 1.1781663, gradient norm = 0.0010580 (50 iterations in 0.042s)
[t-SNE] Iteration 650: error = 1.1738746, gradient norm = 0.0003402 (50 iterations in 0.042s)
[t-SNE] Iteration 700: error = 1.1701699, gradient norm = 0.0004626 (50 iterations in 0.045s)
[t-SNE] Iteration 750: error = 1.1668593, gradient norm = 0.0002217 (50 iterations in 0.042s)
[t-SNE] Iteration 800: error = 1.1664283, gradient norm = 0.0001238 (50 iterations in 0.042s)
[t-SNE] Iteration 850: error = 1.1659899, gradient norm = 0.0000723 (50 iterations in 0.042s)
[t-SNE] Iteration 900: error = 1.1662519, gradient norm = 0.0000626 (50 iterations in 0.044s)
[t-SNE] Iteration 950: error = 1.1660408, gradient norm = 0.0000745 (50 iterations in 0.043s)
[t-SNE] Iteration 1000: error = 1.1660919, gradient norm = 0.0000456 (50 iterations in 0.043s)
[t-SNE] KL divergence after 1000 iterations: 1.166092
[t-SNE] Computed conditional probabilities for sample 424 / 424
[t-SNE] Mean sigma: 0.382347
Beginning preprocessing + Leiden
2024-03-13 19:17:49.698681 MEMORY 16.940580864
Affmat transformed
2024-03-13 19:17:49.704179 MEMORY 16.940580864
sources, targets, weights extracted
2024-03-13 19:17:49.706695 MEMORY 16.940580864
About to launch parallel Leiden runs
2024-03-13 19:17:49.725761 MEMORY 16.940580864
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.1s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    3.6s finished
Parallel Leiden runs finished
2024-03-13 19:17:53.296142 MEMORY 16.940580864
Quality: 0.40556644201744557
Quality: 0.4063336940319134
Quality: 0.4064646143421921
Quality: 0.40697819520826284
Quality: 0.40705386281877187
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 387 out of 387 | elapsed:    0.1s finished
Got subclusters: Counter({0: 76, 1: 75, 2: 65, 3: 63, 4: 53, 5: 48, 6: 44})
On pattern 16
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 387 samples in 0.003s...
[t-SNE] Computed neighbors for 387 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 387 / 387
[t-SNE] Mean sigma: 0.355031
[t-SNE] Computed conditional probabilities in 0.026s
[t-SNE] Iteration 50: error = 68.1508102, gradient norm = 0.4902448 (50 iterations in 0.042s)
[t-SNE] Iteration 100: error = 70.8973846, gradient norm = 0.4380914 (50 iterations in 0.043s)
[t-SNE] Iteration 150: error = 70.6782837, gradient norm = 0.4596446 (50 iterations in 0.043s)
[t-SNE] Iteration 200: error = 73.2502747, gradient norm = 0.4400265 (50 iterations in 0.044s)
[t-SNE] Iteration 250: error = 71.7516251, gradient norm = 0.4248330 (50 iterations in 0.044s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 71.751625
[t-SNE] Iteration 300: error = 1.3277296, gradient norm = 0.0037911 (50 iterations in 0.041s)
[t-SNE] Iteration 350: error = 1.2541895, gradient norm = 0.0017627 (50 iterations in 0.043s)
[t-SNE] Iteration 400: error = 1.1975186, gradient norm = 0.0012355 (50 iterations in 0.041s)
[t-SNE] Iteration 450: error = 1.1477420, gradient norm = 0.0013436 (50 iterations in 0.041s)
[t-SNE] Iteration 500: error = 1.1417164, gradient norm = 0.0007139 (50 iterations in 0.041s)
[t-SNE] Iteration 550: error = 1.1371515, gradient norm = 0.0004843 (50 iterations in 0.042s)
[t-SNE] Iteration 600: error = 1.1248869, gradient norm = 0.0004831 (50 iterations in 0.042s)
[t-SNE] Iteration 650: error = 1.1203727, gradient norm = 0.0005644 (50 iterations in 0.041s)
[t-SNE] Iteration 700: error = 1.1142231, gradient norm = 0.0003544 (50 iterations in 0.041s)
[t-SNE] Iteration 750: error = 1.1100574, gradient norm = 0.0001983 (50 iterations in 0.041s)
[t-SNE] Iteration 800: error = 1.1083255, gradient norm = 0.0003396 (50 iterations in 0.041s)
[t-SNE] Iteration 850: error = 1.1081309, gradient norm = 0.0000762 (50 iterations in 0.041s)
[t-SNE] Iteration 900: error = 1.1081208, gradient norm = 0.0000410 (50 iterations in 0.041s)
[t-SNE] Iteration 950: error = 1.1080234, gradient norm = 0.0000754 (50 iterations in 0.041s)
[t-SNE] Iteration 1000: error = 1.1080557, gradient norm = 0.0000543 (50 iterations in 0.041s)
[t-SNE] KL divergence after 1000 iterations: 1.108056
[t-SNE] Computed conditional probabilities for sample 387 / 387
[t-SNE] Mean sigma: 0.355031
Beginning preprocessing + Leiden
2024-03-13 19:17:54.710589 MEMORY 16.940580864
Affmat transformed
2024-03-13 19:17:54.715914 MEMORY 16.940580864
sources, targets, weights extracted
2024-03-13 19:17:54.718674 MEMORY 16.940580864
About to launch parallel Leiden runs
2024-03-13 19:17:54.723840 MEMORY 16.940580864
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.1s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    3.2s finished
Parallel Leiden runs finished
2024-03-13 19:17:57.973701 MEMORY 16.940580864
Quality: 0.35674726139996515
Quality: 0.35687022951746195
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 381 out of 381 | elapsed:    0.1s finished
Got subclusters: Counter({0: 90, 1: 69, 2: 66, 3: 53, 4: 43, 5: 37, 6: 19, 7: 10})
On pattern 17
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 381 samples in 0.003s...
[t-SNE] Computed neighbors for 381 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 381 / 381
[t-SNE] Mean sigma: 0.359689
[t-SNE] Computed conditional probabilities in 0.026s
[t-SNE] Iteration 50: error = 65.3963852, gradient norm = 0.4909491 (50 iterations in 0.091s)
[t-SNE] Iteration 100: error = 66.3011627, gradient norm = 0.4923874 (50 iterations in 0.043s)
[t-SNE] Iteration 150: error = 67.1912613, gradient norm = 0.4847336 (50 iterations in 0.042s)
[t-SNE] Iteration 200: error = 68.4181061, gradient norm = 0.4632958 (50 iterations in 0.041s)
[t-SNE] Iteration 250: error = 66.5949402, gradient norm = 0.4814336 (50 iterations in 0.041s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 66.594940
[t-SNE] Iteration 300: error = 1.3142949, gradient norm = 0.0042326 (50 iterations in 0.040s)
[t-SNE] Iteration 350: error = 1.2321337, gradient norm = 0.0016765 (50 iterations in 0.040s)
[t-SNE] Iteration 400: error = 1.2128394, gradient norm = 0.0011754 (50 iterations in 0.040s)
[t-SNE] Iteration 450: error = 1.1949362, gradient norm = 0.0007480 (50 iterations in 0.040s)
[t-SNE] Iteration 500: error = 1.1629710, gradient norm = 0.0013896 (50 iterations in 0.040s)
[t-SNE] Iteration 550: error = 1.1576922, gradient norm = 0.0004948 (50 iterations in 0.040s)
[t-SNE] Iteration 600: error = 1.1499431, gradient norm = 0.0009148 (50 iterations in 0.040s)
[t-SNE] Iteration 650: error = 1.1468470, gradient norm = 0.0003039 (50 iterations in 0.040s)
[t-SNE] Iteration 700: error = 1.1460122, gradient norm = 0.0002089 (50 iterations in 0.040s)
[t-SNE] Iteration 750: error = 1.1446052, gradient norm = 0.0001671 (50 iterations in 0.040s)
[t-SNE] Iteration 800: error = 1.1441791, gradient norm = 0.0001010 (50 iterations in 0.040s)
[t-SNE] Iteration 850: error = 1.1441036, gradient norm = 0.0002187 (50 iterations in 0.040s)
[t-SNE] Iteration 900: error = 1.1435198, gradient norm = 0.0001443 (50 iterations in 0.040s)
[t-SNE] Iteration 950: error = 1.1434352, gradient norm = 0.0000671 (50 iterations in 0.040s)
[t-SNE] Iteration 1000: error = 1.1434917, gradient norm = 0.0001023 (50 iterations in 0.040s)
[t-SNE] KL divergence after 1000 iterations: 1.143492
[t-SNE] Computed conditional probabilities for sample 381 / 381
[t-SNE] Mean sigma: 0.359689
Beginning preprocessing + Leiden
2024-03-13 19:17:59.407400 MEMORY 16.940580864
Affmat transformed
2024-03-13 19:17:59.412482 MEMORY 16.940580864
sources, targets, weights extracted
2024-03-13 19:17:59.415051 MEMORY 16.940580864
About to launch parallel Leiden runs
2024-03-13 19:17:59.454604 MEMORY 16.940580864
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.1s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    3.6s finished
Parallel Leiden runs finished
2024-03-13 19:18:03.008042 MEMORY 16.940580864
Quality: 0.35736966365719974
Quality: 0.35741874186359374
Quality: 0.35753013812854
Quality: 0.3579526563371682
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 378 out of 378 | elapsed:    0.1s finished
Got subclusters: Counter({0: 73, 1: 68, 2: 67, 3: 62, 4: 40, 5: 37, 6: 34})
On pattern 18
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 378 samples in 0.003s...
[t-SNE] Computed neighbors for 378 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 378 / 378
[t-SNE] Mean sigma: 0.395987
[t-SNE] Computed conditional probabilities in 0.025s
[t-SNE] Iteration 50: error = 62.8180275, gradient norm = 0.5368001 (50 iterations in 0.041s)
[t-SNE] Iteration 100: error = 65.9736938, gradient norm = 0.5028319 (50 iterations in 0.042s)
[t-SNE] Iteration 150: error = 69.2110901, gradient norm = 0.4643094 (50 iterations in 0.042s)
[t-SNE] Iteration 200: error = 68.9740067, gradient norm = 0.4502784 (50 iterations in 0.041s)
[t-SNE] Iteration 250: error = 71.4020386, gradient norm = 0.4356317 (50 iterations in 0.041s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 71.402039
[t-SNE] Iteration 300: error = 1.3633486, gradient norm = 0.0040193 (50 iterations in 0.043s)
[t-SNE] Iteration 350: error = 1.2791162, gradient norm = 0.0014502 (50 iterations in 0.042s)
[t-SNE] Iteration 400: error = 1.2505242, gradient norm = 0.0014230 (50 iterations in 0.042s)
[t-SNE] Iteration 450: error = 1.2327065, gradient norm = 0.0015696 (50 iterations in 0.042s)
[t-SNE] Iteration 500: error = 1.2284456, gradient norm = 0.0001456 (50 iterations in 0.042s)
[t-SNE] Iteration 550: error = 1.2279617, gradient norm = 0.0003037 (50 iterations in 0.043s)
[t-SNE] Iteration 600: error = 1.2275178, gradient norm = 0.0001004 (50 iterations in 0.042s)
[t-SNE] Iteration 650: error = 1.2257323, gradient norm = 0.0002094 (50 iterations in 0.042s)
[t-SNE] Iteration 700: error = 1.2258464, gradient norm = 0.0000872 (50 iterations in 0.043s)
[t-SNE] Iteration 750: error = 1.2258452, gradient norm = 0.0000565 (50 iterations in 0.042s)
[t-SNE] Iteration 800: error = 1.2257357, gradient norm = 0.0000997 (50 iterations in 0.043s)
[t-SNE] Iteration 850: error = 1.2252002, gradient norm = 0.0002167 (50 iterations in 0.043s)
[t-SNE] Iteration 900: error = 1.2243049, gradient norm = 0.0001776 (50 iterations in 0.042s)
[t-SNE] Iteration 950: error = 1.2187091, gradient norm = 0.0003568 (50 iterations in 0.042s)
[t-SNE] Iteration 1000: error = 1.2184737, gradient norm = 0.0001793 (50 iterations in 0.043s)
[t-SNE] KL divergence after 1000 iterations: 1.218474
[t-SNE] Computed conditional probabilities for sample 378 / 378
[t-SNE] Mean sigma: 0.395987
Beginning preprocessing + Leiden
2024-03-13 19:18:04.414592 MEMORY 16.940580864
Affmat transformed
2024-03-13 19:18:04.419460 MEMORY 16.940580864
sources, targets, weights extracted
2024-03-13 19:18:04.421851 MEMORY 16.940580864
About to launch parallel Leiden runs
2024-03-13 19:18:04.426918 MEMORY 16.940580864
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.1s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    3.2s finished
Parallel Leiden runs finished
2024-03-13 19:18:07.635829 MEMORY 16.940580864
Quality: 0.3384252802273496
Quality: 0.34421475802174134
Quality: 0.3447101121009077
Quality: 0.3462843907794083
Quality: 0.34653122028050054
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 296 out of 343 | elapsed:    0.1s remaining:    0.0s
[Parallel(n_jobs=24)]: Done 343 out of 343 | elapsed:    0.1s finished
Got subclusters: Counter({0: 85, 1: 82, 2: 76, 3: 58, 4: 57, 5: 11, 6: 9})
On pattern 19
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 343 samples in 0.003s...
[t-SNE] Computed neighbors for 343 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 343 / 343
[t-SNE] Mean sigma: 0.416497
[t-SNE] Computed conditional probabilities in 0.023s
[t-SNE] Iteration 50: error = 63.5939636, gradient norm = 0.5238787 (50 iterations in 0.041s)
[t-SNE] Iteration 100: error = 64.3459244, gradient norm = 0.4935896 (50 iterations in 0.039s)
[t-SNE] Iteration 150: error = 65.1586380, gradient norm = 0.4997518 (50 iterations in 0.038s)
[t-SNE] Iteration 200: error = 62.8609123, gradient norm = 0.5108040 (50 iterations in 0.039s)
[t-SNE] Iteration 250: error = 64.7426987, gradient norm = 0.5263855 (50 iterations in 0.039s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 64.742699
[t-SNE] Iteration 300: error = 1.3128814, gradient norm = 0.0040749 (50 iterations in 0.037s)
[t-SNE] Iteration 350: error = 1.2669246, gradient norm = 0.0013487 (50 iterations in 0.039s)
[t-SNE] Iteration 400: error = 1.2188413, gradient norm = 0.0014319 (50 iterations in 0.037s)
[t-SNE] Iteration 450: error = 1.1967586, gradient norm = 0.0008656 (50 iterations in 0.042s)
[t-SNE] Iteration 500: error = 1.1846449, gradient norm = 0.0007766 (50 iterations in 0.038s)
[t-SNE] Iteration 550: error = 1.1743954, gradient norm = 0.0004290 (50 iterations in 0.037s)
[t-SNE] Iteration 600: error = 1.1743168, gradient norm = 0.0002476 (50 iterations in 0.037s)
[t-SNE] Iteration 650: error = 1.1731430, gradient norm = 0.0002607 (50 iterations in 0.052s)
[t-SNE] Iteration 700: error = 1.1722120, gradient norm = 0.0002614 (50 iterations in 0.038s)
[t-SNE] Iteration 750: error = 1.1719790, gradient norm = 0.0000932 (50 iterations in 0.037s)
[t-SNE] Iteration 800: error = 1.1718440, gradient norm = 0.0000993 (50 iterations in 0.037s)
[t-SNE] Iteration 850: error = 1.1717079, gradient norm = 0.0000800 (50 iterations in 0.037s)
[t-SNE] Iteration 900: error = 1.1717527, gradient norm = 0.0000596 (50 iterations in 0.036s)
[t-SNE] Iteration 950: error = 1.1717209, gradient norm = 0.0000647 (50 iterations in 0.037s)
[t-SNE] Iteration 1000: error = 1.1717376, gradient norm = 0.0000644 (50 iterations in 0.037s)
[t-SNE] KL divergence after 1000 iterations: 1.171738
[t-SNE] Computed conditional probabilities for sample 343 / 343
[t-SNE] Mean sigma: 0.416497
Beginning preprocessing + Leiden
2024-03-13 19:18:08.938380 MEMORY 16.940580864
Affmat transformed
2024-03-13 19:18:08.944665 MEMORY 16.940580864
sources, targets, weights extracted
2024-03-13 19:18:08.946732 MEMORY 16.940580864
About to launch parallel Leiden runs
2024-03-13 19:18:08.951984 MEMORY 16.940580864
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.1s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    3.1s finished
Parallel Leiden runs finished
2024-03-13 19:18:12.083054 MEMORY 16.942403584
Quality: 0.3392015243382716
Quality: 0.3410287572855093
Quality: 0.3415200220136609
Quality: 0.3417684129204398
Quality: 0.34247484026306196
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 292 out of 339 | elapsed:    0.1s remaining:    0.0s
[Parallel(n_jobs=24)]: Done 339 out of 339 | elapsed:    0.1s finished
Got subclusters: Counter({0: 69, 1: 67, 2: 56, 3: 55, 4: 44, 5: 34, 6: 18})
On pattern 20
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 339 samples in 0.003s...
[t-SNE] Computed neighbors for 339 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 339 / 339
[t-SNE] Mean sigma: 0.359335
[t-SNE] Computed conditional probabilities in 0.023s
[t-SNE] Iteration 50: error = 65.6997299, gradient norm = 0.5058489 (50 iterations in 0.041s)
[t-SNE] Iteration 100: error = 66.1717911, gradient norm = 0.4998592 (50 iterations in 0.039s)
[t-SNE] Iteration 150: error = 69.8365250, gradient norm = 0.4388773 (50 iterations in 0.039s)
[t-SNE] Iteration 200: error = 71.4313354, gradient norm = 0.4466687 (50 iterations in 0.039s)
[t-SNE] Iteration 250: error = 67.9341660, gradient norm = 0.4709966 (50 iterations in 0.039s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 67.934166
[t-SNE] Iteration 300: error = 1.2651974, gradient norm = 0.0053691 (50 iterations in 0.037s)
[t-SNE] Iteration 350: error = 1.1500580, gradient norm = 0.0013529 (50 iterations in 0.037s)
[t-SNE] Iteration 400: error = 1.1207578, gradient norm = 0.0021928 (50 iterations in 0.037s)
[t-SNE] Iteration 450: error = 1.0918939, gradient norm = 0.0011067 (50 iterations in 0.037s)
[t-SNE] Iteration 500: error = 1.0637817, gradient norm = 0.0011629 (50 iterations in 0.037s)
[t-SNE] Iteration 550: error = 1.0554745, gradient norm = 0.0011884 (50 iterations in 0.037s)
[t-SNE] Iteration 600: error = 1.0478072, gradient norm = 0.0003906 (50 iterations in 0.037s)
[t-SNE] Iteration 650: error = 1.0441991, gradient norm = 0.0001333 (50 iterations in 0.037s)
[t-SNE] Iteration 700: error = 1.0441382, gradient norm = 0.0000869 (50 iterations in 0.037s)
[t-SNE] Iteration 750: error = 1.0392976, gradient norm = 0.0003798 (50 iterations in 0.037s)
[t-SNE] Iteration 800: error = 1.0390477, gradient norm = 0.0001087 (50 iterations in 0.037s)
[t-SNE] Iteration 850: error = 1.0390273, gradient norm = 0.0001135 (50 iterations in 0.037s)
[t-SNE] Iteration 900: error = 1.0373533, gradient norm = 0.0003268 (50 iterations in 0.037s)
[t-SNE] Iteration 950: error = 1.0354922, gradient norm = 0.0003496 (50 iterations in 0.037s)
[t-SNE] Iteration 1000: error = 1.0315571, gradient norm = 0.0007082 (50 iterations in 0.038s)
[t-SNE] KL divergence after 1000 iterations: 1.031557
[t-SNE] Computed conditional probabilities for sample 339 / 339
[t-SNE] Mean sigma: 0.359335
Beginning preprocessing + Leiden
2024-03-13 19:18:13.333460 MEMORY 16.942403584
Affmat transformed
2024-03-13 19:18:13.337888 MEMORY 16.942403584
sources, targets, weights extracted
2024-03-13 19:18:13.340078 MEMORY 16.942403584
About to launch parallel Leiden runs
2024-03-13 19:18:13.345300 MEMORY 16.942403584
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.0s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    3.0s finished
Parallel Leiden runs finished
2024-03-13 19:18:16.299410 MEMORY 16.942403584
Quality: 0.3595569993614665
Quality: 0.3649974192055005
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 272 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 332 out of 332 | elapsed:    0.1s finished
Got subclusters: Counter({0: 61, 1: 60, 2: 59, 3: 47, 4: 44, 5: 33, 6: 20, 7: 15})
On pattern 21
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 332 samples in 0.002s...
[t-SNE] Computed neighbors for 332 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 332 / 332
[t-SNE] Mean sigma: 0.406420
[t-SNE] Computed conditional probabilities in 0.022s
[t-SNE] Iteration 50: error = 63.3291779, gradient norm = 0.5062202 (50 iterations in 0.038s)
[t-SNE] Iteration 100: error = 61.6526337, gradient norm = 0.5270401 (50 iterations in 0.041s)
[t-SNE] Iteration 150: error = 62.5272942, gradient norm = 0.4821872 (50 iterations in 0.039s)
[t-SNE] Iteration 200: error = 61.1092911, gradient norm = 0.5374545 (50 iterations in 0.038s)
[t-SNE] Iteration 250: error = 63.2122002, gradient norm = 0.5156894 (50 iterations in 0.038s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 63.212200
[t-SNE] Iteration 300: error = 1.1295898, gradient norm = 0.0032965 (50 iterations in 0.038s)
[t-SNE] Iteration 350: error = 1.0556440, gradient norm = 0.0012216 (50 iterations in 0.038s)
[t-SNE] Iteration 400: error = 1.0258019, gradient norm = 0.0011632 (50 iterations in 0.038s)
[t-SNE] Iteration 450: error = 1.0206897, gradient norm = 0.0004660 (50 iterations in 0.037s)
[t-SNE] Iteration 500: error = 1.0169635, gradient norm = 0.0003060 (50 iterations in 0.037s)
[t-SNE] Iteration 550: error = 1.0151668, gradient norm = 0.0001656 (50 iterations in 0.037s)
[t-SNE] Iteration 600: error = 1.0149080, gradient norm = 0.0000923 (50 iterations in 0.037s)
[t-SNE] Iteration 650: error = 1.0146608, gradient norm = 0.0001496 (50 iterations in 0.038s)
[t-SNE] Iteration 700: error = 1.0138552, gradient norm = 0.0001615 (50 iterations in 0.038s)
[t-SNE] Iteration 750: error = 1.0075972, gradient norm = 0.0004849 (50 iterations in 0.037s)
[t-SNE] Iteration 800: error = 1.0063134, gradient norm = 0.0001622 (50 iterations in 0.037s)
[t-SNE] Iteration 850: error = 1.0024408, gradient norm = 0.0005580 (50 iterations in 0.037s)
[t-SNE] Iteration 900: error = 0.9914898, gradient norm = 0.0006842 (50 iterations in 0.037s)
[t-SNE] Iteration 950: error = 0.9906411, gradient norm = 0.0009037 (50 iterations in 0.037s)
[t-SNE] Iteration 1000: error = 0.9898362, gradient norm = 0.0000948 (50 iterations in 0.037s)
[t-SNE] KL divergence after 1000 iterations: 0.989836
[t-SNE] Computed conditional probabilities for sample 332 / 332
[t-SNE] Mean sigma: 0.406420
Beginning preprocessing + Leiden
2024-03-13 19:18:17.562499 MEMORY 16.942403584
Affmat transformed
2024-03-13 19:18:17.566869 MEMORY 16.942403584
sources, targets, weights extracted
2024-03-13 19:18:17.568830 MEMORY 16.942403584
About to launch parallel Leiden runs
2024-03-13 19:18:17.573748 MEMORY 16.942403584
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.1s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    3.0s finished
Parallel Leiden runs finished
2024-03-13 19:18:20.612212 MEMORY 16.942403584
Quality: 0.3809112881723788
Quality: 0.3814631392329431
Quality: 0.38157490139788397
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 272 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 327 out of 327 | elapsed:    0.1s finished
Got subclusters: Counter({0: 77, 1: 72, 2: 67, 3: 65, 4: 40, 5: 7, 6: 4})
On pattern 22
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 327 samples in 0.002s...
[t-SNE] Computed neighbors for 327 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 327 / 327
[t-SNE] Mean sigma: 0.361453
[t-SNE] Computed conditional probabilities in 0.022s
[t-SNE] Iteration 50: error = 64.5726013, gradient norm = 0.5043275 (50 iterations in 0.040s)
[t-SNE] Iteration 100: error = 64.2804337, gradient norm = 0.5068882 (50 iterations in 0.039s)
[t-SNE] Iteration 150: error = 66.3528366, gradient norm = 0.4813757 (50 iterations in 0.037s)
[t-SNE] Iteration 200: error = 65.1438751, gradient norm = 0.4965431 (50 iterations in 0.037s)
[t-SNE] Iteration 250: error = 64.0486450, gradient norm = 0.4763672 (50 iterations in 0.037s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 64.048645
[t-SNE] Iteration 300: error = 1.1761497, gradient norm = 0.0036516 (50 iterations in 0.038s)
[t-SNE] Iteration 350: error = 1.0620260, gradient norm = 0.0026163 (50 iterations in 0.036s)
[t-SNE] Iteration 400: error = 0.9946724, gradient norm = 0.0013848 (50 iterations in 0.036s)
[t-SNE] Iteration 450: error = 0.9783456, gradient norm = 0.0006562 (50 iterations in 0.036s)
[t-SNE] Iteration 500: error = 0.9582271, gradient norm = 0.0007764 (50 iterations in 0.038s)
[t-SNE] Iteration 550: error = 0.9439281, gradient norm = 0.0011383 (50 iterations in 0.036s)
[t-SNE] Iteration 600: error = 0.9379637, gradient norm = 0.0003707 (50 iterations in 0.036s)
[t-SNE] Iteration 650: error = 0.9360126, gradient norm = 0.0001704 (50 iterations in 0.036s)
[t-SNE] Iteration 700: error = 0.9347417, gradient norm = 0.0003546 (50 iterations in 0.036s)
[t-SNE] Iteration 750: error = 0.9322023, gradient norm = 0.0001338 (50 iterations in 0.036s)
[t-SNE] Iteration 800: error = 0.9279619, gradient norm = 0.0004181 (50 iterations in 0.036s)
[t-SNE] Iteration 850: error = 0.9278084, gradient norm = 0.0001185 (50 iterations in 0.036s)
[t-SNE] Iteration 900: error = 0.9278280, gradient norm = 0.0000974 (50 iterations in 0.036s)
[t-SNE] Iteration 950: error = 0.9278110, gradient norm = 0.0000924 (50 iterations in 0.036s)
[t-SNE] Iteration 1000: error = 0.9276834, gradient norm = 0.0001377 (50 iterations in 0.038s)
[t-SNE] KL divergence after 1000 iterations: 0.927683
[t-SNE] Computed conditional probabilities for sample 327 / 327
[t-SNE] Mean sigma: 0.361453
Beginning preprocessing + Leiden
2024-03-13 19:18:21.860026 MEMORY 16.942403584
Affmat transformed
2024-03-13 19:18:21.864386 MEMORY 16.942403584
sources, targets, weights extracted
2024-03-13 19:18:21.866478 MEMORY 16.942403584
About to launch parallel Leiden runs
2024-03-13 19:18:21.870764 MEMORY 16.942403584
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.0s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    3.0s finished
Parallel Leiden runs finished
2024-03-13 19:18:24.904504 MEMORY 16.942403584
Quality: 0.36096962179377273
Quality: 0.3617485550637452
Quality: 0.3622426935153789
Quality: 0.362358804315573
Quality: 0.3631284571832124
Quality: 0.3637533705211679
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 272 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 323 out of 323 | elapsed:    0.1s finished
Got subclusters: Counter({0: 80, 1: 67, 2: 64, 3: 59, 4: 44, 5: 13})
On pattern 23
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 323 samples in 0.002s...
[t-SNE] Computed neighbors for 323 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 323 / 323
[t-SNE] Mean sigma: 0.377378
[t-SNE] Computed conditional probabilities in 0.022s
[t-SNE] Iteration 50: error = 65.6013412, gradient norm = 0.4633122 (50 iterations in 0.052s)
[t-SNE] Iteration 100: error = 63.3879395, gradient norm = 0.4997228 (50 iterations in 0.039s)
[t-SNE] Iteration 150: error = 62.0248184, gradient norm = 0.5314567 (50 iterations in 0.039s)
[t-SNE] Iteration 200: error = 64.5449142, gradient norm = 0.4684366 (50 iterations in 0.039s)
[t-SNE] Iteration 250: error = 63.7157860, gradient norm = 0.4922829 (50 iterations in 0.039s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 63.715786
[t-SNE] Iteration 300: error = 1.2163782, gradient norm = 0.0035055 (50 iterations in 0.040s)
[t-SNE] Iteration 350: error = 1.1184021, gradient norm = 0.0017865 (50 iterations in 0.040s)
[t-SNE] Iteration 400: error = 1.0888481, gradient norm = 0.0009506 (50 iterations in 0.040s)
[t-SNE] Iteration 450: error = 1.0637425, gradient norm = 0.0011130 (50 iterations in 0.040s)
[t-SNE] Iteration 500: error = 1.0489680, gradient norm = 0.0005540 (50 iterations in 0.040s)
[t-SNE] Iteration 550: error = 1.0491525, gradient norm = 0.0002201 (50 iterations in 0.040s)
[t-SNE] Iteration 600: error = 1.0459079, gradient norm = 0.0002451 (50 iterations in 0.040s)
[t-SNE] Iteration 650: error = 1.0451320, gradient norm = 0.0004929 (50 iterations in 0.040s)
[t-SNE] Iteration 700: error = 1.0449336, gradient norm = 0.0000720 (50 iterations in 0.040s)
[t-SNE] Iteration 750: error = 1.0449036, gradient norm = 0.0001289 (50 iterations in 0.040s)
[t-SNE] Iteration 800: error = 1.0447392, gradient norm = 0.0000966 (50 iterations in 0.040s)
[t-SNE] Iteration 850: error = 1.0447748, gradient norm = 0.0001172 (50 iterations in 0.040s)
[t-SNE] Iteration 900: error = 1.0444977, gradient norm = 0.0001216 (50 iterations in 0.040s)
[t-SNE] Iteration 950: error = 1.0447085, gradient norm = 0.0001121 (50 iterations in 0.040s)
[t-SNE] Iteration 1000: error = 1.0447761, gradient norm = 0.0001252 (50 iterations in 0.040s)
[t-SNE] KL divergence after 1000 iterations: 1.044776
[t-SNE] Computed conditional probabilities for sample 323 / 323
[t-SNE] Mean sigma: 0.377378
Beginning preprocessing + Leiden
2024-03-13 19:18:26.199063 MEMORY 16.942403584
Affmat transformed
2024-03-13 19:18:26.203607 MEMORY 16.942403584
sources, targets, weights extracted
2024-03-13 19:18:26.205698 MEMORY 16.942403584
About to launch parallel Leiden runs
2024-03-13 19:18:26.220835 MEMORY 16.942403584
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.0s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.9s finished
Parallel Leiden runs finished
2024-03-13 19:18:29.171115 MEMORY 16.942403584
Quality: 0.36186969547170456
Quality: 0.36499310381907996
Quality: 0.36582659979104715
Quality: 0.3659084545506519
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 308 out of 308 | elapsed:    0.1s finished
Got subclusters: Counter({0: 76, 1: 66, 2: 61, 3: 43, 4: 39, 5: 30, 6: 8})
On pattern 24
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 308 samples in 0.002s...
[t-SNE] Computed neighbors for 308 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 308 / 308
[t-SNE] Mean sigma: 0.403560
[t-SNE] Computed conditional probabilities in 0.021s
[t-SNE] Iteration 50: error = 65.5153046, gradient norm = 0.4826323 (50 iterations in 0.039s)
[t-SNE] Iteration 100: error = 61.5285759, gradient norm = 0.5300339 (50 iterations in 0.039s)
[t-SNE] Iteration 150: error = 64.4462128, gradient norm = 0.4965655 (50 iterations in 0.039s)
[t-SNE] Iteration 200: error = 66.9777145, gradient norm = 0.4876758 (50 iterations in 0.039s)
[t-SNE] Iteration 250: error = 67.3130646, gradient norm = 0.4781362 (50 iterations in 0.039s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 67.313065
[t-SNE] Iteration 300: error = 1.1856946, gradient norm = 0.0043760 (50 iterations in 0.036s)
[t-SNE] Iteration 350: error = 1.0706898, gradient norm = 0.0032268 (50 iterations in 0.036s)
[t-SNE] Iteration 400: error = 1.0179763, gradient norm = 0.0010276 (50 iterations in 0.036s)
[t-SNE] Iteration 450: error = 1.0028701, gradient norm = 0.0005634 (50 iterations in 0.036s)
[t-SNE] Iteration 500: error = 0.9905077, gradient norm = 0.0012392 (50 iterations in 0.036s)
[t-SNE] Iteration 550: error = 0.9806730, gradient norm = 0.0019616 (50 iterations in 0.036s)
[t-SNE] Iteration 600: error = 0.9781950, gradient norm = 0.0002297 (50 iterations in 0.036s)
[t-SNE] Iteration 650: error = 0.9774512, gradient norm = 0.0001302 (50 iterations in 0.036s)
[t-SNE] Iteration 700: error = 0.9767377, gradient norm = 0.0002194 (50 iterations in 0.036s)
[t-SNE] Iteration 750: error = 0.9715520, gradient norm = 0.0002527 (50 iterations in 0.037s)
[t-SNE] Iteration 800: error = 0.9709955, gradient norm = 0.0001469 (50 iterations in 0.037s)
[t-SNE] Iteration 850: error = 0.9709800, gradient norm = 0.0000860 (50 iterations in 0.036s)
[t-SNE] Iteration 900: error = 0.9709626, gradient norm = 0.0000666 (50 iterations in 0.073s)
[t-SNE] Iteration 950: error = 0.9709917, gradient norm = 0.0000880 (50 iterations in 0.036s)
[t-SNE] Iteration 1000: error = 0.9712238, gradient norm = 0.0001100 (50 iterations in 0.040s)
[t-SNE] KL divergence after 1000 iterations: 0.971224
[t-SNE] Computed conditional probabilities for sample 308 / 308
[t-SNE] Mean sigma: 0.403560
Beginning preprocessing + Leiden
2024-03-13 19:18:30.421772 MEMORY 16.942403584
Affmat transformed
2024-03-13 19:18:30.426530 MEMORY 16.942403584
sources, targets, weights extracted
2024-03-13 19:18:30.428723 MEMORY 16.942403584
About to launch parallel Leiden runs
2024-03-13 19:18:30.433966 MEMORY 16.942403584
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.0s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.9s finished
Parallel Leiden runs finished
2024-03-13 19:18:33.357215 MEMORY 16.943177728
Quality: 0.349877969712006
Quality: 0.3501763189994253
Quality: 0.3508874477387362
Quality: 0.35093033850034167
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 299 out of 299 | elapsed:    0.1s finished
Got subclusters: Counter({0: 87, 1: 75, 2: 68, 3: 64, 4: 14})
On pattern 25
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 299 samples in 0.002s...
[t-SNE] Computed neighbors for 299 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 299 / 299
[t-SNE] Mean sigma: 0.390935
[t-SNE] Computed conditional probabilities in 0.020s
[t-SNE] Iteration 50: error = 65.1410751, gradient norm = 0.4792732 (50 iterations in 0.038s)
[t-SNE] Iteration 100: error = 63.3919525, gradient norm = 0.4874910 (50 iterations in 0.038s)
[t-SNE] Iteration 150: error = 62.3468933, gradient norm = 0.5090787 (50 iterations in 0.038s)
[t-SNE] Iteration 200: error = 65.9753113, gradient norm = 0.4975964 (50 iterations in 0.038s)
[t-SNE] Iteration 250: error = 64.1123428, gradient norm = 0.5294568 (50 iterations in 0.038s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 64.112343
[t-SNE] Iteration 300: error = 1.2556310, gradient norm = 0.0049097 (50 iterations in 0.036s)
[t-SNE] Iteration 350: error = 1.0754061, gradient norm = 0.0029317 (50 iterations in 0.036s)
[t-SNE] Iteration 400: error = 1.0106645, gradient norm = 0.0019501 (50 iterations in 0.036s)
[t-SNE] Iteration 450: error = 0.9924313, gradient norm = 0.0007990 (50 iterations in 0.035s)
[t-SNE] Iteration 500: error = 0.9804541, gradient norm = 0.0013669 (50 iterations in 0.035s)
[t-SNE] Iteration 550: error = 0.9756109, gradient norm = 0.0003636 (50 iterations in 0.035s)
[t-SNE] Iteration 600: error = 0.9752394, gradient norm = 0.0001161 (50 iterations in 0.035s)
[t-SNE] Iteration 650: error = 0.9752660, gradient norm = 0.0000789 (50 iterations in 0.035s)
[t-SNE] Iteration 700: error = 0.9752610, gradient norm = 0.0000544 (50 iterations in 0.035s)
[t-SNE] Iteration 750: error = 0.9752941, gradient norm = 0.0000704 (50 iterations in 0.035s)
[t-SNE] Iteration 800: error = 0.9752087, gradient norm = 0.0000659 (50 iterations in 0.035s)
[t-SNE] Iteration 850: error = 0.9751772, gradient norm = 0.0000648 (50 iterations in 0.035s)
[t-SNE] Iteration 900: error = 0.9752634, gradient norm = 0.0000840 (50 iterations in 0.035s)
[t-SNE] Iteration 950: error = 0.9752073, gradient norm = 0.0000660 (50 iterations in 0.035s)
[t-SNE] Iteration 1000: error = 0.9752509, gradient norm = 0.0000735 (50 iterations in 0.035s)
[t-SNE] KL divergence after 1000 iterations: 0.975251
[t-SNE] Computed conditional probabilities for sample 299 / 299
[t-SNE] Mean sigma: 0.390935
Beginning preprocessing + Leiden
2024-03-13 19:18:34.529182 MEMORY 16.943177728
Affmat transformed
2024-03-13 19:18:34.533383 MEMORY 16.943177728
sources, targets, weights extracted
2024-03-13 19:18:34.535338 MEMORY 16.943177728
About to launch parallel Leiden runs
2024-03-13 19:18:34.541703 MEMORY 16.943177728
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.0s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.9s finished
Parallel Leiden runs finished
2024-03-13 19:18:37.462221 MEMORY 16.943177728
Quality: 0.3329128400511199
Quality: 0.33382705346027247
Quality: 0.33385220812392297
Quality: 0.33415286840322406
Quality: 0.33420951974535185
Quality: 0.3343069643292838
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 228 out of 275 | elapsed:    0.1s remaining:    0.0s
[Parallel(n_jobs=24)]: Done 275 out of 275 | elapsed:    0.1s finished
Got subclusters: Counter({0: 66, 2: 52, 1: 52, 3: 44, 4: 39, 5: 25, 6: 21})
On pattern 26
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 275 samples in 0.002s...
[t-SNE] Computed neighbors for 275 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 275 / 275
[t-SNE] Mean sigma: 0.428204
[t-SNE] Computed conditional probabilities in 0.019s
[t-SNE] Iteration 50: error = 61.5799637, gradient norm = 0.4963119 (50 iterations in 0.035s)
[t-SNE] Iteration 100: error = 64.2425308, gradient norm = 0.4926221 (50 iterations in 0.035s)
[t-SNE] Iteration 150: error = 62.9704208, gradient norm = 0.4889874 (50 iterations in 0.035s)
[t-SNE] Iteration 200: error = 61.3638344, gradient norm = 0.5146825 (50 iterations in 0.034s)
[t-SNE] Iteration 250: error = 61.1614494, gradient norm = 0.5329986 (50 iterations in 0.034s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 61.161449
[t-SNE] Iteration 300: error = 1.1219417, gradient norm = 0.0054956 (50 iterations in 0.034s)
[t-SNE] Iteration 350: error = 0.9958539, gradient norm = 0.0029266 (50 iterations in 0.034s)
[t-SNE] Iteration 400: error = 0.9019665, gradient norm = 0.0015810 (50 iterations in 0.034s)
[t-SNE] Iteration 450: error = 0.8834679, gradient norm = 0.0005438 (50 iterations in 0.033s)
[t-SNE] Iteration 500: error = 0.8824297, gradient norm = 0.0002520 (50 iterations in 0.034s)
[t-SNE] Iteration 550: error = 0.8791158, gradient norm = 0.0002058 (50 iterations in 0.034s)
[t-SNE] Iteration 600: error = 0.8784794, gradient norm = 0.0004715 (50 iterations in 0.034s)
[t-SNE] Iteration 650: error = 0.8774279, gradient norm = 0.0001603 (50 iterations in 0.033s)
[t-SNE] Iteration 700: error = 0.8776289, gradient norm = 0.0001283 (50 iterations in 0.034s)
[t-SNE] Iteration 750: error = 0.8776940, gradient norm = 0.0000973 (50 iterations in 0.034s)
[t-SNE] Iteration 800: error = 0.8775931, gradient norm = 0.0001714 (50 iterations in 0.033s)
[t-SNE] Iteration 850: error = 0.8772409, gradient norm = 0.0002443 (50 iterations in 0.034s)
[t-SNE] Iteration 900: error = 0.8776462, gradient norm = 0.0003030 (50 iterations in 0.033s)
[t-SNE] Iteration 950: error = 0.8778535, gradient norm = 0.0001205 (50 iterations in 0.034s)
[t-SNE] Iteration 1000: error = 0.8777050, gradient norm = 0.0001206 (50 iterations in 0.033s)
[t-SNE] KL divergence after 1000 iterations: 0.877705
[t-SNE] Computed conditional probabilities for sample 275 / 275
[t-SNE] Mean sigma: 0.428203
Beginning preprocessing + Leiden
2024-03-13 19:18:38.555493 MEMORY 16.943177728
Affmat transformed
2024-03-13 19:18:38.559399 MEMORY 16.943177728
sources, targets, weights extracted
2024-03-13 19:18:38.561072 MEMORY 16.943177728
About to launch parallel Leiden runs
2024-03-13 19:18:38.585687 MEMORY 16.943177728
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.9s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.6s finished
Parallel Leiden runs finished
2024-03-13 19:18:41.167233 MEMORY 16.943177728
Quality: 0.3648283281486364
Quality: 0.36488001047575186
Quality: 0.3659319446928243
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 265 out of 265 | elapsed:    0.1s finished
Got subclusters: Counter({0: 60, 1: 55, 2: 53, 3: 41, 4: 37, 5: 29})
On pattern 27
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 265 samples in 0.002s...
[t-SNE] Computed neighbors for 265 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 265 / 265
[t-SNE] Mean sigma: 0.437451
[t-SNE] Computed conditional probabilities in 0.018s
[t-SNE] Iteration 50: error = 60.0116577, gradient norm = 0.5302907 (50 iterations in 0.089s)
[t-SNE] Iteration 100: error = 62.1602516, gradient norm = 0.4702216 (50 iterations in 0.035s)
[t-SNE] Iteration 150: error = 58.3886986, gradient norm = 0.5197375 (50 iterations in 0.035s)
[t-SNE] Iteration 200: error = 60.3949776, gradient norm = 0.5475096 (50 iterations in 0.035s)
[t-SNE] Iteration 250: error = 57.8726120, gradient norm = 0.5162330 (50 iterations in 0.036s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 57.872612
[t-SNE] Iteration 300: error = 1.0861111, gradient norm = 0.0039002 (50 iterations in 0.036s)
[t-SNE] Iteration 350: error = 0.9914062, gradient norm = 0.0032533 (50 iterations in 0.036s)
[t-SNE] Iteration 400: error = 0.9732815, gradient norm = 0.0008823 (50 iterations in 0.034s)
[t-SNE] Iteration 450: error = 0.9413697, gradient norm = 0.0009403 (50 iterations in 0.034s)
[t-SNE] Iteration 500: error = 0.9370545, gradient norm = 0.0001681 (50 iterations in 0.034s)
[t-SNE] Iteration 550: error = 0.9368683, gradient norm = 0.0000613 (50 iterations in 0.034s)
[t-SNE] Iteration 600: error = 0.9361650, gradient norm = 0.0002552 (50 iterations in 0.034s)
[t-SNE] Iteration 650: error = 0.9358674, gradient norm = 0.0001148 (50 iterations in 0.034s)
[t-SNE] Iteration 700: error = 0.9357005, gradient norm = 0.0000961 (50 iterations in 0.034s)
[t-SNE] Iteration 750: error = 0.9356885, gradient norm = 0.0000705 (50 iterations in 0.035s)
[t-SNE] Iteration 800: error = 0.9356831, gradient norm = 0.0000837 (50 iterations in 0.034s)
[t-SNE] Iteration 850: error = 0.9356759, gradient norm = 0.0000311 (50 iterations in 0.034s)
[t-SNE] Iteration 900: error = 0.9357038, gradient norm = 0.0000748 (50 iterations in 0.038s)
[t-SNE] Iteration 950: error = 0.9357488, gradient norm = 0.0000592 (50 iterations in 0.034s)
[t-SNE] Iteration 1000: error = 0.9357176, gradient norm = 0.0000608 (50 iterations in 0.034s)
[t-SNE] KL divergence after 1000 iterations: 0.935718
[t-SNE] Computed conditional probabilities for sample 265 / 265
[t-SNE] Mean sigma: 0.437451
Beginning preprocessing + Leiden
2024-03-13 19:18:42.336870 MEMORY 16.943177728
Affmat transformed
2024-03-13 19:18:42.340657 MEMORY 16.943177728
sources, targets, weights extracted
2024-03-13 19:18:42.342320 MEMORY 16.943177728
About to launch parallel Leiden runs
2024-03-13 19:18:42.375591 MEMORY 16.943177728
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.9s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.7s finished
Parallel Leiden runs finished
2024-03-13 19:18:45.077907 MEMORY 16.943177728
Quality: 0.35296638387308965
Quality: 0.3531246473278692
Quality: 0.3533618587879828
Quality: 0.3535932875354674
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 256 out of 256 | elapsed:    0.1s finished
Got subclusters: Counter({0: 53, 1: 49, 2: 47, 3: 46, 4: 41, 5: 29})
On pattern 28
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 256 samples in 0.002s...
[t-SNE] Computed neighbors for 256 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 256 / 256
[t-SNE] Mean sigma: 0.386866
[t-SNE] Computed conditional probabilities in 0.017s
[t-SNE] Iteration 50: error = 61.7225761, gradient norm = 0.4859527 (50 iterations in 0.034s)
[t-SNE] Iteration 100: error = 62.0363388, gradient norm = 0.4968804 (50 iterations in 0.034s)
[t-SNE] Iteration 150: error = 61.6280403, gradient norm = 0.5124354 (50 iterations in 0.034s)
[t-SNE] Iteration 200: error = 64.2561417, gradient norm = 0.5049883 (50 iterations in 0.034s)
[t-SNE] Iteration 250: error = 63.5594025, gradient norm = 0.5007611 (50 iterations in 0.034s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 63.559402
[t-SNE] Iteration 300: error = 1.1881336, gradient norm = 0.0044849 (50 iterations in 0.034s)
[t-SNE] Iteration 350: error = 0.9998918, gradient norm = 0.0036983 (50 iterations in 0.033s)
[t-SNE] Iteration 400: error = 0.9255523, gradient norm = 0.0025900 (50 iterations in 0.033s)
[t-SNE] Iteration 450: error = 0.9040127, gradient norm = 0.0009825 (50 iterations in 0.032s)
[t-SNE] Iteration 500: error = 0.9025292, gradient norm = 0.0002301 (50 iterations in 0.032s)
[t-SNE] Iteration 550: error = 0.9027314, gradient norm = 0.0002113 (50 iterations in 0.033s)
[t-SNE] Iteration 600: error = 0.9004849, gradient norm = 0.0007294 (50 iterations in 0.032s)
[t-SNE] Iteration 650: error = 0.8956484, gradient norm = 0.0001981 (50 iterations in 0.034s)
[t-SNE] Iteration 700: error = 0.8958679, gradient norm = 0.0001668 (50 iterations in 0.034s)
[t-SNE] Iteration 750: error = 0.8957826, gradient norm = 0.0001469 (50 iterations in 0.034s)
[t-SNE] Iteration 800: error = 0.8956940, gradient norm = 0.0001220 (50 iterations in 0.032s)
[t-SNE] Iteration 850: error = 0.8957028, gradient norm = 0.0001136 (50 iterations in 0.034s)
[t-SNE] Iteration 900: error = 0.8957202, gradient norm = 0.0000949 (50 iterations in 0.033s)
[t-SNE] Iteration 950: error = 0.8957726, gradient norm = 0.0001236 (50 iterations in 0.032s)
[t-SNE] Iteration 1000: error = 0.8957371, gradient norm = 0.0000796 (50 iterations in 0.032s)
[t-SNE] Iteration 1000: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 1000 iterations: 0.895737
[t-SNE] Computed conditional probabilities for sample 256 / 256
[t-SNE] Mean sigma: 0.386866
Beginning preprocessing + Leiden
2024-03-13 19:18:46.134587 MEMORY 16.943177728
Affmat transformed
2024-03-13 19:18:46.138172 MEMORY 16.943177728
sources, targets, weights extracted
2024-03-13 19:18:46.139745 MEMORY 16.943177728
About to launch parallel Leiden runs
2024-03-13 19:18:46.144537 MEMORY 16.943177728
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.9s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.6s finished
Parallel Leiden runs finished
2024-03-13 19:18:48.770618 MEMORY 16.943177728
Quality: 0.33971930599315914
Quality: 0.34059500380089547
Quality: 0.34326984341901223
Quality: 0.34329730856455914
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done  38 out of  42 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=24)]: Done  42 out of  42 | elapsed:    0.0s finished
Got subclusters: Counter({0: 59, 1: 51, 2: 45, 3: 41, 4: 33, 5: 14, 6: 13})
On pattern 29
[t-SNE] Computing 41 nearest neighbors...
[t-SNE] Indexed 42 samples in 0.000s...
[t-SNE] Computed neighbors for 42 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 42 / 42
[t-SNE] Mean sigma: 8.957612
[t-SNE] Computed conditional probabilities in 0.001s
[t-SNE] Iteration 50: error = 41.9407196, gradient norm = 0.4484192 (50 iterations in 0.012s)
[t-SNE] Iteration 100: error = 46.3559723, gradient norm = 0.3944790 (50 iterations in 0.010s)
[t-SNE] Iteration 150: error = 42.6596832, gradient norm = 0.6392075 (50 iterations in 0.011s)
[t-SNE] Iteration 200: error = 49.7539330, gradient norm = 0.5780349 (50 iterations in 0.010s)
[t-SNE] Iteration 250: error = 41.8965378, gradient norm = 0.3732620 (50 iterations in 0.010s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 41.896538
[t-SNE] Iteration 300: error = 0.6286372, gradient norm = 0.0009017 (50 iterations in 0.010s)
[t-SNE] Iteration 350: error = 0.5838991, gradient norm = 0.0001724 (50 iterations in 0.010s)
[t-SNE] Iteration 400: error = 0.5777001, gradient norm = 0.0001091 (50 iterations in 0.010s)
[t-SNE] Iteration 450: error = 0.5753465, gradient norm = 0.0000441 (50 iterations in 0.010s)
[t-SNE] Iteration 500: error = 0.5741783, gradient norm = 0.0000370 (50 iterations in 0.010s)
[t-SNE] Iteration 550: error = 0.5744154, gradient norm = 0.0000330 (50 iterations in 0.010s)
[t-SNE] Iteration 600: error = 0.5748390, gradient norm = 0.0000204 (50 iterations in 0.010s)
[t-SNE] Iteration 650: error = 0.5747373, gradient norm = 0.0000187 (50 iterations in 0.010s)
[t-SNE] Iteration 700: error = 0.5747065, gradient norm = 0.0000189 (50 iterations in 0.010s)
[t-SNE] Iteration 750: error = 0.5745798, gradient norm = 0.0000205 (50 iterations in 0.010s)
[t-SNE] Iteration 800: error = 0.5744134, gradient norm = 0.0000243 (50 iterations in 0.010s)
[t-SNE] Iteration 850: error = 0.5739073, gradient norm = 0.0000457 (50 iterations in 0.010s)
[t-SNE] Iteration 900: error = 0.5726778, gradient norm = 0.0001236 (50 iterations in 0.010s)
[t-SNE] Iteration 950: error = 0.5686964, gradient norm = 0.0002881 (50 iterations in 0.010s)
[t-SNE] Iteration 1000: error = 0.8207086, gradient norm = 0.0055254 (50 iterations in 0.010s)
[t-SNE] KL divergence after 1000 iterations: 0.820709
[t-SNE] Computed conditional probabilities for sample 42 / 42
[t-SNE] Mean sigma: 1125899906842624.000000
Beginning preprocessing + Leiden
2024-03-13 19:18:49.041448 MEMORY 16.943177728
Affmat transformed
2024-03-13 19:18:49.042200 MEMORY 16.943177728
sources, targets, weights extracted
2024-03-13 19:18:49.042535 MEMORY 16.943177728
About to launch parallel Leiden runs
2024-03-13 19:18:49.047190 MEMORY 16.943177728
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.6s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.7s finished
Parallel Leiden runs finished
2024-03-13 19:18:50.745946 MEMORY 16.943177728
Quality: -1.905142710256783e-13
Got subclusters: Counter({0: 42})
On metacluster 1
Metacluster size 131792 limited to 20000
Relevant tasks:  ('head', 'testis')
Relevant signs:  (1, 1)
TfModiscoSeqletsToPatternsFactory: seed=1234
(Round 1) num seqlets: 20000
(Round 1) Computing coarse affmat
2024-03-13 19:18:56.110658 MEMORY 16.942874624
Beginning embedding computation
MEMORY 16.942874624
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 152 tasks      | elapsed:    1.9s
[Parallel(n_jobs=24)]: Done 402 tasks      | elapsed:    4.7s
[Parallel(n_jobs=24)]: Done 752 tasks      | elapsed:    8.5s
[Parallel(n_jobs=24)]: Done 1202 tasks      | elapsed:   13.6s
[Parallel(n_jobs=24)]: Done 1752 tasks      | elapsed:   19.6s
[Parallel(n_jobs=24)]: Done 2402 tasks      | elapsed:   26.7s
[Parallel(n_jobs=24)]: Done 3152 tasks      | elapsed:   35.0s
[Parallel(n_jobs=24)]: Done 4002 tasks      | elapsed:   44.4s
[Parallel(n_jobs=24)]: Done 4952 tasks      | elapsed:   54.8s
[Parallel(n_jobs=24)]: Done 6002 tasks      | elapsed:  1.1min
[Parallel(n_jobs=24)]: Done 7152 tasks      | elapsed:  1.3min
[Parallel(n_jobs=24)]: Done 8402 tasks      | elapsed:  1.5min
[Parallel(n_jobs=24)]: Done 9752 tasks      | elapsed:  1.8min
[Parallel(n_jobs=24)]: Done 11202 tasks      | elapsed:  2.0min
[Parallel(n_jobs=24)]: Done 12752 tasks      | elapsed:  2.3min
[Parallel(n_jobs=24)]: Done 14402 tasks      | elapsed:  2.6min
[Parallel(n_jobs=24)]: Done 16152 tasks      | elapsed:  2.9min
[Parallel(n_jobs=24)]: Done 18002 tasks      | elapsed:  3.3min
[Parallel(n_jobs=24)]: Done 19952 tasks      | elapsed:  3.6min
[Parallel(n_jobs=24)]: Done 20000 out of 20000 | elapsed:  3.6min finished
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 152 tasks      | elapsed:    1.8s
[Parallel(n_jobs=24)]: Done 402 tasks      | elapsed:    4.6s
[Parallel(n_jobs=24)]: Done 752 tasks      | elapsed:    8.3s
[Parallel(n_jobs=24)]: Done 1202 tasks      | elapsed:   13.1s
[Parallel(n_jobs=24)]: Done 1752 tasks      | elapsed:   19.2s
[Parallel(n_jobs=24)]: Done 2402 tasks      | elapsed:   26.3s
[Parallel(n_jobs=24)]: Done 3152 tasks      | elapsed:   34.4s
[Parallel(n_jobs=24)]: Done 4002 tasks      | elapsed:   43.7s
[Parallel(n_jobs=24)]: Done 4952 tasks      | elapsed:   54.3s
[Parallel(n_jobs=24)]: Done 6002 tasks      | elapsed:  1.1min
[Parallel(n_jobs=24)]: Done 7152 tasks      | elapsed:  1.3min
[Parallel(n_jobs=24)]: Done 8402 tasks      | elapsed:  1.5min
[Parallel(n_jobs=24)]: Done 9752 tasks      | elapsed:  1.8min
[Parallel(n_jobs=24)]: Done 11202 tasks      | elapsed:  2.0min
[Parallel(n_jobs=24)]: Done 12752 tasks      | elapsed:  2.3min
[Parallel(n_jobs=24)]: Done 14402 tasks      | elapsed:  2.6min
[Parallel(n_jobs=24)]: Done 16152 tasks      | elapsed:  2.9min
[Parallel(n_jobs=24)]: Done 18002 tasks      | elapsed:  3.3min
[Parallel(n_jobs=24)]: Done 19952 tasks      | elapsed:  3.6min
[Parallel(n_jobs=24)]: Done 20000 out of 20000 | elapsed:  3.6min finished
At the beginning of embedding call
2024-03-13 19:18:56.110928 MEMORY 16.942874624
before computing embeddings fwd
2024-03-13 19:18:56.120071 MEMORY 16.942874624
after computing embeddings fwd
2024-03-13 19:22:34.220397 MEMORY 16.946245632
after computing embeddings rev
2024-03-13 19:26:12.297250 MEMORY 17.40869632
before computing sparse embeddings fwd
2024-03-13 19:26:12.299186 MEMORY 17.40869632
Constructing csr matrix...
csr matrix made in 2.6564338207244873 s
after computing sparse embeddings fwd
2024-03-13 19:26:15.801193 MEMORY 17.468911616
before computing sparse embeddings rev
2024-03-13 19:26:15.804253 MEMORY 17.468911616
Constructing csr matrix...
csr matrix made in 2.44989013671875 s
after computing sparse embeddings rev
2024-03-13 19:26:19.251985 MEMORY 17.644740608
Finished embedding computation in 449.19 s
MEMORY 17.245495296
Starting affinity matrix computations
MEMORY 17.244971008
Batching in slices of size 3355
  0%|          | 0/6 [00:00<?, ?it/s] 17%|â–ˆâ–‹        | 1/6 [00:07<00:38,  7.64s/it] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 2/6 [00:15<00:30,  7.55s/it] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 3/6 [00:22<00:22,  7.51s/it] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 4/6 [00:30<00:14,  7.48s/it] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 5/6 [00:37<00:07,  7.44s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:44<00:00,  7.25s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:44<00:00,  7.38s/it]
Finished affinity matrix computations in 44.5 s
MEMORY 17.189195776
(Round 1) Computed coarse affmat
2024-03-13 19:27:13.283673 MEMORY 16.94881792
(Round 1) Computing affinity matrix on nearest neighbors
2024-03-13 19:27:13.283813 MEMORY 16.94881792
Launching nearest neighbors affmat calculation job
MEMORY 17.2355584
Parallel runs completed
MEMORY 17.28499712
Job completed in: 69.99 s
MEMORY 17.284804608
Launching nearest neighbors affmat calculation job
MEMORY 17.280438272
Parallel runs completed
MEMORY 17.395515392
Job completed in: 71.0 s
MEMORY 17.395617792
(Round 1) Computed affinity matrix on nearest neighbors in 148.36 s
2024-03-13 19:29:41.651518 MEMORY 17.107247104
Filtered down to 18147 of 20000
(Round 1) Retained 18147 rows out of 20000 after filtering
2024-03-13 19:29:51.933876 MEMORY 17.107247104
(Round 1) Computing density adapted affmat
2024-03-13 19:29:58.115680 MEMORY 17.107247104
Symmetrizing nearest neighbors
Computing betas for density adaptation
Computing normalizing denominators
(Round 1) Computing clustering
2024-03-13 19:32:19.435095 MEMORY 17.200545792
Beginning preprocessing + Leiden
2024-03-13 19:32:19.457928 MEMORY 17.200545792
Affmat transformed
2024-03-13 19:32:19.458075 MEMORY 17.200545792
sources, targets, weights extracted
2024-03-13 19:32:20.118592 MEMORY 17.393332224
About to launch parallel Leiden runs
2024-03-13 19:32:20.263828 MEMORY 17.200545792
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:  1.7min
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:  6.0min finished
Parallel Leiden runs finished
2024-03-13 19:38:17.427787 MEMORY 17.200447488
Quality: 0.4015028920935033
Quality: 0.40155495595128865
Quality: 0.40440934836506703
Quality: 0.4044100308318566
Got 7 clusters after round 1
Counts:
{5: 1841, 2: 3042, 1: 3139, 4: 2056, 0: 4664, 6: 807, 3: 2598}
2024-03-13 19:38:17.482837 MEMORY 17.055719424
(Round 1) Aggregating seqlets in each cluster
2024-03-13 19:38:17.482969 MEMORY 17.055719424
Aggregating for cluster 0 with 4664 seqlets
2024-03-13 19:38:17.488248 MEMORY 17.055719424
Skipped 44 due to duplicates
Trimming eliminated 0 seqlets out of 4620
Aggregating for cluster 1 with 3139 seqlets
2024-03-13 19:38:28.660865 MEMORY 17.055719424
Removed 1 duplicate seqlets
Skipped 33 due to duplicates
Trimming eliminated 0 seqlets out of 3105
Removed 9 duplicate seqlets
Aggregating for cluster 2 with 3042 seqlets
2024-03-13 19:38:35.369790 MEMORY 17.055719424
Removed 1 duplicate seqlets
Skipped 68 due to duplicates
Trimming eliminated 0 seqlets out of 2973
Aggregating for cluster 3 with 2598 seqlets
2024-03-13 19:38:42.091033 MEMORY 17.055719424
Skipped 11 due to duplicates
Trimming eliminated 0 seqlets out of 2587
Aggregating for cluster 4 with 2056 seqlets
2024-03-13 19:38:48.254984 MEMORY 17.055719424
Skipped 18 due to duplicates
Trimming eliminated 0 seqlets out of 2038
Aggregating for cluster 5 with 1841 seqlets
2024-03-13 19:38:53.014374 MEMORY 17.055719424
Skipped 23 due to duplicates
Trimming eliminated 0 seqlets out of 1818
Aggregating for cluster 6 with 807 seqlets
2024-03-13 19:39:00.325285 MEMORY 17.055727616
Removed 1 duplicate seqlets
Skipped 13 due to duplicates
Trimming eliminated 0 seqlets out of 793
Dropping cluster 6 with 793 seqlets due to sign disagreement
(Round 2) num seqlets: 17114
(Round 2) Computing coarse affmat
2024-03-13 19:39:05.329915 MEMORY 17.055727616
Beginning embedding computation
MEMORY 17.055727616
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 256 tasks      | elapsed:    0.6s
[Parallel(n_jobs=24)]: Done 1968 tasks      | elapsed:    2.6s
[Parallel(n_jobs=24)]: Done 4768 tasks      | elapsed:    5.7s
[Parallel(n_jobs=24)]: Done 8368 tasks      | elapsed:    9.6s
[Parallel(n_jobs=24)]: Done 12768 tasks      | elapsed:   14.2s
[Parallel(n_jobs=24)]: Done 17114 out of 17114 | elapsed:   18.9s finished
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 256 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done 1392 tasks      | elapsed:    2.3s
[Parallel(n_jobs=24)]: Done 6992 tasks      | elapsed:    7.1s
[Parallel(n_jobs=24)]: Done 14192 tasks      | elapsed:   13.3s
[Parallel(n_jobs=24)]: Done 17114 out of 17114 | elapsed:   16.4s finished
At the beginning of embedding call
2024-03-13 19:39:05.330116 MEMORY 17.055727616
before computing embeddings fwd
2024-03-13 19:39:05.338686 MEMORY 17.055727616
after computing embeddings fwd
2024-03-13 19:39:24.250845 MEMORY 17.138577408
after computing embeddings rev
2024-03-13 19:39:40.613545 MEMORY 17.814413312
before computing sparse embeddings fwd
2024-03-13 19:39:40.613634 MEMORY 17.814413312
Constructing csr matrix...
csr matrix made in 2.1250455379486084 s
after computing sparse embeddings fwd
2024-03-13 19:39:43.330549 MEMORY 17.876471808
before computing sparse embeddings rev
2024-03-13 19:39:43.330629 MEMORY 17.876471808
Constructing csr matrix...
csr matrix made in 1.9687604904174805 s
after computing sparse embeddings rev
2024-03-13 19:39:46.095887 MEMORY 18.034982912
Finished embedding computation in 44.98 s
MEMORY 17.460625408
Starting affinity matrix computations
MEMORY 17.459314688
Batching in slices of size 3921
  0%|          | 0/5 [00:00<?, ?it/s] 20%|â–ˆâ–ˆ        | 1/5 [00:09<00:37,  9.30s/it] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [00:18<00:28,  9.47s/it] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [00:27<00:18,  9.28s/it] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [00:36<00:09,  9.14s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [00:41<00:00,  7.44s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [00:41<00:00,  8.26s/it]
Finished affinity matrix computations in 41.4 s
MEMORY 17.4038016
(Round 2) Computed coarse affmat
2024-03-13 19:40:35.098532 MEMORY 17.197903872
(Round 2) Computing affinity matrix on nearest neighbors
2024-03-13 19:40:35.098711 MEMORY 17.197903872
Launching nearest neighbors affmat calculation job
MEMORY 17.320214528
Parallel runs completed
MEMORY 17.322962944
Job completed in: 31.27 s
MEMORY 17.320742912
Launching nearest neighbors affmat calculation job
MEMORY 17.320402944
Parallel runs completed
MEMORY 17.322840064
Job completed in: 31.36 s
MEMORY 17.320620032
(Round 2) Computed affinity matrix on nearest neighbors in 69.14 s
2024-03-13 19:41:44.248086 MEMORY 17.197903872
Not applying filtering for rounds above first round
2024-03-13 19:41:44.250502 MEMORY 17.197903872
(Round 2) Computing density adapted affmat
2024-03-13 19:41:50.378347 MEMORY 17.21049088
Symmetrizing nearest neighbors
Computing betas for density adaptation
Computing normalizing denominators
(Round 2) Computing clustering
2024-03-13 19:44:14.048576 MEMORY 17.464623104
Beginning preprocessing + Leiden
2024-03-13 19:44:14.074369 MEMORY 17.464623104
Affmat transformed
2024-03-13 19:44:14.074513 MEMORY 17.464623104
sources, targets, weights extracted
2024-03-13 19:44:14.745496 MEMORY 17.661915136
About to launch parallel Leiden runs
2024-03-13 19:44:14.951873 MEMORY 17.464623104
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:  1.3min
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:  4.0min finished
Parallel Leiden runs finished
2024-03-13 19:48:17.769199 MEMORY 17.464467456
Quality: 0.535579941364623
Quality: 0.5355802675655192
Quality: 0.5355814497589255
Quality: 0.5355815047868301
Quality: 0.5355817310257237
Quality: 0.5355818843590404
Quality: 0.5355819230811257
Got 6 clusters after round 2
Counts:
{4: 2009, 3: 2716, 2: 2863, 0: 4384, 1: 3286, 5: 1856}
2024-03-13 19:48:17.830540 MEMORY 17.316499456
(Round 2) Aggregating seqlets in each cluster
2024-03-13 19:48:17.830642 MEMORY 17.316499456
Aggregating for cluster 0 with 4384 seqlets
2024-03-13 19:48:17.836564 MEMORY 17.316499456
Skipped 24 due to duplicates
Trimming eliminated 0 seqlets out of 4360
Aggregating for cluster 1 with 3286 seqlets
2024-03-13 19:48:25.644543 MEMORY 17.316503552
Skipped 14 due to duplicates
Trimming eliminated 0 seqlets out of 3272
Removed 5 duplicate seqlets
Aggregating for cluster 2 with 2863 seqlets
2024-03-13 19:48:31.104593 MEMORY 17.316503552
Removed 1 duplicate seqlets
Skipped 10 due to duplicates
Trimming eliminated 0 seqlets out of 2852
Aggregating for cluster 3 with 2716 seqlets
2024-03-13 19:48:36.187040 MEMORY 17.316503552
Skipped 10 due to duplicates
Trimming eliminated 0 seqlets out of 2706
Aggregating for cluster 4 with 2009 seqlets
2024-03-13 19:48:40.897275 MEMORY 17.316503552
Skipped 16 due to duplicates
Trimming eliminated 0 seqlets out of 1993
Aggregating for cluster 5 with 1856 seqlets
2024-03-13 19:48:44.540882 MEMORY 17.316503552
Skipped 12 due to duplicates
Trimming eliminated 0 seqlets out of 1844
Got 6 clusters
Splitting into subclusters...
2024-03-13 19:48:51.211991 MEMORY 17.31651584
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.4s
[Parallel(n_jobs=24)]: Done 3930 tasks      | elapsed:    2.9s
[Parallel(n_jobs=24)]: Done 4360 out of 4360 | elapsed:    3.1s finished
Inspecting pattern 0 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 4360
[t-SNE] Computed conditional probabilities for sample 2000 / 4360
[t-SNE] Computed conditional probabilities for sample 3000 / 4360
[t-SNE] Computed conditional probabilities for sample 4000 / 4360
[t-SNE] Computed conditional probabilities for sample 4360 / 4360
[t-SNE] Mean sigma: 0.294935
Beginning preprocessing + Leiden
2024-03-13 19:48:58.781996 MEMORY 17.367638016
Affmat transformed
2024-03-13 19:48:58.832534 MEMORY 17.373749248
sources, targets, weights extracted
2024-03-13 19:48:58.871375 MEMORY 17.373749248
About to launch parallel Leiden runs
2024-03-13 19:48:58.896225 MEMORY 17.373917184
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:   19.9s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:  1.2min finished
Parallel Leiden runs finished
2024-03-13 19:50:09.812977 MEMORY 17.373917184
Quality: 0.45195715293887545
Quality: 0.46062004427059683
Quality: 0.4606887937082564
Got subclusters: Counter({0: 724, 1: 598, 2: 578, 3: 518, 4: 429, 5: 398, 6: 316, 7: 302, 8: 258, 9: 239})
On merging iteration 1
Numbers for each pattern pre-subsample: [724, 598, 578, 518, 429, 398, 316, 302, 258, 239]
Numbers after subsampling: [300, 300, 300, 300, 300, 300, 300, 300, 258, 239]
Computing sims for pattern 0
Computed sims for pattern 0 in 3.7266628742218018 s
Computing sims for pattern 1
Computed sims for pattern 1 in 3.9769909381866455 s
Computing sims for pattern 2
Computed sims for pattern 2 in 4.005721092224121 s
Computing sims for pattern 3
Computed sims for pattern 3 in 3.9250783920288086 s
Computing sims for pattern 4
Computed sims for pattern 4 in 4.014868259429932 s
Computing sims for pattern 5
Computed sims for pattern 5 in 3.949882745742798 s
Computing sims for pattern 6
Computed sims for pattern 6 in 3.969892740249634 s
Computing sims for pattern 7
Computed sims for pattern 7 in 3.9249820709228516 s
Computing sims for pattern 8
Computed sims for pattern 8 in 3.177748680114746 s
Computing sims for pattern 9
Computed sims for pattern 9 in 3.700686454772949 s
Cluster sizes
[724 598 578 518 429 398 316 302 258 239]
Cross-contamination matrix:
[[1.   0.78 0.8  0.77 0.64 0.7  0.72 0.51 0.61 0.69]
 [0.51 1.   0.61 0.46 0.54 0.56 0.65 0.43 0.43 0.59]
 [0.77 0.91 1.   0.63 0.66 0.68 0.76 0.62 0.65 0.78]
 [0.86 0.8  0.67 1.   0.65 0.75 0.65 0.71 0.62 0.72]
 [0.76 0.94 0.76 0.7  1.   0.76 0.89 0.66 0.64 0.88]
 [0.67 0.8  0.62 0.63 0.61 1.   0.67 0.55 0.55 0.65]
 [0.69 0.89 0.7  0.54 0.72 0.67 1.   0.48 0.61 0.71]
 [0.6  0.78 0.69 0.74 0.65 0.63 0.6  1.   0.59 0.73]
 [0.8  0.81 0.8  0.73 0.71 0.76 0.82 0.67 1.   0.83]
 [0.65 0.88 0.7  0.6  0.7  0.64 0.7  0.58 0.6  1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.78 0.83 0.89 0.8  0.81 0.82 0.7  0.83 0.82]
 [0.78 1.   0.82 0.76 0.87 0.8  0.88 0.73 0.8  0.89]
 [0.83 0.82 1.   0.74 0.75 0.73 0.79 0.71 0.82 0.84]
 [0.89 0.76 0.74 1.   0.8  0.79 0.76 0.79 0.79 0.78]
 [0.8  0.87 0.75 0.8  1.   0.83 0.92 0.78 0.84 0.89]
 [0.81 0.8  0.73 0.79 0.83 1.   0.83 0.74 0.8  0.8 ]
 [0.82 0.88 0.79 0.76 0.92 0.83 1.   0.71 0.87 0.86]
 [0.7  0.73 0.71 0.79 0.78 0.74 0.71 1.   0.75 0.76]
 [0.83 0.8  0.82 0.79 0.84 0.8  0.87 0.75 1.   0.85]
 [0.82 0.89 0.84 0.78 0.89 0.8  0.86 0.76 0.85 1.  ]]
Collapsing 4 & 6 with crosscontam 0.7239445224691357 and sim 0.9205842014030826
Collapsing 0 & 3 with crosscontam 0.7743994000000001 and sim 0.8924474576554942
Collapsing 1 & 9 with crosscontam 0.589322763985743 and sim 0.8911785203238054
Collapsing 4 & 9 with crosscontam 0.7049230026440483 and sim 0.8900305050621918
Collapsing 1 & 6 with crosscontam 0.6521259027160493 and sim 0.8797011834701005
Collapsing 1 & 4 with crosscontam 0.5423484424691358 and sim 0.8675596004283378
Collapsing 6 & 8 with crosscontam 0.6070110473729544 and sim 0.8669450932500153
Collapsing 6 & 9 with crosscontam 0.6991315374783573 and sim 0.8629594977190664
Skipped 1 due to duplicates
Trimming eliminated 0 seqlets out of 744
Trimming eliminated 0 seqlets out of 1242
Skipped 2 due to duplicates
Trimming eliminated 0 seqlets out of 835
Removed 1 duplicate seqlets
Skipped 2 due to duplicates
Trimming eliminated 0 seqlets out of 1576
Skipped 1 due to duplicates
Trimming eliminated 0 seqlets out of 1833
Unmerged patterns remapping: OrderedDict([(2, 2), (5, 3), (7, 4)])
Time spent on merging iteration: 13.501827001571655
On merging iteration 2
Numbers for each pattern pre-subsample: [1833, 1242, 578, 398, 302]
Numbers after subsampling: [300, 300, 300, 300, 300]
Computing sims for pattern 0
Computed sims for pattern 0 in 1.727937936782837 s
Computing sims for pattern 1
Computed sims for pattern 1 in 1.7089097499847412 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.873873233795166 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.8841919898986816 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.8777635097503662 s
Cluster sizes
[1833 1242  578  398  302]
Cross-contamination matrix:
[[1.   0.78 0.84 0.86 0.73]
 [0.72 1.   0.81 0.75 0.64]
 [0.72 0.71 1.   0.68 0.62]
 [0.67 0.64 0.62 1.   0.55]
 [0.68 0.66 0.69 0.63 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.82 0.86 0.84 0.78]
 [0.82 1.   0.8  0.81 0.75]
 [0.86 0.8  1.   0.73 0.71]
 [0.84 0.81 0.73 1.   0.74]
 [0.78 0.75 0.71 0.74 1.  ]]
Collapsing 0 & 2 with crosscontam 0.7246220809876542 and sim 0.8593856135868426
Skipped 3 due to duplicates
Trimming eliminated 0 seqlets out of 2408
Unmerged patterns remapping: OrderedDict([(1, 1), (3, 2), (4, 3)])
Time spent on merging iteration: 9.403258800506592
On merging iteration 3
Numbers for each pattern pre-subsample: [2408, 1242, 398, 302]
Numbers after subsampling: [300, 300, 300, 300]
Computing sims for pattern 0
Computed sims for pattern 0 in 1.2987933158874512 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.4469115734100342 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.44461560249328613 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.43120741844177246 s
Cluster sizes
[2408 1242  398  302]
Cross-contamination matrix:
[[1.   0.86 0.93 0.8 ]
 [0.72 1.   0.75 0.64]
 [0.66 0.64 1.   0.55]
 [0.66 0.66 0.63 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.84 0.86 0.78]
 [0.84 1.   0.81 0.75]
 [0.86 0.81 1.   0.74]
 [0.78 0.75 0.74 1.  ]]
Collapsing 0 & 2 with crosscontam 0.6550050222222223 and sim 0.8555596118951163
Trimming eliminated 0 seqlets out of 2806
Unmerged patterns remapping: OrderedDict([(1, 1), (3, 2)])
Time spent on merging iteration: 5.4624669551849365
On merging iteration 4
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 2985 tasks      | elapsed:    1.7s
[Parallel(n_jobs=24)]: Done 3267 out of 3267 | elapsed:    1.8s finished
Numbers for each pattern pre-subsample: [2806, 1242, 302]
Numbers after subsampling: [300, 300, 300]
Computing sims for pattern 0
Computed sims for pattern 0 in 0.8644986152648926 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.42470693588256836 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.45035314559936523 s
Cluster sizes
[2806 1242  302]
Cross-contamination matrix:
[[1.   0.83 0.78]
 [0.73 1.   0.64]
 [0.66 0.66 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.83 0.77]
 [0.83 1.   0.75]
 [0.77 0.75 1.  ]]
Inspecting pattern 1 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 3267
[t-SNE] Computed conditional probabilities for sample 2000 / 3267
[t-SNE] Computed conditional probabilities for sample 3000 / 3267
[t-SNE] Computed conditional probabilities for sample 3267 / 3267
[t-SNE] Mean sigma: 0.308800
Beginning preprocessing + Leiden
2024-03-13 19:51:28.646778 MEMORY 17.342877696
Affmat transformed
2024-03-13 19:51:28.684860 MEMORY 17.348702208
sources, targets, weights extracted
2024-03-13 19:51:28.712340 MEMORY 17.348702208
About to launch parallel Leiden runs
2024-03-13 19:51:28.791281 MEMORY 17.348763648
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:   11.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   42.5s finished
Parallel Leiden runs finished
2024-03-13 19:52:11.262181 MEMORY 17.348763648
Quality: 0.49696151145169426
Quality: 0.4986761052808063
Quality: 0.4988027896746359
Got subclusters: Counter({0: 856, 1: 625, 2: 587, 3: 551, 4: 373, 5: 239, 6: 36})
On merging iteration 1
Numbers for each pattern pre-subsample: [856, 625, 587, 551, 373, 239, 36]
Numbers after subsampling: [300, 300, 300, 300, 300, 239, 36]
Computing sims for pattern 0
Computed sims for pattern 0 in 2.315822124481201 s
Computing sims for pattern 1
Computed sims for pattern 1 in 2.3360400199890137 s
Computing sims for pattern 2
Computed sims for pattern 2 in 2.3933045864105225 s
Computing sims for pattern 3
Computed sims for pattern 3 in 2.400738000869751 s
Computing sims for pattern 4
Computed sims for pattern 4 in 2.4288833141326904 s
Computing sims for pattern 5
Computed sims for pattern 5 in 2.280538320541382 s
Computing sims for pattern 6
Computed sims for pattern 6 in 0.5268003940582275 s
Cluster sizes
[856 625 587 551 373 239  36]
Cross-contamination matrix:
[[1.   0.36 0.4  0.6  0.43 0.65 0.16]
 [0.62 1.   0.61 0.7  0.57 0.55 0.18]
 [0.8  0.72 1.   0.85 0.75 0.72 0.26]
 [0.86 0.63 0.68 1.   0.58 0.78 0.23]
 [0.81 0.66 0.74 0.73 1.   0.73 0.27]
 [0.82 0.42 0.47 0.69 0.49 1.   0.19]
 [0.8  0.64 0.64 0.73 0.66 0.76 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.61 0.75 0.81 0.78 0.83 0.68]
 [0.61 1.   0.75 0.76 0.77 0.67 0.52]
 [0.75 0.75 1.   0.85 0.82 0.74 0.58]
 [0.81 0.76 0.85 1.   0.8  0.87 0.66]
 [0.78 0.77 0.82 0.8  1.   0.74 0.72]
 [0.83 0.67 0.74 0.87 0.74 1.   0.65]
 [0.68 0.52 0.58 0.66 0.72 0.65 1.  ]]
Collapsing 3 & 5 with crosscontam 0.6862026649879771 and sim 0.8691204379179083
Collapsing 2 & 3 with crosscontam 0.681035661728395 and sim 0.8547821434426193
Trimming eliminated 0 seqlets out of 790
Trimming eliminated 0 seqlets out of 1377
Unmerged patterns remapping: OrderedDict([(0, 1), (1, 2), (4, 3), (6, 4)])
Time spent on merging iteration: 3.701974630355835
On merging iteration 2
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 2670 tasks      | elapsed:    1.4s
[Parallel(n_jobs=24)]: Done 2852 out of 2852 | elapsed:    1.4s finished
Numbers for each pattern pre-subsample: [1377, 856, 625, 373, 36]
Numbers after subsampling: [300, 300, 300, 300, 36]
Computing sims for pattern 0
Computed sims for pattern 0 in 1.486579418182373 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.4335966110229492 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.4353492259979248 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.44580602645874023 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.09093618392944336 s
Cluster sizes
[1377  856  625  373   36]
Cross-contamination matrix:
[[1.   1.   0.85 0.83 0.39]
 [0.49 1.   0.36 0.43 0.16]
 [0.6  0.62 1.   0.57 0.18]
 [0.67 0.81 0.66 1.   0.27]
 [0.66 0.8  0.64 0.66 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.83 0.79 0.83 0.65]
 [0.83 1.   0.61 0.78 0.68]
 [0.79 0.61 1.   0.77 0.52]
 [0.83 0.78 0.77 1.   0.72]
 [0.65 0.68 0.52 0.72 1.  ]]
Inspecting pattern 2 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 2852
[t-SNE] Computed conditional probabilities for sample 2000 / 2852
[t-SNE] Computed conditional probabilities for sample 2852 / 2852
[t-SNE] Mean sigma: 0.318240
Beginning preprocessing + Leiden
2024-03-13 19:52:37.371101 MEMORY 17.331863552
Affmat transformed
2024-03-13 19:52:37.404315 MEMORY 17.337565184
sources, targets, weights extracted
2024-03-13 19:52:37.426928 MEMORY 17.337622528
About to launch parallel Leiden runs
2024-03-13 19:52:37.470154 MEMORY 17.337622528
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:   11.1s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   38.0s finished
Parallel Leiden runs finished
2024-03-13 19:53:15.502159 MEMORY 17.337622528
Quality: 0.4686169448644027
Quality: 0.4686659844069524
Quality: 0.4689534213202591
Quality: 0.4703267109093635
Quality: 0.47079765861763306
Quality: 0.4715623466588435
Got subclusters: Counter({0: 595, 1: 490, 2: 452, 3: 394, 4: 350, 5: 291, 6: 251, 7: 29})
On merging iteration 1
Numbers for each pattern pre-subsample: [595, 490, 452, 394, 350, 291, 251, 29]
Numbers after subsampling: [300, 300, 300, 300, 300, 291, 251, 29]
Computing sims for pattern 0
Computed sims for pattern 0 in 2.7853009700775146 s
Computing sims for pattern 1
Computed sims for pattern 1 in 2.816694736480713 s
Computing sims for pattern 2
Computed sims for pattern 2 in 2.786831855773926 s
Computing sims for pattern 3
Computed sims for pattern 3 in 2.871289014816284 s
Computing sims for pattern 4
Computed sims for pattern 4 in 2.7945594787597656 s
Computing sims for pattern 5
Computed sims for pattern 5 in 2.746375799179077 s
Computing sims for pattern 6
Computed sims for pattern 6 in 2.151111602783203 s
Computing sims for pattern 7
Computed sims for pattern 7 in 0.5348243713378906 s
Cluster sizes
[595 490 452 394 350 291 251  29]
Cross-contamination matrix:
[[1.   0.52 0.6  0.33 0.4  0.25 0.56 0.56]
 [0.72 1.   0.59 0.67 0.49 0.53 0.58 0.72]
 [0.87 0.6  1.   0.59 0.62 0.52 0.71 0.57]
 [0.61 0.7  0.66 1.   0.55 0.75 0.66 0.33]
 [0.68 0.6  0.74 0.68 1.   0.62 0.61 0.71]
 [0.52 0.56 0.57 0.78 0.56 1.   0.58 0.32]
 [0.92 0.76 0.8  0.69 0.55 0.6  1.   0.5 ]
 [0.47 0.34 0.27 0.09 0.28 0.1  0.26 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.84 0.9  0.69 0.78 0.64 0.84 0.8 ]
 [0.84 1.   0.83 0.8  0.81 0.78 0.83 0.72]
 [0.9  0.83 1.   0.78 0.82 0.72 0.86 0.74]
 [0.69 0.8  0.78 1.   0.76 0.91 0.76 0.59]
 [0.78 0.81 0.82 0.76 1.   0.75 0.77 0.79]
 [0.64 0.78 0.72 0.91 0.75 1.   0.75 0.57]
 [0.84 0.83 0.86 0.76 0.77 0.75 1.   0.68]
 [0.8  0.72 0.74 0.59 0.79 0.57 0.68 1.  ]]
Collapsing 3 & 5 with crosscontam 0.7498482148402699 and sim 0.9121092320547393
Collapsing 0 & 2 with crosscontam 0.6017864681481484 and sim 0.8964447806448449
Collapsing 2 & 6 with crosscontam 0.7090651468201268 and sim 0.857258906833146
Removed 1 duplicate seqlets
Skipped 1 due to duplicates
Trimming eliminated 0 seqlets out of 683
Trimming eliminated 0 seqlets out of 1047
Skipped 1 due to duplicates
Trimming eliminated 0 seqlets out of 1297
Unmerged patterns remapping: OrderedDict([(1, 2), (4, 3), (7, 4)])
Time spent on merging iteration: 4.716096639633179
On merging iteration 2
Numbers for each pattern pre-subsample: [1297, 683, 490, 350, 29]
Numbers after subsampling: [300, 300, 300, 300, 29]
Computing sims for pattern 0
Computed sims for pattern 0 in 1.629096508026123 s
Computing sims for pattern 1
Computed sims for pattern 1 in 1.582446813583374 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.8241086006164551 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.8761379718780518 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.16296172142028809 s
Cluster sizes
[1297  683  490  350   29]
Cross-contamination matrix:
[[1.   0.58 0.75 0.68 0.76]
 [0.66 1.   0.57 0.72 0.38]
 [0.66 0.56 1.   0.49 0.72]
 [0.73 0.59 0.6  1.   0.71]
 [0.36 0.09 0.34 0.28 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.72 0.86 0.81 0.79]
 [0.72 1.   0.75 0.79 0.59]
 [0.86 0.75 1.   0.81 0.72]
 [0.81 0.79 0.81 1.   0.79]
 [0.79 0.59 0.72 0.79 1.  ]]
Collapsing 0 & 2 with crosscontam 0.6569962607407407 and sim 0.8594531747328638
Removed 1 duplicate seqlets
Skipped 1 due to duplicates
Trimming eliminated 0 seqlets out of 1785
Unmerged patterns remapping: OrderedDict([(1, 1), (3, 2), (4, 3)])
Time spent on merging iteration: 6.589888334274292
On merging iteration 3
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 2706 out of 2706 | elapsed:    1.3s finished
Numbers for each pattern pre-subsample: [1785, 683, 350, 29]
Numbers after subsampling: [300, 300, 300, 29]
Computing sims for pattern 0
Computed sims for pattern 0 in 1.1605780124664307 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.4274332523345947 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.42771387100219727 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.07890486717224121 s
Cluster sizes
[1785  683  350   29]
Cross-contamination matrix:
[[1.   0.7  0.77 0.81]
 [0.67 1.   0.72 0.38]
 [0.64 0.59 1.   0.71]
 [0.32 0.09 0.28 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.74 0.83 0.79]
 [0.74 1.   0.79 0.59]
 [0.83 0.79 1.   0.79]
 [0.79 0.59 0.79 1.  ]]
Inspecting pattern 3 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 2706
[t-SNE] Computed conditional probabilities for sample 2000 / 2706
[t-SNE] Computed conditional probabilities for sample 2706 / 2706
[t-SNE] Mean sigma: 0.326189
Beginning preprocessing + Leiden
2024-03-13 19:53:57.830172 MEMORY 17.337622528
Affmat transformed
2024-03-13 19:53:57.860452 MEMORY 17.339170816
sources, targets, weights extracted
2024-03-13 19:53:57.880136 MEMORY 17.339170816
About to launch parallel Leiden runs
2024-03-13 19:53:57.925307 MEMORY 17.339170816
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    8.8s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   28.8s finished
Parallel Leiden runs finished
2024-03-13 19:54:26.691436 MEMORY 17.339170816
Quality: 0.5072595811474202
Quality: 0.5074893779870577
Quality: 0.5096831640127306
Quality: 0.5099686160303044
Quality: 0.5107701334659037
Quality: 0.5110438010513009
Got subclusters: Counter({0: 625, 1: 484, 2: 470, 3: 312, 4: 261, 5: 199, 6: 190, 7: 165})
On merging iteration 1
Numbers for each pattern pre-subsample: [625, 484, 470, 312, 261, 199, 190, 165]
Numbers after subsampling: [300, 300, 300, 300, 261, 199, 190, 165]
Computing sims for pattern 0
Computed sims for pattern 0 in 2.768456220626831 s
Computing sims for pattern 1
Computed sims for pattern 1 in 2.882852077484131 s
Computing sims for pattern 2
Computed sims for pattern 2 in 2.839705228805542 s
Computing sims for pattern 3
Computed sims for pattern 3 in 2.857328176498413 s
Computing sims for pattern 4
Computed sims for pattern 4 in 2.243800163269043 s
Computing sims for pattern 5
Computed sims for pattern 5 in 2.094027519226074 s
Computing sims for pattern 6
Computed sims for pattern 6 in 1.9869513511657715 s
Computing sims for pattern 7
Computed sims for pattern 7 in 1.6572611331939697 s
Cluster sizes
[625 484 470 312 261 199 190 165]
Cross-contamination matrix:
[[1.   0.29 0.24 0.27 0.29 0.75 0.39 0.31]
 [0.59 1.   0.77 0.58 0.73 0.45 0.76 0.73]
 [0.5  0.78 1.   0.45 0.78 0.44 0.78 0.77]
 [0.69 0.76 0.57 1.   0.71 0.5  0.88 0.74]
 [0.58 0.74 0.78 0.55 1.   0.62 0.82 0.59]
 [0.68 0.17 0.17 0.11 0.28 1.   0.17 0.19]
 [0.54 0.56 0.57 0.51 0.58 0.26 1.   0.55]
 [0.52 0.63 0.66 0.47 0.49 0.39 0.65 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.71 0.58 0.63 0.54 0.7  0.64 0.71]
 [0.71 1.   0.85 0.64 0.77 0.51 0.67 0.89]
 [0.58 0.85 1.   0.64 0.83 0.5  0.7  0.88]
 [0.63 0.64 0.64 1.   0.7  0.57 0.67 0.7 ]
 [0.54 0.77 0.83 0.7  1.   0.54 0.85 0.7 ]
 [0.7  0.51 0.5  0.57 0.54 1.   0.5  0.61]
 [0.64 0.67 0.7  0.67 0.85 0.5  1.   0.68]
 [0.71 0.89 0.88 0.7  0.7  0.61 0.68 1.  ]]
Collapsing 1 & 7 with crosscontam 0.6256703037723423 and sim 0.8874466128437247
Collapsing 2 & 7 with crosscontam 0.6590828023114526 and sim 0.8772625837905228
Collapsing 1 & 2 with crosscontam 0.7693790054320988 and sim 0.8521430383673756
Trimming eliminated 0 seqlets out of 649
Trimming eliminated 0 seqlets out of 1119
Unmerged patterns remapping: OrderedDict([(0, 1), (3, 2), (4, 3), (5, 4), (6, 5)])
Time spent on merging iteration: 4.1847083568573
On merging iteration 2
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 1812 tasks      | elapsed:    0.5s
[Parallel(n_jobs=24)]: Done 1946 out of 1993 | elapsed:    0.5s remaining:    0.0s
[Parallel(n_jobs=24)]: Done 1993 out of 1993 | elapsed:    0.6s finished
Numbers for each pattern pre-subsample: [1119, 625, 312, 261, 199, 190]
Numbers after subsampling: [300, 300, 300, 261, 199, 190]
Computing sims for pattern 0
Computed sims for pattern 0 in 1.9778904914855957 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.4252922534942627 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.4197056293487549 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.33031749725341797 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.3053581714630127 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.29114198684692383 s
Cluster sizes
[1119  625  312  261  199  190]
Cross-contamination matrix:
[[1.   0.68 0.73 0.88 0.59 0.89]
 [0.27 1.   0.27 0.29 0.75 0.39]
 [0.75 0.69 1.   0.71 0.5  0.88]
 [0.73 0.58 0.55 1.   0.62 0.82]
 [0.17 0.68 0.11 0.28 1.   0.17]
 [0.54 0.54 0.51 0.58 0.26 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.68 0.65 0.84 0.59 0.67]
 [0.68 1.   0.63 0.54 0.7  0.64]
 [0.65 0.63 1.   0.7  0.57 0.67]
 [0.84 0.54 0.7  1.   0.54 0.85]
 [0.59 0.7  0.57 0.54 1.   0.5 ]
 [0.67 0.64 0.67 0.85 0.5  1.  ]]
Inspecting pattern 4 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 1993
[t-SNE] Computed conditional probabilities for sample 1993 / 1993
[t-SNE] Mean sigma: 0.319036
Beginning preprocessing + Leiden
2024-03-13 19:54:55.763662 MEMORY 17.339170816
Affmat transformed
2024-03-13 19:54:55.787354 MEMORY 17.339170816
sources, targets, weights extracted
2024-03-13 19:54:55.803085 MEMORY 17.339170816
About to launch parallel Leiden runs
2024-03-13 19:54:55.813555 MEMORY 17.339170816
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    6.0s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   20.6s finished
Parallel Leiden runs finished
2024-03-13 19:55:16.401250 MEMORY 17.339170816
Quality: 0.4657167732711833
Quality: 0.4658713883960772
Quality: 0.4663843973632832
Quality: 0.46641093310216175
Quality: 0.4664796673237565
Got subclusters: Counter({0: 392, 1: 366, 2: 334, 3: 331, 4: 296, 5: 274})
On merging iteration 1
Numbers for each pattern pre-subsample: [392, 366, 334, 331, 296, 274]
Numbers after subsampling: [300, 300, 300, 300, 296, 274]
Computing sims for pattern 0
Computed sims for pattern 0 in 2.143551826477051 s
Computing sims for pattern 1
Computed sims for pattern 1 in 2.124852418899536 s
Computing sims for pattern 2
Computed sims for pattern 2 in 2.190031051635742 s
Computing sims for pattern 3
Computed sims for pattern 3 in 2.119906425476074 s
Computing sims for pattern 4
Computed sims for pattern 4 in 2.133411407470703 s
Computing sims for pattern 5
Computed sims for pattern 5 in 1.8971154689788818 s
Cluster sizes
[392 366 334 331 296 274]
Cross-contamination matrix:
[[1.   0.69 0.91 0.79 0.61 0.87]
 [0.63 1.   0.57 0.71 0.52 0.71]
 [0.71 0.46 1.   0.66 0.68 0.73]
 [0.74 0.72 0.81 1.   0.69 0.71]
 [0.52 0.49 0.75 0.63 1.   0.75]
 [0.63 0.54 0.69 0.54 0.64 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.73 0.92 0.84 0.68 0.82]
 [0.73 1.   0.68 0.83 0.64 0.71]
 [0.92 0.68 1.   0.84 0.79 0.83]
 [0.84 0.83 0.84 1.   0.72 0.8 ]
 [0.68 0.64 0.79 0.72 1.   0.76]
 [0.82 0.71 0.83 0.8  0.76 1.  ]]
Collapsing 0 & 2 with crosscontam 0.7099363155555556 and sim 0.9245540099151042
Trimming eliminated 0 seqlets out of 726
Unmerged patterns remapping: OrderedDict([(1, 1), (3, 2), (4, 3), (5, 4)])
Time spent on merging iteration: 3.099125862121582
On merging iteration 2
Numbers for each pattern pre-subsample: [726, 366, 331, 296, 274]
Numbers after subsampling: [300, 300, 300, 296, 274]
Computing sims for pattern 0
Computed sims for pattern 0 in 1.7766332626342773 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.4470207691192627 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.44015073776245117 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.451845645904541 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.38712477684020996 s
Cluster sizes
[726 366 331 296 274]
Cross-contamination matrix:
[[1.   0.73 0.86 0.73 0.93]
 [0.62 1.   0.71 0.52 0.71]
 [0.76 0.72 1.   0.69 0.71]
 [0.61 0.49 0.63 1.   0.75]
 [0.65 0.54 0.54 0.64 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.71 0.85 0.73 0.83]
 [0.71 1.   0.83 0.64 0.71]
 [0.85 0.83 1.   0.72 0.8 ]
 [0.73 0.64 0.72 1.   0.76]
 [0.83 0.71 0.8  0.76 1.  ]]
Collapsing 0 & 2 with crosscontam 0.7575501279012347 and sim 0.854066917739577
Trimming eliminated 0 seqlets out of 1057
Unmerged patterns remapping: OrderedDict([(1, 1), (3, 2), (4, 3)])
Time spent on merging iteration: 2.2648727893829346
On merging iteration 3
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 1650 tasks      | elapsed:    0.4s
[Parallel(n_jobs=24)]: Done 1844 out of 1844 | elapsed:    0.5s finished
Numbers for each pattern pre-subsample: [1057, 366, 296, 274]
Numbers after subsampling: [300, 300, 296, 274]
Computing sims for pattern 0
Computed sims for pattern 0 in 1.2983500957489014 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.4391593933105469 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.4319877624511719 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.37325167655944824 s
Cluster sizes
[1057  366  296  274]
Cross-contamination matrix:
[[1.   0.73 0.73 0.95]
 [0.58 1.   0.52 0.71]
 [0.56 0.49 1.   0.75]
 [0.64 0.54 0.64 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.71 0.73 0.83]
 [0.71 1.   0.64 0.71]
 [0.73 0.64 1.   0.76]
 [0.83 0.71 0.76 1.  ]]
Inspecting pattern 5 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 1844
[t-SNE] Computed conditional probabilities for sample 1844 / 1844
[t-SNE] Mean sigma: 0.339466
Beginning preprocessing + Leiden
2024-03-13 19:55:41.338391 MEMORY 17.339170816
Affmat transformed
2024-03-13 19:55:41.359487 MEMORY 17.339170816
sources, targets, weights extracted
2024-03-13 19:55:41.373635 MEMORY 17.339170816
About to launch parallel Leiden runs
2024-03-13 19:55:41.383613 MEMORY 17.339170816
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    6.2s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   20.8s finished
Parallel Leiden runs finished
2024-03-13 19:56:02.138785 MEMORY 17.339170816
Quality: 0.4725493809257977
Quality: 0.4735331920105227
Quality: 0.4738564857883694
Got subclusters: Counter({0: 317, 1: 297, 2: 285, 3: 220, 4: 217, 5: 202, 6: 196, 7: 110})
On merging iteration 1
Numbers for each pattern pre-subsample: [317, 297, 285, 220, 217, 202, 196, 110]
Numbers after subsampling: [300, 297, 285, 220, 217, 202, 196, 110]
Computing sims for pattern 0
Computed sims for pattern 0 in 2.792456865310669 s
Computing sims for pattern 1
Computed sims for pattern 1 in 2.8013055324554443 s
Computing sims for pattern 2
Computed sims for pattern 2 in 2.575711727142334 s
Computing sims for pattern 3
Computed sims for pattern 3 in 2.3083600997924805 s
Computing sims for pattern 4
Computed sims for pattern 4 in 2.261080503463745 s
Computing sims for pattern 5
Computed sims for pattern 5 in 2.0908820629119873 s
Computing sims for pattern 6
Computed sims for pattern 6 in 2.1045055389404297 s
Computing sims for pattern 7
Computed sims for pattern 7 in 1.2247343063354492 s
Cluster sizes
[317 297 285 220 217 202 196 110]
Cross-contamination matrix:
[[1.   0.63 0.6  0.76 0.6  0.78 0.46 0.54]
 [0.65 1.   0.35 0.84 0.6  0.82 0.53 0.26]
 [0.7  0.47 1.   0.79 0.67 0.52 0.78 0.72]
 [0.53 0.61 0.5  1.   0.43 0.68 0.6  0.36]
 [0.73 0.79 0.62 0.72 1.   0.77 0.67 0.5 ]
 [0.62 0.66 0.29 0.77 0.46 1.   0.43 0.28]
 [0.51 0.63 0.61 0.82 0.58 0.76 1.   0.47]
 [0.61 0.37 0.78 0.69 0.6  0.53 0.71 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.77 0.72 0.76 0.79 0.81 0.58 0.55]
 [0.77 1.   0.6  0.87 0.78 0.84 0.62 0.54]
 [0.72 0.6  1.   0.7  0.78 0.52 0.81 0.83]
 [0.76 0.87 0.7  1.   0.77 0.78 0.66 0.67]
 [0.79 0.78 0.78 0.77 1.   0.72 0.72 0.76]
 [0.81 0.84 0.52 0.78 0.72 1.   0.64 0.61]
 [0.58 0.62 0.81 0.66 0.72 0.64 1.   0.77]
 [0.55 0.54 0.83 0.67 0.76 0.61 0.77 1.  ]]
Collapsing 1 & 3 with crosscontam 0.6059972477087427 and sim 0.8661651509982304
Skipped 1 due to duplicates
Trimming eliminated 0 seqlets out of 516
Unmerged patterns remapping: OrderedDict([(0, 1), (2, 2), (4, 3), (5, 4), (6, 5), (7, 6)])
Time spent on merging iteration: 2.061093807220459
On merging iteration 2
Numbers for each pattern pre-subsample: [516, 317, 285, 217, 202, 196, 110]
Numbers after subsampling: [300, 300, 285, 217, 202, 196, 110]
Computing sims for pattern 0
Computed sims for pattern 0 in 2.4229230880737305 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.43006324768066406 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.40834736824035645 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.3380260467529297 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.31783246994018555 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.3106365203857422 s
Computing sims for pattern 6
Computed sims for pattern 6 in 0.179307222366333 s
Cluster sizes
[516 317 285 217 202 196 110]
Cross-contamination matrix:
[[1.   0.71 0.48 0.67 0.93 0.7  0.38]
 [0.69 1.   0.6  0.6  0.78 0.46 0.54]
 [0.56 0.7  1.   0.67 0.52 0.78 0.72]
 [0.79 0.73 0.62 1.   0.77 0.67 0.5 ]
 [0.73 0.62 0.29 0.46 1.   0.43 0.28]
 [0.74 0.51 0.61 0.58 0.76 1.   0.47]
 [0.51 0.61 0.78 0.6  0.53 0.71 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.77 0.59 0.81 0.85 0.64 0.59]
 [0.77 1.   0.72 0.79 0.81 0.58 0.55]
 [0.59 0.72 1.   0.78 0.52 0.81 0.83]
 [0.81 0.79 0.78 1.   0.72 0.72 0.76]
 [0.85 0.81 0.52 0.72 1.   0.64 0.61]
 [0.64 0.58 0.81 0.72 0.64 1.   0.77]
 [0.59 0.55 0.83 0.76 0.61 0.77 1.  ]]
Collapsing 0 & 4 with crosscontam 0.7254446338173666 and sim 0.8535116310033506
Removed 1 duplicate seqlets
Skipped 1 due to duplicates
Trimming eliminated 0 seqlets out of 716
Removed 1 duplicate seqlets
Unmerged patterns remapping: OrderedDict([(1, 1), (2, 2), (3, 3), (5, 4), (6, 5)])
Time spent on merging iteration: 1.0910544395446777
On merging iteration 3
Numbers for each pattern pre-subsample: [715, 317, 285, 217, 196, 110]
Numbers after subsampling: [300, 300, 285, 217, 196, 110]
Computing sims for pattern 0
Computed sims for pattern 0 in 2.030174493789673 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.458174467086792 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.3982095718383789 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.3511321544647217 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.31879448890686035 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.18365168571472168 s
Cluster sizes
[715 317 285 217 196 110]
Cross-contamination matrix:
[[1.   0.77 0.52 0.72 0.74 0.43]
 [0.69 1.   0.6  0.6  0.46 0.54]
 [0.54 0.7  1.   0.67 0.78 0.72]
 [0.79 0.73 0.62 1.   0.67 0.5 ]
 [0.72 0.51 0.61 0.58 1.   0.47]
 [0.5  0.61 0.78 0.6  0.71 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.8  0.59 0.81 0.66 0.6 ]
 [0.8  1.   0.72 0.79 0.58 0.55]
 [0.59 0.72 1.   0.78 0.81 0.83]
 [0.81 0.79 0.78 1.   0.72 0.76]
 [0.66 0.58 0.81 0.72 1.   0.77]
 [0.6  0.55 0.83 0.76 0.77 1.  ]]
Merging on 28 clusters
2024-03-13 19:56:30.720296 MEMORY 17.339158528
On merging iteration 1
Numbers for each pattern pre-subsample: [2806, 1242, 302, 1377, 856, 625, 373, 36, 1785, 683, 350, 29, 1119, 625, 312, 261, 199, 190, 1057, 366, 296, 274, 715, 317, 285, 217, 196, 110]
Numbers after subsampling: [300, 300, 300, 300, 300, 300, 300, 36, 300, 300, 300, 29, 300, 300, 300, 261, 199, 190, 300, 300, 296, 274, 300, 300, 285, 217, 196, 110]
Computing sims for pattern 0
Computed sims for pattern 0 in 11.117446184158325 s
Computing sims for pattern 1
Computed sims for pattern 1 in 17.29732656478882 s
Computing sims for pattern 2
Computed sims for pattern 2 in 11.396452188491821 s
Computing sims for pattern 3
Computed sims for pattern 3 in 11.272281408309937 s
Computing sims for pattern 4
Computed sims for pattern 4 in 11.244556427001953 s
Computing sims for pattern 5
Computed sims for pattern 5 in 11.421229600906372 s
Computing sims for pattern 6
Computed sims for pattern 6 in 11.30122709274292 s
Computing sims for pattern 7
Computed sims for pattern 7 in 2.230494260787964 s
Computing sims for pattern 8
Computed sims for pattern 8 in 11.3364577293396 s
Computing sims for pattern 9
Computed sims for pattern 9 in 11.236732482910156 s
Computing sims for pattern 10
Computed sims for pattern 10 in 11.358036756515503 s
Computing sims for pattern 11
Computed sims for pattern 11 in 1.9924628734588623 s
Computing sims for pattern 12
Computed sims for pattern 12 in 11.256329774856567 s
Computing sims for pattern 13
Computed sims for pattern 13 in 11.1480233669281 s
Computing sims for pattern 14
Computed sims for pattern 14 in 11.360227584838867 s
Computing sims for pattern 15
Computed sims for pattern 15 in 9.09324312210083 s
Computing sims for pattern 16
Computed sims for pattern 16 in 8.273937940597534 s
Computing sims for pattern 17
Computed sims for pattern 17 in 13.22920298576355 s
Computing sims for pattern 18
Computed sims for pattern 18 in 11.471014738082886 s
Computing sims for pattern 19
Computed sims for pattern 19 in 11.32809591293335 s
Computing sims for pattern 20
Computed sims for pattern 20 in 11.075911521911621 s
Computing sims for pattern 21
Computed sims for pattern 21 in 9.82893443107605 s
Computing sims for pattern 22
Computed sims for pattern 22 in 11.2509605884552 s
Computing sims for pattern 23
Computed sims for pattern 23 in 11.274012327194214 s
Computing sims for pattern 24
Computed sims for pattern 24 in 10.467743635177612 s
Computing sims for pattern 25
Computed sims for pattern 25 in 9.307047843933105 s
Computing sims for pattern 26
Computed sims for pattern 26 in 8.290923595428467 s
Computing sims for pattern 27
Computed sims for pattern 27 in 4.850821495056152 s
Cluster sizes
[2806 1242  302 1377  856  625  373   36 1785  683  350   29 1119  625
  312  261  199  190 1057  366  296  274  715  317  285  217  196  110]
Cross-contamination matrix:
[[1.   0.83 0.78 0.27 0.18 0.34 0.21 0.17 0.25 0.28 0.27 0.33 0.12 0.03
  0.15 0.2  0.04 0.14 0.44 0.24 0.57 0.73 0.36 0.62 0.38 0.29 0.29 0.3 ]
 [0.73 1.   0.64 0.29 0.19 0.49 0.22 0.09 0.17 0.16 0.16 0.14 0.06 0.01
  0.11 0.12 0.01 0.15 0.39 0.26 0.29 0.55 0.19 0.37 0.25 0.19 0.18 0.13]
 [0.66 0.66 1.   0.34 0.18 0.46 0.31 0.12 0.39 0.33 0.37 0.36 0.08 0.01
  0.05 0.16 0.02 0.13 0.41 0.31 0.44 0.58 0.17 0.34 0.17 0.21 0.11 0.08]
 [0.36 0.58 0.63 1.   1.   0.85 0.83 0.39 0.36 0.46 0.27 0.23 0.42 0.11
  0.25 0.37 0.11 0.44 0.63 0.56 0.4  0.57 0.43 0.4  0.32 0.28 0.27 0.23]
 [0.05 0.11 0.12 0.49 1.   0.36 0.43 0.16 0.09 0.1  0.08 0.06 0.19 0.04
  0.09 0.19 0.03 0.18 0.18 0.16 0.14 0.15 0.42 0.29 0.12 0.23 0.14 0.06]
 [0.24 0.57 0.54 0.6  0.62 1.   0.57 0.18 0.28 0.29 0.14 0.1  0.2  0.06
  0.17 0.35 0.05 0.51 0.29 0.4  0.16 0.26 0.21 0.2  0.16 0.17 0.11 0.11]
 [0.16 0.33 0.43 0.67 0.81 0.66 1.   0.27 0.28 0.35 0.21 0.11 0.46 0.11
  0.29 0.37 0.1  0.6  0.45 0.4  0.37 0.3  0.32 0.35 0.29 0.16 0.2  0.16]
 [0.34 0.45 0.49 0.66 0.8  0.64 0.66 1.   0.5  0.49 0.36 0.54 0.62 0.43
  0.53 0.57 0.43 0.66 0.44 0.42 0.48 0.43 0.46 0.57 0.46 0.44 0.4  0.48]
 [0.31 0.36 0.67 0.34 0.31 0.47 0.39 0.18 1.   0.7  0.77 0.81 0.26 0.14
  0.25 0.33 0.17 0.46 0.29 0.34 0.38 0.28 0.25 0.29 0.19 0.2  0.15 0.28]
 [0.3  0.33 0.57 0.43 0.36 0.46 0.46 0.21 0.67 1.   0.72 0.38 0.24 0.04
  0.08 0.27 0.05 0.29 0.48 0.52 0.26 0.45 0.22 0.29 0.24 0.14 0.13 0.13]
 [0.26 0.27 0.55 0.2  0.23 0.23 0.27 0.14 0.64 0.59 1.   0.71 0.19 0.05
  0.18 0.19 0.05 0.22 0.32 0.27 0.47 0.18 0.2  0.26 0.17 0.18 0.13 0.21]
 [0.08 0.06 0.19 0.04 0.04 0.04 0.03 0.02 0.32 0.09 0.28 1.   0.1  0.03
  0.03 0.06 0.03 0.04 0.06 0.06 0.05 0.04 0.04 0.04 0.03 0.05 0.03 0.02]
 [0.16 0.2  0.25 0.46 0.61 0.42 0.64 0.34 0.31 0.3  0.23 0.43 1.   0.68
  0.73 0.88 0.59 0.89 0.42 0.7  0.48 0.39 0.46 0.55 0.61 0.56 0.5  0.42]
 [0.01 0.01 0.01 0.04 0.06 0.04 0.07 0.04 0.05 0.01 0.02 0.05 0.27 1.
  0.27 0.29 0.75 0.39 0.02 0.06 0.04 0.02 0.05 0.06 0.06 0.03 0.08 0.09]
 [0.22 0.32 0.17 0.28 0.46 0.36 0.5  0.33 0.31 0.13 0.31 0.27 0.75 0.69
  1.   0.71 0.5  0.88 0.49 0.51 0.46 0.46 0.42 0.54 0.51 0.22 0.48 0.79]
 [0.16 0.19 0.29 0.28 0.44 0.48 0.42 0.21 0.29 0.22 0.17 0.21 0.73 0.58
  0.55 1.   0.62 0.82 0.33 0.49 0.3  0.2  0.39 0.48 0.47 0.18 0.11 0.31]
 [0.   0.01 0.01 0.02 0.03 0.03 0.05 0.03 0.04 0.01 0.01 0.04 0.17 0.68
  0.11 0.28 1.   0.17 0.01 0.05 0.04 0.02 0.03 0.03 0.04 0.02 0.05 0.04]
 [0.05 0.14 0.08 0.22 0.37 0.41 0.46 0.15 0.23 0.11 0.09 0.05 0.54 0.54
  0.51 0.58 0.26 1.   0.09 0.22 0.08 0.06 0.13 0.17 0.08 0.1  0.08 0.18]
 [0.4  0.51 0.5  0.46 0.41 0.35 0.44 0.13 0.21 0.36 0.25 0.24 0.28 0.06
  0.34 0.33 0.1  0.19 1.   0.73 0.73 0.95 0.28 0.46 0.4  0.39 0.26 0.37]
 [0.16 0.22 0.23 0.28 0.25 0.29 0.24 0.07 0.13 0.28 0.2  0.16 0.37 0.06
  0.25 0.3  0.07 0.19 0.58 1.   0.52 0.71 0.25 0.4  0.54 0.34 0.24 0.3 ]
 [0.37 0.26 0.38 0.12 0.21 0.13 0.22 0.08 0.17 0.18 0.33 0.12 0.2  0.04
  0.1  0.19 0.07 0.06 0.56 0.49 1.   0.75 0.24 0.49 0.31 0.24 0.18 0.25]
 [0.43 0.38 0.39 0.17 0.14 0.14 0.12 0.06 0.06 0.16 0.07 0.07 0.1  0.01
  0.12 0.09 0.01 0.04 0.64 0.54 0.64 1.   0.14 0.39 0.22 0.14 0.11 0.21]
 [0.32 0.28 0.29 0.23 0.78 0.28 0.35 0.2  0.22 0.24 0.21 0.21 0.31 0.11
  0.23 0.38 0.12 0.2  0.3  0.38 0.43 0.27 1.   0.77 0.52 0.72 0.74 0.43]
 [0.54 0.42 0.4  0.16 0.52 0.21 0.18 0.11 0.17 0.16 0.18 0.18 0.31 0.07
  0.29 0.38 0.06 0.19 0.39 0.48 0.62 0.61 0.69 1.   0.6  0.6  0.46 0.54]
 [0.35 0.38 0.25 0.21 0.31 0.21 0.29 0.15 0.11 0.17 0.17 0.13 0.43 0.1
  0.31 0.41 0.09 0.13 0.4  0.72 0.51 0.48 0.54 0.7  1.   0.67 0.78 0.72]
 [0.3  0.34 0.32 0.31 0.6  0.36 0.32 0.21 0.24 0.27 0.22 0.3  0.41 0.05
  0.15 0.24 0.06 0.22 0.39 0.51 0.5  0.27 0.79 0.73 0.62 1.   0.67 0.5 ]
 [0.3  0.28 0.19 0.21 0.4  0.18 0.25 0.12 0.13 0.19 0.19 0.18 0.33 0.14
  0.33 0.09 0.09 0.17 0.22 0.31 0.36 0.25 0.72 0.51 0.61 0.58 1.   0.47]
 [0.26 0.19 0.13 0.14 0.17 0.15 0.15 0.11 0.2  0.1  0.17 0.1  0.26 0.15
  0.56 0.26 0.11 0.26 0.36 0.43 0.4  0.45 0.5  0.61 0.78 0.6  0.71 1.  ]]
Pattern-to-pattern sim matrix:
[[ 1.    0.83  0.77  0.4   0.23  0.44  0.37  0.3   0.36  0.38  0.41  0.37
   0.18 -0.14  0.08  0.33 -0.12  0.22  0.57  0.4   0.65  0.76  0.39  0.71
   0.46  0.59  0.45  0.27]
 [ 0.83  1.    0.75  0.6   0.34  0.71  0.52  0.39  0.41  0.42  0.42  0.37
   0.17 -0.09  0.09  0.36 -0.09  0.24  0.63  0.44  0.49  0.68  0.37  0.61
   0.46  0.55  0.42  0.21]
 [ 0.77  0.75  1.    0.57  0.32  0.68  0.5   0.38  0.67  0.67  0.65  0.5
   0.19 -0.13  0.09  0.34 -0.07  0.38  0.54  0.41  0.52  0.63  0.35  0.56
   0.34  0.49  0.29  0.18]
 [ 0.4   0.6   0.57  1.    0.83  0.79  0.83  0.65  0.38  0.44  0.33  0.35
   0.4   0.03  0.2   0.4   0.02  0.52  0.61  0.57  0.31  0.56  0.42  0.42
   0.37  0.5   0.34  0.28]
 [ 0.23  0.34  0.32  0.83  1.    0.61  0.78  0.68  0.29  0.37  0.33  0.36
   0.49  0.14  0.29  0.54  0.16  0.51  0.48  0.44  0.34  0.46  0.75  0.62
   0.46  0.57  0.46  0.32]
 [ 0.44  0.71  0.68  0.79  0.61  1.    0.77  0.52  0.49  0.51  0.4   0.37
   0.43  0.08  0.26  0.57  0.15  0.63  0.41  0.61  0.28  0.4   0.42  0.45
   0.39  0.56  0.36  0.2 ]
 [ 0.37  0.52  0.5   0.83  0.78  0.77  1.    0.72  0.42  0.49  0.36  0.3
   0.58  0.19  0.35  0.56  0.16  0.69  0.43  0.6   0.38  0.44  0.43  0.49
   0.47  0.59  0.39  0.32]
 [ 0.3   0.39  0.38  0.65  0.68  0.52  0.72  1.    0.29  0.36  0.24  0.24
   0.52  0.22  0.34  0.51  0.23  0.58  0.27  0.32  0.22  0.32  0.44  0.41
   0.4   0.5   0.4   0.39]
 [ 0.36  0.41  0.67  0.38  0.29  0.49  0.42  0.29  1.    0.74  0.83  0.79
   0.38  0.12  0.25  0.45  0.2   0.57  0.33  0.35  0.3   0.25  0.36  0.36
   0.3   0.41  0.3   0.25]
 [ 0.38  0.42  0.67  0.44  0.37  0.51  0.49  0.36  0.74  1.    0.79  0.59
   0.26 -0.14  0.07  0.39 -0.06  0.37  0.45  0.55  0.32  0.4   0.35  0.37
   0.37  0.45  0.31  0.17]
 [ 0.41  0.42  0.65  0.33  0.33  0.4   0.36  0.24  0.83  0.79  1.    0.79
   0.22  0.02  0.26  0.37  0.    0.4   0.35  0.41  0.61  0.31  0.44  0.45
   0.41  0.52  0.41  0.3 ]
 [ 0.37  0.37  0.5   0.35  0.36  0.37  0.3   0.24  0.79  0.59  0.79  1.
   0.36  0.24  0.33  0.42  0.23  0.38  0.26  0.29  0.45  0.32  0.45  0.38
   0.33  0.46  0.43  0.36]
 [ 0.18  0.17  0.19  0.4   0.49  0.43  0.58  0.52  0.38  0.26  0.22  0.36
   1.    0.68  0.65  0.84  0.59  0.67  0.35  0.58  0.4   0.31  0.5   0.53
   0.62  0.67  0.68  0.53]
 [-0.14 -0.09 -0.13  0.03  0.14  0.08  0.19  0.22  0.12 -0.14  0.02  0.24
   0.68  1.    0.63  0.54  0.7   0.64  0.08  0.19  0.22 -0.02  0.14  0.12
   0.24  0.19  0.29  0.32]
 [ 0.08  0.09  0.09  0.2   0.29  0.26  0.35  0.34  0.25  0.07  0.26  0.33
   0.65  0.63  1.    0.7   0.57  0.67  0.45  0.55  0.36  0.31  0.3   0.39
   0.32  0.04  0.26  0.77]
 [ 0.33  0.36  0.34  0.4   0.54  0.57  0.56  0.51  0.45  0.39  0.37  0.42
   0.84  0.54  0.7   1.    0.54  0.85  0.49  0.62  0.37  0.38  0.62  0.63
   0.64  0.39  0.19  0.49]
 [-0.12 -0.09 -0.07  0.02  0.16  0.15  0.16  0.23  0.2  -0.06  0.    0.23
   0.59  0.7   0.57  0.54  1.    0.5   0.05  0.22  0.2  -0.02  0.18  0.08
   0.37  0.25  0.36  0.43]
 [ 0.22  0.24  0.38  0.52  0.51  0.63  0.69  0.58  0.57  0.37  0.4   0.38
   0.67  0.64  0.67  0.85  0.5   1.    0.11  0.35  0.18  0.19  0.17  0.18
   0.23  0.16  0.18  0.34]
 [ 0.57  0.63  0.54  0.61  0.48  0.41  0.43  0.27  0.33  0.45  0.35  0.26
   0.35  0.08  0.45  0.49  0.05  0.11  1.    0.71  0.73  0.83  0.39  0.55
   0.47  0.52  0.49  0.4 ]
 [ 0.4   0.44  0.41  0.57  0.44  0.61  0.6   0.32  0.35  0.55  0.41  0.29
   0.58  0.19  0.55  0.62  0.22  0.35  0.71  1.    0.64  0.71  0.48  0.6
   0.73  0.62  0.6   0.57]
 [ 0.65  0.49  0.52  0.31  0.34  0.28  0.38  0.22  0.3   0.32  0.61  0.45
   0.4   0.22  0.36  0.37  0.2   0.18  0.73  0.64  1.    0.76  0.49  0.67
   0.6   0.57  0.59  0.46]
 [ 0.76  0.68  0.63  0.56  0.46  0.4   0.44  0.32  0.25  0.4   0.31  0.32
   0.31 -0.02  0.31  0.38 -0.02  0.19  0.83  0.71  0.76  1.    0.39  0.63
   0.47  0.42  0.42  0.41]
 [ 0.39  0.37  0.35  0.42  0.75  0.42  0.43  0.44  0.36  0.35  0.44  0.45
   0.5   0.14  0.3   0.62  0.18  0.17  0.39  0.48  0.49  0.39  1.    0.8
   0.59  0.81  0.66  0.6 ]
 [ 0.71  0.61  0.56  0.42  0.62  0.45  0.49  0.41  0.36  0.37  0.45  0.38
   0.53  0.12  0.39  0.63  0.08  0.18  0.55  0.6   0.67  0.63  0.8   1.
   0.72  0.79  0.58  0.55]
 [ 0.46  0.46  0.34  0.37  0.46  0.39  0.47  0.4   0.3   0.37  0.41  0.33
   0.62  0.24  0.32  0.64  0.37  0.23  0.47  0.73  0.6   0.47  0.59  0.72
   1.    0.78  0.81  0.83]
 [ 0.59  0.55  0.49  0.5   0.57  0.56  0.59  0.5   0.41  0.45  0.52  0.46
   0.67  0.19  0.04  0.39  0.25  0.16  0.52  0.62  0.57  0.42  0.81  0.79
   0.78  1.    0.72  0.76]
 [ 0.45  0.42  0.29  0.34  0.46  0.36  0.39  0.4   0.3   0.31  0.41  0.43
   0.68  0.29  0.26  0.19  0.36  0.18  0.49  0.6   0.59  0.42  0.66  0.58
   0.81  0.72  1.    0.77]
 [ 0.27  0.21  0.18  0.28  0.32  0.2   0.32  0.39  0.25  0.17  0.3   0.36
   0.53  0.32  0.77  0.49  0.43  0.34  0.4   0.57  0.46  0.41  0.6   0.55
   0.83  0.76  0.77  1.  ]]
Got 28 patterns after merging
2024-03-13 20:01:19.663051 MEMORY 17.339150336
Performing filtering
2024-03-13 20:01:19.663249 MEMORY 17.339150336
Got 27 patterns after filtering
2024-03-13 20:01:21.906678 MEMORY 17.339150336
Total time taken is 2549.87s
2024-03-13 20:01:21.906840 MEMORY 17.339150336
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 2640 tasks      | elapsed:    1.3s
[Parallel(n_jobs=24)]: Done 2806 out of 2806 | elapsed:    1.4s finished
/ru-auth/local/home/lzhao/anaconda3/envs/jupyter-ml-clone/lib/python3.9/site-packages/sklearn/manifold/_t_sne.py:691: FutureWarning: 'square_distances' has been introduced in 0.24 to help phase out legacy squaring behavior. The 'legacy' setting will be removed in 1.1 (renaming of 0.26), and the default setting will be changed to True. In 1.3, 'square_distances' will be removed altogether, and distances will be squared by default. Set 'square_distances'=True to silence this warning.
  warnings.warn(
/ru-auth/local/home/lzhao/anaconda3/envs/jupyter-ml-clone/lib/python3.9/site-packages/sklearn/neighbors/_base.py:175: EfficiencyWarning: Precomputed sparse input was not sorted by data.
  warnings.warn('Precomputed sparse input was not sorted by data.',
Applying subclustering to the final motifs
On pattern 0
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 2806 samples in 0.017s...
[t-SNE] Computed neighbors for 2806 samples in 0.002s...
[t-SNE] Computed conditional probabilities for sample 1000 / 2806
[t-SNE] Computed conditional probabilities for sample 2000 / 2806
[t-SNE] Computed conditional probabilities for sample 2806 / 2806
[t-SNE] Mean sigma: 0.302383
[t-SNE] Computed conditional probabilities in 0.190s
[t-SNE] Iteration 50: error = 73.7095337, gradient norm = 0.0576111 (50 iterations in 0.487s)
[t-SNE] Iteration 100: error = 73.6788788, gradient norm = 0.0227844 (50 iterations in 0.234s)
[t-SNE] Iteration 150: error = 73.6871948, gradient norm = 0.0392204 (50 iterations in 0.247s)
[t-SNE] Iteration 200: error = 73.6819611, gradient norm = 0.0308373 (50 iterations in 0.242s)
[t-SNE] Iteration 250: error = 73.6832733, gradient norm = 0.0341931 (50 iterations in 0.239s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 73.683273
[t-SNE] Iteration 300: error = 2.6358993, gradient norm = 0.0013124 (50 iterations in 0.208s)
[t-SNE] Iteration 350: error = 2.5082648, gradient norm = 0.0004123 (50 iterations in 0.197s)
[t-SNE] Iteration 400: error = 2.4541085, gradient norm = 0.0002424 (50 iterations in 0.198s)
[t-SNE] Iteration 450: error = 2.4269457, gradient norm = 0.0001494 (50 iterations in 0.200s)
[t-SNE] Iteration 500: error = 2.4130499, gradient norm = 0.0001157 (50 iterations in 0.196s)
[t-SNE] Iteration 550: error = 2.4047937, gradient norm = 0.0000849 (50 iterations in 0.198s)
[t-SNE] Iteration 600: error = 2.3984551, gradient norm = 0.0000685 (50 iterations in 0.195s)
[t-SNE] Iteration 650: error = 2.3939402, gradient norm = 0.0000782 (50 iterations in 0.199s)
[t-SNE] Iteration 700: error = 2.3914709, gradient norm = 0.0001003 (50 iterations in 0.198s)
[t-SNE] Iteration 750: error = 2.3898666, gradient norm = 0.0000663 (50 iterations in 0.197s)
[t-SNE] Iteration 800: error = 2.3882093, gradient norm = 0.0000532 (50 iterations in 0.195s)
[t-SNE] Iteration 850: error = 2.3862996, gradient norm = 0.0000809 (50 iterations in 0.196s)
[t-SNE] Iteration 900: error = 2.3847575, gradient norm = 0.0000954 (50 iterations in 0.200s)
[t-SNE] Iteration 950: error = 2.3845630, gradient norm = 0.0000668 (50 iterations in 0.199s)
[t-SNE] Iteration 1000: error = 2.3838441, gradient norm = 0.0000449 (50 iterations in 0.197s)
[t-SNE] KL divergence after 1000 iterations: 2.383844
[t-SNE] Computed conditional probabilities for sample 1000 / 2806
[t-SNE] Computed conditional probabilities for sample 2000 / 2806
[t-SNE] Computed conditional probabilities for sample 2806 / 2806
[t-SNE] Mean sigma: 0.302383
Beginning preprocessing + Leiden
2024-03-13 20:01:30.840237 MEMORY 17.339375616
Affmat transformed
2024-03-13 20:01:30.873193 MEMORY 17.340657664
sources, targets, weights extracted
2024-03-13 20:01:30.897951 MEMORY 17.340841984
About to launch parallel Leiden runs
2024-03-13 20:01:30.946642 MEMORY 17.340841984
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:   10.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   41.8s finished
Parallel Leiden runs finished
2024-03-13 20:02:12.743305 MEMORY 17.340841984
Quality: 0.4452717312475825
Quality: 0.44708892400434863
Quality: 0.4474764821134927
Quality: 0.44764715322364207
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 1650 tasks      | elapsed:    0.4s
[Parallel(n_jobs=24)]: Done 1785 out of 1785 | elapsed:    0.5s finished
Got subclusters: Counter({0: 540, 1: 492, 2: 465, 3: 425, 4: 319, 5: 262, 6: 155, 7: 99, 8: 49})
On pattern 1
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 1785 samples in 0.011s...
[t-SNE] Computed neighbors for 1785 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 1000 / 1785
[t-SNE] Computed conditional probabilities for sample 1785 / 1785
[t-SNE] Mean sigma: 0.317978
[t-SNE] Computed conditional probabilities in 0.123s
[t-SNE] Iteration 50: error = 69.1432648, gradient norm = 0.1577903 (50 iterations in 0.326s)
[t-SNE] Iteration 100: error = 69.1950226, gradient norm = 0.1407732 (50 iterations in 0.158s)
[t-SNE] Iteration 150: error = 69.5634537, gradient norm = 0.1299856 (50 iterations in 0.279s)
[t-SNE] Iteration 200: error = 69.0874939, gradient norm = 0.1217456 (50 iterations in 2.123s)
[t-SNE] Iteration 250: error = 68.8872833, gradient norm = 0.1335377 (50 iterations in 2.103s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 68.887283
[t-SNE] Iteration 300: error = 2.2788064, gradient norm = 0.0012899 (50 iterations in 0.235s)
[t-SNE] Iteration 350: error = 2.1976268, gradient norm = 0.0004257 (50 iterations in 0.134s)
[t-SNE] Iteration 400: error = 2.1612904, gradient norm = 0.0002695 (50 iterations in 0.135s)
[t-SNE] Iteration 450: error = 2.1445487, gradient norm = 0.0001655 (50 iterations in 0.905s)
[t-SNE] Iteration 500: error = 2.1360533, gradient norm = 0.0001489 (50 iterations in 0.706s)
[t-SNE] Iteration 550: error = 2.1305487, gradient norm = 0.0000986 (50 iterations in 0.143s)
[t-SNE] Iteration 600: error = 2.1271634, gradient norm = 0.0000747 (50 iterations in 0.137s)
[t-SNE] Iteration 650: error = 2.1250310, gradient norm = 0.0000730 (50 iterations in 0.136s)
[t-SNE] Iteration 700: error = 2.1230032, gradient norm = 0.0000682 (50 iterations in 0.138s)
[t-SNE] Iteration 750: error = 2.1218255, gradient norm = 0.0000666 (50 iterations in 0.157s)
[t-SNE] Iteration 800: error = 2.1193681, gradient norm = 0.0001020 (50 iterations in 0.222s)
[t-SNE] Iteration 850: error = 2.1167412, gradient norm = 0.0000898 (50 iterations in 0.133s)
[t-SNE] Iteration 900: error = 2.1154187, gradient norm = 0.0000770 (50 iterations in 0.163s)
[t-SNE] Iteration 950: error = 2.1144147, gradient norm = 0.0000642 (50 iterations in 0.132s)
[t-SNE] Iteration 1000: error = 2.1137702, gradient norm = 0.0000508 (50 iterations in 0.132s)
[t-SNE] KL divergence after 1000 iterations: 2.113770
[t-SNE] Computed conditional probabilities for sample 1000 / 1785
[t-SNE] Computed conditional probabilities for sample 1785 / 1785
[t-SNE] Mean sigma: 0.317978
Beginning preprocessing + Leiden
2024-03-13 20:02:24.187217 MEMORY 17.340841984
Affmat transformed
2024-03-13 20:02:24.208218 MEMORY 17.340841984
sources, targets, weights extracted
2024-03-13 20:02:24.223446 MEMORY 17.340841984
About to launch parallel Leiden runs
2024-03-13 20:02:24.281157 MEMORY 17.340841984
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    6.2s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   21.9s finished
Parallel Leiden runs finished
2024-03-13 20:02:46.221173 MEMORY 17.340841984
Quality: 0.4280041112685643
Quality: 0.4293212210167537
Quality: 0.4304537652575339
Quality: 0.43115107949779163
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 1290 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 1377 out of 1377 | elapsed:    0.3s finished
Got subclusters: Counter({0: 361, 1: 344, 2: 294, 3: 251, 4: 224, 5: 199, 6: 87, 7: 25})
On pattern 2
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 1377 samples in 0.010s...
[t-SNE] Computed neighbors for 1377 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 1000 / 1377
[t-SNE] Computed conditional probabilities for sample 1377 / 1377
[t-SNE] Mean sigma: 0.333194
[t-SNE] Computed conditional probabilities in 0.096s
[t-SNE] Iteration 50: error = 68.7609329, gradient norm = 0.2090184 (50 iterations in 0.138s)
[t-SNE] Iteration 100: error = 68.4938049, gradient norm = 0.1931756 (50 iterations in 0.119s)
[t-SNE] Iteration 150: error = 69.2152710, gradient norm = 0.1954226 (50 iterations in 0.122s)
[t-SNE] Iteration 200: error = 69.2088089, gradient norm = 0.1919190 (50 iterations in 0.119s)
[t-SNE] Iteration 250: error = 68.8127594, gradient norm = 0.1983323 (50 iterations in 0.117s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 68.812759
[t-SNE] Iteration 300: error = 1.9801334, gradient norm = 0.0019951 (50 iterations in 0.111s)
[t-SNE] Iteration 350: error = 1.9107604, gradient norm = 0.0004296 (50 iterations in 0.107s)
[t-SNE] Iteration 400: error = 1.8838642, gradient norm = 0.0002915 (50 iterations in 0.105s)
[t-SNE] Iteration 450: error = 1.8731357, gradient norm = 0.0001222 (50 iterations in 0.105s)
[t-SNE] Iteration 500: error = 1.8676702, gradient norm = 0.0000951 (50 iterations in 0.106s)
[t-SNE] Iteration 550: error = 1.8645164, gradient norm = 0.0000726 (50 iterations in 0.105s)
[t-SNE] Iteration 600: error = 1.8623184, gradient norm = 0.0000812 (50 iterations in 0.105s)
[t-SNE] Iteration 650: error = 1.8603648, gradient norm = 0.0001177 (50 iterations in 0.106s)
[t-SNE] Iteration 700: error = 1.8593403, gradient norm = 0.0000508 (50 iterations in 0.106s)
[t-SNE] Iteration 750: error = 1.8580718, gradient norm = 0.0000872 (50 iterations in 0.105s)
[t-SNE] Iteration 800: error = 1.8559350, gradient norm = 0.0000788 (50 iterations in 0.106s)
[t-SNE] Iteration 850: error = 1.8552580, gradient norm = 0.0000632 (50 iterations in 0.106s)
[t-SNE] Iteration 900: error = 1.8541881, gradient norm = 0.0000654 (50 iterations in 0.106s)
[t-SNE] Iteration 950: error = 1.8533933, gradient norm = 0.0000726 (50 iterations in 0.105s)
[t-SNE] Iteration 1000: error = 1.8522093, gradient norm = 0.0000555 (50 iterations in 0.106s)
[t-SNE] KL divergence after 1000 iterations: 1.852209
[t-SNE] Computed conditional probabilities for sample 1000 / 1377
[t-SNE] Computed conditional probabilities for sample 1377 / 1377
[t-SNE] Mean sigma: 0.333194
Beginning preprocessing + Leiden
2024-03-13 20:02:50.534871 MEMORY 17.340841984
Affmat transformed
2024-03-13 20:02:50.552718 MEMORY 17.340841984
sources, targets, weights extracted
2024-03-13 20:02:50.563452 MEMORY 17.340841984
About to launch parallel Leiden runs
2024-03-13 20:02:50.613261 MEMORY 17.340841984
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    3.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   12.2s finished
Parallel Leiden runs finished
2024-03-13 20:03:02.828356 MEMORY 17.340841984
Quality: 0.4527532869693853
Quality: 0.4547863150435744
Quality: 0.45554786377487105
Quality: 0.4562099365455861
Quality: 0.45673696267402936
Quality: 0.4569328604708289
Quality: 0.4569875125603812
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 1242 out of 1242 | elapsed:    0.3s finished
Got subclusters: Counter({0: 297, 1: 190, 2: 184, 3: 162, 4: 156, 5: 133, 6: 129, 7: 126})
On pattern 3
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 1242 samples in 0.010s...
[t-SNE] Computed neighbors for 1242 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 1000 / 1242
[t-SNE] Computed conditional probabilities for sample 1242 / 1242
[t-SNE] Mean sigma: 0.316661
[t-SNE] Computed conditional probabilities in 0.084s
[t-SNE] Iteration 50: error = 68.5425491, gradient norm = 0.2460359 (50 iterations in 0.107s)
[t-SNE] Iteration 100: error = 68.8786926, gradient norm = 0.2351245 (50 iterations in 0.099s)
[t-SNE] Iteration 150: error = 69.0513916, gradient norm = 0.2501067 (50 iterations in 0.101s)
[t-SNE] Iteration 200: error = 68.6138611, gradient norm = 0.2367402 (50 iterations in 0.107s)
[t-SNE] Iteration 250: error = 68.5154266, gradient norm = 0.2323675 (50 iterations in 0.102s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 68.515427
[t-SNE] Iteration 300: error = 1.9743481, gradient norm = 0.0017234 (50 iterations in 0.094s)
[t-SNE] Iteration 350: error = 1.9114237, gradient norm = 0.0005237 (50 iterations in 0.090s)
[t-SNE] Iteration 400: error = 1.8886434, gradient norm = 0.0002214 (50 iterations in 0.090s)
[t-SNE] Iteration 450: error = 1.8783404, gradient norm = 0.0001747 (50 iterations in 0.091s)
[t-SNE] Iteration 500: error = 1.8725742, gradient norm = 0.0001332 (50 iterations in 0.091s)
[t-SNE] Iteration 550: error = 1.8693385, gradient norm = 0.0001939 (50 iterations in 0.089s)
[t-SNE] Iteration 600: error = 1.8655143, gradient norm = 0.0001203 (50 iterations in 0.091s)
[t-SNE] Iteration 650: error = 1.8640382, gradient norm = 0.0000987 (50 iterations in 0.091s)
[t-SNE] Iteration 700: error = 1.8625009, gradient norm = 0.0000713 (50 iterations in 0.092s)
[t-SNE] Iteration 750: error = 1.8616648, gradient norm = 0.0000906 (50 iterations in 0.090s)
[t-SNE] Iteration 800: error = 1.8606091, gradient norm = 0.0000561 (50 iterations in 0.092s)
[t-SNE] Iteration 850: error = 1.8601698, gradient norm = 0.0000487 (50 iterations in 0.089s)
[t-SNE] Iteration 900: error = 1.8595895, gradient norm = 0.0000529 (50 iterations in 0.089s)
[t-SNE] Iteration 950: error = 1.8591505, gradient norm = 0.0000437 (50 iterations in 0.089s)
[t-SNE] Iteration 1000: error = 1.8587443, gradient norm = 0.0000476 (50 iterations in 0.090s)
[t-SNE] KL divergence after 1000 iterations: 1.858744
[t-SNE] Computed conditional probabilities for sample 1000 / 1242
[t-SNE] Computed conditional probabilities for sample 1242 / 1242
[t-SNE] Mean sigma: 0.316661
Beginning preprocessing + Leiden
2024-03-13 20:03:06.531036 MEMORY 17.340841984
Affmat transformed
2024-03-13 20:03:06.546073 MEMORY 17.340841984
sources, targets, weights extracted
2024-03-13 20:03:06.556067 MEMORY 17.340841984
About to launch parallel Leiden runs
2024-03-13 20:03:06.572630 MEMORY 17.340841984
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    3.4s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   11.7s finished
Parallel Leiden runs finished
2024-03-13 20:03:18.278039 MEMORY 17.340841984
Quality: 0.4191872486596905
Quality: 0.4196898925174032
Quality: 0.4213986334254365
Quality: 0.42166230293585444
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 1119 out of 1119 | elapsed:    0.2s finished
Got subclusters: Counter({0: 270, 1: 244, 2: 186, 3: 186, 4: 176, 5: 109, 6: 71})
On pattern 4
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 1119 samples in 0.007s...
[t-SNE] Computed neighbors for 1119 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 1000 / 1119
[t-SNE] Computed conditional probabilities for sample 1119 / 1119
[t-SNE] Mean sigma: 0.344633
[t-SNE] Computed conditional probabilities in 0.074s
[t-SNE] Iteration 50: error = 67.7655563, gradient norm = 0.2780218 (50 iterations in 0.212s)
[t-SNE] Iteration 100: error = 69.3973694, gradient norm = 0.2484795 (50 iterations in 0.094s)
[t-SNE] Iteration 150: error = 69.9379578, gradient norm = 0.2584643 (50 iterations in 0.097s)
[t-SNE] Iteration 200: error = 69.6363144, gradient norm = 0.2375776 (50 iterations in 0.150s)
[t-SNE] Iteration 250: error = 68.5872726, gradient norm = 0.2597826 (50 iterations in 0.095s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 68.587273
[t-SNE] Iteration 300: error = 1.9899946, gradient norm = 0.0021619 (50 iterations in 0.118s)
[t-SNE] Iteration 350: error = 1.9309701, gradient norm = 0.0006889 (50 iterations in 0.086s)
[t-SNE] Iteration 400: error = 1.9035966, gradient norm = 0.0003356 (50 iterations in 0.115s)
[t-SNE] Iteration 450: error = 1.8914353, gradient norm = 0.0002070 (50 iterations in 0.119s)
[t-SNE] Iteration 500: error = 1.8846707, gradient norm = 0.0001472 (50 iterations in 0.115s)
[t-SNE] Iteration 550: error = 1.8809952, gradient norm = 0.0001521 (50 iterations in 0.088s)
[t-SNE] Iteration 600: error = 1.8758546, gradient norm = 0.0001852 (50 iterations in 0.087s)
[t-SNE] Iteration 650: error = 1.8735533, gradient norm = 0.0000810 (50 iterations in 0.084s)
[t-SNE] Iteration 700: error = 1.8723313, gradient norm = 0.0000636 (50 iterations in 0.086s)
[t-SNE] Iteration 750: error = 1.8713672, gradient norm = 0.0000628 (50 iterations in 0.084s)
[t-SNE] Iteration 800: error = 1.8707986, gradient norm = 0.0000751 (50 iterations in 0.084s)
[t-SNE] Iteration 850: error = 1.8699509, gradient norm = 0.0000585 (50 iterations in 0.084s)
[t-SNE] Iteration 900: error = 1.8692428, gradient norm = 0.0001657 (50 iterations in 0.085s)
[t-SNE] Iteration 950: error = 1.8681523, gradient norm = 0.0000925 (50 iterations in 0.084s)
[t-SNE] Iteration 1000: error = 1.8681016, gradient norm = 0.0000615 (50 iterations in 0.084s)
[t-SNE] KL divergence after 1000 iterations: 1.868102
[t-SNE] Computed conditional probabilities for sample 1000 / 1119
[t-SNE] Computed conditional probabilities for sample 1119 / 1119
[t-SNE] Mean sigma: 0.344633
Beginning preprocessing + Leiden
2024-03-13 20:03:21.993114 MEMORY 17.340841984
Affmat transformed
2024-03-13 20:03:22.010976 MEMORY 17.340841984
sources, targets, weights extracted
2024-03-13 20:03:22.020121 MEMORY 17.340841984
About to launch parallel Leiden runs
2024-03-13 20:03:22.027355 MEMORY 17.340841984
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    3.5s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   10.9s finished
Parallel Leiden runs finished
2024-03-13 20:03:32.913299 MEMORY 17.340841984
Quality: 0.40695908575105355
Quality: 0.4081042868803847
Quality: 0.408435360202393
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 930 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 1057 out of 1057 | elapsed:    0.3s finished
Got subclusters: Counter({0: 211, 1: 186, 2: 163, 3: 157, 4: 126, 5: 114, 6: 109, 7: 53})
On pattern 5
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 1057 samples in 0.007s...
[t-SNE] Computed neighbors for 1057 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 1000 / 1057
[t-SNE] Computed conditional probabilities for sample 1057 / 1057
[t-SNE] Mean sigma: 0.330297
[t-SNE] Computed conditional probabilities in 0.071s
[t-SNE] Iteration 50: error = 67.4104614, gradient norm = 0.2986051 (50 iterations in 0.087s)
[t-SNE] Iteration 100: error = 67.8143463, gradient norm = 0.2972956 (50 iterations in 0.088s)
[t-SNE] Iteration 150: error = 69.4073944, gradient norm = 0.2717342 (50 iterations in 0.091s)
[t-SNE] Iteration 200: error = 69.6498795, gradient norm = 0.2793111 (50 iterations in 0.088s)
[t-SNE] Iteration 250: error = 69.8403473, gradient norm = 0.2599336 (50 iterations in 0.087s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 69.840347
[t-SNE] Iteration 300: error = 1.8967128, gradient norm = 0.0026118 (50 iterations in 0.083s)
[t-SNE] Iteration 350: error = 1.8395697, gradient norm = 0.0007031 (50 iterations in 0.080s)
[t-SNE] Iteration 400: error = 1.8171788, gradient norm = 0.0002445 (50 iterations in 0.080s)
[t-SNE] Iteration 450: error = 1.8076832, gradient norm = 0.0001798 (50 iterations in 0.081s)
[t-SNE] Iteration 500: error = 1.8009943, gradient norm = 0.0001475 (50 iterations in 0.082s)
[t-SNE] Iteration 550: error = 1.7990096, gradient norm = 0.0001226 (50 iterations in 0.081s)
[t-SNE] Iteration 600: error = 1.7952667, gradient norm = 0.0001673 (50 iterations in 0.082s)
[t-SNE] Iteration 650: error = 1.7937067, gradient norm = 0.0000676 (50 iterations in 0.080s)
[t-SNE] Iteration 700: error = 1.7929167, gradient norm = 0.0000580 (50 iterations in 0.080s)
[t-SNE] Iteration 750: error = 1.7922101, gradient norm = 0.0000556 (50 iterations in 0.080s)
[t-SNE] Iteration 800: error = 1.7917397, gradient norm = 0.0000386 (50 iterations in 0.080s)
[t-SNE] Iteration 850: error = 1.7915112, gradient norm = 0.0000461 (50 iterations in 0.083s)
[t-SNE] Iteration 900: error = 1.7912763, gradient norm = 0.0000379 (50 iterations in 0.080s)
[t-SNE] Iteration 950: error = 1.7907621, gradient norm = 0.0000812 (50 iterations in 0.081s)
[t-SNE] Iteration 1000: error = 1.7902406, gradient norm = 0.0000944 (50 iterations in 0.082s)
[t-SNE] KL divergence after 1000 iterations: 1.790241
[t-SNE] Computed conditional probabilities for sample 1000 / 1057
[t-SNE] Computed conditional probabilities for sample 1057 / 1057
[t-SNE] Mean sigma: 0.330297
Beginning preprocessing + Leiden
2024-03-13 20:03:36.195839 MEMORY 17.340841984
Affmat transformed
2024-03-13 20:03:36.208966 MEMORY 17.340841984
sources, targets, weights extracted
2024-03-13 20:03:36.217949 MEMORY 17.340841984
About to launch parallel Leiden runs
2024-03-13 20:03:36.260187 MEMORY 17.340841984
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    3.0s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   10.8s finished
Parallel Leiden runs finished
2024-03-13 20:03:47.089493 MEMORY 17.340841984
Quality: 0.4092117568528587
Quality: 0.41251480702229115
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 856 out of 856 | elapsed:    0.2s finished
Got subclusters: Counter({0: 223, 1: 203, 2: 190, 3: 144, 4: 108, 5: 106, 6: 53, 7: 30})
On pattern 6
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 856 samples in 0.006s...
[t-SNE] Computed neighbors for 856 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 856 / 856
[t-SNE] Mean sigma: 0.302808
[t-SNE] Computed conditional probabilities in 0.057s
[t-SNE] Iteration 50: error = 70.0256271, gradient norm = 0.3374540 (50 iterations in 0.080s)
[t-SNE] Iteration 100: error = 71.8270187, gradient norm = 0.3066166 (50 iterations in 0.079s)
[t-SNE] Iteration 150: error = 70.5816956, gradient norm = 0.3334434 (50 iterations in 0.080s)
[t-SNE] Iteration 200: error = 73.2256775, gradient norm = 0.3114309 (50 iterations in 0.083s)
[t-SNE] Iteration 250: error = 71.9648895, gradient norm = 0.3252641 (50 iterations in 0.082s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 71.964890
[t-SNE] Iteration 300: error = 1.7580299, gradient norm = 0.0029621 (50 iterations in 0.105s)
[t-SNE] Iteration 350: error = 1.6853472, gradient norm = 0.0005686 (50 iterations in 0.101s)
[t-SNE] Iteration 400: error = 1.6726969, gradient norm = 0.0003269 (50 iterations in 0.098s)
[t-SNE] Iteration 450: error = 1.6619735, gradient norm = 0.0003792 (50 iterations in 0.103s)
[t-SNE] Iteration 500: error = 1.6563296, gradient norm = 0.0002202 (50 iterations in 0.074s)
[t-SNE] Iteration 550: error = 1.6521180, gradient norm = 0.0001927 (50 iterations in 0.095s)
[t-SNE] Iteration 600: error = 1.6504230, gradient norm = 0.0001509 (50 iterations in 0.081s)
[t-SNE] Iteration 650: error = 1.6495045, gradient norm = 0.0001388 (50 iterations in 0.074s)
[t-SNE] Iteration 700: error = 1.6485597, gradient norm = 0.0001011 (50 iterations in 0.074s)
[t-SNE] Iteration 750: error = 1.6479759, gradient norm = 0.0001056 (50 iterations in 0.071s)
[t-SNE] Iteration 800: error = 1.6470618, gradient norm = 0.0001491 (50 iterations in 0.075s)
[t-SNE] Iteration 850: error = 1.6463810, gradient norm = 0.0000950 (50 iterations in 0.071s)
[t-SNE] Iteration 900: error = 1.6443895, gradient norm = 0.0000834 (50 iterations in 0.071s)
[t-SNE] Iteration 950: error = 1.6440593, gradient norm = 0.0000646 (50 iterations in 0.072s)
[t-SNE] Iteration 1000: error = 1.6437515, gradient norm = 0.0000746 (50 iterations in 0.071s)
[t-SNE] KL divergence after 1000 iterations: 1.643752
[t-SNE] Computed conditional probabilities for sample 856 / 856
[t-SNE] Mean sigma: 0.302808
Beginning preprocessing + Leiden
2024-03-13 20:03:50.072614 MEMORY 17.340841984
Affmat transformed
2024-03-13 20:03:50.084494 MEMORY 17.340841984
sources, targets, weights extracted
2024-03-13 20:03:50.093208 MEMORY 17.340841984
About to launch parallel Leiden runs
2024-03-13 20:03:50.128236 MEMORY 17.340841984
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    2.3s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    7.4s finished
Parallel Leiden runs finished
2024-03-13 20:03:57.570850 MEMORY 17.340841984
Quality: 0.3769271369231859
Quality: 0.3807371416969272
Quality: 0.38122108804692434
Quality: 0.38174438802855803
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 715 out of 715 | elapsed:    0.4s finished
Got subclusters: Counter({0: 127, 1: 127, 2: 116, 3: 102, 4: 99, 6: 81, 5: 81, 7: 67, 8: 56})
On pattern 7
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 715 samples in 0.005s...
[t-SNE] Computed neighbors for 715 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 715 / 715
[t-SNE] Mean sigma: 0.344563
[t-SNE] Computed conditional probabilities in 0.049s
[t-SNE] Iteration 50: error = 70.7895966, gradient norm = 0.3736673 (50 iterations in 0.070s)
[t-SNE] Iteration 100: error = 70.7940369, gradient norm = 0.3853920 (50 iterations in 0.069s)
[t-SNE] Iteration 150: error = 73.9204941, gradient norm = 0.3360057 (50 iterations in 0.066s)
[t-SNE] Iteration 200: error = 72.2167206, gradient norm = 0.3663952 (50 iterations in 0.068s)
[t-SNE] Iteration 250: error = 74.1378250, gradient norm = 0.3545416 (50 iterations in 0.070s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 74.137825
[t-SNE] Iteration 300: error = 1.6771898, gradient norm = 0.0041203 (50 iterations in 0.063s)
[t-SNE] Iteration 350: error = 1.5795908, gradient norm = 0.0007622 (50 iterations in 0.062s)
[t-SNE] Iteration 400: error = 1.5621934, gradient norm = 0.0004961 (50 iterations in 0.064s)
[t-SNE] Iteration 450: error = 1.5465854, gradient norm = 0.0005230 (50 iterations in 0.064s)
[t-SNE] Iteration 500: error = 1.5381002, gradient norm = 0.0005575 (50 iterations in 0.061s)
[t-SNE] Iteration 550: error = 1.5283308, gradient norm = 0.0004378 (50 iterations in 0.061s)
[t-SNE] Iteration 600: error = 1.5246757, gradient norm = 0.0002486 (50 iterations in 0.062s)
[t-SNE] Iteration 650: error = 1.5230572, gradient norm = 0.0001291 (50 iterations in 0.063s)
[t-SNE] Iteration 700: error = 1.5220257, gradient norm = 0.0001736 (50 iterations in 0.061s)
[t-SNE] Iteration 750: error = 1.5165689, gradient norm = 0.0001357 (50 iterations in 0.061s)
[t-SNE] Iteration 800: error = 1.5150515, gradient norm = 0.0001355 (50 iterations in 0.062s)
[t-SNE] Iteration 850: error = 1.5146344, gradient norm = 0.0000842 (50 iterations in 0.061s)
[t-SNE] Iteration 900: error = 1.5137867, gradient norm = 0.0001351 (50 iterations in 0.061s)
[t-SNE] Iteration 950: error = 1.5129960, gradient norm = 0.0002635 (50 iterations in 0.061s)
[t-SNE] Iteration 1000: error = 1.5122929, gradient norm = 0.0001166 (50 iterations in 0.061s)
[t-SNE] KL divergence after 1000 iterations: 1.512293
[t-SNE] Computed conditional probabilities for sample 715 / 715
[t-SNE] Mean sigma: 0.344563
Beginning preprocessing + Leiden
2024-03-13 20:04:00.230965 MEMORY 17.340841984
Affmat transformed
2024-03-13 20:04:00.241228 MEMORY 17.340841984
sources, targets, weights extracted
2024-03-13 20:04:00.247472 MEMORY 17.340841984
About to launch parallel Leiden runs
2024-03-13 20:04:00.331238 MEMORY 17.340841984
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    2.0s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    6.5s finished
Parallel Leiden runs finished
2024-03-13 20:04:06.872382 MEMORY 17.340841984
Quality: 0.40468371813457743
Quality: 0.4047767712299692
Quality: 0.40521589335230185
Quality: 0.40536650539175556
Quality: 0.4053707622937839
Quality: 0.40538464111761713
Quality: 0.40556878801042123
Quality: 0.4056426708468808
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 683 out of 683 | elapsed:    0.4s finished
Got subclusters: Counter({0: 148, 1: 139, 2: 131, 3: 101, 4: 86, 5: 78, 6: 27, 7: 5})
On pattern 8
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 683 samples in 0.005s...
[t-SNE] Computed neighbors for 683 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 683 / 683
[t-SNE] Mean sigma: 0.352733
[t-SNE] Computed conditional probabilities in 0.046s
[t-SNE] Iteration 50: error = 67.4804993, gradient norm = 0.4270172 (50 iterations in 0.075s)
[t-SNE] Iteration 100: error = 68.5435104, gradient norm = 0.3997788 (50 iterations in 0.066s)
[t-SNE] Iteration 150: error = 71.1946716, gradient norm = 0.3783946 (50 iterations in 0.103s)
[t-SNE] Iteration 200: error = 70.5917969, gradient norm = 0.3879624 (50 iterations in 0.063s)
[t-SNE] Iteration 250: error = 70.0228577, gradient norm = 0.3938664 (50 iterations in 0.069s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 70.022858
[t-SNE] Iteration 300: error = 1.7606583, gradient norm = 0.0029331 (50 iterations in 0.062s)
[t-SNE] Iteration 350: error = 1.7118767, gradient norm = 0.0010155 (50 iterations in 0.059s)
[t-SNE] Iteration 400: error = 1.6966211, gradient norm = 0.0003469 (50 iterations in 0.063s)
[t-SNE] Iteration 450: error = 1.6844244, gradient norm = 0.0005876 (50 iterations in 0.059s)
[t-SNE] Iteration 500: error = 1.6611600, gradient norm = 0.0005919 (50 iterations in 0.060s)
[t-SNE] Iteration 550: error = 1.6581129, gradient norm = 0.0001392 (50 iterations in 0.061s)
[t-SNE] Iteration 600: error = 1.6565216, gradient norm = 0.0001681 (50 iterations in 0.088s)
[t-SNE] Iteration 650: error = 1.6521940, gradient norm = 0.0002177 (50 iterations in 0.059s)
[t-SNE] Iteration 700: error = 1.6430734, gradient norm = 0.0003077 (50 iterations in 0.060s)
[t-SNE] Iteration 750: error = 1.6408207, gradient norm = 0.0002194 (50 iterations in 0.059s)
[t-SNE] Iteration 800: error = 1.6375804, gradient norm = 0.0002765 (50 iterations in 0.059s)
[t-SNE] Iteration 850: error = 1.6339090, gradient norm = 0.0003125 (50 iterations in 0.060s)
[t-SNE] Iteration 900: error = 1.6331683, gradient norm = 0.0000851 (50 iterations in 0.060s)
[t-SNE] Iteration 950: error = 1.6328247, gradient norm = 0.0000972 (50 iterations in 0.059s)
[t-SNE] Iteration 1000: error = 1.6316060, gradient norm = 0.0001276 (50 iterations in 0.060s)
[t-SNE] KL divergence after 1000 iterations: 1.631606
[t-SNE] Computed conditional probabilities for sample 683 / 683
[t-SNE] Mean sigma: 0.352733
Beginning preprocessing + Leiden
2024-03-13 20:04:09.456315 MEMORY 17.340841984
Affmat transformed
2024-03-13 20:04:09.464561 MEMORY 17.340841984
sources, targets, weights extracted
2024-03-13 20:04:09.469029 MEMORY 17.340841984
About to launch parallel Leiden runs
2024-03-13 20:04:09.570447 MEMORY 17.340841984
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.8s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    6.1s finished
Parallel Leiden runs finished
2024-03-13 20:04:15.623366 MEMORY 17.340841984
Quality: 0.3763271470458493
Quality: 0.3764755951218623
Quality: 0.3801607534877839
Quality: 0.38027223005600114
Quality: 0.3804261289052266
Quality: 0.3815022176705174
Quality: 0.38240405784606757
Quality: 0.3833722609857754
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 625 out of 625 | elapsed:    0.3s finished
Got subclusters: Counter({0: 176, 1: 144, 2: 114, 3: 96, 4: 90, 5: 63})
On pattern 9
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 625 samples in 0.004s...
[t-SNE] Computed neighbors for 625 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 625 / 625
[t-SNE] Mean sigma: 0.347748
[t-SNE] Computed conditional probabilities in 0.042s
[t-SNE] Iteration 50: error = 69.9711151, gradient norm = 0.4046507 (50 iterations in 0.061s)
[t-SNE] Iteration 100: error = 71.9124451, gradient norm = 0.3745987 (50 iterations in 0.062s)
[t-SNE] Iteration 150: error = 71.1670761, gradient norm = 0.3967791 (50 iterations in 0.062s)
[t-SNE] Iteration 200: error = 71.3675461, gradient norm = 0.3884753 (50 iterations in 0.062s)
[t-SNE] Iteration 250: error = 72.5113525, gradient norm = 0.3843841 (50 iterations in 0.063s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 72.511353
[t-SNE] Iteration 300: error = 1.7087964, gradient norm = 0.0036103 (50 iterations in 0.060s)
[t-SNE] Iteration 350: error = 1.6596813, gradient norm = 0.0011259 (50 iterations in 0.060s)
[t-SNE] Iteration 400: error = 1.6394175, gradient norm = 0.0004432 (50 iterations in 0.057s)
[t-SNE] Iteration 450: error = 1.6274382, gradient norm = 0.0009747 (50 iterations in 0.059s)
[t-SNE] Iteration 500: error = 1.6146965, gradient norm = 0.0004307 (50 iterations in 0.058s)
[t-SNE] Iteration 550: error = 1.6104779, gradient norm = 0.0002275 (50 iterations in 0.057s)
[t-SNE] Iteration 600: error = 1.6084055, gradient norm = 0.0003934 (50 iterations in 0.057s)
[t-SNE] Iteration 650: error = 1.6081409, gradient norm = 0.0001065 (50 iterations in 0.057s)
[t-SNE] Iteration 700: error = 1.6080056, gradient norm = 0.0000498 (50 iterations in 0.057s)
[t-SNE] Iteration 750: error = 1.6077304, gradient norm = 0.0000435 (50 iterations in 0.057s)
[t-SNE] Iteration 800: error = 1.6076844, gradient norm = 0.0000548 (50 iterations in 0.057s)
[t-SNE] Iteration 850: error = 1.6076560, gradient norm = 0.0000631 (50 iterations in 0.060s)
[t-SNE] Iteration 900: error = 1.6075950, gradient norm = 0.0000550 (50 iterations in 0.061s)
[t-SNE] Iteration 950: error = 1.6074095, gradient norm = 0.0000560 (50 iterations in 0.061s)
[t-SNE] Iteration 1000: error = 1.6074761, gradient norm = 0.0000615 (50 iterations in 0.059s)
[t-SNE] KL divergence after 1000 iterations: 1.607476
[t-SNE] Computed conditional probabilities for sample 625 / 625
[t-SNE] Mean sigma: 0.347748
Beginning preprocessing + Leiden
2024-03-13 20:04:17.918942 MEMORY 17.340841984
Affmat transformed
2024-03-13 20:04:17.926961 MEMORY 17.340841984
sources, targets, weights extracted
2024-03-13 20:04:17.931303 MEMORY 17.340841984
About to launch parallel Leiden runs
2024-03-13 20:04:17.987392 MEMORY 17.340841984
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    5.7s finished
Parallel Leiden runs finished
2024-03-13 20:04:23.683127 MEMORY 17.340841984
Quality: 0.369422258247057
Quality: 0.3720621967026925
Quality: 0.3737443457367224
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 625 out of 625 | elapsed:    0.3s finished
Got subclusters: Counter({0: 135, 1: 103, 2: 97, 3: 93, 4: 85, 5: 68, 6: 44})
On pattern 10
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 625 samples in 0.005s...
[t-SNE] Computed neighbors for 625 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 625 / 625
[t-SNE] Mean sigma: 0.321933
[t-SNE] Computed conditional probabilities in 0.045s
[t-SNE] Iteration 50: error = 71.0259323, gradient norm = 0.4061671 (50 iterations in 0.099s)
[t-SNE] Iteration 100: error = 73.5981293, gradient norm = 0.3933228 (50 iterations in 0.062s)
[t-SNE] Iteration 150: error = 73.9797745, gradient norm = 0.3875213 (50 iterations in 0.064s)
[t-SNE] Iteration 200: error = 74.5268784, gradient norm = 0.3955300 (50 iterations in 0.061s)
[t-SNE] Iteration 250: error = 72.1406860, gradient norm = 0.3818627 (50 iterations in 0.064s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 72.140686
[t-SNE] Iteration 300: error = 1.4982846, gradient norm = 0.0030354 (50 iterations in 0.059s)
[t-SNE] Iteration 350: error = 1.4646142, gradient norm = 0.0007474 (50 iterations in 0.057s)
[t-SNE] Iteration 400: error = 1.4516296, gradient norm = 0.0006532 (50 iterations in 0.057s)
[t-SNE] Iteration 450: error = 1.4421707, gradient norm = 0.0008728 (50 iterations in 0.057s)
[t-SNE] Iteration 500: error = 1.4354359, gradient norm = 0.0005021 (50 iterations in 0.057s)
[t-SNE] Iteration 550: error = 1.4258696, gradient norm = 0.0002547 (50 iterations in 0.057s)
[t-SNE] Iteration 600: error = 1.4230812, gradient norm = 0.0003289 (50 iterations in 0.057s)
[t-SNE] Iteration 650: error = 1.4186827, gradient norm = 0.0003896 (50 iterations in 0.057s)
[t-SNE] Iteration 700: error = 1.4082650, gradient norm = 0.0006267 (50 iterations in 0.057s)
[t-SNE] Iteration 750: error = 1.4036511, gradient norm = 0.0002860 (50 iterations in 0.057s)
[t-SNE] Iteration 800: error = 1.4002905, gradient norm = 0.0002355 (50 iterations in 0.057s)
[t-SNE] Iteration 850: error = 1.3996215, gradient norm = 0.0000654 (50 iterations in 0.057s)
[t-SNE] Iteration 900: error = 1.3993921, gradient norm = 0.0000690 (50 iterations in 0.059s)
[t-SNE] Iteration 950: error = 1.3992507, gradient norm = 0.0000394 (50 iterations in 0.057s)
[t-SNE] Iteration 1000: error = 1.3991318, gradient norm = 0.0000396 (50 iterations in 0.057s)
[t-SNE] KL divergence after 1000 iterations: 1.399132
[t-SNE] Computed conditional probabilities for sample 625 / 625
[t-SNE] Mean sigma: 0.321933
Beginning preprocessing + Leiden
2024-03-13 20:04:25.985473 MEMORY 17.340841984
Affmat transformed
2024-03-13 20:04:25.993336 MEMORY 17.340841984
sources, targets, weights extracted
2024-03-13 20:04:25.998291 MEMORY 17.340841984
About to launch parallel Leiden runs
2024-03-13 20:04:26.043366 MEMORY 17.340841984
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.6s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    5.3s finished
Parallel Leiden runs finished
2024-03-13 20:04:31.347868 MEMORY 17.340841984
Quality: 0.39196322600185957
Quality: 0.3934189193008111
Quality: 0.39344275564224
Quality: 0.3934791761256606
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 373 out of 373 | elapsed:    0.1s finished
Got subclusters: Counter({0: 141, 1: 133, 2: 110, 3: 91, 4: 83, 5: 47, 6: 20})
On pattern 11
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 373 samples in 0.003s...
[t-SNE] Computed neighbors for 373 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 373 / 373
[t-SNE] Mean sigma: 0.381811
[t-SNE] Computed conditional probabilities in 0.025s
[t-SNE] Iteration 50: error = 66.0174103, gradient norm = 0.5015830 (50 iterations in 0.043s)
[t-SNE] Iteration 100: error = 72.4748230, gradient norm = 0.4344939 (50 iterations in 0.043s)
[t-SNE] Iteration 150: error = 71.6332855, gradient norm = 0.4549321 (50 iterations in 0.043s)
[t-SNE] Iteration 200: error = 73.3622971, gradient norm = 0.4247657 (50 iterations in 0.043s)
[t-SNE] Iteration 250: error = 71.9207306, gradient norm = 0.4248415 (50 iterations in 0.043s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 71.920731
[t-SNE] Iteration 300: error = 1.2940812, gradient norm = 0.0037647 (50 iterations in 0.042s)
[t-SNE] Iteration 350: error = 1.1960690, gradient norm = 0.0016166 (50 iterations in 0.041s)
[t-SNE] Iteration 400: error = 1.1368628, gradient norm = 0.0019445 (50 iterations in 0.041s)
[t-SNE] Iteration 450: error = 1.1176316, gradient norm = 0.0005327 (50 iterations in 0.043s)
[t-SNE] Iteration 500: error = 1.1125233, gradient norm = 0.0004842 (50 iterations in 0.041s)
[t-SNE] Iteration 550: error = 1.1029428, gradient norm = 0.0007577 (50 iterations in 0.041s)
[t-SNE] Iteration 600: error = 1.0907322, gradient norm = 0.0003275 (50 iterations in 0.041s)
[t-SNE] Iteration 650: error = 1.0906279, gradient norm = 0.0002985 (50 iterations in 0.041s)
[t-SNE] Iteration 700: error = 1.0902735, gradient norm = 0.0001087 (50 iterations in 0.041s)
[t-SNE] Iteration 750: error = 1.0902721, gradient norm = 0.0003638 (50 iterations in 0.041s)
[t-SNE] Iteration 800: error = 1.0880543, gradient norm = 0.0001579 (50 iterations in 0.041s)
[t-SNE] Iteration 850: error = 1.0872155, gradient norm = 0.0000796 (50 iterations in 0.041s)
[t-SNE] Iteration 900: error = 1.0872394, gradient norm = 0.0000901 (50 iterations in 0.041s)
[t-SNE] Iteration 950: error = 1.0871047, gradient norm = 0.0000764 (50 iterations in 0.041s)
[t-SNE] Iteration 1000: error = 1.0869343, gradient norm = 0.0001105 (50 iterations in 0.048s)
[t-SNE] KL divergence after 1000 iterations: 1.086934
[t-SNE] Computed conditional probabilities for sample 373 / 373
[t-SNE] Mean sigma: 0.381811
Beginning preprocessing + Leiden
2024-03-13 20:04:32.815668 MEMORY 17.340841984
Affmat transformed
2024-03-13 20:04:32.820747 MEMORY 17.340841984
sources, targets, weights extracted
2024-03-13 20:04:32.823272 MEMORY 17.340841984
About to launch parallel Leiden runs
2024-03-13 20:04:32.863659 MEMORY 17.340841984
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.1s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    3.5s finished
Parallel Leiden runs finished
2024-03-13 20:04:36.414442 MEMORY 17.340841984
Quality: 0.3690203928577678
Quality: 0.3701916352844034
Quality: 0.3702125697035299
Quality: 0.370443425564799
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 366 out of 366 | elapsed:    0.1s finished
Got subclusters: Counter({0: 83, 1: 71, 2: 68, 3: 67, 4: 43, 5: 34, 6: 7})
On pattern 12
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 366 samples in 0.003s...
[t-SNE] Computed neighbors for 366 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 366 / 366
[t-SNE] Mean sigma: 0.367323
[t-SNE] Computed conditional probabilities in 0.025s
[t-SNE] Iteration 50: error = 63.1684990, gradient norm = 0.5180803 (50 iterations in 0.053s)
[t-SNE] Iteration 100: error = 68.1723328, gradient norm = 0.4778491 (50 iterations in 0.042s)
[t-SNE] Iteration 150: error = 68.6363983, gradient norm = 0.4622437 (50 iterations in 0.042s)
[t-SNE] Iteration 200: error = 71.0450745, gradient norm = 0.4356505 (50 iterations in 0.042s)
[t-SNE] Iteration 250: error = 69.5291443, gradient norm = 0.4898852 (50 iterations in 0.042s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 69.529144
[t-SNE] Iteration 300: error = 1.4061204, gradient norm = 0.0052516 (50 iterations in 0.041s)
[t-SNE] Iteration 350: error = 1.2704849, gradient norm = 0.0029178 (50 iterations in 0.041s)
[t-SNE] Iteration 400: error = 1.2367711, gradient norm = 0.0010181 (50 iterations in 0.040s)
[t-SNE] Iteration 450: error = 1.1893184, gradient norm = 0.0024409 (50 iterations in 0.040s)
[t-SNE] Iteration 500: error = 1.1414108, gradient norm = 0.0015655 (50 iterations in 0.040s)
[t-SNE] Iteration 550: error = 1.1284070, gradient norm = 0.0011154 (50 iterations in 0.040s)
[t-SNE] Iteration 600: error = 1.1167045, gradient norm = 0.0003097 (50 iterations in 0.040s)
[t-SNE] Iteration 650: error = 1.1129483, gradient norm = 0.0005319 (50 iterations in 0.040s)
[t-SNE] Iteration 700: error = 1.1065004, gradient norm = 0.0009335 (50 iterations in 0.040s)
[t-SNE] Iteration 750: error = 1.1045753, gradient norm = 0.0002363 (50 iterations in 0.040s)
[t-SNE] Iteration 800: error = 1.1008717, gradient norm = 0.0007048 (50 iterations in 0.042s)
[t-SNE] Iteration 850: error = 1.0994658, gradient norm = 0.0001513 (50 iterations in 0.040s)
[t-SNE] Iteration 900: error = 1.0996559, gradient norm = 0.0000758 (50 iterations in 0.040s)
[t-SNE] Iteration 950: error = 1.0996971, gradient norm = 0.0000485 (50 iterations in 0.040s)
[t-SNE] Iteration 1000: error = 1.0993066, gradient norm = 0.0000902 (50 iterations in 0.040s)
[t-SNE] KL divergence after 1000 iterations: 1.099307
[t-SNE] Computed conditional probabilities for sample 366 / 366
[t-SNE] Mean sigma: 0.367323
Beginning preprocessing + Leiden
2024-03-13 20:04:37.843261 MEMORY 17.340841984
Affmat transformed
2024-03-13 20:04:37.848210 MEMORY 17.340841984
sources, targets, weights extracted
2024-03-13 20:04:37.850632 MEMORY 17.340841984
About to launch parallel Leiden runs
2024-03-13 20:04:37.890165 MEMORY 17.340841984
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.1s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    3.3s finished
Parallel Leiden runs finished
2024-03-13 20:04:41.206282 MEMORY 17.340841984
Quality: 0.3681173720023485
Quality: 0.36932286707667394
Quality: 0.3697597641494272
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 350 out of 350 | elapsed:    0.1s finished
Got subclusters: Counter({0: 93, 1: 80, 2: 60, 3: 50, 4: 48, 5: 35})
On pattern 13
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 350 samples in 0.003s...
[t-SNE] Computed neighbors for 350 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 350 / 350
[t-SNE] Mean sigma: 0.389383
[t-SNE] Computed conditional probabilities in 0.024s
[t-SNE] Iteration 50: error = 64.3798676, gradient norm = 0.5086467 (50 iterations in 0.043s)
[t-SNE] Iteration 100: error = 66.3934860, gradient norm = 0.4499316 (50 iterations in 0.041s)
[t-SNE] Iteration 150: error = 65.5625839, gradient norm = 0.4963045 (50 iterations in 0.042s)
[t-SNE] Iteration 200: error = 69.2223434, gradient norm = 0.4744892 (50 iterations in 0.041s)
[t-SNE] Iteration 250: error = 68.3619614, gradient norm = 0.4707732 (50 iterations in 0.041s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 68.361961
[t-SNE] Iteration 300: error = 1.4121621, gradient norm = 0.0038921 (50 iterations in 0.046s)
[t-SNE] Iteration 350: error = 1.2849069, gradient norm = 0.0018866 (50 iterations in 0.044s)
[t-SNE] Iteration 400: error = 1.2142363, gradient norm = 0.0024924 (50 iterations in 0.044s)
[t-SNE] Iteration 450: error = 1.2066406, gradient norm = 0.0002895 (50 iterations in 0.044s)
[t-SNE] Iteration 500: error = 1.1622670, gradient norm = 0.0017223 (50 iterations in 0.047s)
[t-SNE] Iteration 550: error = 1.1416844, gradient norm = 0.0007588 (50 iterations in 0.044s)
[t-SNE] Iteration 600: error = 1.1303999, gradient norm = 0.0013425 (50 iterations in 0.044s)
[t-SNE] Iteration 650: error = 1.1271808, gradient norm = 0.0001753 (50 iterations in 0.044s)
[t-SNE] Iteration 700: error = 1.1273780, gradient norm = 0.0000973 (50 iterations in 0.045s)
[t-SNE] Iteration 750: error = 1.1270798, gradient norm = 0.0002061 (50 iterations in 0.044s)
[t-SNE] Iteration 800: error = 1.1141990, gradient norm = 0.0014157 (50 iterations in 0.043s)
[t-SNE] Iteration 850: error = 1.1062135, gradient norm = 0.0003076 (50 iterations in 0.043s)
[t-SNE] Iteration 900: error = 1.1027807, gradient norm = 0.0001850 (50 iterations in 0.043s)
[t-SNE] Iteration 950: error = 1.1018211, gradient norm = 0.0002750 (50 iterations in 0.044s)
[t-SNE] Iteration 1000: error = 1.1016059, gradient norm = 0.0000778 (50 iterations in 0.043s)
[t-SNE] KL divergence after 1000 iterations: 1.101606
[t-SNE] Computed conditional probabilities for sample 350 / 350
[t-SNE] Mean sigma: 0.389383
Beginning preprocessing + Leiden
2024-03-13 20:04:42.637079 MEMORY 17.340841984
Affmat transformed
2024-03-13 20:04:42.641779 MEMORY 17.340841984
sources, targets, weights extracted
2024-03-13 20:04:42.643957 MEMORY 17.340841984
About to launch parallel Leiden runs
2024-03-13 20:04:42.705676 MEMORY 17.340841984
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.1s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    3.3s finished
Parallel Leiden runs finished
2024-03-13 20:04:45.972252 MEMORY 17.340841984
Quality: 0.3678575309427561
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 317 out of 317 | elapsed:    0.1s finished
Got subclusters: Counter({0: 98, 1: 76, 2: 74, 3: 71, 4: 31})
On pattern 14
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 317 samples in 0.003s...
[t-SNE] Computed neighbors for 317 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 317 / 317
[t-SNE] Mean sigma: 0.380777
[t-SNE] Computed conditional probabilities in 0.022s
[t-SNE] Iteration 50: error = 65.0366135, gradient norm = 0.4970851 (50 iterations in 0.039s)
[t-SNE] Iteration 100: error = 69.7640762, gradient norm = 0.4719545 (50 iterations in 0.039s)
[t-SNE] Iteration 150: error = 67.3920670, gradient norm = 0.4634017 (50 iterations in 0.039s)
[t-SNE] Iteration 200: error = 69.0242386, gradient norm = 0.4537531 (50 iterations in 0.039s)
[t-SNE] Iteration 250: error = 68.7169724, gradient norm = 0.4884882 (50 iterations in 0.039s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 68.716972
[t-SNE] Iteration 300: error = 1.2802367, gradient norm = 0.0052386 (50 iterations in 0.038s)
[t-SNE] Iteration 350: error = 1.1193566, gradient norm = 0.0035404 (50 iterations in 0.037s)
[t-SNE] Iteration 400: error = 1.0710561, gradient norm = 0.0011761 (50 iterations in 0.037s)
[t-SNE] Iteration 450: error = 1.0667992, gradient norm = 0.0008992 (50 iterations in 0.038s)
[t-SNE] Iteration 500: error = 1.0525174, gradient norm = 0.0006264 (50 iterations in 0.037s)
[t-SNE] Iteration 550: error = 1.0421376, gradient norm = 0.0016140 (50 iterations in 0.037s)
[t-SNE] Iteration 600: error = 1.0377699, gradient norm = 0.0003863 (50 iterations in 0.037s)
[t-SNE] Iteration 650: error = 1.0336535, gradient norm = 0.0003635 (50 iterations in 0.037s)
[t-SNE] Iteration 700: error = 1.0319909, gradient norm = 0.0007411 (50 iterations in 0.037s)
[t-SNE] Iteration 750: error = 1.0214895, gradient norm = 0.0009078 (50 iterations in 0.037s)
[t-SNE] Iteration 800: error = 1.0198516, gradient norm = 0.0002735 (50 iterations in 0.038s)
[t-SNE] Iteration 850: error = 1.0192258, gradient norm = 0.0001754 (50 iterations in 0.037s)
[t-SNE] Iteration 900: error = 1.0194780, gradient norm = 0.0001161 (50 iterations in 0.037s)
[t-SNE] Iteration 950: error = 1.0197064, gradient norm = 0.0001473 (50 iterations in 0.038s)
[t-SNE] Iteration 1000: error = 1.0198381, gradient norm = 0.0001328 (50 iterations in 0.037s)
[t-SNE] KL divergence after 1000 iterations: 1.019838
[t-SNE] Computed conditional probabilities for sample 317 / 317
[t-SNE] Mean sigma: 0.380777
Beginning preprocessing + Leiden
2024-03-13 20:04:47.259600 MEMORY 17.340841984
Affmat transformed
2024-03-13 20:04:47.263918 MEMORY 17.340841984
sources, targets, weights extracted
2024-03-13 20:04:47.266003 MEMORY 17.340841984
About to launch parallel Leiden runs
2024-03-13 20:04:47.318989 MEMORY 17.340841984
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.0s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    3.2s finished
Parallel Leiden runs finished
2024-03-13 20:04:50.490964 MEMORY 17.340841984
Quality: 0.3471080263846519
Quality: 0.3481470530156558
Quality: 0.3481840371891044
Quality: 0.3482525435372434
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 312 out of 312 | elapsed:    0.1s finished
Got subclusters: Counter({0: 76, 1: 65, 2: 53, 3: 52, 4: 48, 5: 23})
On pattern 15
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 312 samples in 0.003s...
[t-SNE] Computed neighbors for 312 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 312 / 312
[t-SNE] Mean sigma: 0.410329
[t-SNE] Computed conditional probabilities in 0.021s
[t-SNE] Iteration 50: error = 62.1177025, gradient norm = 0.5107747 (50 iterations in 0.041s)
[t-SNE] Iteration 100: error = 63.7435455, gradient norm = 0.5023472 (50 iterations in 0.039s)
[t-SNE] Iteration 150: error = 65.7987137, gradient norm = 0.4627380 (50 iterations in 0.040s)
[t-SNE] Iteration 200: error = 62.8988495, gradient norm = 0.5236741 (50 iterations in 0.039s)
[t-SNE] Iteration 250: error = 65.0331879, gradient norm = 0.4740098 (50 iterations in 0.042s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 65.033188
[t-SNE] Iteration 300: error = 1.2436312, gradient norm = 0.0050412 (50 iterations in 0.038s)
[t-SNE] Iteration 350: error = 1.1412468, gradient norm = 0.0030810 (50 iterations in 0.038s)
[t-SNE] Iteration 400: error = 1.0691751, gradient norm = 0.0023307 (50 iterations in 0.038s)
[t-SNE] Iteration 450: error = 1.0419139, gradient norm = 0.0015006 (50 iterations in 0.041s)
[t-SNE] Iteration 500: error = 1.0285871, gradient norm = 0.0009453 (50 iterations in 0.037s)
[t-SNE] Iteration 550: error = 1.0237615, gradient norm = 0.0004580 (50 iterations in 0.038s)
[t-SNE] Iteration 600: error = 1.0202008, gradient norm = 0.0006916 (50 iterations in 0.041s)
[t-SNE] Iteration 650: error = 1.0191551, gradient norm = 0.0002761 (50 iterations in 0.039s)
[t-SNE] Iteration 700: error = 1.0192826, gradient norm = 0.0000767 (50 iterations in 0.039s)
[t-SNE] Iteration 750: error = 1.0192766, gradient norm = 0.0001295 (50 iterations in 0.038s)
[t-SNE] Iteration 800: error = 1.0194169, gradient norm = 0.0001044 (50 iterations in 0.043s)
[t-SNE] Iteration 850: error = 1.0155396, gradient norm = 0.0002204 (50 iterations in 0.039s)
[t-SNE] Iteration 900: error = 1.0151453, gradient norm = 0.0001401 (50 iterations in 0.037s)
[t-SNE] Iteration 950: error = 1.0150150, gradient norm = 0.0000908 (50 iterations in 0.040s)
[t-SNE] Iteration 1000: error = 1.0150114, gradient norm = 0.0000785 (50 iterations in 0.036s)
[t-SNE] KL divergence after 1000 iterations: 1.015011
[t-SNE] Computed conditional probabilities for sample 312 / 312
[t-SNE] Mean sigma: 0.410329
Beginning preprocessing + Leiden
2024-03-13 20:04:51.809038 MEMORY 17.340841984
Affmat transformed
2024-03-13 20:04:51.813995 MEMORY 17.340841984
sources, targets, weights extracted
2024-03-13 20:04:51.816152 MEMORY 17.340841984
About to launch parallel Leiden runs
2024-03-13 20:04:51.887585 MEMORY 17.340841984
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.0s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    3.0s finished
Parallel Leiden runs finished
2024-03-13 20:04:54.913344 MEMORY 17.340841984
Quality: 0.3327163625711464
Quality: 0.3335456041243563
Quality: 0.33396079853106775
Quality: 0.3341495160987006
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 302 out of 302 | elapsed:    0.1s finished
Got subclusters: Counter({0: 69, 1: 64, 2: 59, 3: 57, 4: 33, 5: 25, 6: 5})
On pattern 16
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 302 samples in 0.003s...
[t-SNE] Computed neighbors for 302 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 302 / 302
[t-SNE] Mean sigma: 0.375609
[t-SNE] Computed conditional probabilities in 0.021s
[t-SNE] Iteration 50: error = 63.0820274, gradient norm = 0.5357717 (50 iterations in 0.039s)
[t-SNE] Iteration 100: error = 68.0912170, gradient norm = 0.4654595 (50 iterations in 0.038s)
[t-SNE] Iteration 150: error = 67.0866852, gradient norm = 0.4902243 (50 iterations in 0.039s)
[t-SNE] Iteration 200: error = 66.4312363, gradient norm = 0.4717609 (50 iterations in 0.038s)
[t-SNE] Iteration 250: error = 65.8839722, gradient norm = 0.5083289 (50 iterations in 0.038s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 65.883972
[t-SNE] Iteration 300: error = 1.2716413, gradient norm = 0.0054453 (50 iterations in 0.037s)
[t-SNE] Iteration 350: error = 1.1017395, gradient norm = 0.0041469 (50 iterations in 0.036s)
[t-SNE] Iteration 400: error = 1.0382562, gradient norm = 0.0024663 (50 iterations in 0.036s)
[t-SNE] Iteration 450: error = 0.9970357, gradient norm = 0.0014409 (50 iterations in 0.036s)
[t-SNE] Iteration 500: error = 0.9898623, gradient norm = 0.0003111 (50 iterations in 0.036s)
[t-SNE] Iteration 550: error = 0.9888359, gradient norm = 0.0003405 (50 iterations in 0.036s)
[t-SNE] Iteration 600: error = 0.9854084, gradient norm = 0.0002637 (50 iterations in 0.036s)
[t-SNE] Iteration 650: error = 0.9843475, gradient norm = 0.0001245 (50 iterations in 0.036s)
[t-SNE] Iteration 700: error = 0.9843307, gradient norm = 0.0000822 (50 iterations in 0.035s)
[t-SNE] Iteration 750: error = 0.9845792, gradient norm = 0.0000587 (50 iterations in 0.036s)
[t-SNE] Iteration 800: error = 0.9846643, gradient norm = 0.0000980 (50 iterations in 0.035s)
[t-SNE] Iteration 850: error = 0.9847348, gradient norm = 0.0001184 (50 iterations in 0.036s)
[t-SNE] Iteration 900: error = 0.9846255, gradient norm = 0.0001101 (50 iterations in 0.036s)
[t-SNE] Iteration 950: error = 0.9847099, gradient norm = 0.0001027 (50 iterations in 0.036s)
[t-SNE] Iteration 1000: error = 0.9846319, gradient norm = 0.0001155 (50 iterations in 0.036s)
[t-SNE] KL divergence after 1000 iterations: 0.984632
[t-SNE] Computed conditional probabilities for sample 302 / 302
[t-SNE] Mean sigma: 0.375609
Beginning preprocessing + Leiden
2024-03-13 20:04:56.166455 MEMORY 17.340841984
Affmat transformed
2024-03-13 20:04:56.171232 MEMORY 17.340841984
sources, targets, weights extracted
2024-03-13 20:04:56.173344 MEMORY 17.340841984
About to launch parallel Leiden runs
2024-03-13 20:04:56.191459 MEMORY 17.340841984
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.0s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.8s finished
Parallel Leiden runs finished
2024-03-13 20:04:59.044852 MEMORY 17.340841984
Quality: 0.3298138665603986
Quality: 0.32995020330225117
Quality: 0.33058432980007746
Quality: 0.33059604318129304
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 296 out of 296 | elapsed:    0.1s finished
Got subclusters: Counter({0: 53, 1: 51, 2: 49, 3: 48, 5: 45, 4: 45, 6: 6, 7: 5})
On pattern 17
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 296 samples in 0.003s...
[t-SNE] Computed neighbors for 296 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 296 / 296
[t-SNE] Mean sigma: 0.371373
[t-SNE] Computed conditional probabilities in 0.020s
[t-SNE] Iteration 50: error = 66.0670166, gradient norm = 0.5451385 (50 iterations in 0.046s)
[t-SNE] Iteration 100: error = 73.8114624, gradient norm = 0.4184436 (50 iterations in 0.038s)
[t-SNE] Iteration 150: error = 74.4737778, gradient norm = 0.4373349 (50 iterations in 0.038s)
[t-SNE] Iteration 200: error = 74.9360352, gradient norm = 0.4241061 (50 iterations in 0.038s)
[t-SNE] Iteration 250: error = 74.3717804, gradient norm = 0.4377097 (50 iterations in 0.050s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 74.371780
[t-SNE] Iteration 300: error = 1.3154784, gradient norm = 0.0053033 (50 iterations in 0.043s)
[t-SNE] Iteration 350: error = 1.1027519, gradient norm = 0.0043645 (50 iterations in 0.038s)
[t-SNE] Iteration 400: error = 0.9552428, gradient norm = 0.0027456 (50 iterations in 0.037s)
[t-SNE] Iteration 450: error = 0.9149397, gradient norm = 0.0011039 (50 iterations in 0.054s)
[t-SNE] Iteration 500: error = 0.9034862, gradient norm = 0.0006113 (50 iterations in 0.037s)
[t-SNE] Iteration 550: error = 0.8945090, gradient norm = 0.0005634 (50 iterations in 0.036s)
[t-SNE] Iteration 600: error = 0.8908193, gradient norm = 0.0002051 (50 iterations in 0.037s)
[t-SNE] Iteration 650: error = 0.8909243, gradient norm = 0.0001167 (50 iterations in 0.039s)
[t-SNE] Iteration 700: error = 0.8909513, gradient norm = 0.0001725 (50 iterations in 0.038s)
[t-SNE] Iteration 750: error = 0.8906224, gradient norm = 0.0000680 (50 iterations in 0.037s)
[t-SNE] Iteration 800: error = 0.8907824, gradient norm = 0.0000993 (50 iterations in 0.036s)
[t-SNE] Iteration 850: error = 0.8906238, gradient norm = 0.0000906 (50 iterations in 0.036s)
[t-SNE] Iteration 900: error = 0.8906417, gradient norm = 0.0001016 (50 iterations in 0.038s)
[t-SNE] Iteration 950: error = 0.8906798, gradient norm = 0.0000817 (50 iterations in 0.041s)
[t-SNE] Iteration 1000: error = 0.8907218, gradient norm = 0.0001161 (50 iterations in 0.036s)
[t-SNE] KL divergence after 1000 iterations: 0.890722
[t-SNE] Computed conditional probabilities for sample 296 / 296
[t-SNE] Mean sigma: 0.371374
Beginning preprocessing + Leiden
2024-03-13 20:05:00.350179 MEMORY 17.340841984
Affmat transformed
2024-03-13 20:05:00.355465 MEMORY 17.340841984
sources, targets, weights extracted
2024-03-13 20:05:00.357579 MEMORY 17.340841984
About to launch parallel Leiden runs
2024-03-13 20:05:00.363206 MEMORY 17.340841984
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.9s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.9s finished
Parallel Leiden runs finished
2024-03-13 20:05:03.225773 MEMORY 17.340841984
Quality: 0.2852406415375823
Quality: 0.28705109936981127
Quality: 0.28723205120392514
Quality: 0.28733603077184167
Quality: 0.28776914254165875
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 238 out of 285 | elapsed:    0.1s remaining:    0.0s
[Parallel(n_jobs=24)]: Done 285 out of 285 | elapsed:    0.1s finished
Got subclusters: Counter({0: 94, 1: 74, 2: 64, 3: 32, 4: 20, 5: 12})
On pattern 18
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 285 samples in 0.002s...
[t-SNE] Computed neighbors for 285 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 285 / 285
[t-SNE] Mean sigma: 0.397223
[t-SNE] Computed conditional probabilities in 0.019s
[t-SNE] Iteration 50: error = 63.8243866, gradient norm = 0.4977821 (50 iterations in 0.043s)
[t-SNE] Iteration 100: error = 61.7345467, gradient norm = 0.5201234 (50 iterations in 0.041s)
[t-SNE] Iteration 150: error = 62.4686852, gradient norm = 0.5089977 (50 iterations in 0.035s)
[t-SNE] Iteration 200: error = 63.0891418, gradient norm = 0.4916726 (50 iterations in 0.036s)
[t-SNE] Iteration 250: error = 63.3621483, gradient norm = 0.4939127 (50 iterations in 0.036s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 63.362148
[t-SNE] Iteration 300: error = 1.1266141, gradient norm = 0.0034401 (50 iterations in 0.039s)
[t-SNE] Iteration 350: error = 1.0662977, gradient norm = 0.0022767 (50 iterations in 0.035s)
[t-SNE] Iteration 400: error = 1.0341198, gradient norm = 0.0021385 (50 iterations in 0.034s)
[t-SNE] Iteration 450: error = 1.0137429, gradient norm = 0.0007136 (50 iterations in 0.034s)
[t-SNE] Iteration 500: error = 0.9931014, gradient norm = 0.0013985 (50 iterations in 0.066s)
[t-SNE] Iteration 550: error = 0.9767176, gradient norm = 0.0011706 (50 iterations in 0.034s)
[t-SNE] Iteration 600: error = 0.9523984, gradient norm = 0.0007996 (50 iterations in 0.035s)
[t-SNE] Iteration 650: error = 0.9398708, gradient norm = 0.0016779 (50 iterations in 0.034s)
[t-SNE] Iteration 700: error = 0.9341457, gradient norm = 0.0003057 (50 iterations in 0.066s)
[t-SNE] Iteration 750: error = 0.9326712, gradient norm = 0.0001742 (50 iterations in 0.036s)
[t-SNE] Iteration 800: error = 0.9327532, gradient norm = 0.0001740 (50 iterations in 0.083s)
[t-SNE] Iteration 850: error = 0.9325549, gradient norm = 0.0000844 (50 iterations in 0.036s)
[t-SNE] Iteration 900: error = 0.9326165, gradient norm = 0.0000869 (50 iterations in 0.034s)
[t-SNE] Iteration 950: error = 0.9326274, gradient norm = 0.0000959 (50 iterations in 0.034s)
[t-SNE] Iteration 1000: error = 0.9326580, gradient norm = 0.0000606 (50 iterations in 0.035s)
[t-SNE] KL divergence after 1000 iterations: 0.932658
[t-SNE] Computed conditional probabilities for sample 285 / 285
[t-SNE] Mean sigma: 0.397223
Beginning preprocessing + Leiden
2024-03-13 20:05:04.532050 MEMORY 17.340841984
Affmat transformed
2024-03-13 20:05:04.535999 MEMORY 17.340841984
sources, targets, weights extracted
2024-03-13 20:05:04.537715 MEMORY 17.340841984
About to launch parallel Leiden runs
2024-03-13 20:05:04.555299 MEMORY 17.340841984
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.9s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.8s finished
Parallel Leiden runs finished
2024-03-13 20:05:07.335226 MEMORY 17.340841984
Quality: 0.34404260565542644
Quality: 0.3447667390897628
Quality: 0.3447824256569607
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 274 out of 274 | elapsed:    0.1s finished
Got subclusters: Counter({1: 58, 0: 58, 2: 51, 3: 50, 4: 39, 5: 29})
On pattern 19
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 274 samples in 0.002s...
[t-SNE] Computed neighbors for 274 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 274 / 274
[t-SNE] Mean sigma: 0.359704
[t-SNE] Computed conditional probabilities in 0.019s
[t-SNE] Iteration 50: error = 63.2123871, gradient norm = 0.5190575 (50 iterations in 0.039s)
[t-SNE] Iteration 100: error = 62.2565346, gradient norm = 0.4860873 (50 iterations in 0.040s)
[t-SNE] Iteration 150: error = 67.6689072, gradient norm = 0.5029253 (50 iterations in 0.041s)
[t-SNE] Iteration 200: error = 67.2398529, gradient norm = 0.4499534 (50 iterations in 0.042s)
[t-SNE] Iteration 250: error = 67.6060791, gradient norm = 0.4522454 (50 iterations in 0.071s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 67.606079
[t-SNE] Iteration 300: error = 1.3153992, gradient norm = 0.0043928 (50 iterations in 0.039s)
[t-SNE] Iteration 350: error = 1.0897268, gradient norm = 0.0033171 (50 iterations in 0.035s)
[t-SNE] Iteration 400: error = 1.0211147, gradient norm = 0.0014983 (50 iterations in 0.037s)
[t-SNE] Iteration 450: error = 1.0038136, gradient norm = 0.0010202 (50 iterations in 0.037s)
[t-SNE] Iteration 500: error = 0.9904580, gradient norm = 0.0004421 (50 iterations in 0.035s)
[t-SNE] Iteration 550: error = 0.9897120, gradient norm = 0.0001709 (50 iterations in 0.035s)
[t-SNE] Iteration 600: error = 0.9896092, gradient norm = 0.0001167 (50 iterations in 0.035s)
[t-SNE] Iteration 650: error = 0.9898534, gradient norm = 0.0001463 (50 iterations in 0.039s)
[t-SNE] Iteration 700: error = 0.9897372, gradient norm = 0.0001360 (50 iterations in 0.039s)
[t-SNE] Iteration 750: error = 0.9896962, gradient norm = 0.0001628 (50 iterations in 0.035s)
[t-SNE] Iteration 800: error = 0.9895777, gradient norm = 0.0001058 (50 iterations in 0.038s)
[t-SNE] Iteration 850: error = 0.9895240, gradient norm = 0.0001146 (50 iterations in 0.037s)
[t-SNE] Iteration 900: error = 0.9895531, gradient norm = 0.0000731 (50 iterations in 0.035s)
[t-SNE] Iteration 950: error = 0.9895505, gradient norm = 0.0000613 (50 iterations in 0.035s)
[t-SNE] Iteration 1000: error = 0.9895149, gradient norm = 0.0000845 (50 iterations in 0.038s)
[t-SNE] KL divergence after 1000 iterations: 0.989515
[t-SNE] Computed conditional probabilities for sample 274 / 274
[t-SNE] Mean sigma: 0.359704
Beginning preprocessing + Leiden
2024-03-13 20:05:08.588989 MEMORY 17.340841984
Affmat transformed
2024-03-13 20:05:08.592870 MEMORY 17.340841984
sources, targets, weights extracted
2024-03-13 20:05:08.594594 MEMORY 17.340841984
About to launch parallel Leiden runs
2024-03-13 20:05:08.622671 MEMORY 17.340841984
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.9s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.7s finished
Parallel Leiden runs finished
2024-03-13 20:05:11.340196 MEMORY 17.340841984
Quality: 0.28867797028958164
Quality: 0.2889939574370922
Quality: 0.2901476772484501
Quality: 0.29074889366087436
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 261 out of 261 | elapsed:    0.1s finished
Got subclusters: Counter({0: 63, 1: 46, 2: 45, 3: 43, 4: 31, 5: 29, 6: 15, 7: 2})
On pattern 20
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 261 samples in 0.002s...
[t-SNE] Computed neighbors for 261 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 261 / 261
[t-SNE] Mean sigma: 0.413111
[t-SNE] Computed conditional probabilities in 0.017s
[t-SNE] Iteration 50: error = 63.5775452, gradient norm = 0.4829555 (50 iterations in 0.037s)
[t-SNE] Iteration 100: error = 64.9848785, gradient norm = 0.5209463 (50 iterations in 0.035s)
[t-SNE] Iteration 150: error = 66.7826385, gradient norm = 0.4541296 (50 iterations in 0.035s)
[t-SNE] Iteration 200: error = 66.1039658, gradient norm = 0.4780036 (50 iterations in 0.035s)
[t-SNE] Iteration 250: error = 65.3851089, gradient norm = 0.5060825 (50 iterations in 0.036s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 65.385109
[t-SNE] Iteration 300: error = 1.2604613, gradient norm = 0.0061189 (50 iterations in 0.034s)
[t-SNE] Iteration 350: error = 1.0843613, gradient norm = 0.0047323 (50 iterations in 0.034s)
[t-SNE] Iteration 400: error = 1.0407462, gradient norm = 0.0012466 (50 iterations in 0.034s)
[t-SNE] Iteration 450: error = 1.0182490, gradient norm = 0.0013132 (50 iterations in 0.034s)
[t-SNE] Iteration 500: error = 1.0144759, gradient norm = 0.0004394 (50 iterations in 0.034s)
[t-SNE] Iteration 550: error = 1.0138148, gradient norm = 0.0001967 (50 iterations in 0.034s)
[t-SNE] Iteration 600: error = 1.0138792, gradient norm = 0.0001801 (50 iterations in 0.034s)
[t-SNE] Iteration 650: error = 1.0142471, gradient norm = 0.0001634 (50 iterations in 0.034s)
[t-SNE] Iteration 700: error = 1.0141919, gradient norm = 0.0000752 (50 iterations in 0.035s)
[t-SNE] Iteration 750: error = 1.0141754, gradient norm = 0.0000570 (50 iterations in 0.034s)
[t-SNE] Iteration 800: error = 1.0140169, gradient norm = 0.0001031 (50 iterations in 0.034s)
[t-SNE] Iteration 850: error = 1.0141228, gradient norm = 0.0000854 (50 iterations in 0.034s)
[t-SNE] Iteration 900: error = 1.0139296, gradient norm = 0.0000957 (50 iterations in 0.034s)
[t-SNE] Iteration 900: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 900 iterations: 1.013930
[t-SNE] Computed conditional probabilities for sample 261 / 261
[t-SNE] Mean sigma: 0.413111
Beginning preprocessing + Leiden
2024-03-13 20:05:12.389565 MEMORY 17.340841984
Affmat transformed
2024-03-13 20:05:12.393356 MEMORY 17.340841984
sources, targets, weights extracted
2024-03-13 20:05:12.394962 MEMORY 17.340841984
About to launch parallel Leiden runs
2024-03-13 20:05:12.435290 MEMORY 17.340841984
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.9s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.5s finished
Parallel Leiden runs finished
2024-03-13 20:05:14.923611 MEMORY 17.340841984
Quality: 0.351091125580108
Quality: 0.353748171510239
Quality: 0.3542036378624028
Quality: 0.35464378241271904
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 217 out of 217 | elapsed:    0.1s finished
Got subclusters: Counter({0: 73, 1: 51, 2: 48, 3: 47, 4: 42})
On pattern 21
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 217 samples in 0.002s...
[t-SNE] Computed neighbors for 217 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 217 / 217
[t-SNE] Mean sigma: 0.431353
[t-SNE] Computed conditional probabilities in 0.015s
[t-SNE] Iteration 50: error = 58.3537750, gradient norm = 0.5299357 (50 iterations in 0.031s)
[t-SNE] Iteration 100: error = 58.2624168, gradient norm = 0.5142978 (50 iterations in 0.030s)
[t-SNE] Iteration 150: error = 63.4117546, gradient norm = 0.4813440 (50 iterations in 0.030s)
[t-SNE] Iteration 200: error = 61.6441574, gradient norm = 0.5243741 (50 iterations in 0.030s)
[t-SNE] Iteration 250: error = 60.8354263, gradient norm = 0.5282129 (50 iterations in 0.030s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 60.835426
[t-SNE] Iteration 300: error = 1.1012634, gradient norm = 0.0083361 (50 iterations in 0.030s)
[t-SNE] Iteration 350: error = 0.8758603, gradient norm = 0.0048409 (50 iterations in 0.030s)
[t-SNE] Iteration 400: error = 0.8286121, gradient norm = 0.0021477 (50 iterations in 0.030s)
[t-SNE] Iteration 450: error = 0.7813352, gradient norm = 0.0040044 (50 iterations in 0.030s)
[t-SNE] Iteration 500: error = 0.7684561, gradient norm = 0.0007687 (50 iterations in 0.030s)
[t-SNE] Iteration 550: error = 0.7665261, gradient norm = 0.0002651 (50 iterations in 0.030s)
[t-SNE] Iteration 600: error = 0.7665564, gradient norm = 0.0001391 (50 iterations in 0.030s)
[t-SNE] Iteration 650: error = 0.7667415, gradient norm = 0.0001510 (50 iterations in 0.030s)
[t-SNE] Iteration 700: error = 0.7668236, gradient norm = 0.0001292 (50 iterations in 0.030s)
[t-SNE] Iteration 750: error = 0.7666300, gradient norm = 0.0001942 (50 iterations in 0.030s)
[t-SNE] Iteration 800: error = 0.7667453, gradient norm = 0.0001274 (50 iterations in 0.030s)
[t-SNE] Iteration 850: error = 0.7666041, gradient norm = 0.0001816 (50 iterations in 0.030s)
[t-SNE] Iteration 900: error = 0.7667004, gradient norm = 0.0000816 (50 iterations in 0.030s)
[t-SNE] Iteration 900: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 900 iterations: 0.766700
[t-SNE] Computed conditional probabilities for sample 217 / 217
[t-SNE] Mean sigma: 0.431353
Beginning preprocessing + Leiden
2024-03-13 20:05:15.838508 MEMORY 17.340841984
Affmat transformed
2024-03-13 20:05:15.841538 MEMORY 17.340841984
sources, targets, weights extracted
2024-03-13 20:05:15.842729 MEMORY 17.340841984
About to launch parallel Leiden runs
2024-03-13 20:05:15.860976 MEMORY 17.340841984
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.8s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.4s finished
Parallel Leiden runs finished
2024-03-13 20:05:18.292182 MEMORY 17.340841984
Quality: 0.3040735584158923
Quality: 0.3077394433242176
Quality: 0.3077583866745313
Quality: 0.30797258523773136
Quality: 0.308865852129749
Quality: 0.3090357574704334
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 199 out of 199 | elapsed:    0.1s finished
Got subclusters: Counter({0: 68, 1: 48, 2: 43, 3: 36, 4: 22})
On pattern 22
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 199 samples in 0.002s...
[t-SNE] Computed neighbors for 199 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 199 / 199
[t-SNE] Mean sigma: 0.387010
[t-SNE] Computed conditional probabilities in 0.014s
[t-SNE] Iteration 50: error = 59.5704346, gradient norm = 0.5262206 (50 iterations in 0.032s)
[t-SNE] Iteration 100: error = 62.9766083, gradient norm = 0.4570659 (50 iterations in 0.029s)
[t-SNE] Iteration 150: error = 64.5428543, gradient norm = 0.4317047 (50 iterations in 0.029s)
[t-SNE] Iteration 200: error = 60.7979660, gradient norm = 0.4698601 (50 iterations in 0.028s)
[t-SNE] Iteration 250: error = 60.2783699, gradient norm = 0.5080062 (50 iterations in 0.028s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 60.278370
[t-SNE] Iteration 300: error = 0.8670990, gradient norm = 0.0064574 (50 iterations in 0.028s)
[t-SNE] Iteration 350: error = 0.6840923, gradient norm = 0.0052796 (50 iterations in 0.027s)
[t-SNE] Iteration 400: error = 0.6442325, gradient norm = 0.0014821 (50 iterations in 0.027s)
[t-SNE] Iteration 450: error = 0.6412840, gradient norm = 0.0003252 (50 iterations in 0.027s)
[t-SNE] Iteration 500: error = 0.6410708, gradient norm = 0.0001663 (50 iterations in 0.027s)
[t-SNE] Iteration 550: error = 0.6410549, gradient norm = 0.0002080 (50 iterations in 0.027s)
[t-SNE] Iteration 600: error = 0.6411667, gradient norm = 0.0001756 (50 iterations in 0.027s)
[t-SNE] Iteration 650: error = 0.6411149, gradient norm = 0.0001144 (50 iterations in 0.027s)
[t-SNE] Iteration 700: error = 0.6411084, gradient norm = 0.0001135 (50 iterations in 0.027s)
[t-SNE] Iteration 750: error = 0.6411113, gradient norm = 0.0001153 (50 iterations in 0.027s)
[t-SNE] Iteration 800: error = 0.6409973, gradient norm = 0.0001896 (50 iterations in 0.027s)
[t-SNE] Iteration 850: error = 0.6411558, gradient norm = 0.0001563 (50 iterations in 0.027s)
[t-SNE] Iteration 900: error = 0.6411599, gradient norm = 0.0001410 (50 iterations in 0.027s)
[t-SNE] Iteration 950: error = 0.6410841, gradient norm = 0.0001220 (50 iterations in 0.027s)
[t-SNE] Iteration 1000: error = 0.6411288, gradient norm = 0.0001647 (50 iterations in 0.027s)
[t-SNE] KL divergence after 1000 iterations: 0.641129
[t-SNE] Computed conditional probabilities for sample 199 / 199
[t-SNE] Mean sigma: 0.387010
Beginning preprocessing + Leiden
2024-03-13 20:05:19.196866 MEMORY 17.340841984
Affmat transformed
2024-03-13 20:05:19.199741 MEMORY 17.340841984
sources, targets, weights extracted
2024-03-13 20:05:19.200865 MEMORY 17.340841984
About to launch parallel Leiden runs
2024-03-13 20:05:19.244411 MEMORY 17.340841984
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.8s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.2s finished
Parallel Leiden runs finished
2024-03-13 20:05:21.465853 MEMORY 17.340841984
Quality: 0.3225258484228786
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 196 out of 196 | elapsed:    0.1s finished
Got subclusters: Counter({0: 51, 1: 47, 2: 36, 3: 34, 4: 31})
On pattern 23
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 196 samples in 0.002s...
[t-SNE] Computed neighbors for 196 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 196 / 196
[t-SNE] Mean sigma: 0.436824
[t-SNE] Computed conditional probabilities in 0.013s
[t-SNE] Iteration 50: error = 60.7420807, gradient norm = 0.4833360 (50 iterations in 0.028s)
[t-SNE] Iteration 100: error = 59.6526718, gradient norm = 0.5034435 (50 iterations in 0.030s)
[t-SNE] Iteration 150: error = 61.2418098, gradient norm = 0.4791281 (50 iterations in 0.028s)
[t-SNE] Iteration 200: error = 59.1239662, gradient norm = 0.5508927 (50 iterations in 0.028s)
[t-SNE] Iteration 250: error = 63.1373749, gradient norm = 0.4649659 (50 iterations in 0.028s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 63.137375
[t-SNE] Iteration 300: error = 1.0409517, gradient norm = 0.0068729 (50 iterations in 0.028s)
[t-SNE] Iteration 350: error = 0.7592018, gradient norm = 0.0054945 (50 iterations in 0.028s)
[t-SNE] Iteration 400: error = 0.6891642, gradient norm = 0.0014360 (50 iterations in 0.028s)
[t-SNE] Iteration 450: error = 0.6786637, gradient norm = 0.0005621 (50 iterations in 0.028s)
[t-SNE] Iteration 500: error = 0.6792048, gradient norm = 0.0001813 (50 iterations in 0.027s)
[t-SNE] Iteration 550: error = 0.6790892, gradient norm = 0.0001893 (50 iterations in 0.027s)
[t-SNE] Iteration 600: error = 0.6792741, gradient norm = 0.0001554 (50 iterations in 0.027s)
[t-SNE] Iteration 650: error = 0.6792365, gradient norm = 0.0001700 (50 iterations in 0.027s)
[t-SNE] Iteration 700: error = 0.6790916, gradient norm = 0.0001935 (50 iterations in 0.029s)
[t-SNE] Iteration 750: error = 0.6792219, gradient norm = 0.0001533 (50 iterations in 0.027s)
[t-SNE] Iteration 800: error = 0.6792083, gradient norm = 0.0002008 (50 iterations in 0.028s)
[t-SNE] Iteration 800: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 800 iterations: 0.679208
[t-SNE] Computed conditional probabilities for sample 196 / 196
[t-SNE] Mean sigma: 0.436824
Beginning preprocessing + Leiden
2024-03-13 20:05:22.240215 MEMORY 17.340841984
Affmat transformed
2024-03-13 20:05:22.242887 MEMORY 17.340841984
sources, targets, weights extracted
2024-03-13 20:05:22.243936 MEMORY 17.340841984
About to launch parallel Leiden runs
2024-03-13 20:05:22.279220 MEMORY 17.340841984
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.8s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.3s finished
Parallel Leiden runs finished
2024-03-13 20:05:24.570078 MEMORY 17.340841984
Quality: 0.3010582425451089
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 190 out of 190 | elapsed:    0.1s finished
Got subclusters: Counter({0: 49, 1: 43, 2: 40, 3: 29, 4: 19, 5: 8, 6: 8})
On pattern 24
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 190 samples in 0.002s...
[t-SNE] Computed neighbors for 190 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 190 / 190
[t-SNE] Mean sigma: 0.414152
[t-SNE] Computed conditional probabilities in 0.013s
[t-SNE] Iteration 50: error = 58.4003830, gradient norm = 0.5247175 (50 iterations in 0.030s)
[t-SNE] Iteration 100: error = 62.1404648, gradient norm = 0.4530396 (50 iterations in 0.028s)
[t-SNE] Iteration 150: error = 60.1967964, gradient norm = 0.5016212 (50 iterations in 0.029s)
[t-SNE] Iteration 200: error = 62.9507599, gradient norm = 0.4707381 (50 iterations in 0.029s)
[t-SNE] Iteration 250: error = 57.4358292, gradient norm = 0.5977702 (50 iterations in 0.028s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 57.435829
[t-SNE] Iteration 300: error = 1.0305526, gradient norm = 0.0089947 (50 iterations in 0.026s)
[t-SNE] Iteration 350: error = 0.7775987, gradient norm = 0.0070045 (50 iterations in 0.026s)
[t-SNE] Iteration 400: error = 0.7151565, gradient norm = 0.0012771 (50 iterations in 0.026s)
[t-SNE] Iteration 450: error = 0.7118761, gradient norm = 0.0006006 (50 iterations in 0.026s)
[t-SNE] Iteration 500: error = 0.6876276, gradient norm = 0.0010095 (50 iterations in 0.026s)
[t-SNE] Iteration 550: error = 0.6877265, gradient norm = 0.0003835 (50 iterations in 0.026s)
[t-SNE] Iteration 600: error = 0.6877212, gradient norm = 0.0002951 (50 iterations in 0.026s)
[t-SNE] Iteration 650: error = 0.6877546, gradient norm = 0.0002234 (50 iterations in 0.026s)
[t-SNE] Iteration 700: error = 0.6877403, gradient norm = 0.0001998 (50 iterations in 0.026s)
[t-SNE] Iteration 750: error = 0.6877971, gradient norm = 0.0002198 (50 iterations in 0.026s)
[t-SNE] Iteration 800: error = 0.6878411, gradient norm = 0.0002136 (50 iterations in 0.026s)
[t-SNE] Iteration 850: error = 0.6876752, gradient norm = 0.0002584 (50 iterations in 0.026s)
[t-SNE] Iteration 850: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 850 iterations: 0.687675
[t-SNE] Computed conditional probabilities for sample 190 / 190
[t-SNE] Mean sigma: 0.414152
Beginning preprocessing + Leiden
2024-03-13 20:05:25.347340 MEMORY 17.340841984
Affmat transformed
2024-03-13 20:05:25.350086 MEMORY 17.340841984
sources, targets, weights extracted
2024-03-13 20:05:25.351101 MEMORY 17.340841984
About to launch parallel Leiden runs
2024-03-13 20:05:25.381420 MEMORY 17.340841984
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.8s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.2s finished
Parallel Leiden runs finished
2024-03-13 20:05:27.577177 MEMORY 17.340841984
Quality: 0.30843438395665934
Quality: 0.31032238541774837
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 110 out of 110 | elapsed:    0.0s finished
Got subclusters: Counter({0: 44, 1: 40, 2: 34, 3: 29, 4: 23, 5: 20})
On pattern 25
[t-SNE] Computing 109 nearest neighbors...
[t-SNE] Indexed 110 samples in 0.001s...
[t-SNE] Computed neighbors for 110 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 110 / 110
[t-SNE] Mean sigma: 0.513392
[t-SNE] Computed conditional probabilities in 0.005s
[t-SNE] Iteration 50: error = 54.7260857, gradient norm = 0.5522906 (50 iterations in 0.021s)
[t-SNE] Iteration 100: error = 51.4764900, gradient norm = 0.5771545 (50 iterations in 0.020s)
[t-SNE] Iteration 150: error = 52.2441940, gradient norm = 0.5251593 (50 iterations in 0.020s)
[t-SNE] Iteration 200: error = 52.1250305, gradient norm = 0.5154180 (50 iterations in 0.020s)
[t-SNE] Iteration 250: error = 51.8823166, gradient norm = 0.5367078 (50 iterations in 0.020s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 51.882317
[t-SNE] Iteration 300: error = 0.4420121, gradient norm = 0.0174434 (50 iterations in 0.024s)
[t-SNE] Iteration 350: error = 0.3785176, gradient norm = 0.0011976 (50 iterations in 0.020s)
[t-SNE] Iteration 400: error = 0.3785372, gradient norm = 0.0002768 (50 iterations in 0.020s)
[t-SNE] Iteration 450: error = 0.3783602, gradient norm = 0.0002336 (50 iterations in 0.020s)
[t-SNE] Iteration 500: error = 0.3785807, gradient norm = 0.0002679 (50 iterations in 0.020s)
[t-SNE] Iteration 550: error = 0.3785236, gradient norm = 0.0002042 (50 iterations in 0.020s)
[t-SNE] Iteration 600: error = 0.3783310, gradient norm = 0.0002420 (50 iterations in 0.019s)
[t-SNE] Iteration 650: error = 0.3785043, gradient norm = 0.0002580 (50 iterations in 0.019s)
[t-SNE] Iteration 700: error = 0.3783624, gradient norm = 0.0003170 (50 iterations in 0.019s)
[t-SNE] Iteration 750: error = 0.3783822, gradient norm = 0.0002705 (50 iterations in 0.019s)
[t-SNE] Iteration 800: error = 0.3785519, gradient norm = 0.0002023 (50 iterations in 0.020s)
[t-SNE] Iteration 850: error = 0.3785281, gradient norm = 0.0002159 (50 iterations in 0.019s)
[t-SNE] Iteration 900: error = 0.3785245, gradient norm = 0.0001863 (50 iterations in 0.019s)
[t-SNE] Iteration 950: error = 0.3783880, gradient norm = 0.0001151 (50 iterations in 0.020s)
[t-SNE] Iteration 950: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 950 iterations: 0.378388
[t-SNE] Computed conditional probabilities for sample 110 / 110
[t-SNE] Mean sigma: 0.513392
Beginning preprocessing + Leiden
2024-03-13 20:05:28.120390 MEMORY 17.340841984
Affmat transformed
2024-03-13 20:05:28.122052 MEMORY 17.340841984
sources, targets, weights extracted
2024-03-13 20:05:28.122718 MEMORY 17.340841984
About to launch parallel Leiden runs
2024-03-13 20:05:28.147463 MEMORY 17.340841984
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.9s finished
Parallel Leiden runs finished
2024-03-13 20:05:30.048274 MEMORY 17.340841984
Quality: 0.24939690739898346
Quality: 0.25187172671588837
Quality: 0.2524311485223574
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done  26 out of  36 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=24)]: Done  36 out of  36 | elapsed:    0.0s finished
Got subclusters: Counter({0: 37, 1: 34, 2: 22, 3: 17})
On pattern 26
[t-SNE] Computing 35 nearest neighbors...
[t-SNE] Indexed 36 samples in 0.000s...
[t-SNE] Computed neighbors for 36 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 36 / 36
[t-SNE] Mean sigma: 24.996270
[t-SNE] Computed conditional probabilities in 0.001s
[t-SNE] Iteration 50: error = 49.0615921, gradient norm = 0.3237028 (50 iterations in 0.011s)
[t-SNE] Iteration 100: error = 43.1593323, gradient norm = 0.4938604 (50 iterations in 0.013s)
[t-SNE] Iteration 150: error = 47.3001175, gradient norm = 0.5161840 (50 iterations in 0.010s)
[t-SNE] Iteration 200: error = 47.2021561, gradient norm = 0.5165816 (50 iterations in 0.011s)
[t-SNE] Iteration 250: error = 45.3667564, gradient norm = 0.6694419 (50 iterations in 0.010s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 45.366756
[t-SNE] Iteration 300: error = 0.5946141, gradient norm = 0.0007208 (50 iterations in 0.010s)
[t-SNE] Iteration 350: error = 0.5459545, gradient norm = 0.0001556 (50 iterations in 0.010s)
[t-SNE] Iteration 400: error = 0.5431003, gradient norm = 0.0000910 (50 iterations in 0.010s)
[t-SNE] Iteration 450: error = 0.5409186, gradient norm = 0.0000451 (50 iterations in 0.010s)
[t-SNE] Iteration 500: error = 0.5399825, gradient norm = 0.0000263 (50 iterations in 0.010s)
[t-SNE] Iteration 550: error = 0.5398639, gradient norm = 0.0000254 (50 iterations in 0.011s)
[t-SNE] Iteration 600: error = 0.5395638, gradient norm = 0.0000385 (50 iterations in 0.010s)
[t-SNE] Iteration 650: error = 0.5392191, gradient norm = 0.0000337 (50 iterations in 0.010s)
[t-SNE] Iteration 700: error = 0.5390824, gradient norm = 0.0000332 (50 iterations in 0.010s)
[t-SNE] Iteration 750: error = 0.5389445, gradient norm = 0.0000473 (50 iterations in 0.010s)
[t-SNE] Iteration 800: error = 0.5377197, gradient norm = 0.0001523 (50 iterations in 0.010s)
[t-SNE] Iteration 850: error = 0.5299665, gradient norm = 0.0007199 (50 iterations in 0.010s)
[t-SNE] Iteration 900: error = 0.9890837, gradient norm = 0.0013966 (50 iterations in 0.010s)
[t-SNE] Iteration 950: error = 0.7813781, gradient norm = 0.0004578 (50 iterations in 0.010s)
[t-SNE] Iteration 1000: error = 0.6871620, gradient norm = 0.0003179 (50 iterations in 0.010s)
[t-SNE] KL divergence after 1000 iterations: 0.687162
[t-SNE] Computed conditional probabilities for sample 36 / 36
[t-SNE] Mean sigma: 1125899906842624.000000
Beginning preprocessing + Leiden
2024-03-13 20:05:30.306775 MEMORY 17.340841984
Affmat transformed
2024-03-13 20:05:30.307542 MEMORY 17.340841984
sources, targets, weights extracted
2024-03-13 20:05:30.307884 MEMORY 17.340841984
About to launch parallel Leiden runs
2024-03-13 20:05:30.333516 MEMORY 17.340841984
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.6s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.7s finished
Parallel Leiden runs finished
2024-03-13 20:05:32.040437 MEMORY 17.340841984
Quality: 2.2204460492503205e-16
Got subclusters: Counter({0: 36})
On metacluster 0
Metacluster size 178077 limited to 20000
Relevant tasks:  ('head', 'testis')
Relevant signs:  (-1, -1)
TfModiscoSeqletsToPatternsFactory: seed=1234
(Round 1) num seqlets: 20000
(Round 1) Computing coarse affmat
2024-03-13 20:05:39.219403 MEMORY 17.340862464
Beginning embedding computation
MEMORY 17.340862464
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 152 tasks      | elapsed:    1.9s
[Parallel(n_jobs=24)]: Done 402 tasks      | elapsed:    4.6s
[Parallel(n_jobs=24)]: Done 752 tasks      | elapsed:    8.4s
[Parallel(n_jobs=24)]: Done 1202 tasks      | elapsed:   13.2s
[Parallel(n_jobs=24)]: Done 1752 tasks      | elapsed:   19.3s
[Parallel(n_jobs=24)]: Done 2402 tasks      | elapsed:   26.3s
[Parallel(n_jobs=24)]: Done 3152 tasks      | elapsed:   34.5s
[Parallel(n_jobs=24)]: Done 4002 tasks      | elapsed:   43.7s
[Parallel(n_jobs=24)]: Done 4952 tasks      | elapsed:   54.0s
[Parallel(n_jobs=24)]: Done 6002 tasks      | elapsed:  1.1min
[Parallel(n_jobs=24)]: Done 7152 tasks      | elapsed:  1.3min
[Parallel(n_jobs=24)]: Done 8402 tasks      | elapsed:  1.5min
[Parallel(n_jobs=24)]: Done 9752 tasks      | elapsed:  1.8min
[Parallel(n_jobs=24)]: Done 11202 tasks      | elapsed:  2.0min
[Parallel(n_jobs=24)]: Done 12752 tasks      | elapsed:  2.3min
[Parallel(n_jobs=24)]: Done 14402 tasks      | elapsed:  2.6min
[Parallel(n_jobs=24)]: Done 16152 tasks      | elapsed:  2.9min
[Parallel(n_jobs=24)]: Done 18002 tasks      | elapsed:  3.3min
[Parallel(n_jobs=24)]: Done 19952 tasks      | elapsed:  3.6min
[Parallel(n_jobs=24)]: Done 20000 out of 20000 | elapsed:  3.6min finished
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 152 tasks      | elapsed:    1.8s
[Parallel(n_jobs=24)]: Done 402 tasks      | elapsed:    4.6s
[Parallel(n_jobs=24)]: Done 752 tasks      | elapsed:    8.4s
[Parallel(n_jobs=24)]: Done 1202 tasks      | elapsed:   13.4s
[Parallel(n_jobs=24)]: Done 1752 tasks      | elapsed:   19.3s
[Parallel(n_jobs=24)]: Done 2402 tasks      | elapsed:   26.4s
[Parallel(n_jobs=24)]: Done 3152 tasks      | elapsed:   34.5s
[Parallel(n_jobs=24)]: Done 4002 tasks      | elapsed:   43.6s
[Parallel(n_jobs=24)]: Done 4952 tasks      | elapsed:   54.0s
[Parallel(n_jobs=24)]: Done 6002 tasks      | elapsed:  1.1min
[Parallel(n_jobs=24)]: Done 7152 tasks      | elapsed:  1.3min
[Parallel(n_jobs=24)]: Done 8402 tasks      | elapsed:  1.5min
[Parallel(n_jobs=24)]: Done 9752 tasks      | elapsed:  1.8min
[Parallel(n_jobs=24)]: Done 11202 tasks      | elapsed:  2.0min
[Parallel(n_jobs=24)]: Done 12752 tasks      | elapsed:  2.3min
[Parallel(n_jobs=24)]: Done 14402 tasks      | elapsed:  2.6min
[Parallel(n_jobs=24)]: Done 16152 tasks      | elapsed:  2.9min
[Parallel(n_jobs=24)]: Done 18002 tasks      | elapsed:  3.3min
[Parallel(n_jobs=24)]: Done 19952 tasks      | elapsed:  3.6min
[Parallel(n_jobs=24)]: Done 20000 out of 20000 | elapsed:  3.6min finished
At the beginning of embedding call
2024-03-13 20:05:39.222294 MEMORY 17.340862464
before computing embeddings fwd
2024-03-13 20:05:39.231326 MEMORY 17.340862464
after computing embeddings fwd
2024-03-13 20:09:17.272600 MEMORY 17.34060032
after computing embeddings rev
2024-03-13 20:12:55.113264 MEMORY 17.882112
before computing sparse embeddings fwd
2024-03-13 20:12:55.113376 MEMORY 17.882112
Constructing csr matrix...
csr matrix made in 2.5479443073272705 s
after computing sparse embeddings fwd
2024-03-13 20:12:58.406986 MEMORY 17.99981056
before computing sparse embeddings rev
2024-03-13 20:12:58.407105 MEMORY 17.99981056
Constructing csr matrix...
csr matrix made in 2.4889559745788574 s
after computing sparse embeddings rev
2024-03-13 20:13:01.681186 MEMORY 18.120077312
Finished embedding computation in 446.75 s
MEMORY 17.6421888
Starting affinity matrix computations
MEMORY 17.641926656
Batching in slices of size 3355
  0%|          | 0/6 [00:00<?, ?it/s] 17%|â–ˆâ–‹        | 1/6 [00:09<00:45,  9.07s/it] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 2/6 [00:18<00:36,  9.03s/it] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 3/6 [00:27<00:27,  9.00s/it] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 4/6 [00:35<00:17,  8.98s/it] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 5/6 [00:44<00:08,  8.93s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:53<00:00,  8.78s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:53<00:00,  8.88s/it]
Finished affinity matrix computations in 53.5 s
MEMORY 17.586413568
(Round 1) Computed coarse affmat
2024-03-13 20:14:02.990524 MEMORY 17.345880064
(Round 1) Computing affinity matrix on nearest neighbors
2024-03-13 20:14:02.990661 MEMORY 17.345880064
Launching nearest neighbors affmat calculation job
MEMORY 17.632600064
Parallel runs completed
MEMORY 17.717743616
Job completed in: 69.77 s
MEMORY 17.713180672
Launching nearest neighbors affmat calculation job
MEMORY 17.713016832
Parallel runs completed
MEMORY 17.764868096
Job completed in: 69.16 s
MEMORY 17.764589568
(Round 1) Computed affinity matrix on nearest neighbors in 146.21 s
2024-03-13 20:16:29.204001 MEMORY 17.47777536
Filtered down to 17930 of 20000
(Round 1) Retained 17930 rows out of 20000 after filtering
2024-03-13 20:16:39.740226 MEMORY 17.477869568
(Round 1) Computing density adapted affmat
2024-03-13 20:16:46.296065 MEMORY 17.477869568
Symmetrizing nearest neighbors
Computing betas for density adaptation
/ru-auth/local/home/lzhao/anaconda3/envs/jupyter-ml-clone/lib/python3.9/site-packages/joblib/externals/loky/process_executor.py:688: UserWarning: A worker stopped while some jobs were given to the executor. This can be caused by a too short worker timeout or by a memory leak.
  warnings.warn(
Computing normalizing denominators
(Round 1) Computing clustering
2024-03-13 20:19:40.111541 MEMORY 17.592233984
Beginning preprocessing + Leiden
2024-03-13 20:19:40.140352 MEMORY 17.592233984
Affmat transformed
2024-03-13 20:19:40.140506 MEMORY 17.592233984
sources, targets, weights extracted
2024-03-13 20:19:40.864948 MEMORY 17.795411968
About to launch parallel Leiden runs
2024-03-13 20:19:41.025826 MEMORY 17.592233984
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:  2.4min
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:  5.9min finished
Parallel Leiden runs finished
2024-03-13 20:25:35.102010 MEMORY 17.591648256
Quality: 0.42806435255026654
Quality: 0.4280683153025937
Quality: 0.42806904153464953
Got 5 clusters after round 1
Counts:
{1: 5004, 2: 3205, 0: 6433, 4: 1314, 3: 1974}
2024-03-13 20:25:35.163677 MEMORY 17.43917056
(Round 1) Aggregating seqlets in each cluster
2024-03-13 20:25:35.163801 MEMORY 17.43917056
Aggregating for cluster 0 with 6433 seqlets
2024-03-13 20:25:35.170043 MEMORY 17.43917056
Skipped 55 due to duplicates
Trimming eliminated 0 seqlets out of 6378
Aggregating for cluster 1 with 5004 seqlets
2024-03-13 20:25:49.756774 MEMORY 17.439363072
Removed 1 duplicate seqlets
Skipped 28 due to duplicates
Trimming eliminated 0 seqlets out of 4975
Aggregating for cluster 2 with 3205 seqlets
2024-03-13 20:26:01.229711 MEMORY 17.439363072
Skipped 19 due to duplicates
Trimming eliminated 0 seqlets out of 3186
Aggregating for cluster 3 with 1974 seqlets
2024-03-13 20:26:08.347767 MEMORY 17.439363072
Skipped 7 due to duplicates
Trimming eliminated 0 seqlets out of 1967
Aggregating for cluster 4 with 1314 seqlets
2024-03-13 20:26:12.933413 MEMORY 17.439363072
Skipped 2 due to duplicates
Trimming eliminated 0 seqlets out of 1312
(Round 2) num seqlets: 17796
(Round 2) Computing coarse affmat
2024-03-13 20:26:19.464159 MEMORY 17.43945728
Beginning embedding computation
MEMORY 17.43945728
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   3 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 324 tasks      | elapsed:    0.8s
[Parallel(n_jobs=24)]: Done 3472 tasks      | elapsed:    4.0s
[Parallel(n_jobs=24)]: Done 9072 tasks      | elapsed:    9.2s
[Parallel(n_jobs=24)]: Done 16272 tasks      | elapsed:   15.9s
[Parallel(n_jobs=24)]: Done 17796 out of 17796 | elapsed:   17.1s finished
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   3 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 326 tasks      | elapsed:    0.9s
[Parallel(n_jobs=24)]: Done 2264 tasks      | elapsed:    3.1s
[Parallel(n_jobs=24)]: Done 5064 tasks      | elapsed:    6.1s
[Parallel(n_jobs=24)]: Done 8664 tasks      | elapsed:    9.9s
[Parallel(n_jobs=24)]: Done 13064 tasks      | elapsed:   14.6s
[Parallel(n_jobs=24)]: Done 17739 tasks      | elapsed:   19.6s
[Parallel(n_jobs=24)]: Done 17796 out of 17796 | elapsed:   19.6s finished
At the beginning of embedding call
2024-03-13 20:26:19.464360 MEMORY 17.43945728
before computing embeddings fwd
2024-03-13 20:26:19.473034 MEMORY 17.43945728
after computing embeddings fwd
2024-03-13 20:26:36.554764 MEMORY 17.64440064
after computing embeddings rev
2024-03-13 20:26:56.184766 MEMORY 18.356457472
before computing sparse embeddings fwd
2024-03-13 20:26:56.184859 MEMORY 18.356457472
Constructing csr matrix...
csr matrix made in 2.226271867752075 s
after computing sparse embeddings fwd
2024-03-13 20:26:59.132027 MEMORY 18.462732288
before computing sparse embeddings rev
2024-03-13 20:26:59.132939 MEMORY 18.462732288
Constructing csr matrix...
csr matrix made in 2.050553560256958 s
after computing sparse embeddings rev
2024-03-13 20:27:01.891699 MEMORY 18.56954368
Finished embedding computation in 47.7 s
MEMORY 17.88534784
Starting affinity matrix computations
MEMORY 17.885085696
Batching in slices of size 3771
  0%|          | 0/5 [00:00<?, ?it/s] 20%|â–ˆâ–ˆ        | 1/5 [00:10<00:43, 10.96s/it] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [00:21<00:32, 10.96s/it] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [00:33<00:22, 11.19s/it] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [00:44<00:11, 11.09s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [00:51<00:00,  9.77s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [00:51<00:00, 10.35s/it]
Finished affinity matrix computations in 51.88 s
MEMORY 17.829576704
(Round 2) Computed coarse affmat
2024-03-13 20:28:02.747326 MEMORY 17.616068608
(Round 2) Computing affinity matrix on nearest neighbors
2024-03-13 20:28:02.747460 MEMORY 17.616068608
Launching nearest neighbors affmat calculation job
MEMORY 17.743364096
Parallel runs completed
MEMORY 17.770409984
Job completed in: 34.61 s
MEMORY 17.770237952
Launching nearest neighbors affmat calculation job
MEMORY 17.770082304
Parallel runs completed
MEMORY 17.806352384
Job completed in: 33.33 s
MEMORY 17.806204928
(Round 2) Computed affinity matrix on nearest neighbors in 74.95 s
2024-03-13 20:29:17.698936 MEMORY 17.674330112
Not applying filtering for rounds above first round
2024-03-13 20:29:17.701976 MEMORY 17.674330112
(Round 2) Computing density adapted affmat
2024-03-13 20:29:24.355169 MEMORY 17.775910912
Symmetrizing nearest neighbors
Computing betas for density adaptation
Computing normalizing denominators
(Round 2) Computing clustering
2024-03-13 20:31:55.849478 MEMORY 18.072326144
Beginning preprocessing + Leiden
2024-03-13 20:31:55.875220 MEMORY 18.072326144
Affmat transformed
2024-03-13 20:31:55.875360 MEMORY 18.072326144
sources, targets, weights extracted
2024-03-13 20:31:56.574353 MEMORY 18.278146048
About to launch parallel Leiden runs
2024-03-13 20:31:56.765317 MEMORY 18.072326144
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:  1.6min
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:  4.4min finished
Parallel Leiden runs finished
2024-03-13 20:36:22.908510 MEMORY 18.072322048
Quality: 0.5389595897953257
Quality: 0.5477246771231957
Quality: 0.5477257938196278
Quality: 0.5477259182229592
Quality: 0.5477259308228734
Got 6 clusters after round 2
Counts:
{1: 4141, 2: 3106, 3: 2914, 4: 1965, 5: 1146, 0: 4524}
2024-03-13 20:36:22.955513 MEMORY 17.917775872
(Round 2) Aggregating seqlets in each cluster
2024-03-13 20:36:22.955620 MEMORY 17.917775872
Aggregating for cluster 0 with 4524 seqlets
2024-03-13 20:36:22.961341 MEMORY 17.917775872
Skipped 19 due to duplicates
Trimming eliminated 0 seqlets out of 4505
Aggregating for cluster 1 with 4141 seqlets
2024-03-13 20:36:30.539415 MEMORY 17.917775872
Skipped 12 due to duplicates
Trimming eliminated 0 seqlets out of 4129
Aggregating for cluster 2 with 3106 seqlets
2024-03-13 20:36:37.352353 MEMORY 17.917775872
Skipped 2 due to duplicates
Trimming eliminated 0 seqlets out of 3104
Aggregating for cluster 3 with 2914 seqlets
2024-03-13 20:36:42.434287 MEMORY 17.917775872
Skipped 5 due to duplicates
Trimming eliminated 0 seqlets out of 2909
Aggregating for cluster 4 with 1965 seqlets
2024-03-13 20:36:47.590704 MEMORY 17.917775872
Skipped 1 due to duplicates
Trimming eliminated 0 seqlets out of 1964
Aggregating for cluster 5 with 1146 seqlets
2024-03-13 20:36:50.836533 MEMORY 17.917775872
Skipped 2 due to duplicates
Trimming eliminated 0 seqlets out of 1144
Got 6 clusters
Splitting into subclusters...
2024-03-13 20:36:52.683714 MEMORY 17.917775872
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   7 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 440 tasks      | elapsed:    0.4s
[Parallel(n_jobs=24)]: Done 3845 tasks      | elapsed:    2.6s
[Parallel(n_jobs=24)]: Done 4505 out of 4505 | elapsed:    2.9s finished
Inspecting pattern 0 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 4505
[t-SNE] Computed conditional probabilities for sample 2000 / 4505
[t-SNE] Computed conditional probabilities for sample 3000 / 4505
[t-SNE] Computed conditional probabilities for sample 4000 / 4505
[t-SNE] Computed conditional probabilities for sample 4505 / 4505
[t-SNE] Mean sigma: 0.302030
Beginning preprocessing + Leiden
2024-03-13 20:37:00.275162 MEMORY 17.964433408
Affmat transformed
2024-03-13 20:37:00.327060 MEMORY 17.973714944
sources, targets, weights extracted
2024-03-13 20:37:00.362526 MEMORY 17.973813248
About to launch parallel Leiden runs
2024-03-13 20:37:00.439608 MEMORY 17.973813248
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:   20.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   46.3s finished
Parallel Leiden runs finished
2024-03-13 20:37:46.757026 MEMORY 17.973813248
Quality: 0.5164898872647038
Quality: 0.5178096337187295
Quality: 0.5216604401113583
Quality: 0.5226070354407536
Quality: 0.5226438729684589
Got subclusters: Counter({0: 961, 1: 723, 2: 672, 3: 542, 4: 509, 5: 455, 6: 405, 7: 238})
On merging iteration 1
Numbers for each pattern pre-subsample: [961, 723, 672, 542, 509, 455, 405, 238]
Numbers after subsampling: [300, 300, 300, 300, 300, 300, 300, 238]
Computing sims for pattern 0
Computed sims for pattern 0 in 3.0634984970092773 s
Computing sims for pattern 1
Computed sims for pattern 1 in 3.0915260314941406 s
Computing sims for pattern 2
Computed sims for pattern 2 in 9.333200454711914 s
Computing sims for pattern 3
Computed sims for pattern 3 in 3.1418285369873047 s
Computing sims for pattern 4
Computed sims for pattern 4 in 3.0853514671325684 s
Computing sims for pattern 5
Computed sims for pattern 5 in 3.0757195949554443 s
Computing sims for pattern 6
Computed sims for pattern 6 in 3.0472121238708496 s
Computing sims for pattern 7
Computed sims for pattern 7 in 2.7847023010253906 s
Cluster sizes
[961 723 672 542 509 455 405 238]
Cross-contamination matrix:
[[1.   0.7  0.66 0.75 0.59 0.7  0.52 0.64]
 [0.53 1.   0.63 0.55 0.62 0.53 0.48 0.41]
 [0.6  0.74 1.   0.81 0.78 0.71 0.49 0.54]
 [0.64 0.62 0.76 1.   0.76 0.75 0.62 0.54]
 [0.49 0.68 0.72 0.76 1.   0.39 0.61 0.49]
 [0.61 0.62 0.69 0.78 0.4  1.   0.48 0.65]
 [0.58 0.72 0.6  0.79 0.79 0.62 1.   0.51]
 [0.54 0.48 0.5  0.55 0.49 0.63 0.38 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.79 0.91 0.9  0.74 0.91 0.84 0.8 ]
 [0.79 1.   0.83 0.71 0.77 0.75 0.77 0.63]
 [0.91 0.83 1.   0.88 0.84 0.89 0.75 0.75]
 [0.9  0.71 0.88 1.   0.84 0.88 0.82 0.76]
 [0.74 0.77 0.84 0.84 1.   0.69 0.86 0.66]
 [0.91 0.75 0.89 0.88 0.69 1.   0.71 0.78]
 [0.84 0.77 0.75 0.82 0.86 0.71 1.   0.62]
 [0.8  0.63 0.75 0.76 0.66 0.78 0.62 1.  ]]
Collapsing 0 & 2 with crosscontam 0.6003749511111112 and sim 0.9149604097110795
Collapsing 0 & 5 with crosscontam 0.6110765950617283 and sim 0.9093573811862032
Collapsing 0 & 3 with crosscontam 0.6398726281481484 and sim 0.8983957323912065
Collapsing 2 & 5 with crosscontam 0.6892061501234568 and sim 0.8877410084409189
Collapsing 3 & 5 with crosscontam 0.7478587392592593 and sim 0.8840163069829073
Collapsing 2 & 3 with crosscontam 0.7561589876543211 and sim 0.8811870831432664
Collapsing 4 & 6 with crosscontam 0.6144655758024693 and sim 0.8618361508711475
Trimming eliminated 0 seqlets out of 1633
Trimming eliminated 0 seqlets out of 2088
Skipped 1 due to duplicates
Trimming eliminated 0 seqlets out of 2629
Trimming eliminated 0 seqlets out of 914
Unmerged patterns remapping: OrderedDict([(1, 2), (7, 3)])
Time spent on merging iteration: 13.356855154037476
On merging iteration 2
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.4s
[Parallel(n_jobs=24)]: Done 3495 tasks      | elapsed:    2.1s
[Parallel(n_jobs=24)]: Done 4129 out of 4129 | elapsed:    2.3s finished
Numbers for each pattern pre-subsample: [2629, 914, 723, 238]
Numbers after subsampling: [300, 300, 300, 238]
Computing sims for pattern 0
Computed sims for pattern 0 in 1.2742350101470947 s
Computing sims for pattern 1
Computed sims for pattern 1 in 1.3267312049865723 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.8858985900878906 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.838874101638794 s
Cluster sizes
[2629  914  723  238]
Cross-contamination matrix:
[[1.   0.74 0.87 0.77]
 [0.73 1.   0.85 0.6 ]
 [0.57 0.58 1.   0.41]
 [0.55 0.41 0.48 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.8  0.8  0.8 ]
 [0.8  1.   0.8  0.64]
 [0.8  0.8  1.   0.63]
 [0.8  0.64 0.63 1.  ]]
Inspecting pattern 1 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 4129
[t-SNE] Computed conditional probabilities for sample 2000 / 4129
[t-SNE] Computed conditional probabilities for sample 3000 / 4129
[t-SNE] Computed conditional probabilities for sample 4000 / 4129
[t-SNE] Computed conditional probabilities for sample 4129 / 4129
[t-SNE] Mean sigma: 0.271021
Beginning preprocessing + Leiden
2024-03-13 20:38:40.031660 MEMORY 17.957056512
Affmat transformed
2024-03-13 20:38:40.079996 MEMORY 17.96671488
sources, targets, weights extracted
2024-03-13 20:38:40.116152 MEMORY 17.96671488
About to launch parallel Leiden runs
2024-03-13 20:38:40.169298 MEMORY 17.966792704
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:   20.0s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   49.3s finished
Parallel Leiden runs finished
2024-03-13 20:39:29.474122 MEMORY 17.966792704
Quality: 0.5108270924001354
Quality: 0.5139600375338184
Quality: 0.5143090677296491
Got subclusters: Counter({0: 1024, 1: 778, 2: 697, 3: 663, 4: 477, 5: 228, 6: 169, 7: 93})
On merging iteration 1
Numbers for each pattern pre-subsample: [1024, 778, 697, 663, 477, 228, 169, 93]
Numbers after subsampling: [300, 300, 300, 300, 300, 228, 169, 93]
Computing sims for pattern 0
Computed sims for pattern 0 in 2.83923602104187 s
Computing sims for pattern 1
Computed sims for pattern 1 in 2.923126697540283 s
Computing sims for pattern 2
Computed sims for pattern 2 in 2.9803342819213867 s
Computing sims for pattern 3
Computed sims for pattern 3 in 2.956329822540283 s
Computing sims for pattern 4
Computed sims for pattern 4 in 3.055333137512207 s
Computing sims for pattern 5
Computed sims for pattern 5 in 2.784484386444092 s
Computing sims for pattern 6
Computed sims for pattern 6 in 2.0218069553375244 s
Computing sims for pattern 7
Computed sims for pattern 7 in 1.4218158721923828 s
Cluster sizes
[1024  778  697  663  477  228  169   93]
Cross-contamination matrix:
[[1.   0.41 0.81 0.41 0.46 0.42 0.56 0.43]
 [0.76 1.   0.8  0.74 0.73 0.7  0.59 0.64]
 [0.66 0.29 1.   0.59 0.49 0.27 0.43 0.45]
 [0.65 0.62 1.   1.   0.71 0.62 0.51 0.7 ]
 [0.68 0.6  0.89 0.7  1.   0.54 0.65 0.69]
 [0.79 0.69 0.78 0.75 0.67 1.   0.48 0.66]
 [0.76 0.42 0.79 0.45 0.59 0.34 1.   0.42]
 [0.45 0.33 0.63 0.49 0.49 0.35 0.29 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.81 0.91 0.77 0.76 0.8  0.87 0.74]
 [0.81 1.   0.84 0.86 0.83 0.89 0.67 0.77]
 [0.91 0.84 1.   0.93 0.86 0.8  0.88 0.81]
 [0.77 0.86 0.93 1.   0.87 0.87 0.74 0.8 ]
 [0.76 0.83 0.86 0.87 1.   0.79 0.78 0.78]
 [0.8  0.89 0.8  0.87 0.79 1.   0.65 0.75]
 [0.87 0.67 0.88 0.74 0.78 0.65 1.   0.72]
 [0.74 0.77 0.81 0.8  0.78 0.75 0.72 1.  ]]
Collapsing 2 & 3 with crosscontam 0.5903089506172841 and sim 0.9300107217625169
Collapsing 0 & 2 with crosscontam 0.6555319175308643 and sim 0.9086343980230133
Collapsing 1 & 5 with crosscontam 0.6936292813443272 and sim 0.8913454586003582
Collapsing 3 & 4 with crosscontam 0.698524387654321 and sim 0.8680857953448099
Collapsing 0 & 6 with crosscontam 0.5615045163269778 and sim 0.8663379667938541
Collapsing 3 & 5 with crosscontam 0.6236271851851851 and sim 0.8660444468540707
Collapsing 1 & 3 with crosscontam 0.6219861916049383 and sim 0.860937983548469
Removed 1 duplicate seqlets
Trimming eliminated 0 seqlets out of 1359
Trimming eliminated 0 seqlets out of 2383
Removed 1 duplicate seqlets
Trimming eliminated 0 seqlets out of 1006
Trimming eliminated 0 seqlets out of 2859
Trimming eliminated 0 seqlets out of 3028
Skipped 1 due to duplicates
Trimming eliminated 0 seqlets out of 4033
Unmerged patterns remapping: OrderedDict([(7, 1)])
Time spent on merging iteration: 28.674757719039917
On merging iteration 2
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   5 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 424 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 3104 out of 3104 | elapsed:    1.3s finished
Numbers for each pattern pre-subsample: [4033, 93]
Numbers after subsampling: [300, 93]
Computing sims for pattern 0
Computed sims for pattern 0 in 0.37699031829833984 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.20110821723937988 s
Cluster sizes
[4033   93]
Cross-contamination matrix:
[[1.   0.84]
 [0.45 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.82]
 [0.82 1.  ]]
Inspecting pattern 2 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 3104
[t-SNE] Computed conditional probabilities for sample 2000 / 3104
[t-SNE] Computed conditional probabilities for sample 3000 / 3104
[t-SNE] Computed conditional probabilities for sample 3104 / 3104
[t-SNE] Mean sigma: 0.281354
Beginning preprocessing + Leiden
2024-03-13 20:40:24.361975 MEMORY 17.938673664
Affmat transformed
2024-03-13 20:40:24.399113 MEMORY 17.950547968
sources, targets, weights extracted
2024-03-13 20:40:24.425999 MEMORY 17.950728192
About to launch parallel Leiden runs
2024-03-13 20:40:24.510432 MEMORY 17.950728192
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:   12.9s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   29.0s finished
Parallel Leiden runs finished
2024-03-13 20:40:53.564838 MEMORY 17.950728192
Quality: 0.48586280346850585
Quality: 0.48905603399531156
Got subclusters: Counter({0: 602, 1: 557, 2: 450, 3: 433, 4: 285, 5: 280, 6: 256, 7: 241})
On merging iteration 1
Numbers for each pattern pre-subsample: [602, 557, 450, 433, 285, 280, 256, 241]
Numbers after subsampling: [300, 300, 300, 300, 285, 280, 256, 241]
Computing sims for pattern 0
Computed sims for pattern 0 in 2.91928768157959 s
Computing sims for pattern 1
Computed sims for pattern 1 in 3.007497787475586 s
Computing sims for pattern 2
Computed sims for pattern 2 in 2.989224910736084 s
Computing sims for pattern 3
Computed sims for pattern 3 in 2.9291985034942627 s
Computing sims for pattern 4
Computed sims for pattern 4 in 2.7915894985198975 s
Computing sims for pattern 5
Computed sims for pattern 5 in 2.7028636932373047 s
Computing sims for pattern 6
Computed sims for pattern 6 in 2.329388380050659 s
Computing sims for pattern 7
Computed sims for pattern 7 in 2.1777782440185547 s
Cluster sizes
[602 557 450 433 285 280 256 241]
Cross-contamination matrix:
[[1.   0.8  0.77 0.66 0.66 0.73 0.59 0.73]
 [0.55 1.   0.65 0.57 0.58 0.66 0.38 0.52]
 [0.68 0.81 1.   0.72 0.61 0.72 0.55 0.8 ]
 [0.53 0.69 0.67 1.   0.51 0.61 0.43 0.61]
 [0.84 1.   0.87 0.82 1.   0.86 0.73 0.78]
 [0.68 0.86 0.76 0.7  0.64 1.   0.57 0.69]
 [0.79 0.8  0.82 0.76 0.76 0.81 1.   0.74]
 [0.65 0.68 0.8  0.66 0.54 0.65 0.48 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.89 0.91 0.83 0.9  0.86 0.86 0.83]
 [0.89 1.   0.92 0.91 0.92 0.92 0.85 0.86]
 [0.91 0.92 1.   0.89 0.93 0.89 0.87 0.9 ]
 [0.83 0.91 0.89 1.   0.89 0.86 0.8  0.83]
 [0.9  0.92 0.93 0.89 1.   0.89 0.88 0.86]
 [0.86 0.92 0.89 0.86 0.89 1.   0.84 0.83]
 [0.86 0.85 0.87 0.8  0.88 0.84 1.   0.8 ]
 [0.83 0.86 0.9  0.83 0.86 0.83 0.8  1.  ]]
Collapsing 2 & 4 with crosscontam 0.6144912374269007 and sim 0.9333395656039127
Collapsing 1 & 4 with crosscontam 0.5823628688758935 and sim 0.9236527143822796
Collapsing 1 & 2 with crosscontam 0.6485888464197531 and sim 0.9198574422071529
Collapsing 1 & 5 with crosscontam 0.6592581677248677 and sim 0.9183180099300314
Collapsing 1 & 3 with crosscontam 0.5745955046913578 and sim 0.9093031560884738
Collapsing 0 & 2 with crosscontam 0.6847807896296296 and sim 0.905029741772639
Collapsing 0 & 4 with crosscontam 0.6607627113710202 and sim 0.9033292168114999
Collapsing 2 & 7 with crosscontam 0.8000110410327339 and sim 0.8970978114645909
Collapsing 4 & 5 with crosscontam 0.6378471574344022 and sim 0.8936097214509481
Collapsing 3 & 4 with crosscontam 0.5127215064327486 and sim 0.8935286482318558
Collapsing 2 & 5 with crosscontam 0.7169057396825396 and sim 0.8921790057102315
Collapsing 0 & 1 with crosscontam 0.5549575323456788 and sim 0.8877555993916801
Collapsing 2 & 3 with crosscontam 0.6690198528395062 and sim 0.8871313142866104
Collapsing 4 & 6 with crosscontam 0.7291623117504442 and sim 0.8761256436712905
Collapsing 2 & 6 with crosscontam 0.5515802268518519 and sim 0.8695839262238174
Collapsing 4 & 7 with crosscontam 0.5403524890072107 and sim 0.8634739310132699
Collapsing 3 & 5 with crosscontam 0.6139750645502646 and sim 0.8622445965533128
Collapsing 0 & 5 with crosscontam 0.6847679342808553 and sim 0.860690493168678
Collapsing 0 & 6 with crosscontam 0.5858013113425926 and sim 0.8592339203408621
Collapsing 1 & 7 with crosscontam 0.5188385056093439 and sim 0.8568879716717818
Trimming eliminated 0 seqlets out of 735
Trimming eliminated 0 seqlets out of 1292
Trimming eliminated 0 seqlets out of 1572
Trimming eliminated 0 seqlets out of 2005
Trimming eliminated 0 seqlets out of 2607
Trimming eliminated 0 seqlets out of 2848
Removed 1 duplicate seqlets
Trimming eliminated 0 seqlets out of 3103
Unmerged patterns remapping: OrderedDict()
Time spent on merging iteration: 25.79071617126465
On merging iteration 2
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 2472 tasks      | elapsed:    1.0s
[Parallel(n_jobs=24)]: Done 2862 out of 2909 | elapsed:    1.1s remaining:    0.0s
[Parallel(n_jobs=24)]: Done 2909 out of 2909 | elapsed:    1.1s finished
Numbers for each pattern pre-subsample: [3103]
Numbers after subsampling: [300]
Computing sims for pattern 0
Computed sims for pattern 0 in 5.4836273193359375e-06 s
Cluster sizes
[3103]
Cross-contamination matrix:
[[1.]]
Pattern-to-pattern sim matrix:
[[1.]]
Inspecting pattern 3 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 2909
[t-SNE] Computed conditional probabilities for sample 2000 / 2909
[t-SNE] Computed conditional probabilities for sample 2909 / 2909
[t-SNE] Mean sigma: 0.279616
Beginning preprocessing + Leiden
2024-03-13 20:41:43.958398 MEMORY 17.93275904
Affmat transformed
2024-03-13 20:41:43.993539 MEMORY 17.943834624
sources, targets, weights extracted
2024-03-13 20:41:44.018810 MEMORY 17.944088576
About to launch parallel Leiden runs
2024-03-13 20:41:44.065050 MEMORY 17.944088576
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:   10.9s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   28.1s finished
Parallel Leiden runs finished
2024-03-13 20:42:12.178968 MEMORY 17.944088576
Quality: 0.5106537749372214
Quality: 0.5109131101055926
Quality: 0.5111996736516565
Quality: 0.5118194672451071
Quality: 0.5120394284457853
Got subclusters: Counter({0: 460, 1: 400, 2: 370, 3: 363, 4: 235, 5: 227, 6: 225, 7: 197, 8: 196, 9: 124, 10: 112})
On merging iteration 1
Numbers for each pattern pre-subsample: [460, 400, 370, 363, 235, 227, 225, 197, 196, 124, 112]
Numbers after subsampling: [300, 300, 300, 300, 235, 227, 225, 197, 196, 124, 112]
Computing sims for pattern 0
Computed sims for pattern 0 in 3.805331230163574 s
Computing sims for pattern 1
Computed sims for pattern 1 in 3.847888469696045 s
Computing sims for pattern 2
Computed sims for pattern 2 in 3.925553321838379 s
Computing sims for pattern 3
Computed sims for pattern 3 in 3.86411190032959 s
Computing sims for pattern 4
Computed sims for pattern 4 in 3.55987286567688 s
Computing sims for pattern 5
Computed sims for pattern 5 in 3.4132323265075684 s
Computing sims for pattern 6
Computed sims for pattern 6 in 3.351201295852661 s
Computing sims for pattern 7
Computed sims for pattern 7 in 2.8872621059417725 s
Computing sims for pattern 8
Computed sims for pattern 8 in 2.9774467945098877 s
Computing sims for pattern 9
Computed sims for pattern 9 in 2.0113155841827393 s
Computing sims for pattern 10
Computed sims for pattern 10 in 1.8161859512329102 s
Cluster sizes
[460 400 370 363 235 227 225 197 196 124 112]
Cross-contamination matrix:
[[1.   0.71 0.81 0.68 0.73 0.55 0.44 0.47 0.65 0.76 0.31]
 [0.72 1.   0.62 0.53 0.66 0.71 0.34 0.54 0.52 0.57 0.46]
 [0.74 0.55 1.   0.62 0.74 0.56 0.39 0.52 0.59 0.67 0.09]
 [0.77 0.61 0.78 1.   0.77 0.64 0.57 0.55 0.68 0.65 0.29]
 [0.7  0.62 0.77 0.65 1.   0.6  0.38 0.47 0.59 0.66 0.27]
 [0.65 0.81 0.72 0.66 0.74 1.   0.48 0.55 0.66 0.62 0.44]
 [0.63 0.53 0.63 0.7  0.59 0.58 1.   0.48 0.6  0.69 0.72]
 [0.73 0.8  0.85 0.73 0.76 0.7  0.53 1.   0.7  0.65 0.23]
 [0.73 0.6  0.74 0.67 0.7  0.63 0.47 0.52 1.   0.66 0.25]
 [0.78 0.59 0.75 0.58 0.71 0.55 0.51 0.43 0.6  1.   0.31]
 [0.5  0.69 0.21 0.38 0.46 0.55 0.73 0.21 0.36 0.46 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.92 0.94 0.9  0.94 0.87 0.86 0.83 0.89 0.93 0.68]
 [0.92 1.   0.84 0.8  0.85 0.88 0.78 0.81 0.84 0.84 0.79]
 [0.94 0.84 1.   0.94 0.93 0.88 0.88 0.84 0.86 0.91 0.6 ]
 [0.9  0.8  0.94 1.   0.91 0.87 0.84 0.88 0.86 0.89 0.58]
 [0.94 0.85 0.93 0.91 1.   0.87 0.83 0.79 0.86 0.9  0.64]
 [0.87 0.88 0.88 0.87 0.87 1.   0.82 0.78 0.86 0.83 0.73]
 [0.86 0.78 0.88 0.84 0.83 0.82 1.   0.86 0.83 0.83 0.84]
 [0.83 0.81 0.84 0.88 0.79 0.78 0.86 1.   0.83 0.79 0.61]
 [0.89 0.84 0.86 0.86 0.86 0.86 0.83 0.83 1.   0.85 0.59]
 [0.93 0.84 0.91 0.89 0.9  0.83 0.83 0.79 0.85 1.   0.64]
 [0.68 0.79 0.6  0.58 0.64 0.73 0.84 0.61 0.59 0.64 1.  ]]
Collapsing 0 & 4 with crosscontam 0.6967758743245716 and sim 0.9368097673457204
Collapsing 0 & 2 with crosscontam 0.7409550192592591 and sim 0.9362704912925569
Collapsing 2 & 3 with crosscontam 0.6236183930864196 and sim 0.936269632385327
Collapsing 0 & 9 with crosscontam 0.7579410477897253 and sim 0.9327994369845046
Collapsing 2 & 4 with crosscontam 0.7400970282111898 and sim 0.9318786481672335
Collapsing 0 & 1 with crosscontam 0.705747781728395 and sim 0.9211886145354637
Collapsing 2 & 9 with crosscontam 0.6655402520908007 and sim 0.9085061125708805
Collapsing 3 & 4 with crosscontam 0.6475485650257329 and sim 0.9052527209794176
Collapsing 0 & 3 with crosscontam 0.6808754197530866 and sim 0.9025810422233173
Collapsing 4 & 9 with crosscontam 0.6552310685089666 and sim 0.9006786944891245
Collapsing 0 & 8 with crosscontam 0.6478863741496599 and sim 0.8861975885448827
Collapsing 3 & 9 with crosscontam 0.5829204989202557 and sim 0.8859888528177073
Collapsing 3 & 7 with crosscontam 0.5484377409287462 and sim 0.8815319739041015
Collapsing 1 & 5 with crosscontam 0.7083494247022353 and sim 0.8778917275574134
Collapsing 2 & 5 with crosscontam 0.5564919425681187 and sim 0.876972090947392
Collapsing 0 & 5 with crosscontam 0.5484999719366943 and sim 0.86819285675962
Collapsing 3 & 5 with crosscontam 0.6391062666014031 and sim 0.8670575628629177
Collapsing 4 & 5 with crosscontam 0.6000374357900968 and sim 0.8665084608539386
Collapsing 5 & 8 with crosscontam 0.6264055051681956 and sim 0.864121091384602
Collapsing 2 & 8 with crosscontam 0.5908244897959185 and sim 0.8633784405686394
Collapsing 4 & 8 with crosscontam 0.5883739055893202 and sim 0.8611554100717522
Collapsing 3 & 8 with crosscontam 0.6679875944546914 and sim 0.8594910046441828
Collapsing 1 & 4 with crosscontam 0.6164042623824524 and sim 0.851421515015496
Trimming eliminated 0 seqlets out of 695
Trimming eliminated 0 seqlets out of 1065
Trimming eliminated 0 seqlets out of 1428
Trimming eliminated 0 seqlets out of 1552
Trimming eliminated 0 seqlets out of 1952
Skipped 1 due to duplicates
Trimming eliminated 0 seqlets out of 2147
Skipped 1 due to duplicates
Trimming eliminated 0 seqlets out of 2343
Trimming eliminated 0 seqlets out of 2570
Unmerged patterns remapping: OrderedDict([(6, 1), (10, 2)])
Time spent on merging iteration: 21.473581314086914
On merging iteration 2
Numbers for each pattern pre-subsample: [2570, 225, 112]
Numbers after subsampling: [300, 225, 112]
Computing sims for pattern 0
Computed sims for pattern 0 in 0.7520034313201904 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.3747437000274658 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.19313883781433105 s
Cluster sizes
[2570  225  112]
Cross-contamination matrix:
[[1.   0.72 0.59]
 [0.6  1.   0.72]
 [0.49 0.73 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.89 0.68]
 [0.89 1.   0.84]
 [0.68 0.84 1.  ]]
Collapsing 0 & 1 with crosscontam 0.5951378998079562 and sim 0.8864769249875875
Trimming eliminated 0 seqlets out of 2795
Unmerged patterns remapping: OrderedDict([(2, 1)])
Time spent on merging iteration: 3.6006951332092285
On merging iteration 3
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   7 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 440 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 1655 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done 1964 out of 1964 | elapsed:    0.9s finished
Numbers for each pattern pre-subsample: [2795, 112]
Numbers after subsampling: [300, 112]
Computing sims for pattern 0
Computed sims for pattern 0 in 0.3522477149963379 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.19897246360778809 s
Cluster sizes
[2795  112]
Cross-contamination matrix:
[[1.  0.6]
 [0.5 1. ]]
Pattern-to-pattern sim matrix:
[[1.   0.68]
 [0.68 1.  ]]
Inspecting pattern 4 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 1964
[t-SNE] Computed conditional probabilities for sample 1964 / 1964
[t-SNE] Mean sigma: 0.311782
Beginning preprocessing + Leiden
2024-03-13 20:43:16.278669 MEMORY 17.944088576
Affmat transformed
2024-03-13 20:43:16.302773 MEMORY 17.944088576
sources, targets, weights extracted
2024-03-13 20:43:16.317573 MEMORY 17.944088576
About to launch parallel Leiden runs
2024-03-13 20:43:16.383681 MEMORY 17.944088576
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    6.8s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   16.0s finished
Parallel Leiden runs finished
2024-03-13 20:43:32.349242 MEMORY 17.944088576
Quality: 0.4981157463442982
Quality: 0.5003105617581257
Quality: 0.5003191071850269
Quality: 0.5029106894579313
Got subclusters: Counter({0: 453, 1: 400, 2: 302, 3: 289, 4: 276, 5: 244})
On merging iteration 1
Numbers for each pattern pre-subsample: [453, 400, 302, 289, 276, 244]
Numbers after subsampling: [300, 300, 300, 289, 276, 244]
Computing sims for pattern 0
Computed sims for pattern 0 in 2.174530506134033 s
Computing sims for pattern 1
Computed sims for pattern 1 in 2.144261598587036 s
Computing sims for pattern 2
Computed sims for pattern 2 in 2.130997657775879 s
Computing sims for pattern 3
Computed sims for pattern 3 in 2.0366244316101074 s
Computing sims for pattern 4
Computed sims for pattern 4 in 1.8713762760162354 s
Computing sims for pattern 5
Computed sims for pattern 5 in 1.5477027893066406 s
Cluster sizes
[453 400 302 289 276 244]
Cross-contamination matrix:
[[1.   0.86 0.91 0.69 0.59 0.67]
 [0.43 1.   0.82 0.5  0.39 0.53]
 [0.47 0.78 1.   0.33 0.22 0.47]
 [0.43 0.65 0.43 1.   0.63 0.71]
 [0.38 0.53 0.29 0.57 1.   0.49]
 [0.44 0.71 0.63 0.74 0.5  1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.77 0.81 0.66 0.57 0.71]
 [0.77 1.   0.88 0.77 0.68 0.8 ]
 [0.81 0.88 1.   0.56 0.48 0.69]
 [0.66 0.77 0.56 1.   0.72 0.9 ]
 [0.57 0.68 0.48 0.72 1.   0.65]
 [0.71 0.8  0.69 0.9  0.65 1.  ]]
Collapsing 3 & 5 with crosscontam 0.7092621872404201 and sim 0.8984997394220359
Collapsing 1 & 2 with crosscontam 0.7755324153086418 and sim 0.8845944828692037
Trimming eliminated 0 seqlets out of 533
Trimming eliminated 0 seqlets out of 702
Unmerged patterns remapping: OrderedDict([(0, 2), (4, 3)])
Time spent on merging iteration: 7.172995567321777
On merging iteration 2
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   3 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 416 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 1144 out of 1144 | elapsed:    0.2s finished
Numbers for each pattern pre-subsample: [702, 533, 453, 276]
Numbers after subsampling: [300, 300, 300, 276]
Computing sims for pattern 0
Computed sims for pattern 0 in 1.2771599292755127 s
Computing sims for pattern 1
Computed sims for pattern 1 in 1.2614915370941162 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.8502566814422607 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.7854549884796143 s
Cluster sizes
[702 533 453 276]
Cross-contamination matrix:
[[1.   0.57 0.59 0.44]
 [0.75 1.   0.57 0.73]
 [0.87 0.66 1.   0.59]
 [0.43 0.57 0.38 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.73 0.8  0.65]
 [0.73 1.   0.69 0.7 ]
 [0.8  0.69 1.   0.57]
 [0.65 0.7  0.57 1.  ]]
Inspecting pattern 5 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 1144
[t-SNE] Computed conditional probabilities for sample 1144 / 1144
[t-SNE] Mean sigma: 0.321616
Beginning preprocessing + Leiden
2024-03-13 20:43:56.139141 MEMORY 17.944088576
Affmat transformed
2024-03-13 20:43:56.152708 MEMORY 17.944088576
sources, targets, weights extracted
2024-03-13 20:43:56.162860 MEMORY 17.944088576
About to launch parallel Leiden runs
2024-03-13 20:43:56.215230 MEMORY 17.944088576
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    4.0s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    8.8s finished
Parallel Leiden runs finished
2024-03-13 20:44:05.037390 MEMORY 17.944088576
Quality: 0.48031911975336483
Quality: 0.48098314325625574
Quality: 0.48272344809413326
Quality: 0.4830102320485907
Quality: 0.4830667873077376
Got subclusters: Counter({0: 212, 1: 194, 2: 186, 3: 154, 4: 142, 5: 126, 6: 98, 7: 22, 8: 10})
On merging iteration 1
Numbers for each pattern pre-subsample: [212, 194, 186, 154, 142, 126, 98, 22, 10]
Numbers after subsampling: [212, 194, 186, 154, 142, 126, 98, 22, 10]
Computing sims for pattern 0
Computed sims for pattern 0 in 2.3155484199523926 s
Computing sims for pattern 1
Computed sims for pattern 1 in 2.072244167327881 s
Computing sims for pattern 2
Computed sims for pattern 2 in 2.01043701171875 s
Computing sims for pattern 3
Computed sims for pattern 3 in 1.5561778545379639 s
Computing sims for pattern 4
Computed sims for pattern 4 in 1.6368229389190674 s
Computing sims for pattern 5
Computed sims for pattern 5 in 1.4232449531555176 s
Computing sims for pattern 6
Computed sims for pattern 6 in 1.1012306213378906 s
Computing sims for pattern 7
Computed sims for pattern 7 in 0.41815972328186035 s
Computing sims for pattern 8
Computed sims for pattern 8 in 0.278092622756958 s
Cluster sizes
[212 194 186 154 142 126  98  22  10]
Cross-contamination matrix:
[[1.   0.66 0.59 1.   0.64 0.78 0.73 0.52 0.3 ]
 [0.53 1.   0.36 0.8  0.41 0.74 0.55 0.48 0.1 ]
 [0.9  0.74 1.   1.   0.78 0.8  0.82 0.64 0.28]
 [0.43 0.37 0.25 1.   0.4  0.8  0.51 0.22 0.16]
 [0.73 0.4  0.58 1.   1.   0.84 0.75 0.67 0.28]
 [0.31 0.34 0.18 0.74 0.29 1.   0.46 0.16 0.3 ]
 [0.66 0.6  0.48 0.9  0.6  0.88 1.   0.49 0.39]
 [0.21 0.31 0.16 0.28 0.23 0.21 0.22 1.   0.03]
 [0.06 0.01 0.02 0.1  0.04 0.29 0.09 0.01 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.74 0.84 0.84 0.82 0.79 0.8  0.6  0.56]
 [0.74 1.   0.65 0.69 0.63 0.65 0.68 0.74 0.39]
 [0.84 0.65 1.   0.75 0.84 0.71 0.78 0.63 0.5 ]
 [0.84 0.69 0.75 1.   0.85 0.97 0.81 0.58 0.62]
 [0.82 0.63 0.84 0.85 1.   0.8  0.77 0.71 0.6 ]
 [0.79 0.65 0.71 0.97 0.8  1.   0.82 0.55 0.71]
 [0.8  0.68 0.78 0.81 0.77 0.82 1.   0.57 0.61]
 [0.6  0.74 0.63 0.58 0.71 0.55 0.57 1.   0.42]
 [0.56 0.39 0.5  0.62 0.6  0.71 0.61 0.42 1.  ]]
Collapsing 3 & 5 with crosscontam 0.7360110974461476 and sim 0.9695827061315319
Trimming eliminated 0 seqlets out of 280
Unmerged patterns remapping: OrderedDict([(0, 1), (1, 2), (2, 3), (4, 4), (6, 5), (7, 6), (8, 7)])
Time spent on merging iteration: 0.673537015914917
On merging iteration 2
Numbers for each pattern pre-subsample: [280, 212, 194, 186, 142, 98, 22, 10]
Numbers after subsampling: [280, 212, 194, 186, 142, 98, 22, 10]
Computing sims for pattern 0
Computed sims for pattern 0 in 2.258117914199829 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.32979321479797363 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.31401515007019043 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.2931032180786133 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.24045491218566895 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.18051648139953613 s
Computing sims for pattern 6
Computed sims for pattern 6 in 0.07616877555847168 s
Computing sims for pattern 7
Computed sims for pattern 7 in 0.05519366264343262 s
Cluster sizes
[280 212 194 186 142  98  22  10]
Cross-contamination matrix:
[[1.   0.48 0.45 0.3  0.46 0.58 0.29 0.26]
 [0.92 1.   0.66 0.59 0.64 0.73 0.52 0.3 ]
 [0.75 0.53 1.   0.36 0.41 0.55 0.48 0.1 ]
 [0.93 0.9  0.74 1.   0.78 0.82 0.64 0.28]
 [0.96 0.73 0.4  0.58 1.   0.75 0.67 0.28]
 [0.88 0.66 0.6  0.48 0.6  1.   0.49 0.39]
 [0.25 0.21 0.31 0.16 0.23 0.22 1.   0.03]
 [0.17 0.06 0.01 0.02 0.04 0.09 0.01 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.84 0.68 0.75 0.85 0.82 0.57 0.64]
 [0.84 1.   0.74 0.84 0.82 0.8  0.6  0.56]
 [0.68 0.74 1.   0.65 0.63 0.68 0.74 0.39]
 [0.75 0.84 0.65 1.   0.84 0.78 0.63 0.5 ]
 [0.85 0.82 0.63 0.84 1.   0.77 0.71 0.6 ]
 [0.82 0.8  0.68 0.78 0.77 1.   0.57 0.61]
 [0.57 0.6  0.74 0.63 0.71 0.57 1.   0.42]
 [0.64 0.56 0.39 0.5  0.6  0.61 0.42 1.  ]]
Merging on 21 clusters
2024-03-13 20:44:22.228259 MEMORY 17.944088576
On merging iteration 1
Numbers for each pattern pre-subsample: [2629, 914, 723, 238, 4033, 93, 3103, 2795, 112, 702, 533, 453, 276, 280, 212, 194, 186, 142, 98, 22, 10]
Numbers after subsampling: [300, 300, 300, 238, 300, 93, 300, 300, 112, 300, 300, 300, 276, 280, 212, 194, 186, 142, 98, 22, 10]
Computing sims for pattern 0
Computed sims for pattern 0 in 8.037309169769287 s
Computing sims for pattern 1
Computed sims for pattern 1 in 8.007888078689575 s
Computing sims for pattern 2
Computed sims for pattern 2 in 7.832985162734985 s
Computing sims for pattern 3
Computed sims for pattern 3 in 7.35435676574707 s
Computing sims for pattern 4
Computed sims for pattern 4 in 7.748572587966919 s
Computing sims for pattern 5
Computed sims for pattern 5 in 3.5129332542419434 s
Computing sims for pattern 6
Computed sims for pattern 6 in 7.812839984893799 s
Computing sims for pattern 7
Computed sims for pattern 7 in 7.794307231903076 s
Computing sims for pattern 8
Computed sims for pattern 8 in 3.5289320945739746 s
Computing sims for pattern 9
Computed sims for pattern 9 in 7.804572105407715 s
Computing sims for pattern 10
Computed sims for pattern 10 in 7.750548839569092 s
Computing sims for pattern 11
Computed sims for pattern 11 in 7.776124000549316 s
Computing sims for pattern 12
Computed sims for pattern 12 in 6.845935344696045 s
Computing sims for pattern 13
Computed sims for pattern 13 in 7.074681997299194 s
Computing sims for pattern 14
Computed sims for pattern 14 in 6.3287882804870605 s
Computing sims for pattern 15
Computed sims for pattern 15 in 5.712490797042847 s
Computing sims for pattern 16
Computed sims for pattern 16 in 5.369158029556274 s
Computing sims for pattern 17
Computed sims for pattern 17 in 4.478500843048096 s
Computing sims for pattern 18
Computed sims for pattern 18 in 3.106645107269287 s
Computing sims for pattern 19
Computed sims for pattern 19 in 1.2700963020324707 s
Computing sims for pattern 20
Computed sims for pattern 20 in 0.9256572723388672 s
Cluster sizes
[2629  914  723  238 4033   93 3103 2795  112  702  533  453  276  280
  212  194  186  142   98   22   10]
Cross-contamination matrix:
[[1.   0.74 0.87 0.77 0.14 0.15 0.11 0.35 0.56 0.1  0.06 0.05 0.39 0.5
  0.68 0.3  0.55 0.6  0.47 0.41 0.14]
 [0.73 1.   0.85 0.6  0.41 0.38 0.16 0.23 0.35 0.11 0.16 0.14 0.31 0.5
  0.7  0.42 0.56 0.59 0.45 0.32 0.2 ]
 [0.57 0.58 1.   0.41 0.12 0.13 0.06 0.09 0.19 0.02 0.02 0.04 0.12 0.29
  0.26 0.14 0.29 0.24 0.18 0.11 0.03]
 [0.55 0.41 0.48 1.   0.36 0.24 0.36 0.63 0.41 0.23 0.1  0.12 0.16 0.15
  0.27 0.1  0.23 0.24 0.14 0.62 0.04]
 [0.12 0.3  0.2  0.43 1.   0.84 0.73 0.74 0.32 0.52 0.23 0.21 0.15 0.17
  0.25 0.61 0.11 0.25 0.16 0.65 0.06]
 [0.02 0.07 0.04 0.07 0.45 1.   0.2  0.19 0.08 0.1  0.1  0.04 0.07 0.01
  0.03 0.08 0.01 0.05 0.02 0.12 0.  ]
 [0.08 0.09 0.11 0.42 0.73 0.54 1.   0.94 0.53 0.71 0.27 0.24 0.23 0.18
  0.15 0.67 0.09 0.26 0.17 0.62 0.05]
 [0.21 0.12 0.11 0.58 0.62 0.43 0.79 1.   0.6  0.59 0.21 0.19 0.17 0.14
  0.16 0.08 0.08 0.25 0.11 0.55 0.07]
 [0.26 0.13 0.16 0.32 0.17 0.15 0.33 0.5  1.   0.1  0.06 0.05 0.04 0.26
  0.22 0.15 0.1  0.34 0.13 0.34 0.05]
 [0.06 0.07 0.06 0.25 0.47 0.34 0.65 0.66 0.17 1.   0.57 0.59 0.44 0.1
  0.11 0.1  0.06 0.12 0.1  0.35 0.12]
 [0.05 0.12 0.07 0.16 0.29 0.44 0.34 0.36 0.14 0.75 1.   0.57 0.73 0.11
  0.06 0.25 0.12 0.07 0.29 0.27 0.15]
 [0.04 0.11 0.09 0.22 0.3  0.31 0.36 0.38 0.16 0.87 0.66 1.   0.59 0.14
  0.16 0.24 0.06 0.2  0.44 0.24 0.23]
 [0.21 0.17 0.14 0.16 0.12 0.25 0.2  0.2  0.04 0.43 0.57 0.38 1.   0.22
  0.23 0.25 0.4  0.36 0.67 0.2  0.07]
 [0.16 0.16 0.18 0.13 0.07 0.03 0.08 0.09 0.17 0.07 0.05 0.05 0.17 1.
  0.48 0.45 0.3  0.46 0.58 0.29 0.26]
 [0.48 0.5  0.34 0.28 0.21 0.12 0.12 0.18 0.31 0.09 0.04 0.11 0.38 0.92
  1.   0.66 0.59 0.64 0.73 0.52 0.3 ]
 [0.14 0.19 0.19 0.07 0.43 0.19 0.49 0.06 0.17 0.05 0.12 0.1  0.19 0.75
  0.53 1.   0.36 0.41 0.55 0.48 0.1 ]
 [0.62 0.64 0.6  0.37 0.17 0.2  0.16 0.19 0.3  0.1  0.16 0.08 0.67 0.93
  0.9  0.74 1.   0.78 0.82 0.64 0.28]
 [0.5  0.5  0.39 0.44 0.28 0.27 0.29 0.35 0.58 0.13 0.07 0.05 0.48 0.96
  0.73 0.4  0.58 1.   0.75 0.67 0.28]
 [0.31 0.33 0.26 0.17 0.13 0.12 0.16 0.14 0.21 0.12 0.18 0.23 0.6  0.88
  0.66 0.6  0.48 0.6  1.   0.49 0.39]
 [0.08 0.05 0.03 0.3  0.28 0.11 0.24 0.29 0.19 0.12 0.04 0.03 0.07 0.25
  0.21 0.31 0.16 0.23 0.22 1.   0.03]
 [0.   0.01 0.01 0.   0.01 0.   0.01 0.01 0.   0.03 0.02 0.03 0.01 0.17
  0.06 0.01 0.02 0.04 0.09 0.01 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.8  0.8  0.8  0.33 0.3  0.22 0.44 0.64 0.14 0.09 0.09 0.49 0.53
  0.73 0.46 0.73 0.7  0.56 0.55 0.34]
 [0.8  1.   0.8  0.64 0.46 0.42 0.27 0.36 0.55 0.12 0.13 0.1  0.39 0.55
  0.75 0.49 0.72 0.71 0.57 0.54 0.35]
 [0.8  0.8  1.   0.63 0.39 0.38 0.22 0.29 0.49 0.09 0.1  0.08 0.3  0.4
  0.5  0.39 0.65 0.53 0.41 0.41 0.34]
 [0.8  0.64 0.63 1.   0.54 0.41 0.51 0.73 0.58 0.34 0.12 0.19 0.42 0.38
  0.59 0.33 0.54 0.57 0.4  0.7  0.31]
 [0.33 0.46 0.39 0.54 1.   0.82 0.82 0.8  0.49 0.65 0.35 0.4  0.24 0.27
  0.43 0.73 0.39 0.53 0.3  0.68 0.26]
 [0.3  0.42 0.38 0.41 0.82 1.   0.62 0.64 0.38 0.56 0.38 0.37 0.33 0.14
  0.27 0.45 0.34 0.42 0.27 0.43 0.26]
 [0.22 0.27 0.22 0.51 0.82 0.62 1.   0.91 0.6  0.8  0.44 0.43 0.41 0.25
  0.27 0.76 0.3  0.48 0.27 0.68 0.22]
 [0.44 0.36 0.29 0.73 0.8  0.64 0.91 1.   0.68 0.78 0.37 0.43 0.37 0.26
  0.35 0.19 0.33 0.52 0.26 0.69 0.33]
 [0.64 0.55 0.49 0.58 0.49 0.38 0.6  0.68 1.   0.43 0.26 0.33 0.19 0.44
  0.52 0.37 0.5  0.6  0.39 0.58 0.4 ]
 [0.14 0.12 0.09 0.34 0.65 0.56 0.8  0.78 0.43 1.   0.73 0.8  0.65 0.26
  0.22 0.15 0.2  0.27 0.16 0.44 0.42]
 [0.09 0.13 0.1  0.12 0.35 0.38 0.44 0.37 0.26 0.73 1.   0.69 0.7  0.08
  0.11 0.29 0.21 0.18 0.31 0.25 0.15]
 [0.09 0.1  0.08 0.19 0.4  0.37 0.43 0.43 0.33 0.8  0.69 1.   0.57 0.15
  0.17 0.37 0.19 0.19 0.48 0.27 0.24]
 [0.49 0.39 0.3  0.42 0.24 0.33 0.41 0.37 0.19 0.65 0.7  0.57 1.   0.48
  0.57 0.53 0.68 0.53 0.79 0.38 0.31]
 [0.53 0.55 0.4  0.38 0.27 0.14 0.25 0.26 0.44 0.26 0.08 0.15 0.48 1.
  0.84 0.68 0.75 0.85 0.82 0.57 0.64]
 [0.73 0.75 0.5  0.59 0.43 0.27 0.27 0.35 0.52 0.22 0.11 0.17 0.57 0.84
  1.   0.74 0.84 0.82 0.8  0.6  0.56]
 [0.46 0.49 0.39 0.33 0.73 0.45 0.76 0.19 0.37 0.15 0.29 0.37 0.53 0.68
  0.74 1.   0.65 0.63 0.68 0.74 0.39]
 [0.73 0.72 0.65 0.54 0.39 0.34 0.3  0.33 0.5  0.2  0.21 0.19 0.68 0.75
  0.84 0.65 1.   0.84 0.78 0.63 0.5 ]
 [0.7  0.71 0.53 0.57 0.53 0.42 0.48 0.52 0.6  0.27 0.18 0.19 0.53 0.85
  0.82 0.63 0.84 1.   0.77 0.71 0.6 ]
 [0.56 0.57 0.41 0.4  0.3  0.27 0.27 0.26 0.39 0.16 0.31 0.48 0.79 0.82
  0.8  0.68 0.78 0.77 1.   0.57 0.61]
 [0.55 0.54 0.41 0.7  0.68 0.43 0.68 0.69 0.58 0.44 0.25 0.27 0.38 0.57
  0.6  0.74 0.63 0.71 0.57 1.   0.42]
 [0.34 0.35 0.34 0.31 0.26 0.26 0.22 0.33 0.4  0.42 0.15 0.24 0.31 0.64
  0.56 0.39 0.5  0.6  0.61 0.42 1.  ]]
Collapsing 6 & 7 with crosscontam 0.7889834182716049 and sim 0.9088870977741947
Skipped 4 due to duplicates
Trimming eliminated 0 seqlets out of 5894
Unmerged patterns remapping: OrderedDict([(0, 2), (1, 3), (2, 4), (3, 10), (4, 1), (5, 17), (8, 15), (9, 5), (10, 6), (11, 7), (12, 9), (13, 8), (14, 11), (15, 12), (16, 13), (17, 14), (18, 16), (19, 18), (20, 19)])
Time spent on merging iteration: 14.014362812042236
On merging iteration 2
Numbers for each pattern pre-subsample: [5894, 4033, 2629, 914, 723, 702, 533, 453, 280, 276, 238, 212, 194, 186, 142, 112, 98, 93, 22, 10]
Numbers after subsampling: [300, 300, 300, 300, 300, 300, 300, 300, 280, 276, 238, 212, 194, 186, 142, 112, 98, 93, 22, 10]
Computing sims for pattern 0
Computed sims for pattern 0 in 7.563629865646362 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.41986942291259766 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.4181251525878906 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.43108320236206055 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.4216041564941406 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.4302515983581543 s
Computing sims for pattern 6
Computed sims for pattern 6 in 0.4192843437194824 s
Computing sims for pattern 7
Computed sims for pattern 7 in 0.422593355178833 s
Computing sims for pattern 8
Computed sims for pattern 8 in 0.3748440742492676 s
Computing sims for pattern 9
Computed sims for pattern 9 in 0.37282705307006836 s
Computing sims for pattern 10
Computed sims for pattern 10 in 0.394972562789917 s
Computing sims for pattern 11
Computed sims for pattern 11 in 0.34169816970825195 s
Computing sims for pattern 12
Computed sims for pattern 12 in 0.31748366355895996 s
Computing sims for pattern 13
Computed sims for pattern 13 in 0.3009946346282959 s
Computing sims for pattern 14
Computed sims for pattern 14 in 0.24840426445007324 s
Computing sims for pattern 15
Computed sims for pattern 15 in 0.19959330558776855 s
Computing sims for pattern 16
Computed sims for pattern 16 in 0.1772170066833496 s
Computing sims for pattern 17
Computed sims for pattern 17 in 0.19809818267822266 s
Computing sims for pattern 18
Computed sims for pattern 18 in 0.0779259204864502 s
Computing sims for pattern 19
Computed sims for pattern 19 in 0.05829882621765137 s
Cluster sizes
[5894 4033 2629  914  723  702  533  453  280  276  238  212  194  186
  142  112   98   93   22   10]
Cross-contamination matrix:
[[1.   0.72 0.14 0.12 0.13 0.69 0.26 0.24 0.18 0.22 0.55 0.15 0.66 0.1
  0.29 0.59 0.15 0.54 0.63 0.05]
 [0.74 1.   0.12 0.3  0.2  0.52 0.23 0.21 0.17 0.15 0.43 0.25 0.61 0.11
  0.25 0.32 0.16 0.84 0.65 0.06]
 [0.2  0.14 1.   0.74 0.87 0.1  0.06 0.05 0.5  0.39 0.77 0.68 0.3  0.55
  0.6  0.56 0.47 0.15 0.41 0.14]
 [0.2  0.41 0.73 1.   0.85 0.11 0.16 0.14 0.5  0.31 0.6  0.7  0.42 0.56
  0.59 0.35 0.45 0.38 0.32 0.2 ]
 [0.08 0.12 0.57 0.58 1.   0.02 0.02 0.04 0.29 0.12 0.41 0.26 0.14 0.29
  0.24 0.19 0.18 0.13 0.11 0.03]
 [0.65 0.47 0.06 0.07 0.06 1.   0.57 0.59 0.1  0.44 0.25 0.11 0.1  0.06
  0.12 0.17 0.1  0.34 0.35 0.12]
 [0.34 0.29 0.05 0.12 0.07 0.75 1.   0.57 0.11 0.73 0.16 0.06 0.25 0.12
  0.07 0.14 0.29 0.44 0.27 0.15]
 [0.38 0.3  0.04 0.11 0.09 0.87 0.66 1.   0.14 0.59 0.22 0.16 0.24 0.06
  0.2  0.16 0.44 0.31 0.24 0.23]
 [0.08 0.07 0.16 0.16 0.18 0.07 0.05 0.05 1.   0.17 0.13 0.48 0.45 0.3
  0.46 0.17 0.58 0.03 0.29 0.26]
 [0.2  0.12 0.21 0.17 0.14 0.43 0.57 0.38 0.22 1.   0.16 0.23 0.25 0.4
  0.36 0.04 0.67 0.25 0.2  0.07]
 [0.5  0.36 0.55 0.41 0.48 0.23 0.1  0.12 0.15 0.16 1.   0.27 0.1  0.23
  0.24 0.41 0.14 0.24 0.62 0.04]
 [0.14 0.21 0.48 0.5  0.34 0.09 0.04 0.11 0.92 0.38 0.28 1.   0.66 0.59
  0.64 0.31 0.73 0.12 0.52 0.3 ]
 [0.52 0.43 0.14 0.19 0.19 0.05 0.12 0.1  0.75 0.19 0.07 0.53 1.   0.36
  0.41 0.17 0.55 0.19 0.48 0.1 ]
 [0.19 0.17 0.62 0.64 0.6  0.1  0.16 0.08 0.93 0.67 0.37 0.9  0.74 1.
  0.78 0.3  0.82 0.2  0.64 0.28]
 [0.33 0.28 0.5  0.5  0.39 0.13 0.07 0.05 0.96 0.48 0.44 0.73 0.4  0.58
  1.   0.58 0.75 0.27 0.67 0.28]
 [0.4  0.17 0.26 0.13 0.16 0.1  0.06 0.05 0.26 0.04 0.32 0.22 0.15 0.1
  0.34 1.   0.13 0.15 0.34 0.05]
 [0.16 0.13 0.31 0.33 0.26 0.12 0.18 0.23 0.88 0.6  0.17 0.66 0.6  0.48
  0.6  0.21 1.   0.12 0.49 0.39]
 [0.21 0.45 0.02 0.07 0.04 0.1  0.1  0.04 0.01 0.07 0.07 0.03 0.08 0.01
  0.05 0.08 0.02 1.   0.12 0.  ]
 [0.27 0.28 0.08 0.05 0.03 0.12 0.04 0.03 0.25 0.07 0.3  0.21 0.31 0.16
  0.23 0.19 0.22 0.11 1.   0.03]
 [0.01 0.01 0.   0.01 0.01 0.03 0.02 0.03 0.17 0.01 0.   0.06 0.01 0.02
  0.04 0.   0.09 0.   0.01 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.84 0.33 0.32 0.25 0.8  0.42 0.44 0.26 0.39 0.62 0.28 0.77 0.32
  0.51 0.64 0.27 0.63 0.7  0.23]
 [0.84 1.   0.33 0.46 0.39 0.65 0.35 0.4  0.27 0.24 0.54 0.43 0.73 0.39
  0.53 0.49 0.3  0.82 0.68 0.26]
 [0.33 0.33 1.   0.8  0.8  0.14 0.09 0.09 0.53 0.49 0.8  0.73 0.46 0.73
  0.7  0.64 0.56 0.3  0.55 0.34]
 [0.32 0.46 0.8  1.   0.8  0.12 0.13 0.1  0.55 0.39 0.64 0.75 0.49 0.72
  0.71 0.55 0.57 0.42 0.54 0.35]
 [0.25 0.39 0.8  0.8  1.   0.09 0.1  0.08 0.4  0.3  0.63 0.5  0.39 0.65
  0.53 0.49 0.41 0.38 0.41 0.34]
 [0.8  0.65 0.14 0.12 0.09 1.   0.73 0.8  0.26 0.65 0.34 0.22 0.15 0.2
  0.27 0.43 0.16 0.56 0.44 0.42]
 [0.42 0.35 0.09 0.13 0.1  0.73 1.   0.69 0.08 0.7  0.12 0.11 0.29 0.21
  0.18 0.26 0.31 0.38 0.25 0.15]
 [0.44 0.4  0.09 0.1  0.08 0.8  0.69 1.   0.15 0.57 0.19 0.17 0.37 0.19
  0.19 0.33 0.48 0.37 0.27 0.24]
 [0.26 0.27 0.53 0.55 0.4  0.26 0.08 0.15 1.   0.48 0.38 0.84 0.68 0.75
  0.85 0.44 0.82 0.14 0.57 0.64]
 [0.39 0.24 0.49 0.39 0.3  0.65 0.7  0.57 0.48 1.   0.42 0.57 0.53 0.68
  0.53 0.19 0.79 0.33 0.38 0.31]
 [0.62 0.54 0.8  0.64 0.63 0.34 0.12 0.19 0.38 0.42 1.   0.59 0.33 0.54
  0.57 0.58 0.4  0.41 0.7  0.31]
 [0.28 0.43 0.73 0.75 0.5  0.22 0.11 0.17 0.84 0.57 0.59 1.   0.74 0.84
  0.82 0.52 0.8  0.27 0.6  0.56]
 [0.77 0.73 0.46 0.49 0.39 0.15 0.29 0.37 0.68 0.53 0.33 0.74 1.   0.65
  0.63 0.37 0.68 0.45 0.74 0.39]
 [0.32 0.39 0.73 0.72 0.65 0.2  0.21 0.19 0.75 0.68 0.54 0.84 0.65 1.
  0.84 0.5  0.78 0.34 0.63 0.5 ]
 [0.51 0.53 0.7  0.71 0.53 0.27 0.18 0.19 0.85 0.53 0.57 0.82 0.63 0.84
  1.   0.6  0.77 0.42 0.71 0.6 ]
 [0.64 0.49 0.64 0.55 0.49 0.43 0.26 0.33 0.44 0.19 0.58 0.52 0.37 0.5
  0.6  1.   0.39 0.38 0.58 0.4 ]
 [0.27 0.3  0.56 0.57 0.41 0.16 0.31 0.48 0.82 0.79 0.4  0.8  0.68 0.78
  0.77 0.39 1.   0.27 0.57 0.61]
 [0.63 0.82 0.3  0.42 0.38 0.56 0.38 0.37 0.14 0.33 0.41 0.27 0.45 0.34
  0.42 0.38 0.27 1.   0.43 0.26]
 [0.7  0.68 0.55 0.54 0.41 0.44 0.25 0.27 0.57 0.38 0.7  0.6  0.74 0.63
  0.71 0.58 0.57 0.43 1.   0.42]
 [0.23 0.26 0.34 0.35 0.34 0.42 0.15 0.24 0.64 0.31 0.31 0.56 0.39 0.5
  0.6  0.4  0.61 0.26 0.42 1.  ]]
Got 20 patterns after merging
2024-03-13 20:46:57.258984 MEMORY 17.944088576
Performing filtering
2024-03-13 20:46:57.259207 MEMORY 17.944088576
Got 18 patterns after filtering
2024-03-13 20:46:59.574590 MEMORY 17.944088576
Total time taken is 2486.13s
2024-03-13 20:46:59.574751 MEMORY 17.944088576
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.6s
[Parallel(n_jobs=24)]: Done 2400 tasks      | elapsed:    2.4s
[Parallel(n_jobs=24)]: Done 5200 tasks      | elapsed:    5.0s
[Parallel(n_jobs=24)]: Done 5847 out of 5894 | elapsed:    5.5s remaining:    0.0s
[Parallel(n_jobs=24)]: Done 5894 out of 5894 | elapsed:    5.5s finished
/ru-auth/local/home/lzhao/anaconda3/envs/jupyter-ml-clone/lib/python3.9/site-packages/sklearn/manifold/_t_sne.py:691: FutureWarning: 'square_distances' has been introduced in 0.24 to help phase out legacy squaring behavior. The 'legacy' setting will be removed in 1.1 (renaming of 0.26), and the default setting will be changed to True. In 1.3, 'square_distances' will be removed altogether, and distances will be squared by default. Set 'square_distances'=True to silence this warning.
  warnings.warn(
/ru-auth/local/home/lzhao/anaconda3/envs/jupyter-ml-clone/lib/python3.9/site-packages/sklearn/neighbors/_base.py:175: EfficiencyWarning: Precomputed sparse input was not sorted by data.
  warnings.warn('Precomputed sparse input was not sorted by data.',
Applying subclustering to the final motifs
On pattern 0
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 5894 samples in 0.040s...
[t-SNE] Computed neighbors for 5894 samples in 0.004s...
[t-SNE] Computed conditional probabilities for sample 1000 / 5894
[t-SNE] Computed conditional probabilities for sample 2000 / 5894
[t-SNE] Computed conditional probabilities for sample 3000 / 5894
[t-SNE] Computed conditional probabilities for sample 4000 / 5894
[t-SNE] Computed conditional probabilities for sample 5000 / 5894
[t-SNE] Computed conditional probabilities for sample 5894 / 5894
[t-SNE] Mean sigma: 0.270102
[t-SNE] Computed conditional probabilities in 0.419s
[t-SNE] Iteration 50: error = 82.8421097, gradient norm = 0.0000001 (50 iterations in 2.367s)
[t-SNE] Iteration 50: gradient norm 0.000000. Finished.
[t-SNE] KL divergence after 50 iterations with early exaggeration: 82.842110
[t-SNE] Iteration 100: error = 3.3505800, gradient norm = 0.0016925 (50 iterations in 2.209s)
[t-SNE] Iteration 150: error = 3.0702605, gradient norm = 0.0005647 (50 iterations in 1.436s)
[t-SNE] Iteration 200: error = 2.9756248, gradient norm = 0.0003046 (50 iterations in 0.405s)
[t-SNE] Iteration 250: error = 2.9215522, gradient norm = 0.0001749 (50 iterations in 0.406s)
[t-SNE] Iteration 300: error = 2.8857043, gradient norm = 0.0001317 (50 iterations in 0.419s)
[t-SNE] Iteration 350: error = 2.8615081, gradient norm = 0.0000984 (50 iterations in 0.409s)
[t-SNE] Iteration 400: error = 2.8438888, gradient norm = 0.0000838 (50 iterations in 0.443s)
[t-SNE] Iteration 450: error = 2.8313458, gradient norm = 0.0000689 (50 iterations in 0.423s)
[t-SNE] Iteration 500: error = 2.8224361, gradient norm = 0.0000702 (50 iterations in 0.408s)
[t-SNE] Iteration 550: error = 2.8162985, gradient norm = 0.0000598 (50 iterations in 0.405s)
[t-SNE] Iteration 600: error = 2.8109262, gradient norm = 0.0000525 (50 iterations in 0.407s)
[t-SNE] Iteration 650: error = 2.8073919, gradient norm = 0.0000524 (50 iterations in 0.409s)
[t-SNE] Iteration 700: error = 2.8046279, gradient norm = 0.0000480 (50 iterations in 0.409s)
[t-SNE] Iteration 750: error = 2.8021369, gradient norm = 0.0000428 (50 iterations in 0.408s)
[t-SNE] Iteration 800: error = 2.7998402, gradient norm = 0.0000379 (50 iterations in 0.416s)
[t-SNE] Iteration 850: error = 2.7975869, gradient norm = 0.0000465 (50 iterations in 0.413s)
[t-SNE] Iteration 900: error = 2.7959166, gradient norm = 0.0000438 (50 iterations in 0.415s)
[t-SNE] Iteration 950: error = 2.7945306, gradient norm = 0.0000363 (50 iterations in 0.420s)
[t-SNE] Iteration 1000: error = 2.7930017, gradient norm = 0.0000331 (50 iterations in 0.407s)
[t-SNE] KL divergence after 1000 iterations: 2.793002
[t-SNE] Computed conditional probabilities for sample 1000 / 5894
[t-SNE] Computed conditional probabilities for sample 2000 / 5894
[t-SNE] Computed conditional probabilities for sample 3000 / 5894
[t-SNE] Computed conditional probabilities for sample 4000 / 5894
[t-SNE] Computed conditional probabilities for sample 5000 / 5894
[t-SNE] Computed conditional probabilities for sample 5894 / 5894
[t-SNE] Mean sigma: 0.270102
Beginning preprocessing + Leiden
2024-03-13 20:47:24.595594 MEMORY 17.993424896
Affmat transformed
2024-03-13 20:47:24.670011 MEMORY 18.012307456
sources, targets, weights extracted
2024-03-13 20:47:24.721816 MEMORY 18.012512256
About to launch parallel Leiden runs
2024-03-13 20:47:24.786198 MEMORY 18.012512256
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:   27.8s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:  1.1min finished
Parallel Leiden runs finished
2024-03-13 20:48:30.115372 MEMORY 18.012512256
Quality: 0.5138496878362415
Quality: 0.5139922916072579
Quality: 0.5141814019047312
Quality: 0.5142898519324414
Quality: 0.5148705648627505
Quality: 0.5156800892331609
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.4s
[Parallel(n_jobs=24)]: Done 3495 tasks      | elapsed:    2.1s
[Parallel(n_jobs=24)]: Done 4033 out of 4033 | elapsed:    2.3s finished
Got subclusters: Counter({0: 1050, 1: 922, 2: 854, 3: 751, 4: 685, 6: 543, 5: 543, 7: 433, 8: 113})
On pattern 1
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 4033 samples in 0.026s...
[t-SNE] Computed neighbors for 4033 samples in 0.003s...
[t-SNE] Computed conditional probabilities for sample 1000 / 4033
[t-SNE] Computed conditional probabilities for sample 2000 / 4033
[t-SNE] Computed conditional probabilities for sample 3000 / 4033
[t-SNE] Computed conditional probabilities for sample 4000 / 4033
[t-SNE] Computed conditional probabilities for sample 4033 / 4033
[t-SNE] Mean sigma: 0.272244
[t-SNE] Computed conditional probabilities in 0.280s
[t-SNE] Iteration 50: error = 78.2626953, gradient norm = 0.0051647 (50 iterations in 0.387s)
[t-SNE] Iteration 100: error = 78.2625732, gradient norm = 0.0033818 (50 iterations in 0.493s)
[t-SNE] Iteration 150: error = 78.2625732, gradient norm = 0.0036249 (50 iterations in 0.501s)
[t-SNE] Iteration 200: error = 78.2626038, gradient norm = 0.0039794 (50 iterations in 0.386s)
[t-SNE] Iteration 250: error = 78.2625351, gradient norm = 0.0026563 (50 iterations in 0.398s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 78.262535
[t-SNE] Iteration 300: error = 2.8169777, gradient norm = 0.0016302 (50 iterations in 0.354s)
[t-SNE] Iteration 350: error = 2.6390188, gradient norm = 0.0005120 (50 iterations in 0.298s)
[t-SNE] Iteration 400: error = 2.5613594, gradient norm = 0.0002527 (50 iterations in 0.294s)
[t-SNE] Iteration 450: error = 2.5172360, gradient norm = 0.0001656 (50 iterations in 0.295s)
[t-SNE] Iteration 500: error = 2.4911776, gradient norm = 0.0001161 (50 iterations in 0.295s)
[t-SNE] Iteration 550: error = 2.4737895, gradient norm = 0.0001185 (50 iterations in 0.299s)
[t-SNE] Iteration 600: error = 2.4634862, gradient norm = 0.0000871 (50 iterations in 0.298s)
[t-SNE] Iteration 650: error = 2.4556556, gradient norm = 0.0000727 (50 iterations in 0.295s)
[t-SNE] Iteration 700: error = 2.4505870, gradient norm = 0.0000646 (50 iterations in 0.301s)
[t-SNE] Iteration 750: error = 2.4467988, gradient norm = 0.0000624 (50 iterations in 0.294s)
[t-SNE] Iteration 800: error = 2.4430280, gradient norm = 0.0000522 (50 iterations in 0.293s)
[t-SNE] Iteration 850: error = 2.4401507, gradient norm = 0.0000464 (50 iterations in 0.294s)
[t-SNE] Iteration 900: error = 2.4376483, gradient norm = 0.0000440 (50 iterations in 0.294s)
[t-SNE] Iteration 950: error = 2.4356542, gradient norm = 0.0000431 (50 iterations in 0.334s)
[t-SNE] Iteration 1000: error = 2.4341319, gradient norm = 0.0000454 (50 iterations in 0.296s)
[t-SNE] KL divergence after 1000 iterations: 2.434132
[t-SNE] Computed conditional probabilities for sample 1000 / 4033
[t-SNE] Computed conditional probabilities for sample 2000 / 4033
[t-SNE] Computed conditional probabilities for sample 3000 / 4033
[t-SNE] Computed conditional probabilities for sample 4000 / 4033
[t-SNE] Computed conditional probabilities for sample 4033 / 4033
[t-SNE] Mean sigma: 0.272244
Beginning preprocessing + Leiden
2024-03-13 20:48:44.303936 MEMORY 17.9593216
Affmat transformed
2024-03-13 20:48:44.352846 MEMORY 17.975197696
sources, targets, weights extracted
2024-03-13 20:48:44.387869 MEMORY 17.975242752
About to launch parallel Leiden runs
2024-03-13 20:48:44.438732 MEMORY 17.975242752
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:   16.4s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   41.6s finished
Parallel Leiden runs finished
2024-03-13 20:49:26.094788 MEMORY 17.975242752
Quality: 0.5113492601331519
Quality: 0.5114292562715528
Quality: 0.512535260455549
Quality: 0.5128517223514766
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 2340 tasks      | elapsed:    1.1s
[Parallel(n_jobs=24)]: Done 2629 out of 2629 | elapsed:    1.2s finished
Got subclusters: Counter({0: 958, 1: 796, 2: 738, 3: 710, 4: 339, 5: 255, 6: 237})
On pattern 2
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 2629 samples in 0.018s...
[t-SNE] Computed neighbors for 2629 samples in 0.002s...
[t-SNE] Computed conditional probabilities for sample 1000 / 2629
[t-SNE] Computed conditional probabilities for sample 2000 / 2629
[t-SNE] Computed conditional probabilities for sample 2629 / 2629
[t-SNE] Mean sigma: 0.308762
[t-SNE] Computed conditional probabilities in 0.184s
[t-SNE] Iteration 50: error = 73.8998871, gradient norm = 0.0355494 (50 iterations in 0.208s)
[t-SNE] Iteration 100: error = 73.9923553, gradient norm = 0.0348380 (50 iterations in 0.237s)
[t-SNE] Iteration 150: error = 73.9070282, gradient norm = 0.0441990 (50 iterations in 0.216s)
[t-SNE] Iteration 200: error = 73.8980331, gradient norm = 0.0310028 (50 iterations in 0.223s)
[t-SNE] Iteration 250: error = 73.9237595, gradient norm = 0.0560109 (50 iterations in 0.211s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 73.923759
[t-SNE] Iteration 300: error = 2.4568977, gradient norm = 0.0012799 (50 iterations in 0.186s)
[t-SNE] Iteration 350: error = 2.3316913, gradient norm = 0.0004499 (50 iterations in 0.178s)
[t-SNE] Iteration 400: error = 2.2760165, gradient norm = 0.0002335 (50 iterations in 0.177s)
[t-SNE] Iteration 450: error = 2.2494733, gradient norm = 0.0001345 (50 iterations in 0.183s)
[t-SNE] Iteration 500: error = 2.2335684, gradient norm = 0.0001116 (50 iterations in 0.180s)
[t-SNE] Iteration 550: error = 2.2250206, gradient norm = 0.0000924 (50 iterations in 0.183s)
[t-SNE] Iteration 600: error = 2.2203238, gradient norm = 0.0000666 (50 iterations in 0.176s)
[t-SNE] Iteration 650: error = 2.2165554, gradient norm = 0.0000619 (50 iterations in 0.177s)
[t-SNE] Iteration 700: error = 2.2139227, gradient norm = 0.0000638 (50 iterations in 0.177s)
[t-SNE] Iteration 750: error = 2.2124195, gradient norm = 0.0000514 (50 iterations in 0.178s)
[t-SNE] Iteration 800: error = 2.2111549, gradient norm = 0.0000574 (50 iterations in 0.177s)
[t-SNE] Iteration 850: error = 2.2102680, gradient norm = 0.0000447 (50 iterations in 0.178s)
[t-SNE] Iteration 900: error = 2.2093630, gradient norm = 0.0000418 (50 iterations in 0.176s)
[t-SNE] Iteration 950: error = 2.2083726, gradient norm = 0.0000373 (50 iterations in 0.177s)
[t-SNE] Iteration 1000: error = 2.2074020, gradient norm = 0.0000338 (50 iterations in 0.178s)
[t-SNE] KL divergence after 1000 iterations: 2.207402
[t-SNE] Computed conditional probabilities for sample 1000 / 2629
[t-SNE] Computed conditional probabilities for sample 2000 / 2629
[t-SNE] Computed conditional probabilities for sample 2629 / 2629
[t-SNE] Mean sigma: 0.308762
Beginning preprocessing + Leiden
2024-03-13 20:49:34.399946 MEMORY 17.929203712
Affmat transformed
2024-03-13 20:49:34.431036 MEMORY 17.938305024
sources, targets, weights extracted
2024-03-13 20:49:34.451009 MEMORY 17.938382848
About to launch parallel Leiden runs
2024-03-13 20:49:34.493134 MEMORY 17.938382848
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    9.1s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   26.1s finished
Parallel Leiden runs finished
2024-03-13 20:50:00.643728 MEMORY 17.938382848
Quality: 0.5024800611119298
Quality: 0.5028648981070046
Quality: 0.5029151965044283
Quality: 0.5029820463573512
Quality: 0.5032590233342367
Quality: 0.5033162238278811
Quality: 0.5033808961656909
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   4 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 420 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 914 out of 914 | elapsed:    0.3s finished
Got subclusters: Counter({0: 548, 1: 422, 2: 405, 3: 389, 4: 380, 5: 252, 6: 209, 7: 24})
On pattern 3
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 914 samples in 0.006s...
[t-SNE] Computed neighbors for 914 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 914 / 914
[t-SNE] Mean sigma: 0.339153
[t-SNE] Computed conditional probabilities in 0.062s
[t-SNE] Iteration 50: error = 66.8451920, gradient norm = 0.3391947 (50 iterations in 0.114s)
[t-SNE] Iteration 100: error = 68.2082443, gradient norm = 0.3175913 (50 iterations in 0.079s)
[t-SNE] Iteration 150: error = 69.7308731, gradient norm = 0.2998843 (50 iterations in 0.078s)
[t-SNE] Iteration 200: error = 70.7973938, gradient norm = 0.2962113 (50 iterations in 0.081s)
[t-SNE] Iteration 250: error = 70.3065414, gradient norm = 0.2929454 (50 iterations in 0.080s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 70.306541
[t-SNE] Iteration 300: error = 1.6006107, gradient norm = 0.0025911 (50 iterations in 0.075s)
[t-SNE] Iteration 350: error = 1.5348281, gradient norm = 0.0009321 (50 iterations in 0.080s)
[t-SNE] Iteration 400: error = 1.5116808, gradient norm = 0.0003531 (50 iterations in 0.075s)
[t-SNE] Iteration 450: error = 1.5003836, gradient norm = 0.0004529 (50 iterations in 0.072s)
[t-SNE] Iteration 500: error = 1.4899088, gradient norm = 0.0002356 (50 iterations in 0.073s)
[t-SNE] Iteration 550: error = 1.4857123, gradient norm = 0.0002165 (50 iterations in 0.073s)
[t-SNE] Iteration 600: error = 1.4794542, gradient norm = 0.0001874 (50 iterations in 0.075s)
[t-SNE] Iteration 650: error = 1.4761769, gradient norm = 0.0001054 (50 iterations in 0.073s)
[t-SNE] Iteration 700: error = 1.4740442, gradient norm = 0.0001199 (50 iterations in 0.073s)
[t-SNE] Iteration 750: error = 1.4702454, gradient norm = 0.0002152 (50 iterations in 0.073s)
[t-SNE] Iteration 800: error = 1.4659595, gradient norm = 0.0001446 (50 iterations in 0.074s)
[t-SNE] Iteration 850: error = 1.4631443, gradient norm = 0.0001614 (50 iterations in 0.075s)
[t-SNE] Iteration 900: error = 1.4591544, gradient norm = 0.0001697 (50 iterations in 0.071s)
[t-SNE] Iteration 950: error = 1.4567509, gradient norm = 0.0001618 (50 iterations in 0.071s)
[t-SNE] Iteration 1000: error = 1.4541557, gradient norm = 0.0003395 (50 iterations in 0.071s)
[t-SNE] KL divergence after 1000 iterations: 1.454156
[t-SNE] Computed conditional probabilities for sample 914 / 914
[t-SNE] Mean sigma: 0.339153
Beginning preprocessing + Leiden
2024-03-13 20:50:03.800585 MEMORY 17.938382848
Affmat transformed
2024-03-13 20:50:03.811350 MEMORY 17.938382848
sources, targets, weights extracted
2024-03-13 20:50:03.817965 MEMORY 17.938382848
About to launch parallel Leiden runs
2024-03-13 20:50:03.873529 MEMORY 17.938382848
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    3.0s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    6.1s finished
Parallel Leiden runs finished
2024-03-13 20:50:10.024983 MEMORY 17.938382848
Quality: 0.4713724388278405
Quality: 0.4714944095889683
Quality: 0.47224822695497826
Quality: 0.47241703425242515
Quality: 0.4724678940694754
Quality: 0.4725494188763775
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   3 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 723 out of 723 | elapsed:    0.3s finished
Got subclusters: Counter({0: 218, 1: 165, 2: 125, 3: 115, 4: 102, 5: 86, 6: 79, 7: 24})
On pattern 4
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 723 samples in 0.005s...
[t-SNE] Computed neighbors for 723 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 723 / 723
[t-SNE] Mean sigma: 0.324472
[t-SNE] Computed conditional probabilities in 0.053s
[t-SNE] Iteration 50: error = 70.3427048, gradient norm = 0.3513927 (50 iterations in 0.119s)
[t-SNE] Iteration 100: error = 71.6125336, gradient norm = 0.3605761 (50 iterations in 0.066s)
[t-SNE] Iteration 150: error = 72.0045242, gradient norm = 0.3783687 (50 iterations in 0.069s)
[t-SNE] Iteration 200: error = 71.0776672, gradient norm = 0.3665466 (50 iterations in 0.065s)
[t-SNE] Iteration 250: error = 70.8881073, gradient norm = 0.3848280 (50 iterations in 0.067s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 70.888107
[t-SNE] Iteration 300: error = 1.7045832, gradient norm = 0.0031605 (50 iterations in 0.062s)
[t-SNE] Iteration 350: error = 1.6525284, gradient norm = 0.0007563 (50 iterations in 0.061s)
[t-SNE] Iteration 400: error = 1.6206039, gradient norm = 0.0007964 (50 iterations in 0.061s)
[t-SNE] Iteration 450: error = 1.6001030, gradient norm = 0.0004186 (50 iterations in 0.064s)
[t-SNE] Iteration 500: error = 1.5900515, gradient norm = 0.0002167 (50 iterations in 0.063s)
[t-SNE] Iteration 550: error = 1.5823685, gradient norm = 0.0002028 (50 iterations in 0.063s)
[t-SNE] Iteration 600: error = 1.5796000, gradient norm = 0.0001335 (50 iterations in 0.063s)
[t-SNE] Iteration 650: error = 1.5779065, gradient norm = 0.0001058 (50 iterations in 0.061s)
[t-SNE] Iteration 700: error = 1.5768579, gradient norm = 0.0000786 (50 iterations in 0.064s)
[t-SNE] Iteration 750: error = 1.5767126, gradient norm = 0.0000640 (50 iterations in 0.061s)
[t-SNE] Iteration 800: error = 1.5762405, gradient norm = 0.0000477 (50 iterations in 0.061s)
[t-SNE] Iteration 850: error = 1.5763547, gradient norm = 0.0000714 (50 iterations in 0.063s)
[t-SNE] Iteration 900: error = 1.5761771, gradient norm = 0.0000482 (50 iterations in 0.061s)
[t-SNE] Iteration 950: error = 1.5757058, gradient norm = 0.0001979 (50 iterations in 0.060s)
[t-SNE] Iteration 1000: error = 1.5746806, gradient norm = 0.0000603 (50 iterations in 0.061s)
[t-SNE] KL divergence after 1000 iterations: 1.574681
[t-SNE] Computed conditional probabilities for sample 723 / 723
[t-SNE] Mean sigma: 0.324472
Beginning preprocessing + Leiden
2024-03-13 20:50:12.541792 MEMORY 17.938382848
Affmat transformed
2024-03-13 20:50:12.551116 MEMORY 17.938382848
sources, targets, weights extracted
2024-03-13 20:50:12.557190 MEMORY 17.938382848
About to launch parallel Leiden runs
2024-03-13 20:50:12.595989 MEMORY 17.938382848
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    2.5s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    5.3s finished
Parallel Leiden runs finished
2024-03-13 20:50:17.899273 MEMORY 17.938382848
Quality: 0.3889494577999107
Quality: 0.3918734011821487
Quality: 0.3929418050658008
Quality: 0.3949088354267895
Quality: 0.39493660564816746
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   5 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 424 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 702 out of 702 | elapsed:    0.4s finished
Got subclusters: Counter({0: 107, 1: 104, 2: 96, 3: 90, 4: 80, 5: 76, 6: 67, 7: 55, 8: 48})
On pattern 5
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 702 samples in 0.005s...
[t-SNE] Computed neighbors for 702 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 702 / 702
[t-SNE] Mean sigma: 0.312539
[t-SNE] Computed conditional probabilities in 0.048s
[t-SNE] Iteration 50: error = 69.7260895, gradient norm = 0.3895788 (50 iterations in 0.065s)
[t-SNE] Iteration 100: error = 69.2314377, gradient norm = 0.3882081 (50 iterations in 0.065s)
[t-SNE] Iteration 150: error = 69.8467712, gradient norm = 0.3689387 (50 iterations in 0.065s)
[t-SNE] Iteration 200: error = 70.9116745, gradient norm = 0.3765558 (50 iterations in 0.064s)
[t-SNE] Iteration 250: error = 70.6863403, gradient norm = 0.3543257 (50 iterations in 0.064s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 70.686340
[t-SNE] Iteration 300: error = 1.6014804, gradient norm = 0.0028863 (50 iterations in 0.063s)
[t-SNE] Iteration 350: error = 1.5531176, gradient norm = 0.0006151 (50 iterations in 0.060s)
[t-SNE] Iteration 400: error = 1.5355612, gradient norm = 0.0005484 (50 iterations in 0.060s)
[t-SNE] Iteration 450: error = 1.5307202, gradient norm = 0.0002159 (50 iterations in 0.059s)
[t-SNE] Iteration 500: error = 1.5276179, gradient norm = 0.0001753 (50 iterations in 0.059s)
[t-SNE] Iteration 550: error = 1.5251108, gradient norm = 0.0001646 (50 iterations in 0.059s)
[t-SNE] Iteration 600: error = 1.5227560, gradient norm = 0.0002187 (50 iterations in 0.060s)
[t-SNE] Iteration 650: error = 1.5221103, gradient norm = 0.0001226 (50 iterations in 0.089s)
[t-SNE] Iteration 700: error = 1.5213777, gradient norm = 0.0000933 (50 iterations in 0.088s)
[t-SNE] Iteration 750: error = 1.5215046, gradient norm = 0.0001438 (50 iterations in 0.089s)
[t-SNE] Iteration 800: error = 1.5206739, gradient norm = 0.0000568 (50 iterations in 0.060s)
[t-SNE] Iteration 850: error = 1.5204095, gradient norm = 0.0000422 (50 iterations in 0.087s)
[t-SNE] Iteration 900: error = 1.5203614, gradient norm = 0.0000505 (50 iterations in 0.059s)
[t-SNE] Iteration 950: error = 1.5201795, gradient norm = 0.0000492 (50 iterations in 0.061s)
[t-SNE] Iteration 1000: error = 1.5202247, gradient norm = 0.0000576 (50 iterations in 0.059s)
[t-SNE] KL divergence after 1000 iterations: 1.520225
[t-SNE] Computed conditional probabilities for sample 702 / 702
[t-SNE] Mean sigma: 0.312539
Beginning preprocessing + Leiden
2024-03-13 20:50:20.494525 MEMORY 17.938382848
Affmat transformed
2024-03-13 20:50:20.503610 MEMORY 17.938382848
sources, targets, weights extracted
2024-03-13 20:50:20.509063 MEMORY 17.938382848
About to launch parallel Leiden runs
2024-03-13 20:50:20.543405 MEMORY 17.938382848
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    2.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    6.1s finished
Parallel Leiden runs finished
2024-03-13 20:50:26.606178 MEMORY 17.938382848
Quality: 0.38538814035774405
Quality: 0.3854076685037685
Quality: 0.38687827686170173
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   4 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 533 out of 533 | elapsed:    0.2s finished
Got subclusters: Counter({0: 151, 1: 135, 2: 95, 3: 94, 4: 89, 5: 84, 6: 54})
On pattern 6
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 533 samples in 0.004s...
[t-SNE] Computed neighbors for 533 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 533 / 533
[t-SNE] Mean sigma: 0.343160
[t-SNE] Computed conditional probabilities in 0.036s
[t-SNE] Iteration 50: error = 69.3246460, gradient norm = 0.4423612 (50 iterations in 0.066s)
[t-SNE] Iteration 100: error = 69.4573212, gradient norm = 0.4307532 (50 iterations in 0.054s)
[t-SNE] Iteration 150: error = 70.9710388, gradient norm = 0.4154048 (50 iterations in 0.054s)
[t-SNE] Iteration 200: error = 71.5958557, gradient norm = 0.4207699 (50 iterations in 0.055s)
[t-SNE] Iteration 250: error = 72.4899521, gradient norm = 0.4152697 (50 iterations in 0.054s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 72.489952
[t-SNE] Iteration 300: error = 1.4376894, gradient norm = 0.0028582 (50 iterations in 0.051s)
[t-SNE] Iteration 350: error = 1.3802838, gradient norm = 0.0009136 (50 iterations in 0.050s)
[t-SNE] Iteration 400: error = 1.3521876, gradient norm = 0.0007530 (50 iterations in 0.051s)
[t-SNE] Iteration 450: error = 1.3412981, gradient norm = 0.0004754 (50 iterations in 0.050s)
[t-SNE] Iteration 500: error = 1.3229088, gradient norm = 0.0006941 (50 iterations in 0.050s)
[t-SNE] Iteration 550: error = 1.3197699, gradient norm = 0.0003303 (50 iterations in 0.050s)
[t-SNE] Iteration 600: error = 1.3168389, gradient norm = 0.0001408 (50 iterations in 0.051s)
[t-SNE] Iteration 650: error = 1.3163298, gradient norm = 0.0000807 (50 iterations in 0.050s)
[t-SNE] Iteration 700: error = 1.3159542, gradient norm = 0.0000936 (50 iterations in 0.050s)
[t-SNE] Iteration 750: error = 1.3148030, gradient norm = 0.0002626 (50 iterations in 0.050s)
[t-SNE] Iteration 800: error = 1.3124425, gradient norm = 0.0001384 (50 iterations in 0.050s)
[t-SNE] Iteration 850: error = 1.3117721, gradient norm = 0.0000811 (50 iterations in 0.050s)
[t-SNE] Iteration 900: error = 1.3115791, gradient norm = 0.0001424 (50 iterations in 0.050s)
[t-SNE] Iteration 950: error = 1.3076090, gradient norm = 0.0003972 (50 iterations in 0.050s)
[t-SNE] Iteration 1000: error = 1.3057600, gradient norm = 0.0001889 (50 iterations in 0.050s)
[t-SNE] KL divergence after 1000 iterations: 1.305760
[t-SNE] Computed conditional probabilities for sample 533 / 533
[t-SNE] Mean sigma: 0.343160
Beginning preprocessing + Leiden
2024-03-13 20:50:28.510394 MEMORY 17.938382848
Affmat transformed
2024-03-13 20:50:28.517218 MEMORY 17.938382848
sources, targets, weights extracted
2024-03-13 20:50:28.520861 MEMORY 17.938382848
About to launch parallel Leiden runs
2024-03-13 20:50:28.543433 MEMORY 17.938382848
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.9s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    3.9s finished
Parallel Leiden runs finished
2024-03-13 20:50:32.402510 MEMORY 17.938382848
Quality: 0.3962836402296206
Quality: 0.3971227202690956
Quality: 0.3972603749086503
Quality: 0.3974957634138598
Quality: 0.39902699299672
Quality: 0.3991433328217447
Quality: 0.399458750178044
Quality: 0.40061993647733957
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   3 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 345 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 453 out of 453 | elapsed:    0.2s finished
Got subclusters: Counter({0: 141, 1: 107, 2: 78, 3: 59, 4: 54, 5: 47, 6: 47})
On pattern 7
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 453 samples in 0.003s...
[t-SNE] Computed neighbors for 453 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 453 / 453
[t-SNE] Mean sigma: 0.359680
[t-SNE] Computed conditional probabilities in 0.031s
[t-SNE] Iteration 50: error = 66.7279739, gradient norm = 0.4695450 (50 iterations in 0.047s)
[t-SNE] Iteration 100: error = 69.5998001, gradient norm = 0.4529679 (50 iterations in 0.049s)
[t-SNE] Iteration 150: error = 69.9476395, gradient norm = 0.4497163 (50 iterations in 0.047s)
[t-SNE] Iteration 200: error = 71.2020569, gradient norm = 0.4415214 (50 iterations in 0.047s)
[t-SNE] Iteration 250: error = 70.5787506, gradient norm = 0.4486319 (50 iterations in 0.048s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 70.578751
[t-SNE] Iteration 300: error = 1.4260124, gradient norm = 0.0038757 (50 iterations in 0.045s)
[t-SNE] Iteration 350: error = 1.3499886, gradient norm = 0.0015237 (50 iterations in 0.048s)
[t-SNE] Iteration 400: error = 1.3197132, gradient norm = 0.0008549 (50 iterations in 0.045s)
[t-SNE] Iteration 450: error = 1.3095578, gradient norm = 0.0009708 (50 iterations in 0.045s)
[t-SNE] Iteration 500: error = 1.2946835, gradient norm = 0.0005547 (50 iterations in 0.047s)
[t-SNE] Iteration 550: error = 1.2938542, gradient norm = 0.0000803 (50 iterations in 0.045s)
[t-SNE] Iteration 600: error = 1.2938350, gradient norm = 0.0000802 (50 iterations in 0.045s)
[t-SNE] Iteration 650: error = 1.2935240, gradient norm = 0.0000920 (50 iterations in 0.045s)
[t-SNE] Iteration 700: error = 1.2924463, gradient norm = 0.0003687 (50 iterations in 0.045s)
[t-SNE] Iteration 750: error = 1.2922385, gradient norm = 0.0000896 (50 iterations in 0.045s)
[t-SNE] Iteration 800: error = 1.2921814, gradient norm = 0.0000727 (50 iterations in 0.048s)
[t-SNE] Iteration 850: error = 1.2922282, gradient norm = 0.0000767 (50 iterations in 0.045s)
[t-SNE] Iteration 900: error = 1.2921718, gradient norm = 0.0000553 (50 iterations in 0.047s)
[t-SNE] Iteration 950: error = 1.2922883, gradient norm = 0.0000572 (50 iterations in 0.045s)
[t-SNE] Iteration 1000: error = 1.2922418, gradient norm = 0.0000474 (50 iterations in 0.045s)
[t-SNE] KL divergence after 1000 iterations: 1.292242
[t-SNE] Computed conditional probabilities for sample 453 / 453
[t-SNE] Mean sigma: 0.359681
Beginning preprocessing + Leiden
2024-03-13 20:50:34.129705 MEMORY 17.938382848
Affmat transformed
2024-03-13 20:50:34.135618 MEMORY 17.938382848
sources, targets, weights extracted
2024-03-13 20:50:34.138549 MEMORY 17.938382848
About to launch parallel Leiden runs
2024-03-13 20:50:34.185137 MEMORY 17.938382848
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.8s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    3.4s finished
Parallel Leiden runs finished
2024-03-13 20:50:37.582757 MEMORY 17.938382848
Quality: 0.38895181259055484
Quality: 0.3889594395376603
Quality: 0.3890169341335142
Quality: 0.3908028892648578
Quality: 0.3908153248000954
Quality: 0.3910637518405384
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   6 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 280 out of 280 | elapsed:    0.1s finished
Got subclusters: Counter({0: 97, 1: 88, 2: 79, 3: 67, 4: 59, 5: 56, 6: 7})
On pattern 8
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 280 samples in 0.002s...
[t-SNE] Computed neighbors for 280 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 280 / 280
[t-SNE] Mean sigma: 0.312047
[t-SNE] Computed conditional probabilities in 0.019s
[t-SNE] Iteration 50: error = 60.5048828, gradient norm = 0.5278723 (50 iterations in 0.036s)
[t-SNE] Iteration 100: error = 61.7733154, gradient norm = 0.5297670 (50 iterations in 0.038s)
[t-SNE] Iteration 150: error = 63.9892845, gradient norm = 0.4623753 (50 iterations in 0.036s)
[t-SNE] Iteration 200: error = 61.5367775, gradient norm = 0.4774199 (50 iterations in 0.036s)
[t-SNE] Iteration 250: error = 59.4631615, gradient norm = 0.5150120 (50 iterations in 0.036s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 59.463161
[t-SNE] Iteration 300: error = 0.8382254, gradient norm = 0.0050919 (50 iterations in 0.034s)
[t-SNE] Iteration 350: error = 0.7145550, gradient norm = 0.0027652 (50 iterations in 0.034s)
[t-SNE] Iteration 400: error = 0.6460825, gradient norm = 0.0026724 (50 iterations in 0.034s)
[t-SNE] Iteration 450: error = 0.6106284, gradient norm = 0.0024384 (50 iterations in 0.034s)
[t-SNE] Iteration 500: error = 0.6087357, gradient norm = 0.0002430 (50 iterations in 0.034s)
[t-SNE] Iteration 550: error = 0.6086702, gradient norm = 0.0000338 (50 iterations in 0.034s)
[t-SNE] Iteration 600: error = 0.6087005, gradient norm = 0.0000357 (50 iterations in 0.034s)
[t-SNE] Iteration 650: error = 0.6086906, gradient norm = 0.0000337 (50 iterations in 0.034s)
[t-SNE] Iteration 700: error = 0.6086814, gradient norm = 0.0000477 (50 iterations in 0.034s)
[t-SNE] Iteration 750: error = 0.6086848, gradient norm = 0.0000482 (50 iterations in 0.034s)
[t-SNE] Iteration 800: error = 0.6086947, gradient norm = 0.0000543 (50 iterations in 0.034s)
[t-SNE] Iteration 850: error = 0.6087074, gradient norm = 0.0000614 (50 iterations in 0.034s)
[t-SNE] Iteration 900: error = 0.6087139, gradient norm = 0.0000548 (50 iterations in 0.034s)
[t-SNE] Iteration 900: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 900 iterations: 0.608714
[t-SNE] Computed conditional probabilities for sample 280 / 280
[t-SNE] Mean sigma: 0.312047
Beginning preprocessing + Leiden
2024-03-13 20:50:38.697733 MEMORY 17.938382848
Affmat transformed
2024-03-13 20:50:38.701585 MEMORY 17.938382848
sources, targets, weights extracted
2024-03-13 20:50:38.703564 MEMORY 17.938382848
About to launch parallel Leiden runs
2024-03-13 20:50:38.755286 MEMORY 17.938382848
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.4s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.4s finished
Parallel Leiden runs finished
2024-03-13 20:50:41.179320 MEMORY 17.938382848
Quality: 0.4041587768894503
Quality: 0.404529174822403
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   3 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 276 out of 276 | elapsed:    0.1s finished
Got subclusters: Counter({0: 87, 1: 76, 2: 58, 3: 45, 4: 8, 5: 3, 6: 3})
On pattern 9
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 276 samples in 0.002s...
[t-SNE] Computed neighbors for 276 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 276 / 276
[t-SNE] Mean sigma: 0.361317
[t-SNE] Computed conditional probabilities in 0.018s
[t-SNE] Iteration 50: error = 65.6281815, gradient norm = 0.4735838 (50 iterations in 0.035s)
[t-SNE] Iteration 100: error = 65.5903625, gradient norm = 0.4794948 (50 iterations in 0.035s)
[t-SNE] Iteration 150: error = 65.9307709, gradient norm = 0.4951604 (50 iterations in 0.038s)
[t-SNE] Iteration 200: error = 63.1665726, gradient norm = 0.5135408 (50 iterations in 0.036s)
[t-SNE] Iteration 250: error = 65.2940826, gradient norm = 0.5193557 (50 iterations in 0.036s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 65.294083
[t-SNE] Iteration 300: error = 1.2205899, gradient norm = 0.0054963 (50 iterations in 0.035s)
[t-SNE] Iteration 350: error = 1.0343406, gradient norm = 0.0052038 (50 iterations in 0.035s)
[t-SNE] Iteration 400: error = 0.9635679, gradient norm = 0.0016059 (50 iterations in 0.034s)
[t-SNE] Iteration 450: error = 0.9252273, gradient norm = 0.0010314 (50 iterations in 0.034s)
[t-SNE] Iteration 500: error = 0.9170389, gradient norm = 0.0005985 (50 iterations in 0.033s)
[t-SNE] Iteration 550: error = 0.8869200, gradient norm = 0.0022329 (50 iterations in 0.035s)
[t-SNE] Iteration 600: error = 0.8826094, gradient norm = 0.0003956 (50 iterations in 0.034s)
[t-SNE] Iteration 650: error = 0.8813079, gradient norm = 0.0003870 (50 iterations in 0.033s)
[t-SNE] Iteration 700: error = 0.8805231, gradient norm = 0.0001583 (50 iterations in 0.034s)
[t-SNE] Iteration 750: error = 0.8804212, gradient norm = 0.0001401 (50 iterations in 0.033s)
[t-SNE] Iteration 800: error = 0.8801029, gradient norm = 0.0001125 (50 iterations in 0.034s)
[t-SNE] Iteration 850: error = 0.8802478, gradient norm = 0.0000882 (50 iterations in 0.033s)
[t-SNE] Iteration 900: error = 0.8802248, gradient norm = 0.0001265 (50 iterations in 0.033s)
[t-SNE] Iteration 950: error = 0.8803360, gradient norm = 0.0001088 (50 iterations in 0.035s)
[t-SNE] Iteration 1000: error = 0.8802750, gradient norm = 0.0001097 (50 iterations in 0.033s)
[t-SNE] KL divergence after 1000 iterations: 0.880275
[t-SNE] Computed conditional probabilities for sample 276 / 276
[t-SNE] Mean sigma: 0.361318
Beginning preprocessing + Leiden
2024-03-13 20:50:42.308063 MEMORY 17.938382848
Affmat transformed
2024-03-13 20:50:42.311639 MEMORY 17.938382848
sources, targets, weights extracted
2024-03-13 20:50:42.313367 MEMORY 17.938382848
About to launch parallel Leiden runs
2024-03-13 20:50:42.353653 MEMORY 17.938382848
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.4s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.5s finished
Parallel Leiden runs finished
2024-03-13 20:50:44.856738 MEMORY 17.938382848
Quality: 0.327730972177639
Quality: 0.3289868143062992
Quality: 0.32966884661365387
Quality: 0.3297488378733493
Quality: 0.3298443284947142
Quality: 0.3298715686879468
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   3 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 238 out of 238 | elapsed:    0.1s finished
Got subclusters: Counter({0: 77, 1: 65, 2: 60, 3: 39, 4: 35})
On pattern 10
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 238 samples in 0.002s...
[t-SNE] Computed neighbors for 238 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 238 / 238
[t-SNE] Mean sigma: 0.380362
[t-SNE] Computed conditional probabilities in 0.016s
[t-SNE] Iteration 50: error = 61.8309784, gradient norm = 0.4637295 (50 iterations in 0.035s)
[t-SNE] Iteration 100: error = 62.5604744, gradient norm = 0.4937389 (50 iterations in 0.032s)
[t-SNE] Iteration 150: error = 59.9091301, gradient norm = 0.5048210 (50 iterations in 0.033s)
[t-SNE] Iteration 200: error = 62.4035339, gradient norm = 0.5058768 (50 iterations in 0.035s)
[t-SNE] Iteration 250: error = 63.4916306, gradient norm = 0.4592224 (50 iterations in 0.031s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 63.491631
[t-SNE] Iteration 300: error = 0.9967722, gradient norm = 0.0068906 (50 iterations in 0.031s)
[t-SNE] Iteration 350: error = 0.8429772, gradient norm = 0.0052218 (50 iterations in 0.031s)
[t-SNE] Iteration 400: error = 0.8177487, gradient norm = 0.0008783 (50 iterations in 0.034s)
[t-SNE] Iteration 450: error = 0.8170683, gradient norm = 0.0002490 (50 iterations in 0.032s)
[t-SNE] Iteration 500: error = 0.8167364, gradient norm = 0.0001407 (50 iterations in 0.032s)
[t-SNE] Iteration 550: error = 0.8166286, gradient norm = 0.0000959 (50 iterations in 0.032s)
[t-SNE] Iteration 600: error = 0.8168393, gradient norm = 0.0001112 (50 iterations in 0.031s)
[t-SNE] Iteration 650: error = 0.8166510, gradient norm = 0.0000693 (50 iterations in 0.031s)
[t-SNE] Iteration 700: error = 0.8166823, gradient norm = 0.0000829 (50 iterations in 0.031s)
[t-SNE] Iteration 750: error = 0.8166655, gradient norm = 0.0000891 (50 iterations in 0.031s)
[t-SNE] Iteration 800: error = 0.8166900, gradient norm = 0.0000782 (50 iterations in 0.032s)
[t-SNE] Iteration 850: error = 0.8166864, gradient norm = 0.0000655 (50 iterations in 0.031s)
[t-SNE] Iteration 900: error = 0.8166932, gradient norm = 0.0000411 (50 iterations in 0.031s)
[t-SNE] Iteration 900: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 900 iterations: 0.816693
[t-SNE] Computed conditional probabilities for sample 238 / 238
[t-SNE] Mean sigma: 0.380362
Beginning preprocessing + Leiden
2024-03-13 20:50:45.851230 MEMORY 17.938386944
Affmat transformed
2024-03-13 20:50:45.854425 MEMORY 17.938386944
sources, targets, weights extracted
2024-03-13 20:50:45.855834 MEMORY 17.938386944
About to launch parallel Leiden runs
2024-03-13 20:50:45.911966 MEMORY 17.938386944
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.4s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.2s finished
Parallel Leiden runs finished
2024-03-13 20:50:48.161818 MEMORY 17.938386944
Quality: 0.3662066751401452
Quality: 0.3662925655505397
Quality: 0.36668642777348953
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   3 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 212 out of 212 | elapsed:    0.1s finished
Got subclusters: Counter({0: 67, 2: 45, 1: 45, 3: 34, 4: 28, 5: 16, 6: 3})
On pattern 11
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 212 samples in 0.002s...
[t-SNE] Computed neighbors for 212 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 212 / 212
[t-SNE] Mean sigma: 0.391728
[t-SNE] Computed conditional probabilities in 0.014s
[t-SNE] Iteration 50: error = 63.7860718, gradient norm = 0.5215394 (50 iterations in 0.029s)
[t-SNE] Iteration 100: error = 64.3060608, gradient norm = 0.4727567 (50 iterations in 0.029s)
[t-SNE] Iteration 150: error = 61.4265900, gradient norm = 0.4830181 (50 iterations in 0.029s)
[t-SNE] Iteration 200: error = 62.2437325, gradient norm = 0.4936873 (50 iterations in 0.029s)
[t-SNE] Iteration 250: error = 59.4481812, gradient norm = 0.5339276 (50 iterations in 0.028s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 59.448181
[t-SNE] Iteration 300: error = 0.9441873, gradient norm = 0.0040849 (50 iterations in 0.028s)
[t-SNE] Iteration 350: error = 0.8045573, gradient norm = 0.0033133 (50 iterations in 0.027s)
[t-SNE] Iteration 400: error = 0.7689549, gradient norm = 0.0011028 (50 iterations in 0.028s)
[t-SNE] Iteration 450: error = 0.7613786, gradient norm = 0.0014821 (50 iterations in 0.028s)
[t-SNE] Iteration 500: error = 0.7571384, gradient norm = 0.0004628 (50 iterations in 0.028s)
[t-SNE] Iteration 550: error = 0.7572875, gradient norm = 0.0001530 (50 iterations in 0.027s)
[t-SNE] Iteration 600: error = 0.7572778, gradient norm = 0.0003296 (50 iterations in 0.027s)
[t-SNE] Iteration 650: error = 0.7565547, gradient norm = 0.0003163 (50 iterations in 0.028s)
[t-SNE] Iteration 700: error = 0.7492211, gradient norm = 0.0004050 (50 iterations in 0.028s)
[t-SNE] Iteration 750: error = 0.7494178, gradient norm = 0.0001222 (50 iterations in 0.027s)
[t-SNE] Iteration 800: error = 0.7492745, gradient norm = 0.0001258 (50 iterations in 0.027s)
[t-SNE] Iteration 850: error = 0.7493168, gradient norm = 0.0001701 (50 iterations in 0.028s)
[t-SNE] Iteration 900: error = 0.7492114, gradient norm = 0.0001346 (50 iterations in 0.028s)
[t-SNE] Iteration 950: error = 0.7492350, gradient norm = 0.0001281 (50 iterations in 0.028s)
[t-SNE] Iteration 1000: error = 0.7491724, gradient norm = 0.0000593 (50 iterations in 0.027s)
[t-SNE] KL divergence after 1000 iterations: 0.749172
[t-SNE] Computed conditional probabilities for sample 212 / 212
[t-SNE] Mean sigma: 0.391728
Beginning preprocessing + Leiden
2024-03-13 20:50:49.082588 MEMORY 17.938386944
Affmat transformed
2024-03-13 20:50:49.085519 MEMORY 17.938386944
sources, targets, weights extracted
2024-03-13 20:50:49.086647 MEMORY 17.938386944
About to launch parallel Leiden runs
2024-03-13 20:50:49.135885 MEMORY 17.938386944
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.3s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.1s finished
Parallel Leiden runs finished
2024-03-13 20:50:51.283178 MEMORY 17.938386944
Quality: 0.3173498919565045
Quality: 0.3178749717086991
Quality: 0.3207026879752964
Quality: 0.3212043640074246
Quality: 0.32156134439471373
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   4 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 194 out of 194 | elapsed:    0.1s finished
Got subclusters: Counter({0: 51, 1: 50, 2: 44, 3: 32, 4: 27, 5: 8})
On pattern 12
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 194 samples in 0.002s...
[t-SNE] Computed neighbors for 194 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 194 / 194
[t-SNE] Mean sigma: 0.379982
[t-SNE] Computed conditional probabilities in 0.013s
[t-SNE] Iteration 50: error = 60.4876251, gradient norm = 0.4956118 (50 iterations in 0.031s)
[t-SNE] Iteration 100: error = 63.9094582, gradient norm = 0.4872664 (50 iterations in 0.027s)
[t-SNE] Iteration 150: error = 64.9839096, gradient norm = 0.4781481 (50 iterations in 0.027s)
[t-SNE] Iteration 200: error = 61.8784866, gradient norm = 0.4840891 (50 iterations in 0.030s)
[t-SNE] Iteration 250: error = 62.8832169, gradient norm = 0.4884764 (50 iterations in 0.028s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 62.883217
[t-SNE] Iteration 300: error = 1.0373898, gradient norm = 0.0067351 (50 iterations in 0.028s)
[t-SNE] Iteration 350: error = 0.6698571, gradient norm = 0.0083026 (50 iterations in 0.029s)
[t-SNE] Iteration 400: error = 0.6554980, gradient norm = 0.0004973 (50 iterations in 0.027s)
[t-SNE] Iteration 450: error = 0.6523240, gradient norm = 0.0003691 (50 iterations in 0.027s)
[t-SNE] Iteration 500: error = 0.6523244, gradient norm = 0.0002416 (50 iterations in 0.027s)
[t-SNE] Iteration 550: error = 0.6524322, gradient norm = 0.0002287 (50 iterations in 0.027s)
[t-SNE] Iteration 600: error = 0.6523787, gradient norm = 0.0002255 (50 iterations in 0.027s)
[t-SNE] Iteration 650: error = 0.6523780, gradient norm = 0.0002389 (50 iterations in 0.029s)
[t-SNE] Iteration 700: error = 0.6524646, gradient norm = 0.0002460 (50 iterations in 0.027s)
[t-SNE] Iteration 750: error = 0.6523848, gradient norm = 0.0002590 (50 iterations in 0.027s)
[t-SNE] Iteration 800: error = 0.6522991, gradient norm = 0.0002361 (50 iterations in 0.027s)
[t-SNE] Iteration 850: error = 0.6525797, gradient norm = 0.0003104 (50 iterations in 0.029s)
[t-SNE] Iteration 900: error = 0.6524895, gradient norm = 0.0002686 (50 iterations in 0.027s)
[t-SNE] Iteration 950: error = 0.6524392, gradient norm = 0.0001986 (50 iterations in 0.027s)
[t-SNE] Iteration 1000: error = 0.6523665, gradient norm = 0.0002882 (50 iterations in 0.027s)
[t-SNE] KL divergence after 1000 iterations: 0.652366
[t-SNE] Computed conditional probabilities for sample 194 / 194
[t-SNE] Mean sigma: 0.379982
Beginning preprocessing + Leiden
2024-03-13 20:50:52.173620 MEMORY 17.938386944
Affmat transformed
2024-03-13 20:50:52.176285 MEMORY 17.938386944
sources, targets, weights extracted
2024-03-13 20:50:52.177341 MEMORY 17.938386944
About to launch parallel Leiden runs
2024-03-13 20:50:52.236546 MEMORY 17.938386944
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.3s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.2s finished
Parallel Leiden runs finished
2024-03-13 20:50:54.452016 MEMORY 17.938386944
Quality: 0.27482626957482126
Quality: 0.27550338734728513
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   3 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 186 out of 186 | elapsed:    0.1s finished
Got subclusters: Counter({0: 48, 1: 37, 2: 35, 3: 32, 4: 27, 5: 15})
On pattern 13
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 186 samples in 0.002s...
[t-SNE] Computed neighbors for 186 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 186 / 186
[t-SNE] Mean sigma: 0.430214
[t-SNE] Computed conditional probabilities in 0.012s
[t-SNE] Iteration 50: error = 61.3475037, gradient norm = 0.4799410 (50 iterations in 0.057s)
[t-SNE] Iteration 100: error = 59.2573204, gradient norm = 0.4984483 (50 iterations in 0.028s)
[t-SNE] Iteration 150: error = 59.1734924, gradient norm = 0.4926232 (50 iterations in 0.028s)
[t-SNE] Iteration 200: error = 58.8712769, gradient norm = 0.5031294 (50 iterations in 0.028s)
[t-SNE] Iteration 250: error = 59.9970398, gradient norm = 0.4977175 (50 iterations in 0.028s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 59.997040
[t-SNE] Iteration 300: error = 0.9918043, gradient norm = 0.0068546 (50 iterations in 0.030s)
[t-SNE] Iteration 350: error = 0.7504166, gradient norm = 0.0044309 (50 iterations in 0.030s)
[t-SNE] Iteration 400: error = 0.6975400, gradient norm = 0.0031709 (50 iterations in 0.030s)
[t-SNE] Iteration 450: error = 0.6597795, gradient norm = 0.0017645 (50 iterations in 0.029s)
[t-SNE] Iteration 500: error = 0.6596570, gradient norm = 0.0001670 (50 iterations in 0.029s)
[t-SNE] Iteration 550: error = 0.6597264, gradient norm = 0.0001603 (50 iterations in 0.029s)
[t-SNE] Iteration 600: error = 0.6596988, gradient norm = 0.0001911 (50 iterations in 0.029s)
[t-SNE] Iteration 650: error = 0.6596436, gradient norm = 0.0001919 (50 iterations in 0.029s)
[t-SNE] Iteration 700: error = 0.6597663, gradient norm = 0.0001866 (50 iterations in 0.029s)
[t-SNE] Iteration 750: error = 0.6597086, gradient norm = 0.0001687 (50 iterations in 0.029s)
[t-SNE] Iteration 800: error = 0.6596550, gradient norm = 0.0001691 (50 iterations in 0.029s)
[t-SNE] Iteration 850: error = 0.6596030, gradient norm = 0.0002084 (50 iterations in 0.029s)
[t-SNE] Iteration 900: error = 0.6596875, gradient norm = 0.0002163 (50 iterations in 0.030s)
[t-SNE] Iteration 950: error = 0.6596596, gradient norm = 0.0001598 (50 iterations in 0.029s)
[t-SNE] Iteration 1000: error = 0.6597207, gradient norm = 0.0002076 (50 iterations in 0.028s)
[t-SNE] KL divergence after 1000 iterations: 0.659721
[t-SNE] Computed conditional probabilities for sample 186 / 186
[t-SNE] Mean sigma: 0.430214
Beginning preprocessing + Leiden
2024-03-13 20:50:55.374846 MEMORY 17.938386944
Affmat transformed
2024-03-13 20:50:55.377487 MEMORY 17.938386944
sources, targets, weights extracted
2024-03-13 20:50:55.378518 MEMORY 17.938386944
About to launch parallel Leiden runs
2024-03-13 20:50:55.411819 MEMORY 17.938386944
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.3s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.1s finished
Parallel Leiden runs finished
2024-03-13 20:50:57.518116 MEMORY 17.938386944
Quality: 0.3294198110508889
Quality: 0.33140103996319675
Quality: 0.33330824754737776
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   3 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 142 out of 142 | elapsed:    0.1s finished
Got subclusters: Counter({0: 57, 1: 45, 2: 38, 3: 35, 4: 11})
On pattern 14
[t-SNE] Computing 141 nearest neighbors...
[t-SNE] Indexed 142 samples in 0.001s...
[t-SNE] Computed neighbors for 142 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 142 / 142
[t-SNE] Mean sigma: 0.450719
[t-SNE] Computed conditional probabilities in 0.009s
[t-SNE] Iteration 50: error = 58.0839539, gradient norm = 0.4769116 (50 iterations in 0.028s)
[t-SNE] Iteration 100: error = 56.1257401, gradient norm = 0.4686129 (50 iterations in 0.024s)
[t-SNE] Iteration 150: error = 53.3441811, gradient norm = 0.5463277 (50 iterations in 0.024s)
[t-SNE] Iteration 200: error = 56.5137520, gradient norm = 0.4750251 (50 iterations in 0.025s)
[t-SNE] Iteration 250: error = 57.1564713, gradient norm = 0.4525353 (50 iterations in 0.027s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 57.156471
[t-SNE] Iteration 300: error = 0.6784052, gradient norm = 0.0081151 (50 iterations in 0.024s)
[t-SNE] Iteration 350: error = 0.4039748, gradient norm = 0.0067640 (50 iterations in 0.024s)
[t-SNE] Iteration 400: error = 0.3947850, gradient norm = 0.0003126 (50 iterations in 0.024s)
[t-SNE] Iteration 450: error = 0.3949010, gradient norm = 0.0003515 (50 iterations in 0.024s)
[t-SNE] Iteration 500: error = 0.3947693, gradient norm = 0.0002539 (50 iterations in 0.024s)
[t-SNE] Iteration 550: error = 0.3948880, gradient norm = 0.0003535 (50 iterations in 0.024s)
[t-SNE] Iteration 600: error = 0.3947410, gradient norm = 0.0003014 (50 iterations in 0.024s)
[t-SNE] Iteration 650: error = 0.3948766, gradient norm = 0.0001972 (50 iterations in 0.024s)
[t-SNE] Iteration 700: error = 0.3947187, gradient norm = 0.0002349 (50 iterations in 0.024s)
[t-SNE] Iteration 750: error = 0.3947937, gradient norm = 0.0002820 (50 iterations in 0.024s)
[t-SNE] Iteration 800: error = 0.3946590, gradient norm = 0.0002671 (50 iterations in 0.024s)
[t-SNE] Iteration 850: error = 0.3946853, gradient norm = 0.0002432 (50 iterations in 0.024s)
[t-SNE] Iteration 900: error = 0.3947430, gradient norm = 0.0002713 (50 iterations in 0.024s)
[t-SNE] Iteration 950: error = 0.3947568, gradient norm = 0.0002112 (50 iterations in 0.024s)
[t-SNE] Iteration 1000: error = 0.3948535, gradient norm = 0.0002158 (50 iterations in 0.024s)
[t-SNE] KL divergence after 1000 iterations: 0.394854
[t-SNE] Computed conditional probabilities for sample 142 / 142
[t-SNE] Mean sigma: 0.450719
Beginning preprocessing + Leiden
2024-03-13 20:50:58.241274 MEMORY 17.938386944
Affmat transformed
2024-03-13 20:50:58.243292 MEMORY 17.938386944
sources, targets, weights extracted
2024-03-13 20:50:58.244077 MEMORY 17.938386944
About to launch parallel Leiden runs
2024-03-13 20:50:58.304130 MEMORY 17.938386944
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.2s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.9s finished
Parallel Leiden runs finished
2024-03-13 20:51:00.229062 MEMORY 17.938386944
Quality: 0.3262396124346658
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   4 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 112 out of 112 | elapsed:    0.1s finished
Got subclusters: Counter({0: 43, 1: 39, 2: 38, 3: 22})
On pattern 15
[t-SNE] Computing 111 nearest neighbors...
[t-SNE] Indexed 112 samples in 0.001s...
[t-SNE] Computed neighbors for 112 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 112 / 112
[t-SNE] Mean sigma: 0.442982
[t-SNE] Computed conditional probabilities in 0.006s
[t-SNE] Iteration 50: error = 54.4945068, gradient norm = 0.5665936 (50 iterations in 0.020s)
[t-SNE] Iteration 100: error = 59.8685875, gradient norm = 0.4713348 (50 iterations in 0.020s)
[t-SNE] Iteration 150: error = 54.4078598, gradient norm = 0.4523921 (50 iterations in 0.019s)
[t-SNE] Iteration 200: error = 57.3758125, gradient norm = 0.5752723 (50 iterations in 0.020s)
[t-SNE] Iteration 250: error = 59.0315514, gradient norm = 0.4927007 (50 iterations in 0.020s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 59.031551
[t-SNE] Iteration 300: error = 0.9143934, gradient norm = 0.0073418 (50 iterations in 0.020s)
[t-SNE] Iteration 350: error = 0.6361970, gradient norm = 0.0155230 (50 iterations in 0.020s)
[t-SNE] Iteration 400: error = 0.3356320, gradient norm = 0.0037081 (50 iterations in 0.020s)
[t-SNE] Iteration 450: error = 0.3344982, gradient norm = 0.0005131 (50 iterations in 0.020s)
[t-SNE] Iteration 500: error = 0.3346136, gradient norm = 0.0006178 (50 iterations in 0.020s)
[t-SNE] Iteration 550: error = 0.3345978, gradient norm = 0.0006350 (50 iterations in 0.020s)
[t-SNE] Iteration 600: error = 0.3344540, gradient norm = 0.0005410 (50 iterations in 0.020s)
[t-SNE] Iteration 650: error = 0.3346793, gradient norm = 0.0008517 (50 iterations in 0.020s)
[t-SNE] Iteration 700: error = 0.3346138, gradient norm = 0.0006045 (50 iterations in 0.020s)
[t-SNE] Iteration 750: error = 0.3348101, gradient norm = 0.0007226 (50 iterations in 0.020s)
[t-SNE] Iteration 800: error = 0.3346731, gradient norm = 0.0005510 (50 iterations in 0.020s)
[t-SNE] Iteration 850: error = 0.3345769, gradient norm = 0.0004741 (50 iterations in 0.020s)
[t-SNE] Iteration 900: error = 0.3345734, gradient norm = 0.0005105 (50 iterations in 0.020s)
[t-SNE] Iteration 950: error = 0.3346082, gradient norm = 0.0007537 (50 iterations in 0.020s)
[t-SNE] Iteration 950: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 950 iterations: 0.334608
[t-SNE] Computed conditional probabilities for sample 112 / 112
[t-SNE] Mean sigma: 0.442982
Beginning preprocessing + Leiden
2024-03-13 20:51:00.771629 MEMORY 17.938386944
Affmat transformed
2024-03-13 20:51:00.773078 MEMORY 17.938386944
sources, targets, weights extracted
2024-03-13 20:51:00.773663 MEMORY 17.938386944
About to launch parallel Leiden runs
2024-03-13 20:51:00.788264 MEMORY 17.938386944
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.1s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.8s finished
Parallel Leiden runs finished
2024-03-13 20:51:02.599116 MEMORY 17.938386944
Quality: 0.221829269415861
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   3 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  98 out of  98 | elapsed:    0.0s finished
Got subclusters: Counter({0: 42, 1: 35, 2: 26, 3: 9})
On pattern 16
[t-SNE] Computing 97 nearest neighbors...
[t-SNE] Indexed 98 samples in 0.001s...
[t-SNE] Computed neighbors for 98 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 98 / 98
[t-SNE] Mean sigma: 0.501895
[t-SNE] Computed conditional probabilities in 0.004s
[t-SNE] Iteration 50: error = 55.0130157, gradient norm = 0.4943377 (50 iterations in 0.018s)
[t-SNE] Iteration 100: error = 54.1675987, gradient norm = 0.5082846 (50 iterations in 0.017s)
[t-SNE] Iteration 150: error = 51.5730934, gradient norm = 0.5344179 (50 iterations in 0.017s)
[t-SNE] Iteration 200: error = 53.3626213, gradient norm = 0.5926571 (50 iterations in 0.017s)
[t-SNE] Iteration 250: error = 60.0970230, gradient norm = 0.5277172 (50 iterations in 0.017s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 60.097023
[t-SNE] Iteration 300: error = 1.0079358, gradient norm = 0.0051971 (50 iterations in 0.017s)
[t-SNE] Iteration 350: error = 0.8584256, gradient norm = 0.0020971 (50 iterations in 0.017s)
[t-SNE] Iteration 400: error = 0.7789876, gradient norm = 0.0016949 (50 iterations in 0.016s)
[t-SNE] Iteration 450: error = 0.7181697, gradient norm = 0.0014396 (50 iterations in 0.016s)
[t-SNE] Iteration 500: error = 0.6652409, gradient norm = 0.0012710 (50 iterations in 0.017s)
[t-SNE] Iteration 550: error = 0.5628437, gradient norm = 0.0055344 (50 iterations in 0.018s)
[t-SNE] Iteration 600: error = 0.2209693, gradient norm = 0.0098526 (50 iterations in 0.017s)
[t-SNE] Iteration 650: error = 0.2149978, gradient norm = 0.0044340 (50 iterations in 0.016s)
[t-SNE] Iteration 700: error = 0.2140363, gradient norm = 0.0007751 (50 iterations in 0.016s)
[t-SNE] Iteration 750: error = 0.2140343, gradient norm = 0.0008098 (50 iterations in 0.016s)
[t-SNE] Iteration 800: error = 0.2143919, gradient norm = 0.0007265 (50 iterations in 0.016s)
[t-SNE] Iteration 850: error = 0.2143283, gradient norm = 0.0009024 (50 iterations in 0.016s)
[t-SNE] Iteration 900: error = 0.2143016, gradient norm = 0.0007557 (50 iterations in 0.016s)
[t-SNE] Iteration 950: error = 0.2144597, gradient norm = 0.0007741 (50 iterations in 0.016s)
[t-SNE] Iteration 1000: error = 0.2142622, gradient norm = 0.0011316 (50 iterations in 0.016s)
[t-SNE] KL divergence after 1000 iterations: 0.214262
[t-SNE] Computed conditional probabilities for sample 98 / 98
[t-SNE] Mean sigma: 0.501895
Beginning preprocessing + Leiden
2024-03-13 20:51:03.070637 MEMORY 17.938386944
Affmat transformed
2024-03-13 20:51:03.071917 MEMORY 17.938386944
sources, targets, weights extracted
2024-03-13 20:51:03.072424 MEMORY 17.938386944
About to launch parallel Leiden runs
2024-03-13 20:51:03.113728 MEMORY 17.938386944
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.2s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.8s finished
Parallel Leiden runs finished
2024-03-13 20:51:04.957443 MEMORY 17.938386944
Quality: 0.1826336192274347
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   7 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  93 out of  93 | elapsed:    0.1s finished
Got subclusters: Counter({0: 34, 1: 31, 2: 21, 3: 12})
On pattern 17
[t-SNE] Computing 92 nearest neighbors...
[t-SNE] Indexed 93 samples in 0.001s...
[t-SNE] Computed neighbors for 93 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 93 / 93
[t-SNE] Mean sigma: 0.453405
[t-SNE] Computed conditional probabilities in 0.004s
[t-SNE] Iteration 50: error = 52.8807564, gradient norm = 0.5271533 (50 iterations in 0.017s)
[t-SNE] Iteration 100: error = 51.4090233, gradient norm = 0.5263010 (50 iterations in 0.017s)
[t-SNE] Iteration 150: error = 55.2932434, gradient norm = 0.4546342 (50 iterations in 0.017s)
[t-SNE] Iteration 200: error = 54.4315643, gradient norm = 0.5336767 (50 iterations in 0.017s)
[t-SNE] Iteration 250: error = 50.7340431, gradient norm = 0.5274656 (50 iterations in 0.017s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 50.734043
[t-SNE] Iteration 300: error = 0.7709996, gradient norm = 0.0057183 (50 iterations in 0.017s)
[t-SNE] Iteration 350: error = 0.2938812, gradient norm = 0.0184667 (50 iterations in 0.017s)
[t-SNE] Iteration 400: error = 0.2462316, gradient norm = 0.0015946 (50 iterations in 0.017s)
[t-SNE] Iteration 450: error = 0.2464109, gradient norm = 0.0005911 (50 iterations in 0.016s)
[t-SNE] Iteration 500: error = 0.2462389, gradient norm = 0.0002274 (50 iterations in 0.017s)
[t-SNE] Iteration 550: error = 0.2461811, gradient norm = 0.0003316 (50 iterations in 0.016s)
[t-SNE] Iteration 600: error = 0.2462809, gradient norm = 0.0007419 (50 iterations in 0.016s)
[t-SNE] Iteration 650: error = 0.2463456, gradient norm = 0.0004464 (50 iterations in 0.017s)
[t-SNE] Iteration 700: error = 0.2462019, gradient norm = 0.0002674 (50 iterations in 0.016s)
[t-SNE] Iteration 750: error = 0.2462016, gradient norm = 0.0003569 (50 iterations in 0.016s)
[t-SNE] Iteration 800: error = 0.2462009, gradient norm = 0.0002537 (50 iterations in 0.016s)
[t-SNE] Iteration 850: error = 0.2461936, gradient norm = 0.0003417 (50 iterations in 0.016s)
[t-SNE] Iteration 900: error = 0.2462772, gradient norm = 0.0002685 (50 iterations in 0.016s)
[t-SNE] Iteration 900: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 900 iterations: 0.246277
[t-SNE] Computed conditional probabilities for sample 93 / 93
[t-SNE] Mean sigma: 0.453405
Beginning preprocessing + Leiden
2024-03-13 20:51:05.393599 MEMORY 17.938386944
Affmat transformed
2024-03-13 20:51:05.394774 MEMORY 17.938386944
sources, targets, weights extracted
2024-03-13 20:51:05.395268 MEMORY 17.938386944
About to launch parallel Leiden runs
2024-03-13 20:51:05.424261 MEMORY 17.938386944
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.1s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.7s finished
Parallel Leiden runs finished
2024-03-13 20:51:07.152609 MEMORY 17.938386944
Quality: 0.18547419378226707
Quality: 0.18564131495811792
Quality: 0.18698539589266167
Quality: 0.18707487998227473
Got subclusters: Counter({0: 29, 1: 21, 2: 21, 3: 17, 4: 5})
