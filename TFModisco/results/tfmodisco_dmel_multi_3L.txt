/ru-auth/local/home/xwu05/.local/lib/python3.9/site-packages/pandas/core/computation/expressions.py:21: UserWarning: Pandas requires version '2.8.0' or newer of 'numexpr' (version '2.7.3' currently installed).
  from pandas.core.computation.check import NUMEXPR_INSTALLED
/ru-auth/local/home/xwu05/.local/lib/python3.9/site-packages/pandas/core/arrays/masked.py:62: UserWarning: Pandas requires version '1.3.4' or newer of 'bottleneck' (version '1.3.2' currently installed).
  from pandas.core import (
[22;0t]0;IPython: detect_peaks_scripts/run_modelMEMORY 12.616138752
On task head
Computing windowed sums on original
Generating null dist
peak(mu)= 1.6453486686741079e-06
Computing threshold
Subsampling!
For increasing = True , the minimum IR precision was 0.4651136616676146 occurring at 0.0 implying a frac_neg of 0.869556068898112
To be conservative, adjusted frac neg is 0.95
For increasing = False , the minimum IR precision was 0.4744633929317645 occurring at -1.721493170236954e-08 implying a frac_neg of 0.902817018929683
To be conservative, adjusted frac neg is 0.95
Thresholds from null dist were -1.3006952968048622  and  1.0291488807030875 with frac passing 0.017249
Passing windows frac was 0.017249 , which is below  0.03 ; adjusting
Final raw thresholds are -0.9515995459247402  and  0.9515995459247402
Final transformed thresholds are -0.9700117507144949  and  0.9700117507144949
saving plot to figures/scoredist_0.png
Got 119297 coords
On task testis
Computing windowed sums on original
Generating null dist
peak(mu)= 7.0279050084463834e-06
Computing threshold
Subsampling!
For increasing = True , the minimum IR precision was 0.4659635013830135 occurring at 0.0 implying a frac_neg of 0.8725311895155781
To be conservative, adjusted frac neg is 0.95
For increasing = False , the minimum IR precision was 0.47435812588064596 occurring at -2.0801775413303858e-08 implying a frac_neg of 0.9024359535194423
To be conservative, adjusted frac neg is 0.95
Thresholds from null dist were -2.06822287299452  and  1.73312779447512 with frac passing 0.01143
Passing windows frac was 0.01143 , which is below  0.03 ; adjusting
Final raw thresholds are -1.3955031744776671  and  1.3955031744776671
Final transformed thresholds are -0.9697931091881976  and  0.9697931091881976
saving plot to figures/scoredist_1.png
Got 126579 coords
After resolving overlaps, got 166847 seqlets
Across all tasks, the weakest transformed threshold used was: 0.9696931091881976
MEMORY 13.709037568
166847 identified in total
min_metacluster_size_frac * len(seqlets) = 1668 is more than min_metacluster_size=100.
Using it as a new min_metacluster_size
6 activity patterns with support >= 1668 out of 8 possible patterns
Metacluster sizes:  [92497, 51128, 10406, 5519, 4374, 2923]
Idx to activities:  {0: '-1,-1', 1: '1,1', 2: '-1,0', 3: '0,-1', 4: '0,1', 5: '1,0'}
MEMORY 13.70904576
On metacluster 5
Metacluster size 2923
Relevant tasks:  ('head',)
Relevant signs:  (1,)
TfModiscoSeqletsToPatternsFactory: seed=1234
(Round 1) num seqlets: 2923
(Round 1) Computing coarse affmat
2024-03-16 16:35:44.442899 MEMORY 13.70826752
Beginning embedding computation
MEMORY 13.70826752
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
At the beginning of embedding call
2024-03-16 16:35:44.443097 MEMORY 13.70826752
before computing embeddings fwd
2024-03-16 16:35:44.451736 MEMORY 13.708304384
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:   32.5s
[Parallel(n_jobs=24)]: Done 152 tasks      | elapsed:   34.4s
[Parallel(n_jobs=24)]: Done 402 tasks      | elapsed:   37.3s
[Parallel(n_jobs=24)]: Done 752 tasks      | elapsed:   41.2s
[Parallel(n_jobs=24)]: Done 1202 tasks      | elapsed:   46.1s
[Parallel(n_jobs=24)]: Done 1752 tasks      | elapsed:   52.0s
[Parallel(n_jobs=24)]: Done 2402 tasks      | elapsed:   59.0s
[Parallel(n_jobs=24)]: Done 2923 out of 2923 | elapsed:  1.1min finished
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 152 tasks      | elapsed:    1.8s
[Parallel(n_jobs=24)]: Done 402 tasks      | elapsed:    4.6s
[Parallel(n_jobs=24)]: Done 752 tasks      | elapsed:    8.4s
[Parallel(n_jobs=24)]: Done 1202 tasks      | elapsed:   13.3s
[Parallel(n_jobs=24)]: Done 1752 tasks      | elapsed:   19.3s
[Parallel(n_jobs=24)]: Done 2402 tasks      | elapsed:   26.5s
[Parallel(n_jobs=24)]: Done 2923 out of 2923 | elapsed:   32.1s finished
after computing embeddings fwd
2024-03-16 16:36:49.565177 MEMORY 13.815681024
after computing embeddings rev
2024-03-16 16:37:21.671835 MEMORY 13.93528832
before computing sparse embeddings fwd
2024-03-16 16:37:21.671920 MEMORY 13.93528832
Constructing csr matrix...
csr matrix made in 0.5174829959869385 s
after computing sparse embeddings fwd
2024-03-16 16:37:22.360640 MEMORY 13.935427584
before computing sparse embeddings rev
2024-03-16 16:37:22.360713 MEMORY 13.935427584
Constructing csr matrix...
csr matrix made in 0.32326412200927734 s
after computing sparse embeddings rev
2024-03-16 16:37:22.821164 MEMORY 13.93547264
Finished embedding computation in 99.3 s
MEMORY 13.807714304
Starting affinity matrix computations
MEMORY 13.807714304
Batching in slices of size 2923
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:01<00:00,  1.95s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:01<00:00,  1.98s/it]
Finished affinity matrix computations in 2.07 s
MEMORY 13.807853568
(Round 1) Computed coarse affmat
2024-03-16 16:37:26.538194 MEMORY 13.807874048
(Round 1) Computing affinity matrix on nearest neighbors
2024-03-16 16:37:26.538335 MEMORY 13.807874048
Launching nearest neighbors affmat calculation job
MEMORY 13.807874048
Parallel runs completed
MEMORY 13.915164672
Job completed in: 9.52 s
MEMORY 13.916512256
Launching nearest neighbors affmat calculation job
MEMORY 13.917290496
Parallel runs completed
MEMORY 13.97221376
Job completed in: 9.22 s
MEMORY 13.972099072
(Round 1) Computed affinity matrix on nearest neighbors in 19.88 s
2024-03-16 16:37:46.417444 MEMORY 13.971931136
Filtered down to 2846 of 2923
(Round 1) Retained 2846 rows out of 2923 after filtering
2024-03-16 16:37:48.107032 MEMORY 13.974216704
(Round 1) Computing density adapted affmat
2024-03-16 16:37:49.321867 MEMORY 14.000410624
Symmetrizing nearest neighbors
Computing betas for density adaptation
Computing normalizing denominators
(Round 1) Computing clustering
2024-03-16 16:38:09.778659 MEMORY 13.87851776
Beginning preprocessing + Leiden
2024-03-16 16:38:09.782254 MEMORY 13.87851776
Affmat transformed
2024-03-16 16:38:09.782376 MEMORY 13.87851776
sources, targets, weights extracted
2024-03-16 16:38:09.927415 MEMORY 13.87853824
About to launch parallel Leiden runs
2024-03-16 16:38:09.954592 MEMORY 13.87853824
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:   10.3s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   37.6s finished
Parallel Leiden runs finished
2024-03-16 16:38:47.592788 MEMORY 13.879697408
Quality: 0.2311812013008833
Quality: 0.2346929350041333
Got 4 clusters after round 1
Counts:
{2: 531, 1: 771, 3: 515, 0: 1029}
2024-03-16 16:38:47.603627 MEMORY 13.879697408
(Round 1) Aggregating seqlets in each cluster
2024-03-16 16:38:47.603719 MEMORY 13.879697408
Aggregating for cluster 0 with 1029 seqlets
2024-03-16 16:38:47.606794 MEMORY 13.879697408
Skipped 2 due to duplicates
Trimming eliminated 0 seqlets out of 1027
Aggregating for cluster 1 with 771 seqlets
2024-03-16 16:38:49.772756 MEMORY 13.879906304
Skipped 1 due to duplicates
Trimming eliminated 0 seqlets out of 770
Aggregating for cluster 2 with 531 seqlets
2024-03-16 16:38:51.543962 MEMORY 13.8799104
Trimming eliminated 0 seqlets out of 531
Aggregating for cluster 3 with 515 seqlets
2024-03-16 16:38:52.672834 MEMORY 13.8799104
Skipped 1 seqlets that went over sequence edge during flank expansion
Trimming eliminated 0 seqlets out of 514
(Round 2) num seqlets: 2842
(Round 2) Computing coarse affmat
2024-03-16 16:38:55.028680 MEMORY 13.8799104
Beginning embedding computation
MEMORY 13.8799104
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 368 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done 1368 tasks      | elapsed:    1.9s
[Parallel(n_jobs=24)]: Done 2842 out of 2842 | elapsed:    3.8s finished
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 368 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done 1368 tasks      | elapsed:    2.0s
[Parallel(n_jobs=24)]: Done 2842 out of 2842 | elapsed:    4.0s finished
At the beginning of embedding call
2024-03-16 16:38:55.028938 MEMORY 13.8799104
before computing embeddings fwd
2024-03-16 16:38:55.037715 MEMORY 13.8799104
after computing embeddings fwd
2024-03-16 16:38:58.821487 MEMORY 13.99164928
after computing embeddings rev
2024-03-16 16:39:02.826517 MEMORY 14.107897856
before computing sparse embeddings fwd
2024-03-16 16:39:02.826598 MEMORY 14.107897856
Constructing csr matrix...
csr matrix made in 0.30890560150146484 s
after computing sparse embeddings fwd
2024-03-16 16:39:03.258231 MEMORY 14.107983872
before computing sparse embeddings rev
2024-03-16 16:39:03.258311 MEMORY 14.107983872
Constructing csr matrix...
csr matrix made in 0.3077709674835205 s
after computing sparse embeddings rev
2024-03-16 16:39:03.675576 MEMORY 14.107983872
Finished embedding computation in 9.83 s
MEMORY 14.00758272
Starting affinity matrix computations
MEMORY 14.007320576
Batching in slices of size 2842
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:02<00:00,  2.07s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:02<00:00,  2.07s/it]
Finished affinity matrix computations in 2.08 s
MEMORY 14.007320576
(Round 2) Computed coarse affmat
2024-03-16 16:39:07.688432 MEMORY 14.00723456
(Round 2) Computing affinity matrix on nearest neighbors
2024-03-16 16:39:07.688557 MEMORY 14.00723456
Launching nearest neighbors affmat calculation job
MEMORY 14.00723456
Parallel runs completed
MEMORY 14.034550784
Job completed in: 4.65 s
MEMORY 14.034386944
Launching nearest neighbors affmat calculation job
MEMORY 14.029897728
Parallel runs completed
MEMORY 14.055374848
Job completed in: 4.72 s
MEMORY 14.055272448
(Round 2) Computed affinity matrix on nearest neighbors in 10.5 s
2024-03-16 16:39:18.188011 MEMORY 14.052929536
Not applying filtering for rounds above first round
2024-03-16 16:39:18.188427 MEMORY 14.052929536
(Round 2) Computing density adapted affmat
2024-03-16 16:39:19.462130 MEMORY 14.05886464
Symmetrizing nearest neighbors
Computing betas for density adaptation
Computing normalizing denominators
(Round 2) Computing clustering
2024-03-16 16:39:40.047604 MEMORY 14.011060224
Beginning preprocessing + Leiden
2024-03-16 16:39:40.051377 MEMORY 14.011060224
Affmat transformed
2024-03-16 16:39:40.051490 MEMORY 14.011060224
sources, targets, weights extracted
2024-03-16 16:39:40.134066 MEMORY 14.011060224
About to launch parallel Leiden runs
2024-03-16 16:39:40.176110 MEMORY 14.011060224
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    7.2s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   25.2s finished
Parallel Leiden runs finished
2024-03-16 16:40:05.330232 MEMORY 14.011101184
Quality: 0.333359401445394
Quality: 0.33335961285174737
Got 4 clusters after round 2
Counts:
{0: 979, 2: 586, 3: 479, 1: 798}
2024-03-16 16:40:05.339872 MEMORY 14.011101184
(Round 2) Aggregating seqlets in each cluster
2024-03-16 16:40:05.339959 MEMORY 14.011101184
Aggregating for cluster 0 with 979 seqlets
2024-03-16 16:40:05.341568 MEMORY 14.011101184
Trimming eliminated 0 seqlets out of 979
Aggregating for cluster 1 with 798 seqlets
2024-03-16 16:40:07.024683 MEMORY 14.011113472
Trimming eliminated 0 seqlets out of 798
Aggregating for cluster 2 with 586 seqlets
2024-03-16 16:40:08.290991 MEMORY 14.011113472
Skipped 1 due to duplicates
Trimming eliminated 0 seqlets out of 585
Aggregating for cluster 3 with 479 seqlets
2024-03-16 16:40:09.293424 MEMORY 14.011113472
Trimming eliminated 0 seqlets out of 479
Got 4 clusters
Splitting into subclusters...
2024-03-16 16:40:10.065156 MEMORY 14.011113472
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 930 tasks      | elapsed:    0.4s
[Parallel(n_jobs=24)]: Done 979 out of 979 | elapsed:    0.4s finished
Inspecting pattern 0 for spurious merging
[t-SNE] Computed conditional probabilities for sample 979 / 979
[t-SNE] Mean sigma: 0.339961
Beginning preprocessing + Leiden
2024-03-16 16:40:11.505911 MEMORY 14.011998208
Affmat transformed
2024-03-16 16:40:11.581222 MEMORY 14.011998208
sources, targets, weights extracted
2024-03-16 16:40:11.589076 MEMORY 14.011998208
About to launch parallel Leiden runs
2024-03-16 16:40:11.596051 MEMORY 14.012010496
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    2.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    7.8s finished
Parallel Leiden runs finished
2024-03-16 16:40:19.432924 MEMORY 14.012010496
Quality: 0.4091166694507281
Quality: 0.40915270663547987
Quality: 0.40979065726716224
Quality: 0.4099362458751648
Got subclusters: Counter({0: 214, 1: 178, 2: 126, 3: 103, 4: 89, 5: 78, 6: 66, 7: 63, 8: 62})
On merging iteration 1
Numbers for each pattern pre-subsample: [214, 178, 126, 103, 89, 78, 66, 63, 62]
Numbers after subsampling: [214, 178, 126, 103, 89, 78, 66, 63, 62]
Computing sims for pattern 0
Computed sims for pattern 0 in 1.7433125972747803 s
Computing sims for pattern 1
Computed sims for pattern 1 in 1.2312636375427246 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.9259757995605469 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.7321665287017822 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.6886553764343262 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.6097099781036377 s
Computing sims for pattern 6
Computed sims for pattern 6 in 0.5183429718017578 s
Computing sims for pattern 7
Computed sims for pattern 7 in 0.4909946918487549 s
Computing sims for pattern 8
Computed sims for pattern 8 in 0.49041318893432617 s
Cluster sizes
[214 178 126 103  89  78  66  63  62]
Cross-contamination matrix:
[[1.   0.53 0.58 0.66 0.5  0.66 0.61 0.42 0.81]
 [0.72 1.   0.56 0.58 0.69 0.58 0.51 0.41 0.78]
 [0.93 0.69 1.   0.85 0.77 0.82 0.8  0.73 0.92]
 [0.83 0.49 0.62 1.   0.65 0.69 0.62 0.34 0.82]
 [0.6  0.62 0.57 0.67 1.   0.5  0.6  0.3  0.77]
 [0.76 0.44 0.54 0.62 0.42 1.   0.6  0.45 0.66]
 [0.69 0.39 0.53 0.56 0.52 0.6  1.   0.28 0.72]
 [0.76 0.54 0.72 0.62 0.44 0.74 0.61 1.   0.68]
 [0.75 0.49 0.51 0.6  0.54 0.52 0.57 0.31 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.79 0.88 0.85 0.76 0.87 0.81 0.8  0.89]
 [0.79 1.   0.79 0.74 0.82 0.71 0.67 0.71 0.82]
 [0.88 0.79 1.   0.83 0.79 0.85 0.81 0.87 0.85]
 [0.85 0.74 0.83 1.   0.79 0.81 0.75 0.75 0.81]
 [0.76 0.82 0.79 0.79 1.   0.72 0.74 0.69 0.8 ]
 [0.87 0.71 0.85 0.81 0.72 1.   0.82 0.81 0.79]
 [0.81 0.67 0.81 0.75 0.74 0.82 1.   0.7  0.84]
 [0.8  0.71 0.87 0.75 0.69 0.81 0.7  1.   0.71]
 [0.89 0.82 0.85 0.81 0.8  0.79 0.84 0.71 1.  ]]
Collapsing 0 & 8 with crosscontam 0.7506659321622882 and sim 0.8856817084977923
Collapsing 0 & 2 with crosscontam 0.5798892009090346 and sim 0.8781785983045706
Collapsing 2 & 7 with crosscontam 0.7204103406337385 and sim 0.8729186101676946
Collapsing 0 & 5 with crosscontam 0.6630595667002961 and sim 0.8712949951770583
Collapsing 2 & 8 with crosscontam 0.5103252393793163 and sim 0.8542216048482143
Collapsing 2 & 5 with crosscontam 0.5430536055125144 and sim 0.8537869421365334
Trimming eliminated 0 seqlets out of 276
Trimming eliminated 0 seqlets out of 402
Trimming eliminated 0 seqlets out of 465
Trimming eliminated 0 seqlets out of 543
Unmerged patterns remapping: OrderedDict([(1, 1), (3, 2), (4, 3), (6, 4)])
Time spent on merging iteration: 2.4429075717926025
On merging iteration 2
Numbers for each pattern pre-subsample: [543, 178, 103, 89, 66]
Numbers after subsampling: [300, 178, 103, 89, 66]
Computing sims for pattern 0
Computed sims for pattern 0 in 1.0422804355621338 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.21443915367126465 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.13046860694885254 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.12125134468078613 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.09024190902709961 s
Cluster sizes
[543 178 103  89  66]
Cross-contamination matrix:
[[1.   0.77 0.92 0.77 0.89]
 [0.65 1.   0.58 0.69 0.51]
 [0.71 0.49 1.   0.65 0.62]
 [0.58 0.62 0.67 1.   0.6 ]
 [0.61 0.39 0.56 0.52 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.82 0.87 0.79 0.85]
 [0.82 1.   0.74 0.82 0.67]
 [0.87 0.74 1.   0.79 0.75]
 [0.79 0.82 0.79 1.   0.74]
 [0.85 0.67 0.75 0.74 1.  ]]
Collapsing 0 & 2 with crosscontam 0.7069442718385592 and sim 0.8673324134257534
Trimming eliminated 0 seqlets out of 646
Unmerged patterns remapping: OrderedDict([(1, 1), (3, 2), (4, 3)])
Time spent on merging iteration: 1.6833598613739014
On merging iteration 3
Numbers for each pattern pre-subsample: [646, 178, 89, 66]
Numbers after subsampling: [300, 178, 89, 66]
Computing sims for pattern 0
Computed sims for pattern 0 in 0.7716197967529297 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.2076408863067627 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.12151145935058594 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.0942373275756836 s
Cluster sizes
[646 178  89  66]
Cross-contamination matrix:
[[1.   0.78 0.84 0.93]
 [0.62 1.   0.69 0.51]
 [0.6  0.62 1.   0.6 ]
 [0.61 0.39 0.52 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.82 0.81 0.85]
 [0.82 1.   0.82 0.67]
 [0.81 0.82 1.   0.74]
 [0.85 0.67 0.74 1.  ]]
Collapsing 0 & 3 with crosscontam 0.6061718192021222 and sim 0.8524909159953048
Trimming eliminated 0 seqlets out of 712
Unmerged patterns remapping: OrderedDict([(1, 1), (2, 2)])
Time spent on merging iteration: 1.0556056499481201
On merging iteration 4
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 798 out of 798 | elapsed:    0.3s finished
Numbers for each pattern pre-subsample: [712, 178, 89]
Numbers after subsampling: [300, 178, 89]
Computing sims for pattern 0
Computed sims for pattern 0 in 0.5322537422180176 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.2053992748260498 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.1255497932434082 s
Cluster sizes
[712 178  89]
Cross-contamination matrix:
[[1.   0.78 0.83]
 [0.62 1.   0.69]
 [0.6  0.62 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.82 0.81]
 [0.82 1.   0.82]
 [0.81 0.82 1.  ]]
Inspecting pattern 1 for spurious merging
[t-SNE] Computed conditional probabilities for sample 798 / 798
[t-SNE] Mean sigma: 0.384055
Beginning preprocessing + Leiden
2024-03-16 16:40:36.453671 MEMORY 14.012223488
Affmat transformed
2024-03-16 16:40:36.463038 MEMORY 14.012223488
sources, targets, weights extracted
2024-03-16 16:40:36.468114 MEMORY 14.012223488
About to launch parallel Leiden runs
2024-03-16 16:40:36.474313 MEMORY 14.012223488
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.9s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    6.2s finished
Parallel Leiden runs finished
2024-03-16 16:40:42.700822 MEMORY 14.012223488
Quality: 0.4261271364619768
Quality: 0.42990367843552374
Quality: 0.4300887955801552
Quality: 0.4304134934455343
Quality: 0.43126471040428344
Got subclusters: Counter({0: 184, 1: 171, 2: 121, 3: 92, 4: 87, 5: 64, 6: 59, 7: 20})
On merging iteration 1
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 585 out of 585 | elapsed:    0.2s finished
Numbers for each pattern pre-subsample: [184, 171, 121, 92, 87, 64, 59, 20]
Numbers after subsampling: [184, 171, 121, 92, 87, 64, 59, 20]
Computing sims for pattern 0
Computed sims for pattern 0 in 1.159317970275879 s
Computing sims for pattern 1
Computed sims for pattern 1 in 1.080441951751709 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.7978484630584717 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.6189234256744385 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.5831739902496338 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.4309406280517578 s
Computing sims for pattern 6
Computed sims for pattern 6 in 0.40285229682922363 s
Computing sims for pattern 7
Computed sims for pattern 7 in 0.18171310424804688 s
Cluster sizes
[184 171 121  92  87  64  59  20]
Cross-contamination matrix:
[[1.   0.59 0.74 0.74 0.7  0.45 0.57 0.72]
 [0.49 1.   0.73 0.43 0.67 0.44 0.34 0.52]
 [0.51 0.59 1.   0.44 0.52 0.48 0.19 0.45]
 [0.75 0.54 0.66 1.   0.69 0.47 0.53 0.69]
 [0.56 0.63 0.62 0.55 1.   0.48 0.42 0.57]
 [0.44 0.52 0.69 0.44 0.59 1.   0.59 0.49]
 [0.69 0.53 0.43 0.64 0.65 0.73 1.   0.45]
 [0.55 0.47 0.5  0.52 0.54 0.37 0.23 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.66 0.81 0.77 0.74 0.45 0.62 0.78]
 [0.66 1.   0.82 0.61 0.69 0.48 0.43 0.65]
 [0.81 0.82 1.   0.67 0.78 0.53 0.44 0.69]
 [0.77 0.61 0.67 1.   0.71 0.53 0.55 0.73]
 [0.74 0.69 0.78 0.71 1.   0.57 0.5  0.72]
 [0.45 0.48 0.53 0.53 0.57 1.   0.74 0.6 ]
 [0.62 0.43 0.44 0.55 0.5  0.74 1.   0.54]
 [0.78 0.65 0.69 0.73 0.72 0.6  0.54 1.  ]]
Inspecting pattern 2 for spurious merging
[t-SNE] Computed conditional probabilities for sample 585 / 585
[t-SNE] Mean sigma: 0.359862
Beginning preprocessing + Leiden
2024-03-16 16:40:48.954460 MEMORY 14.012227584
Affmat transformed
2024-03-16 16:40:48.961784 MEMORY 14.012227584
sources, targets, weights extracted
2024-03-16 16:40:48.966520 MEMORY 14.012227584
About to launch parallel Leiden runs
2024-03-16 16:40:48.972016 MEMORY 14.012227584
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.5s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    4.9s finished
Parallel Leiden runs finished
2024-03-16 16:40:53.886895 MEMORY 14.012227584
Quality: 0.3814303190642869
Quality: 0.3829395153850503
Quality: 0.3850921356130874
Quality: 0.3867377099017498
Got subclusters: Counter({0: 152, 1: 101, 2: 97, 3: 90, 4: 64, 5: 60, 6: 21})
On merging iteration 1
Numbers for each pattern pre-subsample: [152, 101, 97, 90, 64, 60, 21]
Numbers after subsampling: [152, 101, 97, 90, 64, 60, 21]
Computing sims for pattern 0
Computed sims for pattern 0 in 0.7443757057189941 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.5318465232849121 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.4409918785095215 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.5075342655181885 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.3608832359313965 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.3411417007446289 s
Computing sims for pattern 6
Computed sims for pattern 6 in 0.15029335021972656 s
Cluster sizes
[152 101  97  90  64  60  21]
Cross-contamination matrix:
[[1.   0.48 0.28 0.24 0.5  0.55 0.81]
 [0.8  1.   0.49 0.32 0.6  0.61 0.84]
 [0.71 0.64 1.   0.54 0.72 0.64 0.82]
 [0.93 0.75 0.79 1.   0.79 0.71 0.85]
 [0.97 0.76 0.72 0.56 1.   0.74 1.  ]
 [0.95 0.7  0.59 0.41 0.68 1.   0.9 ]
 [0.68 0.43 0.32 0.19 0.44 0.43 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.77 0.69 0.7  0.79 0.83 0.88]
 [0.77 1.   0.67 0.68 0.75 0.72 0.78]
 [0.69 0.67 1.   0.7  0.78 0.69 0.77]
 [0.7  0.68 0.7  1.   0.79 0.65 0.71]
 [0.79 0.75 0.78 0.79 1.   0.74 0.88]
 [0.83 0.72 0.69 0.65 0.74 1.   0.8 ]
 [0.88 0.78 0.77 0.71 0.88 0.8  1.  ]]
Collapsing 0 & 6 with crosscontam 0.6797094777760728 and sim 0.8846748792642144
Trimming eliminated 0 seqlets out of 173
Unmerged patterns remapping: OrderedDict([(1, 1), (2, 2), (3, 3), (4, 4), (5, 5)])
Time spent on merging iteration: 0.2730841636657715
On merging iteration 2
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 344 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 479 out of 479 | elapsed:    0.2s finished
Numbers for each pattern pre-subsample: [173, 101, 97, 90, 64, 60]
Numbers after subsampling: [173, 101, 97, 90, 64, 60]
Computing sims for pattern 0
Computed sims for pattern 0 in 0.7565696239471436 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.11281514167785645 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.09992432594299316 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.11044859886169434 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.07601189613342285 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.0770108699798584 s
Cluster sizes
[173 101  97  90  64  60]
Cross-contamination matrix:
[[1.   0.51 0.32 0.25 0.53 0.58]
 [0.8  1.   0.49 0.32 0.6  0.61]
 [0.73 0.64 1.   0.54 0.72 0.64]
 [0.9  0.75 0.79 1.   0.79 0.71]
 [0.97 0.76 0.72 0.56 1.   0.74]
 [0.94 0.7  0.59 0.41 0.68 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.78 0.71 0.7  0.81 0.83]
 [0.78 1.   0.67 0.68 0.75 0.72]
 [0.71 0.67 1.   0.7  0.78 0.69]
 [0.7  0.68 0.7  1.   0.79 0.65]
 [0.81 0.75 0.78 0.79 1.   0.74]
 [0.83 0.72 0.69 0.65 0.74 1.  ]]
Inspecting pattern 3 for spurious merging
[t-SNE] Computed conditional probabilities for sample 479 / 479
[t-SNE] Mean sigma: 0.397617
Beginning preprocessing + Leiden
2024-03-16 16:40:59.157746 MEMORY 14.012227584
Affmat transformed
2024-03-16 16:40:59.163702 MEMORY 14.012227584
sources, targets, weights extracted
2024-03-16 16:40:59.166323 MEMORY 14.012227584
About to launch parallel Leiden runs
2024-03-16 16:40:59.171506 MEMORY 14.012227584
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.2s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    3.7s finished
Parallel Leiden runs finished
2024-03-16 16:41:02.920490 MEMORY 14.012227584
Quality: 0.4287178418378868
Quality: 0.42876442448596414
Quality: 0.4289307214610231
Quality: 0.4289882030028789
Got subclusters: Counter({0: 114, 1: 112, 3: 65, 2: 65, 4: 59, 5: 55, 6: 9})
On merging iteration 1
Numbers for each pattern pre-subsample: [114, 112, 65, 65, 59, 55, 9]
Numbers after subsampling: [114, 112, 65, 65, 59, 55, 9]
Computing sims for pattern 0
Computed sims for pattern 0 in 0.5934321880340576 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.5823044776916504 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.349653959274292 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.34000563621520996 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.32236218452453613 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.29468536376953125 s
Computing sims for pattern 6
Computed sims for pattern 6 in 0.08508467674255371 s
Cluster sizes
[114 112  65  65  59  55   9]
Cross-contamination matrix:
[[1.   0.54 0.71 0.67 0.66 0.74 0.45]
 [0.52 1.   0.59 0.73 0.75 0.59 0.45]
 [0.39 0.32 1.   0.19 0.31 0.23 0.22]
 [0.54 0.61 0.45 1.   0.65 0.51 0.29]
 [0.49 0.59 0.42 0.62 1.   0.4  0.25]
 [0.7  0.63 0.65 0.68 0.58 1.   0.48]
 [0.37 0.39 0.38 0.25 0.21 0.39 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.66 0.62 0.67 0.62 0.81 0.56]
 [0.66 1.   0.67 0.72 0.7  0.7  0.59]
 [0.62 0.67 1.   0.5  0.55 0.62 0.52]
 [0.67 0.72 0.5  1.   0.8  0.66 0.46]
 [0.62 0.7  0.55 0.8  1.   0.54 0.44]
 [0.81 0.7  0.62 0.66 0.54 1.   0.55]
 [0.56 0.59 0.52 0.46 0.44 0.55 1.  ]]
Merging on 24 clusters
2024-03-16 16:41:05.591782 MEMORY 14.012227584
On merging iteration 1
Numbers for each pattern pre-subsample: [712, 178, 89, 184, 171, 121, 92, 87, 64, 59, 20, 173, 101, 97, 90, 64, 60, 114, 112, 65, 65, 59, 55, 9]
Numbers after subsampling: [300, 178, 89, 184, 171, 121, 92, 87, 64, 59, 20, 173, 101, 97, 90, 64, 60, 114, 112, 65, 65, 59, 55, 9]
Computing sims for pattern 0
Computed sims for pattern 0 in 6.080253601074219 s
Computing sims for pattern 1
Computed sims for pattern 1 in 3.7225582599639893 s
Computing sims for pattern 2
Computed sims for pattern 2 in 1.9335298538208008 s
Computing sims for pattern 3
Computed sims for pattern 3 in 5.380255460739136 s
Computing sims for pattern 4
Computed sims for pattern 4 in 3.4365603923797607 s
Computing sims for pattern 5
Computed sims for pattern 5 in 2.5865724086761475 s
Computing sims for pattern 6
Computed sims for pattern 6 in 1.9983880519866943 s
Computing sims for pattern 7
Computed sims for pattern 7 in 1.904608964920044 s
Computing sims for pattern 8
Computed sims for pattern 8 in 1.4219512939453125 s
Computing sims for pattern 9
Computed sims for pattern 9 in 1.301697015762329 s
Computing sims for pattern 10
Computed sims for pattern 10 in 0.5669708251953125 s
Computing sims for pattern 11
Computed sims for pattern 11 in 3.5685482025146484 s
Computing sims for pattern 12
Computed sims for pattern 12 in 2.172144889831543 s
Computing sims for pattern 13
Computed sims for pattern 13 in 1.7533824443817139 s
Computing sims for pattern 14
Computed sims for pattern 14 in 1.987051248550415 s
Computing sims for pattern 15
Computed sims for pattern 15 in 1.4190664291381836 s
Computing sims for pattern 16
Computed sims for pattern 16 in 1.3435006141662598 s
Computing sims for pattern 17
Computed sims for pattern 17 in 2.458528995513916 s
Computing sims for pattern 18
Computed sims for pattern 18 in 2.4110915660858154 s
Computing sims for pattern 19
Computed sims for pattern 19 in 1.4578840732574463 s
Computing sims for pattern 20
Computed sims for pattern 20 in 1.4618449211120605 s
Computing sims for pattern 21
Computed sims for pattern 21 in 1.3019356727600098 s
Computing sims for pattern 22
Computed sims for pattern 22 in 1.2105586528778076 s
Computing sims for pattern 23
Computed sims for pattern 23 in 0.37712717056274414 s
Cluster sizes
[712 178  89 184 171 121  92  87  64  59  20 173 101  97  90  64  60 114
 112  65  65  59  55   9]
Cross-contamination matrix:
[[1.   0.78 0.83 0.4  0.23 0.29 0.35 0.29 0.2  0.18 0.27 0.23 0.42 0.4
  0.38 0.46 0.21 0.57 0.32 0.28 0.47 0.34 0.37 0.33]
 [0.62 1.   0.69 0.24 0.26 0.21 0.15 0.32 0.12 0.22 0.16 0.17 0.22 0.18
  0.15 0.31 0.08 0.33 0.22 0.19 0.28 0.16 0.21 0.17]
 [0.6  0.62 1.   0.21 0.3  0.28 0.13 0.31 0.11 0.13 0.14 0.19 0.25 0.14
  0.21 0.37 0.14 0.3  0.23 0.16 0.44 0.24 0.24 0.19]
 [0.47 0.41 0.41 1.   0.59 0.74 0.74 0.7  0.45 0.57 0.72 0.39 0.25 0.36
  0.52 0.26 0.25 0.46 0.22 0.42 0.4  0.37 0.27 0.26]
 [0.21 0.35 0.45 0.49 1.   0.73 0.43 0.67 0.44 0.34 0.52 0.16 0.07 0.14
  0.3  0.14 0.25 0.36 0.26 0.29 0.57 0.34 0.21 0.26]
 [0.21 0.22 0.33 0.51 0.59 1.   0.44 0.52 0.48 0.19 0.45 0.19 0.09 0.15
  0.29 0.18 0.17 0.31 0.38 0.2  0.44 0.55 0.26 0.16]
 [0.42 0.31 0.28 0.75 0.54 0.66 1.   0.69 0.47 0.53 0.69 0.25 0.18 0.34
  0.42 0.17 0.16 0.55 0.31 0.85 0.38 0.23 0.32 0.36]
 [0.27 0.45 0.46 0.56 0.63 0.62 0.55 1.   0.48 0.42 0.57 0.2  0.11 0.2
  0.3  0.16 0.26 0.41 0.28 0.36 0.51 0.23 0.23 0.29]
 [0.18 0.22 0.19 0.44 0.52 0.69 0.44 0.59 1.   0.59 0.49 0.25 0.12 0.35
  0.25 0.13 0.27 0.32 0.37 0.4  0.4  0.42 0.34 0.33]
 [0.29 0.47 0.3  0.69 0.53 0.43 0.64 0.65 0.73 1.   0.45 0.24 0.19 0.33
  0.42 0.28 0.23 0.45 0.18 0.43 0.43 0.27 0.21 0.3 ]
 [0.2  0.19 0.19 0.55 0.47 0.5  0.52 0.54 0.37 0.23 1.   0.17 0.15 0.13
  0.29 0.14 0.12 0.26 0.14 0.29 0.23 0.13 0.18 0.1 ]
 [0.06 0.05 0.07 0.08 0.04 0.06 0.04 0.04 0.04 0.02 0.05 1.   0.51 0.32
  0.25 0.53 0.58 0.09 0.04 0.07 0.08 0.11 0.05 0.04]
 [0.2  0.14 0.16 0.1  0.03 0.05 0.05 0.04 0.11 0.04 0.09 0.8  1.   0.49
  0.32 0.6  0.61 0.29 0.11 0.34 0.15 0.1  0.18 0.11]
 [0.32 0.21 0.17 0.23 0.12 0.15 0.22 0.14 0.25 0.17 0.13 0.73 0.64 1.
  0.54 0.72 0.64 0.6  0.26 0.45 0.32 0.36 0.35 0.17]
 [0.55 0.39 0.52 0.62 0.47 0.56 0.54 0.48 0.37 0.45 0.53 0.9  0.75 0.79
  1.   0.79 0.71 0.73 0.38 0.58 0.7  0.63 0.64 0.5 ]
 [0.39 0.32 0.43 0.21 0.15 0.21 0.12 0.14 0.2  0.09 0.2  0.97 0.76 0.72
  0.56 1.   0.74 0.3  0.17 0.32 0.23 0.29 0.27 0.26]
 [0.15 0.11 0.19 0.15 0.19 0.17 0.08 0.19 0.17 0.09 0.13 0.94 0.7  0.59
  0.41 0.68 1.   0.28 0.19 0.24 0.24 0.31 0.28 0.1 ]
 [0.58 0.44 0.47 0.38 0.34 0.38 0.47 0.41 0.28 0.3  0.33 0.35 0.52 0.69
  0.54 0.35 0.4  1.   0.54 0.71 0.67 0.66 0.74 0.45]
 [0.3  0.3  0.33 0.18 0.28 0.46 0.23 0.3  0.31 0.11 0.17 0.18 0.25 0.33
  0.21 0.18 0.23 0.52 1.   0.59 0.73 0.75 0.59 0.45]
 [0.12 0.14 0.13 0.16 0.14 0.11 0.44 0.16 0.17 0.13 0.18 0.08 0.31 0.28
  0.26 0.16 0.14 0.39 0.32 1.   0.19 0.31 0.23 0.22]
 [0.34 0.3  0.51 0.23 0.45 0.43 0.21 0.41 0.25 0.19 0.18 0.25 0.21 0.31
  0.35 0.2  0.19 0.54 0.61 0.45 1.   0.65 0.51 0.29]
 [0.2  0.15 0.27 0.19 0.22 0.5  0.12 0.14 0.25 0.12 0.1  0.26 0.13 0.29
  0.29 0.2  0.25 0.49 0.59 0.42 0.62 1.   0.4  0.25]
 [0.36 0.33 0.38 0.22 0.22 0.31 0.26 0.24 0.27 0.1  0.21 0.27 0.36 0.48
  0.46 0.32 0.35 0.7  0.63 0.65 0.68 0.58 1.   0.48]
 [0.18 0.15 0.2  0.12 0.14 0.16 0.16 0.13 0.1  0.1  0.04 0.11 0.21 0.15
  0.17 0.21 0.15 0.37 0.39 0.38 0.25 0.21 0.39 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.82 0.81 0.51 0.28 0.43 0.38 0.39 0.25 0.15 0.38 0.27 0.5  0.49
  0.55 0.5  0.24 0.72 0.46 0.33 0.56 0.37 0.53 0.42]
 [0.82 1.   0.82 0.39 0.38 0.41 0.2  0.46 0.21 0.22 0.28 0.27 0.46 0.34
  0.43 0.46 0.24 0.62 0.49 0.32 0.47 0.32 0.46 0.43]
 [0.81 0.82 1.   0.38 0.36 0.45 0.2  0.47 0.24 0.18 0.28 0.32 0.48 0.36
  0.51 0.53 0.37 0.63 0.47 0.3  0.59 0.39 0.47 0.44]
 [0.51 0.39 0.38 1.   0.66 0.81 0.77 0.74 0.45 0.62 0.78 0.38 0.25 0.38
  0.64 0.3  0.27 0.52 0.26 0.32 0.45 0.4  0.22 0.28]
 [0.28 0.38 0.36 0.66 1.   0.82 0.61 0.69 0.48 0.43 0.65 0.25 0.12 0.22
  0.45 0.19 0.23 0.42 0.3  0.32 0.52 0.41 0.18 0.2 ]
 [0.43 0.41 0.45 0.81 0.82 1.   0.67 0.78 0.53 0.44 0.69 0.37 0.25 0.34
  0.57 0.3  0.31 0.48 0.46 0.35 0.59 0.63 0.23 0.28]
 [0.38 0.2  0.2  0.77 0.61 0.67 1.   0.71 0.53 0.55 0.73 0.2  0.11 0.3
  0.44 0.16 0.1  0.52 0.31 0.64 0.31 0.31 0.18 0.27]
 [0.39 0.46 0.47 0.74 0.69 0.78 0.71 1.   0.57 0.5  0.72 0.31 0.13 0.29
  0.51 0.25 0.4  0.52 0.34 0.34 0.5  0.35 0.24 0.27]
 [0.25 0.21 0.24 0.45 0.48 0.53 0.53 0.57 1.   0.74 0.6  0.18 0.3  0.25
  0.29 0.26 0.2  0.29 0.37 0.38 0.28 0.32 0.26 0.24]
 [0.15 0.22 0.18 0.62 0.43 0.44 0.55 0.5  0.74 1.   0.54 0.11 0.07 0.2
  0.3  0.05 0.08 0.28 0.09 0.2  0.26 0.28 0.04 0.12]
 [0.38 0.28 0.28 0.78 0.65 0.69 0.73 0.72 0.6  0.54 1.   0.31 0.23 0.21
  0.51 0.29 0.29 0.4  0.23 0.38 0.29 0.29 0.17 0.23]
 [0.27 0.27 0.32 0.38 0.25 0.37 0.2  0.31 0.18 0.11 0.31 1.   0.78 0.71
  0.7  0.81 0.83 0.34 0.26 0.25 0.47 0.41 0.28 0.26]
 [0.5  0.46 0.48 0.25 0.12 0.25 0.11 0.13 0.3  0.07 0.23 0.78 1.   0.67
  0.68 0.75 0.72 0.54 0.38 0.42 0.25 0.26 0.34 0.35]
 [0.49 0.34 0.36 0.38 0.22 0.34 0.3  0.29 0.25 0.2  0.21 0.71 0.67 1.
  0.7  0.78 0.69 0.69 0.44 0.42 0.56 0.51 0.61 0.37]
 [0.55 0.43 0.51 0.64 0.45 0.57 0.44 0.51 0.29 0.3  0.51 0.7  0.68 0.7
  1.   0.79 0.65 0.69 0.4  0.43 0.64 0.51 0.52 0.43]
 [0.5  0.46 0.53 0.3  0.19 0.3  0.16 0.25 0.26 0.05 0.29 0.81 0.75 0.78
  0.79 1.   0.74 0.48 0.34 0.32 0.38 0.36 0.35 0.39]
 [0.24 0.24 0.37 0.27 0.23 0.31 0.1  0.4  0.2  0.08 0.29 0.83 0.72 0.69
  0.65 0.74 1.   0.42 0.34 0.4  0.39 0.41 0.38 0.34]
 [0.72 0.62 0.63 0.52 0.42 0.48 0.52 0.52 0.29 0.28 0.4  0.34 0.54 0.69
  0.69 0.48 0.42 1.   0.66 0.62 0.67 0.62 0.81 0.56]
 [0.46 0.49 0.47 0.26 0.3  0.46 0.31 0.34 0.37 0.09 0.23 0.26 0.38 0.44
  0.4  0.34 0.34 0.66 1.   0.67 0.72 0.7  0.7  0.59]
 [0.33 0.32 0.3  0.32 0.32 0.35 0.64 0.34 0.38 0.2  0.38 0.25 0.42 0.42
  0.43 0.32 0.4  0.62 0.67 1.   0.5  0.55 0.62 0.52]
 [0.56 0.47 0.59 0.45 0.52 0.59 0.31 0.5  0.28 0.26 0.29 0.47 0.25 0.56
  0.64 0.38 0.39 0.67 0.72 0.5  1.   0.8  0.66 0.46]
 [0.37 0.32 0.39 0.4  0.41 0.63 0.31 0.35 0.32 0.28 0.29 0.41 0.26 0.51
  0.51 0.36 0.41 0.62 0.7  0.55 0.8  1.   0.54 0.44]
 [0.53 0.46 0.47 0.22 0.18 0.23 0.18 0.24 0.26 0.04 0.17 0.28 0.34 0.61
  0.52 0.35 0.38 0.81 0.7  0.62 0.66 0.54 1.   0.55]
 [0.42 0.43 0.44 0.28 0.2  0.28 0.27 0.27 0.24 0.12 0.23 0.26 0.35 0.37
  0.43 0.39 0.34 0.56 0.59 0.52 0.46 0.44 0.55 1.  ]]
Got 24 patterns after merging
2024-03-16 16:41:59.177857 MEMORY 14.01223168
Performing filtering
2024-03-16 16:41:59.178033 MEMORY 14.01223168
Got 22 patterns after filtering
2024-03-16 16:41:59.602436 MEMORY 14.012235776
Total time taken is 375.83s
2024-03-16 16:41:59.602577 MEMORY 14.012235776
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 712 out of 712 | elapsed:    0.3s finished
/ru-auth/local/home/lzhao/anaconda3/envs/jupyter-ml-clone/lib/python3.9/site-packages/sklearn/manifold/_t_sne.py:691: FutureWarning: 'square_distances' has been introduced in 0.24 to help phase out legacy squaring behavior. The 'legacy' setting will be removed in 1.1 (renaming of 0.26), and the default setting will be changed to True. In 1.3, 'square_distances' will be removed altogether, and distances will be squared by default. Set 'square_distances'=True to silence this warning.
  warnings.warn(
/ru-auth/local/home/lzhao/anaconda3/envs/jupyter-ml-clone/lib/python3.9/site-packages/sklearn/neighbors/_base.py:175: EfficiencyWarning: Precomputed sparse input was not sorted by data.
  warnings.warn('Precomputed sparse input was not sorted by data.',
Applying subclustering to the final motifs
On pattern 0
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 712 samples in 0.096s...
[t-SNE] Computed neighbors for 712 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 712 / 712
[t-SNE] Mean sigma: 0.345176
[t-SNE] Computed conditional probabilities in 0.048s
[t-SNE] Iteration 50: error = 67.4941559, gradient norm = 0.3976458 (50 iterations in 6.811s)
[t-SNE] Iteration 100: error = 69.4673767, gradient norm = 0.3530259 (50 iterations in 0.061s)
[t-SNE] Iteration 150: error = 68.8264236, gradient norm = 0.3694095 (50 iterations in 0.064s)
[t-SNE] Iteration 200: error = 69.7844162, gradient norm = 0.3488753 (50 iterations in 0.064s)
[t-SNE] Iteration 250: error = 71.0966721, gradient norm = 0.3683304 (50 iterations in 0.061s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 71.096672
[t-SNE] Iteration 300: error = 1.6458410, gradient norm = 0.0033827 (50 iterations in 0.062s)
[t-SNE] Iteration 350: error = 1.5759943, gradient norm = 0.0009366 (50 iterations in 0.059s)
[t-SNE] Iteration 400: error = 1.5652523, gradient norm = 0.0003865 (50 iterations in 0.058s)
[t-SNE] Iteration 450: error = 1.5543946, gradient norm = 0.0003012 (50 iterations in 0.058s)
[t-SNE] Iteration 500: error = 1.5486223, gradient norm = 0.0002858 (50 iterations in 0.059s)
[t-SNE] Iteration 550: error = 1.5468460, gradient norm = 0.0002332 (50 iterations in 0.057s)
[t-SNE] Iteration 600: error = 1.5446613, gradient norm = 0.0001985 (50 iterations in 0.059s)
[t-SNE] Iteration 650: error = 1.5418046, gradient norm = 0.0001703 (50 iterations in 0.058s)
[t-SNE] Iteration 700: error = 1.5392954, gradient norm = 0.0001396 (50 iterations in 0.058s)
[t-SNE] Iteration 750: error = 1.5372632, gradient norm = 0.0001491 (50 iterations in 0.057s)
[t-SNE] Iteration 800: error = 1.5361925, gradient norm = 0.0001341 (50 iterations in 0.058s)
[t-SNE] Iteration 850: error = 1.5351348, gradient norm = 0.0001629 (50 iterations in 0.059s)
[t-SNE] Iteration 900: error = 1.5332377, gradient norm = 0.0001190 (50 iterations in 0.058s)
[t-SNE] Iteration 950: error = 1.5318075, gradient norm = 0.0001287 (50 iterations in 0.057s)
[t-SNE] Iteration 1000: error = 1.5307637, gradient norm = 0.0001353 (50 iterations in 0.058s)
[t-SNE] KL divergence after 1000 iterations: 1.530764
[t-SNE] Computed conditional probabilities for sample 712 / 712
[t-SNE] Mean sigma: 0.345176
Beginning preprocessing + Leiden
2024-03-16 16:42:08.826237 MEMORY 13.996240896
Affmat transformed
2024-03-16 16:42:08.834556 MEMORY 13.996240896
sources, targets, weights extracted
2024-03-16 16:42:08.840194 MEMORY 13.996240896
About to launch parallel Leiden runs
2024-03-16 16:42:08.847065 MEMORY 13.996240896
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    2.0s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    6.7s finished
Parallel Leiden runs finished
2024-03-16 16:42:15.591948 MEMORY 13.996240896
Quality: 0.3772751523996814
Quality: 0.3785256227281053
Quality: 0.37934837477247213
Quality: 0.3796960893067014
Quality: 0.37970067383470407
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 184 out of 184 | elapsed:    0.1s finished
Got subclusters: Counter({0: 144, 1: 95, 2: 92, 3: 81, 4: 69, 5: 65, 6: 58, 7: 57, 8: 51})
On pattern 1
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 184 samples in 0.001s...
[t-SNE] Computed neighbors for 184 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 184 / 184
[t-SNE] Mean sigma: 0.448354
[t-SNE] Computed conditional probabilities in 0.012s
[t-SNE] Iteration 50: error = 58.7261200, gradient norm = 0.4760984 (50 iterations in 0.134s)
[t-SNE] Iteration 100: error = 59.0205841, gradient norm = 0.5140728 (50 iterations in 0.026s)
[t-SNE] Iteration 150: error = 58.3040581, gradient norm = 0.4950510 (50 iterations in 0.024s)
[t-SNE] Iteration 200: error = 56.2032051, gradient norm = 0.5570607 (50 iterations in 0.024s)
[t-SNE] Iteration 250: error = 59.0250816, gradient norm = 0.4983284 (50 iterations in 0.024s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 59.025082
[t-SNE] Iteration 300: error = 0.9220324, gradient norm = 0.0089841 (50 iterations in 0.024s)
[t-SNE] Iteration 350: error = 0.7930890, gradient norm = 0.0047694 (50 iterations in 0.023s)
[t-SNE] Iteration 400: error = 0.7522333, gradient norm = 0.0030638 (50 iterations in 0.023s)
[t-SNE] Iteration 450: error = 0.7041751, gradient norm = 0.0004446 (50 iterations in 0.023s)
[t-SNE] Iteration 500: error = 0.7034838, gradient norm = 0.0002690 (50 iterations in 0.023s)
[t-SNE] Iteration 550: error = 0.7033059, gradient norm = 0.0001952 (50 iterations in 0.023s)
[t-SNE] Iteration 600: error = 0.7032967, gradient norm = 0.0002751 (50 iterations in 0.022s)
[t-SNE] Iteration 650: error = 0.7032978, gradient norm = 0.0002263 (50 iterations in 0.022s)
[t-SNE] Iteration 700: error = 0.7032740, gradient norm = 0.0002945 (50 iterations in 0.022s)
[t-SNE] Iteration 750: error = 0.7034365, gradient norm = 0.0002097 (50 iterations in 0.022s)
[t-SNE] Iteration 800: error = 0.7032381, gradient norm = 0.0002421 (50 iterations in 0.022s)
[t-SNE] Iteration 850: error = 0.7033535, gradient norm = 0.0002814 (50 iterations in 0.022s)
[t-SNE] Iteration 900: error = 0.7035067, gradient norm = 0.0002469 (50 iterations in 0.022s)
[t-SNE] Iteration 950: error = 0.7034924, gradient norm = 0.0002322 (50 iterations in 0.022s)
[t-SNE] Iteration 1000: error = 0.7035114, gradient norm = 0.0001986 (50 iterations in 0.022s)
[t-SNE] KL divergence after 1000 iterations: 0.703511
[t-SNE] Computed conditional probabilities for sample 184 / 184
[t-SNE] Mean sigma: 0.448354
Beginning preprocessing + Leiden
2024-03-16 16:42:16.520029 MEMORY 13.996240896
Affmat transformed
2024-03-16 16:42:16.522930 MEMORY 13.996240896
sources, targets, weights extracted
2024-03-16 16:42:16.523981 MEMORY 13.996240896
About to launch parallel Leiden runs
2024-03-16 16:42:16.527912 MEMORY 13.996240896
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.8s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.1s finished
Parallel Leiden runs finished
2024-03-16 16:42:18.676835 MEMORY 13.996240896
Quality: 0.29380823318523086
Quality: 0.2984659300523346
Quality: 0.3003290509456697
Quality: 0.30067077113841084
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 178 out of 178 | elapsed:    0.1s finished
Got subclusters: Counter({0: 42, 1: 37, 2: 33, 3: 27, 4: 24, 5: 21})
On pattern 2
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 178 samples in 0.001s...
[t-SNE] Computed neighbors for 178 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 178 / 178
[t-SNE] Mean sigma: 0.413222
[t-SNE] Computed conditional probabilities in 0.012s
[t-SNE] Iteration 50: error = 63.1555367, gradient norm = 0.5103329 (50 iterations in 0.032s)
[t-SNE] Iteration 100: error = 61.4881859, gradient norm = 0.5400548 (50 iterations in 0.023s)
[t-SNE] Iteration 150: error = 61.9513550, gradient norm = 0.4850562 (50 iterations in 0.023s)
[t-SNE] Iteration 200: error = 59.1936150, gradient norm = 0.5209563 (50 iterations in 0.024s)
[t-SNE] Iteration 250: error = 57.8626862, gradient norm = 0.5656125 (50 iterations in 0.023s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 57.862686
[t-SNE] Iteration 300: error = 0.9029984, gradient norm = 0.0085213 (50 iterations in 0.022s)
[t-SNE] Iteration 350: error = 0.6850401, gradient norm = 0.0029699 (50 iterations in 0.024s)
[t-SNE] Iteration 400: error = 0.6476537, gradient norm = 0.0014891 (50 iterations in 0.022s)
[t-SNE] Iteration 450: error = 0.6442902, gradient norm = 0.0003754 (50 iterations in 0.022s)
[t-SNE] Iteration 500: error = 0.6437018, gradient norm = 0.0005751 (50 iterations in 0.022s)
[t-SNE] Iteration 550: error = 0.6433954, gradient norm = 0.0001964 (50 iterations in 0.022s)
[t-SNE] Iteration 600: error = 0.6433496, gradient norm = 0.0001963 (50 iterations in 0.022s)
[t-SNE] Iteration 650: error = 0.6435176, gradient norm = 0.0001988 (50 iterations in 0.022s)
[t-SNE] Iteration 700: error = 0.6432883, gradient norm = 0.0001986 (50 iterations in 0.021s)
[t-SNE] Iteration 750: error = 0.6434308, gradient norm = 0.0001385 (50 iterations in 0.022s)
[t-SNE] Iteration 800: error = 0.6436853, gradient norm = 0.0002256 (50 iterations in 0.022s)
[t-SNE] Iteration 850: error = 0.6433547, gradient norm = 0.0001878 (50 iterations in 0.023s)
[t-SNE] Iteration 900: error = 0.6432658, gradient norm = 0.0003324 (50 iterations in 0.022s)
[t-SNE] Iteration 950: error = 0.6434396, gradient norm = 0.0001021 (50 iterations in 0.022s)
[t-SNE] Iteration 1000: error = 0.6433471, gradient norm = 0.0001292 (50 iterations in 0.022s)
[t-SNE] KL divergence after 1000 iterations: 0.643347
[t-SNE] Computed conditional probabilities for sample 178 / 178
[t-SNE] Mean sigma: 0.413223
Beginning preprocessing + Leiden
2024-03-16 16:42:19.408254 MEMORY 13.996240896
Affmat transformed
2024-03-16 16:42:19.410599 MEMORY 13.996240896
sources, targets, weights extracted
2024-03-16 16:42:19.411456 MEMORY 13.996240896
About to launch parallel Leiden runs
2024-03-16 16:42:19.416122 MEMORY 13.996240896
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.8s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.2s finished
Parallel Leiden runs finished
2024-03-16 16:42:21.661377 MEMORY 13.996240896
Quality: 0.29023415148493165
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 126 out of 173 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=24)]: Done 173 out of 173 | elapsed:    0.1s finished
Got subclusters: Counter({0: 44, 1: 41, 2: 40, 3: 32, 4: 21})
On pattern 3
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 173 samples in 0.001s...
[t-SNE] Computed neighbors for 173 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 173 / 173
[t-SNE] Mean sigma: 0.375259
[t-SNE] Computed conditional probabilities in 0.011s
[t-SNE] Iteration 50: error = 61.4550705, gradient norm = 0.5307944 (50 iterations in 0.029s)
[t-SNE] Iteration 100: error = 59.6515770, gradient norm = 0.5081891 (50 iterations in 0.024s)
[t-SNE] Iteration 150: error = 59.9761124, gradient norm = 0.4969372 (50 iterations in 0.021s)
[t-SNE] Iteration 200: error = 60.6661072, gradient norm = 0.4867101 (50 iterations in 0.023s)
[t-SNE] Iteration 250: error = 57.6339417, gradient norm = 0.5411273 (50 iterations in 0.023s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 57.633942
[t-SNE] Iteration 300: error = 0.8345826, gradient norm = 0.0085744 (50 iterations in 0.023s)
[t-SNE] Iteration 350: error = 0.6113893, gradient norm = 0.0036269 (50 iterations in 0.023s)
[t-SNE] Iteration 400: error = 0.6075195, gradient norm = 0.0003359 (50 iterations in 0.021s)
[t-SNE] Iteration 450: error = 0.6072447, gradient norm = 0.0001937 (50 iterations in 0.022s)
[t-SNE] Iteration 500: error = 0.6074139, gradient norm = 0.0002821 (50 iterations in 0.024s)
[t-SNE] Iteration 550: error = 0.6071628, gradient norm = 0.0002518 (50 iterations in 0.022s)
[t-SNE] Iteration 600: error = 0.6076279, gradient norm = 0.0002669 (50 iterations in 0.022s)
[t-SNE] Iteration 650: error = 0.6071640, gradient norm = 0.0002416 (50 iterations in 0.022s)
[t-SNE] Iteration 700: error = 0.6072094, gradient norm = 0.0002316 (50 iterations in 0.022s)
[t-SNE] Iteration 750: error = 0.6072460, gradient norm = 0.0001850 (50 iterations in 0.022s)
[t-SNE] Iteration 800: error = 0.6073179, gradient norm = 0.0001189 (50 iterations in 0.022s)
[t-SNE] Iteration 850: error = 0.6072732, gradient norm = 0.0001828 (50 iterations in 0.021s)
[t-SNE] Iteration 900: error = 0.6074249, gradient norm = 0.0002642 (50 iterations in 0.021s)
[t-SNE] Iteration 900: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 900 iterations: 0.607425
[t-SNE] Computed conditional probabilities for sample 173 / 173
[t-SNE] Mean sigma: 0.375259
Beginning preprocessing + Leiden
2024-03-16 16:42:22.340216 MEMORY 13.996240896
Affmat transformed
2024-03-16 16:42:22.342508 MEMORY 13.996240896
sources, targets, weights extracted
2024-03-16 16:42:22.343358 MEMORY 13.996240896
About to launch parallel Leiden runs
2024-03-16 16:42:22.348318 MEMORY 13.996240896
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.8s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.1s finished
Parallel Leiden runs finished
2024-03-16 16:42:24.469831 MEMORY 13.996240896
Quality: 0.25476280765910814
Quality: 0.25830927389254116
Quality: 0.258482035274546
Quality: 0.2585948867570322
Quality: 0.2586337995923667
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 124 out of 171 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=24)]: Done 171 out of 171 | elapsed:    0.1s finished
Got subclusters: Counter({0: 43, 1: 39, 2: 33, 3: 23, 4: 19, 5: 16})
On pattern 4
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 171 samples in 0.001s...
[t-SNE] Computed neighbors for 171 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 171 / 171
[t-SNE] Mean sigma: 0.439955
[t-SNE] Computed conditional probabilities in 0.014s
[t-SNE] Iteration 50: error = 57.3806305, gradient norm = 0.4942074 (50 iterations in 0.023s)
[t-SNE] Iteration 100: error = 60.6605453, gradient norm = 0.5294934 (50 iterations in 0.023s)
[t-SNE] Iteration 150: error = 59.9303207, gradient norm = 0.5255108 (50 iterations in 0.023s)
[t-SNE] Iteration 200: error = 60.1472855, gradient norm = 0.4840531 (50 iterations in 0.022s)
[t-SNE] Iteration 250: error = 58.8089790, gradient norm = 0.5099899 (50 iterations in 0.024s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 58.808979
[t-SNE] Iteration 300: error = 0.9231076, gradient norm = 0.0101670 (50 iterations in 0.022s)
[t-SNE] Iteration 350: error = 0.6908343, gradient norm = 0.0045038 (50 iterations in 0.021s)
[t-SNE] Iteration 400: error = 0.6825252, gradient norm = 0.0003004 (50 iterations in 0.021s)
[t-SNE] Iteration 450: error = 0.6821318, gradient norm = 0.0002409 (50 iterations in 0.021s)
[t-SNE] Iteration 500: error = 0.6819845, gradient norm = 0.0001917 (50 iterations in 0.023s)
[t-SNE] Iteration 550: error = 0.6819722, gradient norm = 0.0001773 (50 iterations in 0.022s)
[t-SNE] Iteration 600: error = 0.6821020, gradient norm = 0.0001242 (50 iterations in 0.022s)
[t-SNE] Iteration 650: error = 0.6822058, gradient norm = 0.0000599 (50 iterations in 0.022s)
[t-SNE] Iteration 700: error = 0.6822066, gradient norm = 0.0001021 (50 iterations in 0.023s)
[t-SNE] Iteration 750: error = 0.6822214, gradient norm = 0.0000966 (50 iterations in 0.022s)
[t-SNE] Iteration 800: error = 0.6823934, gradient norm = 0.0001027 (50 iterations in 0.022s)
[t-SNE] Iteration 850: error = 0.6822067, gradient norm = 0.0002083 (50 iterations in 0.022s)
[t-SNE] Iteration 900: error = 0.6820039, gradient norm = 0.0002109 (50 iterations in 0.021s)
[t-SNE] Iteration 900: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 900 iterations: 0.682004
[t-SNE] Computed conditional probabilities for sample 171 / 171
[t-SNE] Mean sigma: 0.439955
Beginning preprocessing + Leiden
2024-03-16 16:42:25.126033 MEMORY 13.996240896
Affmat transformed
2024-03-16 16:42:25.128348 MEMORY 13.996240896
sources, targets, weights extracted
2024-03-16 16:42:25.129209 MEMORY 13.996240896
About to launch parallel Leiden runs
2024-03-16 16:42:25.133663 MEMORY 13.996240896
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.2s finished
Parallel Leiden runs finished
2024-03-16 16:42:27.304923 MEMORY 13.996240896
Quality: 0.2860420632243719
Quality: 0.28800548424606703
Quality: 0.2883054472468668
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  74 out of 121 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=24)]: Done 121 out of 121 | elapsed:    0.0s finished
Got subclusters: Counter({0: 47, 1: 46, 2: 39, 3: 36, 4: 3})
On pattern 5
[t-SNE] Computing 120 nearest neighbors...
[t-SNE] Indexed 121 samples in 0.001s...
[t-SNE] Computed neighbors for 121 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 121 / 121
[t-SNE] Mean sigma: 0.472199
[t-SNE] Computed conditional probabilities in 0.006s
[t-SNE] Iteration 50: error = 53.1596565, gradient norm = 0.5377163 (50 iterations in 0.019s)
[t-SNE] Iteration 100: error = 53.1688271, gradient norm = 0.5404584 (50 iterations in 0.017s)
[t-SNE] Iteration 150: error = 52.2920914, gradient norm = 0.4926256 (50 iterations in 0.018s)
[t-SNE] Iteration 200: error = 54.2008705, gradient norm = 0.4806713 (50 iterations in 0.017s)
[t-SNE] Iteration 250: error = 52.5998955, gradient norm = 0.4869485 (50 iterations in 0.017s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 52.599895
[t-SNE] Iteration 300: error = 0.5988268, gradient norm = 0.0130193 (50 iterations in 0.017s)
[t-SNE] Iteration 350: error = 0.4522717, gradient norm = 0.0016606 (50 iterations in 0.018s)
[t-SNE] Iteration 400: error = 0.4519780, gradient norm = 0.0003586 (50 iterations in 0.017s)
[t-SNE] Iteration 450: error = 0.4519501, gradient norm = 0.0003882 (50 iterations in 0.017s)
[t-SNE] Iteration 500: error = 0.4519102, gradient norm = 0.0003920 (50 iterations in 0.016s)
[t-SNE] Iteration 550: error = 0.4521550, gradient norm = 0.0003016 (50 iterations in 0.017s)
[t-SNE] Iteration 600: error = 0.4520805, gradient norm = 0.0003887 (50 iterations in 0.018s)
[t-SNE] Iteration 650: error = 0.4520184, gradient norm = 0.0003852 (50 iterations in 0.018s)
[t-SNE] Iteration 700: error = 0.4519591, gradient norm = 0.0002696 (50 iterations in 0.017s)
[t-SNE] Iteration 750: error = 0.4518266, gradient norm = 0.0002737 (50 iterations in 0.017s)
[t-SNE] Iteration 800: error = 0.4519385, gradient norm = 0.0003096 (50 iterations in 0.017s)
[t-SNE] Iteration 850: error = 0.4521085, gradient norm = 0.0002173 (50 iterations in 0.017s)
[t-SNE] Iteration 900: error = 0.4520787, gradient norm = 0.0001813 (50 iterations in 0.016s)
[t-SNE] Iteration 950: error = 0.4519154, gradient norm = 0.0003580 (50 iterations in 0.017s)
[t-SNE] Iteration 1000: error = 0.4519240, gradient norm = 0.0002492 (50 iterations in 0.016s)
[t-SNE] KL divergence after 1000 iterations: 0.451924
[t-SNE] Computed conditional probabilities for sample 121 / 121
[t-SNE] Mean sigma: 0.472199
Beginning preprocessing + Leiden
2024-03-16 16:42:27.826218 MEMORY 13.996240896
Affmat transformed
2024-03-16 16:42:27.827645 MEMORY 13.996240896
sources, targets, weights extracted
2024-03-16 16:42:27.828177 MEMORY 13.996240896
About to launch parallel Leiden runs
2024-03-16 16:42:27.833081 MEMORY 13.996240896
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.9s finished
Parallel Leiden runs finished
2024-03-16 16:42:29.732915 MEMORY 13.996240896
Quality: 0.24892687631561433
Quality: 0.250024260472889
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 114 out of 114 | elapsed:    0.0s finished
Got subclusters: Counter({0: 34, 1: 28, 2: 28, 3: 16, 4: 15})
On pattern 6
[t-SNE] Computing 113 nearest neighbors...
[t-SNE] Indexed 114 samples in 0.001s...
[t-SNE] Computed neighbors for 114 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 114 / 114
[t-SNE] Mean sigma: 0.498993
[t-SNE] Computed conditional probabilities in 0.006s
[t-SNE] Iteration 50: error = 55.1354904, gradient norm = 0.4446469 (50 iterations in 0.018s)
[t-SNE] Iteration 100: error = 56.8387032, gradient norm = 0.4278560 (50 iterations in 0.017s)
[t-SNE] Iteration 150: error = 57.0534058, gradient norm = 0.5396543 (50 iterations in 0.017s)
[t-SNE] Iteration 200: error = 55.4538231, gradient norm = 0.5564611 (50 iterations in 0.016s)
[t-SNE] Iteration 250: error = 58.1755028, gradient norm = 0.5055422 (50 iterations in 0.017s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 58.175503
[t-SNE] Iteration 300: error = 1.0210586, gradient norm = 0.0081807 (50 iterations in 0.016s)
[t-SNE] Iteration 350: error = 0.7773947, gradient norm = 0.0075217 (50 iterations in 0.017s)
[t-SNE] Iteration 400: error = 0.4341685, gradient norm = 0.0058016 (50 iterations in 0.017s)
[t-SNE] Iteration 450: error = 0.4314763, gradient norm = 0.0005907 (50 iterations in 0.017s)
[t-SNE] Iteration 500: error = 0.4314473, gradient norm = 0.0003833 (50 iterations in 0.016s)
[t-SNE] Iteration 550: error = 0.4314061, gradient norm = 0.0003548 (50 iterations in 0.017s)
[t-SNE] Iteration 600: error = 0.4315054, gradient norm = 0.0004852 (50 iterations in 0.017s)
[t-SNE] Iteration 650: error = 0.4314607, gradient norm = 0.0004695 (50 iterations in 0.020s)
[t-SNE] Iteration 700: error = 0.4315071, gradient norm = 0.0004504 (50 iterations in 0.039s)
[t-SNE] Iteration 750: error = 0.4314544, gradient norm = 0.0002754 (50 iterations in 0.016s)
[t-SNE] Iteration 800: error = 0.4315681, gradient norm = 0.0003701 (50 iterations in 0.015s)
[t-SNE] Iteration 850: error = 0.4313886, gradient norm = 0.0004964 (50 iterations in 0.016s)
[t-SNE] Iteration 900: error = 0.4315771, gradient norm = 0.0004118 (50 iterations in 0.016s)
[t-SNE] Iteration 950: error = 0.4314460, gradient norm = 0.0005345 (50 iterations in 0.016s)
[t-SNE] Iteration 1000: error = 0.4314914, gradient norm = 0.0003787 (50 iterations in 0.016s)
[t-SNE] KL divergence after 1000 iterations: 0.431491
[t-SNE] Computed conditional probabilities for sample 114 / 114
[t-SNE] Mean sigma: 0.498993
Beginning preprocessing + Leiden
2024-03-16 16:42:30.237068 MEMORY 13.996240896
Affmat transformed
2024-03-16 16:42:30.238408 MEMORY 13.996240896
sources, targets, weights extracted
2024-03-16 16:42:30.238902 MEMORY 13.996240896
About to launch parallel Leiden runs
2024-03-16 16:42:30.243963 MEMORY 13.996240896
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.8s finished
Parallel Leiden runs finished
2024-03-16 16:42:32.086207 MEMORY 13.996240896
Quality: 0.2361854970824694
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 112 out of 112 | elapsed:    0.0s finished
Got subclusters: Counter({0: 34, 1: 34, 2: 26, 3: 20})
On pattern 7
[t-SNE] Computing 111 nearest neighbors...
[t-SNE] Indexed 112 samples in 0.001s...
[t-SNE] Computed neighbors for 112 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 112 / 112
[t-SNE] Mean sigma: 0.496045
[t-SNE] Computed conditional probabilities in 0.006s
[t-SNE] Iteration 50: error = 53.9109650, gradient norm = 0.5360655 (50 iterations in 0.028s)
[t-SNE] Iteration 100: error = 56.6055489, gradient norm = 0.4638745 (50 iterations in 0.016s)
[t-SNE] Iteration 150: error = 52.0456810, gradient norm = 0.6366296 (50 iterations in 0.017s)
[t-SNE] Iteration 200: error = 56.1227379, gradient norm = 0.4565573 (50 iterations in 0.017s)
[t-SNE] Iteration 250: error = 52.8302879, gradient norm = 0.5012861 (50 iterations in 0.016s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 52.830288
[t-SNE] Iteration 300: error = 0.8927991, gradient norm = 0.0072314 (50 iterations in 0.016s)
[t-SNE] Iteration 350: error = 0.4600140, gradient norm = 0.0142311 (50 iterations in 0.017s)
[t-SNE] Iteration 400: error = 0.4072176, gradient norm = 0.0041286 (50 iterations in 0.016s)
[t-SNE] Iteration 450: error = 0.4031669, gradient norm = 0.0005023 (50 iterations in 0.016s)
[t-SNE] Iteration 500: error = 0.4030805, gradient norm = 0.0003268 (50 iterations in 0.016s)
[t-SNE] Iteration 550: error = 0.4030179, gradient norm = 0.0003199 (50 iterations in 0.016s)
[t-SNE] Iteration 600: error = 0.4033457, gradient norm = 0.0003251 (50 iterations in 0.016s)
[t-SNE] Iteration 650: error = 0.4033299, gradient norm = 0.0004065 (50 iterations in 0.016s)
[t-SNE] Iteration 700: error = 0.4030602, gradient norm = 0.0002257 (50 iterations in 0.016s)
[t-SNE] Iteration 750: error = 0.4032185, gradient norm = 0.0004029 (50 iterations in 0.016s)
[t-SNE] Iteration 800: error = 0.4032167, gradient norm = 0.0002937 (50 iterations in 0.016s)
[t-SNE] Iteration 850: error = 0.4031018, gradient norm = 0.0003261 (50 iterations in 0.016s)
[t-SNE] Iteration 900: error = 0.4030749, gradient norm = 0.0002350 (50 iterations in 0.016s)
[t-SNE] Iteration 900: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 900 iterations: 0.403075
[t-SNE] Computed conditional probabilities for sample 112 / 112
[t-SNE] Mean sigma: 0.496045
Beginning preprocessing + Leiden
2024-03-16 16:42:32.531258 MEMORY 13.996240896
Affmat transformed
2024-03-16 16:42:32.532695 MEMORY 13.996240896
sources, targets, weights extracted
2024-03-16 16:42:32.533249 MEMORY 13.996240896
About to launch parallel Leiden runs
2024-03-16 16:42:32.537246 MEMORY 13.996240896
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.9s finished
Parallel Leiden runs finished
2024-03-16 16:42:34.394969 MEMORY 13.996240896
Quality: 0.21142125088085964
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  54 out of 101 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=24)]: Done 101 out of 101 | elapsed:    0.0s finished
Got subclusters: Counter({0: 36, 1: 35, 2: 29, 3: 12})
On pattern 8
[t-SNE] Computing 100 nearest neighbors...
[t-SNE] Indexed 101 samples in 0.001s...
[t-SNE] Computed neighbors for 101 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 101 / 101
[t-SNE] Mean sigma: 0.498352
[t-SNE] Computed conditional probabilities in 0.004s
[t-SNE] Iteration 50: error = 52.9045296, gradient norm = 0.5911185 (50 iterations in 0.026s)
[t-SNE] Iteration 100: error = 49.5211067, gradient norm = 0.5943160 (50 iterations in 0.015s)
[t-SNE] Iteration 150: error = 51.6399765, gradient norm = 0.5286834 (50 iterations in 0.015s)
[t-SNE] Iteration 200: error = 50.3043175, gradient norm = 0.5904391 (50 iterations in 0.015s)
[t-SNE] Iteration 250: error = 51.9078674, gradient norm = 0.5547212 (50 iterations in 0.015s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 51.907867
[t-SNE] Iteration 300: error = 0.5896198, gradient norm = 0.0154075 (50 iterations in 0.015s)
[t-SNE] Iteration 350: error = 0.3323812, gradient norm = 0.0042361 (50 iterations in 0.015s)
[t-SNE] Iteration 400: error = 0.3313336, gradient norm = 0.0006735 (50 iterations in 0.015s)
[t-SNE] Iteration 450: error = 0.3312994, gradient norm = 0.0006380 (50 iterations in 0.015s)
[t-SNE] Iteration 500: error = 0.3313521, gradient norm = 0.0005805 (50 iterations in 0.015s)
[t-SNE] Iteration 550: error = 0.3313678, gradient norm = 0.0005984 (50 iterations in 0.015s)
[t-SNE] Iteration 600: error = 0.3315304, gradient norm = 0.0006378 (50 iterations in 0.015s)
[t-SNE] Iteration 650: error = 0.3313540, gradient norm = 0.0006205 (50 iterations in 0.014s)
[t-SNE] Iteration 700: error = 0.3313579, gradient norm = 0.0005031 (50 iterations in 0.015s)
[t-SNE] Iteration 750: error = 0.3314124, gradient norm = 0.0006230 (50 iterations in 0.015s)
[t-SNE] Iteration 800: error = 0.3312467, gradient norm = 0.0005472 (50 iterations in 0.015s)
[t-SNE] Iteration 850: error = 0.3312450, gradient norm = 0.0005961 (50 iterations in 0.015s)
[t-SNE] Iteration 900: error = 0.3313045, gradient norm = 0.0006311 (50 iterations in 0.015s)
[t-SNE] Iteration 950: error = 0.3313967, gradient norm = 0.0005521 (50 iterations in 0.015s)
[t-SNE] Iteration 1000: error = 0.3314312, gradient norm = 0.0005802 (50 iterations in 0.015s)
[t-SNE] KL divergence after 1000 iterations: 0.331431
[t-SNE] Computed conditional probabilities for sample 101 / 101
[t-SNE] Mean sigma: 0.498352
Beginning preprocessing + Leiden
2024-03-16 16:42:34.820590 MEMORY 13.996240896
Affmat transformed
2024-03-16 16:42:34.821706 MEMORY 13.996240896
sources, targets, weights extracted
2024-03-16 16:42:34.822146 MEMORY 13.996240896
About to launch parallel Leiden runs
2024-03-16 16:42:34.863743 MEMORY 13.996240896
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.8s finished
Parallel Leiden runs finished
2024-03-16 16:42:36.695178 MEMORY 13.996240896
Quality: 0.2091737022983829
Quality: 0.2093500221258837
Quality: 0.20987148768316033
Quality: 0.21085006249271696
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  50 out of  97 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=24)]: Done  97 out of  97 | elapsed:    0.0s finished
Got subclusters: Counter({0: 28, 1: 26, 2: 25, 3: 22})
On pattern 9
[t-SNE] Computing 96 nearest neighbors...
[t-SNE] Indexed 97 samples in 0.001s...
[t-SNE] Computed neighbors for 97 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 97 / 97
[t-SNE] Mean sigma: 0.540630
[t-SNE] Computed conditional probabilities in 0.004s
[t-SNE] Iteration 50: error = 53.8604698, gradient norm = 0.4773144 (50 iterations in 0.015s)
[t-SNE] Iteration 100: error = 52.0601120, gradient norm = 0.5575679 (50 iterations in 0.015s)
[t-SNE] Iteration 150: error = 53.4200897, gradient norm = 0.5310359 (50 iterations in 0.015s)
[t-SNE] Iteration 200: error = 52.2315788, gradient norm = 0.5436149 (50 iterations in 0.015s)
[t-SNE] Iteration 250: error = 51.0742416, gradient norm = 0.5602347 (50 iterations in 0.015s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 51.074242
[t-SNE] Iteration 300: error = 0.8725370, gradient norm = 0.0085593 (50 iterations in 0.014s)
[t-SNE] Iteration 350: error = 0.5706374, gradient norm = 0.0127519 (50 iterations in 0.014s)
[t-SNE] Iteration 400: error = 0.3164970, gradient norm = 0.0076509 (50 iterations in 0.015s)
[t-SNE] Iteration 450: error = 0.3143492, gradient norm = 0.0007923 (50 iterations in 0.014s)
[t-SNE] Iteration 500: error = 0.3145994, gradient norm = 0.0004113 (50 iterations in 0.015s)
[t-SNE] Iteration 550: error = 0.3143131, gradient norm = 0.0005008 (50 iterations in 0.014s)
[t-SNE] Iteration 600: error = 0.3143163, gradient norm = 0.0005631 (50 iterations in 0.014s)
[t-SNE] Iteration 650: error = 0.3144016, gradient norm = 0.0003614 (50 iterations in 0.014s)
[t-SNE] Iteration 700: error = 0.3143502, gradient norm = 0.0004088 (50 iterations in 0.014s)
[t-SNE] Iteration 750: error = 0.3144271, gradient norm = 0.0003859 (50 iterations in 0.014s)
[t-SNE] Iteration 800: error = 0.3144160, gradient norm = 0.0004330 (50 iterations in 0.014s)
[t-SNE] Iteration 850: error = 0.3144083, gradient norm = 0.0005645 (50 iterations in 0.014s)
[t-SNE] Iteration 900: error = 0.3143951, gradient norm = 0.0004815 (50 iterations in 0.014s)
[t-SNE] Iteration 900: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 900 iterations: 0.314395
[t-SNE] Computed conditional probabilities for sample 97 / 97
[t-SNE] Mean sigma: 0.540630
Beginning preprocessing + Leiden
2024-03-16 16:42:37.061783 MEMORY 13.996240896
Affmat transformed
2024-03-16 16:42:37.062864 MEMORY 13.996240896
sources, targets, weights extracted
2024-03-16 16:42:37.063286 MEMORY 13.996240896
About to launch parallel Leiden runs
2024-03-16 16:42:37.067485 MEMORY 13.996240896
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.6s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.8s finished
Parallel Leiden runs finished
2024-03-16 16:42:38.871147 MEMORY 13.996240896
Quality: 0.20274115477063864
Quality: 0.20284781055802353
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  92 out of  92 | elapsed:    0.0s finished
Got subclusters: Counter({0: 26, 1: 26, 2: 21, 3: 18, 4: 6})
On pattern 10
[t-SNE] Computing 91 nearest neighbors...
[t-SNE] Indexed 92 samples in 0.001s...
[t-SNE] Computed neighbors for 92 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 92 / 92
[t-SNE] Mean sigma: 0.583917
[t-SNE] Computed conditional probabilities in 0.004s
[t-SNE] Iteration 50: error = 50.8442993, gradient norm = 0.4479337 (50 iterations in 0.015s)
[t-SNE] Iteration 100: error = 50.4314575, gradient norm = 0.5083715 (50 iterations in 0.014s)
[t-SNE] Iteration 150: error = 53.1439323, gradient norm = 0.5196000 (50 iterations in 0.014s)
[t-SNE] Iteration 200: error = 53.4185410, gradient norm = 0.4299429 (50 iterations in 0.014s)
[t-SNE] Iteration 250: error = 49.2480812, gradient norm = 0.4834623 (50 iterations in 0.014s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 49.248081
[t-SNE] Iteration 300: error = 0.4775961, gradient norm = 0.0169385 (50 iterations in 0.014s)
[t-SNE] Iteration 350: error = 0.2597436, gradient norm = 0.0028119 (50 iterations in 0.014s)
[t-SNE] Iteration 400: error = 0.2589603, gradient norm = 0.0006860 (50 iterations in 0.014s)
[t-SNE] Iteration 450: error = 0.2593102, gradient norm = 0.0006257 (50 iterations in 0.014s)
[t-SNE] Iteration 500: error = 0.2592992, gradient norm = 0.0006620 (50 iterations in 0.014s)
[t-SNE] Iteration 550: error = 0.2591335, gradient norm = 0.0007396 (50 iterations in 0.014s)
[t-SNE] Iteration 600: error = 0.2588037, gradient norm = 0.0005379 (50 iterations in 0.014s)
[t-SNE] Iteration 650: error = 0.2590570, gradient norm = 0.0006424 (50 iterations in 0.014s)
[t-SNE] Iteration 700: error = 0.2592890, gradient norm = 0.0007529 (50 iterations in 0.014s)
[t-SNE] Iteration 750: error = 0.2593497, gradient norm = 0.0006287 (50 iterations in 0.014s)
[t-SNE] Iteration 800: error = 0.2593870, gradient norm = 0.0006387 (50 iterations in 0.014s)
[t-SNE] Iteration 850: error = 0.2594163, gradient norm = 0.0006320 (50 iterations in 0.014s)
[t-SNE] Iteration 900: error = 0.2593693, gradient norm = 0.0006656 (50 iterations in 0.014s)
[t-SNE] Iteration 950: error = 0.2589947, gradient norm = 0.0008116 (50 iterations in 0.014s)
[t-SNE] Iteration 950: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 950 iterations: 0.258995
[t-SNE] Computed conditional probabilities for sample 92 / 92
[t-SNE] Mean sigma: 0.583917
Beginning preprocessing + Leiden
2024-03-16 16:42:39.246777 MEMORY 13.996240896
Affmat transformed
2024-03-16 16:42:39.247857 MEMORY 13.996240896
sources, targets, weights extracted
2024-03-16 16:42:39.248282 MEMORY 13.996240896
About to launch parallel Leiden runs
2024-03-16 16:42:39.252414 MEMORY 13.996240896
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.6s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.8s finished
Parallel Leiden runs finished
2024-03-16 16:42:41.046102 MEMORY 13.996240896
Quality: 0.2012498230554061
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  90 out of  90 | elapsed:    0.0s finished
Got subclusters: Counter({0: 27, 1: 25, 2: 21, 3: 19})
On pattern 11
[t-SNE] Computing 89 nearest neighbors...
[t-SNE] Indexed 90 samples in 0.001s...
[t-SNE] Computed neighbors for 90 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 90 / 90
[t-SNE] Mean sigma: 0.616812
[t-SNE] Computed conditional probabilities in 0.005s
[t-SNE] Iteration 50: error = 48.3856773, gradient norm = 0.5551991 (50 iterations in 0.014s)
[t-SNE] Iteration 100: error = 51.2683067, gradient norm = 0.5337015 (50 iterations in 0.014s)
[t-SNE] Iteration 150: error = 51.4964066, gradient norm = 0.5518512 (50 iterations in 0.014s)
[t-SNE] Iteration 200: error = 48.4305000, gradient norm = 0.5257003 (50 iterations in 0.014s)
[t-SNE] Iteration 250: error = 52.3475456, gradient norm = 0.4757231 (50 iterations in 0.014s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 52.347546
[t-SNE] Iteration 300: error = 0.8341654, gradient norm = 0.0085832 (50 iterations in 0.014s)
[t-SNE] Iteration 350: error = 0.6640774, gradient norm = 0.0060290 (50 iterations in 0.014s)
[t-SNE] Iteration 400: error = 0.2953648, gradient norm = 0.0090724 (50 iterations in 0.014s)
[t-SNE] Iteration 450: error = 0.2896665, gradient norm = 0.0012788 (50 iterations in 0.014s)
[t-SNE] Iteration 500: error = 0.2896836, gradient norm = 0.0007514 (50 iterations in 0.014s)
[t-SNE] Iteration 550: error = 0.2892612, gradient norm = 0.0007801 (50 iterations in 0.013s)
[t-SNE] Iteration 600: error = 0.2897006, gradient norm = 0.0008524 (50 iterations in 0.013s)
[t-SNE] Iteration 650: error = 0.2899846, gradient norm = 0.0007671 (50 iterations in 0.013s)
[t-SNE] Iteration 700: error = 0.2895410, gradient norm = 0.0009158 (50 iterations in 0.013s)
[t-SNE] Iteration 750: error = 0.2895570, gradient norm = 0.0008149 (50 iterations in 0.014s)
[t-SNE] Iteration 800: error = 0.2899452, gradient norm = 0.0007229 (50 iterations in 0.013s)
[t-SNE] Iteration 850: error = 0.2892972, gradient norm = 0.0008384 (50 iterations in 0.013s)
[t-SNE] Iteration 900: error = 0.2895212, gradient norm = 0.0009194 (50 iterations in 0.013s)
[t-SNE] Iteration 900: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 900 iterations: 0.289521
[t-SNE] Computed conditional probabilities for sample 90 / 90
[t-SNE] Mean sigma: 0.616812
Beginning preprocessing + Leiden
2024-03-16 16:42:41.398219 MEMORY 13.996240896
Affmat transformed
2024-03-16 16:42:41.399214 MEMORY 13.996240896
sources, targets, weights extracted
2024-03-16 16:42:41.399610 MEMORY 13.996240896
About to launch parallel Leiden runs
2024-03-16 16:42:41.404632 MEMORY 13.996240896
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.6s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.8s finished
Parallel Leiden runs finished
2024-03-16 16:42:43.209019 MEMORY 13.996240896
Quality: 0.17417555544329985
Quality: 0.1790130233399466
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  89 out of  89 | elapsed:    0.0s finished
Got subclusters: Counter({0: 27, 1: 23, 2: 21, 3: 19})
On pattern 12
[t-SNE] Computing 88 nearest neighbors...
[t-SNE] Indexed 89 samples in 0.001s...
[t-SNE] Computed neighbors for 89 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 89 / 89
[t-SNE] Mean sigma: 0.544570
[t-SNE] Computed conditional probabilities in 0.003s
[t-SNE] Iteration 50: error = 52.2409859, gradient norm = 0.4612470 (50 iterations in 0.017s)
[t-SNE] Iteration 100: error = 52.1085434, gradient norm = 0.4515193 (50 iterations in 0.014s)
[t-SNE] Iteration 150: error = 49.2640457, gradient norm = 0.6047251 (50 iterations in 0.014s)
[t-SNE] Iteration 200: error = 51.0761566, gradient norm = 0.5068364 (50 iterations in 0.014s)
[t-SNE] Iteration 250: error = 49.1384277, gradient norm = 0.5898793 (50 iterations in 0.014s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 49.138428
[t-SNE] Iteration 300: error = 0.7324164, gradient norm = 0.0074823 (50 iterations in 0.014s)
[t-SNE] Iteration 350: error = 0.2663257, gradient norm = 0.0168830 (50 iterations in 0.014s)
[t-SNE] Iteration 400: error = 0.2462355, gradient norm = 0.0017176 (50 iterations in 0.016s)
[t-SNE] Iteration 450: error = 0.2460983, gradient norm = 0.0005430 (50 iterations in 0.013s)
[t-SNE] Iteration 500: error = 0.2461362, gradient norm = 0.0007910 (50 iterations in 0.014s)
[t-SNE] Iteration 550: error = 0.2461378, gradient norm = 0.0005699 (50 iterations in 0.013s)
[t-SNE] Iteration 600: error = 0.2461521, gradient norm = 0.0005027 (50 iterations in 0.013s)
[t-SNE] Iteration 650: error = 0.2461470, gradient norm = 0.0005759 (50 iterations in 0.014s)
[t-SNE] Iteration 700: error = 0.2460918, gradient norm = 0.0006131 (50 iterations in 0.014s)
[t-SNE] Iteration 750: error = 0.2460379, gradient norm = 0.0006497 (50 iterations in 0.013s)
[t-SNE] Iteration 800: error = 0.2462174, gradient norm = 0.0007632 (50 iterations in 0.014s)
[t-SNE] Iteration 850: error = 0.2461700, gradient norm = 0.0006495 (50 iterations in 0.013s)
[t-SNE] Iteration 900: error = 0.2461739, gradient norm = 0.0007129 (50 iterations in 0.014s)
[t-SNE] Iteration 950: error = 0.2461345, gradient norm = 0.0005258 (50 iterations in 0.014s)
[t-SNE] Iteration 1000: error = 0.2461815, gradient norm = 0.0013079 (50 iterations in 0.013s)
[t-SNE] KL divergence after 1000 iterations: 0.246182
[t-SNE] Computed conditional probabilities for sample 89 / 89
[t-SNE] Mean sigma: 0.544570
Beginning preprocessing + Leiden
2024-03-16 16:42:43.593909 MEMORY 13.996240896
Affmat transformed
2024-03-16 16:42:43.594950 MEMORY 13.996240896
sources, targets, weights extracted
2024-03-16 16:42:43.595383 MEMORY 13.996240896
About to launch parallel Leiden runs
2024-03-16 16:42:43.599987 MEMORY 13.996240896
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.8s finished
Parallel Leiden runs finished
2024-03-16 16:42:45.381625 MEMORY 13.996240896
Quality: 0.1881049327894094
Quality: 0.19104751023946417
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  87 out of  87 | elapsed:    0.0s finished
Got subclusters: Counter({0: 30, 1: 27, 2: 18, 3: 14})
On pattern 13
[t-SNE] Computing 86 nearest neighbors...
[t-SNE] Indexed 87 samples in 0.001s...
[t-SNE] Computed neighbors for 87 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 87 / 87
[t-SNE] Mean sigma: 0.575573
[t-SNE] Computed conditional probabilities in 0.003s
[t-SNE] Iteration 50: error = 50.8731842, gradient norm = 0.4852679 (50 iterations in 0.016s)
[t-SNE] Iteration 100: error = 51.8195724, gradient norm = 0.5188503 (50 iterations in 0.014s)
[t-SNE] Iteration 150: error = 53.3481560, gradient norm = 0.4633374 (50 iterations in 0.015s)
[t-SNE] Iteration 200: error = 52.5070496, gradient norm = 0.4931018 (50 iterations in 0.015s)
[t-SNE] Iteration 250: error = 49.4687576, gradient norm = 0.5371240 (50 iterations in 0.014s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 49.468758
[t-SNE] Iteration 300: error = 0.6551467, gradient norm = 0.0080946 (50 iterations in 0.013s)
[t-SNE] Iteration 350: error = 0.2645974, gradient norm = 0.0160859 (50 iterations in 0.014s)
[t-SNE] Iteration 400: error = 0.2502385, gradient norm = 0.0016742 (50 iterations in 0.013s)
[t-SNE] Iteration 450: error = 0.2502299, gradient norm = 0.0007966 (50 iterations in 0.013s)
[t-SNE] Iteration 500: error = 0.2501894, gradient norm = 0.0006557 (50 iterations in 0.014s)
[t-SNE] Iteration 550: error = 0.2500746, gradient norm = 0.0006030 (50 iterations in 0.013s)
[t-SNE] Iteration 600: error = 0.2501554, gradient norm = 0.0006472 (50 iterations in 0.013s)
[t-SNE] Iteration 650: error = 0.2502331, gradient norm = 0.0008133 (50 iterations in 0.014s)
[t-SNE] Iteration 700: error = 0.2503954, gradient norm = 0.0007265 (50 iterations in 0.013s)
[t-SNE] Iteration 750: error = 0.2500399, gradient norm = 0.0006347 (50 iterations in 0.013s)
[t-SNE] Iteration 800: error = 0.2501437, gradient norm = 0.0005420 (50 iterations in 0.013s)
[t-SNE] Iteration 850: error = 0.2500851, gradient norm = 0.0006294 (50 iterations in 0.013s)
[t-SNE] Iteration 900: error = 0.2501041, gradient norm = 0.0006744 (50 iterations in 0.013s)
[t-SNE] Iteration 950: error = 0.2500980, gradient norm = 0.0006978 (50 iterations in 0.013s)
[t-SNE] Iteration 1000: error = 0.2501948, gradient norm = 0.0007600 (50 iterations in 0.013s)
[t-SNE] KL divergence after 1000 iterations: 0.250195
[t-SNE] Computed conditional probabilities for sample 87 / 87
[t-SNE] Mean sigma: 0.575573
Beginning preprocessing + Leiden
2024-03-16 16:42:45.757939 MEMORY 13.996240896
Affmat transformed
2024-03-16 16:42:45.758982 MEMORY 13.996240896
sources, targets, weights extracted
2024-03-16 16:42:45.759390 MEMORY 13.996240896
About to launch parallel Leiden runs
2024-03-16 16:42:45.764387 MEMORY 13.996240896
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.6s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.8s finished
Parallel Leiden runs finished
2024-03-16 16:42:47.532075 MEMORY 13.996240896
Quality: 0.1862614609727986
Quality: 0.18972589408149562
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  65 out of  65 | elapsed:    0.0s finished
Got subclusters: Counter({1: 25, 0: 25, 2: 22, 3: 15})
On pattern 14
[t-SNE] Computing 64 nearest neighbors...
[t-SNE] Indexed 65 samples in 0.001s...
[t-SNE] Computed neighbors for 65 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 65 / 65
[t-SNE] Mean sigma: 0.682257
[t-SNE] Computed conditional probabilities in 0.002s
[t-SNE] Iteration 50: error = 46.2893677, gradient norm = 0.5743254 (50 iterations in 0.017s)
[t-SNE] Iteration 100: error = 48.3172874, gradient norm = 0.5020815 (50 iterations in 0.012s)
[t-SNE] Iteration 150: error = 49.9505615, gradient norm = 0.3757390 (50 iterations in 0.012s)
[t-SNE] Iteration 200: error = 48.9085579, gradient norm = 0.5375607 (50 iterations in 0.012s)
[t-SNE] Iteration 250: error = 49.2848320, gradient norm = 0.4212762 (50 iterations in 0.012s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 49.284832
[t-SNE] Iteration 300: error = 0.8022078, gradient norm = 0.0018524 (50 iterations in 0.013s)
[t-SNE] Iteration 350: error = 0.6765720, gradient norm = 0.0006281 (50 iterations in 0.012s)
[t-SNE] Iteration 400: error = 0.6403204, gradient norm = 0.0003442 (50 iterations in 0.012s)
[t-SNE] Iteration 450: error = 0.6113992, gradient norm = 0.0005137 (50 iterations in 0.012s)
[t-SNE] Iteration 500: error = 0.5841348, gradient norm = 0.0002163 (50 iterations in 0.012s)
[t-SNE] Iteration 550: error = 0.5689428, gradient norm = 0.0002517 (50 iterations in 0.012s)
[t-SNE] Iteration 600: error = 0.5581992, gradient norm = 0.0001529 (50 iterations in 0.012s)
[t-SNE] Iteration 650: error = 0.5480034, gradient norm = 0.0002406 (50 iterations in 0.012s)
[t-SNE] Iteration 700: error = 0.5407431, gradient norm = 0.0001343 (50 iterations in 0.012s)
[t-SNE] Iteration 750: error = 0.5385216, gradient norm = 0.0001035 (50 iterations in 0.012s)
[t-SNE] Iteration 800: error = 0.5293061, gradient norm = 0.0003219 (50 iterations in 0.012s)
[t-SNE] Iteration 850: error = 0.5190686, gradient norm = 0.0001959 (50 iterations in 0.012s)
[t-SNE] Iteration 900: error = 0.5061404, gradient norm = 0.0004451 (50 iterations in 0.012s)
[t-SNE] Iteration 950: error = 0.4973264, gradient norm = 0.0003125 (50 iterations in 0.012s)
[t-SNE] Iteration 1000: error = 0.4879061, gradient norm = 0.0003735 (50 iterations in 0.012s)
[t-SNE] KL divergence after 1000 iterations: 0.487906
[t-SNE] Computed conditional probabilities for sample 65 / 65
[t-SNE] Mean sigma: 0.682257
Beginning preprocessing + Leiden
2024-03-16 16:42:47.857298 MEMORY 13.996240896
Affmat transformed
2024-03-16 16:42:47.858186 MEMORY 13.996240896
sources, targets, weights extracted
2024-03-16 16:42:47.858584 MEMORY 13.996240896
About to launch parallel Leiden runs
2024-03-16 16:42:47.879046 MEMORY 13.996240896
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.6s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.8s finished
Parallel Leiden runs finished
2024-03-16 16:42:49.634952 MEMORY 13.996240896
Quality: 0.1028300945566145
Quality: 0.10539091317744329
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  65 out of  65 | elapsed:    0.0s finished
Got subclusters: Counter({0: 25, 1: 24, 2: 11, 3: 5})
On pattern 15
[t-SNE] Computing 64 nearest neighbors...
[t-SNE] Indexed 65 samples in 0.001s...
[t-SNE] Computed neighbors for 65 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 65 / 65
[t-SNE] Mean sigma: 0.712755
[t-SNE] Computed conditional probabilities in 0.002s
[t-SNE] Iteration 50: error = 46.6769829, gradient norm = 0.4431584 (50 iterations in 0.012s)
[t-SNE] Iteration 100: error = 46.7127266, gradient norm = 0.6324465 (50 iterations in 0.012s)
[t-SNE] Iteration 150: error = 50.4913292, gradient norm = 0.4673774 (50 iterations in 0.012s)
[t-SNE] Iteration 200: error = 47.1866608, gradient norm = 0.4588853 (50 iterations in 0.012s)
[t-SNE] Iteration 250: error = 47.9415512, gradient norm = 0.6601113 (50 iterations in 0.012s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 47.941551
[t-SNE] Iteration 300: error = 0.8450954, gradient norm = 0.0016048 (50 iterations in 0.012s)
[t-SNE] Iteration 350: error = 0.7537653, gradient norm = 0.0007407 (50 iterations in 0.011s)
[t-SNE] Iteration 400: error = 0.7007234, gradient norm = 0.0005420 (50 iterations in 0.012s)
[t-SNE] Iteration 450: error = 0.6746382, gradient norm = 0.0004514 (50 iterations in 0.011s)
[t-SNE] Iteration 500: error = 0.6471218, gradient norm = 0.0004472 (50 iterations in 0.011s)
[t-SNE] Iteration 550: error = 0.6087248, gradient norm = 0.0006567 (50 iterations in 0.011s)
[t-SNE] Iteration 600: error = 0.5579866, gradient norm = 0.0004344 (50 iterations in 0.011s)
[t-SNE] Iteration 650: error = 0.5373523, gradient norm = 0.0002729 (50 iterations in 0.011s)
[t-SNE] Iteration 700: error = 0.5254012, gradient norm = 0.0003219 (50 iterations in 0.011s)
[t-SNE] Iteration 750: error = 0.5146646, gradient norm = 0.0002225 (50 iterations in 0.011s)
[t-SNE] Iteration 800: error = 0.5119935, gradient norm = 0.0001631 (50 iterations in 0.011s)
[t-SNE] Iteration 850: error = 0.5071406, gradient norm = 0.0001889 (50 iterations in 0.011s)
[t-SNE] Iteration 900: error = 0.5005264, gradient norm = 0.0002508 (50 iterations in 0.011s)
[t-SNE] Iteration 950: error = 0.4898754, gradient norm = 0.0006177 (50 iterations in 0.011s)
[t-SNE] Iteration 1000: error = 0.4790598, gradient norm = 0.0004531 (50 iterations in 0.012s)
[t-SNE] KL divergence after 1000 iterations: 0.479060
[t-SNE] Computed conditional probabilities for sample 65 / 65
[t-SNE] Mean sigma: 0.712754
Beginning preprocessing + Leiden
2024-03-16 16:42:49.934779 MEMORY 13.996240896
Affmat transformed
2024-03-16 16:42:49.935609 MEMORY 13.996240896
sources, targets, weights extracted
2024-03-16 16:42:49.935955 MEMORY 13.996240896
About to launch parallel Leiden runs
2024-03-16 16:42:49.939923 MEMORY 13.996240896
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.6s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.7s finished
Parallel Leiden runs finished
2024-03-16 16:42:51.651550 MEMORY 13.996240896
Quality: 0.11952856063220875
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  64 out of  64 | elapsed:    0.0s finished
Got subclusters: Counter({0: 27, 1: 25, 2: 13})
On pattern 16
[t-SNE] Computing 63 nearest neighbors...
[t-SNE] Indexed 64 samples in 0.000s...
[t-SNE] Computed neighbors for 64 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 64 / 64
[t-SNE] Mean sigma: 0.780046
[t-SNE] Computed conditional probabilities in 0.002s
[t-SNE] Iteration 50: error = 47.4302216, gradient norm = 0.5918663 (50 iterations in 0.061s)
[t-SNE] Iteration 100: error = 50.8773537, gradient norm = 0.5239019 (50 iterations in 0.012s)
[t-SNE] Iteration 150: error = 50.1472130, gradient norm = 0.5143468 (50 iterations in 0.012s)
[t-SNE] Iteration 200: error = 47.8693581, gradient norm = 0.5883386 (50 iterations in 0.012s)
[t-SNE] Iteration 250: error = 48.1014519, gradient norm = 0.6626712 (50 iterations in 0.012s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 48.101452
[t-SNE] Iteration 300: error = 0.8492332, gradient norm = 0.0014655 (50 iterations in 0.012s)
[t-SNE] Iteration 350: error = 0.7759457, gradient norm = 0.0007243 (50 iterations in 0.011s)
[t-SNE] Iteration 400: error = 0.7221715, gradient norm = 0.0005517 (50 iterations in 0.011s)
[t-SNE] Iteration 450: error = 0.6821055, gradient norm = 0.0006567 (50 iterations in 0.011s)
[t-SNE] Iteration 500: error = 0.6339539, gradient norm = 0.0006083 (50 iterations in 0.011s)
[t-SNE] Iteration 550: error = 0.6154687, gradient norm = 0.0003666 (50 iterations in 0.012s)
[t-SNE] Iteration 600: error = 0.6044450, gradient norm = 0.0002947 (50 iterations in 0.011s)
[t-SNE] Iteration 650: error = 0.5951328, gradient norm = 0.0005433 (50 iterations in 0.011s)
[t-SNE] Iteration 700: error = 0.5859101, gradient norm = 0.0003146 (50 iterations in 0.011s)
[t-SNE] Iteration 750: error = 0.5816135, gradient norm = 0.0002698 (50 iterations in 0.011s)
[t-SNE] Iteration 800: error = 0.5696869, gradient norm = 0.0014031 (50 iterations in 0.011s)
[t-SNE] Iteration 850: error = 1.0177281, gradient norm = 0.0015016 (50 iterations in 0.011s)
[t-SNE] Iteration 900: error = 0.8707929, gradient norm = 0.0005289 (50 iterations in 0.011s)
[t-SNE] Iteration 950: error = 0.8017491, gradient norm = 0.0003186 (50 iterations in 0.011s)
[t-SNE] Iteration 1000: error = 0.7692147, gradient norm = 0.0002426 (50 iterations in 0.011s)
[t-SNE] KL divergence after 1000 iterations: 0.769215
[t-SNE] Computed conditional probabilities for sample 64 / 64
[t-SNE] Mean sigma: 0.780046
Beginning preprocessing + Leiden
2024-03-16 16:42:51.995835 MEMORY 13.996240896
Affmat transformed
2024-03-16 16:42:51.996702 MEMORY 13.996240896
sources, targets, weights extracted
2024-03-16 16:42:51.997063 MEMORY 13.996240896
About to launch parallel Leiden runs
2024-03-16 16:42:52.000694 MEMORY 13.996240896
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.6s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.7s finished
Parallel Leiden runs finished
2024-03-16 16:42:53.713155 MEMORY 13.996240896
Quality: 0.11322566407295817
Quality: 0.11748934184291755
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  64 out of  64 | elapsed:    0.0s finished
Got subclusters: Counter({0: 23, 1: 21, 2: 20})
On pattern 17
[t-SNE] Computing 63 nearest neighbors...
[t-SNE] Indexed 64 samples in 0.000s...
[t-SNE] Computed neighbors for 64 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 64 / 64
[t-SNE] Mean sigma: 0.744286
[t-SNE] Computed conditional probabilities in 0.002s
[t-SNE] Iteration 50: error = 50.6182556, gradient norm = 0.5098403 (50 iterations in 0.030s)
[t-SNE] Iteration 100: error = 46.3713989, gradient norm = 0.5100012 (50 iterations in 0.012s)
[t-SNE] Iteration 150: error = 46.6499329, gradient norm = 0.4545598 (50 iterations in 0.012s)
[t-SNE] Iteration 200: error = 46.3728409, gradient norm = 0.5116855 (50 iterations in 0.012s)
[t-SNE] Iteration 250: error = 44.9423866, gradient norm = 0.5717285 (50 iterations in 0.012s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 44.942387
[t-SNE] Iteration 300: error = 0.7388079, gradient norm = 0.0016871 (50 iterations in 0.012s)
[t-SNE] Iteration 350: error = 0.6590928, gradient norm = 0.0006122 (50 iterations in 0.012s)
[t-SNE] Iteration 400: error = 0.6434279, gradient norm = 0.0005359 (50 iterations in 0.012s)
[t-SNE] Iteration 450: error = 0.6150546, gradient norm = 0.0005297 (50 iterations in 0.013s)
[t-SNE] Iteration 500: error = 0.6021118, gradient norm = 0.0003380 (50 iterations in 0.012s)
[t-SNE] Iteration 550: error = 0.5838049, gradient norm = 0.0008538 (50 iterations in 0.012s)
[t-SNE] Iteration 600: error = 0.5330573, gradient norm = 0.0055535 (50 iterations in 0.012s)
[t-SNE] Iteration 650: error = 0.1316985, gradient norm = 0.0253848 (50 iterations in 0.012s)
[t-SNE] Iteration 700: error = 0.0959050, gradient norm = 0.0047725 (50 iterations in 0.012s)
[t-SNE] Iteration 750: error = 0.0952772, gradient norm = 0.0009555 (50 iterations in 0.012s)
[t-SNE] Iteration 800: error = 0.0953341, gradient norm = 0.0006507 (50 iterations in 0.012s)
[t-SNE] Iteration 850: error = 0.0953036, gradient norm = 0.0004546 (50 iterations in 0.015s)
[t-SNE] Iteration 900: error = 0.0953438, gradient norm = 0.0007914 (50 iterations in 0.012s)
[t-SNE] Iteration 950: error = 0.0952570, gradient norm = 0.0004395 (50 iterations in 0.014s)
[t-SNE] Iteration 1000: error = 0.0954217, gradient norm = 0.0007556 (50 iterations in 0.012s)
[t-SNE] KL divergence after 1000 iterations: 0.095422
[t-SNE] Computed conditional probabilities for sample 64 / 64
[t-SNE] Mean sigma: 0.744287
Beginning preprocessing + Leiden
2024-03-16 16:42:54.049782 MEMORY 13.996240896
Affmat transformed
2024-03-16 16:42:54.050779 MEMORY 13.996240896
sources, targets, weights extracted
2024-03-16 16:42:54.051201 MEMORY 13.996240896
About to launch parallel Leiden runs
2024-03-16 16:42:54.054949 MEMORY 13.996240896
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.6s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.7s finished
Parallel Leiden runs finished
2024-03-16 16:42:55.784879 MEMORY 13.996240896
Quality: 0.09448572199981889
Quality: 0.09567765930083386
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  60 out of  60 | elapsed:    0.0s finished
Got subclusters: Counter({1: 21, 0: 21, 2: 15, 3: 7})
On pattern 18
[t-SNE] Computing 59 nearest neighbors...
[t-SNE] Indexed 60 samples in 0.001s...
[t-SNE] Computed neighbors for 60 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 60 / 60
[t-SNE] Mean sigma: 0.850758
[t-SNE] Computed conditional probabilities in 0.002s
[t-SNE] Iteration 50: error = 50.9104958, gradient norm = 0.5504162 (50 iterations in 0.013s)
[t-SNE] Iteration 100: error = 43.3911057, gradient norm = 0.5829098 (50 iterations in 0.012s)
[t-SNE] Iteration 150: error = 45.7792015, gradient norm = 0.5208608 (50 iterations in 0.012s)
[t-SNE] Iteration 200: error = 48.0996284, gradient norm = 0.5908955 (50 iterations in 0.013s)
[t-SNE] Iteration 250: error = 46.3799744, gradient norm = 0.4426007 (50 iterations in 0.012s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 46.379974
[t-SNE] Iteration 300: error = 0.7304153, gradient norm = 0.0013465 (50 iterations in 0.012s)
[t-SNE] Iteration 350: error = 0.6577368, gradient norm = 0.0010898 (50 iterations in 0.012s)
[t-SNE] Iteration 400: error = 0.6235787, gradient norm = 0.0005859 (50 iterations in 0.012s)
[t-SNE] Iteration 450: error = 0.6013432, gradient norm = 0.0006058 (50 iterations in 0.012s)
[t-SNE] Iteration 500: error = 0.5860783, gradient norm = 0.0007315 (50 iterations in 0.012s)
[t-SNE] Iteration 550: error = 0.5496110, gradient norm = 0.0009885 (50 iterations in 0.012s)
[t-SNE] Iteration 600: error = 0.5154123, gradient norm = 0.0015263 (50 iterations in 0.012s)
[t-SNE] Iteration 650: error = 1.0038805, gradient norm = 0.0069460 (50 iterations in 0.012s)
[t-SNE] Iteration 700: error = 0.7618555, gradient norm = 0.0009443 (50 iterations in 0.012s)
[t-SNE] Iteration 750: error = 0.6593566, gradient norm = 0.0002910 (50 iterations in 0.012s)
[t-SNE] Iteration 800: error = 0.6408143, gradient norm = 0.0002457 (50 iterations in 0.012s)
[t-SNE] Iteration 850: error = 0.6186461, gradient norm = 0.0003731 (50 iterations in 0.012s)
[t-SNE] Iteration 900: error = 0.5905219, gradient norm = 0.0002448 (50 iterations in 0.012s)
[t-SNE] Iteration 950: error = 0.5804811, gradient norm = 0.0002326 (50 iterations in 0.012s)
[t-SNE] Iteration 950: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 950 iterations: 0.580481
[t-SNE] Computed conditional probabilities for sample 60 / 60
[t-SNE] Mean sigma: 0.850758
Beginning preprocessing + Leiden
2024-03-16 16:42:56.090848 MEMORY 13.996240896
Affmat transformed
2024-03-16 16:42:56.091779 MEMORY 13.996240896
sources, targets, weights extracted
2024-03-16 16:42:56.092181 MEMORY 13.996240896
About to launch parallel Leiden runs
2024-03-16 16:42:56.096181 MEMORY 13.996240896
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.6s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.7s finished
Parallel Leiden runs finished
2024-03-16 16:42:57.847086 MEMORY 13.996240896
Quality: 0.1074768813414602
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  59 out of  59 | elapsed:    0.0s finished
Got subclusters: Counter({0: 25, 1: 25, 2: 10})
On pattern 19
[t-SNE] Computing 58 nearest neighbors...
[t-SNE] Indexed 59 samples in 0.000s...
[t-SNE] Computed neighbors for 59 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 59 / 59
[t-SNE] Mean sigma: 0.962451
[t-SNE] Computed conditional probabilities in 0.002s
[t-SNE] Iteration 50: error = 44.6791916, gradient norm = 0.6733758 (50 iterations in 0.019s)
[t-SNE] Iteration 100: error = 45.5583839, gradient norm = 0.3140398 (50 iterations in 0.012s)
[t-SNE] Iteration 150: error = 46.2660294, gradient norm = 0.5383761 (50 iterations in 0.012s)
[t-SNE] Iteration 200: error = 45.3653221, gradient norm = 0.5594418 (50 iterations in 0.011s)
[t-SNE] Iteration 250: error = 46.0511055, gradient norm = 0.4317801 (50 iterations in 0.011s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 46.051105
[t-SNE] Iteration 300: error = 0.8902113, gradient norm = 0.0015473 (50 iterations in 0.012s)
[t-SNE] Iteration 350: error = 0.7243521, gradient norm = 0.0006917 (50 iterations in 0.011s)
[t-SNE] Iteration 400: error = 0.6692249, gradient norm = 0.0003106 (50 iterations in 0.011s)
[t-SNE] Iteration 450: error = 0.6521110, gradient norm = 0.0002280 (50 iterations in 0.011s)
[t-SNE] Iteration 500: error = 0.6370503, gradient norm = 0.0002191 (50 iterations in 0.011s)
[t-SNE] Iteration 550: error = 0.6197979, gradient norm = 0.0002664 (50 iterations in 0.011s)
[t-SNE] Iteration 600: error = 0.6090836, gradient norm = 0.0001269 (50 iterations in 0.011s)
[t-SNE] Iteration 650: error = 0.6075081, gradient norm = 0.0000668 (50 iterations in 0.011s)
[t-SNE] Iteration 700: error = 0.5977235, gradient norm = 0.0002630 (50 iterations in 0.011s)
[t-SNE] Iteration 750: error = 0.5927845, gradient norm = 0.0001140 (50 iterations in 0.012s)
[t-SNE] Iteration 800: error = 0.5904150, gradient norm = 0.0000859 (50 iterations in 0.012s)
[t-SNE] Iteration 850: error = 0.5885682, gradient norm = 0.0001030 (50 iterations in 0.011s)
[t-SNE] Iteration 900: error = 0.5872025, gradient norm = 0.0000772 (50 iterations in 0.011s)
[t-SNE] Iteration 950: error = 0.5856935, gradient norm = 0.0000888 (50 iterations in 0.011s)
[t-SNE] Iteration 1000: error = 0.5833601, gradient norm = 0.0002010 (50 iterations in 0.011s)
[t-SNE] KL divergence after 1000 iterations: 0.583360
[t-SNE] Computed conditional probabilities for sample 59 / 59
[t-SNE] Mean sigma: 0.962451
Beginning preprocessing + Leiden
2024-03-16 16:42:58.142142 MEMORY 13.996240896
Affmat transformed
2024-03-16 16:42:58.142951 MEMORY 13.996240896
sources, targets, weights extracted
2024-03-16 16:42:58.143299 MEMORY 13.996240896
About to launch parallel Leiden runs
2024-03-16 16:42:58.148130 MEMORY 13.996240896
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.6s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.7s finished
Parallel Leiden runs finished
2024-03-16 16:42:59.845292 MEMORY 13.996240896
Quality: 0.09000038933645982
Quality: 0.09260804946941519
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  59 out of  59 | elapsed:    0.0s finished
Got subclusters: Counter({0: 26, 1: 20, 2: 13})
On pattern 20
[t-SNE] Computing 58 nearest neighbors...
[t-SNE] Indexed 59 samples in 0.000s...
[t-SNE] Computed neighbors for 59 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 59 / 59
[t-SNE] Mean sigma: 0.800343
[t-SNE] Computed conditional probabilities in 0.002s
[t-SNE] Iteration 50: error = 44.7108421, gradient norm = 0.6521387 (50 iterations in 0.012s)
[t-SNE] Iteration 100: error = 48.9196434, gradient norm = 0.5498328 (50 iterations in 0.012s)
[t-SNE] Iteration 150: error = 44.6629715, gradient norm = 0.5259851 (50 iterations in 0.012s)
[t-SNE] Iteration 200: error = 46.9529495, gradient norm = 0.5361257 (50 iterations in 0.012s)
[t-SNE] Iteration 250: error = 43.1222992, gradient norm = 0.5346897 (50 iterations in 0.012s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 43.122299
[t-SNE] Iteration 300: error = 0.8351566, gradient norm = 0.0019381 (50 iterations in 0.012s)
[t-SNE] Iteration 350: error = 0.7095690, gradient norm = 0.0006116 (50 iterations in 0.011s)
[t-SNE] Iteration 400: error = 0.6629937, gradient norm = 0.0007244 (50 iterations in 0.011s)
[t-SNE] Iteration 450: error = 0.6350402, gradient norm = 0.0003788 (50 iterations in 0.011s)
[t-SNE] Iteration 500: error = 0.6110878, gradient norm = 0.0003695 (50 iterations in 0.011s)
[t-SNE] Iteration 550: error = 0.5984167, gradient norm = 0.0003663 (50 iterations in 0.046s)
[t-SNE] Iteration 600: error = 0.5821448, gradient norm = 0.0003699 (50 iterations in 0.011s)
[t-SNE] Iteration 650: error = 0.5657377, gradient norm = 0.0002268 (50 iterations in 0.011s)
[t-SNE] Iteration 700: error = 0.5595212, gradient norm = 0.0001731 (50 iterations in 0.012s)
[t-SNE] Iteration 750: error = 0.5548576, gradient norm = 0.0001810 (50 iterations in 0.011s)
[t-SNE] Iteration 800: error = 0.5524287, gradient norm = 0.0001250 (50 iterations in 0.011s)
[t-SNE] Iteration 850: error = 0.5499861, gradient norm = 0.0001209 (50 iterations in 0.011s)
[t-SNE] Iteration 900: error = 0.5431003, gradient norm = 0.0003204 (50 iterations in 0.013s)
[t-SNE] Iteration 950: error = 0.5289563, gradient norm = 0.0003569 (50 iterations in 0.013s)
[t-SNE] Iteration 1000: error = 0.5226384, gradient norm = 0.0002313 (50 iterations in 0.011s)
[t-SNE] KL divergence after 1000 iterations: 0.522638
[t-SNE] Computed conditional probabilities for sample 59 / 59
[t-SNE] Mean sigma: 0.800343
Beginning preprocessing + Leiden
2024-03-16 16:43:00.169703 MEMORY 13.996240896
Affmat transformed
2024-03-16 16:43:00.170526 MEMORY 13.996240896
sources, targets, weights extracted
2024-03-16 16:43:00.170860 MEMORY 13.996240896
About to launch parallel Leiden runs
2024-03-16 16:43:00.174548 MEMORY 13.996240896
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.6s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.7s finished
Parallel Leiden runs finished
2024-03-16 16:43:01.893227 MEMORY 13.996240896
Quality: 0.08010546711578198
Quality: 0.08138246316401405
Quality: 0.08138246316401407
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  55 out of  55 | elapsed:    0.0s finished
Got subclusters: Counter({0: 19, 1: 16, 3: 12, 2: 12})
On pattern 21
[t-SNE] Computing 54 nearest neighbors...
[t-SNE] Indexed 55 samples in 0.000s...
[t-SNE] Computed neighbors for 55 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 55 / 55
[t-SNE] Mean sigma: 1.029713
[t-SNE] Computed conditional probabilities in 0.001s
[t-SNE] Iteration 50: error = 46.9819908, gradient norm = 0.6009130 (50 iterations in 0.012s)
[t-SNE] Iteration 100: error = 46.2115402, gradient norm = 0.5201079 (50 iterations in 0.011s)
[t-SNE] Iteration 150: error = 47.8341522, gradient norm = 0.5754446 (50 iterations in 0.011s)
[t-SNE] Iteration 200: error = 46.4725838, gradient norm = 0.4518505 (50 iterations in 0.011s)
[t-SNE] Iteration 250: error = 44.0090790, gradient norm = 0.3930759 (50 iterations in 0.011s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 44.009079
[t-SNE] Iteration 300: error = 0.7104541, gradient norm = 0.0012076 (50 iterations in 0.011s)
[t-SNE] Iteration 350: error = 0.6440650, gradient norm = 0.0002669 (50 iterations in 0.011s)
[t-SNE] Iteration 400: error = 0.6256246, gradient norm = 0.0002838 (50 iterations in 0.011s)
[t-SNE] Iteration 450: error = 0.6156943, gradient norm = 0.0001709 (50 iterations in 0.011s)
[t-SNE] Iteration 500: error = 0.6000212, gradient norm = 0.0001890 (50 iterations in 0.011s)
[t-SNE] Iteration 550: error = 0.5931385, gradient norm = 0.0002279 (50 iterations in 0.011s)
[t-SNE] Iteration 600: error = 0.5736723, gradient norm = 0.0002642 (50 iterations in 0.011s)
[t-SNE] Iteration 650: error = 0.5590165, gradient norm = 0.0002632 (50 iterations in 0.011s)
[t-SNE] Iteration 700: error = 0.5530627, gradient norm = 0.0001820 (50 iterations in 0.011s)
[t-SNE] Iteration 750: error = 0.5411830, gradient norm = 0.0001596 (50 iterations in 0.011s)
[t-SNE] Iteration 800: error = 0.5393286, gradient norm = 0.0001368 (50 iterations in 0.011s)
[t-SNE] Iteration 850: error = 0.5319471, gradient norm = 0.0002694 (50 iterations in 0.011s)
[t-SNE] Iteration 900: error = 0.5262340, gradient norm = 0.0002396 (50 iterations in 0.011s)
[t-SNE] Iteration 950: error = 0.5212925, gradient norm = 0.0002421 (50 iterations in 0.011s)
[t-SNE] Iteration 1000: error = 0.5167056, gradient norm = 0.0001788 (50 iterations in 0.011s)
[t-SNE] KL divergence after 1000 iterations: 0.516706
[t-SNE] Computed conditional probabilities for sample 55 / 55
[t-SNE] Mean sigma: 1.029712
Beginning preprocessing + Leiden
2024-03-16 16:43:02.169265 MEMORY 13.996240896
Affmat transformed
2024-03-16 16:43:02.170076 MEMORY 13.996240896
sources, targets, weights extracted
2024-03-16 16:43:02.170412 MEMORY 13.996240896
About to launch parallel Leiden runs
2024-03-16 16:43:02.174694 MEMORY 13.996240896
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.6s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.7s finished
Parallel Leiden runs finished
2024-03-16 16:43:03.907597 MEMORY 13.996240896
Quality: 0.06158722631515757
Got subclusters: Counter({0: 27, 1: 20, 2: 8})
On metacluster 4
Metacluster size 4374
Relevant tasks:  ('testis',)
Relevant signs:  (1,)
TfModiscoSeqletsToPatternsFactory: seed=1234
(Round 1) num seqlets: 4374
(Round 1) Computing coarse affmat
2024-03-16 16:43:05.909844 MEMORY 13.994930176
Beginning embedding computation
MEMORY 13.994930176
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 152 tasks      | elapsed:    2.0s
[Parallel(n_jobs=24)]: Done 402 tasks      | elapsed:    4.8s
[Parallel(n_jobs=24)]: Done 752 tasks      | elapsed:    8.6s
[Parallel(n_jobs=24)]: Done 1202 tasks      | elapsed:   13.5s
[Parallel(n_jobs=24)]: Done 1752 tasks      | elapsed:   19.4s
[Parallel(n_jobs=24)]: Done 2402 tasks      | elapsed:   26.5s
[Parallel(n_jobs=24)]: Done 3152 tasks      | elapsed:   34.7s
[Parallel(n_jobs=24)]: Done 4002 tasks      | elapsed:   44.1s
[Parallel(n_jobs=24)]: Done 4374 out of 4374 | elapsed:   48.2s finished
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 152 tasks      | elapsed:    1.8s
[Parallel(n_jobs=24)]: Done 402 tasks      | elapsed:    4.6s
[Parallel(n_jobs=24)]: Done 752 tasks      | elapsed:    8.6s
[Parallel(n_jobs=24)]: Done 1202 tasks      | elapsed:   13.5s
[Parallel(n_jobs=24)]: Done 1752 tasks      | elapsed:   19.5s
[Parallel(n_jobs=24)]: Done 2402 tasks      | elapsed:   26.6s
[Parallel(n_jobs=24)]: Done 3152 tasks      | elapsed:   34.8s
[Parallel(n_jobs=24)]: Done 4002 tasks      | elapsed:   44.2s
[Parallel(n_jobs=24)]: Done 4374 out of 4374 | elapsed:   48.3s finished
At the beginning of embedding call
2024-03-16 16:43:05.910085 MEMORY 13.994930176
before computing embeddings fwd
2024-03-16 16:43:05.919025 MEMORY 13.994930176
after computing embeddings fwd
2024-03-16 16:43:54.127504 MEMORY 14.003802112
after computing embeddings rev
2024-03-16 16:44:42.442127 MEMORY 14.182449152
before computing sparse embeddings fwd
2024-03-16 16:44:42.442217 MEMORY 14.182449152
Constructing csr matrix...
csr matrix made in 0.5133678913116455 s
after computing sparse embeddings fwd
2024-03-16 16:44:43.132202 MEMORY 14.182580224
before computing sparse embeddings rev
2024-03-16 16:44:43.132281 MEMORY 14.182580224
Constructing csr matrix...
csr matrix made in 0.49068284034729004 s
after computing sparse embeddings rev
2024-03-16 16:44:43.781926 MEMORY 14.182580224
Finished embedding computation in 98.95 s
MEMORY 14.007205888
Starting affinity matrix computations
MEMORY 14.007205888
Batching in slices of size 4374
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:03<00:00,  3.06s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:03<00:00,  3.06s/it]
Finished affinity matrix computations in 3.08 s
MEMORY 14.007205888
(Round 1) Computed coarse affmat
2024-03-16 16:44:48.772000 MEMORY 14.00682496
(Round 1) Computing affinity matrix on nearest neighbors
2024-03-16 16:44:48.772146 MEMORY 14.00682496
Launching nearest neighbors affmat calculation job
MEMORY 14.00682496
Parallel runs completed
MEMORY 14.112612352
Job completed in: 13.9 s
MEMORY 14.111117312
Launching nearest neighbors affmat calculation job
MEMORY 14.1115392
Parallel runs completed
MEMORY 14.180892672
Job completed in: 13.55 s
MEMORY 14.181494784
(Round 1) Computed affinity matrix on nearest neighbors in 28.79 s
2024-03-16 16:45:17.558900 MEMORY 14.148268032
Filtered down to 4249 of 4374
(Round 1) Retained 4249 rows out of 4374 after filtering
2024-03-16 16:45:19.732745 MEMORY 14.148276224
(Round 1) Computing density adapted affmat
2024-03-16 16:45:21.231655 MEMORY 14.148276224
Symmetrizing nearest neighbors
Computing betas for density adaptation
Computing normalizing denominators
(Round 1) Computing clustering
2024-03-16 16:45:52.998469 MEMORY 14.159618048
Beginning preprocessing + Leiden
2024-03-16 16:45:53.004084 MEMORY 14.159618048
Affmat transformed
2024-03-16 16:45:53.004209 MEMORY 14.159618048
sources, targets, weights extracted
2024-03-16 16:45:53.136479 MEMORY 14.159618048
About to launch parallel Leiden runs
2024-03-16 16:45:53.191913 MEMORY 14.159618048
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:   19.0s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:  1.2min finished
Parallel Leiden runs finished
2024-03-16 16:47:07.375285 MEMORY 14.159622144
Quality: 0.3263438818248552
Quality: 0.3263529849567865
Quality: 0.32635407451624365
Got 4 clusters after round 1
Counts:
{2: 1152, 0: 1228, 1: 1181, 3: 688}
2024-03-16 16:47:07.388654 MEMORY 14.159622144
(Round 1) Aggregating seqlets in each cluster
2024-03-16 16:47:07.388742 MEMORY 14.159622144
Aggregating for cluster 0 with 1228 seqlets
2024-03-16 16:47:07.392100 MEMORY 14.159622144
Skipped 2 due to duplicates
Trimming eliminated 0 seqlets out of 1226
Aggregating for cluster 1 with 1181 seqlets
2024-03-16 16:47:10.149091 MEMORY 14.159806464
Trimming eliminated 0 seqlets out of 1181
Aggregating for cluster 2 with 1152 seqlets
2024-03-16 16:47:12.427267 MEMORY 14.159806464
Skipped 1 due to duplicates
Trimming eliminated 0 seqlets out of 1151
Aggregating for cluster 3 with 688 seqlets
2024-03-16 16:47:15.658816 MEMORY 14.159814656
Skipped 1 due to duplicates
Trimming eliminated 0 seqlets out of 687
(Round 2) num seqlets: 4245
(Round 2) Computing coarse affmat
2024-03-16 16:47:17.888982 MEMORY 14.159814656
Beginning embedding computation
MEMORY 14.159814656
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 368 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done 1368 tasks      | elapsed:    2.0s
[Parallel(n_jobs=24)]: Done 2768 tasks      | elapsed:    4.0s
[Parallel(n_jobs=24)]: Done 4245 out of 4245 | elapsed:    6.0s finished
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 368 tasks      | elapsed:    0.8s
[Parallel(n_jobs=24)]: Done 1368 tasks      | elapsed:    2.2s
[Parallel(n_jobs=24)]: Done 2768 tasks      | elapsed:    4.2s
[Parallel(n_jobs=24)]: Done 4245 out of 4245 | elapsed:    6.4s finished
At the beginning of embedding call
2024-03-16 16:47:17.889176 MEMORY 14.159814656
before computing embeddings fwd
2024-03-16 16:47:17.897373 MEMORY 14.159814656
after computing embeddings fwd
2024-03-16 16:47:23.938216 MEMORY 14.282211328
after computing embeddings rev
2024-03-16 16:47:30.292663 MEMORY 14.45576704
before computing sparse embeddings fwd
2024-03-16 16:47:30.292749 MEMORY 14.45576704
Constructing csr matrix...
csr matrix made in 0.4686620235443115 s
after computing sparse embeddings fwd
2024-03-16 16:47:30.942820 MEMORY 14.455885824
before computing sparse embeddings rev
2024-03-16 16:47:30.942897 MEMORY 14.455885824
Constructing csr matrix...
csr matrix made in 0.4601292610168457 s
after computing sparse embeddings rev
2024-03-16 16:47:31.584130 MEMORY 14.462398464
Finished embedding computation in 14.78 s
MEMORY 14.317006848
Starting affinity matrix computations
MEMORY 14.316744704
Batching in slices of size 4245
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:03<00:00,  3.23s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:03<00:00,  3.23s/it]
Finished affinity matrix computations in 3.25 s
MEMORY 14.316752896
(Round 2) Computed coarse affmat
2024-03-16 16:47:36.692989 MEMORY 14.31656448
(Round 2) Computing affinity matrix on nearest neighbors
2024-03-16 16:47:36.693110 MEMORY 14.31656448
Launching nearest neighbors affmat calculation job
MEMORY 14.31656448
Parallel runs completed
MEMORY 14.336925696
Job completed in: 6.71 s
MEMORY 14.336544768
Launching nearest neighbors affmat calculation job
MEMORY 14.336299008
Parallel runs completed
MEMORY 14.340243456
Job completed in: 6.57 s
MEMORY 14.340120576
(Round 2) Computed affinity matrix on nearest neighbors in 14.64 s
2024-03-16 16:47:51.331392 MEMORY 14.337728512
Not applying filtering for rounds above first round
2024-03-16 16:47:51.331960 MEMORY 14.337728512
(Round 2) Computing density adapted affmat
2024-03-16 16:47:52.876112 MEMORY 14.343192576
Symmetrizing nearest neighbors
Computing betas for density adaptation
Computing normalizing denominators
(Round 2) Computing clustering
2024-03-16 16:48:23.943933 MEMORY 14.3451136
Beginning preprocessing + Leiden
2024-03-16 16:48:23.949276 MEMORY 14.3451136
Affmat transformed
2024-03-16 16:48:23.949410 MEMORY 14.3451136
sources, targets, weights extracted
2024-03-16 16:48:24.075389 MEMORY 14.356246528
About to launch parallel Leiden runs
2024-03-16 16:48:24.112027 MEMORY 14.356246528
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:   13.1s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   44.0s finished
Parallel Leiden runs finished
2024-03-16 16:49:08.136927 MEMORY 14.356246528
Quality: 0.44148802013537947
Got 4 clusters after round 2
Counts:
{0: 1223, 1: 1209, 2: 1117, 3: 696}
2024-03-16 16:49:08.149532 MEMORY 14.356246528
(Round 2) Aggregating seqlets in each cluster
2024-03-16 16:49:08.149618 MEMORY 14.356246528
Aggregating for cluster 0 with 1223 seqlets
2024-03-16 16:49:08.152375 MEMORY 14.356246528
Trimming eliminated 0 seqlets out of 1223
Aggregating for cluster 1 with 1209 seqlets
2024-03-16 16:49:10.107842 MEMORY 14.356246528
Skipped 2 due to duplicates
Trimming eliminated 0 seqlets out of 1207
Aggregating for cluster 2 with 1117 seqlets
2024-03-16 16:49:11.960038 MEMORY 14.356246528
Trimming eliminated 0 seqlets out of 1117
Aggregating for cluster 3 with 696 seqlets
2024-03-16 16:49:14.556197 MEMORY 14.35572224
Skipped 1 due to duplicates
Trimming eliminated 0 seqlets out of 695
Got 4 clusters
Splitting into subclusters...
2024-03-16 16:49:15.567245 MEMORY 14.35572224
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 1223 out of 1223 | elapsed:    0.4s finished
Inspecting pattern 0 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 1223
[t-SNE] Computed conditional probabilities for sample 1223 / 1223
[t-SNE] Mean sigma: 0.338637
Beginning preprocessing + Leiden
2024-03-16 16:49:17.261976 MEMORY 14.356164608
Affmat transformed
2024-03-16 16:49:17.275951 MEMORY 14.356164608
sources, targets, weights extracted
2024-03-16 16:49:17.284308 MEMORY 14.356164608
About to launch parallel Leiden runs
2024-03-16 16:49:17.308818 MEMORY 14.356164608
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    3.0s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   11.3s finished
Parallel Leiden runs finished
2024-03-16 16:49:28.576635 MEMORY 14.356164608
Quality: 0.45916412185162414
Quality: 0.4601214616522046
Quality: 0.46077492097138845
Quality: 0.4609815407053864
Quality: 0.4614608028254848
Quality: 0.4620141120276142
Got subclusters: Counter({0: 239, 1: 215, 2: 202, 3: 184, 4: 145, 5: 128, 6: 110})
On merging iteration 1
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 1207 out of 1207 | elapsed:    0.4s finished
Numbers for each pattern pre-subsample: [239, 215, 202, 184, 145, 128, 110]
Numbers after subsampling: [239, 215, 202, 184, 145, 128, 110]
Computing sims for pattern 0
Computed sims for pattern 0 in 1.4049313068389893 s
Computing sims for pattern 1
Computed sims for pattern 1 in 1.2654740810394287 s
Computing sims for pattern 2
Computed sims for pattern 2 in 1.1515486240386963 s
Computing sims for pattern 3
Computed sims for pattern 3 in 1.0229594707489014 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.7551188468933105 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.7373912334442139 s
Computing sims for pattern 6
Computed sims for pattern 6 in 0.6104989051818848 s
Cluster sizes
[239 215 202 184 145 128 110]
Cross-contamination matrix:
[[1.   0.28 0.69 0.39 0.47 0.24 0.47]
 [0.41 1.   0.62 0.6  0.64 0.64 0.62]
 [0.74 0.56 1.   0.64 0.44 0.57 0.47]
 [0.51 0.66 0.78 1.   0.63 0.57 0.69]
 [0.71 0.79 0.65 0.72 1.   0.59 0.79]
 [0.5  0.65 0.65 0.52 0.46 1.   0.61]
 [0.54 0.63 0.47 0.45 0.45 0.42 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.64 0.82 0.59 0.76 0.74 0.68]
 [0.64 1.   0.69 0.74 0.8  0.84 0.76]
 [0.82 0.69 1.   0.82 0.7  0.83 0.67]
 [0.59 0.74 0.82 1.   0.74 0.8  0.67]
 [0.76 0.8  0.7  0.74 1.   0.79 0.68]
 [0.74 0.84 0.83 0.8  0.79 1.   0.79]
 [0.68 0.76 0.67 0.67 0.68 0.79 1.  ]]
Inspecting pattern 1 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 1207
[t-SNE] Computed conditional probabilities for sample 1207 / 1207
[t-SNE] Mean sigma: 0.344722
Beginning preprocessing + Leiden
2024-03-16 16:49:37.436636 MEMORY 14.356238336
Affmat transformed
2024-03-16 16:49:37.450589 MEMORY 14.356238336
sources, targets, weights extracted
2024-03-16 16:49:37.458612 MEMORY 14.356238336
About to launch parallel Leiden runs
2024-03-16 16:49:37.465948 MEMORY 14.356238336
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    3.0s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    9.7s finished
Parallel Leiden runs finished
2024-03-16 16:49:47.140357 MEMORY 14.356238336
Quality: 0.4654162703806929
Quality: 0.4662557660643892
Quality: 0.46710098326107957
Got subclusters: Counter({0: 321, 1: 244, 2: 228, 3: 221, 4: 108, 5: 61, 6: 16, 7: 8})
On merging iteration 1
Numbers for each pattern pre-subsample: [321, 244, 228, 221, 108, 61, 16, 8]
Numbers after subsampling: [300, 244, 228, 221, 108, 61, 16, 8]
Computing sims for pattern 0
Computed sims for pattern 0 in 1.9461464881896973 s
Computing sims for pattern 1
Computed sims for pattern 1 in 1.4175734519958496 s
Computing sims for pattern 2
Computed sims for pattern 2 in 1.7008686065673828 s
Computing sims for pattern 3
Computed sims for pattern 3 in 1.6143059730529785 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.7728304862976074 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.49171876907348633 s
Computing sims for pattern 6
Computed sims for pattern 6 in 0.19584155082702637 s
Computing sims for pattern 7
Computed sims for pattern 7 in 0.144059419631958 s
Cluster sizes
[321 244 228 221 108  61  16   8]
Cross-contamination matrix:
[[1.   0.64 0.39 0.48 0.21 0.57 0.68 0.34]
 [0.61 1.   0.34 0.32 0.36 0.35 0.66 0.26]
 [0.47 0.51 1.   0.75 0.57 0.56 0.74 0.3 ]
 [0.55 0.46 0.72 1.   0.65 0.48 0.44 0.44]
 [0.52 0.77 0.8  0.93 1.   0.55 0.71 0.37]
 [0.66 0.62 0.54 0.6  0.31 1.   0.71 0.33]
 [0.44 0.48 0.38 0.33 0.18 0.49 1.   0.17]
 [0.15 0.13 0.06 0.21 0.07 0.13 0.14 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.89 0.85 0.86 0.55 0.86 0.83 0.64]
 [0.89 1.   0.79 0.79 0.66 0.82 0.85 0.63]
 [0.85 0.79 1.   0.87 0.71 0.84 0.82 0.62]
 [0.86 0.79 0.87 1.   0.85 0.8  0.76 0.68]
 [0.55 0.66 0.71 0.85 1.   0.68 0.74 0.52]
 [0.86 0.82 0.84 0.8  0.68 1.   0.89 0.6 ]
 [0.83 0.85 0.82 0.76 0.74 0.89 1.   0.61]
 [0.64 0.63 0.62 0.68 0.52 0.6  0.61 1.  ]]
Collapsing 0 & 1 with crosscontam 0.6081495771305381 and sim 0.8916015499470631
Collapsing 2 & 3 with crosscontam 0.7203758984657549 and sim 0.8698504165243787
Collapsing 0 & 5 with crosscontam 0.5729950625379479 and sim 0.8637401308960004
Trimming eliminated 0 seqlets out of 565
Trimming eliminated 0 seqlets out of 449
Trimming eliminated 0 seqlets out of 626
Unmerged patterns remapping: OrderedDict([(4, 2), (6, 3), (7, 4)])
Time spent on merging iteration: 2.469381809234619
On merging iteration 2
Numbers for each pattern pre-subsample: [626, 449, 108, 16, 8]
Numbers after subsampling: [300, 300, 108, 16, 8]
Computing sims for pattern 0
Computed sims for pattern 0 in 1.057082176208496 s
Computing sims for pattern 1
Computed sims for pattern 1 in 1.0818767547607422 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.2760500907897949 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.07965588569641113 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.060129404067993164 s
Cluster sizes
[626 449 108  16   8]
Cross-contamination matrix:
[[1.   0.64 0.35 0.8  0.52]
 [0.72 1.   0.76 0.88 0.5 ]
 [0.37 0.84 1.   0.71 0.37]
 [0.43 0.36 0.18 1.   0.17]
 [0.17 0.15 0.07 0.14 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.89 0.68 0.86 0.63]
 [0.89 1.   0.8  0.8  0.66]
 [0.68 0.8  1.   0.74 0.52]
 [0.86 0.8  0.74 1.   0.61]
 [0.63 0.66 0.52 0.61 1.  ]]
Collapsing 0 & 1 with crosscontam 0.6444955525925926 and sim 0.8943351404886597
Trimming eliminated 0 seqlets out of 1075
Unmerged patterns remapping: OrderedDict([(2, 1), (3, 2), (4, 3)])
Time spent on merging iteration: 2.8966269493103027
On merging iteration 3
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 1117 out of 1117 | elapsed:    0.3s finished
Numbers for each pattern pre-subsample: [1075, 108, 16, 8]
Numbers after subsampling: [300, 108, 16, 8]
Computing sims for pattern 0
Computed sims for pattern 0 in 0.7600884437561035 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.13969683647155762 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.0401768684387207 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.0304868221282959 s
Cluster sizes
[1075  108   16    8]
Cross-contamination matrix:
[[1.   0.58 1.   0.64]
 [0.53 1.   0.71 0.37]
 [0.41 0.18 1.   0.17]
 [0.12 0.07 0.14 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.72 0.89 0.63]
 [0.72 1.   0.74 0.52]
 [0.89 0.74 1.   0.61]
 [0.63 0.52 0.61 1.  ]]
Inspecting pattern 2 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 1117
[t-SNE] Computed conditional probabilities for sample 1117 / 1117
[t-SNE] Mean sigma: 0.359767
Beginning preprocessing + Leiden
2024-03-16 16:50:06.004972 MEMORY 14.356238336
Affmat transformed
2024-03-16 16:50:06.018022 MEMORY 14.356238336
sources, targets, weights extracted
2024-03-16 16:50:06.025635 MEMORY 14.356238336
About to launch parallel Leiden runs
2024-03-16 16:50:06.032638 MEMORY 14.356238336
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    2.5s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    7.9s finished
Parallel Leiden runs finished
2024-03-16 16:50:13.967842 MEMORY 14.356238336
Quality: 0.5423133034432582
Quality: 0.5433175987917132
Quality: 0.5433239024892014
Quality: 0.5434872442695078
Quality: 0.5434972727242918
Quality: 0.5435057714943349
Quality: 0.543581028433591
Got subclusters: Counter({0: 214, 1: 174, 2: 162, 3: 126, 4: 122, 5: 115, 6: 106, 7: 98})
On merging iteration 1
Numbers for each pattern pre-subsample: [214, 174, 162, 126, 122, 115, 106, 98]
Numbers after subsampling: [214, 174, 162, 126, 122, 115, 106, 98]
Computing sims for pattern 0
Computed sims for pattern 0 in 1.6504535675048828 s
Computing sims for pattern 1
Computed sims for pattern 1 in 1.2455244064331055 s
Computing sims for pattern 2
Computed sims for pattern 2 in 1.1632428169250488 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.9903500080108643 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.9625329971313477 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.887092113494873 s
Computing sims for pattern 6
Computed sims for pattern 6 in 0.8092780113220215 s
Computing sims for pattern 7
Computed sims for pattern 7 in 0.6568315029144287 s
Cluster sizes
[214 174 162 126 122 115 106  98]
Cross-contamination matrix:
[[1.   0.59 0.31 0.19 0.53 0.55 0.14 0.51]
 [0.63 1.   0.53 0.4  0.76 0.64 0.36 0.42]
 [0.54 0.77 1.   0.36 0.77 0.56 0.45 0.72]
 [0.14 0.45 0.15 1.   0.28 0.51 0.52 0.5 ]
 [0.53 0.64 0.48 0.26 1.   0.76 0.18 0.57]
 [0.69 0.77 0.46 0.64 0.88 1.   0.46 0.65]
 [0.19 0.37 0.27 0.39 0.22 0.36 1.   0.34]
 [0.61 0.51 0.54 0.55 0.68 0.58 0.47 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.82 0.76 0.71 0.73 0.73 0.5  0.71]
 [0.82 1.   0.79 0.67 0.82 0.81 0.68 0.7 ]
 [0.76 0.79 1.   0.68 0.79 0.71 0.67 0.79]
 [0.71 0.67 0.68 1.   0.63 0.73 0.73 0.8 ]
 [0.73 0.82 0.79 0.63 1.   0.88 0.56 0.82]
 [0.73 0.81 0.71 0.73 0.88 1.   0.64 0.73]
 [0.5  0.68 0.67 0.73 0.56 0.64 1.   0.78]
 [0.71 0.7  0.79 0.8  0.82 0.73 0.78 1.  ]]
Collapsing 4 & 5 with crosscontam 0.756496148020817 and sim 0.8824274648024705
Trimming eliminated 0 seqlets out of 237
Unmerged patterns remapping: OrderedDict([(0, 1), (1, 2), (2, 3), (3, 4), (6, 5), (7, 6)])
Time spent on merging iteration: 1.0172150135040283
On merging iteration 2
Numbers for each pattern pre-subsample: [237, 214, 174, 162, 126, 106, 98]
Numbers after subsampling: [237, 214, 174, 162, 126, 106, 98]
Computing sims for pattern 0
Computed sims for pattern 0 in 1.6829144954681396 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.27071619033813477 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.2009897232055664 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.1856224536895752 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.15309572219848633 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.12684011459350586 s
Computing sims for pattern 6
Computed sims for pattern 6 in 0.10441374778747559 s
Cluster sizes
[237 214 174 162 126 106  98]
Cross-contamination matrix:
[[1.   0.76 0.85 0.68 0.5  0.49 0.76]
 [0.51 1.   0.59 0.31 0.19 0.14 0.51]
 [0.7  0.63 1.   0.53 0.4  0.36 0.42]
 [0.66 0.54 0.77 1.   0.36 0.45 0.72]
 [0.25 0.14 0.45 0.15 1.   0.52 0.5 ]
 [0.21 0.19 0.37 0.27 0.39 1.   0.34]
 [0.59 0.61 0.51 0.54 0.55 0.47 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.74 0.85 0.75 0.63 0.52 0.8 ]
 [0.74 1.   0.82 0.76 0.71 0.5  0.71]
 [0.85 0.82 1.   0.79 0.67 0.68 0.7 ]
 [0.75 0.76 0.79 1.   0.68 0.67 0.79]
 [0.63 0.71 0.67 0.68 1.   0.73 0.8 ]
 [0.52 0.5  0.68 0.67 0.73 1.   0.78]
 [0.8  0.71 0.7  0.79 0.8  0.78 1.  ]]
Collapsing 0 & 2 with crosscontam 0.699751727500628 and sim 0.8546479410268844
Trimming eliminated 0 seqlets out of 411
Unmerged patterns remapping: OrderedDict([(1, 1), (3, 2), (4, 3), (5, 4), (6, 5)])
Time spent on merging iteration: 0.7765841484069824
On merging iteration 3
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 695 out of 695 | elapsed:    0.3s finished
Numbers for each pattern pre-subsample: [411, 214, 162, 126, 106, 98]
Numbers after subsampling: [300, 214, 162, 126, 106, 98]
Computing sims for pattern 0
Computed sims for pattern 0 in 1.521824598312378 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.2782750129699707 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.19758152961730957 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.17182159423828125 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.13994336128234863 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.1183171272277832 s
Cluster sizes
[411 214 162 126 106  98]
Cross-contamination matrix:
[[1.   0.79 0.77 0.61 0.52 0.8 ]
 [0.46 1.   0.31 0.19 0.14 0.51]
 [0.63 0.54 1.   0.36 0.45 0.72]
 [0.27 0.14 0.15 1.   0.52 0.5 ]
 [0.24 0.19 0.27 0.39 1.   0.34]
 [0.55 0.61 0.54 0.55 0.47 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.71 0.74 0.69 0.58 0.8 ]
 [0.71 1.   0.76 0.71 0.5  0.71]
 [0.74 0.76 1.   0.68 0.67 0.79]
 [0.69 0.71 0.68 1.   0.73 0.8 ]
 [0.58 0.5  0.67 0.73 1.   0.78]
 [0.8  0.71 0.79 0.8  0.78 1.  ]]
Inspecting pattern 3 for spurious merging
[t-SNE] Computed conditional probabilities for sample 695 / 695
[t-SNE] Mean sigma: 0.371312
Beginning preprocessing + Leiden
2024-03-16 16:50:29.794350 MEMORY 14.356238336
Affmat transformed
2024-03-16 16:50:29.802816 MEMORY 14.356238336
sources, targets, weights extracted
2024-03-16 16:50:29.807397 MEMORY 14.356238336
About to launch parallel Leiden runs
2024-03-16 16:50:29.813380 MEMORY 14.356238336
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    5.3s finished
Parallel Leiden runs finished
2024-03-16 16:50:35.086664 MEMORY 14.356238336
Quality: 0.4122436376821294
Quality: 0.41310215712312476
Quality: 0.41423321560011267
Quality: 0.41544157356031053
Quality: 0.41548562417262774
Got subclusters: Counter({0: 159, 1: 122, 2: 108, 3: 108, 4: 82, 5: 80, 6: 33, 7: 3})
On merging iteration 1
Numbers for each pattern pre-subsample: [159, 122, 108, 108, 82, 80, 33, 3]
Numbers after subsampling: [159, 122, 108, 108, 82, 80, 33, 3]
Computing sims for pattern 0
Computed sims for pattern 0 in 0.9665398597717285 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.8388559818267822 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.7224335670471191 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.7031736373901367 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.5599610805511475 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.5372600555419922 s
Computing sims for pattern 6
Computed sims for pattern 6 in 0.2488558292388916 s
Computing sims for pattern 7
Computed sims for pattern 7 in 0.08138728141784668 s
Cluster sizes
[159 122 108 108  82  80  33   3]
Cross-contamination matrix:
[[1.   0.73 0.72 0.74 0.8  0.73 0.78 0.68]
 [0.35 1.   0.59 0.5  0.6  0.57 0.42 0.39]
 [0.36 0.64 1.   0.56 0.68 0.68 0.48 0.44]
 [0.48 0.65 0.68 1.   0.62 0.7  0.61 0.44]
 [0.48 0.71 0.75 0.54 1.   0.8  0.67 0.56]
 [0.38 0.61 0.68 0.56 0.72 1.   0.59 0.5 ]
 [0.37 0.41 0.44 0.41 0.55 0.55 1.   0.31]
 [0.02 0.03 0.04 0.01 0.03 0.04 0.   1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.65 0.64 0.8  0.83 0.74 0.85 0.59]
 [0.65 1.   0.7  0.66 0.77 0.78 0.54 0.49]
 [0.64 0.7  1.   0.68 0.76 0.74 0.6  0.45]
 [0.8  0.66 0.68 1.   0.73 0.72 0.76 0.53]
 [0.83 0.77 0.76 0.73 1.   0.84 0.81 0.61]
 [0.74 0.78 0.74 0.72 0.84 1.   0.7  0.58]
 [0.85 0.54 0.6  0.76 0.81 0.7  1.   0.54]
 [0.59 0.49 0.45 0.53 0.61 0.58 0.54 1.  ]]
Merging on 25 clusters
2024-03-16 16:50:39.888958 MEMORY 14.356238336
On merging iteration 1
Numbers for each pattern pre-subsample: [239, 215, 202, 184, 145, 128, 110, 1075, 108, 16, 8, 411, 214, 162, 126, 106, 98, 159, 122, 108, 108, 82, 80, 33, 3]
Numbers after subsampling: [239, 215, 202, 184, 145, 128, 110, 300, 108, 16, 8, 300, 214, 162, 126, 106, 98, 159, 122, 108, 108, 82, 80, 33, 3]
Computing sims for pattern 0
Computed sims for pattern 0 in 6.434728145599365 s
Computing sims for pattern 1
Computed sims for pattern 1 in 5.944530487060547 s
Computing sims for pattern 2
Computed sims for pattern 2 in 6.9371888637542725 s
Computing sims for pattern 3
Computed sims for pattern 3 in 4.63038969039917 s
Computing sims for pattern 4
Computed sims for pattern 4 in 3.3612616062164307 s
Computing sims for pattern 5
Computed sims for pattern 5 in 3.3760292530059814 s
Computing sims for pattern 6
Computed sims for pattern 6 in 2.7685985565185547 s
Computing sims for pattern 7
Computed sims for pattern 7 in 7.0462775230407715 s
Computing sims for pattern 8
Computed sims for pattern 8 in 2.685293197631836 s
Computing sims for pattern 9
Computed sims for pattern 9 in 0.6160457134246826 s
Computing sims for pattern 10
Computed sims for pattern 10 in 0.44118762016296387 s
Computing sims for pattern 11
Computed sims for pattern 11 in 6.9629340171813965 s
Computing sims for pattern 12
Computed sims for pattern 12 in 5.60863471031189 s
Computing sims for pattern 13
Computed sims for pattern 13 in 3.8139305114746094 s
Computing sims for pattern 14
Computed sims for pattern 14 in 3.249908685684204 s
Computing sims for pattern 15
Computed sims for pattern 15 in 2.6421234607696533 s
Computing sims for pattern 16
Computed sims for pattern 16 in 2.1431009769439697 s
Computing sims for pattern 17
Computed sims for pattern 17 in 5.1787025928497314 s
Computing sims for pattern 18
Computed sims for pattern 18 in 3.18666934967041 s
Computing sims for pattern 19
Computed sims for pattern 19 in 2.7246341705322266 s
Computing sims for pattern 20
Computed sims for pattern 20 in 2.7105228900909424 s
Computing sims for pattern 21
Computed sims for pattern 21 in 2.1252024173736572 s
Computing sims for pattern 22
Computed sims for pattern 22 in 2.083634376525879 s
Computing sims for pattern 23
Computed sims for pattern 23 in 0.9822373390197754 s
Computing sims for pattern 24
Computed sims for pattern 24 in 0.3464515209197998 s
Cluster sizes
[ 239  215  202  184  145  128  110 1075  108   16    8  411  214  162
  126  106   98  159  122  108  108   82   80   33    3]
Cross-contamination matrix:
[[1.   0.28 0.69 0.39 0.47 0.24 0.47 0.24 0.23 0.29 0.14 0.1  0.13 0.23
  0.4  0.1  0.21 0.06 0.41 0.25 0.11 0.12 0.1  0.02 0.11]
 [0.41 1.   0.62 0.6  0.64 0.64 0.62 0.33 0.15 0.32 0.25 0.16 0.14 0.16
  0.24 0.13 0.15 0.12 0.47 0.33 0.19 0.18 0.16 0.08 0.3 ]
 [0.74 0.56 1.   0.64 0.44 0.57 0.47 0.25 0.3  0.23 0.12 0.33 0.14 0.24
  0.36 0.1  0.23 0.08 0.32 0.41 0.16 0.11 0.11 0.03 0.13]
 [0.51 0.66 0.78 1.   0.63 0.57 0.69 0.37 0.54 0.4  0.16 0.31 0.17 0.32
  0.36 0.13 0.3  0.1  0.47 0.49 0.28 0.18 0.2  0.04 0.17]
 [0.71 0.79 0.65 0.72 1.   0.59 0.79 0.39 0.43 0.44 0.26 0.29 0.17 0.39
  0.4  0.2  0.33 0.11 0.63 0.37 0.28 0.22 0.26 0.09 0.22]
 [0.5  0.65 0.65 0.52 0.46 1.   0.61 0.48 0.18 0.72 0.34 0.17 0.19 0.21
  0.26 0.1  0.21 0.07 0.4  0.37 0.16 0.18 0.12 0.06 0.15]
 [0.54 0.63 0.47 0.45 0.45 0.42 1.   0.34 0.16 0.41 0.15 0.07 0.04 0.07
  0.11 0.04 0.13 0.04 0.35 0.16 0.1  0.08 0.06 0.03 0.21]
 [0.76 0.78 0.72 0.68 0.66 0.9  0.97 1.   0.58 1.   0.64 0.36 0.46 0.45
  0.37 0.32 0.42 0.17 0.62 0.37 0.52 0.3  0.25 0.15 0.31]
 [0.49 0.36 0.59 0.78 0.65 0.44 0.49 0.53 1.   0.71 0.37 0.44 0.25 0.52
  0.44 0.33 0.49 0.16 0.52 0.52 0.33 0.29 0.31 0.15 0.24]
 [0.15 0.16 0.14 0.19 0.17 0.48 0.36 0.41 0.18 1.   0.17 0.05 0.05 0.07
  0.07 0.11 0.1  0.01 0.23 0.09 0.03 0.04 0.03 0.   0.08]
 [0.07 0.06 0.06 0.05 0.04 0.1  0.07 0.12 0.07 0.14 1.   0.03 0.06 0.04
  0.02 0.02 0.05 0.   0.06 0.02 0.02 0.04 0.03 0.06 0.03]
 [0.33 0.36 0.59 0.51 0.42 0.34 0.31 0.28 0.4  0.3  0.28 1.   0.79 0.77
  0.61 0.52 0.8  0.12 0.25 0.4  0.26 0.18 0.44 0.17 0.21]
 [0.12 0.08 0.13 0.11 0.09 0.12 0.05 0.1  0.06 0.12 0.09 0.46 1.   0.31
  0.19 0.14 0.51 0.01 0.04 0.09 0.03 0.03 0.09 0.01 0.01]
 [0.38 0.22 0.36 0.4  0.42 0.3  0.17 0.24 0.36 0.3  0.19 0.63 0.54 1.
  0.36 0.45 0.72 0.02 0.19 0.28 0.16 0.08 0.34 0.07 0.02]
 [0.41 0.1  0.32 0.17 0.21 0.17 0.16 0.07 0.11 0.13 0.03 0.27 0.14 0.15
  1.   0.52 0.5  0.04 0.29 0.16 0.11 0.08 0.21 0.04 0.02]
 [0.18 0.14 0.15 0.14 0.12 0.08 0.05 0.09 0.13 0.07 0.09 0.24 0.19 0.27
  0.39 1.   0.34 0.05 0.19 0.1  0.11 0.09 0.26 0.04 0.02]
 [0.23 0.11 0.23 0.15 0.18 0.16 0.18 0.11 0.16 0.15 0.08 0.55 0.61 0.54
  0.55 0.47 1.   0.04 0.16 0.16 0.16 0.07 0.33 0.04 0.04]
 [0.22 0.13 0.24 0.21 0.21 0.1  0.27 0.1  0.16 0.08 0.1  0.11 0.06 0.06
  0.12 0.09 0.12 1.   0.73 0.72 0.74 0.8  0.73 0.78 0.68]
 [0.45 0.41 0.32 0.34 0.42 0.32 0.44 0.28 0.24 0.42 0.13 0.08 0.07 0.11
  0.22 0.1  0.15 0.35 1.   0.59 0.5  0.6  0.57 0.42 0.39]
 [0.27 0.17 0.39 0.2  0.17 0.22 0.14 0.1  0.2  0.13 0.05 0.18 0.08 0.14
  0.14 0.06 0.13 0.36 0.64 1.   0.56 0.68 0.68 0.48 0.44]
 [0.14 0.13 0.12 0.12 0.17 0.13 0.11 0.27 0.19 0.13 0.1  0.1  0.1  0.15
  0.13 0.09 0.19 0.48 0.65 0.68 1.   0.62 0.7  0.61 0.44]
 [0.17 0.1  0.12 0.14 0.14 0.15 0.14 0.12 0.12 0.15 0.05 0.05 0.07 0.05
  0.09 0.06 0.06 0.48 0.71 0.75 0.54 1.   0.8  0.67 0.56]
 [0.14 0.14 0.13 0.13 0.16 0.09 0.12 0.09 0.1  0.11 0.07 0.16 0.12 0.18
  0.18 0.17 0.23 0.38 0.61 0.68 0.56 0.72 1.   0.59 0.5 ]
 [0.04 0.03 0.02 0.02 0.03 0.01 0.02 0.02 0.03 0.01 0.09 0.01 0.01 0.01
  0.03 0.01 0.02 0.37 0.41 0.44 0.41 0.55 0.55 1.   0.31]
 [0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.
  0.   0.   0.   0.02 0.03 0.04 0.01 0.03 0.04 0.   1.  ]]
Pattern-to-pattern sim matrix:
[[ 1.    0.64  0.82  0.59  0.76  0.74  0.68  0.74  0.61  0.69  0.54  0.49
   0.54  0.62  0.81  0.38  0.57  0.12  0.65  0.51  0.32  0.31  0.36  0.09
   0.23]
 [ 0.64  1.    0.69  0.74  0.8   0.84  0.76  0.76  0.49  0.65  0.53  0.4
   0.62  0.52  0.6   0.4   0.43  0.22  0.7   0.6   0.4   0.41  0.43  0.19
   0.22]
 [ 0.82  0.69  1.    0.82  0.7   0.83  0.67  0.66  0.68  0.61  0.45  0.61
   0.59  0.6   0.75  0.33  0.54  0.11  0.59  0.73  0.4   0.29  0.37  0.11
   0.24]
 [ 0.59  0.74  0.82  1.    0.74  0.8   0.67  0.6   0.79  0.65  0.4   0.59
   0.61  0.64  0.72  0.44  0.54  0.14  0.6   0.68  0.41  0.31  0.37  0.11
   0.2 ]
 [ 0.76  0.8   0.7   0.74  1.    0.79  0.68  0.66  0.73  0.71  0.46  0.43
   0.62  0.7   0.78  0.51  0.54  0.21  0.78  0.56  0.44  0.38  0.48  0.16
   0.19]
 [ 0.74  0.84  0.83  0.8   0.79  1.    0.79  0.86  0.61  0.84  0.59  0.45
   0.69  0.63  0.74  0.46  0.58  0.13  0.72  0.69  0.44  0.43  0.43  0.12
   0.23]
 [ 0.68  0.76  0.67  0.67  0.68  0.79  1.    0.85  0.48  0.79  0.55  0.32
   0.45  0.41  0.53  0.31  0.4   0.14  0.65  0.41  0.29  0.29  0.31  0.15
   0.28]
 [ 0.74  0.76  0.66  0.6   0.66  0.86  0.85  1.    0.72  0.89  0.63  0.4
   0.57  0.55  0.45  0.44  0.46  0.11  0.68  0.36  0.33  0.28  0.29  0.15
   0.24]
 [ 0.61  0.49  0.68  0.79  0.73  0.61  0.48  0.72  1.    0.74  0.52  0.49
   0.52  0.69  0.67  0.48  0.53  0.16  0.66  0.63  0.48  0.36  0.39  0.16
   0.14]
 [ 0.69  0.65  0.61  0.65  0.71  0.84  0.79  0.89  0.74  1.    0.61  0.5
   0.64  0.63  0.68  0.59  0.61  0.06  0.71  0.56  0.37  0.35  0.38  0.07
   0.3 ]
 [ 0.54  0.53  0.45  0.4   0.46  0.59  0.55  0.63  0.52  0.61  1.    0.35
   0.35  0.38  0.29  0.33  0.32  0.11  0.49  0.28  0.2   0.29  0.28  0.28
   0.25]
 [ 0.49  0.4   0.61  0.59  0.43  0.45  0.32  0.4   0.49  0.5   0.35  1.
   0.71  0.74  0.69  0.58  0.8   0.01  0.37  0.44  0.29  0.16  0.49  0.08
   0.23]
 [ 0.54  0.62  0.59  0.61  0.62  0.69  0.45  0.57  0.52  0.64  0.35  0.71
   1.    0.76  0.71  0.5   0.71 -0.01  0.53  0.43  0.2   0.22  0.43  0.07
   0.14]
 [ 0.62  0.52  0.6   0.64  0.7   0.63  0.41  0.55  0.69  0.63  0.38  0.74
   0.76  1.    0.68  0.67  0.79 -0.    0.55  0.48  0.22  0.25  0.55  0.13
   0.11]
 [ 0.81  0.6   0.75  0.72  0.78  0.74  0.53  0.45  0.67  0.68  0.29  0.69
   0.71  0.68  1.    0.73  0.8   0.29  0.77  0.57  0.41  0.48  0.65  0.19
   0.23]
 [ 0.38  0.4   0.33  0.44  0.51  0.46  0.31  0.44  0.48  0.59  0.33  0.58
   0.5   0.67  0.73  1.    0.78  0.14  0.49  0.35  0.23  0.31  0.66  0.08
   0.15]
 [ 0.57  0.43  0.54  0.54  0.54  0.58  0.4   0.46  0.53  0.61  0.32  0.8
   0.71  0.79  0.8   0.78  1.    0.17  0.55  0.46  0.35  0.33  0.69  0.13
   0.19]
 [ 0.12  0.22  0.11  0.14  0.21  0.13  0.14  0.11  0.16  0.06  0.11  0.01
  -0.01 -0.    0.29  0.14  0.17  1.    0.65  0.64  0.8   0.83  0.74  0.85
   0.59]
 [ 0.65  0.7   0.59  0.6   0.78  0.72  0.65  0.68  0.66  0.71  0.49  0.37
   0.53  0.55  0.77  0.49  0.55  0.65  1.    0.7   0.66  0.77  0.78  0.54
   0.49]
 [ 0.51  0.6   0.73  0.68  0.56  0.69  0.41  0.36  0.63  0.56  0.28  0.44
   0.43  0.48  0.57  0.35  0.46  0.64  0.7   1.    0.68  0.76  0.74  0.6
   0.45]
 [ 0.32  0.4   0.4   0.41  0.44  0.44  0.29  0.33  0.48  0.37  0.2   0.29
   0.2   0.22  0.41  0.23  0.35  0.8   0.66  0.68  1.    0.73  0.72  0.76
   0.53]
 [ 0.31  0.41  0.29  0.31  0.38  0.43  0.29  0.28  0.36  0.35  0.29  0.16
   0.22  0.25  0.48  0.31  0.33  0.83  0.77  0.76  0.73  1.    0.84  0.81
   0.61]
 [ 0.36  0.43  0.37  0.37  0.48  0.43  0.31  0.29  0.39  0.38  0.28  0.49
   0.43  0.55  0.65  0.66  0.69  0.74  0.78  0.74  0.72  0.84  1.    0.7
   0.58]
 [ 0.09  0.19  0.11  0.11  0.16  0.12  0.15  0.15  0.16  0.07  0.28  0.08
   0.07  0.13  0.19  0.08  0.13  0.85  0.54  0.6   0.76  0.81  0.7   1.
   0.54]
 [ 0.23  0.22  0.24  0.2   0.19  0.23  0.28  0.24  0.14  0.3   0.25  0.23
   0.14  0.11  0.23  0.15  0.19  0.59  0.49  0.45  0.53  0.61  0.58  0.54
   1.  ]]
Got 25 patterns after merging
2024-03-16 16:52:08.391754 MEMORY 14.35643904
Performing filtering
2024-03-16 16:52:08.391936 MEMORY 14.35643904
Got 22 patterns after filtering
2024-03-16 16:52:08.957246 MEMORY 14.35643904
Total time taken is 544.39s
2024-03-16 16:52:08.957401 MEMORY 14.35643904
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 930 tasks      | elapsed:    0.5s
[Parallel(n_jobs=24)]: Done 1075 out of 1075 | elapsed:    0.6s finished
/ru-auth/local/home/lzhao/anaconda3/envs/jupyter-ml-clone/lib/python3.9/site-packages/sklearn/manifold/_t_sne.py:691: FutureWarning: 'square_distances' has been introduced in 0.24 to help phase out legacy squaring behavior. The 'legacy' setting will be removed in 1.1 (renaming of 0.26), and the default setting will be changed to True. In 1.3, 'square_distances' will be removed altogether, and distances will be squared by default. Set 'square_distances'=True to silence this warning.
  warnings.warn(
/ru-auth/local/home/lzhao/anaconda3/envs/jupyter-ml-clone/lib/python3.9/site-packages/sklearn/neighbors/_base.py:175: EfficiencyWarning: Precomputed sparse input was not sorted by data.
  warnings.warn('Precomputed sparse input was not sorted by data.',
Applying subclustering to the final motifs
On pattern 0
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 1075 samples in 0.007s...
[t-SNE] Computed neighbors for 1075 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 1000 / 1075
[t-SNE] Computed conditional probabilities for sample 1075 / 1075
[t-SNE] Mean sigma: 0.347312
[t-SNE] Computed conditional probabilities in 0.072s
[t-SNE] Iteration 50: error = 65.9391861, gradient norm = 0.2540770 (50 iterations in 0.083s)
[t-SNE] Iteration 100: error = 66.4559479, gradient norm = 0.2777155 (50 iterations in 0.085s)
[t-SNE] Iteration 150: error = 66.0141983, gradient norm = 0.2751226 (50 iterations in 0.090s)
[t-SNE] Iteration 200: error = 66.7456360, gradient norm = 0.2460423 (50 iterations in 0.092s)
[t-SNE] Iteration 250: error = 66.8137131, gradient norm = 0.2546190 (50 iterations in 0.086s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 66.813713
[t-SNE] Iteration 300: error = 1.7456172, gradient norm = 0.0018987 (50 iterations in 0.113s)
[t-SNE] Iteration 350: error = 1.6847682, gradient norm = 0.0005003 (50 iterations in 0.076s)
[t-SNE] Iteration 400: error = 1.6610442, gradient norm = 0.0002668 (50 iterations in 0.077s)
[t-SNE] Iteration 450: error = 1.6526546, gradient norm = 0.0001914 (50 iterations in 0.078s)
[t-SNE] Iteration 500: error = 1.6478076, gradient norm = 0.0001764 (50 iterations in 0.078s)
[t-SNE] Iteration 550: error = 1.6452427, gradient norm = 0.0000938 (50 iterations in 0.075s)
[t-SNE] Iteration 600: error = 1.6438715, gradient norm = 0.0000808 (50 iterations in 0.075s)
[t-SNE] Iteration 650: error = 1.6424729, gradient norm = 0.0000633 (50 iterations in 0.077s)
[t-SNE] Iteration 700: error = 1.6417580, gradient norm = 0.0000383 (50 iterations in 0.075s)
[t-SNE] Iteration 750: error = 1.6411153, gradient norm = 0.0000408 (50 iterations in 0.075s)
[t-SNE] Iteration 800: error = 1.6406860, gradient norm = 0.0000610 (50 iterations in 0.077s)
[t-SNE] Iteration 850: error = 1.6403290, gradient norm = 0.0000378 (50 iterations in 0.076s)
[t-SNE] Iteration 900: error = 1.6399859, gradient norm = 0.0000607 (50 iterations in 0.077s)
[t-SNE] Iteration 950: error = 1.6397974, gradient norm = 0.0000363 (50 iterations in 0.075s)
[t-SNE] Iteration 1000: error = 1.6395925, gradient norm = 0.0000346 (50 iterations in 0.076s)
[t-SNE] KL divergence after 1000 iterations: 1.639593
[t-SNE] Computed conditional probabilities for sample 1000 / 1075
[t-SNE] Computed conditional probabilities for sample 1075 / 1075
[t-SNE] Mean sigma: 0.347312
Beginning preprocessing + Leiden
2024-03-16 16:52:12.312301 MEMORY 14.35643904
Affmat transformed
2024-03-16 16:52:12.324762 MEMORY 14.35643904
sources, targets, weights extracted
2024-03-16 16:52:12.331829 MEMORY 14.35643904
About to launch parallel Leiden runs
2024-03-16 16:52:12.339002 MEMORY 14.35643904
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    2.8s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    9.6s finished
Parallel Leiden runs finished
2024-03-16 16:52:21.910078 MEMORY 14.35643904
Quality: 0.46179026607992685
Quality: 0.4662117337564274
Quality: 0.466343642456382
Quality: 0.46776245738203104
Quality: 0.468752823169703
Quality: 0.46879819525499544
Quality: 0.4692599746882638
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 344 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 411 out of 411 | elapsed:    0.1s finished
Got subclusters: Counter({0: 293, 1: 235, 2: 203, 3: 140, 4: 122, 5: 77, 6: 5})
On pattern 1
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 411 samples in 0.003s...
[t-SNE] Computed neighbors for 411 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 411 / 411
[t-SNE] Mean sigma: 0.370347
[t-SNE] Computed conditional probabilities in 0.028s
[t-SNE] Iteration 50: error = 65.0507812, gradient norm = 0.4924630 (50 iterations in 0.041s)
[t-SNE] Iteration 100: error = 67.9164886, gradient norm = 0.4800789 (50 iterations in 0.045s)
[t-SNE] Iteration 150: error = 68.6087875, gradient norm = 0.4859591 (50 iterations in 0.045s)
[t-SNE] Iteration 200: error = 70.9543762, gradient norm = 0.4449064 (50 iterations in 0.042s)
[t-SNE] Iteration 250: error = 69.1488266, gradient norm = 0.4691300 (50 iterations in 0.041s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 69.148827
[t-SNE] Iteration 300: error = 1.3647732, gradient norm = 0.0045194 (50 iterations in 0.039s)
[t-SNE] Iteration 350: error = 1.2747866, gradient norm = 0.0018011 (50 iterations in 0.040s)
[t-SNE] Iteration 400: error = 1.1544794, gradient norm = 0.0023243 (50 iterations in 0.039s)
[t-SNE] Iteration 450: error = 1.1272753, gradient norm = 0.0012121 (50 iterations in 0.040s)
[t-SNE] Iteration 500: error = 1.1153336, gradient norm = 0.0007851 (50 iterations in 0.039s)
[t-SNE] Iteration 550: error = 1.1109161, gradient norm = 0.0002416 (50 iterations in 0.039s)
[t-SNE] Iteration 600: error = 1.1082852, gradient norm = 0.0001733 (50 iterations in 0.038s)
[t-SNE] Iteration 650: error = 1.1062516, gradient norm = 0.0003292 (50 iterations in 0.038s)
[t-SNE] Iteration 700: error = 1.1049826, gradient norm = 0.0003918 (50 iterations in 0.039s)
[t-SNE] Iteration 750: error = 1.1027207, gradient norm = 0.0005276 (50 iterations in 0.040s)
[t-SNE] Iteration 800: error = 1.1013436, gradient norm = 0.0001787 (50 iterations in 0.041s)
[t-SNE] Iteration 850: error = 1.1017576, gradient norm = 0.0001277 (50 iterations in 0.038s)
[t-SNE] Iteration 900: error = 1.0969617, gradient norm = 0.0001808 (50 iterations in 0.038s)
[t-SNE] Iteration 950: error = 1.0958380, gradient norm = 0.0001803 (50 iterations in 0.038s)
[t-SNE] Iteration 1000: error = 1.0946599, gradient norm = 0.0007935 (50 iterations in 0.039s)
[t-SNE] KL divergence after 1000 iterations: 1.094660
[t-SNE] Computed conditional probabilities for sample 411 / 411
[t-SNE] Mean sigma: 0.370347
Beginning preprocessing + Leiden
2024-03-16 16:52:23.459069 MEMORY 14.35643904
Affmat transformed
2024-03-16 16:52:23.464337 MEMORY 14.35643904
sources, targets, weights extracted
2024-03-16 16:52:23.467176 MEMORY 14.35643904
About to launch parallel Leiden runs
2024-03-16 16:52:23.472510 MEMORY 14.35643904
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.1s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    3.5s finished
Parallel Leiden runs finished
2024-03-16 16:52:27.004392 MEMORY 14.35643904
Quality: 0.38196274525020363
Quality: 0.38201409756801774
Quality: 0.38211110237067497
Quality: 0.38220612632530343
Quality: 0.3824700226517932
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 239 out of 239 | elapsed:    0.1s finished
Got subclusters: Counter({0: 102, 1: 80, 2: 68, 3: 63, 4: 51, 5: 42, 6: 5})
On pattern 2
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 239 samples in 0.002s...
[t-SNE] Computed neighbors for 239 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 239 / 239
[t-SNE] Mean sigma: 0.378409
[t-SNE] Computed conditional probabilities in 0.016s
[t-SNE] Iteration 50: error = 61.9523315, gradient norm = 0.5093448 (50 iterations in 0.029s)
[t-SNE] Iteration 100: error = 64.2662277, gradient norm = 0.4736672 (50 iterations in 0.028s)
[t-SNE] Iteration 150: error = 61.5678635, gradient norm = 0.5404269 (50 iterations in 0.028s)
[t-SNE] Iteration 200: error = 64.0243912, gradient norm = 0.5110424 (50 iterations in 0.028s)
[t-SNE] Iteration 250: error = 64.0722961, gradient norm = 0.4824854 (50 iterations in 0.028s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 64.072296
[t-SNE] Iteration 300: error = 1.0945293, gradient norm = 0.0058728 (50 iterations in 0.040s)
[t-SNE] Iteration 350: error = 0.9197407, gradient norm = 0.0038563 (50 iterations in 0.038s)
[t-SNE] Iteration 400: error = 0.8627039, gradient norm = 0.0019694 (50 iterations in 0.037s)
[t-SNE] Iteration 450: error = 0.8571163, gradient norm = 0.0002681 (50 iterations in 0.038s)
[t-SNE] Iteration 500: error = 0.8568257, gradient norm = 0.0005043 (50 iterations in 0.037s)
[t-SNE] Iteration 550: error = 0.8551800, gradient norm = 0.0005101 (50 iterations in 0.038s)
[t-SNE] Iteration 600: error = 0.8378043, gradient norm = 0.0014648 (50 iterations in 0.038s)
[t-SNE] Iteration 650: error = 0.8331358, gradient norm = 0.0006964 (50 iterations in 0.038s)
[t-SNE] Iteration 700: error = 0.8236917, gradient norm = 0.0013423 (50 iterations in 0.038s)
[t-SNE] Iteration 750: error = 0.8222055, gradient norm = 0.0001580 (50 iterations in 0.037s)
[t-SNE] Iteration 800: error = 0.8221112, gradient norm = 0.0001551 (50 iterations in 0.037s)
[t-SNE] Iteration 850: error = 0.8225523, gradient norm = 0.0001994 (50 iterations in 0.037s)
[t-SNE] Iteration 900: error = 0.8221537, gradient norm = 0.0002353 (50 iterations in 0.036s)
[t-SNE] Iteration 950: error = 0.8220687, gradient norm = 0.0002507 (50 iterations in 0.038s)
[t-SNE] Iteration 1000: error = 0.8221658, gradient norm = 0.0002038 (50 iterations in 0.037s)
[t-SNE] KL divergence after 1000 iterations: 0.822166
[t-SNE] Computed conditional probabilities for sample 239 / 239
[t-SNE] Mean sigma: 0.378409
Beginning preprocessing + Leiden
2024-03-16 16:52:28.126120 MEMORY 14.35643904
Affmat transformed
2024-03-16 16:52:28.129283 MEMORY 14.35643904
sources, targets, weights extracted
2024-03-16 16:52:28.130617 MEMORY 14.35643904
About to launch parallel Leiden runs
2024-03-16 16:52:28.135823 MEMORY 14.35643904
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.8s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.5s finished
Parallel Leiden runs finished
2024-03-16 16:52:30.646129 MEMORY 14.35643904
Quality: 0.3213244009931868
Quality: 0.32595297507208837
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 215 out of 215 | elapsed:    0.1s finished
Got subclusters: Counter({0: 65, 1: 63, 2: 62, 3: 32, 4: 17})
On pattern 3
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 215 samples in 0.002s...
[t-SNE] Computed neighbors for 215 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 215 / 215
[t-SNE] Mean sigma: 0.391312
[t-SNE] Computed conditional probabilities in 0.014s
[t-SNE] Iteration 50: error = 58.3356323, gradient norm = 0.5091747 (50 iterations in 0.026s)
[t-SNE] Iteration 100: error = 58.6638412, gradient norm = 0.5323972 (50 iterations in 0.025s)
[t-SNE] Iteration 150: error = 59.3669281, gradient norm = 0.5331996 (50 iterations in 0.025s)
[t-SNE] Iteration 200: error = 58.1346359, gradient norm = 0.5109438 (50 iterations in 0.025s)
[t-SNE] Iteration 250: error = 61.9755173, gradient norm = 0.4748590 (50 iterations in 0.026s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 61.975517
[t-SNE] Iteration 300: error = 0.9394819, gradient norm = 0.0084062 (50 iterations in 0.025s)
[t-SNE] Iteration 350: error = 0.7937263, gradient norm = 0.0016715 (50 iterations in 0.025s)
[t-SNE] Iteration 400: error = 0.7663150, gradient norm = 0.0015014 (50 iterations in 0.025s)
[t-SNE] Iteration 450: error = 0.7593275, gradient norm = 0.0003015 (50 iterations in 0.025s)
[t-SNE] Iteration 500: error = 0.7592255, gradient norm = 0.0002082 (50 iterations in 0.025s)
[t-SNE] Iteration 550: error = 0.7594594, gradient norm = 0.0002239 (50 iterations in 0.025s)
[t-SNE] Iteration 600: error = 0.7592713, gradient norm = 0.0001706 (50 iterations in 0.024s)
[t-SNE] Iteration 650: error = 0.7592387, gradient norm = 0.0001896 (50 iterations in 0.025s)
[t-SNE] Iteration 700: error = 0.7591833, gradient norm = 0.0002420 (50 iterations in 0.024s)
[t-SNE] Iteration 750: error = 0.7591558, gradient norm = 0.0002432 (50 iterations in 0.025s)
[t-SNE] Iteration 800: error = 0.7592260, gradient norm = 0.0001911 (50 iterations in 0.025s)
[t-SNE] Iteration 850: error = 0.7593087, gradient norm = 0.0002642 (50 iterations in 0.025s)
[t-SNE] Iteration 900: error = 0.7591521, gradient norm = 0.0002107 (50 iterations in 0.025s)
[t-SNE] Iteration 950: error = 0.7591799, gradient norm = 0.0002263 (50 iterations in 0.024s)
[t-SNE] Iteration 1000: error = 0.7591907, gradient norm = 0.0002133 (50 iterations in 0.025s)
[t-SNE] KL divergence after 1000 iterations: 0.759191
[t-SNE] Computed conditional probabilities for sample 215 / 215
[t-SNE] Mean sigma: 0.391312
Beginning preprocessing + Leiden
2024-03-16 16:52:31.499488 MEMORY 14.35643904
Affmat transformed
2024-03-16 16:52:31.502273 MEMORY 14.35643904
sources, targets, weights extracted
2024-03-16 16:52:31.503388 MEMORY 14.35643904
About to launch parallel Leiden runs
2024-03-16 16:52:31.508222 MEMORY 14.35643904
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.8s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.4s finished
Parallel Leiden runs finished
2024-03-16 16:52:33.875917 MEMORY 14.35643904
Quality: 0.31008468926124616
Quality: 0.315076514939806
Quality: 0.31534538113678034
Quality: 0.31539466048553566
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 214 out of 214 | elapsed:    0.1s finished
Got subclusters: Counter({0: 47, 1: 47, 2: 35, 3: 34, 4: 32, 5: 20})
On pattern 4
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 214 samples in 0.002s...
[t-SNE] Computed neighbors for 214 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 214 / 214
[t-SNE] Mean sigma: 0.383972
[t-SNE] Computed conditional probabilities in 0.014s
[t-SNE] Iteration 50: error = 60.0852699, gradient norm = 0.4823008 (50 iterations in 0.027s)
[t-SNE] Iteration 100: error = 64.1931763, gradient norm = 0.4422095 (50 iterations in 0.029s)
[t-SNE] Iteration 150: error = 60.8196487, gradient norm = 0.4819991 (50 iterations in 0.026s)
[t-SNE] Iteration 200: error = 58.8319893, gradient norm = 0.5408757 (50 iterations in 0.026s)
[t-SNE] Iteration 250: error = 60.7912750, gradient norm = 0.4932469 (50 iterations in 0.025s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 60.791275
[t-SNE] Iteration 300: error = 0.9612067, gradient norm = 0.0055772 (50 iterations in 0.025s)
[t-SNE] Iteration 350: error = 0.8346013, gradient norm = 0.0046456 (50 iterations in 0.025s)
[t-SNE] Iteration 400: error = 0.7489101, gradient norm = 0.0032961 (50 iterations in 0.025s)
[t-SNE] Iteration 450: error = 0.6986750, gradient norm = 0.0020390 (50 iterations in 0.025s)
[t-SNE] Iteration 500: error = 0.6977588, gradient norm = 0.0001679 (50 iterations in 0.024s)
[t-SNE] Iteration 550: error = 0.6978616, gradient norm = 0.0000958 (50 iterations in 0.024s)
[t-SNE] Iteration 600: error = 0.6978706, gradient norm = 0.0000729 (50 iterations in 0.024s)
[t-SNE] Iteration 650: error = 0.6977408, gradient norm = 0.0001742 (50 iterations in 0.024s)
[t-SNE] Iteration 700: error = 0.6977690, gradient norm = 0.0001495 (50 iterations in 0.024s)
[t-SNE] Iteration 750: error = 0.6977313, gradient norm = 0.0001408 (50 iterations in 0.024s)
[t-SNE] Iteration 800: error = 0.6976888, gradient norm = 0.0001717 (50 iterations in 0.024s)
[t-SNE] Iteration 850: error = 0.6976855, gradient norm = 0.0000973 (50 iterations in 0.024s)
[t-SNE] Iteration 900: error = 0.6976656, gradient norm = 0.0000843 (50 iterations in 0.024s)
[t-SNE] Iteration 950: error = 0.6977864, gradient norm = 0.0001271 (50 iterations in 0.024s)
[t-SNE] Iteration 1000: error = 0.6977737, gradient norm = 0.0001013 (50 iterations in 0.024s)
[t-SNE] KL divergence after 1000 iterations: 0.697774
[t-SNE] Computed conditional probabilities for sample 214 / 214
[t-SNE] Mean sigma: 0.383972
Beginning preprocessing + Leiden
2024-03-16 16:52:34.729606 MEMORY 14.35643904
Affmat transformed
2024-03-16 16:52:34.732542 MEMORY 14.35643904
sources, targets, weights extracted
2024-03-16 16:52:34.733662 MEMORY 14.35643904
About to launch parallel Leiden runs
2024-03-16 16:52:34.738376 MEMORY 14.35643904
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.8s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.4s finished
Parallel Leiden runs finished
2024-03-16 16:52:37.135595 MEMORY 14.35643904
Quality: 0.3242917789473615
Quality: 0.325744629828723
Quality: 0.32690712569708946
Quality: 0.3283840980551839
Quality: 0.32845886452679174
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 202 out of 202 | elapsed:    0.1s finished
Got subclusters: Counter({0: 59, 1: 47, 2: 45, 3: 43, 4: 17, 5: 3})
On pattern 5
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 202 samples in 0.002s...
[t-SNE] Computed neighbors for 202 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 202 / 202
[t-SNE] Mean sigma: 0.382754
[t-SNE] Computed conditional probabilities in 0.013s
[t-SNE] Iteration 50: error = 60.5912514, gradient norm = 0.4979010 (50 iterations in 0.025s)
[t-SNE] Iteration 100: error = 59.7452316, gradient norm = 0.4997692 (50 iterations in 0.025s)
[t-SNE] Iteration 150: error = 62.2932243, gradient norm = 0.4873977 (50 iterations in 0.025s)
[t-SNE] Iteration 200: error = 62.2964211, gradient norm = 0.5304478 (50 iterations in 0.025s)
[t-SNE] Iteration 250: error = 58.6323662, gradient norm = 0.4973781 (50 iterations in 0.025s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 58.632366
[t-SNE] Iteration 300: error = 0.9789222, gradient norm = 0.0065875 (50 iterations in 0.024s)
[t-SNE] Iteration 350: error = 0.8177167, gradient norm = 0.0030724 (50 iterations in 0.024s)
[t-SNE] Iteration 400: error = 0.7913181, gradient norm = 0.0032249 (50 iterations in 0.024s)
[t-SNE] Iteration 450: error = 0.7842844, gradient norm = 0.0002876 (50 iterations in 0.024s)
[t-SNE] Iteration 500: error = 0.7842838, gradient norm = 0.0001842 (50 iterations in 0.024s)
[t-SNE] Iteration 550: error = 0.7842488, gradient norm = 0.0001677 (50 iterations in 0.024s)
[t-SNE] Iteration 600: error = 0.7847306, gradient norm = 0.0002324 (50 iterations in 0.024s)
[t-SNE] Iteration 650: error = 0.7846524, gradient norm = 0.0001514 (50 iterations in 0.024s)
[t-SNE] Iteration 700: error = 0.7843838, gradient norm = 0.0001292 (50 iterations in 0.024s)
[t-SNE] Iteration 750: error = 0.7844214, gradient norm = 0.0002024 (50 iterations in 0.024s)
[t-SNE] Iteration 800: error = 0.7844309, gradient norm = 0.0001779 (50 iterations in 0.024s)
[t-SNE] Iteration 850: error = 0.7845212, gradient norm = 0.0001929 (50 iterations in 0.024s)
[t-SNE] Iteration 900: error = 0.7843410, gradient norm = 0.0001525 (50 iterations in 0.024s)
[t-SNE] Iteration 900: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 900 iterations: 0.784341
[t-SNE] Computed conditional probabilities for sample 202 / 202
[t-SNE] Mean sigma: 0.382754
Beginning preprocessing + Leiden
2024-03-16 16:52:37.919153 MEMORY 14.35643904
Affmat transformed
2024-03-16 16:52:37.921892 MEMORY 14.35643904
sources, targets, weights extracted
2024-03-16 16:52:37.922909 MEMORY 14.35643904
About to launch parallel Leiden runs
2024-03-16 16:52:37.927584 MEMORY 14.35643904
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.8s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.4s finished
Parallel Leiden runs finished
2024-03-16 16:52:40.291830 MEMORY 14.35643904
Quality: 0.2736069329073793
Quality: 0.28642777347052983
Quality: 0.2880147308715701
Quality: 0.2883399221809407
Quality: 0.2883958703479962
Quality: 0.2886826723849015
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 184 out of 184 | elapsed:    0.1s finished
Got subclusters: Counter({0: 55, 1: 52, 2: 45, 3: 38, 4: 12})
On pattern 6
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 184 samples in 0.002s...
[t-SNE] Computed neighbors for 184 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 184 / 184
[t-SNE] Mean sigma: 0.407852
[t-SNE] Computed conditional probabilities in 0.013s
[t-SNE] Iteration 50: error = 56.3751450, gradient norm = 0.5390996 (50 iterations in 0.031s)
[t-SNE] Iteration 100: error = 58.7515450, gradient norm = 0.5104263 (50 iterations in 0.024s)
[t-SNE] Iteration 150: error = 62.2005730, gradient norm = 0.4169716 (50 iterations in 0.024s)
[t-SNE] Iteration 200: error = 59.8128471, gradient norm = 0.4834315 (50 iterations in 0.024s)
[t-SNE] Iteration 250: error = 58.5695877, gradient norm = 0.5091333 (50 iterations in 0.024s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 58.569588
[t-SNE] Iteration 300: error = 0.8554127, gradient norm = 0.0084728 (50 iterations in 0.024s)
[t-SNE] Iteration 350: error = 0.7384375, gradient norm = 0.0029037 (50 iterations in 0.023s)
[t-SNE] Iteration 400: error = 0.7193960, gradient norm = 0.0022006 (50 iterations in 0.023s)
[t-SNE] Iteration 450: error = 0.7144399, gradient norm = 0.0001914 (50 iterations in 0.023s)
[t-SNE] Iteration 500: error = 0.7142896, gradient norm = 0.0001570 (50 iterations in 0.023s)
[t-SNE] Iteration 550: error = 0.7143589, gradient norm = 0.0001689 (50 iterations in 0.023s)
[t-SNE] Iteration 600: error = 0.7142970, gradient norm = 0.0002207 (50 iterations in 0.023s)
[t-SNE] Iteration 650: error = 0.7143728, gradient norm = 0.0001581 (50 iterations in 0.023s)
[t-SNE] Iteration 700: error = 0.7142665, gradient norm = 0.0001590 (50 iterations in 0.023s)
[t-SNE] Iteration 750: error = 0.7143449, gradient norm = 0.0001848 (50 iterations in 0.023s)
[t-SNE] Iteration 800: error = 0.7143843, gradient norm = 0.0001456 (50 iterations in 0.023s)
[t-SNE] Iteration 850: error = 0.7143317, gradient norm = 0.0001749 (50 iterations in 0.023s)
[t-SNE] Iteration 900: error = 0.7143620, gradient norm = 0.0001542 (50 iterations in 0.026s)
[t-SNE] Iteration 950: error = 0.7143795, gradient norm = 0.0001406 (50 iterations in 0.023s)
[t-SNE] Iteration 1000: error = 0.7142957, gradient norm = 0.0001536 (50 iterations in 0.023s)
[t-SNE] KL divergence after 1000 iterations: 0.714296
[t-SNE] Computed conditional probabilities for sample 184 / 184
[t-SNE] Mean sigma: 0.407853
Beginning preprocessing + Leiden
2024-03-16 16:52:41.060896 MEMORY 14.35643904
Affmat transformed
2024-03-16 16:52:41.063619 MEMORY 14.35643904
sources, targets, weights extracted
2024-03-16 16:52:41.064605 MEMORY 14.35643904
About to launch parallel Leiden runs
2024-03-16 16:52:41.069445 MEMORY 14.35643904
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.8s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.2s finished
Parallel Leiden runs finished
2024-03-16 16:52:43.256895 MEMORY 14.35643904
Quality: 0.29520376224987865
Quality: 0.29551454572359914
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 162 out of 162 | elapsed:    0.1s finished
Got subclusters: Counter({0: 40, 1: 37, 2: 34, 3: 30, 4: 25, 5: 18})
On pattern 7
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 162 samples in 0.002s...
[t-SNE] Computed neighbors for 162 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 162 / 162
[t-SNE] Mean sigma: 0.439710
[t-SNE] Computed conditional probabilities in 0.011s
[t-SNE] Iteration 50: error = 56.6084251, gradient norm = 0.4663621 (50 iterations in 0.023s)
[t-SNE] Iteration 100: error = 63.4775391, gradient norm = 0.4608411 (50 iterations in 0.023s)
[t-SNE] Iteration 150: error = 59.2186089, gradient norm = 0.5205571 (50 iterations in 0.023s)
[t-SNE] Iteration 200: error = 57.8000793, gradient norm = 0.5250869 (50 iterations in 0.024s)
[t-SNE] Iteration 250: error = 61.1035042, gradient norm = 0.4965525 (50 iterations in 0.023s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 61.103504
[t-SNE] Iteration 300: error = 0.8808638, gradient norm = 0.0123582 (50 iterations in 0.023s)
[t-SNE] Iteration 350: error = 0.5840179, gradient norm = 0.0048054 (50 iterations in 0.022s)
[t-SNE] Iteration 400: error = 0.5757362, gradient norm = 0.0003497 (50 iterations in 0.022s)
[t-SNE] Iteration 450: error = 0.5756779, gradient norm = 0.0003147 (50 iterations in 0.022s)
[t-SNE] Iteration 500: error = 0.5756380, gradient norm = 0.0002958 (50 iterations in 0.021s)
[t-SNE] Iteration 550: error = 0.5754740, gradient norm = 0.0002626 (50 iterations in 0.022s)
[t-SNE] Iteration 600: error = 0.5756803, gradient norm = 0.0003632 (50 iterations in 0.022s)
[t-SNE] Iteration 650: error = 0.5754918, gradient norm = 0.0002636 (50 iterations in 0.022s)
[t-SNE] Iteration 700: error = 0.5753748, gradient norm = 0.0003414 (50 iterations in 0.022s)
[t-SNE] Iteration 750: error = 0.5754043, gradient norm = 0.0002829 (50 iterations in 0.021s)
[t-SNE] Iteration 800: error = 0.5753810, gradient norm = 0.0004259 (50 iterations in 0.023s)
[t-SNE] Iteration 850: error = 0.5754329, gradient norm = 0.0002827 (50 iterations in 0.021s)
[t-SNE] Iteration 900: error = 0.5754812, gradient norm = 0.0004181 (50 iterations in 0.023s)
[t-SNE] Iteration 950: error = 0.5754529, gradient norm = 0.0003280 (50 iterations in 0.022s)
[t-SNE] Iteration 1000: error = 0.5754551, gradient norm = 0.0003824 (50 iterations in 0.022s)
[t-SNE] KL divergence after 1000 iterations: 0.575455
[t-SNE] Computed conditional probabilities for sample 162 / 162
[t-SNE] Mean sigma: 0.439710
Beginning preprocessing + Leiden
2024-03-16 16:52:43.957224 MEMORY 14.35643904
Affmat transformed
2024-03-16 16:52:43.959540 MEMORY 14.35643904
sources, targets, weights extracted
2024-03-16 16:52:43.960388 MEMORY 14.35643904
About to launch parallel Leiden runs
2024-03-16 16:52:43.965777 MEMORY 14.35643904
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.0s finished
Parallel Leiden runs finished
2024-03-16 16:52:46.005318 MEMORY 14.35643904
Quality: 0.2836792343145533
Quality: 0.2846242260160126
Quality: 0.28482890182375875
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 112 out of 159 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=24)]: Done 159 out of 159 | elapsed:    0.1s finished
Got subclusters: Counter({0: 40, 1: 39, 2: 26, 3: 20, 4: 14, 5: 14, 6: 9})
On pattern 8
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 159 samples in 0.001s...
[t-SNE] Computed neighbors for 159 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 159 / 159
[t-SNE] Mean sigma: 0.473407
[t-SNE] Computed conditional probabilities in 0.011s
[t-SNE] Iteration 50: error = 56.2905045, gradient norm = 0.5637737 (50 iterations in 0.022s)
[t-SNE] Iteration 100: error = 55.3209343, gradient norm = 0.5595395 (50 iterations in 0.023s)
[t-SNE] Iteration 150: error = 57.8601341, gradient norm = 0.5049375 (50 iterations in 0.023s)
[t-SNE] Iteration 200: error = 55.5129471, gradient norm = 0.5134032 (50 iterations in 0.023s)
[t-SNE] Iteration 250: error = 54.8507004, gradient norm = 0.5577636 (50 iterations in 0.023s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 54.850700
[t-SNE] Iteration 300: error = 0.7961378, gradient norm = 0.0094069 (50 iterations in 0.023s)
[t-SNE] Iteration 350: error = 0.5766097, gradient norm = 0.0018728 (50 iterations in 0.023s)
[t-SNE] Iteration 400: error = 0.5675520, gradient norm = 0.0002821 (50 iterations in 0.023s)
[t-SNE] Iteration 450: error = 0.5674998, gradient norm = 0.0001119 (50 iterations in 0.024s)
[t-SNE] Iteration 500: error = 0.5675043, gradient norm = 0.0000793 (50 iterations in 0.023s)
[t-SNE] Iteration 550: error = 0.5675921, gradient norm = 0.0001650 (50 iterations in 0.023s)
[t-SNE] Iteration 600: error = 0.5674799, gradient norm = 0.0002006 (50 iterations in 0.021s)
[t-SNE] Iteration 650: error = 0.5675089, gradient norm = 0.0002020 (50 iterations in 0.021s)
[t-SNE] Iteration 700: error = 0.5674935, gradient norm = 0.0002159 (50 iterations in 0.022s)
[t-SNE] Iteration 750: error = 0.5674959, gradient norm = 0.0002185 (50 iterations in 0.022s)
[t-SNE] Iteration 800: error = 0.5675603, gradient norm = 0.0002398 (50 iterations in 0.021s)
[t-SNE] Iteration 850: error = 0.5672258, gradient norm = 0.0001829 (50 iterations in 0.023s)
[t-SNE] Iteration 900: error = 0.5672390, gradient norm = 0.0001801 (50 iterations in 0.021s)
[t-SNE] Iteration 950: error = 0.5672062, gradient norm = 0.0001619 (50 iterations in 0.022s)
[t-SNE] Iteration 1000: error = 0.5671789, gradient norm = 0.0002068 (50 iterations in 0.022s)
[t-SNE] KL divergence after 1000 iterations: 0.567179
[t-SNE] Computed conditional probabilities for sample 159 / 159
[t-SNE] Mean sigma: 0.473407
Beginning preprocessing + Leiden
2024-03-16 16:52:46.696588 MEMORY 14.35643904
Affmat transformed
2024-03-16 16:52:46.698822 MEMORY 14.35643904
sources, targets, weights extracted
2024-03-16 16:52:46.699643 MEMORY 14.35643904
About to launch parallel Leiden runs
2024-03-16 16:52:46.704076 MEMORY 14.35643904
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.1s finished
Parallel Leiden runs finished
2024-03-16 16:52:48.781205 MEMORY 14.35643904
Quality: 0.284500134412213
Quality: 0.2846469845094658
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  98 out of 145 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=24)]: Done 145 out of 145 | elapsed:    0.0s finished
Got subclusters: Counter({0: 38, 1: 37, 2: 34, 3: 27, 4: 23})
On pattern 9
[t-SNE] Computing 144 nearest neighbors...
[t-SNE] Indexed 145 samples in 0.001s...
[t-SNE] Computed neighbors for 145 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 145 / 145
[t-SNE] Mean sigma: 0.456652
[t-SNE] Computed conditional probabilities in 0.009s
[t-SNE] Iteration 50: error = 54.8969002, gradient norm = 0.5331802 (50 iterations in 0.022s)
[t-SNE] Iteration 100: error = 55.6737709, gradient norm = 0.5615587 (50 iterations in 0.022s)
[t-SNE] Iteration 150: error = 56.4737320, gradient norm = 0.5144551 (50 iterations in 0.021s)
[t-SNE] Iteration 200: error = 58.3753624, gradient norm = 0.4953685 (50 iterations in 0.021s)
[t-SNE] Iteration 250: error = 54.9014397, gradient norm = 0.5706046 (50 iterations in 0.021s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 54.901440
[t-SNE] Iteration 300: error = 0.6986911, gradient norm = 0.0125290 (50 iterations in 0.022s)
[t-SNE] Iteration 350: error = 0.5622147, gradient norm = 0.0022569 (50 iterations in 0.020s)
[t-SNE] Iteration 400: error = 0.5609450, gradient norm = 0.0002879 (50 iterations in 0.020s)
[t-SNE] Iteration 450: error = 0.5609320, gradient norm = 0.0002648 (50 iterations in 0.020s)
[t-SNE] Iteration 500: error = 0.5609450, gradient norm = 0.0003177 (50 iterations in 0.020s)
[t-SNE] Iteration 550: error = 0.5609477, gradient norm = 0.0003267 (50 iterations in 0.020s)
[t-SNE] Iteration 600: error = 0.5608798, gradient norm = 0.0002598 (50 iterations in 0.020s)
[t-SNE] Iteration 650: error = 0.5607771, gradient norm = 0.0002746 (50 iterations in 0.020s)
[t-SNE] Iteration 700: error = 0.5609989, gradient norm = 0.0003120 (50 iterations in 0.020s)
[t-SNE] Iteration 750: error = 0.5608472, gradient norm = 0.0002764 (50 iterations in 0.021s)
[t-SNE] Iteration 800: error = 0.5609055, gradient norm = 0.0003849 (50 iterations in 0.020s)
[t-SNE] Iteration 850: error = 0.5607788, gradient norm = 0.0003488 (50 iterations in 0.020s)
[t-SNE] Iteration 900: error = 0.5609237, gradient norm = 0.0004546 (50 iterations in 0.020s)
[t-SNE] Iteration 950: error = 0.5609206, gradient norm = 0.0003011 (50 iterations in 0.020s)
[t-SNE] Iteration 1000: error = 0.5609139, gradient norm = 0.0002499 (50 iterations in 0.020s)
[t-SNE] Iteration 1000: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 1000 iterations: 0.560914
[t-SNE] Computed conditional probabilities for sample 145 / 145
[t-SNE] Mean sigma: 0.456652
Beginning preprocessing + Leiden
2024-03-16 16:52:49.406502 MEMORY 14.35643904
Affmat transformed
2024-03-16 16:52:49.408298 MEMORY 14.35643904
sources, targets, weights extracted
2024-03-16 16:52:49.408995 MEMORY 14.35643904
About to launch parallel Leiden runs
2024-03-16 16:52:49.413900 MEMORY 14.35643904
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.0s finished
Parallel Leiden runs finished
2024-03-16 16:52:51.444805 MEMORY 14.35643904
Quality: 0.26876714812698665
Quality: 0.2693103171947445
Quality: 0.269487216151235
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 128 out of 128 | elapsed:    0.0s finished
Got subclusters: Counter({0: 34, 1: 34, 2: 32, 3: 31, 4: 14})
On pattern 10
[t-SNE] Computing 127 nearest neighbors...
[t-SNE] Indexed 128 samples in 0.001s...
[t-SNE] Computed neighbors for 128 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 128 / 128
[t-SNE] Mean sigma: 0.455322
[t-SNE] Computed conditional probabilities in 0.007s
[t-SNE] Iteration 50: error = 56.1498718, gradient norm = 0.5315416 (50 iterations in 0.023s)
[t-SNE] Iteration 100: error = 54.9258804, gradient norm = 0.5225025 (50 iterations in 0.019s)
[t-SNE] Iteration 150: error = 52.9809494, gradient norm = 0.5198211 (50 iterations in 0.020s)
[t-SNE] Iteration 200: error = 55.1398239, gradient norm = 0.4580542 (50 iterations in 0.019s)
[t-SNE] Iteration 250: error = 56.1747932, gradient norm = 0.5470459 (50 iterations in 0.020s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 56.174793
[t-SNE] Iteration 300: error = 0.7899268, gradient norm = 0.0121892 (50 iterations in 0.018s)
[t-SNE] Iteration 350: error = 0.4621027, gradient norm = 0.0046716 (50 iterations in 0.019s)
[t-SNE] Iteration 400: error = 0.4603801, gradient norm = 0.0002004 (50 iterations in 0.019s)
[t-SNE] Iteration 450: error = 0.4602212, gradient norm = 0.0002344 (50 iterations in 0.019s)
[t-SNE] Iteration 500: error = 0.4601843, gradient norm = 0.0002479 (50 iterations in 0.018s)
[t-SNE] Iteration 550: error = 0.4602098, gradient norm = 0.0001817 (50 iterations in 0.019s)
[t-SNE] Iteration 600: error = 0.4602412, gradient norm = 0.0001784 (50 iterations in 0.019s)
[t-SNE] Iteration 650: error = 0.4602355, gradient norm = 0.0002098 (50 iterations in 0.019s)
[t-SNE] Iteration 700: error = 0.4602089, gradient norm = 0.0001510 (50 iterations in 0.027s)
[t-SNE] Iteration 750: error = 0.4602220, gradient norm = 0.0001876 (50 iterations in 0.019s)
[t-SNE] Iteration 800: error = 0.4603345, gradient norm = 0.0008815 (50 iterations in 0.018s)
[t-SNE] Iteration 850: error = 0.4602574, gradient norm = 0.0002174 (50 iterations in 0.019s)
[t-SNE] Iteration 850: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 850 iterations: 0.460257
[t-SNE] Computed conditional probabilities for sample 128 / 128
[t-SNE] Mean sigma: 0.455322
Beginning preprocessing + Leiden
2024-03-16 16:52:51.958561 MEMORY 14.35643904
Affmat transformed
2024-03-16 16:52:51.960285 MEMORY 14.35643904
sources, targets, weights extracted
2024-03-16 16:52:51.960882 MEMORY 14.35643904
About to launch parallel Leiden runs
2024-03-16 16:52:51.982472 MEMORY 14.35643904
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.9s finished
Parallel Leiden runs finished
2024-03-16 16:52:53.881340 MEMORY 14.35643904
Quality: 0.2809934446483922
Quality: 0.28214205685502836
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 126 out of 126 | elapsed:    0.0s finished
Got subclusters: Counter({1: 30, 0: 30, 2: 29, 3: 23, 4: 16})
On pattern 11
[t-SNE] Computing 125 nearest neighbors...
[t-SNE] Indexed 126 samples in 0.001s...
[t-SNE] Computed neighbors for 126 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 126 / 126
[t-SNE] Mean sigma: 0.449950
[t-SNE] Computed conditional probabilities in 0.007s
[t-SNE] Iteration 50: error = 53.8641167, gradient norm = 0.5609895 (50 iterations in 0.021s)
[t-SNE] Iteration 100: error = 54.5646935, gradient norm = 0.5166590 (50 iterations in 0.019s)
[t-SNE] Iteration 150: error = 54.4748573, gradient norm = 0.5286599 (50 iterations in 0.019s)
[t-SNE] Iteration 200: error = 52.7256622, gradient norm = 0.5653861 (50 iterations in 0.018s)
[t-SNE] Iteration 250: error = 54.9268494, gradient norm = 0.5579940 (50 iterations in 0.019s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 54.926849
[t-SNE] Iteration 300: error = 0.7449402, gradient norm = 0.0095033 (50 iterations in 0.020s)
[t-SNE] Iteration 350: error = 0.4558610, gradient norm = 0.0037736 (50 iterations in 0.019s)
[t-SNE] Iteration 400: error = 0.4544604, gradient norm = 0.0004032 (50 iterations in 0.019s)
[t-SNE] Iteration 450: error = 0.4542670, gradient norm = 0.0003731 (50 iterations in 0.018s)
[t-SNE] Iteration 500: error = 0.4543813, gradient norm = 0.0002568 (50 iterations in 0.018s)
[t-SNE] Iteration 550: error = 0.4543694, gradient norm = 0.0004128 (50 iterations in 0.018s)
[t-SNE] Iteration 600: error = 0.4543192, gradient norm = 0.0002823 (50 iterations in 0.018s)
[t-SNE] Iteration 650: error = 0.4545272, gradient norm = 0.0003725 (50 iterations in 0.018s)
[t-SNE] Iteration 700: error = 0.4544651, gradient norm = 0.0003741 (50 iterations in 0.018s)
[t-SNE] Iteration 750: error = 0.4543716, gradient norm = 0.0003442 (50 iterations in 0.018s)
[t-SNE] Iteration 800: error = 0.4546010, gradient norm = 0.0003393 (50 iterations in 0.018s)
[t-SNE] Iteration 800: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 800 iterations: 0.454601
[t-SNE] Computed conditional probabilities for sample 126 / 126
[t-SNE] Mean sigma: 0.449950
Beginning preprocessing + Leiden
2024-03-16 16:52:54.394390 MEMORY 14.35643904
Affmat transformed
2024-03-16 16:52:54.395952 MEMORY 14.35643904
sources, targets, weights extracted
2024-03-16 16:52:54.396557 MEMORY 14.35643904
About to launch parallel Leiden runs
2024-03-16 16:52:54.400672 MEMORY 14.35643904
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.9s finished
Parallel Leiden runs finished
2024-03-16 16:52:56.295910 MEMORY 14.35643904
Quality: 0.2592292166033269
Quality: 0.259802179916676
Quality: 0.2601497907327958
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 122 out of 122 | elapsed:    0.0s finished
Got subclusters: Counter({0: 35, 1: 32, 2: 19, 3: 16, 4: 10, 6: 7, 5: 7})
On pattern 12
[t-SNE] Computing 121 nearest neighbors...
[t-SNE] Indexed 122 samples in 0.001s...
[t-SNE] Computed neighbors for 122 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 122 / 122
[t-SNE] Mean sigma: 0.452834
[t-SNE] Computed conditional probabilities in 0.007s
[t-SNE] Iteration 50: error = 56.5120811, gradient norm = 0.5032261 (50 iterations in 0.018s)
[t-SNE] Iteration 100: error = 55.6772919, gradient norm = 0.4846750 (50 iterations in 0.018s)
[t-SNE] Iteration 150: error = 54.4746857, gradient norm = 0.5497358 (50 iterations in 0.020s)
[t-SNE] Iteration 200: error = 52.7375298, gradient norm = 0.5784921 (50 iterations in 0.019s)
[t-SNE] Iteration 250: error = 53.6778641, gradient norm = 0.5620638 (50 iterations in 0.017s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 53.677864
[t-SNE] Iteration 300: error = 0.7224527, gradient norm = 0.0086584 (50 iterations in 0.020s)
[t-SNE] Iteration 350: error = 0.4355253, gradient norm = 0.0034142 (50 iterations in 0.018s)
[t-SNE] Iteration 400: error = 0.4353146, gradient norm = 0.0005678 (50 iterations in 0.019s)
[t-SNE] Iteration 450: error = 0.4354709, gradient norm = 0.0002774 (50 iterations in 0.019s)
[t-SNE] Iteration 500: error = 0.4354655, gradient norm = 0.0003071 (50 iterations in 0.018s)
[t-SNE] Iteration 550: error = 0.4353387, gradient norm = 0.0003651 (50 iterations in 0.019s)
[t-SNE] Iteration 600: error = 0.4354899, gradient norm = 0.0003159 (50 iterations in 0.018s)
[t-SNE] Iteration 650: error = 0.4354438, gradient norm = 0.0002492 (50 iterations in 0.018s)
[t-SNE] Iteration 700: error = 0.4354670, gradient norm = 0.0003469 (50 iterations in 0.019s)
[t-SNE] Iteration 750: error = 0.4355061, gradient norm = 0.0003548 (50 iterations in 0.019s)
[t-SNE] Iteration 750: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 750 iterations: 0.435506
[t-SNE] Computed conditional probabilities for sample 122 / 122
[t-SNE] Mean sigma: 0.452834
Beginning preprocessing + Leiden
2024-03-16 16:52:56.764081 MEMORY 14.35643904
Affmat transformed
2024-03-16 16:52:56.765655 MEMORY 14.35643904
sources, targets, weights extracted
2024-03-16 16:52:56.766200 MEMORY 14.35643904
About to launch parallel Leiden runs
2024-03-16 16:52:56.771007 MEMORY 14.35643904
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.9s finished
Parallel Leiden runs finished
2024-03-16 16:52:58.646602 MEMORY 14.35643904
Quality: 0.2429798654349098
Quality: 0.24321546907674194
Quality: 0.24412867996882917
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 110 out of 110 | elapsed:    0.0s finished
Got subclusters: Counter({0: 39, 1: 27, 2: 25, 3: 15, 4: 14, 5: 2})
On pattern 13
[t-SNE] Computing 109 nearest neighbors...
[t-SNE] Indexed 110 samples in 0.001s...
[t-SNE] Computed neighbors for 110 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 110 / 110
[t-SNE] Mean sigma: 0.464683
[t-SNE] Computed conditional probabilities in 0.005s
[t-SNE] Iteration 50: error = 54.4182358, gradient norm = 0.4380539 (50 iterations in 0.088s)
[t-SNE] Iteration 100: error = 53.6149406, gradient norm = 0.4772863 (50 iterations in 0.017s)
[t-SNE] Iteration 150: error = 52.0287857, gradient norm = 0.5835751 (50 iterations in 0.017s)
[t-SNE] Iteration 200: error = 55.6738243, gradient norm = 0.5188271 (50 iterations in 0.017s)
[t-SNE] Iteration 250: error = 54.5639038, gradient norm = 0.4382580 (50 iterations in 0.017s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 54.563904
[t-SNE] Iteration 300: error = 0.9277245, gradient norm = 0.0062330 (50 iterations in 0.018s)
[t-SNE] Iteration 350: error = 0.5376775, gradient norm = 0.0202466 (50 iterations in 0.017s)
[t-SNE] Iteration 400: error = 0.3191211, gradient norm = 0.0026515 (50 iterations in 0.018s)
[t-SNE] Iteration 450: error = 0.3183117, gradient norm = 0.0004812 (50 iterations in 0.017s)
[t-SNE] Iteration 500: error = 0.3180111, gradient norm = 0.0006310 (50 iterations in 0.017s)
[t-SNE] Iteration 550: error = 0.3181618, gradient norm = 0.0007071 (50 iterations in 0.018s)
[t-SNE] Iteration 600: error = 0.3178647, gradient norm = 0.0006387 (50 iterations in 0.017s)
[t-SNE] Iteration 650: error = 0.3177959, gradient norm = 0.0004303 (50 iterations in 0.018s)
[t-SNE] Iteration 700: error = 0.3182249, gradient norm = 0.0006612 (50 iterations in 0.018s)
[t-SNE] Iteration 750: error = 0.3181948, gradient norm = 0.0006593 (50 iterations in 0.018s)
[t-SNE] Iteration 800: error = 0.3180984, gradient norm = 0.0006485 (50 iterations in 0.017s)
[t-SNE] Iteration 850: error = 0.3181540, gradient norm = 0.0005396 (50 iterations in 0.017s)
[t-SNE] Iteration 900: error = 0.3183390, gradient norm = 0.0007575 (50 iterations in 0.017s)
[t-SNE] Iteration 950: error = 0.3178473, gradient norm = 0.0005960 (50 iterations in 0.017s)
[t-SNE] Iteration 1000: error = 0.3179796, gradient norm = 0.0006432 (50 iterations in 0.017s)
[t-SNE] Iteration 1000: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 1000 iterations: 0.317980
[t-SNE] Computed conditional probabilities for sample 110 / 110
[t-SNE] Mean sigma: 0.464683
Beginning preprocessing + Leiden
2024-03-16 16:52:59.228715 MEMORY 14.35643904
Affmat transformed
2024-03-16 16:52:59.230069 MEMORY 14.35643904
sources, targets, weights extracted
2024-03-16 16:52:59.230618 MEMORY 14.35643904
About to launch parallel Leiden runs
2024-03-16 16:52:59.234472 MEMORY 14.35643904
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.9s finished
Parallel Leiden runs finished
2024-03-16 16:53:01.087508 MEMORY 14.35643904
Quality: 0.25297109700466286
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 108 out of 108 | elapsed:    0.0s finished
Got subclusters: Counter({1: 34, 0: 34, 2: 28, 3: 14})
On pattern 14
[t-SNE] Computing 107 nearest neighbors...
[t-SNE] Indexed 108 samples in 0.001s...
[t-SNE] Computed neighbors for 108 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 108 / 108
[t-SNE] Mean sigma: 0.544095
[t-SNE] Computed conditional probabilities in 0.005s
[t-SNE] Iteration 50: error = 50.3745270, gradient norm = 0.5620509 (50 iterations in 0.017s)
[t-SNE] Iteration 100: error = 51.8958588, gradient norm = 0.5080857 (50 iterations in 0.018s)
[t-SNE] Iteration 150: error = 51.0688477, gradient norm = 0.4868906 (50 iterations in 0.016s)
[t-SNE] Iteration 200: error = 51.6163597, gradient norm = 0.4813097 (50 iterations in 0.017s)
[t-SNE] Iteration 250: error = 50.8537636, gradient norm = 0.5772669 (50 iterations in 0.016s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 50.853764
[t-SNE] Iteration 300: error = 0.4967181, gradient norm = 0.0245913 (50 iterations in 0.016s)
[t-SNE] Iteration 350: error = 0.3332846, gradient norm = 0.0029165 (50 iterations in 0.016s)
[t-SNE] Iteration 400: error = 0.3328983, gradient norm = 0.0004180 (50 iterations in 0.017s)
[t-SNE] Iteration 450: error = 0.3327731, gradient norm = 0.0003878 (50 iterations in 0.016s)
[t-SNE] Iteration 500: error = 0.3329375, gradient norm = 0.0005646 (50 iterations in 0.017s)
[t-SNE] Iteration 550: error = 0.3328129, gradient norm = 0.0004634 (50 iterations in 0.016s)
[t-SNE] Iteration 600: error = 0.3331561, gradient norm = 0.0002588 (50 iterations in 0.017s)
[t-SNE] Iteration 650: error = 0.3330917, gradient norm = 0.0002138 (50 iterations in 0.017s)
[t-SNE] Iteration 700: error = 0.3331335, gradient norm = 0.0002746 (50 iterations in 0.017s)
[t-SNE] Iteration 750: error = 0.3329370, gradient norm = 0.0002005 (50 iterations in 0.016s)
[t-SNE] Iteration 800: error = 0.3329253, gradient norm = 0.0001980 (50 iterations in 0.016s)
[t-SNE] Iteration 800: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 800 iterations: 0.332925
[t-SNE] Computed conditional probabilities for sample 108 / 108
[t-SNE] Mean sigma: 0.544095
Beginning preprocessing + Leiden
2024-03-16 16:53:01.501846 MEMORY 14.35643904
Affmat transformed
2024-03-16 16:53:01.503198 MEMORY 14.35643904
sources, targets, weights extracted
2024-03-16 16:53:01.503723 MEMORY 14.35643904
About to launch parallel Leiden runs
2024-03-16 16:53:01.508314 MEMORY 14.35643904
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.9s finished
Parallel Leiden runs finished
2024-03-16 16:53:03.384536 MEMORY 14.35643904
Quality: 0.2579568801511764
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 108 out of 108 | elapsed:    0.0s finished
Got subclusters: Counter({0: 35, 1: 28, 2: 21, 3: 14, 4: 10})
On pattern 15
[t-SNE] Computing 107 nearest neighbors...
[t-SNE] Indexed 108 samples in 0.001s...
[t-SNE] Computed neighbors for 108 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 108 / 108
[t-SNE] Mean sigma: 0.479296
[t-SNE] Computed conditional probabilities in 0.005s
[t-SNE] Iteration 50: error = 55.1125069, gradient norm = 0.4183865 (50 iterations in 0.018s)
[t-SNE] Iteration 100: error = 55.9679260, gradient norm = 0.5208671 (50 iterations in 0.018s)
[t-SNE] Iteration 150: error = 55.3720932, gradient norm = 0.5601133 (50 iterations in 0.017s)
[t-SNE] Iteration 200: error = 55.3489799, gradient norm = 0.5425597 (50 iterations in 0.016s)
[t-SNE] Iteration 250: error = 55.8218613, gradient norm = 0.5039704 (50 iterations in 0.018s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 55.821861
[t-SNE] Iteration 300: error = 0.9264429, gradient norm = 0.0073455 (50 iterations in 0.017s)
[t-SNE] Iteration 350: error = 0.4074262, gradient norm = 0.0138806 (50 iterations in 0.017s)
[t-SNE] Iteration 400: error = 0.3730824, gradient norm = 0.0008272 (50 iterations in 0.017s)
[t-SNE] Iteration 450: error = 0.3730586, gradient norm = 0.0003254 (50 iterations in 0.016s)
[t-SNE] Iteration 500: error = 0.3728866, gradient norm = 0.0003869 (50 iterations in 0.017s)
[t-SNE] Iteration 550: error = 0.3729672, gradient norm = 0.0003009 (50 iterations in 0.016s)
[t-SNE] Iteration 600: error = 0.3729713, gradient norm = 0.0003663 (50 iterations in 0.017s)
[t-SNE] Iteration 650: error = 0.3731779, gradient norm = 0.0003848 (50 iterations in 0.016s)
[t-SNE] Iteration 700: error = 0.3730632, gradient norm = 0.0002907 (50 iterations in 0.016s)
[t-SNE] Iteration 750: error = 0.3729732, gradient norm = 0.0002004 (50 iterations in 0.017s)
[t-SNE] Iteration 800: error = 0.3729676, gradient norm = 0.0002053 (50 iterations in 0.016s)
[t-SNE] Iteration 850: error = 0.3730649, gradient norm = 0.0002988 (50 iterations in 0.017s)
[t-SNE] Iteration 850: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 850 iterations: 0.373065
[t-SNE] Computed conditional probabilities for sample 108 / 108
[t-SNE] Mean sigma: 0.479296
Beginning preprocessing + Leiden
2024-03-16 16:53:03.839787 MEMORY 14.35643904
Affmat transformed
2024-03-16 16:53:03.841099 MEMORY 14.35643904
sources, targets, weights extracted
2024-03-16 16:53:03.841616 MEMORY 14.35643904
About to launch parallel Leiden runs
2024-03-16 16:53:03.880245 MEMORY 14.35643904
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.8s finished
Parallel Leiden runs finished
2024-03-16 16:53:05.711078 MEMORY 14.35643904
Quality: 0.22266736888571947
Quality: 0.227026730568011
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 108 out of 108 | elapsed:    0.0s finished
Got subclusters: Counter({0: 32, 1: 27, 2: 23, 3: 22, 4: 4})
On pattern 16
[t-SNE] Computing 107 nearest neighbors...
[t-SNE] Indexed 108 samples in 0.001s...
[t-SNE] Computed neighbors for 108 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 108 / 108
[t-SNE] Mean sigma: 0.508315
[t-SNE] Computed conditional probabilities in 0.005s
[t-SNE] Iteration 50: error = 54.1106606, gradient norm = 0.4863142 (50 iterations in 0.017s)
[t-SNE] Iteration 100: error = 52.9781189, gradient norm = 0.5512394 (50 iterations in 0.016s)
[t-SNE] Iteration 150: error = 54.2461967, gradient norm = 0.4965921 (50 iterations in 0.018s)
[t-SNE] Iteration 200: error = 52.8993034, gradient norm = 0.5013031 (50 iterations in 0.017s)
[t-SNE] Iteration 250: error = 52.8313560, gradient norm = 0.4971313 (50 iterations in 0.018s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 52.831356
[t-SNE] Iteration 300: error = 0.6087317, gradient norm = 0.0104189 (50 iterations in 0.018s)
[t-SNE] Iteration 350: error = 0.3557710, gradient norm = 0.0042545 (50 iterations in 0.018s)
[t-SNE] Iteration 400: error = 0.3491915, gradient norm = 0.0006713 (50 iterations in 0.018s)
[t-SNE] Iteration 450: error = 0.3494189, gradient norm = 0.0006221 (50 iterations in 0.017s)
[t-SNE] Iteration 500: error = 0.3495427, gradient norm = 0.0006228 (50 iterations in 0.017s)
[t-SNE] Iteration 550: error = 0.3496289, gradient norm = 0.0006025 (50 iterations in 0.017s)
[t-SNE] Iteration 600: error = 0.3494362, gradient norm = 0.0005382 (50 iterations in 0.016s)
[t-SNE] Iteration 650: error = 0.3495297, gradient norm = 0.0007021 (50 iterations in 0.018s)
[t-SNE] Iteration 700: error = 0.3492732, gradient norm = 0.0005887 (50 iterations in 0.018s)
[t-SNE] Iteration 750: error = 0.3494997, gradient norm = 0.0006000 (50 iterations in 0.017s)
[t-SNE] Iteration 750: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 750 iterations: 0.349500
[t-SNE] Computed conditional probabilities for sample 108 / 108
[t-SNE] Mean sigma: 0.508315
Beginning preprocessing + Leiden
2024-03-16 16:53:06.138571 MEMORY 14.35643904
Affmat transformed
2024-03-16 16:53:06.139887 MEMORY 14.35643904
sources, targets, weights extracted
2024-03-16 16:53:06.140411 MEMORY 14.35643904
About to launch parallel Leiden runs
2024-03-16 16:53:06.145223 MEMORY 14.35643904
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.6s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.8s finished
Parallel Leiden runs finished
2024-03-16 16:53:07.962211 MEMORY 14.35643904
Quality: 0.24683724956405886
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 106 out of 106 | elapsed:    0.0s finished
Got subclusters: Counter({0: 32, 1: 29, 2: 25, 3: 22})
On pattern 17
[t-SNE] Computing 105 nearest neighbors...
[t-SNE] Indexed 106 samples in 0.001s...
[t-SNE] Computed neighbors for 106 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 106 / 106
[t-SNE] Mean sigma: 0.479612
[t-SNE] Computed conditional probabilities in 0.005s
[t-SNE] Iteration 50: error = 49.6603165, gradient norm = 0.4935228 (50 iterations in 0.021s)
[t-SNE] Iteration 100: error = 49.2109299, gradient norm = 0.5607467 (50 iterations in 0.018s)
[t-SNE] Iteration 150: error = 51.4692345, gradient norm = 0.6054119 (50 iterations in 0.017s)
[t-SNE] Iteration 200: error = 54.5842972, gradient norm = 0.5632343 (50 iterations in 0.017s)
[t-SNE] Iteration 250: error = 51.2961159, gradient norm = 0.5407329 (50 iterations in 0.016s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 51.296116
[t-SNE] Iteration 300: error = 0.7490752, gradient norm = 0.0092030 (50 iterations in 0.020s)
[t-SNE] Iteration 350: error = 0.2509630, gradient norm = 0.0109757 (50 iterations in 0.017s)
[t-SNE] Iteration 400: error = 0.2356891, gradient norm = 0.0006528 (50 iterations in 0.017s)
[t-SNE] Iteration 450: error = 0.2356760, gradient norm = 0.0004007 (50 iterations in 0.018s)
[t-SNE] Iteration 500: error = 0.2359407, gradient norm = 0.0004983 (50 iterations in 0.017s)
[t-SNE] Iteration 550: error = 0.2358554, gradient norm = 0.0003706 (50 iterations in 0.018s)
[t-SNE] Iteration 600: error = 0.2358279, gradient norm = 0.0004424 (50 iterations in 0.018s)
[t-SNE] Iteration 650: error = 0.2358487, gradient norm = 0.0004130 (50 iterations in 0.017s)
[t-SNE] Iteration 700: error = 0.2355170, gradient norm = 0.0003703 (50 iterations in 0.017s)
[t-SNE] Iteration 750: error = 0.2358494, gradient norm = 0.0003651 (50 iterations in 0.017s)
[t-SNE] Iteration 800: error = 0.2357956, gradient norm = 0.0004459 (50 iterations in 0.018s)
[t-SNE] Iteration 850: error = 0.2357674, gradient norm = 0.0004315 (50 iterations in 0.018s)
[t-SNE] Iteration 900: error = 0.2358090, gradient norm = 0.0004722 (50 iterations in 0.018s)
[t-SNE] Iteration 950: error = 0.2357463, gradient norm = 0.0005381 (50 iterations in 0.018s)
[t-SNE] Iteration 1000: error = 0.2356066, gradient norm = 0.0005217 (50 iterations in 0.018s)
[t-SNE] KL divergence after 1000 iterations: 0.235607
[t-SNE] Computed conditional probabilities for sample 106 / 106
[t-SNE] Mean sigma: 0.479612
Beginning preprocessing + Leiden
2024-03-16 16:53:08.481272 MEMORY 14.35643904
Affmat transformed
2024-03-16 16:53:08.482895 MEMORY 14.35643904
sources, targets, weights extracted
2024-03-16 16:53:08.483484 MEMORY 14.35643904
About to launch parallel Leiden runs
2024-03-16 16:53:08.501311 MEMORY 14.35643904
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.6s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.8s finished
Parallel Leiden runs finished
2024-03-16 16:53:10.264965 MEMORY 14.35643904
Quality: 0.22504633294961263
Quality: 0.22633547602979665
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  98 out of  98 | elapsed:    0.0s finished
Got subclusters: Counter({0: 30, 1: 28, 2: 27, 3: 21})
On pattern 18
[t-SNE] Computing 97 nearest neighbors...
[t-SNE] Indexed 98 samples in 0.001s...
[t-SNE] Computed neighbors for 98 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 98 / 98
[t-SNE] Mean sigma: 0.493107
[t-SNE] Computed conditional probabilities in 0.004s
[t-SNE] Iteration 50: error = 52.8968124, gradient norm = 0.4698848 (50 iterations in 0.015s)
[t-SNE] Iteration 100: error = 50.6802521, gradient norm = 0.5598597 (50 iterations in 0.015s)
[t-SNE] Iteration 150: error = 50.8297920, gradient norm = 0.5513765 (50 iterations in 0.015s)
[t-SNE] Iteration 200: error = 50.4261589, gradient norm = 0.6022849 (50 iterations in 0.017s)
[t-SNE] Iteration 250: error = 53.2636642, gradient norm = 0.4426999 (50 iterations in 0.017s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 53.263664
[t-SNE] Iteration 300: error = 0.7902657, gradient norm = 0.0126353 (50 iterations in 0.017s)
[t-SNE] Iteration 350: error = 0.3361699, gradient norm = 0.0149912 (50 iterations in 0.017s)
[t-SNE] Iteration 400: error = 0.3090206, gradient norm = 0.0010550 (50 iterations in 0.018s)
[t-SNE] Iteration 450: error = 0.3080409, gradient norm = 0.0005172 (50 iterations in 0.015s)
[t-SNE] Iteration 500: error = 0.3074352, gradient norm = 0.0017438 (50 iterations in 0.017s)
[t-SNE] Iteration 550: error = 0.3071667, gradient norm = 0.0004591 (50 iterations in 0.017s)
[t-SNE] Iteration 600: error = 0.3070658, gradient norm = 0.0006029 (50 iterations in 0.017s)
[t-SNE] Iteration 650: error = 0.3070763, gradient norm = 0.0004101 (50 iterations in 0.017s)
[t-SNE] Iteration 700: error = 0.3070800, gradient norm = 0.0004521 (50 iterations in 0.016s)
[t-SNE] Iteration 750: error = 0.3070107, gradient norm = 0.0005159 (50 iterations in 0.016s)
[t-SNE] Iteration 800: error = 0.3071917, gradient norm = 0.0006054 (50 iterations in 0.017s)
[t-SNE] Iteration 850: error = 0.3071502, gradient norm = 0.0005563 (50 iterations in 0.017s)
[t-SNE] Iteration 900: error = 0.3069777, gradient norm = 0.0005995 (50 iterations in 0.017s)
[t-SNE] Iteration 950: error = 0.3072437, gradient norm = 0.0005230 (50 iterations in 0.017s)
[t-SNE] Iteration 1000: error = 0.3071019, gradient norm = 0.0003861 (50 iterations in 0.016s)
[t-SNE] KL divergence after 1000 iterations: 0.307102
[t-SNE] Computed conditional probabilities for sample 98 / 98
[t-SNE] Mean sigma: 0.493107
Beginning preprocessing + Leiden
2024-03-16 16:53:10.749239 MEMORY 14.35643904
Affmat transformed
2024-03-16 16:53:10.750432 MEMORY 14.35643904
sources, targets, weights extracted
2024-03-16 16:53:10.750917 MEMORY 14.35643904
About to launch parallel Leiden runs
2024-03-16 16:53:10.755404 MEMORY 14.35643904
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.8s finished
Parallel Leiden runs finished
2024-03-16 16:53:12.603555 MEMORY 14.35643904
Quality: 0.21747595123894614
Quality: 0.218132891237179
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  82 out of  82 | elapsed:    0.0s finished
Got subclusters: Counter({0: 27, 1: 25, 2: 23, 3: 23})
On pattern 19
[t-SNE] Computing 81 nearest neighbors...
[t-SNE] Indexed 82 samples in 0.001s...
[t-SNE] Computed neighbors for 82 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 82 / 82
[t-SNE] Mean sigma: 0.579488
[t-SNE] Computed conditional probabilities in 0.003s
[t-SNE] Iteration 50: error = 51.8895187, gradient norm = 0.5726204 (50 iterations in 0.014s)
[t-SNE] Iteration 100: error = 49.4942322, gradient norm = 0.5086448 (50 iterations in 0.013s)
[t-SNE] Iteration 150: error = 50.3420563, gradient norm = 0.4837495 (50 iterations in 0.015s)
[t-SNE] Iteration 200: error = 49.0355339, gradient norm = 0.4610137 (50 iterations in 0.013s)
[t-SNE] Iteration 250: error = 52.4173508, gradient norm = 0.4466735 (50 iterations in 0.013s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 52.417351
[t-SNE] Iteration 300: error = 0.9838802, gradient norm = 0.0032954 (50 iterations in 0.015s)
[t-SNE] Iteration 350: error = 0.8014501, gradient norm = 0.0030549 (50 iterations in 0.013s)
[t-SNE] Iteration 400: error = 0.6965247, gradient norm = 0.0017986 (50 iterations in 0.014s)
[t-SNE] Iteration 450: error = 0.6358179, gradient norm = 0.0015994 (50 iterations in 0.014s)
[t-SNE] Iteration 500: error = 0.5302498, gradient norm = 0.0012845 (50 iterations in 0.013s)
[t-SNE] Iteration 550: error = 0.4989793, gradient norm = 0.0013778 (50 iterations in 0.014s)
[t-SNE] Iteration 600: error = 0.3767558, gradient norm = 0.0124211 (50 iterations in 0.014s)
[t-SNE] Iteration 650: error = 0.1812616, gradient norm = 0.0042884 (50 iterations in 0.013s)
[t-SNE] Iteration 700: error = 0.1806112, gradient norm = 0.0007249 (50 iterations in 0.013s)
[t-SNE] Iteration 750: error = 0.1804840, gradient norm = 0.0003822 (50 iterations in 0.014s)
[t-SNE] Iteration 800: error = 0.1805446, gradient norm = 0.0006221 (50 iterations in 0.014s)
[t-SNE] Iteration 850: error = 0.1805381, gradient norm = 0.0004712 (50 iterations in 0.013s)
[t-SNE] Iteration 900: error = 0.1805314, gradient norm = 0.0005133 (50 iterations in 0.013s)
[t-SNE] Iteration 950: error = 0.1805043, gradient norm = 0.0003644 (50 iterations in 0.013s)
[t-SNE] Iteration 1000: error = 0.1805284, gradient norm = 0.0003504 (50 iterations in 0.013s)
[t-SNE] KL divergence after 1000 iterations: 0.180528
[t-SNE] Computed conditional probabilities for sample 82 / 82
[t-SNE] Mean sigma: 0.579488
Beginning preprocessing + Leiden
2024-03-16 16:53:12.980546 MEMORY 14.35643904
Affmat transformed
2024-03-16 16:53:12.981500 MEMORY 14.35643904
sources, targets, weights extracted
2024-03-16 16:53:12.981885 MEMORY 14.35643904
About to launch parallel Leiden runs
2024-03-16 16:53:13.000721 MEMORY 14.35643904
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.6s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.8s finished
Parallel Leiden runs finished
2024-03-16 16:53:14.771897 MEMORY 14.35643904
Quality: 0.2043049328872002
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  80 out of  80 | elapsed:    0.0s finished
Got subclusters: Counter({0: 25, 1: 24, 2: 19, 3: 14})
On pattern 20
[t-SNE] Computing 79 nearest neighbors...
[t-SNE] Indexed 80 samples in 0.001s...
[t-SNE] Computed neighbors for 80 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 80 / 80
[t-SNE] Mean sigma: 0.566468
[t-SNE] Computed conditional probabilities in 0.003s
[t-SNE] Iteration 50: error = 51.2394371, gradient norm = 0.4460182 (50 iterations in 0.013s)
[t-SNE] Iteration 100: error = 53.7216759, gradient norm = 0.5656258 (50 iterations in 0.013s)
[t-SNE] Iteration 150: error = 49.6438026, gradient norm = 0.5334393 (50 iterations in 0.013s)
[t-SNE] Iteration 200: error = 51.9070129, gradient norm = 0.4850811 (50 iterations in 0.014s)
[t-SNE] Iteration 250: error = 50.8755493, gradient norm = 0.4451365 (50 iterations in 0.014s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 50.875549
[t-SNE] Iteration 300: error = 0.8329690, gradient norm = 0.0039944 (50 iterations in 0.014s)
[t-SNE] Iteration 350: error = 0.6993157, gradient norm = 0.0018391 (50 iterations in 0.014s)
[t-SNE] Iteration 400: error = 0.6330126, gradient norm = 0.0018330 (50 iterations in 0.014s)
[t-SNE] Iteration 450: error = 0.5664875, gradient norm = 0.0018978 (50 iterations in 0.013s)
[t-SNE] Iteration 500: error = 0.2306507, gradient norm = 0.0189010 (50 iterations in 0.014s)
[t-SNE] Iteration 550: error = 0.2137433, gradient norm = 0.0020105 (50 iterations in 0.014s)
[t-SNE] Iteration 600: error = 0.2135471, gradient norm = 0.0003985 (50 iterations in 0.013s)
[t-SNE] Iteration 650: error = 0.2135144, gradient norm = 0.0001033 (50 iterations in 0.014s)
[t-SNE] Iteration 700: error = 0.2135224, gradient norm = 0.0000609 (50 iterations in 0.014s)
[t-SNE] Iteration 750: error = 0.2134598, gradient norm = 0.0002495 (50 iterations in 0.014s)
[t-SNE] Iteration 800: error = 0.2135357, gradient norm = 0.0000508 (50 iterations in 0.013s)
[t-SNE] Iteration 850: error = 0.2135338, gradient norm = 0.0000263 (50 iterations in 0.014s)
[t-SNE] Iteration 900: error = 0.2135228, gradient norm = 0.0000428 (50 iterations in 0.013s)
[t-SNE] Iteration 950: error = 0.2135233, gradient norm = 0.0000422 (50 iterations in 0.014s)
[t-SNE] Iteration 1000: error = 0.2135319, gradient norm = 0.0000359 (50 iterations in 0.013s)
[t-SNE] KL divergence after 1000 iterations: 0.213532
[t-SNE] Computed conditional probabilities for sample 80 / 80
[t-SNE] Mean sigma: 0.566468
Beginning preprocessing + Leiden
2024-03-16 16:53:15.140319 MEMORY 14.35643904
Affmat transformed
2024-03-16 16:53:15.141288 MEMORY 14.35643904
sources, targets, weights extracted
2024-03-16 16:53:15.141678 MEMORY 14.35643904
About to launch parallel Leiden runs
2024-03-16 16:53:15.145523 MEMORY 14.35643904
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.6s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.8s finished
Parallel Leiden runs finished
2024-03-16 16:53:16.920451 MEMORY 14.35643904
Quality: 0.16927219628811116
Quality: 0.16937263766759164
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done  20 out of  33 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=24)]: Done  33 out of  33 | elapsed:    0.0s finished
Got subclusters: Counter({0: 28, 1: 18, 2: 14, 3: 11, 4: 9})
On pattern 21
[t-SNE] Computing 32 nearest neighbors...
[t-SNE] Indexed 33 samples in 0.000s...
[t-SNE] Computed neighbors for 33 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 33 / 33
[t-SNE] Mean sigma: 11.228960
[t-SNE] Computed conditional probabilities in 0.001s
[t-SNE] Iteration 50: error = 47.4980316, gradient norm = 0.4698498 (50 iterations in 0.032s)
[t-SNE] Iteration 100: error = 43.7577744, gradient norm = 0.5248239 (50 iterations in 0.011s)
[t-SNE] Iteration 150: error = 48.9933701, gradient norm = 0.6542534 (50 iterations in 0.010s)
[t-SNE] Iteration 200: error = 42.4938316, gradient norm = 0.6226386 (50 iterations in 0.010s)
[t-SNE] Iteration 250: error = 46.2898865, gradient norm = 0.5295357 (50 iterations in 0.010s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 46.289886
[t-SNE] Iteration 300: error = 0.6675938, gradient norm = 0.0010074 (50 iterations in 0.010s)
[t-SNE] Iteration 350: error = 0.5517346, gradient norm = 0.0003396 (50 iterations in 0.010s)
[t-SNE] Iteration 400: error = 0.5292349, gradient norm = 0.0001440 (50 iterations in 0.010s)
[t-SNE] Iteration 450: error = 0.5216024, gradient norm = 0.0000671 (50 iterations in 0.012s)
[t-SNE] Iteration 500: error = 0.5197779, gradient norm = 0.0000527 (50 iterations in 0.010s)
[t-SNE] Iteration 550: error = 0.5186785, gradient norm = 0.0000185 (50 iterations in 0.010s)
[t-SNE] Iteration 600: error = 0.5186218, gradient norm = 0.0000178 (50 iterations in 0.010s)
[t-SNE] Iteration 650: error = 0.5183988, gradient norm = 0.0000184 (50 iterations in 0.010s)
[t-SNE] Iteration 700: error = 0.5184348, gradient norm = 0.0000184 (50 iterations in 0.009s)
[t-SNE] Iteration 750: error = 0.5182609, gradient norm = 0.0000192 (50 iterations in 0.009s)
[t-SNE] Iteration 800: error = 0.5186702, gradient norm = 0.0000340 (50 iterations in 0.010s)
[t-SNE] Iteration 850: error = 0.5184960, gradient norm = 0.0000216 (50 iterations in 0.009s)
[t-SNE] Iteration 900: error = 0.5187211, gradient norm = 0.0000187 (50 iterations in 0.009s)
[t-SNE] Iteration 950: error = 0.5187817, gradient norm = 0.0000211 (50 iterations in 0.009s)
[t-SNE] Iteration 1000: error = 0.5187410, gradient norm = 0.0000198 (50 iterations in 0.009s)
[t-SNE] KL divergence after 1000 iterations: 0.518741
[t-SNE] Computed conditional probabilities for sample 33 / 33
[t-SNE] Mean sigma: 1125899906842624.000000
Beginning preprocessing + Leiden
2024-03-16 16:53:17.175742 MEMORY 14.35643904
Affmat transformed
2024-03-16 16:53:17.176445 MEMORY 14.35643904
sources, targets, weights extracted
2024-03-16 16:53:17.176743 MEMORY 14.35643904
About to launch parallel Leiden runs
2024-03-16 16:53:17.180391 MEMORY 14.35643904
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.6s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.7s finished
Parallel Leiden runs finished
2024-03-16 16:53:18.891392 MEMORY 14.35643904
Quality: -7.105427357600852e-15
Got subclusters: Counter({0: 33})
On metacluster 3
Metacluster size 5519
Relevant tasks:  ('testis',)
Relevant signs:  (-1,)
TfModiscoSeqletsToPatternsFactory: seed=1234
(Round 1) num seqlets: 5519
(Round 1) Computing coarse affmat
2024-03-16 16:53:20.500370 MEMORY 14.355914752
Beginning embedding computation
MEMORY 14.355914752
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 152 tasks      | elapsed:    2.0s
[Parallel(n_jobs=24)]: Done 402 tasks      | elapsed:    4.7s
[Parallel(n_jobs=24)]: Done 752 tasks      | elapsed:    8.6s
[Parallel(n_jobs=24)]: Done 1202 tasks      | elapsed:   13.5s
[Parallel(n_jobs=24)]: Done 1752 tasks      | elapsed:   19.4s
[Parallel(n_jobs=24)]: Done 2402 tasks      | elapsed:   26.5s
[Parallel(n_jobs=24)]: Done 3152 tasks      | elapsed:   34.7s
[Parallel(n_jobs=24)]: Done 4002 tasks      | elapsed:   44.2s
[Parallel(n_jobs=24)]: Done 4952 tasks      | elapsed:   54.6s
[Parallel(n_jobs=24)]: Done 5519 out of 5519 | elapsed:  1.0min finished
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 152 tasks      | elapsed:    1.9s
[Parallel(n_jobs=24)]: Done 402 tasks      | elapsed:    4.7s
[Parallel(n_jobs=24)]: Done 752 tasks      | elapsed:    8.6s
[Parallel(n_jobs=24)]: Done 1202 tasks      | elapsed:   13.6s
[Parallel(n_jobs=24)]: Done 1752 tasks      | elapsed:   19.6s
[Parallel(n_jobs=24)]: Done 2402 tasks      | elapsed:   26.7s
[Parallel(n_jobs=24)]: Done 3152 tasks      | elapsed:   35.0s
[Parallel(n_jobs=24)]: Done 4002 tasks      | elapsed:   44.1s
[Parallel(n_jobs=24)]: Done 4952 tasks      | elapsed:   54.6s
[Parallel(n_jobs=24)]: Done 5519 out of 5519 | elapsed:  1.0min finished
At the beginning of embedding call
2024-03-16 16:53:20.500594 MEMORY 14.355914752
before computing embeddings fwd
2024-03-16 16:53:20.509129 MEMORY 14.355914752
after computing embeddings fwd
2024-03-16 16:54:21.493046 MEMORY 14.355914752
after computing embeddings rev
2024-03-16 16:55:22.253625 MEMORY 14.49658368
before computing sparse embeddings fwd
2024-03-16 16:55:22.253722 MEMORY 14.49658368
Constructing csr matrix...
csr matrix made in 0.6834726333618164 s
after computing sparse embeddings fwd
2024-03-16 16:55:23.163065 MEMORY 14.588526592
before computing sparse embeddings rev
2024-03-16 16:55:23.163686 MEMORY 14.588592128
Constructing csr matrix...
csr matrix made in 0.6428403854370117 s
after computing sparse embeddings rev
2024-03-16 16:55:24.089112 MEMORY 14.621745152
Finished embedding computation in 124.82 s
MEMORY 14.481760256
Starting affinity matrix computations
MEMORY 14.481760256
Batching in slices of size 5519
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:05<00:00,  5.10s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:05<00:00,  5.10s/it]
Finished affinity matrix computations in 5.13 s
MEMORY 14.482485248
(Round 1) Computed coarse affmat
2024-03-16 16:55:31.409025 MEMORY 14.322982912
(Round 1) Computing affinity matrix on nearest neighbors
2024-03-16 16:55:31.409150 MEMORY 14.322982912
Launching nearest neighbors affmat calculation job
MEMORY 14.322982912
Parallel runs completed
MEMORY 14.348394496
Job completed in: 17.11 s
MEMORY 14.346100736
Launching nearest neighbors affmat calculation job
MEMORY 14.345904128
Parallel runs completed
MEMORY 14.411321344
Job completed in: 17.04 s
MEMORY 14.4111616
(Round 1) Computed affinity matrix on nearest neighbors in 35.79 s
2024-03-16 16:56:07.200502 MEMORY 14.408957952
Filtered down to 5345 of 5519
(Round 1) Retained 5345 rows out of 5519 after filtering
2024-03-16 16:56:09.934737 MEMORY 14.408957952
(Round 1) Computing density adapted affmat
2024-03-16 16:56:11.842395 MEMORY 14.408957952
Symmetrizing nearest neighbors
Computing betas for density adaptation
Computing normalizing denominators
(Round 1) Computing clustering
2024-03-16 16:56:55.389348 MEMORY 14.515441664
Beginning preprocessing + Leiden
2024-03-16 16:56:55.396811 MEMORY 14.515441664
Affmat transformed
2024-03-16 16:56:55.396936 MEMORY 14.515441664
sources, targets, weights extracted
2024-03-16 16:56:55.585255 MEMORY 14.5452032
About to launch parallel Leiden runs
2024-03-16 16:56:55.632664 MEMORY 14.5452032
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:   15.9s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:  1.1min finished
Parallel Leiden runs finished
2024-03-16 16:58:02.791297 MEMORY 14.5452032
Quality: 0.46146511316744243
Quality: 0.46163592159185324
Quality: 0.46163866317791635
Quality: 0.4616463514870306
Quality: 0.46164991957504525
Quality: 0.4616499291715954
Got 4 clusters after round 1
Counts:
{0: 1588, 3: 1037, 1: 1394, 2: 1326}
2024-03-16 16:58:02.809322 MEMORY 14.410981376
(Round 1) Aggregating seqlets in each cluster
2024-03-16 16:58:02.809416 MEMORY 14.410981376
Aggregating for cluster 0 with 1588 seqlets
2024-03-16 16:58:02.814649 MEMORY 14.410981376
Skipped 5 due to duplicates
Trimming eliminated 0 seqlets out of 1583
Aggregating for cluster 1 with 1394 seqlets
2024-03-16 16:58:07.429922 MEMORY 14.410981376
Skipped 2 due to duplicates
Trimming eliminated 0 seqlets out of 1392
Aggregating for cluster 2 with 1326 seqlets
2024-03-16 16:58:10.235272 MEMORY 14.410981376
Skipped 3 due to duplicates
Trimming eliminated 0 seqlets out of 1323
Aggregating for cluster 3 with 1037 seqlets
2024-03-16 16:58:12.855879 MEMORY 14.410981376
Trimming eliminated 0 seqlets out of 1037
(Round 2) num seqlets: 5335
(Round 2) Computing coarse affmat
2024-03-16 16:58:15.751733 MEMORY 14.410981376
Beginning embedding computation
MEMORY 14.410981376
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 320 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done 1320 tasks      | elapsed:    2.0s
[Parallel(n_jobs=24)]: Done 2720 tasks      | elapsed:    4.0s
[Parallel(n_jobs=24)]: Done 4520 tasks      | elapsed:    6.3s
[Parallel(n_jobs=24)]: Done 5335 out of 5335 | elapsed:    7.5s finished
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 256 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done 1224 tasks      | elapsed:    2.0s
[Parallel(n_jobs=24)]: Done 2624 tasks      | elapsed:    4.0s
[Parallel(n_jobs=24)]: Done 4424 tasks      | elapsed:    6.5s
[Parallel(n_jobs=24)]: Done 5335 out of 5335 | elapsed:    7.8s finished
At the beginning of embedding call
2024-03-16 16:58:15.751943 MEMORY 14.410981376
before computing embeddings fwd
2024-03-16 16:58:15.760222 MEMORY 14.410981376
after computing embeddings fwd
2024-03-16 16:58:23.221388 MEMORY 14.49209856
after computing embeddings rev
2024-03-16 16:58:31.071905 MEMORY 14.692466688
before computing sparse embeddings fwd
2024-03-16 16:58:31.071994 MEMORY 14.692466688
Constructing csr matrix...
csr matrix made in 0.6202936172485352 s
after computing sparse embeddings fwd
2024-03-16 16:58:31.941051 MEMORY 14.872383488
before computing sparse embeddings rev
2024-03-16 16:58:31.941133 MEMORY 14.872383488
Constructing csr matrix...
csr matrix made in 0.5901789665222168 s
after computing sparse embeddings rev
2024-03-16 16:58:32.704298 MEMORY 14.91505152
Finished embedding computation in 18.28 s
MEMORY 14.73497088
Starting affinity matrix computations
MEMORY 14.73497088
Batching in slices of size 5335
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:05<00:00,  5.23s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:05<00:00,  5.23s/it]
Finished affinity matrix computations in 5.26 s
MEMORY 14.73497088
(Round 2) Computed coarse affmat
2024-03-16 16:58:40.242776 MEMORY 14.512513024
(Round 2) Computing affinity matrix on nearest neighbors
2024-03-16 16:58:40.242919 MEMORY 14.512513024
Launching nearest neighbors affmat calculation job
MEMORY 14.512513024
Parallel runs completed
MEMORY 14.53170688
Job completed in: 8.7 s
MEMORY 14.53129728
Launching nearest neighbors affmat calculation job
MEMORY 14.528954368
Parallel runs completed
MEMORY 14.53430784
Job completed in: 8.71 s
MEMORY 14.532087808
(Round 2) Computed affinity matrix on nearest neighbors in 19.07 s
2024-03-16 16:58:59.317470 MEMORY 14.529744896
Not applying filtering for rounds above first round
2024-03-16 16:58:59.318212 MEMORY 14.529744896
(Round 2) Computing density adapted affmat
2024-03-16 16:59:01.417022 MEMORY 14.53361152
Symmetrizing nearest neighbors
Computing betas for density adaptation
Computing normalizing denominators
(Round 2) Computing clustering
2024-03-16 16:59:43.254147 MEMORY 14.75794944
Beginning preprocessing + Leiden
2024-03-16 16:59:43.261622 MEMORY 14.75794944
Affmat transformed
2024-03-16 16:59:43.261747 MEMORY 14.75794944
sources, targets, weights extracted
2024-03-16 16:59:43.447453 MEMORY 14.78774784
About to launch parallel Leiden runs
2024-03-16 16:59:43.495162 MEMORY 14.713376768
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:   13.8s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   46.4s finished
Parallel Leiden runs finished
2024-03-16 17:00:29.882807 MEMORY 14.713376768
Quality: 0.5266815396853427
Got 4 clusters after round 2
Counts:
{0: 1625, 2: 1179, 3: 1079, 1: 1452}
2024-03-16 17:00:29.900144 MEMORY 14.638874624
(Round 2) Aggregating seqlets in each cluster
2024-03-16 17:00:29.900240 MEMORY 14.638874624
Aggregating for cluster 0 with 1625 seqlets
2024-03-16 17:00:29.903792 MEMORY 14.638874624
Skipped 1 due to duplicates
Trimming eliminated 0 seqlets out of 1624
Aggregating for cluster 1 with 1452 seqlets
2024-03-16 17:00:33.465580 MEMORY 14.638088192
Skipped 3 due to duplicates
Trimming eliminated 0 seqlets out of 1449
Aggregating for cluster 2 with 1179 seqlets
2024-03-16 17:00:35.580096 MEMORY 14.638088192
Trimming eliminated 0 seqlets out of 1179
Aggregating for cluster 3 with 1079 seqlets
2024-03-16 17:00:37.228290 MEMORY 14.638088192
Trimming eliminated 0 seqlets out of 1079
Got 4 clusters
Splitting into subclusters...
2024-03-16 17:00:38.776766 MEMORY 14.638088192
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 1624 out of 1624 | elapsed:    0.6s finished
Inspecting pattern 0 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 1624
[t-SNE] Computed conditional probabilities for sample 1624 / 1624
[t-SNE] Mean sigma: 0.268806
Beginning preprocessing + Leiden
2024-03-16 17:00:41.119454 MEMORY 14.655684608
Affmat transformed
2024-03-16 17:00:41.137773 MEMORY 14.656724992
sources, targets, weights extracted
2024-03-16 17:00:41.151898 MEMORY 14.656724992
About to launch parallel Leiden runs
2024-03-16 17:00:41.160668 MEMORY 14.65686016
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    4.8s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   15.2s finished
Parallel Leiden runs finished
2024-03-16 17:00:56.370841 MEMORY 14.65686016
Quality: 0.5161186919782582
Quality: 0.5162256352319217
Quality: 0.5163818770342322
Got subclusters: Counter({0: 418, 1: 246, 2: 225, 3: 195, 4: 190, 5: 119, 6: 87, 7: 74, 8: 70})
On merging iteration 1
Numbers for each pattern pre-subsample: [418, 246, 225, 195, 190, 119, 87, 74, 70]
Numbers after subsampling: [300, 246, 225, 195, 190, 119, 87, 74, 70]
Computing sims for pattern 0
Computed sims for pattern 0 in 2.210839033126831 s
Computing sims for pattern 1
Computed sims for pattern 1 in 1.7037169933319092 s
Computing sims for pattern 2
Computed sims for pattern 2 in 2.018974781036377 s
Computing sims for pattern 3
Computed sims for pattern 3 in 1.7121233940124512 s
Computing sims for pattern 4
Computed sims for pattern 4 in 1.7084593772888184 s
Computing sims for pattern 5
Computed sims for pattern 5 in 1.065251111984253 s
Computing sims for pattern 6
Computed sims for pattern 6 in 0.8072378635406494 s
Computing sims for pattern 7
Computed sims for pattern 7 in 0.693082332611084 s
Computing sims for pattern 8
Computed sims for pattern 8 in 0.6646289825439453 s
Cluster sizes
[418 246 225 195 190 119  87  74  70]
Cross-contamination matrix:
[[1.   0.58 0.15 0.47 0.25 0.59 0.21 0.47 0.3 ]
 [0.89 1.   0.34 0.76 0.35 0.65 0.39 0.72 0.35]
 [0.79 0.78 1.   0.85 0.3  0.66 0.62 0.92 0.59]
 [0.75 0.74 0.31 1.   0.23 0.57 0.31 0.69 0.21]
 [0.94 0.77 0.32 0.67 1.   0.67 0.36 0.65 0.5 ]
 [1.   0.86 0.53 0.82 0.55 1.   0.57 0.79 0.64]
 [0.87 0.83 0.6  0.81 0.35 0.69 1.   0.77 0.47]
 [0.8  0.75 0.41 0.76 0.26 0.57 0.34 1.   0.32]
 [0.94 0.69 0.51 0.57 0.43 0.73 0.41 0.66 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.93 0.79 0.89 0.81 0.96 0.87 0.9  0.87]
 [0.93 1.   0.86 0.94 0.78 0.92 0.9  0.95 0.76]
 [0.79 0.86 1.   0.85 0.64 0.8  0.9  0.92 0.82]
 [0.89 0.94 0.85 1.   0.78 0.89 0.88 0.92 0.74]
 [0.81 0.78 0.64 0.78 1.   0.76 0.64 0.77 0.69]
 [0.96 0.92 0.8  0.89 0.76 1.   0.87 0.89 0.84]
 [0.87 0.9  0.9  0.88 0.64 0.87 1.   0.92 0.79]
 [0.9  0.95 0.92 0.92 0.77 0.89 0.92 1.   0.81]
 [0.87 0.76 0.82 0.74 0.69 0.84 0.79 0.81 1.  ]]
Collapsing 0 & 5 with crosscontam 0.5940424239028943 and sim 0.959998475347669
Collapsing 1 & 7 with crosscontam 0.717491965638394 and sim 0.9530977113735161
Collapsing 1 & 3 with crosscontam 0.7370969928745459 and sim 0.9409411096773369
Collapsing 0 & 1 with crosscontam 0.5753892110809997 and sim 0.9259126726375991
Collapsing 2 & 7 with crosscontam 0.4121397218986702 and sim 0.9248839400585712
Collapsing 3 & 7 with crosscontam 0.6933237762113502 and sim 0.9244899656076943
Collapsing 6 & 7 with crosscontam 0.3436412407974836 and sim 0.9233775223226848
Collapsing 1 & 5 with crosscontam 0.6489398975510525 and sim 0.919352902910005
Collapsing 1 & 6 with crosscontam 0.3891050191417076 and sim 0.9036797395256747
Collapsing 2 & 6 with crosscontam 0.6012840910030446 and sim 0.9028692730126938
Collapsing 0 & 7 with crosscontam 0.46680444644644625 and sim 0.901193641786996
Collapsing 5 & 7 with crosscontam 0.5714007830838495 and sim 0.894035970445902
Collapsing 3 & 5 with crosscontam 0.5670141789988639 and sim 0.8915921344861438
Collapsing 5 & 6 with crosscontam 0.5664392676804131 and sim 0.8660023677526913
Trimming eliminated 0 seqlets out of 537
Trimming eliminated 0 seqlets out of 320
Trimming eliminated 0 seqlets out of 515
Trimming eliminated 0 seqlets out of 1052
Trimming eliminated 0 seqlets out of 1277
Trimming eliminated 0 seqlets out of 1364
Unmerged patterns remapping: OrderedDict([(4, 1), (8, 2)])
Time spent on merging iteration: 6.873132944107056
On merging iteration 2
Numbers for each pattern pre-subsample: [1364, 190, 70]
Numbers after subsampling: [300, 190, 70]
Computing sims for pattern 0
Computed sims for pattern 0 in 0.5952873229980469 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.2531595230102539 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.10421514511108398 s
Cluster sizes
[1364  190   70]
Cross-contamination matrix:
[[1.   0.59 0.69]
 [0.67 1.   0.5 ]
 [0.69 0.43 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.8  0.85]
 [0.8  1.   0.69]
 [0.85 0.69 1.  ]]
Collapsing 0 & 2 with crosscontam 0.6906239067055395 and sim 0.853350441984006
Trimming eliminated 0 seqlets out of 1434
Unmerged patterns remapping: OrderedDict([(1, 1)])
Time spent on merging iteration: 1.5994980335235596
On merging iteration 3
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 1290 tasks      | elapsed:    0.6s
[Parallel(n_jobs=24)]: Done 1449 out of 1449 | elapsed:    0.8s finished
Numbers for each pattern pre-subsample: [1434, 190]
Numbers after subsampling: [300, 190]
Computing sims for pattern 0
Computed sims for pattern 0 in 0.31313657760620117 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.24007439613342285 s
Cluster sizes
[1434  190]
Cross-contamination matrix:
[[1.   0.59]
 [0.68 1.  ]]
Pattern-to-pattern sim matrix:
[[1.  0.8]
 [0.8 1. ]]
Inspecting pattern 1 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 1449
[t-SNE] Computed conditional probabilities for sample 1449 / 1449
[t-SNE] Mean sigma: 0.313897
Beginning preprocessing + Leiden
2024-03-16 17:01:20.842256 MEMORY 14.656892928
Affmat transformed
2024-03-16 17:01:20.860909 MEMORY 14.656892928
sources, targets, weights extracted
2024-03-16 17:01:20.871910 MEMORY 14.656892928
About to launch parallel Leiden runs
2024-03-16 17:01:20.880017 MEMORY 14.656892928
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    3.8s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   11.9s finished
Parallel Leiden runs finished
2024-03-16 17:01:32.815385 MEMORY 14.656892928
Quality: 0.49915577200167505
Quality: 0.4996862356644716
Quality: 0.5004448235966333
Quality: 0.5020708833378518
Quality: 0.5022729846439459
Quality: 0.5029881585235411
Quality: 0.5042253136567494
Got subclusters: Counter({0: 230, 1: 226, 2: 219, 3: 212, 4: 208, 5: 143, 6: 136, 7: 75})
On merging iteration 1
Numbers for each pattern pre-subsample: [230, 226, 219, 212, 208, 143, 136, 75]
Numbers after subsampling: [230, 226, 219, 212, 208, 143, 136, 75]
Computing sims for pattern 0
Computed sims for pattern 0 in 1.8707051277160645 s
Computing sims for pattern 1
Computed sims for pattern 1 in 1.838172435760498 s
Computing sims for pattern 2
Computed sims for pattern 2 in 1.781364917755127 s
Computing sims for pattern 3
Computed sims for pattern 3 in 1.6810014247894287 s
Computing sims for pattern 4
Computed sims for pattern 4 in 2.862715482711792 s
Computing sims for pattern 5
Computed sims for pattern 5 in 1.1965696811676025 s
Computing sims for pattern 6
Computed sims for pattern 6 in 1.1331164836883545 s
Computing sims for pattern 7
Computed sims for pattern 7 in 0.6753168106079102 s
Cluster sizes
[230 226 219 212 208 143 136  75]
Cross-contamination matrix:
[[1.   0.31 0.76 0.52 0.64 0.56 0.69 0.7 ]
 [0.43 1.   0.81 0.54 0.56 0.74 0.74 0.47]
 [0.51 0.43 1.   0.35 0.54 0.62 0.58 0.51]
 [0.76 0.64 0.8  1.   0.62 0.82 0.76 0.85]
 [0.59 0.4  0.76 0.38 1.   0.61 0.17 0.51]
 [0.42 0.47 0.73 0.45 0.5  1.   0.46 0.77]
 [0.68 0.61 0.83 0.54 0.44 0.61 1.   0.6 ]
 [0.42 0.06 0.49 0.35 0.31 0.64 0.34 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.61 0.79 0.83 0.85 0.69 0.8  0.77]
 [0.61 1.   0.85 0.79 0.74 0.82 0.89 0.64]
 [0.79 0.85 1.   0.75 0.86 0.85 0.88 0.73]
 [0.83 0.79 0.75 1.   0.71 0.79 0.8  0.82]
 [0.85 0.74 0.86 0.71 1.   0.85 0.69 0.78]
 [0.69 0.82 0.85 0.79 0.85 1.   0.81 0.81]
 [0.8  0.89 0.88 0.8  0.69 0.81 1.   0.69]
 [0.77 0.64 0.73 0.82 0.78 0.81 0.69 1.  ]]
Collapsing 1 & 6 with crosscontam 0.6107385487572254 and sim 0.8850644261166998
Collapsing 2 & 6 with crosscontam 0.5750832766279241 and sim 0.8782133824936122
Collapsing 2 & 4 with crosscontam 0.5406117037620288 and sim 0.8582189213601323
Aborting collapse as 4 & 6 have cross-contam 0.30872868133872544 and sim 0.6901534491670667
Collapsing 2 & 5 with crosscontam 0.6179049013475271 and sim 0.8508716312102359
Trimming eliminated 0 seqlets out of 362
Trimming eliminated 0 seqlets out of 581
Trimming eliminated 0 seqlets out of 724
Unmerged patterns remapping: OrderedDict([(0, 1), (3, 2), (4, 3), (7, 4)])
Time spent on merging iteration: 2.7669143676757812
On merging iteration 2
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 1179 out of 1179 | elapsed:    0.4s finished
Numbers for each pattern pre-subsample: [724, 230, 212, 208, 75]
Numbers after subsampling: [300, 230, 212, 208, 75]
Computing sims for pattern 0
Computed sims for pattern 0 in 1.2371129989624023 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.30607104301452637 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.28066158294677734 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.2657797336578369 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.10957026481628418 s
Cluster sizes
[724 230 212 208  75]
Cross-contamination matrix:
[[1.   0.76 0.7  0.83 0.78]
 [0.49 1.   0.52 0.64 0.7 ]
 [0.65 0.76 1.   0.62 0.85]
 [0.5  0.59 0.38 1.   0.51]
 [0.27 0.42 0.35 0.31 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.73 0.78 0.81 0.66]
 [0.73 1.   0.83 0.85 0.77]
 [0.78 0.83 1.   0.71 0.82]
 [0.81 0.85 0.71 1.   0.78]
 [0.66 0.77 0.82 0.78 1.  ]]
Inspecting pattern 2 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 1179
[t-SNE] Computed conditional probabilities for sample 1179 / 1179
[t-SNE] Mean sigma: 0.316331
Beginning preprocessing + Leiden
2024-03-16 17:01:52.085220 MEMORY 14.656892928
Affmat transformed
2024-03-16 17:01:52.100902 MEMORY 14.656892928
sources, targets, weights extracted
2024-03-16 17:01:52.109364 MEMORY 14.656892928
About to launch parallel Leiden runs
2024-03-16 17:01:52.116351 MEMORY 14.656892928
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    3.2s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    9.6s finished
Parallel Leiden runs finished
2024-03-16 17:02:01.680613 MEMORY 14.656892928
Quality: 0.4673558067855536
Quality: 0.46766102520999764
Quality: 0.46944913043223074
Quality: 0.46953470831830224
Quality: 0.46976005631148826
Quality: 0.4701948634920031
Got subclusters: Counter({0: 193, 1: 171, 2: 151, 3: 145, 4: 138, 5: 134, 6: 123, 7: 82, 8: 32, 9: 10})
On merging iteration 1
Numbers for each pattern pre-subsample: [193, 171, 151, 145, 138, 134, 123, 82, 32, 10]
Numbers after subsampling: [193, 171, 151, 145, 138, 134, 123, 82, 32, 10]
Computing sims for pattern 0
Computed sims for pattern 0 in 1.7858495712280273 s
Computing sims for pattern 1
Computed sims for pattern 1 in 1.5004844665527344 s
Computing sims for pattern 2
Computed sims for pattern 2 in 1.265974760055542 s
Computing sims for pattern 3
Computed sims for pattern 3 in 1.1644303798675537 s
Computing sims for pattern 4
Computed sims for pattern 4 in 1.2836575508117676 s
Computing sims for pattern 5
Computed sims for pattern 5 in 1.2741978168487549 s
Computing sims for pattern 6
Computed sims for pattern 6 in 1.1532495021820068 s
Computing sims for pattern 7
Computed sims for pattern 7 in 0.7911102771759033 s
Computing sims for pattern 8
Computed sims for pattern 8 in 0.37676262855529785 s
Computing sims for pattern 9
Computed sims for pattern 9 in 0.17784786224365234 s
Cluster sizes
[193 171 151 145 138 134 123  82  32  10]
Cross-contamination matrix:
[[1.   0.45 0.62 0.69 0.53 0.56 0.5  0.61 0.52 0.68]
 [0.61 1.   0.65 0.79 0.73 0.71 0.61 0.76 0.85 0.78]
 [0.42 0.31 1.   0.65 0.31 0.38 0.37 0.6  0.59 0.35]
 [0.57 0.5  0.75 1.   0.42 0.63 0.43 0.77 0.73 0.53]
 [0.6  0.62 0.53 0.58 1.   0.61 0.51 0.55 0.74 0.41]
 [0.58 0.55 0.6  0.79 0.56 1.   0.55 0.7  0.68 0.61]
 [0.57 0.51 0.63 0.6  0.52 0.6  1.   0.59 0.5  0.45]
 [0.41 0.39 0.58 0.65 0.32 0.45 0.33 1.   0.61 0.21]
 [0.44 0.54 0.64 0.67 0.54 0.53 0.39 0.67 1.   0.47]
 [0.06 0.09 0.07 0.11 0.03 0.11 0.03 0.02 0.06 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.8  0.85 0.87 0.78 0.84 0.85 0.89 0.81 0.66]
 [0.8  1.   0.83 0.88 0.86 0.84 0.84 0.89 0.9  0.64]
 [0.85 0.83 1.   0.92 0.75 0.89 0.89 0.93 0.87 0.64]
 [0.87 0.88 0.92 1.   0.78 0.91 0.88 0.97 0.88 0.71]
 [0.78 0.86 0.75 0.78 1.   0.79 0.8  0.81 0.85 0.61]
 [0.84 0.84 0.89 0.91 0.79 1.   0.87 0.91 0.84 0.67]
 [0.85 0.84 0.89 0.88 0.8  0.87 1.   0.89 0.82 0.56]
 [0.89 0.89 0.93 0.97 0.81 0.91 0.89 1.   0.89 0.69]
 [0.81 0.9  0.87 0.88 0.85 0.84 0.82 0.89 1.   0.62]
 [0.66 0.64 0.64 0.71 0.61 0.67 0.56 0.69 0.62 1.  ]]
Collapsing 3 & 7 with crosscontam 0.64695616020141 and sim 0.9717567863822391
Collapsing 2 & 7 with crosscontam 0.5845738921162353 and sim 0.9325372104971892
Collapsing 2 & 3 with crosscontam 0.6526496601316718 and sim 0.9221305899474429
Collapsing 3 & 5 with crosscontam 0.6336303949113344 and sim 0.9141418333137565
Collapsing 5 & 7 with crosscontam 0.4491252368329133 and sim 0.9135383168511851
Collapsing 1 & 8 with crosscontam 0.5443693462171053 and sim 0.8954155638240975
Collapsing 7 & 8 with crosscontam 0.60823442782316 and sim 0.8939732876264563
Collapsing 3 & 8 with crosscontam 0.6720248518318965 and sim 0.8772471600950913
Collapsing 0 & 3 with crosscontam 0.5666265259735499 and sim 0.8733978362878824
Collapsing 5 & 6 with crosscontam 0.5486595758121844 and sim 0.8673814193660953
Collapsing 2 & 8 with crosscontam 0.5859866289122326 and sim 0.8660791191137011
Collapsing 1 & 4 with crosscontam 0.615910618237399 and sim 0.8638735986294375
Collapsing 0 & 6 with crosscontam 0.5025651028683884 and sim 0.8513002203335773
Collapsing 4 & 8 with crosscontam 0.5448882614356885 and sim 0.8504524046116988
Trimming eliminated 0 seqlets out of 227
Trimming eliminated 0 seqlets out of 378
Trimming eliminated 0 seqlets out of 512
Trimming eliminated 0 seqlets out of 203
Trimming eliminated 0 seqlets out of 715
Trimming eliminated 0 seqlets out of 908
Trimming eliminated 0 seqlets out of 1031
Trimming eliminated 0 seqlets out of 1169
Unmerged patterns remapping: OrderedDict([(9, 1)])
Time spent on merging iteration: 8.230811357498169
On merging iteration 2
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 930 tasks      | elapsed:    0.5s
[Parallel(n_jobs=24)]: Done 1079 out of 1079 | elapsed:    0.6s finished
Numbers for each pattern pre-subsample: [1169, 10]
Numbers after subsampling: [300, 10]
Computing sims for pattern 0
Computed sims for pattern 0 in 0.2288661003112793 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.03533792495727539 s
Cluster sizes
[1169   10]
Cross-contamination matrix:
[[1.   0.95]
 [0.09 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.68]
 [0.68 1.  ]]
Inspecting pattern 3 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 1079
[t-SNE] Computed conditional probabilities for sample 1079 / 1079
[t-SNE] Mean sigma: 0.279515
Beginning preprocessing + Leiden
2024-03-16 17:02:22.810345 MEMORY 14.656892928
Affmat transformed
2024-03-16 17:02:22.823453 MEMORY 14.656892928
sources, targets, weights extracted
2024-03-16 17:02:22.832099 MEMORY 14.656892928
About to launch parallel Leiden runs
2024-03-16 17:02:22.839052 MEMORY 14.656892928
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    2.9s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    9.0s finished
Parallel Leiden runs finished
2024-03-16 17:02:31.822916 MEMORY 14.656892928
Quality: 0.4566312081855884
Quality: 0.4567273000444954
Quality: 0.45716058243155855
Quality: 0.45733504134983
Got subclusters: Counter({0: 285, 1: 201, 2: 196, 3: 128, 4: 113, 5: 86, 6: 58, 8: 6, 7: 6})
On merging iteration 1
Numbers for each pattern pre-subsample: [285, 201, 196, 128, 113, 86, 58, 6, 6]
Numbers after subsampling: [285, 201, 196, 128, 113, 86, 58, 6, 6]
Computing sims for pattern 0
Computed sims for pattern 0 in 2.02079439163208 s
Computing sims for pattern 1
Computed sims for pattern 1 in 1.574021339416504 s
Computing sims for pattern 2
Computed sims for pattern 2 in 1.5480163097381592 s
Computing sims for pattern 3
Computed sims for pattern 3 in 1.019578218460083 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.8731296062469482 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.7251958847045898 s
Computing sims for pattern 6
Computed sims for pattern 6 in 0.494992733001709 s
Computing sims for pattern 7
Computed sims for pattern 7 in 0.13001275062561035 s
Computing sims for pattern 8
Computed sims for pattern 8 in 0.12709474563598633 s
Cluster sizes
[285 201 196 128 113  86  58   6   6]
Cross-contamination matrix:
[[1.   0.63 0.65 0.88 0.44 0.76 0.8  0.34 0.27]
 [0.68 1.   0.83 0.85 0.53 0.88 0.94 0.22 0.24]
 [0.58 0.71 1.   0.73 0.62 0.78 0.72 0.28 0.23]
 [0.72 0.63 0.65 1.   0.49 0.68 0.87 0.15 0.23]
 [0.49 0.46 0.76 0.71 1.   0.54 0.57 0.26 0.24]
 [0.65 0.72 0.76 0.74 0.42 1.   0.8  0.1  0.18]
 [0.46 0.59 0.51 0.75 0.33 0.58 1.   0.11 0.18]
 [0.18 0.07 0.18 0.08 0.07 0.08 0.07 1.   0.07]
 [0.18 0.19 0.19 0.24 0.12 0.25 0.23 0.13 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.9  0.9  0.94 0.84 0.92 0.9  0.74 0.75]
 [0.9  1.   0.95 0.96 0.87 0.96 0.97 0.64 0.71]
 [0.9  0.95 1.   0.94 0.91 0.95 0.94 0.71 0.75]
 [0.94 0.96 0.94 1.   0.91 0.95 0.97 0.64 0.72]
 [0.84 0.87 0.91 0.91 1.   0.89 0.91 0.58 0.68]
 [0.92 0.96 0.95 0.95 0.89 1.   0.96 0.65 0.78]
 [0.9  0.97 0.94 0.97 0.91 0.96 1.   0.62 0.73]
 [0.74 0.64 0.71 0.64 0.58 0.65 0.62 1.   0.69]
 [0.75 0.71 0.75 0.72 0.68 0.78 0.73 0.69 1.  ]]
Collapsing 3 & 6 with crosscontam 0.7519532050822093 and sim 0.9716603205144692
Collapsing 1 & 6 with crosscontam 0.5907661862894311 and sim 0.9678400672527796
Collapsing 5 & 6 with crosscontam 0.5816718745679286 and sim 0.9578426165900842
Collapsing 1 & 5 with crosscontam 0.721866850235722 and sim 0.9567056984837375
Collapsing 1 & 3 with crosscontam 0.6310954402335247 and sim 0.9560724221615874
Collapsing 2 & 5 with crosscontam 0.764273515385502 and sim 0.9525470963893959
Collapsing 3 & 5 with crosscontam 0.6764492434124616 and sim 0.9512445917123263
Collapsing 1 & 2 with crosscontam 0.7096968842178284 and sim 0.9508020461107435
Collapsing 2 & 6 with crosscontam 0.5144618140831305 and sim 0.9424609561357684
Collapsing 0 & 3 with crosscontam 0.7199701208817331 and sim 0.9413779305159706
Collapsing 2 & 3 with crosscontam 0.6500579191713918 and sim 0.935738632103526
Collapsing 0 & 5 with crosscontam 0.6548730454937324 and sim 0.9212555484152585
Collapsing 3 & 4 with crosscontam 0.4914672311428374 and sim 0.9136126634982087
Collapsing 2 & 4 with crosscontam 0.6154105033594379 and sim 0.9076461010410457
Collapsing 4 & 6 with crosscontam 0.32944363790871956 and sim 0.9062559482103412
Collapsing 0 & 6 with crosscontam 0.4635869780235984 and sim 0.9041965190040083
Collapsing 0 & 2 with crosscontam 0.5842025949773584 and sim 0.9007218335965104
Collapsing 0 & 1 with crosscontam 0.6274965717760144 and sim 0.895465136307
Trimming eliminated 0 seqlets out of 186
Trimming eliminated 0 seqlets out of 387
Trimming eliminated 0 seqlets out of 473
Trimming eliminated 0 seqlets out of 669
Trimming eliminated 0 seqlets out of 954
Trimming eliminated 0 seqlets out of 1067
Unmerged patterns remapping: OrderedDict([(7, 1), (8, 2)])
Time spent on merging iteration: 5.314043998718262
On merging iteration 2
Numbers for each pattern pre-subsample: [1067, 6, 6]
Numbers after subsampling: [300, 6, 6]
Computing sims for pattern 0
Computed sims for pattern 0 in 0.4463331699371338 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.028961658477783203 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.028822660446166992 s
Cluster sizes
[1067    6    6]
Cross-contamination matrix:
[[1.   0.47 0.49]
 [0.11 1.   0.07]
 [0.19 0.13 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.69 0.74]
 [0.69 1.   0.69]
 [0.74 0.69 1.  ]]
Merging on 12 clusters
2024-03-16 17:02:46.269205 MEMORY 14.656892928
On merging iteration 1
Numbers for each pattern pre-subsample: [1434, 190, 724, 230, 212, 208, 75, 1169, 10, 1067, 6, 6]
Numbers after subsampling: [300, 190, 300, 230, 212, 208, 75, 300, 10, 300, 6, 6]
Computing sims for pattern 0
Computed sims for pattern 0 in 3.1602559089660645 s
Computing sims for pattern 1
Computed sims for pattern 1 in 2.1879773139953613 s
Computing sims for pattern 2
Computed sims for pattern 2 in 3.2347183227539062 s
Computing sims for pattern 3
Computed sims for pattern 3 in 2.7862892150878906 s
Computing sims for pattern 4
Computed sims for pattern 4 in 2.518683910369873 s
Computing sims for pattern 5
Computed sims for pattern 5 in 2.542267322540283 s
Computing sims for pattern 6
Computed sims for pattern 6 in 0.9817321300506592 s
Computing sims for pattern 7
Computed sims for pattern 7 in 3.247291088104248 s
Computing sims for pattern 8
Computed sims for pattern 8 in 0.26997995376586914 s
Computing sims for pattern 9
Computed sims for pattern 9 in 3.2197723388671875 s
Computing sims for pattern 10
Computed sims for pattern 10 in 0.23305320739746094 s
Computing sims for pattern 11
Computed sims for pattern 11 in 0.22118377685546875 s
Cluster sizes
[1434  190  724  230  212  208   75 1169   10 1067    6    6]
Cross-contamination matrix:
[[1.   0.59 0.15 0.1  0.12 0.09 0.07 0.25 0.08 0.23 0.14 0.17]
 [0.68 1.   0.28 0.11 0.19 0.1  0.08 0.34 0.16 0.08 0.15 0.22]
 [0.32 0.52 1.   0.76 0.7  0.83 0.78 0.71 0.67 0.15 0.14 0.29]
 [0.07 0.09 0.49 1.   0.52 0.64 0.7  0.25 0.43 0.23 0.07 0.28]
 [0.26 0.34 0.65 0.76 1.   0.62 0.85 0.48 0.67 0.39 0.23 0.38]
 [0.05 0.08 0.5  0.59 0.38 1.   0.51 0.13 0.09 0.33 0.11 0.21]
 [0.01 0.03 0.27 0.42 0.35 0.31 1.   0.07 0.34 0.04 0.01 0.04]
 [0.52 0.57 0.79 0.56 0.6  0.44 0.48 1.   0.95 0.18 0.11 0.28]
 [0.   0.   0.06 0.07 0.03 0.02 0.08 0.09 1.   0.01 0.   0.01]
 [0.29 0.1  0.08 0.3  0.27 0.43 0.15 0.09 0.18 1.   0.47 0.49]
 [0.02 0.01 0.   0.01 0.01 0.02 0.   0.   0.03 0.11 1.   0.07]
 [0.08 0.09 0.05 0.13 0.08 0.11 0.05 0.03 0.07 0.19 0.13 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.8  0.53 0.39 0.55 0.39 0.39 0.61 0.32 0.57 0.62 0.63]
 [0.8  1.   0.69 0.46 0.62 0.49 0.46 0.72 0.47 0.36 0.44 0.4 ]
 [0.53 0.69 1.   0.73 0.78 0.81 0.66 0.88 0.66 0.31 0.35 0.4 ]
 [0.39 0.46 0.73 1.   0.83 0.85 0.77 0.61 0.59 0.66 0.43 0.62]
 [0.55 0.62 0.78 0.83 1.   0.71 0.82 0.74 0.59 0.61 0.48 0.62]
 [0.39 0.49 0.81 0.85 0.71 1.   0.78 0.65 0.48 0.67 0.5  0.52]
 [0.39 0.46 0.66 0.77 0.82 0.78 1.   0.59 0.5  0.48 0.37 0.48]
 [0.61 0.72 0.88 0.61 0.74 0.65 0.59 1.   0.68 0.32 0.29 0.42]
 [0.32 0.47 0.66 0.59 0.59 0.48 0.5  0.68 1.   0.4  0.38 0.48]
 [0.57 0.36 0.31 0.66 0.61 0.67 0.48 0.32 0.4  1.   0.69 0.74]
 [0.62 0.44 0.35 0.43 0.48 0.5  0.37 0.29 0.38 0.69 1.   0.69]
 [0.63 0.4  0.4  0.62 0.62 0.52 0.48 0.42 0.48 0.74 0.69 1.  ]]
Collapsing 2 & 7 with crosscontam 0.7076162241975308 and sim 0.8838441453375598
Skipped 3 due to duplicates
Trimming eliminated 0 seqlets out of 1890
Unmerged patterns remapping: OrderedDict([(0, 1), (1, 6), (3, 3), (4, 4), (5, 5), (6, 7), (8, 8), (9, 2), (10, 9), (11, 10)])
Time spent on merging iteration: 4.369653701782227
On merging iteration 2
Numbers for each pattern pre-subsample: [1890, 1434, 1067, 230, 212, 208, 190, 75, 10, 6, 6]
Numbers after subsampling: [300, 300, 300, 230, 212, 208, 190, 75, 10, 6, 6]
Computing sims for pattern 0
Computed sims for pattern 0 in 2.9501521587371826 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.3500196933746338 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.36017847061157227 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.30057430267333984 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.2778644561767578 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.27024316787719727 s
Computing sims for pattern 6
Computed sims for pattern 6 in 0.23209047317504883 s
Computing sims for pattern 7
Computed sims for pattern 7 in 0.10538315773010254 s
Computing sims for pattern 8
Computed sims for pattern 8 in 0.035585880279541016 s
Computing sims for pattern 9
Computed sims for pattern 9 in 0.02761697769165039 s
Computing sims for pattern 10
Computed sims for pattern 10 in 0.026981353759765625 s
Cluster sizes
[1890 1434 1067  230  212  208  190   75   10    6    6]
Cross-contamination matrix:
[[1.   0.51 0.17 0.68 0.71 0.58 0.61 0.63 0.89 0.13 0.25]
 [0.24 1.   0.23 0.1  0.12 0.09 0.59 0.07 0.08 0.14 0.17]
 [0.08 0.29 1.   0.3  0.27 0.43 0.1  0.15 0.18 0.47 0.49]
 [0.35 0.07 0.23 1.   0.52 0.64 0.09 0.7  0.43 0.07 0.28]
 [0.58 0.26 0.39 0.76 1.   0.62 0.34 0.85 0.67 0.23 0.38]
 [0.15 0.05 0.33 0.59 0.38 1.   0.08 0.51 0.09 0.11 0.21]
 [0.33 0.68 0.08 0.11 0.19 0.1  1.   0.08 0.16 0.15 0.22]
 [0.11 0.01 0.04 0.42 0.35 0.31 0.03 1.   0.34 0.01 0.04]
 [0.05 0.   0.01 0.07 0.03 0.02 0.   0.08 1.   0.   0.01]
 [0.   0.02 0.11 0.01 0.01 0.02 0.01 0.   0.03 1.   0.07]
 [0.03 0.08 0.19 0.13 0.08 0.11 0.09 0.05 0.07 0.13 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.59 0.29 0.67 0.77 0.69 0.72 0.62 0.66 0.31 0.41]
 [0.59 1.   0.57 0.39 0.55 0.39 0.8  0.39 0.32 0.62 0.63]
 [0.29 0.57 1.   0.66 0.61 0.67 0.36 0.48 0.4  0.69 0.74]
 [0.67 0.39 0.66 1.   0.83 0.85 0.46 0.77 0.59 0.43 0.62]
 [0.77 0.55 0.61 0.83 1.   0.71 0.62 0.82 0.59 0.48 0.62]
 [0.69 0.39 0.67 0.85 0.71 1.   0.49 0.78 0.48 0.5  0.52]
 [0.72 0.8  0.36 0.46 0.62 0.49 1.   0.46 0.47 0.44 0.4 ]
 [0.62 0.39 0.48 0.77 0.82 0.78 0.46 1.   0.5  0.37 0.48]
 [0.66 0.32 0.4  0.59 0.59 0.48 0.47 0.5  1.   0.38 0.48]
 [0.31 0.62 0.69 0.43 0.48 0.5  0.44 0.37 0.38 1.   0.69]
 [0.41 0.63 0.74 0.62 0.62 0.52 0.4  0.48 0.48 0.69 1.  ]]
Got 11 patterns after merging
2024-03-16 17:03:20.668252 MEMORY 14.656892928
Performing filtering
2024-03-16 17:03:20.668446 MEMORY 14.656892928
Got 8 patterns after filtering
2024-03-16 17:03:21.357496 MEMORY 14.656892928
Total time taken is 601.82s
2024-03-16 17:03:21.357643 MEMORY 14.656892928
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 1650 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 1890 out of 1890 | elapsed:    0.3s finished
/ru-auth/local/home/lzhao/anaconda3/envs/jupyter-ml-clone/lib/python3.9/site-packages/sklearn/manifold/_t_sne.py:691: FutureWarning: 'square_distances' has been introduced in 0.24 to help phase out legacy squaring behavior. The 'legacy' setting will be removed in 1.1 (renaming of 0.26), and the default setting will be changed to True. In 1.3, 'square_distances' will be removed altogether, and distances will be squared by default. Set 'square_distances'=True to silence this warning.
  warnings.warn(
/ru-auth/local/home/lzhao/anaconda3/envs/jupyter-ml-clone/lib/python3.9/site-packages/sklearn/neighbors/_base.py:175: EfficiencyWarning: Precomputed sparse input was not sorted by data.
  warnings.warn('Precomputed sparse input was not sorted by data.',
Applying subclustering to the final motifs
On pattern 0
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 1890 samples in 0.012s...
[t-SNE] Computed neighbors for 1890 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 1000 / 1890
[t-SNE] Computed conditional probabilities for sample 1890 / 1890
[t-SNE] Mean sigma: 0.309516
[t-SNE] Computed conditional probabilities in 0.130s
[t-SNE] Iteration 50: error = 70.7268066, gradient norm = 0.0873431 (50 iterations in 0.157s)
[t-SNE] Iteration 100: error = 70.8478851, gradient norm = 0.0530676 (50 iterations in 0.161s)
[t-SNE] Iteration 150: error = 70.8991318, gradient norm = 0.0592672 (50 iterations in 0.172s)
[t-SNE] Iteration 200: error = 70.7827759, gradient norm = 0.0655477 (50 iterations in 0.168s)
[t-SNE] Iteration 250: error = 70.6096802, gradient norm = 0.0737216 (50 iterations in 0.167s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 70.609680
[t-SNE] Iteration 300: error = 2.1432705, gradient norm = 0.0014119 (50 iterations in 0.136s)
[t-SNE] Iteration 350: error = 2.0221796, gradient norm = 0.0005556 (50 iterations in 0.129s)
[t-SNE] Iteration 400: error = 1.9815509, gradient norm = 0.0002231 (50 iterations in 0.130s)
[t-SNE] Iteration 450: error = 1.9622419, gradient norm = 0.0001461 (50 iterations in 0.130s)
[t-SNE] Iteration 500: error = 1.9514645, gradient norm = 0.0001175 (50 iterations in 0.131s)
[t-SNE] Iteration 550: error = 1.9464664, gradient norm = 0.0001135 (50 iterations in 0.131s)
[t-SNE] Iteration 600: error = 1.9439124, gradient norm = 0.0000819 (50 iterations in 0.129s)
[t-SNE] Iteration 650: error = 1.9417450, gradient norm = 0.0000639 (50 iterations in 0.129s)
[t-SNE] Iteration 700: error = 1.9399326, gradient norm = 0.0000750 (50 iterations in 0.130s)
[t-SNE] Iteration 750: error = 1.9383631, gradient norm = 0.0000576 (50 iterations in 0.129s)
[t-SNE] Iteration 800: error = 1.9368906, gradient norm = 0.0000634 (50 iterations in 0.128s)
[t-SNE] Iteration 850: error = 1.9354331, gradient norm = 0.0000450 (50 iterations in 0.128s)
[t-SNE] Iteration 900: error = 1.9347053, gradient norm = 0.0000373 (50 iterations in 0.130s)
[t-SNE] Iteration 950: error = 1.9340595, gradient norm = 0.0000376 (50 iterations in 0.127s)
[t-SNE] Iteration 1000: error = 1.9335933, gradient norm = 0.0000442 (50 iterations in 0.129s)
[t-SNE] KL divergence after 1000 iterations: 1.933593
[t-SNE] Computed conditional probabilities for sample 1000 / 1890
[t-SNE] Computed conditional probabilities for sample 1890 / 1890
[t-SNE] Mean sigma: 0.309516
Beginning preprocessing + Leiden
2024-03-16 17:03:26.570132 MEMORY 14.66175488
Affmat transformed
2024-03-16 17:03:26.591359 MEMORY 14.66345472
sources, targets, weights extracted
2024-03-16 17:03:26.604043 MEMORY 14.663692288
About to launch parallel Leiden runs
2024-03-16 17:03:26.644200 MEMORY 14.663692288
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    5.0s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   16.7s finished
Parallel Leiden runs finished
2024-03-16 17:03:43.324396 MEMORY 14.663692288
Quality: 0.5242196243680536
Quality: 0.5286565895773152
Quality: 0.5292408748293453
Quality: 0.5292669569226766
Quality: 0.5297481058600834
Quality: 0.529757288752451
Quality: 0.5297732428227167
Quality: 0.5300777319301112
Quality: 0.5301817131728132
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 1290 tasks      | elapsed:    0.6s
[Parallel(n_jobs=24)]: Done 1434 out of 1434 | elapsed:    0.7s finished
Got subclusters: Counter({0: 282, 1: 269, 2: 259, 3: 254, 4: 215, 5: 207, 6: 172, 7: 149, 8: 83})
On pattern 1
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 1434 samples in 0.009s...
[t-SNE] Computed neighbors for 1434 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 1000 / 1434
[t-SNE] Computed conditional probabilities for sample 1434 / 1434
[t-SNE] Mean sigma: 0.265743
[t-SNE] Computed conditional probabilities in 0.103s
[t-SNE] Iteration 50: error = 67.5184937, gradient norm = 0.1882033 (50 iterations in 0.119s)
[t-SNE] Iteration 100: error = 67.8733444, gradient norm = 0.1842910 (50 iterations in 0.119s)
[t-SNE] Iteration 150: error = 68.4074554, gradient norm = 0.1835449 (50 iterations in 0.120s)
[t-SNE] Iteration 200: error = 68.8747025, gradient norm = 0.1855210 (50 iterations in 0.121s)
[t-SNE] Iteration 250: error = 67.8750229, gradient norm = 0.1951388 (50 iterations in 0.122s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 67.875023
[t-SNE] Iteration 300: error = 1.8911668, gradient norm = 0.0017383 (50 iterations in 0.117s)
[t-SNE] Iteration 350: error = 1.7981813, gradient norm = 0.0005652 (50 iterations in 0.105s)
[t-SNE] Iteration 400: error = 1.7656977, gradient norm = 0.0003359 (50 iterations in 0.104s)
[t-SNE] Iteration 450: error = 1.7470667, gradient norm = 0.0001824 (50 iterations in 0.104s)
[t-SNE] Iteration 500: error = 1.7388449, gradient norm = 0.0001493 (50 iterations in 0.107s)
[t-SNE] Iteration 550: error = 1.7338475, gradient norm = 0.0001214 (50 iterations in 0.103s)
[t-SNE] Iteration 600: error = 1.7294888, gradient norm = 0.0001131 (50 iterations in 0.104s)
[t-SNE] Iteration 650: error = 1.7270633, gradient norm = 0.0000959 (50 iterations in 0.104s)
[t-SNE] Iteration 700: error = 1.7255967, gradient norm = 0.0000865 (50 iterations in 0.105s)
[t-SNE] Iteration 750: error = 1.7243943, gradient norm = 0.0000733 (50 iterations in 0.103s)
[t-SNE] Iteration 800: error = 1.7230760, gradient norm = 0.0000632 (50 iterations in 0.103s)
[t-SNE] Iteration 850: error = 1.7217957, gradient norm = 0.0000822 (50 iterations in 0.105s)
[t-SNE] Iteration 900: error = 1.7207946, gradient norm = 0.0000857 (50 iterations in 0.105s)
[t-SNE] Iteration 950: error = 1.7197459, gradient norm = 0.0000746 (50 iterations in 0.110s)
[t-SNE] Iteration 1000: error = 1.7188307, gradient norm = 0.0000930 (50 iterations in 0.107s)
[t-SNE] KL divergence after 1000 iterations: 1.718831
[t-SNE] Computed conditional probabilities for sample 1000 / 1434
[t-SNE] Computed conditional probabilities for sample 1434 / 1434
[t-SNE] Mean sigma: 0.265743
Beginning preprocessing + Leiden
2024-03-16 17:03:47.981431 MEMORY 14.663790592
Affmat transformed
2024-03-16 17:03:47.997998 MEMORY 14.663790592
sources, targets, weights extracted
2024-03-16 17:03:48.010327 MEMORY 14.663790592
About to launch parallel Leiden runs
2024-03-16 17:03:48.018327 MEMORY 14.663790592
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    3.9s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   12.9s finished
Parallel Leiden runs finished
2024-03-16 17:04:00.871550 MEMORY 14.663790592
Quality: 0.4962617903114966
Quality: 0.4964255134543419
Quality: 0.4965591049532353
Quality: 0.4965836927360013
Quality: 0.49668244951400037
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 930 tasks      | elapsed:    0.4s
[Parallel(n_jobs=24)]: Done 1067 out of 1067 | elapsed:    0.6s finished
Got subclusters: Counter({0: 414, 1: 248, 2: 233, 3: 197, 4: 121, 5: 74, 6: 72, 7: 65, 8: 10})
On pattern 2
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 1067 samples in 0.007s...
[t-SNE] Computed neighbors for 1067 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 1000 / 1067
[t-SNE] Computed conditional probabilities for sample 1067 / 1067
[t-SNE] Mean sigma: 0.280136
[t-SNE] Computed conditional probabilities in 0.073s
[t-SNE] Iteration 50: error = 67.1010742, gradient norm = 0.3081587 (50 iterations in 0.085s)
[t-SNE] Iteration 100: error = 67.9190140, gradient norm = 0.2643185 (50 iterations in 0.085s)
[t-SNE] Iteration 150: error = 67.0352554, gradient norm = 0.2901901 (50 iterations in 0.087s)
[t-SNE] Iteration 200: error = 68.2497101, gradient norm = 0.2478347 (50 iterations in 0.087s)
[t-SNE] Iteration 250: error = 67.4387894, gradient norm = 0.2833901 (50 iterations in 0.088s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 67.438789
[t-SNE] Iteration 300: error = 1.8837912, gradient norm = 0.0015802 (50 iterations in 0.080s)
[t-SNE] Iteration 350: error = 1.8083115, gradient norm = 0.0006881 (50 iterations in 0.077s)
[t-SNE] Iteration 400: error = 1.7671489, gradient norm = 0.0005393 (50 iterations in 0.077s)
[t-SNE] Iteration 450: error = 1.7396119, gradient norm = 0.0004138 (50 iterations in 0.077s)
[t-SNE] Iteration 500: error = 1.7211734, gradient norm = 0.0004198 (50 iterations in 0.079s)
[t-SNE] Iteration 550: error = 1.7096248, gradient norm = 0.0004777 (50 iterations in 0.080s)
[t-SNE] Iteration 600: error = 1.7040780, gradient norm = 0.0003446 (50 iterations in 0.078s)
[t-SNE] Iteration 650: error = 1.6970165, gradient norm = 0.0002741 (50 iterations in 0.078s)
[t-SNE] Iteration 700: error = 1.6893272, gradient norm = 0.0002364 (50 iterations in 0.079s)
[t-SNE] Iteration 750: error = 1.6857369, gradient norm = 0.0001733 (50 iterations in 0.079s)
[t-SNE] Iteration 800: error = 1.6825247, gradient norm = 0.0002512 (50 iterations in 0.080s)
[t-SNE] Iteration 850: error = 1.6797364, gradient norm = 0.0001963 (50 iterations in 0.078s)
[t-SNE] Iteration 900: error = 1.6775624, gradient norm = 0.0001144 (50 iterations in 0.078s)
[t-SNE] Iteration 950: error = 1.6769116, gradient norm = 0.0000853 (50 iterations in 0.079s)
[t-SNE] Iteration 1000: error = 1.6759568, gradient norm = 0.0001067 (50 iterations in 0.077s)
[t-SNE] KL divergence after 1000 iterations: 1.675957
[t-SNE] Computed conditional probabilities for sample 1000 / 1067
[t-SNE] Computed conditional probabilities for sample 1067 / 1067
[t-SNE] Mean sigma: 0.280136
Beginning preprocessing + Leiden
2024-03-16 17:04:04.328334 MEMORY 14.663790592
Affmat transformed
2024-03-16 17:04:04.340880 MEMORY 14.663790592
sources, targets, weights extracted
2024-03-16 17:04:04.349157 MEMORY 14.663790592
About to launch parallel Leiden runs
2024-03-16 17:04:04.356074 MEMORY 14.663790592
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    2.9s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    9.7s finished
Parallel Leiden runs finished
2024-03-16 17:04:14.099065 MEMORY 14.663790592
Quality: 0.45817764675023587
Quality: 0.4598666860194482
Quality: 0.4599533775408222
Quality: 0.4602564543209031
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 230 out of 230 | elapsed:    0.1s finished
Got subclusters: Counter({0: 299, 1: 246, 2: 138, 3: 136, 4: 124, 5: 117, 6: 5, 7: 2})
On pattern 3
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 230 samples in 0.002s...
[t-SNE] Computed neighbors for 230 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 230 / 230
[t-SNE] Mean sigma: 0.354972
[t-SNE] Computed conditional probabilities in 0.016s
[t-SNE] Iteration 50: error = 66.4117737, gradient norm = 0.4662797 (50 iterations in 0.029s)
[t-SNE] Iteration 100: error = 67.3617020, gradient norm = 0.4607005 (50 iterations in 0.030s)
[t-SNE] Iteration 150: error = 64.4059296, gradient norm = 0.4859252 (50 iterations in 0.030s)
[t-SNE] Iteration 200: error = 64.4173737, gradient norm = 0.4696319 (50 iterations in 0.027s)
[t-SNE] Iteration 250: error = 60.2252312, gradient norm = 0.5167184 (50 iterations in 0.028s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 60.225231
[t-SNE] Iteration 300: error = 0.9611837, gradient norm = 0.0071570 (50 iterations in 0.027s)
[t-SNE] Iteration 350: error = 0.8132688, gradient norm = 0.0017640 (50 iterations in 0.028s)
[t-SNE] Iteration 400: error = 0.7857157, gradient norm = 0.0024567 (50 iterations in 0.029s)
[t-SNE] Iteration 450: error = 0.7751512, gradient norm = 0.0006919 (50 iterations in 0.028s)
[t-SNE] Iteration 500: error = 0.7693383, gradient norm = 0.0018992 (50 iterations in 0.027s)
[t-SNE] Iteration 550: error = 0.7567957, gradient norm = 0.0016573 (50 iterations in 0.029s)
[t-SNE] Iteration 600: error = 0.7540061, gradient norm = 0.0005851 (50 iterations in 0.027s)
[t-SNE] Iteration 650: error = 0.7396620, gradient norm = 0.0025570 (50 iterations in 0.030s)
[t-SNE] Iteration 700: error = 0.7271295, gradient norm = 0.0001597 (50 iterations in 0.029s)
[t-SNE] Iteration 750: error = 0.7271957, gradient norm = 0.0001221 (50 iterations in 0.029s)
[t-SNE] Iteration 800: error = 0.7270707, gradient norm = 0.0001735 (50 iterations in 0.029s)
[t-SNE] Iteration 850: error = 0.7270858, gradient norm = 0.0001209 (50 iterations in 0.028s)
[t-SNE] Iteration 900: error = 0.7271493, gradient norm = 0.0001726 (50 iterations in 0.031s)
[t-SNE] Iteration 950: error = 0.7271657, gradient norm = 0.0001496 (50 iterations in 0.029s)
[t-SNE] Iteration 1000: error = 0.7270558, gradient norm = 0.0001339 (50 iterations in 0.029s)
[t-SNE] KL divergence after 1000 iterations: 0.727056
[t-SNE] Computed conditional probabilities for sample 230 / 230
[t-SNE] Mean sigma: 0.354972
Beginning preprocessing + Leiden
2024-03-16 17:04:15.140126 MEMORY 14.663790592
Affmat transformed
2024-03-16 17:04:15.143266 MEMORY 14.663790592
sources, targets, weights extracted
2024-03-16 17:04:15.144562 MEMORY 14.663790592
About to launch parallel Leiden runs
2024-03-16 17:04:15.149623 MEMORY 14.663790592
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.8s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.5s finished
Parallel Leiden runs finished
2024-03-16 17:04:17.642631 MEMORY 14.663790592
Quality: 0.3264465656515593
Quality: 0.3306853835789834
Quality: 0.3316266038660214
Quality: 0.3322750194144138
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 212 out of 212 | elapsed:    0.1s finished
Got subclusters: Counter({0: 56, 1: 52, 2: 51, 3: 41, 4: 30})
On pattern 4
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 212 samples in 0.002s...
[t-SNE] Computed neighbors for 212 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 212 / 212
[t-SNE] Mean sigma: 0.385843
[t-SNE] Computed conditional probabilities in 0.014s
[t-SNE] Iteration 50: error = 60.7486801, gradient norm = 0.5095904 (50 iterations in 0.112s)
[t-SNE] Iteration 100: error = 62.9923820, gradient norm = 0.4794322 (50 iterations in 0.029s)
[t-SNE] Iteration 150: error = 59.9114876, gradient norm = 0.5166274 (50 iterations in 0.029s)
[t-SNE] Iteration 200: error = 60.0662956, gradient norm = 0.5192074 (50 iterations in 0.027s)
[t-SNE] Iteration 250: error = 58.4479790, gradient norm = 0.5327340 (50 iterations in 0.027s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 58.447979
[t-SNE] Iteration 300: error = 0.7957143, gradient norm = 0.0047366 (50 iterations in 0.027s)
[t-SNE] Iteration 350: error = 0.6818461, gradient norm = 0.0030967 (50 iterations in 0.026s)
[t-SNE] Iteration 400: error = 0.6559799, gradient norm = 0.0013345 (50 iterations in 0.028s)
[t-SNE] Iteration 450: error = 0.6432846, gradient norm = 0.0007339 (50 iterations in 0.026s)
[t-SNE] Iteration 500: error = 0.6427879, gradient norm = 0.0002270 (50 iterations in 0.026s)
[t-SNE] Iteration 550: error = 0.6425492, gradient norm = 0.0001400 (50 iterations in 0.027s)
[t-SNE] Iteration 600: error = 0.6425748, gradient norm = 0.0001668 (50 iterations in 0.026s)
[t-SNE] Iteration 650: error = 0.6426600, gradient norm = 0.0002029 (50 iterations in 0.026s)
[t-SNE] Iteration 700: error = 0.6426281, gradient norm = 0.0002036 (50 iterations in 0.025s)
[t-SNE] Iteration 750: error = 0.6426209, gradient norm = 0.0002169 (50 iterations in 0.025s)
[t-SNE] Iteration 800: error = 0.6426639, gradient norm = 0.0002487 (50 iterations in 0.025s)
[t-SNE] Iteration 850: error = 0.6427094, gradient norm = 0.0002452 (50 iterations in 0.025s)
[t-SNE] Iteration 900: error = 0.6426839, gradient norm = 0.0001809 (50 iterations in 0.025s)
[t-SNE] Iteration 900: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 900 iterations: 0.642684
[t-SNE] Computed conditional probabilities for sample 212 / 212
[t-SNE] Mean sigma: 0.385843
Beginning preprocessing + Leiden
2024-03-16 17:04:18.552282 MEMORY 14.663790592
Affmat transformed
2024-03-16 17:04:18.555210 MEMORY 14.663790592
sources, targets, weights extracted
2024-03-16 17:04:18.556393 MEMORY 14.663790592
About to launch parallel Leiden runs
2024-03-16 17:04:18.560472 MEMORY 14.663790592
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.8s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.3s finished
Parallel Leiden runs finished
2024-03-16 17:04:20.878299 MEMORY 14.663790592
Quality: 0.3456994037665768
Quality: 0.34814645558521606
Quality: 0.34867733915906385
Quality: 0.34900257374599436
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 208 out of 208 | elapsed:    0.1s finished
Got subclusters: Counter({0: 54, 1: 51, 2: 44, 3: 35, 4: 28})
On pattern 5
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 208 samples in 0.002s...
[t-SNE] Computed neighbors for 208 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 208 / 208
[t-SNE] Mean sigma: 0.363136
[t-SNE] Computed conditional probabilities in 0.014s
[t-SNE] Iteration 50: error = 59.1594810, gradient norm = 0.5097609 (50 iterations in 0.026s)
[t-SNE] Iteration 100: error = 59.4817047, gradient norm = 0.5534902 (50 iterations in 0.027s)
[t-SNE] Iteration 150: error = 61.1538200, gradient norm = 0.5040961 (50 iterations in 0.028s)
[t-SNE] Iteration 200: error = 62.6270218, gradient norm = 0.4630130 (50 iterations in 0.027s)
[t-SNE] Iteration 250: error = 58.5633011, gradient norm = 0.5250767 (50 iterations in 0.028s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 58.563301
[t-SNE] Iteration 300: error = 0.8823403, gradient norm = 0.0064226 (50 iterations in 0.025s)
[t-SNE] Iteration 350: error = 0.7311659, gradient norm = 0.0031958 (50 iterations in 0.026s)
[t-SNE] Iteration 400: error = 0.6818597, gradient norm = 0.0011458 (50 iterations in 0.025s)
[t-SNE] Iteration 450: error = 0.6748451, gradient norm = 0.0010890 (50 iterations in 0.025s)
[t-SNE] Iteration 500: error = 0.6743212, gradient norm = 0.0001176 (50 iterations in 0.026s)
[t-SNE] Iteration 550: error = 0.6744101, gradient norm = 0.0001463 (50 iterations in 0.025s)
[t-SNE] Iteration 600: error = 0.6742919, gradient norm = 0.0001226 (50 iterations in 0.024s)
[t-SNE] Iteration 650: error = 0.6743014, gradient norm = 0.0001619 (50 iterations in 0.024s)
[t-SNE] Iteration 700: error = 0.6743008, gradient norm = 0.0001430 (50 iterations in 0.025s)
[t-SNE] Iteration 750: error = 0.6744528, gradient norm = 0.0000931 (50 iterations in 0.025s)
[t-SNE] Iteration 800: error = 0.6744875, gradient norm = 0.0001152 (50 iterations in 0.027s)
[t-SNE] Iteration 850: error = 0.6743004, gradient norm = 0.0001596 (50 iterations in 0.025s)
[t-SNE] Iteration 900: error = 0.6743371, gradient norm = 0.0001306 (50 iterations in 0.025s)
[t-SNE] Iteration 950: error = 0.6743903, gradient norm = 0.0001160 (50 iterations in 0.025s)
[t-SNE] Iteration 950: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 950 iterations: 0.674390
[t-SNE] Computed conditional probabilities for sample 208 / 208
[t-SNE] Mean sigma: 0.363136
Beginning preprocessing + Leiden
2024-03-16 17:04:21.690965 MEMORY 14.66382336
Affmat transformed
2024-03-16 17:04:21.693996 MEMORY 14.66382336
sources, targets, weights extracted
2024-03-16 17:04:21.695101 MEMORY 14.66382336
About to launch parallel Leiden runs
2024-03-16 17:04:21.699779 MEMORY 14.66382336
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.8s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.2s finished
Parallel Leiden runs finished
2024-03-16 17:04:23.943344 MEMORY 14.66382336
Quality: 0.3573955266554192
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 190 out of 190 | elapsed:    0.1s finished
Got subclusters: Counter({0: 54, 1: 45, 2: 43, 3: 42, 4: 24})
On pattern 6
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 190 samples in 0.002s...
[t-SNE] Computed neighbors for 190 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 190 / 190
[t-SNE] Mean sigma: 0.363371
[t-SNE] Computed conditional probabilities in 0.012s
[t-SNE] Iteration 50: error = 62.1598930, gradient norm = 0.4683011 (50 iterations in 0.026s)
[t-SNE] Iteration 100: error = 57.4665031, gradient norm = 0.5410502 (50 iterations in 0.025s)
[t-SNE] Iteration 150: error = 58.7491150, gradient norm = 0.5441906 (50 iterations in 0.026s)
[t-SNE] Iteration 200: error = 61.1587296, gradient norm = 0.4511695 (50 iterations in 0.025s)
[t-SNE] Iteration 250: error = 57.7325859, gradient norm = 0.5251884 (50 iterations in 0.026s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 57.732586
[t-SNE] Iteration 300: error = 0.7747992, gradient norm = 0.0060225 (50 iterations in 0.023s)
[t-SNE] Iteration 350: error = 0.6145144, gradient norm = 0.0054975 (50 iterations in 0.024s)
[t-SNE] Iteration 400: error = 0.5990924, gradient norm = 0.0005652 (50 iterations in 0.024s)
[t-SNE] Iteration 450: error = 0.5973610, gradient norm = 0.0003156 (50 iterations in 0.023s)
[t-SNE] Iteration 500: error = 0.5973732, gradient norm = 0.0001651 (50 iterations in 0.025s)
[t-SNE] Iteration 550: error = 0.5974232, gradient norm = 0.0001244 (50 iterations in 0.024s)
[t-SNE] Iteration 600: error = 0.5974470, gradient norm = 0.0001271 (50 iterations in 0.024s)
[t-SNE] Iteration 650: error = 0.5973774, gradient norm = 0.0001892 (50 iterations in 0.024s)
[t-SNE] Iteration 700: error = 0.5973117, gradient norm = 0.0001051 (50 iterations in 0.024s)
[t-SNE] Iteration 750: error = 0.5974328, gradient norm = 0.0001285 (50 iterations in 0.024s)
[t-SNE] Iteration 800: error = 0.5973932, gradient norm = 0.0001188 (50 iterations in 0.024s)
[t-SNE] Iteration 850: error = 0.5972916, gradient norm = 0.0001733 (50 iterations in 0.024s)
[t-SNE] Iteration 900: error = 0.5974966, gradient norm = 0.0001334 (50 iterations in 0.024s)
[t-SNE] Iteration 950: error = 0.5972819, gradient norm = 0.0001282 (50 iterations in 0.024s)
[t-SNE] Iteration 1000: error = 0.5973276, gradient norm = 0.0001311 (50 iterations in 0.024s)
[t-SNE] KL divergence after 1000 iterations: 0.597328
[t-SNE] Computed conditional probabilities for sample 190 / 190
[t-SNE] Mean sigma: 0.363371
Beginning preprocessing + Leiden
2024-03-16 17:04:24.729482 MEMORY 14.66382336
Affmat transformed
2024-03-16 17:04:24.732050 MEMORY 14.66382336
sources, targets, weights extracted
2024-03-16 17:04:24.733021 MEMORY 14.66382336
About to launch parallel Leiden runs
2024-03-16 17:04:24.737407 MEMORY 14.66382336
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.8s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.2s finished
Parallel Leiden runs finished
2024-03-16 17:04:26.985913 MEMORY 14.66382336
Quality: 0.33047922008382596
Quality: 0.3310524916680665
Quality: 0.33178139935775497
Quality: 0.3323760178463504
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  75 out of  75 | elapsed:    0.0s finished
Got subclusters: Counter({0: 50, 1: 43, 2: 30, 3: 28, 4: 24, 5: 11, 6: 4})
On pattern 7
[t-SNE] Computing 74 nearest neighbors...
[t-SNE] Indexed 75 samples in 0.001s...
[t-SNE] Computed neighbors for 75 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 75 / 75
[t-SNE] Mean sigma: 0.517550
[t-SNE] Computed conditional probabilities in 0.003s
[t-SNE] Iteration 50: error = 50.4357986, gradient norm = 0.4827070 (50 iterations in 0.013s)
[t-SNE] Iteration 100: error = 47.6895561, gradient norm = 0.5761726 (50 iterations in 0.014s)
[t-SNE] Iteration 150: error = 46.7276001, gradient norm = 0.5836312 (50 iterations in 0.014s)
[t-SNE] Iteration 200: error = 48.2589073, gradient norm = 0.5550563 (50 iterations in 0.013s)
[t-SNE] Iteration 250: error = 49.7631073, gradient norm = 0.5251039 (50 iterations in 0.013s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 49.763107
[t-SNE] Iteration 300: error = 0.8761905, gradient norm = 0.0027174 (50 iterations in 0.013s)
[t-SNE] Iteration 350: error = 0.7080470, gradient norm = 0.0015270 (50 iterations in 0.012s)
[t-SNE] Iteration 400: error = 0.6185360, gradient norm = 0.0015163 (50 iterations in 0.013s)
[t-SNE] Iteration 450: error = 0.5558056, gradient norm = 0.0009820 (50 iterations in 0.012s)
[t-SNE] Iteration 500: error = 0.5221171, gradient norm = 0.0011031 (50 iterations in 0.012s)
[t-SNE] Iteration 550: error = 0.5059936, gradient norm = 0.0007331 (50 iterations in 0.012s)
[t-SNE] Iteration 600: error = 0.4688562, gradient norm = 0.0007608 (50 iterations in 0.012s)
[t-SNE] Iteration 650: error = 0.4534185, gradient norm = 0.0005212 (50 iterations in 0.013s)
[t-SNE] Iteration 700: error = 0.4350338, gradient norm = 0.0007530 (50 iterations in 0.012s)
[t-SNE] Iteration 750: error = 0.4081573, gradient norm = 0.0012405 (50 iterations in 0.012s)
[t-SNE] Iteration 800: error = 0.1870600, gradient norm = 0.0213837 (50 iterations in 0.012s)
[t-SNE] Iteration 850: error = 0.1501342, gradient norm = 0.0025673 (50 iterations in 0.013s)
[t-SNE] Iteration 900: error = 0.1500347, gradient norm = 0.0014627 (50 iterations in 0.014s)
[t-SNE] Iteration 950: error = 0.1501384, gradient norm = 0.0019679 (50 iterations in 0.014s)
[t-SNE] Iteration 1000: error = 0.1500661, gradient norm = 0.0012428 (50 iterations in 0.012s)
[t-SNE] KL divergence after 1000 iterations: 0.150066
[t-SNE] Computed conditional probabilities for sample 75 / 75
[t-SNE] Mean sigma: 0.517551
Beginning preprocessing + Leiden
2024-03-16 17:04:27.334549 MEMORY 14.66382336
Affmat transformed
2024-03-16 17:04:27.335498 MEMORY 14.66382336
sources, targets, weights extracted
2024-03-16 17:04:27.335888 MEMORY 14.66382336
About to launch parallel Leiden runs
2024-03-16 17:04:27.339798 MEMORY 14.66382336
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.6s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.8s finished
Parallel Leiden runs finished
2024-03-16 17:04:29.101679 MEMORY 14.66382336
Quality: 0.1784874157784278
Quality: 0.17864360447926847
Got subclusters: Counter({0: 21, 1: 17, 3: 15, 2: 15, 4: 7})
On metacluster 2
Metacluster size 10406
Relevant tasks:  ('head',)
Relevant signs:  (-1,)
TfModiscoSeqletsToPatternsFactory: seed=1234
(Round 1) num seqlets: 10406
(Round 1) Computing coarse affmat
2024-03-16 17:04:30.889144 MEMORY 14.663561216
Beginning embedding computation
MEMORY 14.663561216
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 152 tasks      | elapsed:    1.9s
[Parallel(n_jobs=24)]: Done 402 tasks      | elapsed:    4.7s
[Parallel(n_jobs=24)]: Done 752 tasks      | elapsed:    8.5s
[Parallel(n_jobs=24)]: Done 1202 tasks      | elapsed:   13.4s
[Parallel(n_jobs=24)]: Done 1752 tasks      | elapsed:   19.5s
[Parallel(n_jobs=24)]: Done 2402 tasks      | elapsed:   26.5s
[Parallel(n_jobs=24)]: Done 3152 tasks      | elapsed:   34.8s
[Parallel(n_jobs=24)]: Done 4002 tasks      | elapsed:   44.0s
[Parallel(n_jobs=24)]: Done 4952 tasks      | elapsed:   54.4s
[Parallel(n_jobs=24)]: Done 6002 tasks      | elapsed:  1.1min
[Parallel(n_jobs=24)]: Done 7152 tasks      | elapsed:  1.3min
[Parallel(n_jobs=24)]: Done 8402 tasks      | elapsed:  1.5min
[Parallel(n_jobs=24)]: Done 9752 tasks      | elapsed:  1.8min
[Parallel(n_jobs=24)]: Done 10406 out of 10406 | elapsed:  1.9min finished
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 152 tasks      | elapsed:    2.0s
[Parallel(n_jobs=24)]: Done 402 tasks      | elapsed:    4.8s
[Parallel(n_jobs=24)]: Done 752 tasks      | elapsed:    8.8s
[Parallel(n_jobs=24)]: Done 1202 tasks      | elapsed:   14.1s
[Parallel(n_jobs=24)]: Done 1752 tasks      | elapsed:   20.4s
[Parallel(n_jobs=24)]: Done 2402 tasks      | elapsed:   27.9s
[Parallel(n_jobs=24)]: Done 3152 tasks      | elapsed:   36.3s
[Parallel(n_jobs=24)]: Done 4002 tasks      | elapsed:   46.0s
[Parallel(n_jobs=24)]: Done 4952 tasks      | elapsed:   56.5s
[Parallel(n_jobs=24)]: Done 6002 tasks      | elapsed:  1.1min
[Parallel(n_jobs=24)]: Done 7152 tasks      | elapsed:  1.3min
[Parallel(n_jobs=24)]: Done 8402 tasks      | elapsed:  1.6min
[Parallel(n_jobs=24)]: Done 9752 tasks      | elapsed:  1.8min
[Parallel(n_jobs=24)]: Done 10406 out of 10406 | elapsed:  1.9min finished
At the beginning of embedding call
2024-03-16 17:04:30.889401 MEMORY 14.663561216
before computing embeddings fwd
2024-03-16 17:04:30.898092 MEMORY 14.663561216
after computing embeddings fwd
2024-03-16 17:06:24.970738 MEMORY 14.713229312
after computing embeddings rev
2024-03-16 17:08:21.178097 MEMORY 15.105732608
before computing sparse embeddings fwd
2024-03-16 17:08:21.178194 MEMORY 15.105732608
Constructing csr matrix...
csr matrix made in 1.2844786643981934 s
after computing sparse embeddings fwd
2024-03-16 17:08:22.955783 MEMORY 15.229554688
before computing sparse embeddings rev
2024-03-16 17:08:22.955871 MEMORY 15.229554688
Constructing csr matrix...
csr matrix made in 1.2034385204315186 s
after computing sparse embeddings rev
2024-03-16 17:08:24.566472 MEMORY 15.356157952
Finished embedding computation in 235.12 s
MEMORY 14.994345984
Starting affinity matrix computations
MEMORY 14.994345984
Batching in slices of size 6449
  0%|          | 0/2 [00:00<?, ?it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:09<00:09,  9.28s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:15<00:00,  7.38s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:15<00:00,  7.67s/it]
Finished affinity matrix computations in 15.39 s
MEMORY 14.996885504
(Round 1) Computed coarse affmat
2024-03-16 17:08:42.516074 MEMORY 14.72151552
(Round 1) Computing affinity matrix on nearest neighbors
2024-03-16 17:08:42.516216 MEMORY 14.72151552
Launching nearest neighbors affmat calculation job
MEMORY 14.796034048
Parallel runs completed
MEMORY 14.841401344
Job completed in: 31.28 s
MEMORY 14.838931456
Launching nearest neighbors affmat calculation job
MEMORY 14.836736
Parallel runs completed
MEMORY 14.942281728
Job completed in: 31.56 s
MEMORY 14.942208
(Round 1) Computed affinity matrix on nearest neighbors in 65.86 s
2024-03-16 17:09:48.374654 MEMORY 14.867451904
Filtered down to 9922 of 10406
(Round 1) Retained 9922 rows out of 10406 after filtering
2024-03-16 17:09:54.375830 MEMORY 14.867705856
(Round 1) Computing density adapted affmat
2024-03-16 17:09:57.754845 MEMORY 14.867709952
Symmetrizing nearest neighbors
Computing betas for density adaptation
Computing normalizing denominators
(Round 1) Computing clustering
2024-03-16 17:11:35.604694 MEMORY 15.214071808
Beginning preprocessing + Leiden
2024-03-16 17:11:35.619651 MEMORY 15.214071808
Affmat transformed
2024-03-16 17:11:35.619829 MEMORY 15.214071808
sources, targets, weights extracted
2024-03-16 17:11:36.021709 MEMORY 15.330623488
About to launch parallel Leiden runs
2024-03-16 17:11:36.112445 MEMORY 15.272411136
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:  1.2min
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:  3.8min finished
Parallel Leiden runs finished
2024-03-16 17:15:23.385893 MEMORY 15.266791424
Quality: 0.3876593906897693
Quality: 0.39371688173843955
Quality: 0.39373450670941146
Quality: 0.39373460839452734
Got 5 clusters after round 1
Counts:
{3: 1512, 0: 2720, 1: 2639, 2: 1758, 4: 1293}
2024-03-16 17:15:23.414454 MEMORY 15.091982336
(Round 1) Aggregating seqlets in each cluster
2024-03-16 17:15:23.414572 MEMORY 15.091982336
Aggregating for cluster 0 with 2720 seqlets
2024-03-16 17:15:23.421471 MEMORY 15.091990528
Skipped 2 seqlets that went over sequence edge during flank expansion
Skipped 8 due to duplicates
Trimming eliminated 0 seqlets out of 2710
Aggregating for cluster 1 with 2639 seqlets
2024-03-16 17:15:29.458490 MEMORY 15.092006912
Skipped 2 seqlets that went over sequence edge during flank expansion
Skipped 10 due to duplicates
Trimming eliminated 0 seqlets out of 2627
Aggregating for cluster 2 with 1758 seqlets
2024-03-16 17:15:36.652975 MEMORY 15.09214208
Skipped 3 due to duplicates
Trimming eliminated 0 seqlets out of 1755
Aggregating for cluster 3 with 1512 seqlets
2024-03-16 17:15:41.199803 MEMORY 15.092150272
Skipped 2 due to duplicates
Trimming eliminated 0 seqlets out of 1510
Aggregating for cluster 4 with 1293 seqlets
2024-03-16 17:15:44.540548 MEMORY 15.092150272
Skipped 5 due to duplicates
Trimming eliminated 0 seqlets out of 1288
(Round 2) num seqlets: 9869
(Round 2) Computing coarse affmat
2024-03-16 17:15:49.164806 MEMORY 15.092150272
Beginning embedding computation
MEMORY 15.092150272
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 368 tasks      | elapsed:    0.8s
[Parallel(n_jobs=24)]: Done 1368 tasks      | elapsed:    2.4s
[Parallel(n_jobs=24)]: Done 2768 tasks      | elapsed:    4.5s
[Parallel(n_jobs=24)]: Done 4568 tasks      | elapsed:    7.3s
[Parallel(n_jobs=24)]: Done 6768 tasks      | elapsed:   10.7s
[Parallel(n_jobs=24)]: Done 9368 tasks      | elapsed:   14.4s
[Parallel(n_jobs=24)]: Done 9869 out of 9869 | elapsed:   15.0s finished
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 272 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done 2112 tasks      | elapsed:    2.8s
[Parallel(n_jobs=24)]: Done 4912 tasks      | elapsed:    5.9s
[Parallel(n_jobs=24)]: Done 8512 tasks      | elapsed:   10.1s
[Parallel(n_jobs=24)]: Done 9869 out of 9869 | elapsed:   11.6s finished
At the beginning of embedding call
2024-03-16 17:15:49.165070 MEMORY 15.092150272
before computing embeddings fwd
2024-03-16 17:15:49.173950 MEMORY 15.092154368
after computing embeddings fwd
2024-03-16 17:16:04.210956 MEMORY 15.357005824
after computing embeddings rev
2024-03-16 17:16:15.807561 MEMORY 15.760941056
before computing sparse embeddings fwd
2024-03-16 17:16:15.807657 MEMORY 15.760941056
Constructing csr matrix...
csr matrix made in 1.1397175788879395 s
after computing sparse embeddings fwd
2024-03-16 17:16:17.367638 MEMORY 15.90347776
before computing sparse embeddings rev
2024-03-16 17:16:17.367721 MEMORY 15.90347776
Constructing csr matrix...
csr matrix made in 1.154789924621582 s
after computing sparse embeddings rev
2024-03-16 17:16:18.905121 MEMORY 15.982055424
Finished embedding computation in 31.73 s
MEMORY 15.65831168
Starting affinity matrix computations
MEMORY 15.657525248
Batching in slices of size 6799
  0%|          | 0/2 [00:00<?, ?it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:11<00:11, 11.11s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:16<00:00,  7.77s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:16<00:00,  8.27s/it]
Finished affinity matrix computations in 16.59 s
MEMORY 15.689166848
(Round 2) Computed coarse affmat
2024-03-16 17:16:38.725410 MEMORY 15.435657216
(Round 2) Computing affinity matrix on nearest neighbors
2024-03-16 17:16:38.725569 MEMORY 15.435657216
Launching nearest neighbors affmat calculation job
MEMORY 15.435657216
Parallel runs completed
MEMORY 15.449788416
Job completed in: 14.88 s
MEMORY 15.44935424
Launching nearest neighbors affmat calculation job
MEMORY 15.44923136
Parallel runs completed
MEMORY 15.472685056
Job completed in: 14.66 s
MEMORY 15.470465024
(Round 2) Computed affinity matrix on nearest neighbors in 32.12 s
2024-03-16 17:17:10.848974 MEMORY 15.470288896
Not applying filtering for rounds above first round
2024-03-16 17:17:10.850343 MEMORY 15.470288896
(Round 2) Computing density adapted affmat
2024-03-16 17:17:13.974891 MEMORY 15.471751168
Symmetrizing nearest neighbors
Computing betas for density adaptation
Computing normalizing denominators
(Round 2) Computing clustering
2024-03-16 17:18:44.983909 MEMORY 15.834927104
Beginning preprocessing + Leiden
2024-03-16 17:18:44.998687 MEMORY 15.834927104
Affmat transformed
2024-03-16 17:18:44.998861 MEMORY 15.834927104
sources, targets, weights extracted
2024-03-16 17:18:45.382465 MEMORY 15.950016512
About to launch parallel Leiden runs
2024-03-16 17:18:45.472091 MEMORY 15.892545536
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:   42.1s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:  2.6min finished
Parallel Leiden runs finished
2024-03-16 17:21:21.206558 MEMORY 15.892545536
Quality: 0.499057251872942
Quality: 0.49905825404926524
Got 6 clusters after round 2
Counts:
{1: 2155, 3: 1364, 0: 2376, 5: 1049, 4: 1279, 2: 1646}
2024-03-16 17:21:21.235987 MEMORY 15.71981312
(Round 2) Aggregating seqlets in each cluster
2024-03-16 17:21:21.236124 MEMORY 15.71981312
Aggregating for cluster 0 with 2376 seqlets
2024-03-16 17:21:21.239350 MEMORY 15.71981312
Skipped 1 due to duplicates
Trimming eliminated 0 seqlets out of 2375
Aggregating for cluster 1 with 2155 seqlets
2024-03-16 17:21:25.875844 MEMORY 15.719919616
Trimming eliminated 0 seqlets out of 2155
Aggregating for cluster 2 with 1646 seqlets
2024-03-16 17:21:29.470054 MEMORY 15.719919616
Trimming eliminated 0 seqlets out of 1646
Aggregating for cluster 3 with 1364 seqlets
2024-03-16 17:21:34.443187 MEMORY 15.719919616
Trimming eliminated 0 seqlets out of 1364
Aggregating for cluster 4 with 1279 seqlets
2024-03-16 17:21:36.701330 MEMORY 15.719919616
Trimming eliminated 0 seqlets out of 1279
Aggregating for cluster 5 with 1049 seqlets
2024-03-16 17:21:38.878347 MEMORY 15.719919616
Skipped 1 due to duplicates
Trimming eliminated 0 seqlets out of 1048
Got 6 clusters
Splitting into subclusters...
2024-03-16 17:21:40.613460 MEMORY 15.719919616
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 2375 out of 2375 | elapsed:    0.5s finished
Inspecting pattern 0 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 2375
[t-SNE] Computed conditional probabilities for sample 2000 / 2375
[t-SNE] Computed conditional probabilities for sample 2375 / 2375
[t-SNE] Mean sigma: 0.247769
Beginning preprocessing + Leiden
2024-03-16 17:21:43.675547 MEMORY 15.719968768
Affmat transformed
2024-03-16 17:21:43.708339 MEMORY 15.719981056
sources, targets, weights extracted
2024-03-16 17:21:43.732142 MEMORY 15.719981056
About to launch parallel Leiden runs
2024-03-16 17:21:43.745001 MEMORY 15.719981056
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    7.1s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   25.9s finished
Parallel Leiden runs finished
2024-03-16 17:22:09.674530 MEMORY 15.719981056
Quality: 0.5509600590811188
Quality: 0.5512864747916172
Quality: 0.5515954377454579
Quality: 0.5516236007533161
Quality: 0.5517432730841331
Quality: 0.5517964109867224
Quality: 0.5518308620037361
Got subclusters: Counter({0: 428, 2: 382, 1: 382, 3: 278, 4: 267, 5: 252, 6: 243, 7: 143})
On merging iteration 1
Numbers for each pattern pre-subsample: [428, 382, 382, 278, 267, 252, 243, 143]
Numbers after subsampling: [300, 300, 300, 278, 267, 252, 243, 143]
Computing sims for pattern 0
Computed sims for pattern 0 in 2.4160397052764893 s
Computing sims for pattern 1
Computed sims for pattern 1 in 2.5438079833984375 s
Computing sims for pattern 2
Computed sims for pattern 2 in 2.451397657394409 s
Computing sims for pattern 3
Computed sims for pattern 3 in 2.2788617610931396 s
Computing sims for pattern 4
Computed sims for pattern 4 in 2.2881245613098145 s
Computing sims for pattern 5
Computed sims for pattern 5 in 2.098393201828003 s
Computing sims for pattern 6
Computed sims for pattern 6 in 1.8737075328826904 s
Computing sims for pattern 7
Computed sims for pattern 7 in 1.4780621528625488 s
Cluster sizes
[428 382 382 278 267 252 243 143]
Cross-contamination matrix:
[[1.   0.68 0.1  0.99 0.29 0.28 0.76 0.3 ]
 [0.75 1.   0.14 0.97 0.44 0.21 0.79 0.55]
 [0.83 1.   1.   1.   0.92 0.66 0.93 0.95]
 [0.71 0.61 0.13 1.   0.33 0.26 0.62 0.35]
 [0.52 0.69 0.23 0.81 1.   0.28 0.54 0.68]
 [0.9  0.8  0.4  1.   0.65 1.   0.83 0.63]
 [0.8  0.75 0.15 0.92 0.33 0.26 1.   0.43]
 [0.64 0.91 0.34 0.94 0.79 0.36 0.77 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.93 0.76 0.97 0.82 0.84 0.95 0.84]
 [0.93 1.   0.84 0.95 0.9  0.79 0.96 0.95]
 [0.76 0.84 1.   0.84 0.83 0.75 0.84 0.87]
 [0.97 0.95 0.84 1.   0.87 0.87 0.96 0.9 ]
 [0.82 0.9  0.83 0.87 1.   0.74 0.85 0.91]
 [0.84 0.79 0.75 0.87 0.74 1.   0.8  0.75]
 [0.95 0.96 0.84 0.96 0.85 0.8  1.   0.89]
 [0.84 0.95 0.87 0.9  0.91 0.75 0.89 1.  ]]
Collapsing 0 & 3 with crosscontam 0.7108998639295696 and sim 0.9731515273469826
Collapsing 3 & 6 with crosscontam 0.6185280025035402 and sim 0.9588613008628174
Collapsing 1 & 6 with crosscontam 0.752543006469645 and sim 0.955125232210776
Collapsing 0 & 6 with crosscontam 0.7594664502362445 and sim 0.9543286136875009
Collapsing 1 & 3 with crosscontam 0.6079034982251763 and sim 0.9511505159160412
Collapsing 1 & 7 with crosscontam 0.5505754581714581 and sim 0.9497653797818212
Collapsing 0 & 1 with crosscontam 0.676405028148148 and sim 0.930389949691249
Collapsing 4 & 7 with crosscontam 0.6788623436447667 and sim 0.9091120254452811
Collapsing 1 & 4 with crosscontam 0.4363386256068802 and sim 0.9007485818820465
Trimming eliminated 0 seqlets out of 706
Trimming eliminated 0 seqlets out of 949
Trimming eliminated 0 seqlets out of 1331
Trimming eliminated 0 seqlets out of 1474
Trimming eliminated 0 seqlets out of 1741
Unmerged patterns remapping: OrderedDict([(2, 1), (5, 2)])
Time spent on merging iteration: 10.585010290145874
On merging iteration 2
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 1812 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 2108 out of 2155 | elapsed:    0.4s remaining:    0.0s
[Parallel(n_jobs=24)]: Done 2155 out of 2155 | elapsed:    0.4s finished
Numbers for each pattern pre-subsample: [1741, 382, 252]
Numbers after subsampling: [300, 300, 252]
Computing sims for pattern 0
Computed sims for pattern 0 in 0.7409570217132568 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.36972475051879883 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.2876276969909668 s
Cluster sizes
[1741  382  252]
Cross-contamination matrix:
[[1.   0.29 0.46]
 [0.98 1.   0.66]
 [0.85 0.4  1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.85 0.84]
 [0.85 1.   0.75]
 [0.84 0.75 1.  ]]
Inspecting pattern 1 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 2155
[t-SNE] Computed conditional probabilities for sample 2000 / 2155
[t-SNE] Computed conditional probabilities for sample 2155 / 2155
[t-SNE] Mean sigma: 0.239056
Beginning preprocessing + Leiden
2024-03-16 17:22:41.233208 MEMORY 15.7203456
Affmat transformed
2024-03-16 17:22:41.265960 MEMORY 15.7203456
sources, targets, weights extracted
2024-03-16 17:22:41.285612 MEMORY 15.7203456
About to launch parallel Leiden runs
2024-03-16 17:22:41.296321 MEMORY 15.7203456
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    6.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   26.2s finished
Parallel Leiden runs finished
2024-03-16 17:23:07.500374 MEMORY 15.7203456
Quality: 0.5327154612359368
Quality: 0.5358673741279745
Quality: 0.5374962328951584
Quality: 0.5377038071509253
Got subclusters: Counter({0: 513, 1: 397, 2: 271, 3: 263, 4: 207, 5: 198, 6: 122, 7: 121, 8: 63})
On merging iteration 1
Numbers for each pattern pre-subsample: [513, 397, 271, 263, 207, 198, 122, 121, 63]
Numbers after subsampling: [300, 300, 271, 263, 207, 198, 122, 121, 63]
Computing sims for pattern 0
Computed sims for pattern 0 in 2.779827356338501 s
Computing sims for pattern 1
Computed sims for pattern 1 in 2.8008008003234863 s
Computing sims for pattern 2
Computed sims for pattern 2 in 2.382657289505005 s
Computing sims for pattern 3
Computed sims for pattern 3 in 2.2810964584350586 s
Computing sims for pattern 4
Computed sims for pattern 4 in 2.1918604373931885 s
Computing sims for pattern 5
Computed sims for pattern 5 in 2.0568878650665283 s
Computing sims for pattern 6
Computed sims for pattern 6 in 1.2711737155914307 s
Computing sims for pattern 7
Computed sims for pattern 7 in 1.2723050117492676 s
Computing sims for pattern 8
Computed sims for pattern 8 in 2.3563947677612305 s
Cluster sizes
[513 397 271 263 207 198 122 121  63]
Cross-contamination matrix:
[[1.   0.42 0.66 0.7  0.31 0.75 0.38 0.38 0.06]
 [0.81 1.   1.   0.97 0.6  0.79 0.77 0.5  0.28]
 [0.71 0.64 1.   0.73 0.38 0.59 0.49 0.31 0.08]
 [0.76 0.53 0.73 1.   0.27 0.73 0.42 0.31 0.02]
 [0.65 0.57 0.8  0.75 1.   0.62 0.67 0.43 0.07]
 [0.85 0.45 0.63 0.76 0.34 1.   0.45 0.39 0.08]
 [0.82 0.84 0.98 0.96 0.74 0.86 1.   0.54 0.18]
 [1.   0.89 1.   1.   0.86 1.   0.9  1.   0.32]
 [0.35 0.52 0.54 0.42 0.25 0.39 0.34 0.25 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.88 0.91 0.94 0.84 0.96 0.88 0.91 0.42]
 [0.88 1.   0.98 0.95 0.88 0.9  0.94 0.84 0.68]
 [0.91 0.98 1.   0.97 0.9  0.92 0.95 0.85 0.64]
 [0.94 0.95 0.97 1.   0.91 0.96 0.96 0.9  0.51]
 [0.84 0.88 0.9  0.91 1.   0.88 0.91 0.87 0.53]
 [0.96 0.9  0.92 0.96 0.88 1.   0.92 0.92 0.45]
 [0.88 0.94 0.95 0.96 0.91 0.92 1.   0.88 0.59]
 [0.91 0.84 0.85 0.9  0.87 0.92 0.88 1.   0.47]
 [0.42 0.68 0.64 0.51 0.53 0.45 0.59 0.47 1.  ]]
Collapsing 1 & 2 with crosscontam 0.6353856904454585 and sim 0.9789303224891268
Collapsing 2 & 3 with crosscontam 0.7275188573359663 and sim 0.9674710011449902
Collapsing 3 & 6 with crosscontam 0.42135881714983614 and sim 0.9620152669132249
Collapsing 3 & 5 with crosscontam 0.7337345074331032 and sim 0.9619008595503695
Collapsing 0 & 5 with crosscontam 0.7544756311260756 and sim 0.9589042708969276
Collapsing 2 & 6 with crosscontam 0.4870617746609387 and sim 0.9531532864816451
Collapsing 1 & 3 with crosscontam 0.5320430859623206 and sim 0.9518187615951548
Collapsing 1 & 6 with crosscontam 0.7693813588342442 and sim 0.9442942503971622
Collapsing 0 & 3 with crosscontam 0.7007918360794252 and sim 0.937967654534542
Collapsing 5 & 6 with crosscontam 0.4484311106130394 and sim 0.9246949102137383
Collapsing 2 & 5 with crosscontam 0.5903523713995971 and sim 0.9214173831565313
Collapsing 5 & 7 with crosscontam 0.3872398572821285 and sim 0.9212327144829731
Collapsing 3 & 4 with crosscontam 0.2657138075570895 and sim 0.9133279586366319
Collapsing 0 & 2 with crosscontam 0.6643009244225775 and sim 0.9131114295408582
Collapsing 0 & 7 with crosscontam 0.3847658181818181 and sim 0.9064731988223356
Collapsing 4 & 6 with crosscontam 0.6724454357608007 and sim 0.9063722832756127
Collapsing 1 & 5 with crosscontam 0.45011787431846617 and sim 0.9012590701882529
Collapsing 3 & 7 with crosscontam 0.3122301839416737 and sim 0.9008095612585261
Collapsing 6 & 7 with crosscontam 0.5437699103296265 and sim 0.8826896130014382
Collapsing 1 & 4 with crosscontam 0.5693050933568953 and sim 0.8765284459425763
Trimming eliminated 0 seqlets out of 668
Trimming eliminated 0 seqlets out of 931
Trimming eliminated 0 seqlets out of 1053
Trimming eliminated 0 seqlets out of 1251
Trimming eliminated 0 seqlets out of 1764
Trimming eliminated 0 seqlets out of 1885
Trimming eliminated 0 seqlets out of 2092
Unmerged patterns remapping: OrderedDict([(8, 1)])
Time spent on merging iteration: 13.250943660736084
On merging iteration 2
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 1646 out of 1646 | elapsed:    0.2s finished
Numbers for each pattern pre-subsample: [2092, 63]
Numbers after subsampling: [300, 63]
Computing sims for pattern 0
Computed sims for pattern 0 in 0.271864652633667 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.10300087928771973 s
Cluster sizes
[2092   63]
Cross-contamination matrix:
[[1.   0.24]
 [0.41 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.55]
 [0.55 1.  ]]
Inspecting pattern 2 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 1646
[t-SNE] Computed conditional probabilities for sample 1646 / 1646
[t-SNE] Mean sigma: 0.333049
Beginning preprocessing + Leiden
2024-03-16 17:23:40.772677 MEMORY 15.7203456
Affmat transformed
2024-03-16 17:23:40.795913 MEMORY 15.7203456
sources, targets, weights extracted
2024-03-16 17:23:40.807506 MEMORY 15.7203456
About to launch parallel Leiden runs
2024-03-16 17:23:40.816281 MEMORY 15.7203456
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    4.2s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   13.9s finished
Parallel Leiden runs finished
2024-03-16 17:23:54.702824 MEMORY 15.7203456
Quality: 0.5581195374667357
Quality: 0.5585015547601305
Quality: 0.5595660384514314
Got subclusters: Counter({0: 336, 1: 310, 2: 245, 3: 183, 4: 167, 5: 159, 6: 129, 7: 117})
On merging iteration 1
Numbers for each pattern pre-subsample: [336, 310, 245, 183, 167, 159, 129, 117]
Numbers after subsampling: [300, 300, 245, 183, 167, 159, 129, 117]
Computing sims for pattern 0
Computed sims for pattern 0 in 2.4740445613861084 s
Computing sims for pattern 1
Computed sims for pattern 1 in 2.474634885787964 s
Computing sims for pattern 2
Computed sims for pattern 2 in 1.899500846862793 s
Computing sims for pattern 3
Computed sims for pattern 3 in 1.782999038696289 s
Computing sims for pattern 4
Computed sims for pattern 4 in 1.554208755493164 s
Computing sims for pattern 5
Computed sims for pattern 5 in 1.366076946258545 s
Computing sims for pattern 6
Computed sims for pattern 6 in 1.2441926002502441 s
Computing sims for pattern 7
Computed sims for pattern 7 in 1.111560583114624 s
Cluster sizes
[336 310 245 183 167 159 129 117]
Cross-contamination matrix:
[[1.   0.42 0.51 0.54 0.62 0.47 0.65 0.38]
 [0.46 1.   0.55 0.77 0.25 0.73 0.59 0.48]
 [0.66 0.65 1.   0.71 0.31 0.87 0.73 0.4 ]
 [0.46 0.63 0.48 1.   0.08 0.63 0.56 0.21]
 [0.5  0.18 0.17 0.09 1.   0.11 0.12 0.56]
 [0.36 0.53 0.56 0.57 0.1  1.   0.42 0.13]
 [0.71 0.61 0.64 0.72 0.19 0.62 1.   0.26]
 [0.53 0.63 0.47 0.43 0.86 0.33 0.39 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.69 0.79 0.75 0.74 0.73 0.84 0.63]
 [0.69 1.   0.78 0.81 0.52 0.81 0.79 0.76]
 [0.79 0.78 1.   0.83 0.44 0.89 0.87 0.57]
 [0.75 0.81 0.83 1.   0.33 0.85 0.85 0.58]
 [0.74 0.52 0.44 0.33 1.   0.31 0.39 0.83]
 [0.73 0.81 0.89 0.85 0.31 1.   0.82 0.58]
 [0.84 0.79 0.87 0.85 0.39 0.82 1.   0.55]
 [0.63 0.76 0.57 0.58 0.83 0.58 0.55 1.  ]]
Collapsing 2 & 5 with crosscontam 0.5594909586419354 and sim 0.888918817145575
Collapsing 2 & 6 with crosscontam 0.6426202911572574 and sim 0.8734979819923211
Trimming eliminated 0 seqlets out of 404
Trimming eliminated 0 seqlets out of 533
Unmerged patterns remapping: OrderedDict([(0, 1), (1, 2), (3, 3), (4, 4), (7, 5)])
Time spent on merging iteration: 2.5227363109588623
On merging iteration 2
Numbers for each pattern pre-subsample: [533, 336, 310, 183, 167, 117]
Numbers after subsampling: [300, 300, 300, 183, 167, 117]
Computing sims for pattern 0
Computed sims for pattern 0 in 1.7786378860473633 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.389340877532959 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.3856780529022217 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.2620813846588135 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.23909258842468262 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.1699962615966797 s
Cluster sizes
[533 336 310 183 167 117]
Cross-contamination matrix:
[[1.   0.76 0.82 0.92 0.35 0.47]
 [0.52 1.   0.42 0.54 0.62 0.38]
 [0.63 0.46 1.   0.77 0.25 0.48]
 [0.57 0.46 0.63 1.   0.08 0.21]
 [0.14 0.5  0.18 0.09 1.   0.56]
 [0.45 0.53 0.63 0.43 0.86 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.81 0.83 0.91 0.43 0.57]
 [0.81 1.   0.69 0.75 0.74 0.63]
 [0.83 0.69 1.   0.81 0.52 0.76]
 [0.91 0.75 0.81 1.   0.33 0.58]
 [0.43 0.74 0.52 0.33 1.   0.83]
 [0.57 0.63 0.76 0.58 0.83 1.  ]]
Collapsing 0 & 3 with crosscontam 0.5676355898826797 and sim 0.9062997663367854
Trimming eliminated 0 seqlets out of 716
Unmerged patterns remapping: OrderedDict([(1, 1), (2, 2), (4, 3), (5, 4)])
Time spent on merging iteration: 1.0402095317840576
On merging iteration 3
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 1290 tasks      | elapsed:    0.6s
[Parallel(n_jobs=24)]: Done 1364 out of 1364 | elapsed:    0.7s finished
Numbers for each pattern pre-subsample: [716, 336, 310, 167, 117]
Numbers after subsampling: [300, 300, 300, 167, 117]
Computing sims for pattern 0
Computed sims for pattern 0 in 1.437150239944458 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.37294554710388184 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.369168758392334 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.215562105178833 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.17075729370117188 s
Cluster sizes
[716 336 310 167 117]
Cross-contamination matrix:
[[1.   0.77 0.85 0.34 0.49]
 [0.5  1.   0.42 0.62 0.38]
 [0.66 0.46 1.   0.25 0.48]
 [0.12 0.5  0.18 1.   0.56]
 [0.45 0.53 0.63 0.86 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.82 0.84 0.43 0.59]
 [0.82 1.   0.69 0.74 0.63]
 [0.84 0.69 1.   0.52 0.76]
 [0.43 0.74 0.52 1.   0.83]
 [0.59 0.63 0.76 0.83 1.  ]]
Inspecting pattern 3 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 1364
[t-SNE] Computed conditional probabilities for sample 1364 / 1364
[t-SNE] Mean sigma: 0.250576
Beginning preprocessing + Leiden
2024-03-16 17:24:19.506365 MEMORY 15.720349696
Affmat transformed
2024-03-16 17:24:19.524253 MEMORY 15.720349696
sources, targets, weights extracted
2024-03-16 17:24:19.537542 MEMORY 15.720349696
About to launch parallel Leiden runs
2024-03-16 17:24:19.546423 MEMORY 15.720349696
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    4.6s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   15.6s finished
Parallel Leiden runs finished
2024-03-16 17:24:35.181066 MEMORY 15.720349696
Quality: 0.44379535905727985
Quality: 0.44420462321947946
Quality: 0.4465272167377648
Quality: 0.4469699410284487
Quality: 0.44760977349921727
Quality: 0.44767090182321745
Quality: 0.44907226281189505
Quality: 0.44931233562067974
Got subclusters: Counter({0: 268, 1: 246, 2: 223, 3: 163, 4: 158, 5: 123, 6: 91, 7: 88, 8: 2, 9: 2})
On merging iteration 1
Numbers for each pattern pre-subsample: [268, 246, 223, 163, 158, 123, 91, 88, 2, 2]
Numbers after subsampling: [268, 246, 223, 163, 158, 123, 91, 88, 2, 2]
Computing sims for pattern 0
Computed sims for pattern 0 in 2.28422474861145 s
Computing sims for pattern 1
Computed sims for pattern 1 in 1.9651086330413818 s
Computing sims for pattern 2
Computed sims for pattern 2 in 2.330930233001709 s
Computing sims for pattern 3
Computed sims for pattern 3 in 1.5736017227172852 s
Computing sims for pattern 4
Computed sims for pattern 4 in 1.4999585151672363 s
Computing sims for pattern 5
Computed sims for pattern 5 in 1.2856404781341553 s
Computing sims for pattern 6
Computed sims for pattern 6 in 0.9773201942443848 s
Computing sims for pattern 7
Computed sims for pattern 7 in 0.9418091773986816 s
Computing sims for pattern 8
Computed sims for pattern 8 in 0.15314960479736328 s
Computing sims for pattern 9
Computed sims for pattern 9 in 0.14542150497436523 s
Cluster sizes
[268 246 223 163 158 123  91  88   2   2]
Cross-contamination matrix:
[[1.   1.   0.8  0.78 0.71 0.98 1.   0.32 0.35 0.49]
 [0.58 1.   0.51 0.57 0.46 0.69 0.72 0.08 0.14 0.17]
 [0.73 1.   1.   0.81 0.79 0.89 0.93 0.31 0.31 0.26]
 [0.67 1.   0.76 1.   0.75 0.91 0.88 0.22 0.39 0.29]
 [0.66 0.92 0.83 0.82 1.   0.95 0.87 0.35 0.41 0.41]
 [0.56 0.78 0.47 0.51 0.52 1.   0.66 0.07 0.12 0.14]
 [0.66 0.91 0.61 0.61 0.54 0.78 1.   0.09 0.08 0.13]
 [0.66 0.76 0.89 0.65 0.85 0.73 0.74 1.   0.28 0.4 ]
 [0.   0.   0.   0.   0.   0.   0.   0.   1.   0.  ]
 [0.   0.   0.   0.   0.   0.   0.   0.   0.   1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.94 0.9  0.88 0.88 0.92 0.93 0.66 0.7  0.69]
 [0.94 1.   0.96 0.97 0.93 0.97 0.97 0.68 0.78 0.7 ]
 [0.9  0.96 1.   0.95 0.95 0.9  0.94 0.81 0.76 0.64]
 [0.88 0.97 0.95 1.   0.95 0.95 0.93 0.72 0.77 0.66]
 [0.88 0.93 0.95 0.95 1.   0.94 0.92 0.77 0.72 0.62]
 [0.92 0.97 0.9  0.95 0.94 1.   0.95 0.66 0.75 0.64]
 [0.93 0.97 0.94 0.93 0.92 0.95 1.   0.67 0.72 0.66]
 [0.66 0.68 0.81 0.72 0.77 0.66 0.67 1.   0.56 0.44]
 [0.7  0.78 0.76 0.77 0.72 0.75 0.72 0.56 1.   0.68]
 [0.69 0.7  0.64 0.66 0.62 0.64 0.66 0.44 0.68 1.  ]]
Collapsing 1 & 3 with crosscontam 0.5666400170398838 and sim 0.9699112673362401
Collapsing 1 & 6 with crosscontam 0.7219049147343863 and sim 0.9686799311448488
Collapsing 1 & 5 with crosscontam 0.6883178953200679 and sim 0.9659875720473489
Collapsing 1 & 2 with crosscontam 0.5099509645367797 and sim 0.959943457378582
Collapsing 2 & 4 with crosscontam 0.7910271936939592 and sim 0.9529226620257031
Collapsing 2 & 3 with crosscontam 0.7638995731575553 and sim 0.9474899000541424
Collapsing 3 & 5 with crosscontam 0.5107246648184023 and sim 0.9467184931509867
Collapsing 5 & 6 with crosscontam 0.6646863183477567 and sim 0.9463994688286425
Collapsing 3 & 4 with crosscontam 0.7470862051678735 and sim 0.9456511571960124
Collapsing 0 & 1 with crosscontam 0.5789084690334001 and sim 0.9420231226896683
Collapsing 4 & 5 with crosscontam 0.5209396575475402 and sim 0.9389247264724104
Collapsing 2 & 6 with crosscontam 0.6108473667199867 and sim 0.9366052374837917
Collapsing 0 & 6 with crosscontam 0.6609629252417004 and sim 0.9347636374190335
Collapsing 1 & 4 with crosscontam 0.456589703630252 and sim 0.9346529335881909
Collapsing 3 & 6 with crosscontam 0.6057757569555957 and sim 0.9342403108324496
Collapsing 0 & 5 with crosscontam 0.5583115971564179 and sim 0.9229904752418403
Collapsing 4 & 6 with crosscontam 0.5361045415004533 and sim 0.9211927639204476
Collapsing 2 & 5 with crosscontam 0.4658301941377001 and sim 0.9025808296163592
Collapsing 0 & 2 with crosscontam 0.7298790203898369 and sim 0.9003327029299691
Collapsing 0 & 3 with crosscontam 0.6707415154868548 and sim 0.8831672427308721
Collapsing 0 & 4 with crosscontam 0.6648151119588404 and sim 0.8766373367927784
Trimming eliminated 0 seqlets out of 409
Trimming eliminated 0 seqlets out of 500
Trimming eliminated 0 seqlets out of 623
Trimming eliminated 0 seqlets out of 846
Trimming eliminated 0 seqlets out of 1004
Trimming eliminated 0 seqlets out of 1272
Unmerged patterns remapping: OrderedDict([(7, 1), (8, 2), (9, 3)])
Time spent on merging iteration: 6.611501216888428
On merging iteration 2
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 1279 out of 1279 | elapsed:    0.5s finished
Numbers for each pattern pre-subsample: [1272, 88, 2, 2]
Numbers after subsampling: [300, 88, 2, 2]
Computing sims for pattern 0
Computed sims for pattern 0 in 0.7839486598968506 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.14040589332580566 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.030424118041992188 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.02955317497253418 s
Cluster sizes
[1272   88    2    2]
Cross-contamination matrix:
[[1.   0.35 0.44 0.46]
 [0.75 1.   0.28 0.4 ]
 [0.   0.   1.   0.  ]
 [0.   0.   0.   1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.73 0.77 0.68]
 [0.73 1.   0.56 0.44]
 [0.77 0.56 1.   0.68]
 [0.68 0.44 0.68 1.  ]]
Inspecting pattern 4 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 1279
[t-SNE] Computed conditional probabilities for sample 1279 / 1279
[t-SNE] Mean sigma: 0.313211
Beginning preprocessing + Leiden
2024-03-16 17:24:58.043316 MEMORY 15.720349696
Affmat transformed
2024-03-16 17:24:58.058986 MEMORY 15.720349696
sources, targets, weights extracted
2024-03-16 17:24:58.068991 MEMORY 15.720349696
About to launch parallel Leiden runs
2024-03-16 17:24:58.076742 MEMORY 15.720349696
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    3.5s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   10.8s finished
Parallel Leiden runs finished
2024-03-16 17:25:08.894773 MEMORY 15.720349696
Quality: 0.560716622165949
Got subclusters: Counter({0: 246, 1: 216, 3: 198, 2: 198, 4: 192, 5: 139, 6: 88, 7: 2})
On merging iteration 1
Numbers for each pattern pre-subsample: [246, 216, 198, 198, 192, 139, 88, 2]
Numbers after subsampling: [246, 216, 198, 198, 192, 139, 88, 2]
Computing sims for pattern 0
Computed sims for pattern 0 in 1.5905532836914062 s
Computing sims for pattern 1
Computed sims for pattern 1 in 1.8101143836975098 s
Computing sims for pattern 2
Computed sims for pattern 2 in 1.6843116283416748 s
Computing sims for pattern 3
Computed sims for pattern 3 in 1.5979628562927246 s
Computing sims for pattern 4
Computed sims for pattern 4 in 1.5649621486663818 s
Computing sims for pattern 5
Computed sims for pattern 5 in 1.1963753700256348 s
Computing sims for pattern 6
Computed sims for pattern 6 in 0.7935161590576172 s
Computing sims for pattern 7
Computed sims for pattern 7 in 0.14865589141845703 s
Cluster sizes
[246 216 198 198 192 139  88   2]
Cross-contamination matrix:
[[1.   0.05 0.08 0.23 0.51 0.1  0.07 0.05]
 [0.31 1.   0.43 0.45 0.54 0.58 0.53 0.29]
 [0.61 0.65 1.   0.69 0.61 0.68 0.83 0.56]
 [0.89 0.43 0.54 1.   0.77 0.66 0.47 0.18]
 [1.   0.27 0.17 0.4  1.   0.28 0.34 0.16]
 [0.72 0.72 0.59 0.82 0.76 1.   0.8  0.57]
 [0.27 0.41 0.47 0.39 0.53 0.53 1.   0.35]
 [0.   0.   0.   0.   0.   0.01 0.   1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.52 0.66 0.79 0.93 0.7  0.5  0.37]
 [0.52 1.   0.68 0.65 0.63 0.78 0.67 0.5 ]
 [0.66 0.68 1.   0.8  0.7  0.76 0.74 0.47]
 [0.79 0.65 0.8  1.   0.78 0.88 0.69 0.4 ]
 [0.93 0.63 0.7  0.78 1.   0.75 0.6  0.47]
 [0.7  0.78 0.76 0.88 0.75 1.   0.8  0.53]
 [0.5  0.67 0.74 0.69 0.6  0.8  1.   0.49]
 [0.37 0.5  0.47 0.4  0.47 0.53 0.49 1.  ]]
Collapsing 0 & 4 with crosscontam 0.5093036690021373 and sim 0.9314294458864095
Collapsing 3 & 5 with crosscontam 0.6573459878617405 and sim 0.8801769268180055
Trimming eliminated 0 seqlets out of 438
Trimming eliminated 0 seqlets out of 337
Unmerged patterns remapping: OrderedDict([(1, 2), (2, 3), (6, 4), (7, 5)])
Time spent on merging iteration: 1.500016450881958
On merging iteration 2
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 930 tasks      | elapsed:    0.5s
[Parallel(n_jobs=24)]: Done 1048 out of 1048 | elapsed:    0.7s finished
Numbers for each pattern pre-subsample: [438, 337, 216, 198, 88, 2]
Numbers after subsampling: [300, 300, 216, 198, 88, 2]
Computing sims for pattern 0
Computed sims for pattern 0 in 1.5963568687438965 s
Computing sims for pattern 1
Computed sims for pattern 1 in 1.6100106239318848 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.6038804054260254 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.5490796566009521 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.2816617488861084 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.05980253219604492 s
Cluster sizes
[438 337 216 198  88   2]
Cross-contamination matrix:
[[1.   0.37 0.22 0.23 0.21 0.19]
 [0.82 1.   0.55 0.63 0.76 0.44]
 [0.39 0.41 1.   0.43 0.53 0.29]
 [0.56 0.69 0.65 1.   0.83 0.56]
 [0.28 0.47 0.41 0.47 1.   0.35]
 [0.   0.   0.   0.   0.   1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.76 0.54 0.66 0.51 0.42]
 [0.76 1.   0.63 0.81 0.76 0.47]
 [0.54 0.63 1.   0.68 0.67 0.5 ]
 [0.66 0.81 0.68 1.   0.74 0.47]
 [0.51 0.76 0.67 0.74 1.   0.49]
 [0.42 0.47 0.5  0.47 0.49 1.  ]]
Inspecting pattern 5 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 1048
[t-SNE] Computed conditional probabilities for sample 1048 / 1048
[t-SNE] Mean sigma: 0.250661
Beginning preprocessing + Leiden
2024-03-16 17:25:27.454117 MEMORY 15.720349696
Affmat transformed
2024-03-16 17:25:27.467134 MEMORY 15.720349696
sources, targets, weights extracted
2024-03-16 17:25:27.477694 MEMORY 15.720349696
About to launch parallel Leiden runs
2024-03-16 17:25:27.484869 MEMORY 15.720349696
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    3.2s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   10.6s finished
Parallel Leiden runs finished
2024-03-16 17:25:38.112369 MEMORY 15.720349696
Quality: 0.4644049272899532
Quality: 0.464750999496592
Quality: 0.4649326517690056
Got subclusters: Counter({0: 234, 1: 176, 2: 137, 3: 130, 4: 122, 5: 102, 6: 101, 7: 46})
On merging iteration 1
Numbers for each pattern pre-subsample: [234, 176, 137, 130, 122, 102, 101, 46]
Numbers after subsampling: [234, 176, 137, 130, 122, 102, 101, 46]
Computing sims for pattern 0
Computed sims for pattern 0 in 1.93357515335083 s
Computing sims for pattern 1
Computed sims for pattern 1 in 1.372387409210205 s
Computing sims for pattern 2
Computed sims for pattern 2 in 1.1613709926605225 s
Computing sims for pattern 3
Computed sims for pattern 3 in 1.0660781860351562 s
Computing sims for pattern 4
Computed sims for pattern 4 in 1.001354455947876 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.8352253437042236 s
Computing sims for pattern 6
Computed sims for pattern 6 in 0.8074069023132324 s
Computing sims for pattern 7
Computed sims for pattern 7 in 0.4385800361633301 s
Cluster sizes
[234 176 137 130 122 102 101  46]
Cross-contamination matrix:
[[1.   0.59 0.26 0.28 0.9  0.5  0.29 0.2 ]
 [0.87 1.   0.23 0.49 1.   0.57 0.46 0.24]
 [1.   0.9  1.   0.65 1.   0.88 0.76 0.63]
 [1.   1.   0.55 1.   1.   0.84 1.   0.58]
 [0.75 0.53 0.1  0.21 1.   0.42 0.16 0.1 ]
 [1.   0.88 0.55 0.62 1.   1.   0.62 0.54]
 [0.54 0.55 0.18 0.47 0.65 0.34 1.   0.16]
 [0.98 0.87 0.57 0.63 1.   0.84 0.63 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.93 0.88 0.89 0.97 0.93 0.82 0.84]
 [0.93 1.   0.8  0.96 0.97 0.91 0.89 0.83]
 [0.88 0.8  1.   0.79 0.84 0.83 0.74 0.8 ]
 [0.89 0.96 0.79 1.   0.94 0.9  0.9  0.85]
 [0.97 0.97 0.84 0.94 1.   0.95 0.87 0.86]
 [0.93 0.91 0.83 0.9  0.95 1.   0.83 0.9 ]
 [0.82 0.89 0.74 0.9  0.87 0.83 1.   0.79]
 [0.84 0.83 0.8  0.85 0.86 0.9  0.79 1.  ]]
Collapsing 0 & 4 with crosscontam 0.7481513569963705 and sim 0.9725314657021731
Collapsing 1 & 4 with crosscontam 0.5326150646970451 and sim 0.9715560975230699
Collapsing 1 & 3 with crosscontam 0.4915030427346414 and sim 0.9642669853597943
Collapsing 4 & 5 with crosscontam 0.41705680470275164 and sim 0.9497307601234486
Collapsing 3 & 4 with crosscontam 0.20810733734745002 and sim 0.9404398171471807
Collapsing 0 & 1 with crosscontam 0.5916367291627536 and sim 0.9292144957276027
Collapsing 0 & 5 with crosscontam 0.49829215064719734 and sim 0.9260974084219532
Collapsing 1 & 5 with crosscontam 0.5713575345204291 and sim 0.909962608150831
Collapsing 5 & 7 with crosscontam 0.5436132997571594 and sim 0.902780264857772
Collapsing 3 & 5 with crosscontam 0.6190472628290662 and sim 0.9001203253799849
Trimming eliminated 0 seqlets out of 356
Trimming eliminated 0 seqlets out of 532
Trimming eliminated 0 seqlets out of 662
Trimming eliminated 0 seqlets out of 764
Trimming eliminated 0 seqlets out of 810
Unmerged patterns remapping: OrderedDict([(2, 1), (6, 2)])
Time spent on merging iteration: 5.261102914810181
On merging iteration 2
Numbers for each pattern pre-subsample: [810, 137, 101]
Numbers after subsampling: [300, 137, 101]
Computing sims for pattern 0
Computed sims for pattern 0 in 0.6368708610534668 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.19926762580871582 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.14471435546875 s
Cluster sizes
[810 137 101]
Cross-contamination matrix:
[[1.   0.51 0.71]
 [0.92 1.   0.76]
 [0.51 0.18 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.85 0.88]
 [0.85 1.   0.74]
 [0.88 0.74 1.  ]]
Collapsing 0 & 2 with crosscontam 0.5054300312885911 and sim 0.8801044620135399
Collapsing 0 & 1 with crosscontam 0.5072147964314682 and sim 0.8548366610990205
Trimming eliminated 0 seqlets out of 911
Trimming eliminated 0 seqlets out of 1048
Unmerged patterns remapping: OrderedDict()
Time spent on merging iteration: 2.13643217086792
On merging iteration 3
Numbers for each pattern pre-subsample: [1048]
Numbers after subsampling: [300]
Computing sims for pattern 0
Computed sims for pattern 0 in 7.152557373046875e-06 s
Cluster sizes
[1048]
Cross-contamination matrix:
[[1.]]
Pattern-to-pattern sim matrix:
[[1.]]
Merging on 21 clusters
2024-03-16 17:25:54.822728 MEMORY 15.720349696
On merging iteration 1
Numbers for each pattern pre-subsample: [1741, 382, 252, 2092, 63, 716, 336, 310, 167, 117, 1272, 88, 2, 2, 438, 337, 216, 198, 88, 2, 1048]
Numbers after subsampling: [300, 300, 252, 300, 63, 300, 300, 300, 167, 117, 300, 88, 2, 2, 300, 300, 216, 198, 88, 2, 300]
Computing sims for pattern 0
Computed sims for pattern 0 in 6.659353971481323 s
Computing sims for pattern 1
Computed sims for pattern 1 in 6.569142818450928 s
Computing sims for pattern 2
Computed sims for pattern 2 in 4.968893527984619 s
Computing sims for pattern 3
Computed sims for pattern 3 in 8.145655870437622 s
Computing sims for pattern 4
Computed sims for pattern 4 in 1.7513823509216309 s
Computing sims for pattern 5
Computed sims for pattern 5 in 6.674403190612793 s
Computing sims for pattern 6
Computed sims for pattern 6 in 6.582183837890625 s
Computing sims for pattern 7
Computed sims for pattern 7 in 6.5311408042907715 s
Computing sims for pattern 8
Computed sims for pattern 8 in 3.834808349609375 s
Computing sims for pattern 9
Computed sims for pattern 9 in 2.89271879196167 s
Computing sims for pattern 10
Computed sims for pattern 10 in 6.487159729003906 s
Computing sims for pattern 11
Computed sims for pattern 11 in 2.2820851802825928 s
Computing sims for pattern 12
Computed sims for pattern 12 in 0.45003366470336914 s
Computing sims for pattern 13
Computed sims for pattern 13 in 0.44359803199768066 s
Computing sims for pattern 14
Computed sims for pattern 14 in 6.474342346191406 s
Computing sims for pattern 15
Computed sims for pattern 15 in 6.520249366760254 s
Computing sims for pattern 16
Computed sims for pattern 16 in 5.257091045379639 s
Computing sims for pattern 17
Computed sims for pattern 17 in 6.117477655410767 s
Computing sims for pattern 18
Computed sims for pattern 18 in 2.199259042739868 s
Computing sims for pattern 19
Computed sims for pattern 19 in 0.3891611099243164 s
Computing sims for pattern 20
Computed sims for pattern 20 in 6.216837167739868 s
Cluster sizes
[1741  382  252 2092   63  716  336  310  167  117 1272   88    2    2
  438  337  216  198   88    2 1048]
Cross-contamination matrix:
[[1.   0.29 0.46 0.74 0.06 0.11 0.03 0.21 0.01 0.04 0.71 0.09 0.33 0.2
  0.02 0.11 0.01 0.   0.01 0.13 0.82]
 [0.98 1.   0.66 0.61 0.02 0.2  0.18 0.35 0.14 0.2  0.76 0.21 0.39 0.89
  0.24 0.48 0.22 0.14 0.3  0.59 0.84]
 [0.85 0.4  1.   0.54 0.02 0.28 0.16 0.52 0.08 0.16 0.55 0.07 0.1  0.22
  0.08 0.21 0.07 0.04 0.05 0.67 0.72]
 [0.83 0.2  0.32 1.   0.24 0.12 0.03 0.21 0.03 0.06 0.77 0.18 0.38 0.25
  0.03 0.07 0.04 0.02 0.02 0.11 0.73]
 [0.19 0.   0.01 0.41 1.   0.04 0.04 0.03 0.03 0.03 0.17 0.3  0.02 0.09
  0.02 0.01 0.15 0.01 0.02 0.01 0.17]
 [0.73 0.37 0.74 0.58 0.25 1.   0.77 0.85 0.34 0.49 0.42 0.13 0.35 0.24
  0.14 0.12 0.26 0.24 0.24 0.87 0.67]
 [0.22 0.2  0.32 0.07 0.11 0.5  1.   0.42 0.62 0.38 0.08 0.14 0.12 0.09
  0.07 0.08 0.21 0.03 0.18 0.36 0.17]
 [0.83 0.42 0.91 0.64 0.11 0.66 0.46 1.   0.25 0.48 0.5  0.1  0.39 0.26
  0.22 0.11 0.29 0.22 0.29 1.   0.73]
 [0.11 0.12 0.13 0.06 0.06 0.12 0.5  0.18 1.   0.56 0.1  0.18 0.07 0.08
  0.06 0.17 0.08 0.07 0.23 0.07 0.08]
 [0.5  0.36 0.49 0.36 0.16 0.45 0.53 0.63 0.86 1.   0.31 0.2  0.48 0.27
  0.13 0.1  0.21 0.12 0.48 0.57 0.44]
 [0.89 0.34 0.4  0.85 0.25 0.11 0.04 0.19 0.06 0.07 1.   0.35 0.44 0.46
  0.07 0.14 0.09 0.05 0.02 0.12 0.81]
 [0.48 0.2  0.12 0.52 0.41 0.08 0.11 0.08 0.2  0.13 0.75 1.   0.28 0.4
  0.11 0.15 0.22 0.16 0.15 0.04 0.43]
 [0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   1.   0.
  0.   0.   0.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   1.
  0.   0.   0.   0.   0.   0.   0.  ]
 [0.12 0.13 0.1  0.06 0.05 0.05 0.04 0.08 0.08 0.04 0.1  0.08 0.03 0.1
  1.   0.37 0.22 0.23 0.21 0.19 0.08]
 [0.45 0.61 0.45 0.2  0.07 0.11 0.17 0.16 0.37 0.1  0.37 0.24 0.21 0.43
  0.82 1.   0.55 0.63 0.76 0.44 0.32]
 [0.15 0.25 0.14 0.08 0.12 0.07 0.11 0.15 0.16 0.07 0.17 0.22 0.25 0.06
  0.39 0.41 1.   0.43 0.53 0.29 0.08]
 [0.16 0.32 0.18 0.09 0.08 0.22 0.09 0.27 0.22 0.17 0.08 0.28 0.1  0.22
  0.56 0.69 0.65 1.   0.83 0.56 0.15]
 [0.03 0.26 0.14 0.02 0.04 0.11 0.1  0.14 0.22 0.16 0.09 0.11 0.13 0.03
  0.28 0.47 0.41 0.47 1.   0.35 0.03]
 [0.   0.   0.   0.   0.   0.   0.   0.01 0.   0.   0.   0.   0.   0.
  0.   0.   0.   0.   0.   1.   0.  ]
 [1.   0.42 0.59 0.86 0.17 0.22 0.07 0.33 0.05 0.11 0.86 0.21 0.52 0.39
  0.06 0.15 0.04 0.03 0.04 0.31 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.85 0.84 0.94 0.35 0.57 0.44 0.74 0.51 0.69 0.93 0.6  0.76 0.7
  0.23 0.45 0.27 0.18 0.28 0.49 0.98]
 [0.85 1.   0.75 0.7  0.17 0.43 0.42 0.62 0.53 0.63 0.74 0.44 0.64 0.73
  0.36 0.7  0.5  0.44 0.55 0.5  0.82]
 [0.84 0.75 1.   0.71 0.22 0.64 0.49 0.86 0.52 0.67 0.73 0.37 0.57 0.57
  0.18 0.5  0.29 0.19 0.29 0.71 0.83]
 [0.94 0.7  0.71 1.   0.55 0.49 0.34 0.66 0.44 0.61 0.93 0.64 0.77 0.65
  0.18 0.26 0.36 0.21 0.25 0.41 0.93]
 [0.35 0.17 0.22 0.55 1.   0.5  0.43 0.38 0.35 0.36 0.55 0.61 0.44 0.33
  0.23 0.26 0.54 0.33 0.36 0.36 0.34]
 [0.57 0.43 0.64 0.49 0.5  1.   0.82 0.84 0.43 0.59 0.37 0.3  0.34 0.25
  0.18 0.24 0.29 0.26 0.26 0.69 0.58]
 [0.44 0.42 0.49 0.34 0.43 0.82 1.   0.69 0.74 0.63 0.34 0.41 0.36 0.38
  0.04 0.12 0.39 0.13 0.27 0.55 0.42]
 [0.74 0.62 0.86 0.66 0.38 0.84 0.69 1.   0.52 0.76 0.57 0.39 0.49 0.49
  0.27 0.24 0.46 0.27 0.25 0.85 0.75]
 [0.51 0.53 0.52 0.44 0.35 0.43 0.74 0.52 1.   0.83 0.46 0.39 0.51 0.46
  0.06 0.34 0.27 0.3  0.39 0.42 0.48]
 [0.69 0.63 0.67 0.61 0.36 0.59 0.63 0.76 0.83 1.   0.54 0.28 0.63 0.57
  0.04 0.1  0.2  0.14 0.47 0.51 0.68]
 [0.93 0.74 0.73 0.93 0.55 0.37 0.34 0.57 0.46 0.54 1.   0.73 0.77 0.68
  0.27 0.41 0.33 0.22 0.24 0.31 0.93]
 [0.6  0.44 0.37 0.64 0.61 0.3  0.41 0.39 0.39 0.28 0.73 1.   0.56 0.44
  0.32 0.44 0.43 0.42 0.33 0.33 0.58]
 [0.76 0.64 0.57 0.77 0.44 0.34 0.36 0.49 0.51 0.63 0.77 0.56 1.   0.68
  0.06 0.25 0.44 0.09 0.43 0.48 0.75]
 [0.7  0.73 0.57 0.65 0.33 0.25 0.38 0.49 0.46 0.57 0.68 0.44 0.68 1.
  0.13 0.4  0.28 0.25 0.35 0.53 0.69]
 [0.23 0.36 0.18 0.18 0.23 0.18 0.04 0.27 0.06 0.04 0.27 0.32 0.06 0.13
  1.   0.76 0.54 0.66 0.51 0.42 0.19]
 [0.45 0.7  0.5  0.26 0.26 0.24 0.12 0.24 0.34 0.1  0.41 0.44 0.25 0.4
  0.76 1.   0.63 0.81 0.76 0.47 0.4 ]
 [0.27 0.5  0.29 0.36 0.54 0.29 0.39 0.46 0.27 0.2  0.33 0.43 0.44 0.28
  0.54 0.63 1.   0.68 0.67 0.5  0.23]
 [0.18 0.44 0.19 0.21 0.33 0.26 0.13 0.27 0.3  0.14 0.22 0.42 0.09 0.25
  0.66 0.81 0.68 1.   0.74 0.47 0.13]
 [0.28 0.55 0.29 0.25 0.36 0.26 0.27 0.25 0.39 0.47 0.24 0.33 0.43 0.35
  0.51 0.76 0.67 0.74 1.   0.49 0.29]
 [0.49 0.5  0.71 0.41 0.36 0.69 0.55 0.85 0.42 0.51 0.31 0.33 0.48 0.53
  0.42 0.47 0.5  0.47 0.49 1.   0.49]
 [0.98 0.82 0.83 0.93 0.34 0.58 0.42 0.75 0.48 0.68 0.93 0.58 0.75 0.69
  0.19 0.4  0.23 0.13 0.29 0.49 1.  ]]
Collapsing 0 & 20 with crosscontam 0.8247947985185187 and sim 0.9791019530131752
Collapsing 0 & 3 with crosscontam 0.7386796414814816 and sim 0.9408136270942336
Collapsing 0 & 10 with crosscontam 0.7142654316049382 and sim 0.9319982344264894
Collapsing 3 & 10 with crosscontam 0.772367005925926 and sim 0.9299080178700855
Collapsing 10 & 20 with crosscontam 0.809724606419753 and sim 0.9263254785631281
Collapsing 3 & 20 with crosscontam 0.7337369296296294 and sim 0.9260712895609726
Collapsing 2 & 7 with crosscontam 0.5182283468207978 and sim 0.8630995800573604
Trimming eliminated 0 seqlets out of 2789
Skipped 1 due to duplicates
Trimming eliminated 0 seqlets out of 4880
Skipped 2 due to duplicates
Trimming eliminated 0 seqlets out of 6150
Skipped 1 due to duplicates
Trimming eliminated 0 seqlets out of 561
Unmerged patterns remapping: OrderedDict([(1, 4), (4, 13), (5, 1), (6, 6), (8, 9), (9, 10), (11, 11), (12, 14), (13, 15), (14, 3), (15, 5), (16, 7), (17, 8), (18, 12), (19, 16)])
Time spent on merging iteration: 30.340456008911133
On merging iteration 2
Numbers for each pattern pre-subsample: [6150, 716, 561, 438, 382, 337, 336, 216, 198, 167, 117, 88, 88, 63, 2, 2, 2]
Numbers after subsampling: [300, 300, 300, 300, 300, 300, 300, 216, 198, 167, 117, 88, 88, 63, 2, 2, 2]
Computing sims for pattern 0
Computed sims for pattern 0 in 4.803963899612427 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.7111616134643555 s
Computing sims for pattern 2
Computed sims for pattern 2 in 4.917014122009277 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.715472936630249 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.6961047649383545 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.7123489379882812 s
Computing sims for pattern 6
Computed sims for pattern 6 in 0.7016184329986572 s
Computing sims for pattern 7
Computed sims for pattern 7 in 2.0596261024475098 s
Computing sims for pattern 8
Computed sims for pattern 8 in 0.5110104084014893 s
Computing sims for pattern 9
Computed sims for pattern 9 in 0.420529842376709 s
Computing sims for pattern 10
Computed sims for pattern 10 in 0.30629849433898926 s
Computing sims for pattern 11
Computed sims for pattern 11 in 0.25501394271850586 s
Computing sims for pattern 12
Computed sims for pattern 12 in 0.2536275386810303 s
Computing sims for pattern 13
Computed sims for pattern 13 in 0.18968653678894043 s
Computing sims for pattern 14
Computed sims for pattern 14 in 0.05292773246765137 s
Computing sims for pattern 15
Computed sims for pattern 15 in 0.049027442932128906 s
Computing sims for pattern 16
Computed sims for pattern 16 in 0.0475156307220459 s
Cluster sizes
[6150  716  561  438  382  337  336  216  198  167  117   88   88   63
    2    2    2]
Cross-contamination matrix:
[[1.   0.19 0.41 0.06 0.39 0.15 0.07 0.03 0.02 0.06 0.11 0.26 0.04 0.25
  0.53 0.42 0.22]
 [0.61 1.   0.8  0.14 0.37 0.12 0.77 0.26 0.24 0.34 0.49 0.13 0.24 0.25
  0.35 0.24 0.87]
 [0.85 0.6  1.   0.07 0.56 0.28 0.43 0.23 0.18 0.23 0.43 0.16 0.19 0.06
  0.17 0.39 1.  ]
 [0.09 0.05 0.05 1.   0.13 0.37 0.04 0.22 0.23 0.08 0.04 0.08 0.21 0.05
  0.03 0.1  0.19]
 [0.79 0.2  0.48 0.24 1.   0.48 0.18 0.22 0.14 0.14 0.2  0.21 0.3  0.02
  0.39 0.89 0.59]
 [0.33 0.11 0.29 0.82 0.61 1.   0.17 0.55 0.63 0.37 0.1  0.24 0.76 0.07
  0.21 0.43 0.44]
 [0.15 0.5  0.37 0.07 0.2  0.08 1.   0.21 0.03 0.62 0.38 0.14 0.18 0.11
  0.12 0.09 0.36]
 [0.04 0.07 0.19 0.39 0.25 0.41 0.11 1.   0.43 0.16 0.07 0.22 0.53 0.12
  0.25 0.06 0.29]
 [0.07 0.22 0.24 0.56 0.32 0.69 0.09 0.65 1.   0.22 0.17 0.28 0.83 0.08
  0.1  0.22 0.56]
 [0.09 0.12 0.15 0.06 0.12 0.17 0.5  0.08 0.07 1.   0.56 0.18 0.23 0.06
  0.07 0.08 0.07]
 [0.41 0.45 0.56 0.13 0.36 0.1  0.53 0.21 0.12 0.86 1.   0.2  0.48 0.16
  0.48 0.27 0.57]
 [0.53 0.08 0.1  0.11 0.2  0.15 0.11 0.22 0.16 0.2  0.13 1.   0.15 0.41
  0.28 0.4  0.04]
 [0.03 0.11 0.06 0.28 0.26 0.47 0.1  0.41 0.47 0.22 0.16 0.11 1.   0.04
  0.13 0.03 0.35]
 [0.28 0.04 0.01 0.02 0.   0.01 0.04 0.15 0.01 0.03 0.03 0.3  0.02 1.
  0.02 0.09 0.01]
 [0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.
  1.   0.   0.  ]
 [0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.
  0.   1.   0.  ]
 [0.   0.   0.01 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.
  0.   0.   1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.52 0.77 0.22 0.79 0.38 0.37 0.27 0.17 0.48 0.64 0.65 0.27 0.47
  0.78 0.69 0.43]
 [0.52 1.   0.77 0.18 0.43 0.24 0.82 0.29 0.26 0.43 0.59 0.3  0.26 0.5
  0.34 0.25 0.69]
 [0.77 0.77 1.   0.12 0.71 0.36 0.62 0.24 0.23 0.53 0.75 0.27 0.35 0.24
  0.51 0.56 0.8 ]
 [0.22 0.18 0.12 1.   0.36 0.76 0.04 0.54 0.66 0.06 0.04 0.32 0.51 0.23
  0.06 0.13 0.42]
 [0.79 0.43 0.71 0.36 1.   0.7  0.42 0.5  0.44 0.53 0.63 0.44 0.55 0.17
  0.64 0.73 0.5 ]
 [0.38 0.24 0.36 0.76 0.7  1.   0.12 0.63 0.81 0.34 0.1  0.44 0.76 0.26
  0.25 0.4  0.47]
 [0.37 0.82 0.62 0.04 0.42 0.12 1.   0.39 0.13 0.74 0.63 0.41 0.27 0.43
  0.36 0.38 0.55]
 [0.27 0.29 0.24 0.54 0.5  0.63 0.39 1.   0.68 0.27 0.2  0.43 0.67 0.54
  0.44 0.28 0.5 ]
 [0.17 0.26 0.23 0.66 0.44 0.81 0.13 0.68 1.   0.3  0.14 0.42 0.74 0.33
  0.09 0.25 0.47]
 [0.48 0.43 0.53 0.06 0.53 0.34 0.74 0.27 0.3  1.   0.83 0.39 0.39 0.35
  0.51 0.46 0.42]
 [0.64 0.59 0.75 0.04 0.63 0.1  0.63 0.2  0.14 0.83 1.   0.28 0.47 0.36
  0.63 0.57 0.51]
 [0.65 0.3  0.27 0.32 0.44 0.44 0.41 0.43 0.42 0.39 0.28 1.   0.33 0.61
  0.56 0.44 0.33]
 [0.27 0.26 0.35 0.51 0.55 0.76 0.27 0.67 0.74 0.39 0.47 0.33 1.   0.36
  0.43 0.35 0.49]
 [0.47 0.5  0.24 0.23 0.17 0.26 0.43 0.54 0.33 0.35 0.36 0.61 0.36 1.
  0.44 0.33 0.36]
 [0.78 0.34 0.51 0.06 0.64 0.25 0.36 0.44 0.09 0.51 0.63 0.56 0.43 0.44
  1.   0.68 0.48]
 [0.69 0.25 0.56 0.13 0.73 0.4  0.38 0.28 0.25 0.46 0.57 0.44 0.35 0.33
  0.68 1.   0.53]
 [0.43 0.69 0.8  0.42 0.5  0.47 0.55 0.5  0.47 0.42 0.51 0.33 0.49 0.36
  0.48 0.53 1.  ]]
Got 17 patterns after merging
2024-03-16 17:28:15.344990 MEMORY 15.720349696
Performing filtering
2024-03-16 17:28:15.345199 MEMORY 15.720349696
Got 14 patterns after filtering
2024-03-16 17:28:16.607335 MEMORY 15.720349696
Total time taken is 1426.77s
2024-03-16 17:28:16.607476 MEMORY 15.720349696
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 4080 tasks      | elapsed:    2.0s
[Parallel(n_jobs=24)]: Done 6150 out of 6150 | elapsed:    2.8s finished
/ru-auth/local/home/lzhao/anaconda3/envs/jupyter-ml-clone/lib/python3.9/site-packages/sklearn/manifold/_t_sne.py:691: FutureWarning: 'square_distances' has been introduced in 0.24 to help phase out legacy squaring behavior. The 'legacy' setting will be removed in 1.1 (renaming of 0.26), and the default setting will be changed to True. In 1.3, 'square_distances' will be removed altogether, and distances will be squared by default. Set 'square_distances'=True to silence this warning.
  warnings.warn(
/ru-auth/local/home/lzhao/anaconda3/envs/jupyter-ml-clone/lib/python3.9/site-packages/sklearn/neighbors/_base.py:175: EfficiencyWarning: Precomputed sparse input was not sorted by data.
  warnings.warn('Precomputed sparse input was not sorted by data.',
Applying subclustering to the final motifs
On pattern 0
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 6150 samples in 0.043s...
[t-SNE] Computed neighbors for 6150 samples in 0.004s...
[t-SNE] Computed conditional probabilities for sample 1000 / 6150
[t-SNE] Computed conditional probabilities for sample 2000 / 6150
[t-SNE] Computed conditional probabilities for sample 3000 / 6150
[t-SNE] Computed conditional probabilities for sample 4000 / 6150
[t-SNE] Computed conditional probabilities for sample 5000 / 6150
[t-SNE] Computed conditional probabilities for sample 6000 / 6150
[t-SNE] Computed conditional probabilities for sample 6150 / 6150
[t-SNE] Mean sigma: 0.229582
[t-SNE] Computed conditional probabilities in 0.439s
[t-SNE] Iteration 50: error = 83.0089264, gradient norm = 0.0000000 (50 iterations in 2.362s)
[t-SNE] Iteration 50: gradient norm 0.000000. Finished.
[t-SNE] KL divergence after 50 iterations with early exaggeration: 83.008926
[t-SNE] Iteration 100: error = 2.8050208, gradient norm = 0.0012270 (50 iterations in 2.353s)
[t-SNE] Iteration 150: error = 2.5833635, gradient norm = 0.0004178 (50 iterations in 2.338s)
[t-SNE] Iteration 200: error = 2.4907639, gradient norm = 0.0002441 (50 iterations in 2.313s)
[t-SNE] Iteration 250: error = 2.4379821, gradient norm = 0.0001579 (50 iterations in 1.482s)
[t-SNE] Iteration 300: error = 2.4047744, gradient norm = 0.0001210 (50 iterations in 0.444s)
[t-SNE] Iteration 350: error = 2.3816795, gradient norm = 0.0000934 (50 iterations in 0.447s)
[t-SNE] Iteration 400: error = 2.3649361, gradient norm = 0.0000783 (50 iterations in 0.450s)
[t-SNE] Iteration 450: error = 2.3526156, gradient norm = 0.0000631 (50 iterations in 0.491s)
[t-SNE] Iteration 500: error = 2.3430176, gradient norm = 0.0000528 (50 iterations in 0.451s)
[t-SNE] Iteration 550: error = 2.3353631, gradient norm = 0.0000460 (50 iterations in 0.566s)
[t-SNE] Iteration 600: error = 2.3291662, gradient norm = 0.0000404 (50 iterations in 0.599s)
[t-SNE] Iteration 650: error = 2.3241432, gradient norm = 0.0000383 (50 iterations in 0.460s)
[t-SNE] Iteration 700: error = 2.3202262, gradient norm = 0.0000376 (50 iterations in 0.470s)
[t-SNE] Iteration 750: error = 2.3173823, gradient norm = 0.0000327 (50 iterations in 0.466s)
[t-SNE] Iteration 800: error = 2.3149168, gradient norm = 0.0000314 (50 iterations in 0.490s)
[t-SNE] Iteration 850: error = 2.3128738, gradient norm = 0.0000284 (50 iterations in 0.452s)
[t-SNE] Iteration 900: error = 2.3110838, gradient norm = 0.0000279 (50 iterations in 0.449s)
[t-SNE] Iteration 950: error = 2.3095069, gradient norm = 0.0000257 (50 iterations in 0.446s)
[t-SNE] Iteration 1000: error = 2.3081460, gradient norm = 0.0000264 (50 iterations in 0.446s)
[t-SNE] KL divergence after 1000 iterations: 2.308146
[t-SNE] Computed conditional probabilities for sample 1000 / 6150
[t-SNE] Computed conditional probabilities for sample 2000 / 6150
[t-SNE] Computed conditional probabilities for sample 3000 / 6150
[t-SNE] Computed conditional probabilities for sample 4000 / 6150
[t-SNE] Computed conditional probabilities for sample 5000 / 6150
[t-SNE] Computed conditional probabilities for sample 6000 / 6150
[t-SNE] Computed conditional probabilities for sample 6150 / 6150
[t-SNE] Mean sigma: 0.229582
Beginning preprocessing + Leiden
2024-03-16 17:28:44.135821 MEMORY 15.780376576
Affmat transformed
2024-03-16 17:28:44.211200 MEMORY 15.78698752
sources, targets, weights extracted
2024-03-16 17:28:44.266191 MEMORY 15.787118592
About to launch parallel Leiden runs
2024-03-16 17:28:44.289216 MEMORY 15.787118592
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:   22.8s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:  1.5min finished
Parallel Leiden runs finished
2024-03-16 17:30:11.504750 MEMORY 15.787118592
Quality: 0.591344344684608
Quality: 0.5945152137113909
Quality: 0.5957614548531311
Quality: 0.5959619437129441
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 716 out of 716 | elapsed:    0.3s finished
Got subclusters: Counter({0: 1189, 1: 1112, 2: 949, 3: 944, 4: 581, 5: 564, 6: 454, 7: 327, 8: 30})
On pattern 1
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 716 samples in 0.005s...
[t-SNE] Computed neighbors for 716 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 716 / 716
[t-SNE] Mean sigma: 0.344694
[t-SNE] Computed conditional probabilities in 0.051s
[t-SNE] Iteration 50: error = 66.1020126, gradient norm = 0.4088894 (50 iterations in 0.067s)
[t-SNE] Iteration 100: error = 68.8401871, gradient norm = 0.3855998 (50 iterations in 0.065s)
[t-SNE] Iteration 150: error = 70.1578827, gradient norm = 0.3646712 (50 iterations in 0.063s)
[t-SNE] Iteration 200: error = 69.4073029, gradient norm = 0.3795758 (50 iterations in 0.067s)
[t-SNE] Iteration 250: error = 68.1706619, gradient norm = 0.3973183 (50 iterations in 0.066s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 68.170662
[t-SNE] Iteration 300: error = 1.5599576, gradient norm = 0.0029577 (50 iterations in 0.061s)
[t-SNE] Iteration 350: error = 1.5041121, gradient norm = 0.0010726 (50 iterations in 0.059s)
[t-SNE] Iteration 400: error = 1.4772515, gradient norm = 0.0007384 (50 iterations in 0.061s)
[t-SNE] Iteration 450: error = 1.4601421, gradient norm = 0.0003552 (50 iterations in 0.061s)
[t-SNE] Iteration 500: error = 1.4554040, gradient norm = 0.0001759 (50 iterations in 0.061s)
[t-SNE] Iteration 550: error = 1.4522643, gradient norm = 0.0003457 (50 iterations in 0.061s)
[t-SNE] Iteration 600: error = 1.4471971, gradient norm = 0.0002463 (50 iterations in 0.060s)
[t-SNE] Iteration 650: error = 1.4435749, gradient norm = 0.0005830 (50 iterations in 0.060s)
[t-SNE] Iteration 700: error = 1.4398438, gradient norm = 0.0002629 (50 iterations in 0.061s)
[t-SNE] Iteration 750: error = 1.4390198, gradient norm = 0.0000897 (50 iterations in 0.061s)
[t-SNE] Iteration 800: error = 1.4383882, gradient norm = 0.0000726 (50 iterations in 0.061s)
[t-SNE] Iteration 850: error = 1.4381040, gradient norm = 0.0000425 (50 iterations in 0.060s)
[t-SNE] Iteration 900: error = 1.4381682, gradient norm = 0.0000531 (50 iterations in 0.060s)
[t-SNE] Iteration 950: error = 1.4378614, gradient norm = 0.0000475 (50 iterations in 0.060s)
[t-SNE] Iteration 1000: error = 1.4375210, gradient norm = 0.0000447 (50 iterations in 0.058s)
[t-SNE] KL divergence after 1000 iterations: 1.437521
[t-SNE] Computed conditional probabilities for sample 716 / 716
[t-SNE] Mean sigma: 0.344694
Beginning preprocessing + Leiden
2024-03-16 17:30:14.401031 MEMORY 15.721611264
Affmat transformed
2024-03-16 17:30:14.409767 MEMORY 15.721611264
sources, targets, weights extracted
2024-03-16 17:30:14.414420 MEMORY 15.721611264
About to launch parallel Leiden runs
2024-03-16 17:30:14.420230 MEMORY 15.721611264
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.8s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    5.4s finished
Parallel Leiden runs finished
2024-03-16 17:30:19.871473 MEMORY 15.721611264
Quality: 0.4599025382077275
Quality: 0.45999234536621797
Quality: 0.460102883139124
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 514 out of 561 | elapsed:    0.1s remaining:    0.0s
[Parallel(n_jobs=24)]: Done 561 out of 561 | elapsed:    0.1s finished
Got subclusters: Counter({0: 155, 1: 146, 2: 134, 3: 114, 4: 95, 5: 72})
On pattern 2
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 561 samples in 0.004s...
[t-SNE] Computed neighbors for 561 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 561 / 561
[t-SNE] Mean sigma: 0.334873
[t-SNE] Computed conditional probabilities in 0.039s
[t-SNE] Iteration 50: error = 68.2572479, gradient norm = 0.4401513 (50 iterations in 0.063s)
[t-SNE] Iteration 100: error = 68.0773621, gradient norm = 0.4453345 (50 iterations in 0.056s)
[t-SNE] Iteration 150: error = 68.8583527, gradient norm = 0.4235967 (50 iterations in 0.055s)
[t-SNE] Iteration 200: error = 68.7826080, gradient norm = 0.4257078 (50 iterations in 0.057s)
[t-SNE] Iteration 250: error = 70.8638306, gradient norm = 0.4043611 (50 iterations in 0.056s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 70.863831
[t-SNE] Iteration 300: error = 1.2649208, gradient norm = 0.0031130 (50 iterations in 0.054s)
[t-SNE] Iteration 350: error = 1.1607392, gradient norm = 0.0014974 (50 iterations in 0.052s)
[t-SNE] Iteration 400: error = 1.1310790, gradient norm = 0.0006426 (50 iterations in 0.052s)
[t-SNE] Iteration 450: error = 1.1103905, gradient norm = 0.0005003 (50 iterations in 0.055s)
[t-SNE] Iteration 500: error = 1.0911521, gradient norm = 0.0008708 (50 iterations in 0.053s)
[t-SNE] Iteration 550: error = 1.0751644, gradient norm = 0.0003373 (50 iterations in 0.053s)
[t-SNE] Iteration 600: error = 1.0712969, gradient norm = 0.0001894 (50 iterations in 0.052s)
[t-SNE] Iteration 650: error = 1.0661082, gradient norm = 0.0002201 (50 iterations in 0.053s)
[t-SNE] Iteration 700: error = 1.0633165, gradient norm = 0.0002357 (50 iterations in 0.054s)
[t-SNE] Iteration 750: error = 1.0531172, gradient norm = 0.0004260 (50 iterations in 0.052s)
[t-SNE] Iteration 800: error = 1.0489422, gradient norm = 0.0004593 (50 iterations in 0.052s)
[t-SNE] Iteration 850: error = 1.0457187, gradient norm = 0.0001120 (50 iterations in 0.053s)
[t-SNE] Iteration 900: error = 1.0445596, gradient norm = 0.0001026 (50 iterations in 0.052s)
[t-SNE] Iteration 950: error = 1.0405484, gradient norm = 0.0003851 (50 iterations in 0.052s)
[t-SNE] Iteration 1000: error = 1.0313597, gradient norm = 0.0001528 (50 iterations in 0.053s)
[t-SNE] KL divergence after 1000 iterations: 1.031360
[t-SNE] Computed conditional probabilities for sample 561 / 561
[t-SNE] Mean sigma: 0.334873
Beginning preprocessing + Leiden
2024-03-16 17:30:21.745423 MEMORY 15.721611264
Affmat transformed
2024-03-16 17:30:21.752630 MEMORY 15.721611264
sources, targets, weights extracted
2024-03-16 17:30:21.756823 MEMORY 15.721611264
About to launch parallel Leiden runs
2024-03-16 17:30:21.762797 MEMORY 15.721611264
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.4s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    4.9s finished
Parallel Leiden runs finished
2024-03-16 17:30:26.634824 MEMORY 15.721611264
Quality: 0.48000861991123006
Quality: 0.48281647206990036
Quality: 0.4828214850915112
Quality: 0.48296328776617303
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 344 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 438 out of 438 | elapsed:    0.1s finished
Got subclusters: Counter({0: 129, 1: 129, 2: 117, 3: 104, 4: 82})
On pattern 3
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 438 samples in 0.003s...
[t-SNE] Computed neighbors for 438 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 438 / 438
[t-SNE] Mean sigma: 0.272560
[t-SNE] Computed conditional probabilities in 0.031s
[t-SNE] Iteration 50: error = 63.3312073, gradient norm = 0.4915951 (50 iterations in 0.047s)
[t-SNE] Iteration 100: error = 65.2778015, gradient norm = 0.4740845 (50 iterations in 0.047s)
[t-SNE] Iteration 150: error = 66.2582397, gradient norm = 0.4838007 (50 iterations in 0.048s)
[t-SNE] Iteration 200: error = 65.0741196, gradient norm = 0.4977925 (50 iterations in 0.048s)
[t-SNE] Iteration 250: error = 65.8056412, gradient norm = 0.4953055 (50 iterations in 0.048s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 65.805641
[t-SNE] Iteration 300: error = 1.0568945, gradient norm = 0.0043403 (50 iterations in 0.047s)
[t-SNE] Iteration 350: error = 0.9986304, gradient norm = 0.0011110 (50 iterations in 0.045s)
[t-SNE] Iteration 400: error = 0.9769316, gradient norm = 0.0008906 (50 iterations in 0.045s)
[t-SNE] Iteration 450: error = 0.9599372, gradient norm = 0.0011065 (50 iterations in 0.045s)
[t-SNE] Iteration 500: error = 0.9553096, gradient norm = 0.0004156 (50 iterations in 0.045s)
[t-SNE] Iteration 550: error = 0.9542596, gradient norm = 0.0001251 (50 iterations in 0.045s)
[t-SNE] Iteration 600: error = 0.9540975, gradient norm = 0.0000735 (50 iterations in 0.045s)
[t-SNE] Iteration 650: error = 0.9528061, gradient norm = 0.0001516 (50 iterations in 0.045s)
[t-SNE] Iteration 700: error = 0.9523883, gradient norm = 0.0003102 (50 iterations in 0.048s)
[t-SNE] Iteration 750: error = 0.9523043, gradient norm = 0.0000870 (50 iterations in 0.045s)
[t-SNE] Iteration 800: error = 0.9520609, gradient norm = 0.0001039 (50 iterations in 0.045s)
[t-SNE] Iteration 850: error = 0.9521481, gradient norm = 0.0000773 (50 iterations in 0.047s)
[t-SNE] Iteration 900: error = 0.9519964, gradient norm = 0.0000491 (50 iterations in 0.047s)
[t-SNE] Iteration 950: error = 0.9520095, gradient norm = 0.0000643 (50 iterations in 0.048s)
[t-SNE] Iteration 1000: error = 0.9518921, gradient norm = 0.0000395 (50 iterations in 0.045s)
[t-SNE] KL divergence after 1000 iterations: 0.951892
[t-SNE] Computed conditional probabilities for sample 438 / 438
[t-SNE] Mean sigma: 0.272560
Beginning preprocessing + Leiden
2024-03-16 17:30:28.221540 MEMORY 15.721611264
Affmat transformed
2024-03-16 17:30:28.227190 MEMORY 15.721611264
sources, targets, weights extracted
2024-03-16 17:30:28.230796 MEMORY 15.721611264
About to launch parallel Leiden runs
2024-03-16 17:30:28.235962 MEMORY 15.721611264
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.3s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    3.7s finished
Parallel Leiden runs finished
2024-03-16 17:30:31.910756 MEMORY 15.721611264
Quality: 0.41830527936147116
Quality: 0.4202196063681402
Quality: 0.4204107678430897
Quality: 0.4205413085350544
Quality: 0.42063274141047813
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 382 out of 382 | elapsed:    0.1s finished
Got subclusters: Counter({0: 92, 1: 91, 2: 87, 3: 84, 4: 73, 5: 6, 6: 3, 7: 2})
On pattern 4
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 382 samples in 0.003s...
[t-SNE] Computed neighbors for 382 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 382 / 382
[t-SNE] Mean sigma: 0.355021
[t-SNE] Computed conditional probabilities in 0.026s
[t-SNE] Iteration 50: error = 63.8782196, gradient norm = 0.5029267 (50 iterations in 0.055s)
[t-SNE] Iteration 100: error = 66.4077530, gradient norm = 0.4690968 (50 iterations in 0.044s)
[t-SNE] Iteration 150: error = 65.9862747, gradient norm = 0.5169825 (50 iterations in 0.044s)
[t-SNE] Iteration 200: error = 67.9836502, gradient norm = 0.4784142 (50 iterations in 0.046s)
[t-SNE] Iteration 250: error = 68.9580078, gradient norm = 0.4638938 (50 iterations in 0.045s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 68.958008
[t-SNE] Iteration 300: error = 1.1861244, gradient norm = 0.0045424 (50 iterations in 0.047s)
[t-SNE] Iteration 350: error = 1.0643191, gradient norm = 0.0024040 (50 iterations in 0.042s)
[t-SNE] Iteration 400: error = 0.9896841, gradient norm = 0.0011214 (50 iterations in 0.045s)
[t-SNE] Iteration 450: error = 0.9496985, gradient norm = 0.0011412 (50 iterations in 0.042s)
[t-SNE] Iteration 500: error = 0.9351249, gradient norm = 0.0007899 (50 iterations in 0.042s)
[t-SNE] Iteration 550: error = 0.9243066, gradient norm = 0.0004808 (50 iterations in 0.043s)
[t-SNE] Iteration 600: error = 0.9210632, gradient norm = 0.0003148 (50 iterations in 0.043s)
[t-SNE] Iteration 650: error = 0.9195070, gradient norm = 0.0003012 (50 iterations in 0.044s)
[t-SNE] Iteration 700: error = 0.9150442, gradient norm = 0.0003060 (50 iterations in 0.042s)
[t-SNE] Iteration 750: error = 0.9120920, gradient norm = 0.0006298 (50 iterations in 0.041s)
[t-SNE] Iteration 800: error = 0.9087747, gradient norm = 0.0002321 (50 iterations in 0.043s)
[t-SNE] Iteration 850: error = 0.9068655, gradient norm = 0.0002703 (50 iterations in 0.042s)
[t-SNE] Iteration 900: error = 0.9047136, gradient norm = 0.0000881 (50 iterations in 0.046s)
[t-SNE] Iteration 950: error = 0.9044759, gradient norm = 0.0002777 (50 iterations in 0.042s)
[t-SNE] Iteration 1000: error = 0.9042840, gradient norm = 0.0000857 (50 iterations in 0.042s)
[t-SNE] KL divergence after 1000 iterations: 0.904284
[t-SNE] Computed conditional probabilities for sample 382 / 382
[t-SNE] Mean sigma: 0.355021
Beginning preprocessing + Leiden
2024-03-16 17:30:33.350655 MEMORY 15.721611264
Affmat transformed
2024-03-16 17:30:33.355758 MEMORY 15.721611264
sources, targets, weights extracted
2024-03-16 17:30:33.358540 MEMORY 15.721611264
About to launch parallel Leiden runs
2024-03-16 17:30:33.364422 MEMORY 15.721611264
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.0s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.9s finished
Parallel Leiden runs finished
2024-03-16 17:30:36.270209 MEMORY 15.721611264
Quality: 0.4476429531984949
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 337 out of 337 | elapsed:    0.1s finished
Got subclusters: Counter({0: 83, 1: 78, 2: 75, 3: 65, 4: 46, 5: 35})
On pattern 5
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 337 samples in 0.003s...
[t-SNE] Computed neighbors for 337 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 337 / 337
[t-SNE] Mean sigma: 0.369972
[t-SNE] Computed conditional probabilities in 0.023s
[t-SNE] Iteration 50: error = 65.2484207, gradient norm = 0.4630870 (50 iterations in 0.042s)
[t-SNE] Iteration 100: error = 62.5877228, gradient norm = 0.5148662 (50 iterations in 0.042s)
[t-SNE] Iteration 150: error = 66.1856537, gradient norm = 0.4840084 (50 iterations in 0.042s)
[t-SNE] Iteration 200: error = 64.4697342, gradient norm = 0.4950799 (50 iterations in 0.042s)
[t-SNE] Iteration 250: error = 63.9021072, gradient norm = 0.5071024 (50 iterations in 0.041s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 63.902107
[t-SNE] Iteration 300: error = 0.9597449, gradient norm = 0.0041391 (50 iterations in 0.043s)
[t-SNE] Iteration 350: error = 0.8757221, gradient norm = 0.0013620 (50 iterations in 0.041s)
[t-SNE] Iteration 400: error = 0.8560639, gradient norm = 0.0004379 (50 iterations in 0.041s)
[t-SNE] Iteration 450: error = 0.8536810, gradient norm = 0.0003576 (50 iterations in 0.040s)
[t-SNE] Iteration 500: error = 0.8503748, gradient norm = 0.0001871 (50 iterations in 0.040s)
[t-SNE] Iteration 550: error = 0.8500518, gradient norm = 0.0000621 (50 iterations in 0.040s)
[t-SNE] Iteration 600: error = 0.8499245, gradient norm = 0.0000855 (50 iterations in 0.038s)
[t-SNE] Iteration 650: error = 0.8499530, gradient norm = 0.0002011 (50 iterations in 0.038s)
[t-SNE] Iteration 700: error = 0.8467435, gradient norm = 0.0002797 (50 iterations in 0.038s)
[t-SNE] Iteration 750: error = 0.8457057, gradient norm = 0.0002572 (50 iterations in 0.040s)
[t-SNE] Iteration 800: error = 0.8456875, gradient norm = 0.0000323 (50 iterations in 0.040s)
[t-SNE] Iteration 850: error = 0.8455588, gradient norm = 0.0000419 (50 iterations in 0.039s)
[t-SNE] Iteration 900: error = 0.8453428, gradient norm = 0.0000924 (50 iterations in 0.039s)
[t-SNE] Iteration 950: error = 0.8452677, gradient norm = 0.0000824 (50 iterations in 0.040s)
[t-SNE] Iteration 1000: error = 0.8452481, gradient norm = 0.0001150 (50 iterations in 0.039s)
[t-SNE] KL divergence after 1000 iterations: 0.845248
[t-SNE] Computed conditional probabilities for sample 337 / 337
[t-SNE] Mean sigma: 0.369973
Beginning preprocessing + Leiden
2024-03-16 17:30:37.569382 MEMORY 15.721611264
Affmat transformed
2024-03-16 17:30:37.573827 MEMORY 15.721611264
sources, targets, weights extracted
2024-03-16 17:30:37.576205 MEMORY 15.721611264
About to launch parallel Leiden runs
2024-03-16 17:30:37.581603 MEMORY 15.721611264
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.0s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.9s finished
Parallel Leiden runs finished
2024-03-16 17:30:40.525854 MEMORY 15.721611264
Quality: 0.4124444855325065
Quality: 0.4125406029605047
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 336 out of 336 | elapsed:    0.1s finished
Got subclusters: Counter({0: 94, 1: 72, 2: 66, 3: 65, 4: 40})
On pattern 6
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 336 samples in 0.003s...
[t-SNE] Computed neighbors for 336 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 336 / 336
[t-SNE] Mean sigma: 0.351576
[t-SNE] Computed conditional probabilities in 0.023s
[t-SNE] Iteration 50: error = 63.1501465, gradient norm = 0.5037011 (50 iterations in 0.041s)
[t-SNE] Iteration 100: error = 67.1128540, gradient norm = 0.4790836 (50 iterations in 0.041s)
[t-SNE] Iteration 150: error = 67.3213348, gradient norm = 0.4743513 (50 iterations in 0.041s)
[t-SNE] Iteration 200: error = 66.0246124, gradient norm = 0.4816291 (50 iterations in 0.041s)
[t-SNE] Iteration 250: error = 66.5010376, gradient norm = 0.4787274 (50 iterations in 0.041s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 66.501038
[t-SNE] Iteration 300: error = 1.1378363, gradient norm = 0.0037059 (50 iterations in 0.039s)
[t-SNE] Iteration 350: error = 1.0289122, gradient norm = 0.0017413 (50 iterations in 0.039s)
[t-SNE] Iteration 400: error = 0.9319795, gradient norm = 0.0020044 (50 iterations in 0.039s)
[t-SNE] Iteration 450: error = 0.9047890, gradient norm = 0.0008928 (50 iterations in 0.039s)
[t-SNE] Iteration 500: error = 0.9004263, gradient norm = 0.0001534 (50 iterations in 0.038s)
[t-SNE] Iteration 550: error = 0.8990190, gradient norm = 0.0001727 (50 iterations in 0.039s)
[t-SNE] Iteration 600: error = 0.8986418, gradient norm = 0.0000831 (50 iterations in 0.037s)
[t-SNE] Iteration 650: error = 0.8986318, gradient norm = 0.0000702 (50 iterations in 0.038s)
[t-SNE] Iteration 700: error = 0.8986761, gradient norm = 0.0000733 (50 iterations in 0.037s)
[t-SNE] Iteration 750: error = 0.8986396, gradient norm = 0.0000883 (50 iterations in 0.039s)
[t-SNE] Iteration 800: error = 0.8986638, gradient norm = 0.0000699 (50 iterations in 0.038s)
[t-SNE] Iteration 850: error = 0.8986831, gradient norm = 0.0000754 (50 iterations in 0.039s)
[t-SNE] Iteration 900: error = 0.8986317, gradient norm = 0.0000602 (50 iterations in 0.037s)
[t-SNE] Iteration 950: error = 0.8986779, gradient norm = 0.0000732 (50 iterations in 0.040s)
[t-SNE] Iteration 1000: error = 0.8986521, gradient norm = 0.0000638 (50 iterations in 0.039s)
[t-SNE] KL divergence after 1000 iterations: 0.898652
[t-SNE] Computed conditional probabilities for sample 336 / 336
[t-SNE] Mean sigma: 0.351576
Beginning preprocessing + Leiden
2024-03-16 17:30:41.807434 MEMORY 15.721611264
Affmat transformed
2024-03-16 17:30:41.812015 MEMORY 15.721611264
sources, targets, weights extracted
2024-03-16 17:30:41.814319 MEMORY 15.721611264
About to launch parallel Leiden runs
2024-03-16 17:30:41.819772 MEMORY 15.721611264
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.0s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    3.1s finished
Parallel Leiden runs finished
2024-03-16 17:30:44.952089 MEMORY 15.721611264
Quality: 0.3953109343753783
Quality: 0.39591187923882526
Quality: 0.395936927299255
Quality: 0.3962865614022332
Quality: 0.3963821101800261
Quality: 0.3970010482440008
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 216 out of 216 | elapsed:    0.1s finished
Got subclusters: Counter({0: 93, 1: 73, 2: 72, 3: 56, 4: 42})
On pattern 7
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 216 samples in 0.002s...
[t-SNE] Computed neighbors for 216 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 216 / 216
[t-SNE] Mean sigma: 0.370363
[t-SNE] Computed conditional probabilities in 0.015s
[t-SNE] Iteration 50: error = 64.4486237, gradient norm = 0.4833399 (50 iterations in 0.034s)
[t-SNE] Iteration 100: error = 64.9061661, gradient norm = 0.4607967 (50 iterations in 0.029s)
[t-SNE] Iteration 150: error = 58.9190826, gradient norm = 0.5519763 (50 iterations in 0.028s)
[t-SNE] Iteration 200: error = 64.0755615, gradient norm = 0.4712600 (50 iterations in 0.028s)
[t-SNE] Iteration 250: error = 63.4180412, gradient norm = 0.4390994 (50 iterations in 0.028s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 63.418041
[t-SNE] Iteration 300: error = 0.9971596, gradient norm = 0.0079936 (50 iterations in 0.027s)
[t-SNE] Iteration 350: error = 0.7493278, gradient norm = 0.0025318 (50 iterations in 0.027s)
[t-SNE] Iteration 400: error = 0.7397121, gradient norm = 0.0004718 (50 iterations in 0.028s)
[t-SNE] Iteration 450: error = 0.7398348, gradient norm = 0.0001122 (50 iterations in 0.028s)
[t-SNE] Iteration 500: error = 0.7399844, gradient norm = 0.0001654 (50 iterations in 0.027s)
[t-SNE] Iteration 550: error = 0.7399559, gradient norm = 0.0001576 (50 iterations in 0.026s)
[t-SNE] Iteration 600: error = 0.7399359, gradient norm = 0.0000815 (50 iterations in 0.026s)
[t-SNE] Iteration 650: error = 0.7399098, gradient norm = 0.0001403 (50 iterations in 0.026s)
[t-SNE] Iteration 700: error = 0.7398949, gradient norm = 0.0001411 (50 iterations in 0.026s)
[t-SNE] Iteration 750: error = 0.7399071, gradient norm = 0.0001008 (50 iterations in 0.028s)
[t-SNE] Iteration 750: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 750 iterations: 0.739907
[t-SNE] Computed conditional probabilities for sample 216 / 216
[t-SNE] Mean sigma: 0.370363
Beginning preprocessing + Leiden
2024-03-16 17:30:45.720409 MEMORY 15.721611264
Affmat transformed
2024-03-16 17:30:45.723479 MEMORY 15.721611264
sources, targets, weights extracted
2024-03-16 17:30:45.724751 MEMORY 15.721611264
About to launch parallel Leiden runs
2024-03-16 17:30:45.730010 MEMORY 15.721611264
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.9s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.4s finished
Parallel Leiden runs finished
2024-03-16 17:30:48.136016 MEMORY 15.721611264
Quality: 0.3037805302252084
Quality: 0.304077027319123
Quality: 0.3048337414529214
Quality: 0.3053055500274376
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 198 out of 198 | elapsed:    0.1s finished
Got subclusters: Counter({0: 56, 1: 50, 2: 36, 3: 35, 4: 18, 5: 14, 6: 5, 7: 2})
On pattern 8
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 198 samples in 0.002s...
[t-SNE] Computed neighbors for 198 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 198 / 198
[t-SNE] Mean sigma: 0.413424
[t-SNE] Computed conditional probabilities in 0.013s
[t-SNE] Iteration 50: error = 59.4279137, gradient norm = 0.5546295 (50 iterations in 0.455s)
[t-SNE] Iteration 100: error = 59.2204704, gradient norm = 0.4931082 (50 iterations in 0.030s)
[t-SNE] Iteration 150: error = 60.1967087, gradient norm = 0.5032168 (50 iterations in 0.027s)
[t-SNE] Iteration 200: error = 61.0474968, gradient norm = 0.5007910 (50 iterations in 0.027s)
[t-SNE] Iteration 250: error = 63.2872467, gradient norm = 0.4483039 (50 iterations in 0.030s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 63.287247
[t-SNE] Iteration 300: error = 1.0400089, gradient norm = 0.0054538 (50 iterations in 0.030s)
[t-SNE] Iteration 350: error = 0.7676666, gradient norm = 0.0074419 (50 iterations in 0.027s)
[t-SNE] Iteration 400: error = 0.6649773, gradient norm = 0.0020560 (50 iterations in 0.028s)
[t-SNE] Iteration 450: error = 0.6475435, gradient norm = 0.0011901 (50 iterations in 0.027s)
[t-SNE] Iteration 500: error = 0.6440491, gradient norm = 0.0011346 (50 iterations in 0.028s)
[t-SNE] Iteration 550: error = 0.6269212, gradient norm = 0.0023531 (50 iterations in 0.026s)
[t-SNE] Iteration 600: error = 0.6256364, gradient norm = 0.0001451 (50 iterations in 0.030s)
[t-SNE] Iteration 650: error = 0.6257563, gradient norm = 0.0000934 (50 iterations in 0.026s)
[t-SNE] Iteration 700: error = 0.6256542, gradient norm = 0.0001490 (50 iterations in 0.026s)
[t-SNE] Iteration 750: error = 0.6256695, gradient norm = 0.0001805 (50 iterations in 0.026s)
[t-SNE] Iteration 800: error = 0.6256369, gradient norm = 0.0001217 (50 iterations in 0.029s)
[t-SNE] Iteration 850: error = 0.6256194, gradient norm = 0.0001297 (50 iterations in 0.028s)
[t-SNE] Iteration 900: error = 0.6259448, gradient norm = 0.0001636 (50 iterations in 0.028s)
[t-SNE] Iteration 950: error = 0.6258188, gradient norm = 0.0000841 (50 iterations in 0.031s)
[t-SNE] Iteration 1000: error = 0.6258135, gradient norm = 0.0000842 (50 iterations in 0.026s)
[t-SNE] KL divergence after 1000 iterations: 0.625813
[t-SNE] Computed conditional probabilities for sample 198 / 198
[t-SNE] Mean sigma: 0.413424
Beginning preprocessing + Leiden
2024-03-16 17:30:49.445162 MEMORY 15.721611264
Affmat transformed
2024-03-16 17:30:49.448137 MEMORY 15.721611264
sources, targets, weights extracted
2024-03-16 17:30:49.449239 MEMORY 15.721611264
About to launch parallel Leiden runs
2024-03-16 17:30:49.453626 MEMORY 15.721611264
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.8s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.3s finished
Parallel Leiden runs finished
2024-03-16 17:30:51.736292 MEMORY 15.721611264
Quality: 0.3573318979133786
Quality: 0.3575414673538868
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 120 out of 167 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=24)]: Done 167 out of 167 | elapsed:    0.1s finished
Got subclusters: Counter({0: 43, 1: 38, 2: 34, 3: 30, 4: 27, 5: 24, 6: 2})
On pattern 9
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 167 samples in 0.002s...
[t-SNE] Computed neighbors for 167 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 167 / 167
[t-SNE] Mean sigma: 0.380706
[t-SNE] Computed conditional probabilities in 0.011s
[t-SNE] Iteration 50: error = 61.3587265, gradient norm = 0.4866435 (50 iterations in 0.557s)
[t-SNE] Iteration 100: error = 58.8212242, gradient norm = 0.5343913 (50 iterations in 0.025s)
[t-SNE] Iteration 150: error = 59.1772499, gradient norm = 0.5267525 (50 iterations in 0.025s)
[t-SNE] Iteration 200: error = 60.4305267, gradient norm = 0.4686004 (50 iterations in 0.025s)
[t-SNE] Iteration 250: error = 61.0696335, gradient norm = 0.5252792 (50 iterations in 0.025s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 61.069633
[t-SNE] Iteration 300: error = 0.8226534, gradient norm = 0.0091476 (50 iterations in 0.026s)
[t-SNE] Iteration 350: error = 0.5638541, gradient norm = 0.0039202 (50 iterations in 0.024s)
[t-SNE] Iteration 400: error = 0.5609916, gradient norm = 0.0001954 (50 iterations in 0.024s)
[t-SNE] Iteration 450: error = 0.5601717, gradient norm = 0.0008643 (50 iterations in 0.024s)
[t-SNE] Iteration 500: error = 0.5600387, gradient norm = 0.0002492 (50 iterations in 0.026s)
[t-SNE] Iteration 550: error = 0.5594345, gradient norm = 0.0003378 (50 iterations in 0.025s)
[t-SNE] Iteration 600: error = 0.5592954, gradient norm = 0.0003111 (50 iterations in 0.024s)
[t-SNE] Iteration 650: error = 0.5591946, gradient norm = 0.0003626 (50 iterations in 0.025s)
[t-SNE] Iteration 700: error = 0.5595733, gradient norm = 0.0004244 (50 iterations in 0.025s)
[t-SNE] Iteration 750: error = 0.5593626, gradient norm = 0.0003312 (50 iterations in 0.025s)
[t-SNE] Iteration 800: error = 0.5593037, gradient norm = 0.0003880 (50 iterations in 0.025s)
[t-SNE] Iteration 850: error = 0.5594525, gradient norm = 0.0003049 (50 iterations in 0.025s)
[t-SNE] Iteration 900: error = 0.5592471, gradient norm = 0.0003726 (50 iterations in 0.024s)
[t-SNE] Iteration 950: error = 0.5595456, gradient norm = 0.0003888 (50 iterations in 0.024s)
[t-SNE] Iteration 1000: error = 0.5592799, gradient norm = 0.0003264 (50 iterations in 0.026s)
[t-SNE] Iteration 1000: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 1000 iterations: 0.559280
[t-SNE] Computed conditional probabilities for sample 167 / 167
[t-SNE] Mean sigma: 0.380706
Beginning preprocessing + Leiden
2024-03-16 17:30:53.034835 MEMORY 15.721611264
Affmat transformed
2024-03-16 17:30:53.037348 MEMORY 15.721611264
sources, targets, weights extracted
2024-03-16 17:30:53.038240 MEMORY 15.721611264
About to launch parallel Leiden runs
2024-03-16 17:30:53.043108 MEMORY 15.721611264
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.8s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.2s finished
Parallel Leiden runs finished
2024-03-16 17:30:55.268937 MEMORY 15.721611264
Quality: 0.2528252212457276
Quality: 0.2537202272165141
Quality: 0.2562157116831064
Quality: 0.2594148585531913
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  70 out of 117 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=24)]: Done 117 out of 117 | elapsed:    0.0s finished
Got subclusters: Counter({0: 43, 1: 38, 2: 34, 3: 27, 4: 25})
On pattern 10
[t-SNE] Computing 116 nearest neighbors...
[t-SNE] Indexed 117 samples in 0.001s...
[t-SNE] Computed neighbors for 117 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 117 / 117
[t-SNE] Mean sigma: 0.491769
[t-SNE] Computed conditional probabilities in 0.006s
[t-SNE] Iteration 50: error = 52.0740738, gradient norm = 0.5712954 (50 iterations in 0.028s)
[t-SNE] Iteration 100: error = 51.4141121, gradient norm = 0.5857818 (50 iterations in 0.019s)
[t-SNE] Iteration 150: error = 53.3558502, gradient norm = 0.5450339 (50 iterations in 0.020s)
[t-SNE] Iteration 200: error = 51.0077477, gradient norm = 0.6100515 (50 iterations in 0.020s)
[t-SNE] Iteration 250: error = 52.1298943, gradient norm = 0.5127664 (50 iterations in 0.019s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 52.129894
[t-SNE] Iteration 300: error = 0.6519192, gradient norm = 0.0083926 (50 iterations in 0.019s)
[t-SNE] Iteration 350: error = 0.3543676, gradient norm = 0.0035822 (50 iterations in 0.020s)
[t-SNE] Iteration 400: error = 0.3477653, gradient norm = 0.0007021 (50 iterations in 0.018s)
[t-SNE] Iteration 450: error = 0.3484666, gradient norm = 0.0007912 (50 iterations in 0.019s)
[t-SNE] Iteration 500: error = 0.3480745, gradient norm = 0.0004115 (50 iterations in 0.019s)
[t-SNE] Iteration 550: error = 0.3481026, gradient norm = 0.0004368 (50 iterations in 0.018s)
[t-SNE] Iteration 600: error = 0.3482642, gradient norm = 0.0003389 (50 iterations in 0.018s)
[t-SNE] Iteration 650: error = 0.3483740, gradient norm = 0.0003241 (50 iterations in 0.019s)
[t-SNE] Iteration 700: error = 0.3483109, gradient norm = 0.0002855 (50 iterations in 0.018s)
[t-SNE] Iteration 750: error = 0.3483095, gradient norm = 0.0002937 (50 iterations in 0.018s)
[t-SNE] Iteration 750: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 750 iterations: 0.348310
[t-SNE] Computed conditional probabilities for sample 117 / 117
[t-SNE] Mean sigma: 0.491769
Beginning preprocessing + Leiden
2024-03-16 17:30:55.725133 MEMORY 15.721611264
Affmat transformed
2024-03-16 17:30:55.726693 MEMORY 15.721611264
sources, targets, weights extracted
2024-03-16 17:30:55.727255 MEMORY 15.721611264
About to launch parallel Leiden runs
2024-03-16 17:30:55.731187 MEMORY 15.721611264
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.9s finished
Parallel Leiden runs finished
2024-03-16 17:30:57.629500 MEMORY 15.721611264
Quality: 0.28921579122161445
Quality: 0.2897019300133068
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  88 out of  88 | elapsed:    0.0s finished
Got subclusters: Counter({0: 34, 1: 32, 2: 19, 3: 18, 4: 11, 5: 3})
On pattern 11
[t-SNE] Computing 87 nearest neighbors...
[t-SNE] Indexed 88 samples in 0.001s...
[t-SNE] Computed neighbors for 88 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 88 / 88
[t-SNE] Mean sigma: 0.510570
[t-SNE] Computed conditional probabilities in 0.004s
[t-SNE] Iteration 50: error = 54.3776588, gradient norm = 0.4890164 (50 iterations in 0.016s)
[t-SNE] Iteration 100: error = 49.6875916, gradient norm = 0.5549532 (50 iterations in 0.016s)
[t-SNE] Iteration 150: error = 53.1375656, gradient norm = 0.5297936 (50 iterations in 0.016s)
[t-SNE] Iteration 200: error = 49.4435806, gradient norm = 0.5449432 (50 iterations in 0.016s)
[t-SNE] Iteration 250: error = 54.3456459, gradient norm = 0.5494776 (50 iterations in 0.015s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 54.345646
[t-SNE] Iteration 300: error = 1.0229717, gradient norm = 0.0062587 (50 iterations in 0.015s)
[t-SNE] Iteration 350: error = 0.8440486, gradient norm = 0.0016719 (50 iterations in 0.018s)
[t-SNE] Iteration 400: error = 0.7652376, gradient norm = 0.0009691 (50 iterations in 0.016s)
[t-SNE] Iteration 450: error = 0.7130594, gradient norm = 0.0014212 (50 iterations in 0.015s)
[t-SNE] Iteration 500: error = 0.6625604, gradient norm = 0.0012594 (50 iterations in 0.015s)
[t-SNE] Iteration 550: error = 0.6290924, gradient norm = 0.0008604 (50 iterations in 0.014s)
[t-SNE] Iteration 600: error = 0.5700319, gradient norm = 0.0037352 (50 iterations in 0.014s)
[t-SNE] Iteration 650: error = 0.5277317, gradient norm = 0.0024065 (50 iterations in 0.014s)
[t-SNE] Iteration 700: error = 0.3256206, gradient norm = 0.0201421 (50 iterations in 0.017s)
[t-SNE] Iteration 750: error = 0.2410478, gradient norm = 0.0112268 (50 iterations in 0.014s)
[t-SNE] Iteration 800: error = 0.2417679, gradient norm = 0.0124025 (50 iterations in 0.015s)
[t-SNE] Iteration 850: error = 0.2434233, gradient norm = 0.0118498 (50 iterations in 0.014s)
[t-SNE] Iteration 900: error = 0.2430078, gradient norm = 0.0130557 (50 iterations in 0.015s)
[t-SNE] Iteration 950: error = 0.2453414, gradient norm = 0.0134962 (50 iterations in 0.015s)
[t-SNE] Iteration 1000: error = 0.2364267, gradient norm = 0.0040621 (50 iterations in 0.014s)
[t-SNE] KL divergence after 1000 iterations: 0.236427
[t-SNE] Computed conditional probabilities for sample 88 / 88
[t-SNE] Mean sigma: 0.510570
Beginning preprocessing + Leiden
2024-03-16 17:30:58.040464 MEMORY 15.721611264
Affmat transformed
2024-03-16 17:30:58.041722 MEMORY 15.721611264
sources, targets, weights extracted
2024-03-16 17:30:58.042266 MEMORY 15.721611264
About to launch parallel Leiden runs
2024-03-16 17:30:58.067217 MEMORY 15.721611264
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.6s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.8s finished
Parallel Leiden runs finished
2024-03-16 17:30:59.878849 MEMORY 15.721611264
Quality: 0.20316997729497974
Quality: 0.2032241996482796
Quality: 0.20394723410809742
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  88 out of  88 | elapsed:    0.0s finished
Got subclusters: Counter({0: 24, 1: 23, 2: 22, 3: 19})
On pattern 12
[t-SNE] Computing 87 nearest neighbors...
[t-SNE] Indexed 88 samples in 0.001s...
[t-SNE] Computed neighbors for 88 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 88 / 88
[t-SNE] Mean sigma: 0.490220
[t-SNE] Computed conditional probabilities in 0.004s
[t-SNE] Iteration 50: error = 49.1620407, gradient norm = 0.4553743 (50 iterations in 0.015s)
[t-SNE] Iteration 100: error = 47.3853798, gradient norm = 0.5714892 (50 iterations in 0.015s)
[t-SNE] Iteration 150: error = 51.3183174, gradient norm = 0.4760867 (50 iterations in 0.015s)
[t-SNE] Iteration 200: error = 50.3962784, gradient norm = 0.5392243 (50 iterations in 0.015s)
[t-SNE] Iteration 250: error = 50.8880730, gradient norm = 0.4883928 (50 iterations in 0.018s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 50.888073
[t-SNE] Iteration 300: error = 0.7149923, gradient norm = 0.0111354 (50 iterations in 0.018s)
[t-SNE] Iteration 350: error = 0.2441320, gradient norm = 0.0131950 (50 iterations in 0.015s)
[t-SNE] Iteration 400: error = 0.2258112, gradient norm = 0.0011098 (50 iterations in 0.016s)
[t-SNE] Iteration 450: error = 0.2259131, gradient norm = 0.0006489 (50 iterations in 0.015s)
[t-SNE] Iteration 500: error = 0.2258707, gradient norm = 0.0005142 (50 iterations in 0.015s)
[t-SNE] Iteration 550: error = 0.2259393, gradient norm = 0.0005607 (50 iterations in 0.015s)
[t-SNE] Iteration 600: error = 0.2258550, gradient norm = 0.0008375 (50 iterations in 0.015s)
[t-SNE] Iteration 650: error = 0.2256318, gradient norm = 0.0007597 (50 iterations in 0.015s)
[t-SNE] Iteration 700: error = 0.2259640, gradient norm = 0.0007046 (50 iterations in 0.015s)
[t-SNE] Iteration 750: error = 0.2256987, gradient norm = 0.0005470 (50 iterations in 0.015s)
[t-SNE] Iteration 800: error = 0.2257635, gradient norm = 0.0007308 (50 iterations in 0.015s)
[t-SNE] Iteration 850: error = 0.2258544, gradient norm = 0.0007665 (50 iterations in 0.016s)
[t-SNE] Iteration 900: error = 0.2258681, gradient norm = 0.0006133 (50 iterations in 0.027s)
[t-SNE] Iteration 950: error = 0.2258707, gradient norm = 0.0005749 (50 iterations in 0.015s)
[t-SNE] Iteration 1000: error = 0.2257412, gradient norm = 0.0005710 (50 iterations in 0.037s)
[t-SNE] Iteration 1000: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 1000 iterations: 0.225741
[t-SNE] Computed conditional probabilities for sample 88 / 88
[t-SNE] Mean sigma: 0.490220
Beginning preprocessing + Leiden
2024-03-16 17:31:00.322189 MEMORY 15.721611264
Affmat transformed
2024-03-16 17:31:00.323338 MEMORY 15.721611264
sources, targets, weights extracted
2024-03-16 17:31:00.323789 MEMORY 15.721611264
About to launch parallel Leiden runs
2024-03-16 17:31:00.327684 MEMORY 15.721611264
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.8s finished
Parallel Leiden runs finished
2024-03-16 17:31:02.171389 MEMORY 15.721611264
Quality: 0.19792517925171846
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  63 out of  63 | elapsed:    0.0s finished
Got subclusters: Counter({0: 30, 1: 29, 2: 16, 3: 13})
On pattern 13
[t-SNE] Computing 62 nearest neighbors...
[t-SNE] Indexed 63 samples in 0.000s...
[t-SNE] Computed neighbors for 63 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 63 / 63
[t-SNE] Mean sigma: 0.623426
[t-SNE] Computed conditional probabilities in 0.002s
[t-SNE] Iteration 50: error = 43.7435646, gradient norm = 0.5893414 (50 iterations in 0.012s)
[t-SNE] Iteration 100: error = 47.9364548, gradient norm = 0.6233728 (50 iterations in 0.012s)
[t-SNE] Iteration 150: error = 50.3994102, gradient norm = 0.5406842 (50 iterations in 0.012s)
[t-SNE] Iteration 200: error = 49.4221535, gradient norm = 0.4740148 (50 iterations in 0.012s)
[t-SNE] Iteration 250: error = 45.1047096, gradient norm = 0.4529156 (50 iterations in 0.012s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 45.104710
[t-SNE] Iteration 300: error = 0.7582116, gradient norm = 0.0013344 (50 iterations in 0.012s)
[t-SNE] Iteration 350: error = 0.6954060, gradient norm = 0.0010524 (50 iterations in 0.012s)
[t-SNE] Iteration 400: error = 0.6632608, gradient norm = 0.0004986 (50 iterations in 0.012s)
[t-SNE] Iteration 450: error = 0.6499988, gradient norm = 0.0005627 (50 iterations in 0.012s)
[t-SNE] Iteration 500: error = 0.6377444, gradient norm = 0.0004796 (50 iterations in 0.011s)
[t-SNE] Iteration 550: error = 0.6069531, gradient norm = 0.0016585 (50 iterations in 0.012s)
[t-SNE] Iteration 600: error = 0.5751008, gradient norm = 0.0009569 (50 iterations in 0.012s)
[t-SNE] Iteration 650: error = 0.6433468, gradient norm = 0.0358966 (50 iterations in 0.012s)
[t-SNE] Iteration 700: error = 0.5743673, gradient norm = 0.0023030 (50 iterations in 0.012s)
[t-SNE] Iteration 750: error = 0.5193913, gradient norm = 0.0011498 (50 iterations in 0.012s)
[t-SNE] Iteration 800: error = 0.4863575, gradient norm = 0.0009623 (50 iterations in 0.012s)
[t-SNE] Iteration 850: error = 0.4564736, gradient norm = 0.0009913 (50 iterations in 0.012s)
[t-SNE] Iteration 900: error = 0.8373530, gradient norm = 0.0018304 (50 iterations in 0.012s)
[t-SNE] Iteration 950: error = 0.6827664, gradient norm = 0.0006888 (50 iterations in 0.012s)
[t-SNE] Iteration 1000: error = 0.6136333, gradient norm = 0.0004500 (50 iterations in 0.011s)
[t-SNE] KL divergence after 1000 iterations: 0.613633
[t-SNE] Computed conditional probabilities for sample 63 / 63
[t-SNE] Mean sigma: 0.623426
Beginning preprocessing + Leiden
2024-03-16 17:31:02.471051 MEMORY 15.721611264
Affmat transformed
2024-03-16 17:31:02.471963 MEMORY 15.721611264
sources, targets, weights extracted
2024-03-16 17:31:02.472338 MEMORY 15.721611264
About to launch parallel Leiden runs
2024-03-16 17:31:02.491727 MEMORY 15.721611264
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.6s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.8s finished
Parallel Leiden runs finished
2024-03-16 17:31:04.254534 MEMORY 15.721611264
Quality: 0.11108636086796687
Got subclusters: Counter({0: 21, 2: 19, 1: 19, 3: 4})
On metacluster 1
Metacluster size 51128 limited to 20000
Relevant tasks:  ('head', 'testis')
Relevant signs:  (1, 1)
TfModiscoSeqletsToPatternsFactory: seed=1234
(Round 1) num seqlets: 20000
(Round 1) Computing coarse affmat
2024-03-16 17:31:06.628211 MEMORY 15.72161536
Beginning embedding computation
MEMORY 15.72161536
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 152 tasks      | elapsed:    2.0s
[Parallel(n_jobs=24)]: Done 402 tasks      | elapsed:    4.9s
[Parallel(n_jobs=24)]: Done 752 tasks      | elapsed:    8.7s
[Parallel(n_jobs=24)]: Done 1202 tasks      | elapsed:   13.6s
[Parallel(n_jobs=24)]: Done 1752 tasks      | elapsed:   19.6s
[Parallel(n_jobs=24)]: Done 2402 tasks      | elapsed:   26.6s
[Parallel(n_jobs=24)]: Done 3152 tasks      | elapsed:   34.8s
[Parallel(n_jobs=24)]: Done 4002 tasks      | elapsed:   44.0s
[Parallel(n_jobs=24)]: Done 4952 tasks      | elapsed:   54.3s
[Parallel(n_jobs=24)]: Done 6002 tasks      | elapsed:  1.1min
[Parallel(n_jobs=24)]: Done 7152 tasks      | elapsed:  1.3min
[Parallel(n_jobs=24)]: Done 8402 tasks      | elapsed:  1.5min
[Parallel(n_jobs=24)]: Done 9752 tasks      | elapsed:  1.8min
[Parallel(n_jobs=24)]: Done 11202 tasks      | elapsed:  2.0min
[Parallel(n_jobs=24)]: Done 12752 tasks      | elapsed:  2.3min
[Parallel(n_jobs=24)]: Done 14402 tasks      | elapsed:  2.6min
[Parallel(n_jobs=24)]: Done 16152 tasks      | elapsed:  3.0min
[Parallel(n_jobs=24)]: Done 18002 tasks      | elapsed:  3.3min
[Parallel(n_jobs=24)]: Done 19952 tasks      | elapsed:  3.7min
[Parallel(n_jobs=24)]: Done 20000 out of 20000 | elapsed:  3.7min finished
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 152 tasks      | elapsed:    1.9s
[Parallel(n_jobs=24)]: Done 402 tasks      | elapsed:    4.7s
[Parallel(n_jobs=24)]: Done 752 tasks      | elapsed:    8.7s
[Parallel(n_jobs=24)]: Done 1202 tasks      | elapsed:   13.7s
[Parallel(n_jobs=24)]: Done 1752 tasks      | elapsed:   20.0s
[Parallel(n_jobs=24)]: Done 2402 tasks      | elapsed:   27.3s
[Parallel(n_jobs=24)]: Done 3152 tasks      | elapsed:   35.7s
[Parallel(n_jobs=24)]: Done 4002 tasks      | elapsed:   45.2s
[Parallel(n_jobs=24)]: Done 4952 tasks      | elapsed:   55.7s
[Parallel(n_jobs=24)]: Done 6002 tasks      | elapsed:  1.1min
[Parallel(n_jobs=24)]: Done 7152 tasks      | elapsed:  1.3min
[Parallel(n_jobs=24)]: Done 8402 tasks      | elapsed:  1.6min
[Parallel(n_jobs=24)]: Done 9752 tasks      | elapsed:  1.8min
[Parallel(n_jobs=24)]: Done 11202 tasks      | elapsed:  2.1min
[Parallel(n_jobs=24)]: Done 12752 tasks      | elapsed:  2.4min
[Parallel(n_jobs=24)]: Done 14402 tasks      | elapsed:  2.7min
[Parallel(n_jobs=24)]: Done 16152 tasks      | elapsed:  3.0min
[Parallel(n_jobs=24)]: Done 18002 tasks      | elapsed:  3.4min
[Parallel(n_jobs=24)]: Done 19952 tasks      | elapsed:  3.7min
[Parallel(n_jobs=24)]: Done 20000 out of 20000 | elapsed:  3.8min finished
At the beginning of embedding call
2024-03-16 17:31:06.628435 MEMORY 15.72161536
before computing embeddings fwd
2024-03-16 17:31:06.637220 MEMORY 15.72161536
after computing embeddings fwd
2024-03-16 17:34:47.602964 MEMORY 15.901892608
after computing embeddings rev
2024-03-16 17:38:32.947352 MEMORY 16.663543808
before computing sparse embeddings fwd
2024-03-16 17:38:32.948460 MEMORY 16.663543808
Constructing csr matrix...
csr matrix made in 2.7139744758605957 s
after computing sparse embeddings fwd
2024-03-16 17:38:36.705965 MEMORY 16.833282048
before computing sparse embeddings rev
2024-03-16 17:38:36.706087 MEMORY 16.833282048
Constructing csr matrix...
csr matrix made in 2.7172188758850098 s
after computing sparse embeddings rev
2024-03-16 17:38:40.459353 MEMORY 16.9535488
Finished embedding computation in 456.37 s
MEMORY 16.231092224
Starting affinity matrix computations
MEMORY 16.230834176
Batching in slices of size 3355
  0%|          | 0/6 [00:00<?, ?it/s] 17%|â–ˆâ–‹        | 1/6 [00:07<00:39,  7.90s/it] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 2/6 [00:15<00:31,  7.91s/it] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 3/6 [00:23<00:23,  7.89s/it] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 4/6 [00:31<00:15,  7.88s/it] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 5/6 [00:39<00:07,  7.87s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:47<00:00,  7.81s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:47<00:00,  7.85s/it]
Finished affinity matrix computations in 47.28 s
MEMORY 16.181260288
(Round 1) Computed coarse affmat
2024-03-16 17:39:31.796196 MEMORY 15.940202496
(Round 1) Computing affinity matrix on nearest neighbors
2024-03-16 17:39:31.796372 MEMORY 15.940202496
Launching nearest neighbors affmat calculation job
MEMORY 16.226701312
Parallel runs completed
MEMORY 16.318357504
Job completed in: 72.03 s
MEMORY 16.3185664
Launching nearest neighbors affmat calculation job
MEMORY 16.318693376
Parallel runs completed
MEMORY 16.47671296
Job completed in: 72.36 s
MEMORY 16.4768768
(Round 1) Computed affinity matrix on nearest neighbors in 150.53 s
2024-03-16 17:42:02.327340 MEMORY 16.1903616
Filtered down to 19051 of 20000
(Round 1) Retained 19051 rows out of 20000 after filtering
2024-03-16 17:42:13.375595 MEMORY 16.190377984
(Round 1) Computing density adapted affmat
2024-03-16 17:42:18.935414 MEMORY 16.20754432
Symmetrizing nearest neighbors
Computing betas for density adaptation
Computing normalizing denominators
(Round 1) Computing clustering
2024-03-16 17:45:32.591018 MEMORY 17.386192896
Beginning preprocessing + Leiden
2024-03-16 17:45:32.618270 MEMORY 17.38622976
Affmat transformed
2024-03-16 17:45:32.618527 MEMORY 17.386266624
sources, targets, weights extracted
2024-03-16 17:45:33.307885 MEMORY 17.385402368
About to launch parallel Leiden runs
2024-03-16 17:45:33.481842 MEMORY 17.385345024
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:  2.0min
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:  8.9min finished
Parallel Leiden runs finished
2024-03-16 17:54:25.557293 MEMORY 17.3850624
Quality: 0.4457451970769438
Quality: 0.44810786557515725
Quality: 0.44844386436019634
Got 8 clusters after round 1
Counts:
{6: 1937, 0: 3265, 3: 2644, 1: 3175, 4: 2558, 5: 2484, 2: 2731, 7: 257}
2024-03-16 17:54:25.609923 MEMORY 17.385263104
(Round 1) Aggregating seqlets in each cluster
2024-03-16 17:54:25.610055 MEMORY 17.385263104
Aggregating for cluster 0 with 3265 seqlets
2024-03-16 17:54:25.623270 MEMORY 17.385271296
Skipped 4 seqlets that went over sequence edge during flank expansion
Skipped 45 due to duplicates
Trimming eliminated 0 seqlets out of 3216
Aggregating for cluster 1 with 3175 seqlets
2024-03-16 17:54:34.711138 MEMORY 17.385652224
Removed 1 duplicate seqlets
Skipped 22 due to duplicates
Trimming eliminated 0 seqlets out of 3152
Removed 1 duplicate seqlets
Aggregating for cluster 2 with 2731 seqlets
2024-03-16 17:54:44.957705 MEMORY 17.38602496
Skipped 1 seqlets that went over sequence edge during flank expansion
Skipped 10 due to duplicates
Trimming eliminated 0 seqlets out of 2720
Aggregating for cluster 3 with 2644 seqlets
2024-03-16 17:54:53.111902 MEMORY 17.38602496
Skipped 2 seqlets that went over sequence edge during flank expansion
Skipped 12 due to duplicates
Trimming eliminated 0 seqlets out of 2630
Aggregating for cluster 4 with 2558 seqlets
2024-03-16 17:55:00.846465 MEMORY 17.38602496
Skipped 3 seqlets that went over sequence edge during flank expansion
Skipped 8 due to duplicates
Trimming eliminated 0 seqlets out of 2547
Aggregating for cluster 5 with 2484 seqlets
2024-03-16 17:55:07.788789 MEMORY 17.38602496
Skipped 10 due to duplicates
Trimming eliminated 0 seqlets out of 2474
Removed 3 duplicate seqlets
Aggregating for cluster 6 with 1937 seqlets
2024-03-16 17:55:16.340050 MEMORY 17.386020864
Skipped 2 seqlets that went over sequence edge during flank expansion
Skipped 22 due to duplicates
Trimming eliminated 0 seqlets out of 1913
Aggregating for cluster 7 with 257 seqlets
2024-03-16 17:55:21.090587 MEMORY 17.386020864
Trimming eliminated 0 seqlets out of 257
Dropping cluster 7 with 257 seqlets due to sign disagreement
(Round 2) num seqlets: 18636
(Round 2) Computing coarse affmat
2024-03-16 17:55:23.660807 MEMORY 17.386020864
Beginning embedding computation
MEMORY 17.386020864
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
At the beginning of embedding call
2024-03-16 17:55:23.661077 MEMORY 17.386020864
before computing embeddings fwd
2024-03-16 17:55:23.670606 MEMORY 17.38602496
[Parallel(n_jobs=24)]: Done   3 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 416 tasks      | elapsed:    0.9s
[Parallel(n_jobs=24)]: Done 2408 tasks      | elapsed:    3.2s
[Parallel(n_jobs=24)]: Done 5208 tasks      | elapsed:    6.5s
[Parallel(n_jobs=24)]: Done 8808 tasks      | elapsed:   10.9s
[Parallel(n_jobs=24)]: Done 13208 tasks      | elapsed:   15.8s
[Parallel(n_jobs=24)]: Done 18408 tasks      | elapsed:   21.1s
[Parallel(n_jobs=24)]: Done 18636 out of 18636 | elapsed:   21.4s finished
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.8s
[Parallel(n_jobs=24)]: Done 2400 tasks      | elapsed:    2.9s
[Parallel(n_jobs=24)]: Done 5200 tasks      | elapsed:    5.8s
[Parallel(n_jobs=24)]: Done 8800 tasks      | elapsed:    9.6s
[Parallel(n_jobs=24)]: Done 13200 tasks      | elapsed:   14.3s
[Parallel(n_jobs=24)]: Done 18400 tasks      | elapsed:   19.9s
[Parallel(n_jobs=24)]: Done 18636 out of 18636 | elapsed:   20.2s finished
after computing embeddings fwd
2024-03-16 17:55:45.083094 MEMORY 17.920540672
after computing embeddings rev
2024-03-16 17:56:05.281180 MEMORY 18.682310656
before computing sparse embeddings fwd
2024-03-16 17:56:05.281290 MEMORY 18.682310656
Constructing csr matrix...
csr matrix made in 2.1478259563446045 s
after computing sparse embeddings fwd
2024-03-16 17:56:08.340000 MEMORY 18.683142144
before computing sparse embeddings rev
2024-03-16 17:56:08.340090 MEMORY 18.683142144
Constructing csr matrix...
csr matrix made in 2.0849852561950684 s
after computing sparse embeddings rev
2024-03-16 17:56:11.194092 MEMORY 18.683404288
Finished embedding computation in 50.61 s
MEMORY 18.01240576
Starting affinity matrix computations
MEMORY 18.011623424
Batching in slices of size 3601
  0%|          | 0/6 [00:00<?, ?it/s] 17%|â–ˆâ–‹        | 1/6 [00:09<00:48,  9.67s/it] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 2/6 [00:19<00:38,  9.54s/it] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 3/6 [00:28<00:28,  9.65s/it] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 4/6 [00:38<00:19,  9.62s/it] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 5/6 [00:48<00:09,  9.67s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:51<00:00,  7.40s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:51<00:00,  8.54s/it]
Finished affinity matrix computations in 51.38 s
MEMORY 18.01142272
(Round 2) Computed coarse affmat
2024-03-16 17:57:07.360480 MEMORY 18.010374144
(Round 2) Computing affinity matrix on nearest neighbors
2024-03-16 17:57:07.360633 MEMORY 18.010374144
Launching nearest neighbors affmat calculation job
MEMORY 18.010443776
Parallel runs completed
MEMORY 17.99104512
Job completed in: 32.85 s
MEMORY 17.988898816
Launching nearest neighbors affmat calculation job
MEMORY 17.988554752
Parallel runs completed
MEMORY 17.990946816
Job completed in: 32.75 s
MEMORY 17.99079936
(Round 2) Computed affinity matrix on nearest neighbors in 70.88 s
2024-03-16 17:58:18.245031 MEMORY 17.988554752
Not applying filtering for rounds above first round
2024-03-16 17:58:18.249076 MEMORY 17.988554752
(Round 2) Computing density adapted affmat
2024-03-16 17:58:23.447622 MEMORY 18.047750144
Symmetrizing nearest neighbors
Computing betas for density adaptation
Computing normalizing denominators
(Round 2) Computing clustering
2024-03-16 18:01:15.858416 MEMORY 17.891876864
Beginning preprocessing + Leiden
2024-03-16 18:01:15.885068 MEMORY 17.892032512
Affmat transformed
2024-03-16 18:01:15.885253 MEMORY 17.892032512
sources, targets, weights extracted
2024-03-16 18:01:16.579005 MEMORY 17.999122432
About to launch parallel Leiden runs
2024-03-16 18:01:16.743202 MEMORY 17.892220928
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:  1.7min
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:  5.5min finished
Parallel Leiden runs finished
2024-03-16 18:06:48.737942 MEMORY 17.892524032
Quality: 0.591940338184357
Quality: 0.5919406266582626
Got 7 clusters after round 2
Counts:
{1: 3116, 3: 2703, 6: 1949, 0: 3157, 5: 2403, 2: 2718, 4: 2590}
2024-03-16 18:06:48.784341 MEMORY 17.785102336
(Round 2) Aggregating seqlets in each cluster
2024-03-16 18:06:48.784480 MEMORY 17.785102336
Aggregating for cluster 0 with 3157 seqlets
2024-03-16 18:06:48.791069 MEMORY 17.78511872
Removed 1 duplicate seqlets
Skipped 8 due to duplicates
Trimming eliminated 0 seqlets out of 3148
Aggregating for cluster 1 with 3116 seqlets
2024-03-16 18:06:55.092693 MEMORY 17.785176064
Skipped 21 due to duplicates
Trimming eliminated 0 seqlets out of 3095
Aggregating for cluster 2 with 2718 seqlets
2024-03-16 18:07:01.323282 MEMORY 17.78518016
Removed 4 duplicate seqlets
Skipped 33 due to duplicates
Trimming eliminated 0 seqlets out of 2681
Aggregating for cluster 3 with 2703 seqlets
2024-03-16 18:07:06.322613 MEMORY 17.785409536
Skipped 3 due to duplicates
Trimming eliminated 0 seqlets out of 2700
Aggregating for cluster 4 with 2590 seqlets
2024-03-16 18:07:12.705696 MEMORY 17.785421824
Skipped 7 due to duplicates
Trimming eliminated 0 seqlets out of 2583
Aggregating for cluster 5 with 2403 seqlets
2024-03-16 18:07:17.700439 MEMORY 17.785421824
Skipped 4 due to duplicates
Trimming eliminated 0 seqlets out of 2399
Aggregating for cluster 6 with 1949 seqlets
2024-03-16 18:07:22.108418 MEMORY 17.785421824
Skipped 19 due to duplicates
Trimming eliminated 0 seqlets out of 1930
Got 7 clusters
Splitting into subclusters...
2024-03-16 18:07:25.966838 MEMORY 17.785421824
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 2985 tasks      | elapsed:    1.5s
[Parallel(n_jobs=24)]: Done 3148 out of 3148 | elapsed:    1.5s finished
Inspecting pattern 0 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 3148
[t-SNE] Computed conditional probabilities for sample 2000 / 3148
[t-SNE] Computed conditional probabilities for sample 3000 / 3148
[t-SNE] Computed conditional probabilities for sample 3148 / 3148
[t-SNE] Mean sigma: 0.318584
Beginning preprocessing + Leiden
2024-03-16 18:07:31.056175 MEMORY 17.785552896
Affmat transformed
2024-03-16 18:07:31.098204 MEMORY 17.785573376
sources, targets, weights extracted
2024-03-16 18:07:31.122172 MEMORY 17.785573376
About to launch parallel Leiden runs
2024-03-16 18:07:31.135517 MEMORY 17.785573376
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:   12.0s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   42.2s finished
Parallel Leiden runs finished
2024-03-16 18:08:13.306539 MEMORY 17.785573376
Quality: 0.5106477488850765
Quality: 0.5176298068529547
Quality: 0.518105356424755
Quality: 0.5207545607711966
Got subclusters: Counter({0: 665, 1: 628, 2: 606, 3: 536, 4: 408, 5: 186, 6: 93, 7: 26})
On merging iteration 1
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 3095 out of 3095 | elapsed:    1.4s finished
Numbers for each pattern pre-subsample: [665, 628, 606, 536, 408, 186, 93, 26]
Numbers after subsampling: [300, 300, 300, 300, 300, 186, 93, 26]
Computing sims for pattern 0
Computed sims for pattern 0 in 2.8955271244049072 s
Computing sims for pattern 1
Computed sims for pattern 1 in 2.863267183303833 s
Computing sims for pattern 2
Computed sims for pattern 2 in 2.9330544471740723 s
Computing sims for pattern 3
Computed sims for pattern 3 in 4.955191612243652 s
Computing sims for pattern 4
Computed sims for pattern 4 in 2.96954083442688 s
Computing sims for pattern 5
Computed sims for pattern 5 in 2.102552890777588 s
Computing sims for pattern 6
Computed sims for pattern 6 in 1.3390514850616455 s
Computing sims for pattern 7
Computed sims for pattern 7 in 0.5325682163238525 s
Cluster sizes
[665 628 606 536 408 186  93  26]
Cross-contamination matrix:
[[1.   0.46 0.49 0.38 0.66 0.28 0.56 0.39]
 [0.61 1.   0.54 0.55 0.73 0.35 0.67 0.55]
 [0.64 0.53 1.   0.73 0.56 0.45 0.73 0.55]
 [0.43 0.58 0.62 1.   0.44 0.51 0.6  0.43]
 [0.77 0.67 0.51 0.49 1.   0.24 0.6  0.49]
 [0.53 0.61 0.77 0.96 0.56 1.   0.68 0.57]
 [0.36 0.48 0.54 0.39 0.47 0.25 1.   0.23]
 [0.43 0.44 0.45 0.44 0.44 0.22 0.41 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.71 0.75 0.69 0.85 0.44 0.74 0.73]
 [0.71 1.   0.72 0.84 0.81 0.56 0.75 0.77]
 [0.75 0.72 1.   0.79 0.72 0.62 0.77 0.77]
 [0.69 0.84 0.79 1.   0.73 0.76 0.78 0.74]
 [0.85 0.81 0.72 0.73 1.   0.46 0.72 0.73]
 [0.44 0.56 0.62 0.76 0.46 1.   0.53 0.49]
 [0.74 0.75 0.77 0.78 0.72 0.53 1.   0.71]
 [0.73 0.77 0.77 0.74 0.73 0.49 0.71 1.  ]]
Inspecting pattern 1 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 3095
[t-SNE] Computed conditional probabilities for sample 2000 / 3095
[t-SNE] Computed conditional probabilities for sample 3000 / 3095
[t-SNE] Computed conditional probabilities for sample 3095 / 3095
[t-SNE] Mean sigma: 0.291625
Beginning preprocessing + Leiden
2024-03-16 18:08:39.770843 MEMORY 17.785982976
Affmat transformed
2024-03-16 18:08:39.808077 MEMORY 17.785982976
sources, targets, weights extracted
2024-03-16 18:08:39.838791 MEMORY 17.785982976
About to launch parallel Leiden runs
2024-03-16 18:08:39.855427 MEMORY 17.785962496
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:   10.2s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   37.8s finished
Parallel Leiden runs finished
2024-03-16 18:09:17.646381 MEMORY 17.785962496
Quality: 0.5228863484869034
Quality: 0.5252273782326198
Quality: 0.5253239005387907
Quality: 0.525405869202862
Quality: 0.5254218946092694
Quality: 0.5254383060285736
Got subclusters: Counter({0: 759, 1: 721, 2: 580, 3: 386, 4: 258, 5: 247, 6: 128, 7: 6, 9: 5, 8: 5})
On merging iteration 1
Numbers for each pattern pre-subsample: [759, 721, 580, 386, 258, 247, 128, 6, 5, 5]
Numbers after subsampling: [300, 300, 300, 300, 258, 247, 128, 6, 5, 5]
Computing sims for pattern 0
Computed sims for pattern 0 in 3.372952461242676 s
Computing sims for pattern 1
Computed sims for pattern 1 in 3.4788782596588135 s
Computing sims for pattern 2
Computed sims for pattern 2 in 3.4941372871398926 s
Computing sims for pattern 3
Computed sims for pattern 3 in 3.4538683891296387 s
Computing sims for pattern 4
Computed sims for pattern 4 in 2.6939563751220703 s
Computing sims for pattern 5
Computed sims for pattern 5 in 2.5474929809570312 s
Computing sims for pattern 6
Computed sims for pattern 6 in 1.680114507675171 s
Computing sims for pattern 7
Computed sims for pattern 7 in 0.350144624710083 s
Computing sims for pattern 8
Computed sims for pattern 8 in 0.34282493591308594 s
Computing sims for pattern 9
Computed sims for pattern 9 in 0.339519739151001 s
Cluster sizes
[759 721 580 386 258 247 128   6   5   5]
Cross-contamination matrix:
[[1.   0.46 0.59 0.43 0.49 0.71 0.33 0.43 0.51 0.78]
 [0.53 1.   0.63 0.59 0.57 0.88 0.62 0.6  0.69 0.99]
 [0.78 0.74 1.   0.56 0.63 0.91 0.58 0.34 0.61 0.92]
 [0.72 0.83 0.68 1.   0.59 0.81 0.35 0.31 0.59 0.85]
 [0.87 0.89 0.83 0.66 1.   0.97 0.62 0.79 0.73 0.91]
 [0.62 0.69 0.61 0.41 0.48 1.   0.51 0.37 0.55 0.87]
 [0.41 0.67 0.52 0.2  0.39 0.74 1.   0.27 0.5  0.69]
 [0.04 0.04 0.   0.   0.02 0.02 0.   1.   0.   0.01]
 [0.   0.   0.   0.   0.   0.   0.   0.   1.   0.  ]
 [0.01 0.01 0.   0.   0.   0.02 0.   0.   0.   1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.63 0.79 0.67 0.79 0.76 0.52 0.53 0.46 0.63]
 [0.63 1.   0.77 0.77 0.82 0.88 0.74 0.67 0.51 0.76]
 [0.79 0.77 1.   0.66 0.78 0.88 0.66 0.6  0.44 0.7 ]
 [0.67 0.77 0.66 1.   0.73 0.66 0.69 0.54 0.41 0.56]
 [0.79 0.82 0.78 0.73 1.   0.83 0.58 0.69 0.5  0.61]
 [0.76 0.88 0.88 0.66 0.83 1.   0.79 0.61 0.49 0.74]
 [0.52 0.74 0.66 0.69 0.58 0.79 1.   0.47 0.46 0.63]
 [0.53 0.67 0.6  0.54 0.69 0.61 0.47 1.   0.35 0.49]
 [0.46 0.51 0.44 0.41 0.5  0.49 0.46 0.35 1.   0.41]
 [0.63 0.76 0.7  0.56 0.61 0.74 0.63 0.49 0.41 1.  ]]
Collapsing 2 & 5 with crosscontam 0.6143679215134936 and sim 0.8813464438069716
Collapsing 1 & 5 with crosscontam 0.6886823560843183 and sim 0.8779301833681935
Trimming eliminated 0 seqlets out of 827
Skipped 1 due to duplicates
Trimming eliminated 0 seqlets out of 1547
Unmerged patterns remapping: OrderedDict([(0, 1), (3, 2), (4, 3), (6, 4), (7, 5), (8, 6), (9, 7)])
Time spent on merging iteration: 4.411414384841919
On merging iteration 2
Numbers for each pattern pre-subsample: [1547, 759, 386, 258, 128, 6, 5, 5]
Numbers after subsampling: [300, 300, 300, 258, 128, 6, 5, 5]
Computing sims for pattern 0
Computed sims for pattern 0 in 2.504653215408325 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.45427417755126953 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.4471585750579834 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.3518862724304199 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.22509145736694336 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.05220532417297363 s
Computing sims for pattern 6
Computed sims for pattern 6 in 0.050661563873291016 s
Computing sims for pattern 7
Computed sims for pattern 7 in 0.05071568489074707 s
Cluster sizes
[1547  759  386  258  128    6    5    5]
Cross-contamination matrix:
[[1.   0.78 0.71 0.75 0.75 0.68 0.77 1.  ]
 [0.56 1.   0.43 0.49 0.33 0.43 0.51 0.78]
 [0.79 0.72 1.   0.59 0.35 0.31 0.59 0.85]
 [0.9  0.87 0.66 1.   0.62 0.79 0.73 0.91]
 [0.63 0.41 0.2  0.39 1.   0.27 0.5  0.69]
 [0.03 0.04 0.   0.02 0.   1.   0.   0.01]
 [0.   0.   0.   0.   0.   0.   1.   0.  ]
 [0.01 0.01 0.   0.   0.   0.   0.   1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.75 0.73 0.87 0.75 0.69 0.51 0.77]
 [0.75 1.   0.67 0.79 0.52 0.53 0.46 0.63]
 [0.73 0.67 1.   0.73 0.69 0.54 0.41 0.56]
 [0.87 0.79 0.73 1.   0.58 0.69 0.5  0.61]
 [0.75 0.52 0.69 0.58 1.   0.47 0.46 0.63]
 [0.69 0.53 0.54 0.69 0.47 1.   0.35 0.49]
 [0.51 0.46 0.41 0.5  0.46 0.35 1.   0.41]
 [0.77 0.63 0.56 0.61 0.63 0.49 0.41 1.  ]]
Collapsing 0 & 3 with crosscontam 0.7491730967556705 and sim 0.8725794342314794
Trimming eliminated 0 seqlets out of 1805
Unmerged patterns remapping: OrderedDict([(1, 1), (2, 2), (4, 3), (5, 4), (6, 5), (7, 6)])
Time spent on merging iteration: 5.1893980503082275
On merging iteration 3
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 2270 tasks      | elapsed:    1.0s
[Parallel(n_jobs=24)]: Done 2681 out of 2681 | elapsed:    1.2s finished
Numbers for each pattern pre-subsample: [1805, 759, 386, 128, 6, 5, 5]
Numbers after subsampling: [300, 300, 300, 128, 6, 5, 5]
Computing sims for pattern 0
Computed sims for pattern 0 in 2.1477861404418945 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.459470272064209 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.4528324604034424 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.22881579399108887 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.05348825454711914 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.053682565689086914 s
Computing sims for pattern 6
Computed sims for pattern 6 in 0.05083465576171875 s
Cluster sizes
[1805  759  386  128    6    5    5]
Cross-contamination matrix:
[[1.   0.85 0.79 0.8  0.78 0.82 1.  ]
 [0.53 1.   0.43 0.33 0.43 0.51 0.78]
 [0.74 0.72 1.   0.35 0.31 0.59 0.85]
 [0.56 0.41 0.2  1.   0.27 0.5  0.69]
 [0.02 0.04 0.   0.   1.   0.   0.01]
 [0.   0.   0.   0.   0.   1.   0.  ]
 [0.01 0.01 0.   0.   0.   0.   1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.76 0.74 0.73 0.7  0.51 0.76]
 [0.76 1.   0.67 0.52 0.53 0.46 0.63]
 [0.74 0.67 1.   0.69 0.54 0.41 0.56]
 [0.73 0.52 0.69 1.   0.47 0.46 0.63]
 [0.7  0.53 0.54 0.47 1.   0.35 0.49]
 [0.51 0.46 0.41 0.46 0.35 1.   0.41]
 [0.76 0.63 0.56 0.63 0.49 0.41 1.  ]]
Inspecting pattern 2 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 2681
[t-SNE] Computed conditional probabilities for sample 2000 / 2681
[t-SNE] Computed conditional probabilities for sample 2681 / 2681
[t-SNE] Mean sigma: 0.274922
Beginning preprocessing + Leiden
2024-03-16 18:10:01.397783 MEMORY 17.78597888
Affmat transformed
2024-03-16 18:10:01.431344 MEMORY 17.78597888
sources, targets, weights extracted
2024-03-16 18:10:01.461018 MEMORY 17.78597888
About to launch parallel Leiden runs
2024-03-16 18:10:01.474073 MEMORY 17.78597888
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    8.9s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   30.1s finished
Parallel Leiden runs finished
2024-03-16 18:10:31.603554 MEMORY 17.78597888
Quality: 0.5347640373102067
Quality: 0.5349002847486012
Quality: 0.5349336999133193
Quality: 0.5350428051034734
Quality: 0.5350484557434261
Quality: 0.5351308419017031
Got subclusters: Counter({0: 478, 1: 444, 2: 432, 3: 394, 4: 332, 5: 247, 6: 194, 7: 160})
On merging iteration 1
Numbers for each pattern pre-subsample: [478, 444, 432, 394, 332, 247, 194, 160]
Numbers after subsampling: [300, 300, 300, 300, 300, 247, 194, 160]
Computing sims for pattern 0
Computed sims for pattern 0 in 3.070896625518799 s
Computing sims for pattern 1
Computed sims for pattern 1 in 3.0799710750579834 s
Computing sims for pattern 2
Computed sims for pattern 2 in 3.041917324066162 s
Computing sims for pattern 3
Computed sims for pattern 3 in 3.0856716632843018 s
Computing sims for pattern 4
Computed sims for pattern 4 in 3.0795562267303467 s
Computing sims for pattern 5
Computed sims for pattern 5 in 2.2211122512817383 s
Computing sims for pattern 6
Computed sims for pattern 6 in 2.1722919940948486 s
Computing sims for pattern 7
Computed sims for pattern 7 in 1.7451062202453613 s
Cluster sizes
[478 444 432 394 332 247 194 160]
Cross-contamination matrix:
[[1.   0.64 0.09 0.2  0.31 0.25 0.46 0.45]
 [1.   1.   0.16 0.33 0.5  0.46 0.66 0.73]
 [0.74 0.44 1.   0.64 0.34 0.49 0.55 0.55]
 [1.   0.72 0.6  1.   0.53 0.63 0.73 0.8 ]
 [1.   0.91 0.3  0.5  1.   0.7  0.8  0.78]
 [1.   0.89 0.44 0.6  0.72 1.   0.62 0.87]
 [1.   0.9  0.35 0.51 0.62 0.53 1.   0.83]
 [0.91 0.75 0.17 0.33 0.37 0.41 0.58 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.95 0.64 0.81 0.85 0.81 0.92 0.88]
 [0.95 1.   0.55 0.74 0.83 0.79 0.93 0.91]
 [0.64 0.55 1.   0.71 0.5  0.67 0.56 0.65]
 [0.81 0.74 0.71 1.   0.63 0.76 0.72 0.81]
 [0.85 0.83 0.5  0.63 1.   0.77 0.83 0.78]
 [0.81 0.79 0.67 0.76 0.77 1.   0.72 0.85]
 [0.92 0.93 0.56 0.72 0.83 0.72 1.   0.86]
 [0.88 0.91 0.65 0.81 0.78 0.85 0.86 1.  ]]
Collapsing 0 & 1 with crosscontam 0.6441089679012344 and sim 0.951669117993014
Collapsing 1 & 6 with crosscontam 0.6564949728904161 and sim 0.9270188650332661
Collapsing 0 & 6 with crosscontam 0.45823194119893107 and sim 0.9196604640174386
Collapsing 1 & 7 with crosscontam 0.7267760453703704 and sim 0.9061685848623848
Collapsing 6 & 7 with crosscontam 0.5825803298163661 and sim 0.8587998299223037
Trimming eliminated 0 seqlets out of 922
Trimming eliminated 0 seqlets out of 1116
Trimming eliminated 0 seqlets out of 1276
Unmerged patterns remapping: OrderedDict([(2, 1), (3, 2), (4, 3), (5, 4)])
Time spent on merging iteration: 6.019597768783569
On merging iteration 2
Numbers for each pattern pre-subsample: [1276, 432, 394, 332, 247]
Numbers after subsampling: [300, 300, 300, 300, 247]
Computing sims for pattern 0
Computed sims for pattern 0 in 1.7225878238677979 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.4658663272857666 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.4625229835510254 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.4719812870025635 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.3473777770996094 s
Cluster sizes
[1276  432  394  332  247]
Cross-contamination matrix:
[[1.   0.24 0.42 0.57 0.51]
 [0.57 1.   0.64 0.34 0.49]
 [0.83 0.6  1.   0.53 0.63]
 [0.96 0.3  0.5  1.   0.7 ]
 [0.92 0.44 0.6  0.72 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.61 0.8  0.85 0.81]
 [0.61 1.   0.71 0.5  0.67]
 [0.8  0.71 1.   0.63 0.76]
 [0.85 0.5  0.63 1.   0.77]
 [0.81 0.67 0.76 0.77 1.  ]]
Collapsing 0 & 3 with crosscontam 0.569972089382716 and sim 0.8527634426442687
Trimming eliminated 0 seqlets out of 1608
Unmerged patterns remapping: OrderedDict([(1, 1), (2, 2), (4, 3)])
Time spent on merging iteration: 4.532577753067017
On merging iteration 3
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 2270 tasks      | elapsed:    1.0s
[Parallel(n_jobs=24)]: Done 2700 out of 2700 | elapsed:    1.1s finished
Numbers for each pattern pre-subsample: [1608, 432, 394, 247]
Numbers after subsampling: [300, 300, 300, 247]
Computing sims for pattern 0
Computed sims for pattern 0 in 1.4074821472167969 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.46114468574523926 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.4612162113189697 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.3435220718383789 s
Cluster sizes
[1608  432  394  247]
Cross-contamination matrix:
[[1.   0.27 0.46 0.58]
 [0.55 1.   0.64 0.49]
 [0.79 0.6  1.   0.63]
 [0.91 0.44 0.6  1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.59 0.79 0.81]
 [0.59 1.   0.71 0.67]
 [0.79 0.71 1.   0.76]
 [0.81 0.67 0.76 1.  ]]
Inspecting pattern 3 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 2700
[t-SNE] Computed conditional probabilities for sample 2000 / 2700
[t-SNE] Computed conditional probabilities for sample 2700 / 2700
[t-SNE] Mean sigma: 0.300013
Beginning preprocessing + Leiden
2024-03-16 18:11:12.831131 MEMORY 17.78597888
Affmat transformed
2024-03-16 18:11:12.863884 MEMORY 17.78597888
sources, targets, weights extracted
2024-03-16 18:11:12.887398 MEMORY 17.78597888
About to launch parallel Leiden runs
2024-03-16 18:11:12.899359 MEMORY 17.78597888
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    8.9s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   28.3s finished
Parallel Leiden runs finished
2024-03-16 18:11:41.190438 MEMORY 17.78597888
Quality: 0.5185861341939854
Quality: 0.5187152652976502
Quality: 0.5204605153351358
Quality: 0.520583285173982
Quality: 0.5208399215548933
Quality: 0.5219762691787272
Got subclusters: Counter({0: 551, 1: 496, 2: 481, 3: 326, 4: 272, 5: 247, 6: 213, 7: 112, 8: 2})
On merging iteration 1
Numbers for each pattern pre-subsample: [551, 496, 481, 326, 272, 247, 213, 112, 2]
Numbers after subsampling: [300, 300, 300, 300, 272, 247, 213, 112, 2]
Computing sims for pattern 0
Computed sims for pattern 0 in 3.38456130027771 s
Computing sims for pattern 1
Computed sims for pattern 1 in 3.371575355529785 s
Computing sims for pattern 2
Computed sims for pattern 2 in 3.372434377670288 s
Computing sims for pattern 3
Computed sims for pattern 3 in 3.3519840240478516 s
Computing sims for pattern 4
Computed sims for pattern 4 in 2.9356818199157715 s
Computing sims for pattern 5
Computed sims for pattern 5 in 2.4791197776794434 s
Computing sims for pattern 6
Computed sims for pattern 6 in 2.7584264278411865 s
Computing sims for pattern 7
Computed sims for pattern 7 in 1.475039005279541 s
Computing sims for pattern 8
Computed sims for pattern 8 in 0.31340456008911133 s
Cluster sizes
[551 496 481 326 272 247 213 112   2]
Cross-contamination matrix:
[[1.   0.25 0.77 0.38 0.63 0.47 0.33 0.44 0.43]
 [0.46 1.   0.57 0.61 0.47 0.61 0.41 0.42 0.6 ]
 [0.81 0.35 1.   0.53 0.57 0.53 0.38 0.41 0.36]
 [0.7  0.66 0.86 1.   0.67 0.72 0.74 0.63 0.59]
 [0.95 0.47 0.83 0.62 1.   0.62 0.6  0.58 0.21]
 [0.75 0.59 0.77 0.65 0.61 1.   0.61 0.54 0.64]
 [0.58 0.41 0.62 0.69 0.61 0.63 1.   0.45 0.46]
 [0.85 0.53 0.77 0.7  0.71 0.68 0.57 1.   0.25]
 [0.   0.   0.   0.   0.   0.   0.   0.   1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.73 0.95 0.89 0.92 0.93 0.89 0.87 0.67]
 [0.73 1.   0.78 0.79 0.73 0.8  0.67 0.66 0.76]
 [0.95 0.78 1.   0.96 0.91 0.9  0.88 0.84 0.67]
 [0.89 0.79 0.96 1.   0.91 0.86 0.89 0.82 0.65]
 [0.92 0.73 0.91 0.91 1.   0.86 0.91 0.81 0.58]
 [0.93 0.8  0.9  0.86 0.86 1.   0.86 0.82 0.77]
 [0.89 0.67 0.88 0.89 0.91 0.86 1.   0.79 0.58]
 [0.87 0.66 0.84 0.82 0.81 0.82 0.79 1.   0.55]
 [0.67 0.76 0.67 0.65 0.58 0.77 0.58 0.55 1.  ]]
Collapsing 2 & 3 with crosscontam 0.5298120019753088 and sim 0.9602403692700918
Collapsing 0 & 2 with crosscontam 0.7691473683950616 and sim 0.9490058024190016
Collapsing 0 & 5 with crosscontam 0.4740356539211277 and sim 0.9264943652616175
Collapsing 0 & 4 with crosscontam 0.6318989128540307 and sim 0.9198702627426882
Collapsing 2 & 4 with crosscontam 0.5724298442265796 and sim 0.9137387714899473
Collapsing 3 & 4 with crosscontam 0.6191077323554852 and sim 0.9121593703985822
Collapsing 4 & 6 with crosscontam 0.6001059519112606 and sim 0.9058764434369853
Collapsing 2 & 5 with crosscontam 0.5281305796971059 and sim 0.8960056713398582
Collapsing 3 & 6 with crosscontam 0.6911366509454675 and sim 0.8850577279781864
Collapsing 3 & 5 with crosscontam 0.652086958077843 and sim 0.8648731242515875
Collapsing 4 & 5 with crosscontam 0.6094544743516597 and sim 0.8636806088968854
Collapsing 5 & 6 with crosscontam 0.6105568865716746 and sim 0.8558076211592485
Trimming eliminated 0 seqlets out of 807
Trimming eliminated 0 seqlets out of 1358
Trimming eliminated 0 seqlets out of 1605
Trimming eliminated 0 seqlets out of 1877
Trimming eliminated 0 seqlets out of 2090
Unmerged patterns remapping: OrderedDict([(1, 1), (7, 2), (8, 3)])
Time spent on merging iteration: 11.351985216140747
On merging iteration 2
Numbers for each pattern pre-subsample: [2090, 496, 112, 2]
Numbers after subsampling: [300, 300, 112, 2]
Computing sims for pattern 0
Computed sims for pattern 0 in 1.0919203758239746 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.47493886947631836 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.20637083053588867 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.04916048049926758 s
Cluster sizes
[2090  496  112    2]
Cross-contamination matrix:
[[1.   0.59 0.72 0.61]
 [0.5  1.   0.42 0.6 ]
 [0.74 0.53 1.   0.25]
 [0.   0.   0.   1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.76 0.86 0.65]
 [0.76 1.   0.66 0.76]
 [0.86 0.66 1.   0.55]
 [0.65 0.76 0.55 1.  ]]
Collapsing 0 & 2 with crosscontam 0.720447742063492 and sim 0.856720818008984
Removed 1 duplicate seqlets
Trimming eliminated 0 seqlets out of 2201
Unmerged patterns remapping: OrderedDict([(1, 1), (3, 2)])
Time spent on merging iteration: 2.4746556282043457
On merging iteration 3
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 2332 tasks      | elapsed:    1.0s
[Parallel(n_jobs=24)]: Done 2583 out of 2583 | elapsed:    1.1s finished
Numbers for each pattern pre-subsample: [2201, 496, 2]
Numbers after subsampling: [300, 300, 2]
Computing sims for pattern 0
Computed sims for pattern 0 in 0.7615261077880859 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.4600369930267334 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.04990434646606445 s
Cluster sizes
[2201  496    2]
Cross-contamination matrix:
[[1.   0.65 0.72]
 [0.5  1.   0.6 ]
 [0.   0.   1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.78 0.68]
 [0.78 1.   0.76]
 [0.68 0.76 1.  ]]
Inspecting pattern 4 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 2583
[t-SNE] Computed conditional probabilities for sample 2000 / 2583
[t-SNE] Computed conditional probabilities for sample 2583 / 2583
[t-SNE] Mean sigma: 0.276419
Beginning preprocessing + Leiden
2024-03-16 18:12:26.096453 MEMORY 17.78597888
Affmat transformed
2024-03-16 18:12:26.132355 MEMORY 17.78597888
sources, targets, weights extracted
2024-03-16 18:12:26.159591 MEMORY 17.78597888
About to launch parallel Leiden runs
2024-03-16 18:12:26.196488 MEMORY 17.78597888
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    9.3s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   31.1s finished
Parallel Leiden runs finished
2024-03-16 18:12:57.289760 MEMORY 17.78597888
Quality: 0.4758173203526353
Quality: 0.47726719215030733
Quality: 0.4786379518723677
Got subclusters: Counter({0: 386, 1: 313, 2: 307, 3: 260, 4: 242, 5: 234, 6: 227, 7: 186, 8: 119, 9: 118, 10: 104, 11: 87})
On merging iteration 1
Numbers for each pattern pre-subsample: [386, 313, 307, 260, 242, 234, 227, 186, 119, 118, 104, 87]
Numbers after subsampling: [300, 300, 300, 260, 242, 234, 227, 186, 119, 118, 104, 87]
Computing sims for pattern 0
Computed sims for pattern 0 in 4.3275628089904785 s
Computing sims for pattern 1
Computed sims for pattern 1 in 4.465814590454102 s
Computing sims for pattern 2
Computed sims for pattern 2 in 4.557775020599365 s
Computing sims for pattern 3
Computed sims for pattern 3 in 3.6182847023010254 s
Computing sims for pattern 4
Computed sims for pattern 4 in 3.233510732650757 s
Computing sims for pattern 5
Computed sims for pattern 5 in 6.226165533065796 s
Computing sims for pattern 6
Computed sims for pattern 6 in 4.1523802280426025 s
Computing sims for pattern 7
Computed sims for pattern 7 in 3.1875593662261963 s
Computing sims for pattern 8
Computed sims for pattern 8 in 2.1891798973083496 s
Computing sims for pattern 9
Computed sims for pattern 9 in 2.1473989486694336 s
Computing sims for pattern 10
Computed sims for pattern 10 in 1.8957889080047607 s
Computing sims for pattern 11
Computed sims for pattern 11 in 1.7927463054656982 s
Cluster sizes
[386 313 307 260 242 234 227 186 119 118 104  87]
Cross-contamination matrix:
[[1.   0.82 0.66 0.93 0.68 0.68 0.56 0.51 0.68 0.62 0.61 0.37]
 [0.74 1.   0.71 0.8  0.59 0.66 0.47 0.46 0.54 0.6  0.61 0.53]
 [0.7  0.84 1.   0.85 0.79 0.68 0.6  0.51 0.67 0.74 0.71 0.47]
 [0.78 0.73 0.68 1.   0.44 0.57 0.53 0.44 0.57 0.6  0.5  0.51]
 [0.83 0.8  0.91 0.7  1.   0.74 0.65 0.48 0.62 0.83 0.77 0.64]
 [0.74 0.8  0.7  0.77 0.64 1.   0.45 0.45 0.53 0.59 0.53 0.38]
 [0.79 0.76 0.79 0.97 0.74 0.63 1.   0.5  0.56 0.68 0.63 0.55]
 [0.89 0.9  0.83 0.94 0.71 0.78 0.66 1.   0.77 0.63 0.63 0.57]
 [0.66 0.58 0.6  0.68 0.46 0.47 0.35 0.39 1.   0.42 0.74 0.34]
 [0.61 0.67 0.7  0.65 0.68 0.54 0.47 0.34 0.42 1.   0.61 0.56]
 [0.61 0.68 0.68 0.62 0.64 0.51 0.46 0.35 0.71 0.62 1.   0.48]
 [0.29 0.52 0.36 0.57 0.42 0.27 0.29 0.21 0.26 0.49 0.39 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.87 0.85 0.92 0.88 0.85 0.85 0.84 0.86 0.82 0.82 0.71]
 [0.87 1.   0.88 0.85 0.82 0.83 0.79 0.84 0.79 0.83 0.81 0.73]
 [0.85 0.88 1.   0.88 0.93 0.84 0.84 0.85 0.86 0.91 0.86 0.7 ]
 [0.92 0.85 0.88 1.   0.83 0.79 0.88 0.83 0.85 0.85 0.8  0.7 ]
 [0.88 0.82 0.93 0.83 1.   0.82 0.87 0.79 0.81 0.94 0.91 0.73]
 [0.85 0.83 0.84 0.79 0.82 1.   0.76 0.81 0.77 0.79 0.78 0.64]
 [0.85 0.79 0.84 0.88 0.87 0.76 1.   0.79 0.75 0.82 0.8  0.61]
 [0.84 0.84 0.85 0.83 0.79 0.81 0.79 1.   0.81 0.74 0.75 0.63]
 [0.86 0.79 0.86 0.85 0.81 0.77 0.75 0.81 1.   0.82 0.88 0.75]
 [0.82 0.83 0.91 0.85 0.94 0.79 0.82 0.74 0.82 1.   0.9  0.8 ]
 [0.82 0.81 0.86 0.8  0.91 0.78 0.8  0.75 0.88 0.9  1.   0.78]
 [0.71 0.73 0.7  0.7  0.73 0.64 0.61 0.63 0.75 0.8  0.78 1.  ]]
Collapsing 4 & 9 with crosscontam 0.6772625545861413 and sim 0.9395467797806731
Collapsing 2 & 4 with crosscontam 0.7914338126721765 and sim 0.9334873525263615
Collapsing 0 & 3 with crosscontam 0.7801184372629342 and sim 0.9152115276259708
Collapsing 2 & 9 with crosscontam 0.7023118235067849 and sim 0.9132181191081401
Collapsing 4 & 10 with crosscontam 0.6386412891170152 and sim 0.9069752012572061
Collapsing 9 & 10 with crosscontam 0.6075926888637779 and sim 0.8975258411126589
Collapsing 8 & 10 with crosscontam 0.7105345381211201 and sim 0.8839541642088715
Collapsing 3 & 6 with crosscontam 0.5306791469745489 and sim 0.8814966839041709
Collapsing 0 & 4 with crosscontam 0.6810790076522804 and sim 0.8794961296980928
Collapsing 1 & 2 with crosscontam 0.7102322795061728 and sim 0.8787256891952229
Collapsing 2 & 3 with crosscontam 0.6792487035351236 and sim 0.8784091937443603
Collapsing 4 & 6 with crosscontam 0.6500611980503606 and sim 0.8742934153129586
Collapsing 0 & 1 with crosscontam 0.7384574874074072 and sim 0.8671497384480019
Collapsing 0 & 8 with crosscontam 0.6554940789959087 and sim 0.8639540820696945
Collapsing 2 & 10 with crosscontam 0.6791534502541343 and sim 0.8593129051781105
Collapsing 2 & 8 with crosscontam 0.6011351095059871 and sim 0.8581378783394913
Collapsing 0 & 5 with crosscontam 0.6792552947135169 and sim 0.8518660936242027
Trimming eliminated 0 seqlets out of 360
Trimming eliminated 0 seqlets out of 667
Trimming eliminated 0 seqlets out of 646
Trimming eliminated 0 seqlets out of 771
Trimming eliminated 0 seqlets out of 890
Trimming eliminated 0 seqlets out of 873
Trimming eliminated 0 seqlets out of 1763
Trimming eliminated 0 seqlets out of 2076
Trimming eliminated 0 seqlets out of 2310
Unmerged patterns remapping: OrderedDict([(7, 1), (11, 2)])
Time spent on merging iteration: 18.86274027824402
On merging iteration 2
Numbers for each pattern pre-subsample: [2310, 186, 87]
Numbers after subsampling: [300, 186, 87]
Computing sims for pattern 0
Computed sims for pattern 0 in 0.780275821685791 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.3214287757873535 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.19740581512451172 s
Cluster sizes
[2310  186   87]
Cross-contamination matrix:
[[1.   0.67 0.82]
 [0.78 1.   0.57]
 [0.47 0.21 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.86 0.75]
 [0.86 1.   0.63]
 [0.75 0.63 1.  ]]
Collapsing 0 & 1 with crosscontam 0.6718841975308645 and sim 0.8597486225858222
Trimming eliminated 0 seqlets out of 2496
Unmerged patterns remapping: OrderedDict([(2, 1)])
Time spent on merging iteration: 5.786681890487671
On merging iteration 3
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 2399 out of 2399 | elapsed:    1.1s finished
Numbers for each pattern pre-subsample: [2496, 87]
Numbers after subsampling: [300, 87]
Computing sims for pattern 0
Computed sims for pattern 0 in 0.37856388092041016 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.19619321823120117 s
Cluster sizes
[2496   87]
Cross-contamination matrix:
[[1.   0.87]
 [0.43 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.74]
 [0.74 1.  ]]
Inspecting pattern 5 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 2399
[t-SNE] Computed conditional probabilities for sample 2000 / 2399
[t-SNE] Computed conditional probabilities for sample 2399 / 2399
[t-SNE] Mean sigma: 0.332209
Beginning preprocessing + Leiden
2024-03-16 18:14:08.143459 MEMORY 17.78597888
Affmat transformed
2024-03-16 18:14:08.173424 MEMORY 17.78597888
sources, targets, weights extracted
2024-03-16 18:14:08.193597 MEMORY 17.78597888
About to launch parallel Leiden runs
2024-03-16 18:14:08.211546 MEMORY 17.78593792
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    7.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   26.8s finished
Parallel Leiden runs finished
2024-03-16 18:14:35.026487 MEMORY 17.78593792
Quality: 0.5168537688273294
Quality: 0.5173908496965891
Quality: 0.5178979374719666
Quality: 0.5187506866033834
Quality: 0.5189491717415766
Quality: 0.5191194252943314
Quality: 0.5195559456816989
Got subclusters: Counter({0: 456, 1: 446, 2: 391, 3: 366, 4: 341, 5: 184, 6: 124, 7: 89, 8: 2})
On merging iteration 1
Numbers for each pattern pre-subsample: [456, 446, 391, 366, 341, 184, 124, 89, 2]
Numbers after subsampling: [300, 300, 300, 300, 300, 184, 124, 89, 2]
Computing sims for pattern 0
Computed sims for pattern 0 in 3.3001043796539307 s
Computing sims for pattern 1
Computed sims for pattern 1 in 3.257734537124634 s
Computing sims for pattern 2
Computed sims for pattern 2 in 3.307520627975464 s
Computing sims for pattern 3
Computed sims for pattern 3 in 3.2803921699523926 s
Computing sims for pattern 4
Computed sims for pattern 4 in 3.2316226959228516 s
Computing sims for pattern 5
Computed sims for pattern 5 in 2.1885156631469727 s
Computing sims for pattern 6
Computed sims for pattern 6 in 1.5784156322479248 s
Computing sims for pattern 7
Computed sims for pattern 7 in 1.3587689399719238 s
Computing sims for pattern 8
Computed sims for pattern 8 in 0.2874267101287842 s
Cluster sizes
[456 446 391 366 341 184 124  89   2]
Cross-contamination matrix:
[[1.   0.69 0.54 0.47 0.75 0.65 0.21 0.31 0.5 ]
 [0.69 1.   0.51 0.44 0.4  0.62 0.61 0.72 0.23]
 [0.55 0.53 1.   0.81 0.71 0.72 0.59 0.37 0.21]
 [0.38 0.34 0.69 1.   0.7  0.51 0.46 0.44 0.27]
 [0.57 0.27 0.53 0.62 1.   0.55 0.28 0.15 0.25]
 [0.74 0.72 0.82 0.7  0.83 1.   0.51 0.24 0.31]
 [0.16 0.59 0.54 0.51 0.35 0.38 1.   0.79 0.07]
 [0.15 0.43 0.19 0.28 0.1  0.11 0.53 1.   0.06]
 [0.   0.   0.   0.   0.   0.   0.   0.   1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.69 0.56 0.63 0.72 0.72 0.26 0.35 0.41]
 [0.69 1.   0.7  0.58 0.58 0.64 0.8  0.71 0.39]
 [0.56 0.7  1.   0.86 0.69 0.82 0.74 0.51 0.59]
 [0.63 0.58 0.86 1.   0.74 0.76 0.64 0.55 0.51]
 [0.72 0.58 0.69 0.74 1.   0.78 0.54 0.4  0.49]
 [0.72 0.64 0.82 0.76 0.78 1.   0.59 0.3  0.59]
 [0.26 0.8  0.74 0.64 0.54 0.59 1.   0.75 0.35]
 [0.35 0.71 0.51 0.55 0.4  0.3  0.75 1.   0.29]
 [0.41 0.39 0.59 0.51 0.49 0.59 0.35 0.29 1.  ]]
Collapsing 2 & 3 with crosscontam 0.6927315466666666 and sim 0.8624698637094095
Trimming eliminated 0 seqlets out of 757
Unmerged patterns remapping: OrderedDict([(0, 1), (1, 2), (4, 3), (5, 4), (6, 5), (7, 6), (8, 7)])
Time spent on merging iteration: 1.4010205268859863
On merging iteration 2
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 1650 tasks      | elapsed:    0.6s
[Parallel(n_jobs=24)]: Done 1930 out of 1930 | elapsed:    0.7s finished
Numbers for each pattern pre-subsample: [757, 456, 446, 341, 184, 124, 89, 2]
Numbers after subsampling: [300, 300, 300, 300, 184, 124, 89, 2]
Computing sims for pattern 0
Computed sims for pattern 0 in 2.742913246154785 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.45047926902770996 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.44461584091186523 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.4587585926055908 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.3090698719024658 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.23241114616394043 s
Computing sims for pattern 6
Computed sims for pattern 6 in 0.19023871421813965 s
Computing sims for pattern 7
Computed sims for pattern 7 in 0.04741239547729492 s
Cluster sizes
[757 456 446 341 184 124  89   2]
Cross-contamination matrix:
[[1.   0.63 0.6  0.83 0.77 0.69 0.48 0.37]
 [0.53 1.   0.69 0.75 0.65 0.21 0.31 0.5 ]
 [0.49 0.69 1.   0.4  0.62 0.61 0.72 0.23]
 [0.55 0.57 0.27 1.   0.55 0.28 0.15 0.25]
 [0.75 0.74 0.72 0.83 1.   0.51 0.24 0.31]
 [0.53 0.16 0.59 0.35 0.38 1.   0.79 0.07]
 [0.21 0.15 0.43 0.1  0.11 0.53 1.   0.06]
 [0.   0.   0.   0.   0.   0.   0.   1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.58 0.67 0.73 0.82 0.73 0.51 0.58]
 [0.58 1.   0.69 0.72 0.72 0.26 0.35 0.41]
 [0.67 0.69 1.   0.58 0.64 0.8  0.71 0.39]
 [0.73 0.72 0.58 1.   0.78 0.54 0.4  0.49]
 [0.82 0.72 0.64 0.78 1.   0.59 0.3  0.59]
 [0.73 0.26 0.8  0.54 0.59 1.   0.75 0.35]
 [0.51 0.35 0.71 0.4  0.3  0.75 1.   0.29]
 [0.58 0.41 0.39 0.49 0.59 0.35 0.29 1.  ]]
Inspecting pattern 6 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 1930
[t-SNE] Computed conditional probabilities for sample 1930 / 1930
[t-SNE] Mean sigma: 0.278328
Beginning preprocessing + Leiden
2024-03-16 18:15:06.556643 MEMORY 17.78593792
Affmat transformed
2024-03-16 18:15:06.580027 MEMORY 17.78593792
sources, targets, weights extracted
2024-03-16 18:15:06.599269 MEMORY 17.78593792
About to launch parallel Leiden runs
2024-03-16 18:15:06.616737 MEMORY 17.785933824
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    7.3s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   26.3s finished
Parallel Leiden runs finished
2024-03-16 18:15:32.948017 MEMORY 17.785933824
Quality: 0.4524101789954053
Quality: 0.45465526089954605
Quality: 0.45498397292778753
Got subclusters: Counter({0: 385, 1: 306, 2: 298, 3: 261, 4: 241, 5: 235, 6: 68, 7: 67, 8: 28, 9: 27, 10: 12, 11: 2})
On merging iteration 1
Numbers for each pattern pre-subsample: [385, 306, 298, 261, 241, 235, 68, 67, 28, 27, 12, 2]
Numbers after subsampling: [300, 300, 298, 261, 241, 235, 68, 67, 28, 27, 12, 2]
Computing sims for pattern 0
Computed sims for pattern 0 in 4.085071563720703 s
Computing sims for pattern 1
Computed sims for pattern 1 in 4.0918543338775635 s
Computing sims for pattern 2
Computed sims for pattern 2 in 4.068950653076172 s
Computing sims for pattern 3
Computed sims for pattern 3 in 3.2545218467712402 s
Computing sims for pattern 4
Computed sims for pattern 4 in 2.820173501968384 s
Computing sims for pattern 5
Computed sims for pattern 5 in 3.677468776702881 s
Computing sims for pattern 6
Computed sims for pattern 6 in 1.2343780994415283 s
Computing sims for pattern 7
Computed sims for pattern 7 in 1.2447335720062256 s
Computing sims for pattern 8
Computed sims for pattern 8 in 0.6242408752441406 s
Computing sims for pattern 9
Computed sims for pattern 9 in 0.6069772243499756 s
Computing sims for pattern 10
Computed sims for pattern 10 in 0.4195380210876465 s
Computing sims for pattern 11
Computed sims for pattern 11 in 0.29476118087768555 s
Cluster sizes
[385 306 298 261 241 235  68  67  28  27  12   2]
Cross-contamination matrix:
[[1.   0.95 0.67 0.61 0.58 0.75 0.47 0.95 0.73 0.41 0.82 0.57]
 [0.42 1.   0.37 0.45 0.32 0.69 0.17 0.63 0.28 0.19 0.45 0.22]
 [0.72 0.74 1.   0.6  0.62 0.81 0.53 0.79 0.66 0.46 0.56 0.57]
 [0.71 1.   0.65 1.   0.74 0.87 0.51 1.   0.64 0.44 0.69 0.48]
 [0.82 1.   0.8  0.88 1.   0.93 0.54 0.97 0.84 0.63 0.74 0.61]
 [0.63 1.   0.63 0.64 0.56 1.   0.39 0.83 0.56 0.42 0.7  0.52]
 [0.64 0.75 0.65 0.59 0.51 0.63 1.   0.87 0.58 0.31 0.42 0.62]
 [0.52 0.8  0.37 0.48 0.34 0.59 0.29 1.   0.37 0.17 0.44 0.31]
 [0.55 0.61 0.43 0.37 0.42 0.51 0.26 0.58 1.   0.25 0.4  0.23]
 [0.52 0.74 0.52 0.46 0.54 0.64 0.28 0.55 0.5  1.   0.62 0.2 ]
 [0.39 0.54 0.19 0.24 0.19 0.41 0.07 0.42 0.22 0.13 1.   0.14]
 [0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.85 0.82 0.86 0.86 0.86 0.78 0.93 0.84 0.73 0.78 0.66]
 [0.85 1.   0.83 0.93 0.87 0.97 0.69 0.92 0.77 0.8  0.8  0.61]
 [0.82 0.83 1.   0.84 0.83 0.87 0.78 0.86 0.78 0.73 0.66 0.59]
 [0.86 0.93 0.84 1.   0.93 0.91 0.78 0.92 0.78 0.8  0.74 0.59]
 [0.86 0.87 0.83 0.93 1.   0.9  0.77 0.92 0.83 0.8  0.7  0.62]
 [0.86 0.97 0.87 0.91 0.9  1.   0.72 0.92 0.8  0.83 0.81 0.62]
 [0.78 0.69 0.78 0.78 0.77 0.72 1.   0.8  0.74 0.58 0.58 0.62]
 [0.93 0.92 0.86 0.92 0.92 0.92 0.8  1.   0.85 0.79 0.77 0.65]
 [0.84 0.77 0.78 0.78 0.83 0.8  0.74 0.85 1.   0.67 0.69 0.59]
 [0.73 0.8  0.73 0.8  0.8  0.83 0.58 0.79 0.67 1.   0.72 0.45]
 [0.78 0.8  0.66 0.74 0.7  0.81 0.58 0.77 0.69 0.72 1.   0.48]
 [0.66 0.61 0.59 0.59 0.62 0.62 0.62 0.65 0.59 0.45 0.48 1.  ]]
Collapsing 1 & 5 with crosscontam 0.6939126190701341 and sim 0.970721246460431
Collapsing 0 & 7 with crosscontam 0.5229653913546546 and sim 0.9335747415061812
Collapsing 3 & 4 with crosscontam 0.7375453133009238 and sim 0.9290238289790288
Collapsing 1 & 3 with crosscontam 0.45003857017170423 and sim 0.9262246540019272
Collapsing 5 & 7 with crosscontam 0.5922765652548507 and sim 0.9249327313877636
Collapsing 1 & 7 with crosscontam 0.6316368866777224 and sim 0.9227711684055484
Collapsing 4 & 7 with crosscontam 0.3374003569869455 and sim 0.9211801633121269
Collapsing 3 & 7 with crosscontam 0.48176897931229634 and sim 0.9210287813091503
Collapsing 3 & 5 with crosscontam 0.6409405562509995 and sim 0.9116505112264606
Collapsing 4 & 5 with crosscontam 0.5596082838559067 and sim 0.8975776160993854
Collapsing 2 & 5 with crosscontam 0.6317876328886276 and sim 0.8720775094139575
Collapsing 0 & 5 with crosscontam 0.6255675314076201 and sim 0.8643942608904103
Collapsing 0 & 4 with crosscontam 0.5780826230213614 and sim 0.8597684296590441
Collapsing 0 & 3 with crosscontam 0.6106828051653186 and sim 0.8572997425619517
Removed 2 duplicate seqlets
Trimming eliminated 0 seqlets out of 539
Trimming eliminated 0 seqlets out of 452
Trimming eliminated 0 seqlets out of 502
Trimming eliminated 0 seqlets out of 1041
Trimming eliminated 0 seqlets out of 1493
Skipped 1 due to duplicates
Trimming eliminated 0 seqlets out of 1790
Unmerged patterns remapping: OrderedDict([(6, 1), (8, 2), (9, 3), (10, 4), (11, 5)])
Time spent on merging iteration: 9.853279113769531
On merging iteration 2
Numbers for each pattern pre-subsample: [1790, 68, 28, 27, 12, 2]
Numbers after subsampling: [300, 68, 28, 27, 12, 2]
Computing sims for pattern 0
Computed sims for pattern 0 in 1.540113925933838 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.14759278297424316 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.08240199089050293 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.08463025093078613 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.062340736389160156 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.04773879051208496 s
Cluster sizes
[1790   68   28   27   12    2]
Cross-contamination matrix:
[[1.   0.7  0.91 0.7  0.96 0.81]
 [0.61 1.   0.58 0.31 0.42 0.62]
 [0.46 0.26 1.   0.25 0.4  0.23]
 [0.55 0.28 0.5  1.   0.62 0.2 ]
 [0.32 0.07 0.22 0.13 1.   0.14]
 [0.   0.   0.   0.   0.   1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.79 0.85 0.82 0.8  0.65]
 [0.79 1.   0.74 0.58 0.58 0.62]
 [0.85 0.74 1.   0.67 0.69 0.59]
 [0.82 0.58 0.67 1.   0.72 0.45]
 [0.8  0.58 0.69 0.72 1.   0.48]
 [0.65 0.62 0.59 0.45 0.48 1.  ]]
Merging on 38 clusters
2024-03-16 18:16:11.408543 MEMORY 17.785974784
On merging iteration 1
Numbers for each pattern pre-subsample: [665, 628, 606, 536, 408, 186, 93, 26, 1805, 759, 386, 128, 6, 5, 5, 1608, 432, 394, 247, 2201, 496, 2, 2496, 87, 757, 456, 446, 341, 184, 124, 89, 2, 1790, 68, 28, 27, 12, 2]
Numbers after subsampling: [300, 300, 300, 300, 300, 186, 93, 26, 300, 300, 300, 128, 6, 5, 5, 300, 300, 300, 247, 300, 300, 2, 300, 87, 300, 300, 300, 300, 184, 124, 89, 2, 300, 68, 28, 27, 12, 2]
Computing sims for pattern 0
Computed sims for pattern 0 in 14.41663932800293 s
Computing sims for pattern 1
Computed sims for pattern 1 in 14.503225326538086 s
Computing sims for pattern 2
Computed sims for pattern 2 in 14.64787244796753 s
Computing sims for pattern 3
Computed sims for pattern 3 in 16.646696090698242 s
Computing sims for pattern 4
Computed sims for pattern 4 in 14.715618133544922 s
Computing sims for pattern 5
Computed sims for pattern 5 in 9.915455341339111 s
Computing sims for pattern 6
Computed sims for pattern 6 in 5.952672719955444 s
Computing sims for pattern 7
Computed sims for pattern 7 in 2.182473659515381 s
Computing sims for pattern 8
Computed sims for pattern 8 in 14.166619539260864 s
Computing sims for pattern 9
Computed sims for pattern 9 in 14.00770115852356 s
Computing sims for pattern 10
Computed sims for pattern 10 in 16.066617250442505 s
Computing sims for pattern 11
Computed sims for pattern 11 in 6.801497936248779 s
Computing sims for pattern 12
Computed sims for pattern 12 in 1.2034084796905518 s
Computing sims for pattern 13
Computed sims for pattern 13 in 1.1498193740844727 s
Computing sims for pattern 14
Computed sims for pattern 14 in 1.1397972106933594 s
Computing sims for pattern 15
Computed sims for pattern 15 in 13.84463882446289 s
Computing sims for pattern 16
Computed sims for pattern 16 in 14.027001142501831 s
Computing sims for pattern 17
Computed sims for pattern 17 in 14.04509449005127 s
Computing sims for pattern 18
Computed sims for pattern 18 in 10.092015981674194 s
Computing sims for pattern 19
Computed sims for pattern 19 in 13.865166902542114 s
Computing sims for pattern 20
Computed sims for pattern 20 in 16.835839986801147 s
Computing sims for pattern 21
Computed sims for pattern 21 in 1.0928947925567627 s
Computing sims for pattern 22
Computed sims for pattern 22 in 14.615979194641113 s
Computing sims for pattern 23
Computed sims for pattern 23 in 5.562506675720215 s
Computing sims for pattern 24
Computed sims for pattern 24 in 13.76819658279419 s
Computing sims for pattern 25
Computed sims for pattern 25 in 14.089648962020874 s
Computing sims for pattern 26
Computed sims for pattern 26 in 14.830958366394043 s
Computing sims for pattern 27
Computed sims for pattern 27 in 17.073840618133545 s
Computing sims for pattern 28
Computed sims for pattern 28 in 10.183047771453857 s
Computing sims for pattern 29
Computed sims for pattern 29 in 6.883808612823486 s
Computing sims for pattern 30
Computed sims for pattern 30 in 5.6058080196380615 s
Computing sims for pattern 31
Computed sims for pattern 31 in 1.0989344120025635 s
Computing sims for pattern 32
Computed sims for pattern 32 in 14.446794033050537 s
Computing sims for pattern 33
Computed sims for pattern 33 in 4.494805574417114 s
Computing sims for pattern 34
Computed sims for pattern 34 in 2.3347511291503906 s
Computing sims for pattern 35
Computed sims for pattern 35 in 2.2659919261932373 s
Computing sims for pattern 36
Computed sims for pattern 36 in 1.5913162231445312 s
Computing sims for pattern 37
Computed sims for pattern 37 in 1.1578950881958008 s
Cluster sizes
[ 665  628  606  536  408  186   93   26 1805  759  386  128    6    5
    5 1608  432  394  247 2201  496    2 2496   87  757  456  446  341
  184  124   89    2 1790   68   28   27   12    2]
Cross-contamination matrix:
[[1.   0.46 0.49 ... 0.3  0.22 0.14]
 [0.61 1.   0.54 ... 0.45 0.38 0.21]
 [0.64 0.53 1.   ... 0.32 0.25 0.15]
 ...
 [0.22 0.22 0.16 ... 1.   0.62 0.2 ]
 [0.01 0.01 0.   ... 0.13 1.   0.14]
 [0.   0.   0.   ... 0.   0.   1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.71 0.75 ... 0.59 0.38 0.44]
 [0.71 1.   0.72 ... 0.68 0.5  0.4 ]
 [0.75 0.72 1.   ... 0.56 0.33 0.35]
 ...
 [0.59 0.68 0.56 ... 1.   0.72 0.45]
 [0.38 0.5  0.33 ... 0.72 1.   0.48]
 [0.44 0.4  0.35 ... 0.45 0.48 1.  ]]
Got 38 patterns after merging
2024-03-16 18:22:15.267921 MEMORY 17.7857536
Performing filtering
2024-03-16 18:22:15.268250 MEMORY 17.785765888
Got 28 patterns after filtering
2024-03-16 18:22:19.884969 MEMORY 17.78579456
Total time taken is 3074.61s
2024-03-16 18:22:19.885152 MEMORY 17.78579456
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 2355 tasks      | elapsed:    1.1s
[Parallel(n_jobs=24)]: Done 2496 out of 2496 | elapsed:    1.2s finished
/ru-auth/local/home/lzhao/anaconda3/envs/jupyter-ml-clone/lib/python3.9/site-packages/sklearn/manifold/_t_sne.py:691: FutureWarning: 'square_distances' has been introduced in 0.24 to help phase out legacy squaring behavior. The 'legacy' setting will be removed in 1.1 (renaming of 0.26), and the default setting will be changed to True. In 1.3, 'square_distances' will be removed altogether, and distances will be squared by default. Set 'square_distances'=True to silence this warning.
  warnings.warn(
/ru-auth/local/home/lzhao/anaconda3/envs/jupyter-ml-clone/lib/python3.9/site-packages/sklearn/neighbors/_base.py:175: EfficiencyWarning: Precomputed sparse input was not sorted by data.
  warnings.warn('Precomputed sparse input was not sorted by data.',
Applying subclustering to the final motifs
On pattern 0
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 2496 samples in 0.017s...
[t-SNE] Computed neighbors for 2496 samples in 0.002s...
[t-SNE] Computed conditional probabilities for sample 1000 / 2496
[t-SNE] Computed conditional probabilities for sample 2000 / 2496
[t-SNE] Computed conditional probabilities for sample 2496 / 2496
[t-SNE] Mean sigma: 0.279455
[t-SNE] Computed conditional probabilities in 0.178s
[t-SNE] Iteration 50: error = 72.1409836, gradient norm = 0.0466070 (50 iterations in 2.322s)
[t-SNE] Iteration 100: error = 72.1119919, gradient norm = 0.0331205 (50 iterations in 2.182s)
[t-SNE] Iteration 150: error = 71.9742584, gradient norm = 0.0392771 (50 iterations in 2.206s)
[t-SNE] Iteration 200: error = 71.9819489, gradient norm = 0.0503903 (50 iterations in 2.186s)
[t-SNE] Iteration 250: error = 71.9706802, gradient norm = 0.0310510 (50 iterations in 2.189s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 71.970680
[t-SNE] Iteration 300: error = 2.3069692, gradient norm = 0.0013012 (50 iterations in 2.174s)
[t-SNE] Iteration 350: error = 2.1882842, gradient norm = 0.0004463 (50 iterations in 2.172s)
[t-SNE] Iteration 400: error = 2.1400912, gradient norm = 0.0002274 (50 iterations in 2.166s)
[t-SNE] Iteration 450: error = 2.1162393, gradient norm = 0.0001875 (50 iterations in 2.176s)
[t-SNE] Iteration 500: error = 2.1038501, gradient norm = 0.0001054 (50 iterations in 2.163s)
[t-SNE] Iteration 550: error = 2.0964611, gradient norm = 0.0000955 (50 iterations in 2.162s)
[t-SNE] Iteration 600: error = 2.0926466, gradient norm = 0.0000737 (50 iterations in 2.204s)
[t-SNE] Iteration 650: error = 2.0897105, gradient norm = 0.0000607 (50 iterations in 2.156s)
[t-SNE] Iteration 700: error = 2.0869842, gradient norm = 0.0000658 (50 iterations in 2.147s)
[t-SNE] Iteration 750: error = 2.0851429, gradient norm = 0.0000605 (50 iterations in 2.176s)
[t-SNE] Iteration 800: error = 2.0838575, gradient norm = 0.0000483 (50 iterations in 2.196s)
[t-SNE] Iteration 850: error = 2.0826814, gradient norm = 0.0000658 (50 iterations in 2.164s)
[t-SNE] Iteration 900: error = 2.0820017, gradient norm = 0.0000566 (50 iterations in 2.202s)
[t-SNE] Iteration 950: error = 2.0814259, gradient norm = 0.0000429 (50 iterations in 2.152s)
[t-SNE] Iteration 1000: error = 2.0807145, gradient norm = 0.0000543 (50 iterations in 2.171s)
[t-SNE] KL divergence after 1000 iterations: 2.080714
[t-SNE] Computed conditional probabilities for sample 1000 / 2496
[t-SNE] Computed conditional probabilities for sample 2000 / 2496
[t-SNE] Computed conditional probabilities for sample 2496 / 2496
[t-SNE] Mean sigma: 0.279455
Beginning preprocessing + Leiden
2024-03-16 18:23:07.821795 MEMORY 17.786220544
Affmat transformed
2024-03-16 18:23:07.853724 MEMORY 17.786257408
sources, targets, weights extracted
2024-03-16 18:23:07.880904 MEMORY 17.786261504
About to launch parallel Leiden runs
2024-03-16 18:23:07.893692 MEMORY 17.786269696
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    9.2s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   30.8s finished
Parallel Leiden runs finished
2024-03-16 18:23:38.695683 MEMORY 17.785778176
Quality: 0.4879628195466255
Quality: 0.48919626249604037
Quality: 0.4892508762767085
Quality: 0.49125389817140075
Quality: 0.491409790437739
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 1980 tasks      | elapsed:    0.8s
[Parallel(n_jobs=24)]: Done 2201 out of 2201 | elapsed:    0.9s finished
Got subclusters: Counter({0: 428, 1: 395, 2: 353, 3: 279, 4: 262, 5: 252, 6: 210, 7: 147, 8: 134, 9: 28, 10: 8})
On pattern 1
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 2201 samples in 0.017s...
[t-SNE] Computed neighbors for 2201 samples in 0.002s...
[t-SNE] Computed conditional probabilities for sample 1000 / 2201
[t-SNE] Computed conditional probabilities for sample 2000 / 2201
[t-SNE] Computed conditional probabilities for sample 2201 / 2201
[t-SNE] Mean sigma: 0.297648
[t-SNE] Computed conditional probabilities in 0.156s
[t-SNE] Iteration 50: error = 71.4821701, gradient norm = 0.0805075 (50 iterations in 2.190s)
[t-SNE] Iteration 100: error = 71.5176468, gradient norm = 0.0760255 (50 iterations in 2.232s)
[t-SNE] Iteration 150: error = 71.4000549, gradient norm = 0.0737200 (50 iterations in 2.198s)
[t-SNE] Iteration 200: error = 71.4431458, gradient norm = 0.0748097 (50 iterations in 2.227s)
[t-SNE] Iteration 250: error = 71.2107697, gradient norm = 0.0987050 (50 iterations in 2.185s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 71.210770
[t-SNE] Iteration 300: error = 2.2973518, gradient norm = 0.0012473 (50 iterations in 2.170s)
[t-SNE] Iteration 350: error = 2.1830590, gradient norm = 0.0004268 (50 iterations in 2.154s)
[t-SNE] Iteration 400: error = 2.1426139, gradient norm = 0.0002754 (50 iterations in 2.150s)
[t-SNE] Iteration 450: error = 2.1235986, gradient norm = 0.0001281 (50 iterations in 2.192s)
[t-SNE] Iteration 500: error = 2.1129148, gradient norm = 0.0000953 (50 iterations in 2.175s)
[t-SNE] Iteration 550: error = 2.1063290, gradient norm = 0.0000926 (50 iterations in 2.148s)
[t-SNE] Iteration 600: error = 2.1022532, gradient norm = 0.0000673 (50 iterations in 2.136s)
[t-SNE] Iteration 650: error = 2.0998583, gradient norm = 0.0000572 (50 iterations in 2.176s)
[t-SNE] Iteration 700: error = 2.0978942, gradient norm = 0.0000483 (50 iterations in 2.204s)
[t-SNE] Iteration 750: error = 2.0962050, gradient norm = 0.0000453 (50 iterations in 2.143s)
[t-SNE] Iteration 800: error = 2.0952079, gradient norm = 0.0000422 (50 iterations in 2.188s)
[t-SNE] Iteration 850: error = 2.0944397, gradient norm = 0.0000433 (50 iterations in 2.157s)
[t-SNE] Iteration 900: error = 2.0936358, gradient norm = 0.0000418 (50 iterations in 2.210s)
[t-SNE] Iteration 950: error = 2.0930908, gradient norm = 0.0000436 (50 iterations in 2.154s)
[t-SNE] Iteration 1000: error = 2.0926607, gradient norm = 0.0000372 (50 iterations in 2.122s)
[t-SNE] KL divergence after 1000 iterations: 2.092661
[t-SNE] Computed conditional probabilities for sample 1000 / 2201
[t-SNE] Computed conditional probabilities for sample 2000 / 2201
[t-SNE] Computed conditional probabilities for sample 2201 / 2201
[t-SNE] Mean sigma: 0.297648
Beginning preprocessing + Leiden
2024-03-16 18:24:26.228648 MEMORY 17.786077184
Affmat transformed
2024-03-16 18:24:26.266959 MEMORY 17.786077184
sources, targets, weights extracted
2024-03-16 18:24:26.288382 MEMORY 17.78608128
About to launch parallel Leiden runs
2024-03-16 18:24:26.300026 MEMORY 17.78608128
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    7.3s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   24.2s finished
Parallel Leiden runs finished
2024-03-16 18:24:50.507436 MEMORY 17.78608128
Quality: 0.4763476116095999
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 1635 tasks      | elapsed:    0.6s
[Parallel(n_jobs=24)]: Done 1805 out of 1805 | elapsed:    0.7s finished
Got subclusters: Counter({0: 416, 1: 354, 2: 334, 3: 270, 4: 233, 5: 214, 6: 167, 7: 136, 8: 77})
On pattern 2
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 1805 samples in 0.013s...
[t-SNE] Computed neighbors for 1805 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 1000 / 1805
[t-SNE] Computed conditional probabilities for sample 1805 / 1805
[t-SNE] Mean sigma: 0.298955
[t-SNE] Computed conditional probabilities in 0.127s
[t-SNE] Iteration 50: error = 69.1979752, gradient norm = 0.1800737 (50 iterations in 2.155s)
[t-SNE] Iteration 100: error = 69.7987671, gradient norm = 0.1659483 (50 iterations in 2.152s)
[t-SNE] Iteration 150: error = 69.6607208, gradient norm = 0.1735369 (50 iterations in 2.163s)
[t-SNE] Iteration 200: error = 69.4398041, gradient norm = 0.1727902 (50 iterations in 2.154s)
[t-SNE] Iteration 250: error = 69.6784439, gradient norm = 0.1526059 (50 iterations in 2.191s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 69.678444
[t-SNE] Iteration 300: error = 2.0726318, gradient norm = 0.0011065 (50 iterations in 2.169s)
[t-SNE] Iteration 350: error = 1.9970365, gradient norm = 0.0003224 (50 iterations in 2.149s)
[t-SNE] Iteration 400: error = 1.9659809, gradient norm = 0.0002288 (50 iterations in 2.146s)
[t-SNE] Iteration 450: error = 1.9524388, gradient norm = 0.0001502 (50 iterations in 2.120s)
[t-SNE] Iteration 500: error = 1.9452522, gradient norm = 0.0000966 (50 iterations in 2.156s)
[t-SNE] Iteration 550: error = 1.9411081, gradient norm = 0.0000897 (50 iterations in 2.144s)
[t-SNE] Iteration 600: error = 1.9386487, gradient norm = 0.0000715 (50 iterations in 2.160s)
[t-SNE] Iteration 650: error = 1.9368081, gradient norm = 0.0000701 (50 iterations in 2.141s)
[t-SNE] Iteration 700: error = 1.9350759, gradient norm = 0.0000765 (50 iterations in 2.133s)
[t-SNE] Iteration 750: error = 1.9343069, gradient norm = 0.0000733 (50 iterations in 2.140s)
[t-SNE] Iteration 800: error = 1.9336296, gradient norm = 0.0000579 (50 iterations in 2.159s)
[t-SNE] Iteration 850: error = 1.9328773, gradient norm = 0.0000800 (50 iterations in 2.139s)
[t-SNE] Iteration 900: error = 1.9323143, gradient norm = 0.0000506 (50 iterations in 2.155s)
[t-SNE] Iteration 950: error = 1.9314597, gradient norm = 0.0000737 (50 iterations in 2.133s)
[t-SNE] Iteration 1000: error = 1.9306120, gradient norm = 0.0000670 (50 iterations in 2.158s)
[t-SNE] KL divergence after 1000 iterations: 1.930612
[t-SNE] Computed conditional probabilities for sample 1000 / 1805
[t-SNE] Computed conditional probabilities for sample 1805 / 1805
[t-SNE] Mean sigma: 0.298955
Beginning preprocessing + Leiden
2024-03-16 18:25:36.780806 MEMORY 17.786085376
Affmat transformed
2024-03-16 18:25:36.805880 MEMORY 17.786085376
sources, targets, weights extracted
2024-03-16 18:25:36.823421 MEMORY 17.786085376
About to launch parallel Leiden runs
2024-03-16 18:25:36.833301 MEMORY 17.786085376
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    5.5s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   17.5s finished
Parallel Leiden runs finished
2024-03-16 18:25:54.386148 MEMORY 17.786085376
Quality: 0.47422097245560013
Quality: 0.4744702024381646
Quality: 0.47530073995168237
Quality: 0.4753530697173713
Quality: 0.4754847084475393
Quality: 0.47551812105732666
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 1650 tasks      | elapsed:    0.6s
[Parallel(n_jobs=24)]: Done 1790 out of 1790 | elapsed:    0.7s finished
Got subclusters: Counter({0: 373, 1: 363, 2: 273, 3: 243, 4: 240, 5: 211, 6: 102})
On pattern 3
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 1790 samples in 0.015s...
[t-SNE] Computed neighbors for 1790 samples in 0.002s...
[t-SNE] Computed conditional probabilities for sample 1000 / 1790
[t-SNE] Computed conditional probabilities for sample 1790 / 1790
[t-SNE] Mean sigma: 0.277552
[t-SNE] Computed conditional probabilities in 0.127s
[t-SNE] Iteration 50: error = 68.5944901, gradient norm = 0.1650506 (50 iterations in 2.174s)
[t-SNE] Iteration 100: error = 68.6392059, gradient norm = 0.1507902 (50 iterations in 2.151s)
[t-SNE] Iteration 150: error = 68.8597260, gradient norm = 0.1407525 (50 iterations in 2.161s)
[t-SNE] Iteration 200: error = 68.8722382, gradient norm = 0.1455531 (50 iterations in 2.143s)
[t-SNE] Iteration 250: error = 68.8145752, gradient norm = 0.1411711 (50 iterations in 2.179s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 68.814575
[t-SNE] Iteration 300: error = 2.1144235, gradient norm = 0.0012558 (50 iterations in 2.194s)
[t-SNE] Iteration 350: error = 2.0308735, gradient norm = 0.0004277 (50 iterations in 2.179s)
[t-SNE] Iteration 400: error = 1.9988089, gradient norm = 0.0002004 (50 iterations in 2.151s)
[t-SNE] Iteration 450: error = 1.9847369, gradient norm = 0.0001375 (50 iterations in 2.103s)
[t-SNE] Iteration 500: error = 1.9773272, gradient norm = 0.0001367 (50 iterations in 2.137s)
[t-SNE] Iteration 550: error = 1.9739801, gradient norm = 0.0000895 (50 iterations in 2.140s)
[t-SNE] Iteration 600: error = 1.9711468, gradient norm = 0.0000664 (50 iterations in 2.116s)
[t-SNE] Iteration 650: error = 1.9690881, gradient norm = 0.0000508 (50 iterations in 2.180s)
[t-SNE] Iteration 700: error = 1.9675660, gradient norm = 0.0000554 (50 iterations in 2.146s)
[t-SNE] Iteration 750: error = 1.9665658, gradient norm = 0.0000424 (50 iterations in 2.127s)
[t-SNE] Iteration 800: error = 1.9657435, gradient norm = 0.0000404 (50 iterations in 2.167s)
[t-SNE] Iteration 850: error = 1.9652284, gradient norm = 0.0000360 (50 iterations in 2.149s)
[t-SNE] Iteration 900: error = 1.9648043, gradient norm = 0.0000300 (50 iterations in 2.118s)
[t-SNE] Iteration 950: error = 1.9644405, gradient norm = 0.0000359 (50 iterations in 2.183s)
[t-SNE] Iteration 1000: error = 1.9640989, gradient norm = 0.0000367 (50 iterations in 2.106s)
[t-SNE] KL divergence after 1000 iterations: 1.964099
[t-SNE] Computed conditional probabilities for sample 1000 / 1790
[t-SNE] Computed conditional probabilities for sample 1790 / 1790
[t-SNE] Mean sigma: 0.277551
Beginning preprocessing + Leiden
2024-03-16 18:26:40.576584 MEMORY 17.786085376
Affmat transformed
2024-03-16 18:26:40.601581 MEMORY 17.786085376
sources, targets, weights extracted
2024-03-16 18:26:40.619427 MEMORY 17.786085376
About to launch parallel Leiden runs
2024-03-16 18:26:40.630166 MEMORY 17.786085376
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    6.2s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   20.2s finished
Parallel Leiden runs finished
2024-03-16 18:27:00.834652 MEMORY 17.785987072
Quality: 0.4592296560511241
Quality: 0.45924610693009615
Quality: 0.4595042672263033
Quality: 0.45959638757761184
Quality: 0.4596888179006256
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 1561 out of 1608 | elapsed:    0.4s remaining:    0.0s
[Parallel(n_jobs=24)]: Done 1608 out of 1608 | elapsed:    0.4s finished
Got subclusters: Counter({0: 374, 1: 312, 2: 271, 3: 271, 4: 259, 5: 226, 6: 77})
On pattern 4
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 1608 samples in 0.013s...
[t-SNE] Computed neighbors for 1608 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 1000 / 1608
[t-SNE] Computed conditional probabilities for sample 1608 / 1608
[t-SNE] Mean sigma: 0.256361
[t-SNE] Computed conditional probabilities in 0.116s
[t-SNE] Iteration 50: error = 68.3624725, gradient norm = 0.2036850 (50 iterations in 2.154s)
[t-SNE] Iteration 100: error = 68.8073883, gradient norm = 0.2169182 (50 iterations in 2.189s)
[t-SNE] Iteration 150: error = 68.9912262, gradient norm = 0.2015605 (50 iterations in 2.171s)
[t-SNE] Iteration 200: error = 68.9890060, gradient norm = 0.1855002 (50 iterations in 2.161s)
[t-SNE] Iteration 250: error = 68.7152252, gradient norm = 0.2167318 (50 iterations in 2.149s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 68.715225
[t-SNE] Iteration 300: error = 1.9988703, gradient norm = 0.0021034 (50 iterations in 2.144s)
[t-SNE] Iteration 350: error = 1.9105704, gradient norm = 0.0004255 (50 iterations in 2.131s)
[t-SNE] Iteration 400: error = 1.8841680, gradient norm = 0.0002009 (50 iterations in 2.152s)
[t-SNE] Iteration 450: error = 1.8729604, gradient norm = 0.0001245 (50 iterations in 2.133s)
[t-SNE] Iteration 500: error = 1.8667097, gradient norm = 0.0001488 (50 iterations in 2.144s)
[t-SNE] Iteration 550: error = 1.8636247, gradient norm = 0.0000797 (50 iterations in 2.155s)
[t-SNE] Iteration 600: error = 1.8616202, gradient norm = 0.0000655 (50 iterations in 2.148s)
[t-SNE] Iteration 650: error = 1.8602535, gradient norm = 0.0000596 (50 iterations in 2.143s)
[t-SNE] Iteration 700: error = 1.8592633, gradient norm = 0.0000673 (50 iterations in 2.159s)
[t-SNE] Iteration 750: error = 1.8584002, gradient norm = 0.0000478 (50 iterations in 2.114s)
[t-SNE] Iteration 800: error = 1.8579599, gradient norm = 0.0000691 (50 iterations in 2.135s)
[t-SNE] Iteration 850: error = 1.8574545, gradient norm = 0.0000365 (50 iterations in 2.125s)
[t-SNE] Iteration 900: error = 1.8570759, gradient norm = 0.0000390 (50 iterations in 2.171s)
[t-SNE] Iteration 950: error = 1.8566210, gradient norm = 0.0000454 (50 iterations in 2.173s)
[t-SNE] Iteration 1000: error = 1.8563045, gradient norm = 0.0000344 (50 iterations in 2.140s)
[t-SNE] KL divergence after 1000 iterations: 1.856305
[t-SNE] Computed conditional probabilities for sample 1000 / 1608
[t-SNE] Computed conditional probabilities for sample 1608 / 1608
[t-SNE] Mean sigma: 0.256361
Beginning preprocessing + Leiden
2024-03-16 18:27:46.520933 MEMORY 17.786085376
Affmat transformed
2024-03-16 18:27:46.543790 MEMORY 17.786085376
sources, targets, weights extracted
2024-03-16 18:27:46.561512 MEMORY 17.786085376
About to launch parallel Leiden runs
2024-03-16 18:27:46.571145 MEMORY 17.786085376
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    5.4s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   18.1s finished
Parallel Leiden runs finished
2024-03-16 18:28:04.674141 MEMORY 17.786085376
Quality: 0.4289337285667052
Quality: 0.43019032378753913
Quality: 0.43061785595359053
Quality: 0.4325537416278678
Quality: 0.43410534312693755
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 759 out of 759 | elapsed:    0.4s finished
Got subclusters: Counter({0: 290, 1: 245, 2: 218, 3: 180, 4: 167, 5: 165, 6: 128, 7: 122, 8: 82, 9: 11})
On pattern 5
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 759 samples in 0.006s...
[t-SNE] Computed neighbors for 759 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 759 / 759
[t-SNE] Mean sigma: 0.287000
[t-SNE] Computed conditional probabilities in 0.055s
[t-SNE] Iteration 50: error = 70.8177261, gradient norm = 0.3608298 (50 iterations in 2.099s)
[t-SNE] Iteration 100: error = 70.9613419, gradient norm = 0.3457945 (50 iterations in 2.111s)
[t-SNE] Iteration 150: error = 71.3292770, gradient norm = 0.3535609 (50 iterations in 2.106s)
[t-SNE] Iteration 200: error = 72.4656525, gradient norm = 0.3337904 (50 iterations in 2.113s)
[t-SNE] Iteration 250: error = 69.5811386, gradient norm = 0.3746303 (50 iterations in 2.121s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 69.581139
[t-SNE] Iteration 300: error = 1.3652682, gradient norm = 0.0024263 (50 iterations in 2.136s)
[t-SNE] Iteration 350: error = 1.3282397, gradient norm = 0.0004265 (50 iterations in 2.104s)
[t-SNE] Iteration 400: error = 1.3163278, gradient norm = 0.0002879 (50 iterations in 2.108s)
[t-SNE] Iteration 450: error = 1.3120997, gradient norm = 0.0001397 (50 iterations in 2.102s)
[t-SNE] Iteration 500: error = 1.3094980, gradient norm = 0.0001564 (50 iterations in 2.110s)
[t-SNE] Iteration 550: error = 1.3076795, gradient norm = 0.0001454 (50 iterations in 2.098s)
[t-SNE] Iteration 600: error = 1.3057538, gradient norm = 0.0001007 (50 iterations in 2.085s)
[t-SNE] Iteration 650: error = 1.3052446, gradient norm = 0.0000855 (50 iterations in 2.109s)
[t-SNE] Iteration 700: error = 1.3052931, gradient norm = 0.0000649 (50 iterations in 2.105s)
[t-SNE] Iteration 750: error = 1.3050697, gradient norm = 0.0000524 (50 iterations in 2.101s)
[t-SNE] Iteration 800: error = 1.3043058, gradient norm = 0.0001638 (50 iterations in 2.106s)
[t-SNE] Iteration 850: error = 1.3036100, gradient norm = 0.0001578 (50 iterations in 2.090s)
[t-SNE] Iteration 900: error = 1.3031691, gradient norm = 0.0000482 (50 iterations in 2.138s)
[t-SNE] Iteration 950: error = 1.3030696, gradient norm = 0.0000735 (50 iterations in 2.106s)
[t-SNE] Iteration 1000: error = 1.3015245, gradient norm = 0.0001296 (50 iterations in 2.137s)
[t-SNE] KL divergence after 1000 iterations: 1.301525
[t-SNE] Computed conditional probabilities for sample 759 / 759
[t-SNE] Mean sigma: 0.287000
Beginning preprocessing + Leiden
2024-03-16 18:28:48.304658 MEMORY 17.786085376
Affmat transformed
2024-03-16 18:28:48.314917 MEMORY 17.786085376
sources, targets, weights extracted
2024-03-16 18:28:48.322849 MEMORY 17.786085376
About to launch parallel Leiden runs
2024-03-16 18:28:48.330801 MEMORY 17.786085376
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    2.2s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    6.9s finished
Parallel Leiden runs finished
2024-03-16 18:28:55.282753 MEMORY 17.786085376
Quality: 0.38561950498446695
Quality: 0.3922934416409607
Quality: 0.3930520085741666
Quality: 0.3931528569164816
Quality: 0.39367237024774665
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 757 out of 757 | elapsed:    0.4s finished
Got subclusters: Counter({0: 142, 1: 126, 2: 107, 3: 102, 4: 98, 5: 86, 6: 54, 7: 40, 8: 4})
On pattern 6
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 757 samples in 0.006s...
[t-SNE] Computed neighbors for 757 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 757 / 757
[t-SNE] Mean sigma: 0.350229
[t-SNE] Computed conditional probabilities in 0.053s
[t-SNE] Iteration 50: error = 66.7232590, gradient norm = 0.3844042 (50 iterations in 2.095s)
[t-SNE] Iteration 100: error = 68.3397827, gradient norm = 0.3959223 (50 iterations in 2.093s)
[t-SNE] Iteration 150: error = 67.7678604, gradient norm = 0.3661718 (50 iterations in 2.099s)
[t-SNE] Iteration 200: error = 70.0576782, gradient norm = 0.3395644 (50 iterations in 2.126s)
[t-SNE] Iteration 250: error = 68.6856689, gradient norm = 0.3716202 (50 iterations in 2.134s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 68.685669
[t-SNE] Iteration 300: error = 1.7214411, gradient norm = 0.0028864 (50 iterations in 2.097s)
[t-SNE] Iteration 350: error = 1.6462241, gradient norm = 0.0010081 (50 iterations in 2.107s)
[t-SNE] Iteration 400: error = 1.6055319, gradient norm = 0.0007938 (50 iterations in 2.081s)
[t-SNE] Iteration 450: error = 1.5886118, gradient norm = 0.0004341 (50 iterations in 2.090s)
[t-SNE] Iteration 500: error = 1.5808907, gradient norm = 0.0002796 (50 iterations in 2.101s)
[t-SNE] Iteration 550: error = 1.5763993, gradient norm = 0.0002036 (50 iterations in 2.125s)
[t-SNE] Iteration 600: error = 1.5745683, gradient norm = 0.0001098 (50 iterations in 2.100s)
[t-SNE] Iteration 650: error = 1.5724045, gradient norm = 0.0001547 (50 iterations in 2.090s)
[t-SNE] Iteration 700: error = 1.5719135, gradient norm = 0.0001469 (50 iterations in 2.100s)
[t-SNE] Iteration 750: error = 1.5702029, gradient norm = 0.0001198 (50 iterations in 2.116s)
[t-SNE] Iteration 800: error = 1.5696316, gradient norm = 0.0000820 (50 iterations in 2.095s)
[t-SNE] Iteration 850: error = 1.5692135, gradient norm = 0.0000876 (50 iterations in 2.088s)
[t-SNE] Iteration 900: error = 1.5690761, gradient norm = 0.0000837 (50 iterations in 2.089s)
[t-SNE] Iteration 950: error = 1.5690300, gradient norm = 0.0000671 (50 iterations in 2.097s)
[t-SNE] Iteration 1000: error = 1.5684329, gradient norm = 0.0000802 (50 iterations in 2.083s)
[t-SNE] KL divergence after 1000 iterations: 1.568433
[t-SNE] Computed conditional probabilities for sample 757 / 757
[t-SNE] Mean sigma: 0.350229
Beginning preprocessing + Leiden
2024-03-16 18:29:38.699672 MEMORY 17.786085376
Affmat transformed
2024-03-16 18:29:38.710764 MEMORY 17.786085376
sources, targets, weights extracted
2024-03-16 18:29:38.716905 MEMORY 17.786085376
About to launch parallel Leiden runs
2024-03-16 18:29:38.723537 MEMORY 17.786085376
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    2.1s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    6.1s finished
Parallel Leiden runs finished
2024-03-16 18:29:44.816134 MEMORY 17.786085376
Quality: 0.41063853279695817
Quality: 0.4113823676310833
Quality: 0.4118100115094437
Quality: 0.4119522184584335
Quality: 0.4136017771850738
Quality: 0.413856024163986
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 665 out of 665 | elapsed:    0.4s finished
Got subclusters: Counter({0: 135, 1: 134, 2: 114, 3: 108, 4: 96, 5: 90, 6: 80})
On pattern 7
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 665 samples in 0.006s...
[t-SNE] Computed neighbors for 665 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 665 / 665
[t-SNE] Mean sigma: 0.327267
[t-SNE] Computed conditional probabilities in 0.048s
[t-SNE] Iteration 50: error = 69.2313919, gradient norm = 0.4073049 (50 iterations in 2.078s)
[t-SNE] Iteration 100: error = 71.1331635, gradient norm = 0.3934479 (50 iterations in 2.093s)
[t-SNE] Iteration 150: error = 71.6099701, gradient norm = 0.3925533 (50 iterations in 2.095s)
[t-SNE] Iteration 200: error = 71.1461182, gradient norm = 0.3921070 (50 iterations in 2.111s)
[t-SNE] Iteration 250: error = 72.2727509, gradient norm = 0.3790432 (50 iterations in 2.112s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 72.272751
[t-SNE] Iteration 300: error = 1.7289842, gradient norm = 0.0035413 (50 iterations in 2.100s)
[t-SNE] Iteration 350: error = 1.6483639, gradient norm = 0.0013535 (50 iterations in 2.094s)
[t-SNE] Iteration 400: error = 1.6286924, gradient norm = 0.0004170 (50 iterations in 2.109s)
[t-SNE] Iteration 450: error = 1.6205468, gradient norm = 0.0002905 (50 iterations in 2.090s)
[t-SNE] Iteration 500: error = 1.6128707, gradient norm = 0.0003784 (50 iterations in 2.091s)
[t-SNE] Iteration 550: error = 1.6086558, gradient norm = 0.0002748 (50 iterations in 2.118s)
[t-SNE] Iteration 600: error = 1.6061298, gradient norm = 0.0002550 (50 iterations in 2.103s)
[t-SNE] Iteration 650: error = 1.6036716, gradient norm = 0.0002136 (50 iterations in 2.140s)
[t-SNE] Iteration 700: error = 1.6027673, gradient norm = 0.0002382 (50 iterations in 2.108s)
[t-SNE] Iteration 750: error = 1.6012361, gradient norm = 0.0001018 (50 iterations in 2.110s)
[t-SNE] Iteration 800: error = 1.6008937, gradient norm = 0.0000702 (50 iterations in 2.097s)
[t-SNE] Iteration 850: error = 1.5991565, gradient norm = 0.0002530 (50 iterations in 2.093s)
[t-SNE] Iteration 900: error = 1.5991690, gradient norm = 0.0000581 (50 iterations in 2.115s)
[t-SNE] Iteration 950: error = 1.5990280, gradient norm = 0.0000675 (50 iterations in 2.101s)
[t-SNE] Iteration 1000: error = 1.5990428, gradient norm = 0.0000512 (50 iterations in 2.097s)
[t-SNE] KL divergence after 1000 iterations: 1.599043
[t-SNE] Computed conditional probabilities for sample 665 / 665
[t-SNE] Mean sigma: 0.327267
Beginning preprocessing + Leiden
2024-03-16 18:30:28.235699 MEMORY 17.786085376
Affmat transformed
2024-03-16 18:30:28.246526 MEMORY 17.786085376
sources, targets, weights extracted
2024-03-16 18:30:28.252164 MEMORY 17.786085376
About to launch parallel Leiden runs
2024-03-16 18:30:28.258921 MEMORY 17.786085376
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.8s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    6.2s finished
Parallel Leiden runs finished
2024-03-16 18:30:34.512137 MEMORY 17.786085376
Quality: 0.3772925070703658
Quality: 0.3783835933872759
Quality: 0.3786375911539399
Quality: 0.378703396362709
Quality: 0.3787176983355388
Quality: 0.37896357596915686
Quality: 0.3789711134835753
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 628 out of 628 | elapsed:    0.3s finished
Got subclusters: Counter({0: 122, 1: 87, 3: 83, 2: 83, 4: 78, 5: 70, 6: 67, 7: 45, 8: 30})
On pattern 8
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 628 samples in 0.005s...
[t-SNE] Computed neighbors for 628 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 628 / 628
[t-SNE] Mean sigma: 0.341417
[t-SNE] Computed conditional probabilities in 0.048s
[t-SNE] Iteration 50: error = 68.0103607, gradient norm = 0.4342840 (50 iterations in 2.093s)
[t-SNE] Iteration 100: error = 70.0324326, gradient norm = 0.4072503 (50 iterations in 2.083s)
[t-SNE] Iteration 150: error = 71.8618622, gradient norm = 0.3876456 (50 iterations in 2.096s)
[t-SNE] Iteration 200: error = 72.0811996, gradient norm = 0.3813964 (50 iterations in 2.100s)
[t-SNE] Iteration 250: error = 73.1524658, gradient norm = 0.3919460 (50 iterations in 2.115s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 73.152466
[t-SNE] Iteration 300: error = 1.6340057, gradient norm = 0.0039804 (50 iterations in 2.085s)
[t-SNE] Iteration 350: error = 1.5607147, gradient norm = 0.0010651 (50 iterations in 2.109s)
[t-SNE] Iteration 400: error = 1.5335243, gradient norm = 0.0007794 (50 iterations in 2.076s)
[t-SNE] Iteration 450: error = 1.5237892, gradient norm = 0.0003057 (50 iterations in 2.132s)
[t-SNE] Iteration 500: error = 1.5154394, gradient norm = 0.0003630 (50 iterations in 2.090s)
[t-SNE] Iteration 550: error = 1.5091070, gradient norm = 0.0003462 (50 iterations in 2.113s)
[t-SNE] Iteration 600: error = 1.5049055, gradient norm = 0.0001889 (50 iterations in 2.092s)
[t-SNE] Iteration 650: error = 1.5009036, gradient norm = 0.0004406 (50 iterations in 2.089s)
[t-SNE] Iteration 700: error = 1.4881810, gradient norm = 0.0004582 (50 iterations in 2.098s)
[t-SNE] Iteration 750: error = 1.4841235, gradient norm = 0.0003685 (50 iterations in 2.095s)
[t-SNE] Iteration 800: error = 1.4829501, gradient norm = 0.0001249 (50 iterations in 2.118s)
[t-SNE] Iteration 850: error = 1.4823211, gradient norm = 0.0001062 (50 iterations in 2.078s)
[t-SNE] Iteration 900: error = 1.4814712, gradient norm = 0.0003544 (50 iterations in 2.089s)
[t-SNE] Iteration 950: error = 1.4802008, gradient norm = 0.0001732 (50 iterations in 2.168s)
[t-SNE] Iteration 1000: error = 1.4789022, gradient norm = 0.0001996 (50 iterations in 2.095s)
[t-SNE] KL divergence after 1000 iterations: 1.478902
[t-SNE] Computed conditional probabilities for sample 628 / 628
[t-SNE] Mean sigma: 0.341417
Beginning preprocessing + Leiden
2024-03-16 18:31:17.724403 MEMORY 17.786085376
Affmat transformed
2024-03-16 18:31:17.733788 MEMORY 17.786085376
sources, targets, weights extracted
2024-03-16 18:31:17.739624 MEMORY 17.786085376
About to launch parallel Leiden runs
2024-03-16 18:31:17.745458 MEMORY 17.786085376
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.8s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    5.6s finished
Parallel Leiden runs finished
2024-03-16 18:31:23.366735 MEMORY 17.786085376
Quality: 0.38126103072314455
Quality: 0.3833953218683538
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 606 out of 606 | elapsed:    0.3s finished
Got subclusters: Counter({0: 144, 1: 127, 2: 107, 3: 94, 4: 85, 5: 71})
On pattern 9
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 606 samples in 0.005s...
[t-SNE] Computed neighbors for 606 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 606 / 606
[t-SNE] Mean sigma: 0.350116
[t-SNE] Computed conditional probabilities in 0.043s
[t-SNE] Iteration 50: error = 68.2973557, gradient norm = 0.4248377 (50 iterations in 2.090s)
[t-SNE] Iteration 100: error = 70.2245483, gradient norm = 0.4193390 (50 iterations in 2.095s)
[t-SNE] Iteration 150: error = 69.9765778, gradient norm = 0.4094457 (50 iterations in 2.092s)
[t-SNE] Iteration 200: error = 71.1457367, gradient norm = 0.4014584 (50 iterations in 2.158s)
[t-SNE] Iteration 250: error = 71.6062317, gradient norm = 0.4017866 (50 iterations in 2.091s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 71.606232
[t-SNE] Iteration 300: error = 1.5594749, gradient norm = 0.0027955 (50 iterations in 2.083s)
[t-SNE] Iteration 350: error = 1.5014567, gradient norm = 0.0011104 (50 iterations in 2.112s)
[t-SNE] Iteration 400: error = 1.4655210, gradient norm = 0.0008900 (50 iterations in 2.113s)
[t-SNE] Iteration 450: error = 1.4539857, gradient norm = 0.0004396 (50 iterations in 2.090s)
[t-SNE] Iteration 500: error = 1.4483595, gradient norm = 0.0002277 (50 iterations in 2.157s)
[t-SNE] Iteration 550: error = 1.4459724, gradient norm = 0.0001090 (50 iterations in 2.094s)
[t-SNE] Iteration 600: error = 1.4450477, gradient norm = 0.0000917 (50 iterations in 2.084s)
[t-SNE] Iteration 650: error = 1.4448611, gradient norm = 0.0000897 (50 iterations in 2.090s)
[t-SNE] Iteration 700: error = 1.4435540, gradient norm = 0.0001620 (50 iterations in 2.103s)
[t-SNE] Iteration 750: error = 1.4431736, gradient norm = 0.0000617 (50 iterations in 2.087s)
[t-SNE] Iteration 800: error = 1.4430032, gradient norm = 0.0000453 (50 iterations in 2.089s)
[t-SNE] Iteration 850: error = 1.4429146, gradient norm = 0.0000456 (50 iterations in 2.166s)
[t-SNE] Iteration 900: error = 1.4428509, gradient norm = 0.0000450 (50 iterations in 2.084s)
[t-SNE] Iteration 950: error = 1.4428450, gradient norm = 0.0000479 (50 iterations in 2.102s)
[t-SNE] Iteration 1000: error = 1.4426510, gradient norm = 0.0000274 (50 iterations in 2.114s)
[t-SNE] KL divergence after 1000 iterations: 1.442651
[t-SNE] Computed conditional probabilities for sample 606 / 606
[t-SNE] Mean sigma: 0.350116
Beginning preprocessing + Leiden
2024-03-16 18:32:06.582002 MEMORY 17.786085376
Affmat transformed
2024-03-16 18:32:06.591389 MEMORY 17.786085376
sources, targets, weights extracted
2024-03-16 18:32:06.596142 MEMORY 17.786085376
About to launch parallel Leiden runs
2024-03-16 18:32:06.601775 MEMORY 17.786085376
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    5.2s finished
Parallel Leiden runs finished
2024-03-16 18:32:11.846570 MEMORY 17.786085376
Quality: 0.40785146862533544
Quality: 0.40881996612744476
Quality: 0.40886112396727964
Quality: 0.4088967695245823
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 536 out of 536 | elapsed:    0.2s finished
Got subclusters: Counter({0: 117, 1: 113, 2: 100, 3: 85, 4: 64, 5: 59, 6: 46, 7: 22})
On pattern 10
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 536 samples in 0.005s...
[t-SNE] Computed neighbors for 536 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 536 / 536
[t-SNE] Mean sigma: 0.337555
[t-SNE] Computed conditional probabilities in 0.039s
[t-SNE] Iteration 50: error = 69.2221375, gradient norm = 0.4406142 (50 iterations in 2.087s)
[t-SNE] Iteration 100: error = 72.1534271, gradient norm = 0.4143636 (50 iterations in 2.090s)
[t-SNE] Iteration 150: error = 70.3206711, gradient norm = 0.4338844 (50 iterations in 2.097s)
[t-SNE] Iteration 200: error = 73.5968628, gradient norm = 0.3872994 (50 iterations in 2.092s)
[t-SNE] Iteration 250: error = 74.0514069, gradient norm = 0.3922787 (50 iterations in 2.098s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 74.051407
[t-SNE] Iteration 300: error = 1.5845848, gradient norm = 0.0043223 (50 iterations in 2.101s)
[t-SNE] Iteration 350: error = 1.5075697, gradient norm = 0.0020649 (50 iterations in 2.091s)
[t-SNE] Iteration 400: error = 1.4380183, gradient norm = 0.0009124 (50 iterations in 2.123s)
[t-SNE] Iteration 450: error = 1.4141637, gradient norm = 0.0007768 (50 iterations in 2.084s)
[t-SNE] Iteration 500: error = 1.3972834, gradient norm = 0.0005078 (50 iterations in 2.116s)
[t-SNE] Iteration 550: error = 1.3877088, gradient norm = 0.0005655 (50 iterations in 2.089s)
[t-SNE] Iteration 600: error = 1.3793423, gradient norm = 0.0002887 (50 iterations in 2.097s)
[t-SNE] Iteration 650: error = 1.3700837, gradient norm = 0.0006106 (50 iterations in 2.129s)
[t-SNE] Iteration 700: error = 1.3603791, gradient norm = 0.0002918 (50 iterations in 2.079s)
[t-SNE] Iteration 750: error = 1.3543175, gradient norm = 0.0003954 (50 iterations in 2.110s)
[t-SNE] Iteration 800: error = 1.3473583, gradient norm = 0.0008341 (50 iterations in 2.094s)
[t-SNE] Iteration 850: error = 1.3398538, gradient norm = 0.0003010 (50 iterations in 2.086s)
[t-SNE] Iteration 900: error = 1.3396744, gradient norm = 0.0000799 (50 iterations in 2.095s)
[t-SNE] Iteration 950: error = 1.3396118, gradient norm = 0.0000731 (50 iterations in 2.093s)
[t-SNE] Iteration 1000: error = 1.3399415, gradient norm = 0.0000925 (50 iterations in 2.080s)
[t-SNE] KL divergence after 1000 iterations: 1.339942
[t-SNE] Computed conditional probabilities for sample 536 / 536
[t-SNE] Mean sigma: 0.337555
Beginning preprocessing + Leiden
2024-03-16 18:32:54.711508 MEMORY 17.786085376
Affmat transformed
2024-03-16 18:32:54.720718 MEMORY 17.786085376
sources, targets, weights extracted
2024-03-16 18:32:54.725485 MEMORY 17.786085376
About to launch parallel Leiden runs
2024-03-16 18:32:54.731082 MEMORY 17.786085376
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.5s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    5.0s finished
Parallel Leiden runs finished
2024-03-16 18:32:59.784458 MEMORY 17.786085376
Quality: 0.3720226990269349
Quality: 0.37296791823013037
Quality: 0.37429758905607613
Quality: 0.374648220732164
Quality: 0.3746953551435669
Quality: 0.3747020004973168
Quality: 0.3747042026449089
Quality: 0.37478502286033905
Quality: 0.37482189149182693
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 344 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 496 out of 496 | elapsed:    0.3s finished
Got subclusters: Counter({0: 116, 1: 107, 2: 107, 3: 95, 4: 69, 5: 38, 6: 4})
On pattern 11
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 496 samples in 0.004s...
[t-SNE] Computed neighbors for 496 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 496 / 496
[t-SNE] Mean sigma: 0.339319
[t-SNE] Computed conditional probabilities in 0.038s
[t-SNE] Iteration 50: error = 71.6338120, gradient norm = 0.4339153 (50 iterations in 2.081s)
[t-SNE] Iteration 100: error = 74.3415070, gradient norm = 0.4280170 (50 iterations in 2.113s)
[t-SNE] Iteration 150: error = 75.3078918, gradient norm = 0.3959291 (50 iterations in 2.207s)
[t-SNE] Iteration 200: error = 73.0028076, gradient norm = 0.4126201 (50 iterations in 2.095s)
[t-SNE] Iteration 250: error = 73.0734406, gradient norm = 0.4160991 (50 iterations in 2.112s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 73.073441
[t-SNE] Iteration 300: error = 1.3771065, gradient norm = 0.0046621 (50 iterations in 2.111s)
[t-SNE] Iteration 350: error = 1.2746435, gradient norm = 0.0021933 (50 iterations in 2.094s)
[t-SNE] Iteration 400: error = 1.2224798, gradient norm = 0.0009048 (50 iterations in 2.114s)
[t-SNE] Iteration 450: error = 1.1938988, gradient norm = 0.0011028 (50 iterations in 2.128s)
[t-SNE] Iteration 500: error = 1.1665680, gradient norm = 0.0010263 (50 iterations in 2.102s)
[t-SNE] Iteration 550: error = 1.1506360, gradient norm = 0.0005465 (50 iterations in 2.117s)
[t-SNE] Iteration 600: error = 1.1451145, gradient norm = 0.0003074 (50 iterations in 2.118s)
[t-SNE] Iteration 650: error = 1.1400723, gradient norm = 0.0001957 (50 iterations in 2.085s)
[t-SNE] Iteration 700: error = 1.1374865, gradient norm = 0.0001191 (50 iterations in 2.094s)
[t-SNE] Iteration 750: error = 1.1366647, gradient norm = 0.0001836 (50 iterations in 2.105s)
[t-SNE] Iteration 800: error = 1.1315941, gradient norm = 0.0002699 (50 iterations in 2.097s)
[t-SNE] Iteration 850: error = 1.1298161, gradient norm = 0.0001078 (50 iterations in 2.094s)
[t-SNE] Iteration 900: error = 1.1297139, gradient norm = 0.0000529 (50 iterations in 2.083s)
[t-SNE] Iteration 950: error = 1.1295207, gradient norm = 0.0001179 (50 iterations in 2.086s)
[t-SNE] Iteration 1000: error = 1.1294324, gradient norm = 0.0000507 (50 iterations in 2.093s)
[t-SNE] KL divergence after 1000 iterations: 1.129432
[t-SNE] Computed conditional probabilities for sample 496 / 496
[t-SNE] Mean sigma: 0.339319
Beginning preprocessing + Leiden
2024-03-16 18:33:42.915917 MEMORY 17.786085376
Affmat transformed
2024-03-16 18:33:42.923965 MEMORY 17.786085376
sources, targets, weights extracted
2024-03-16 18:33:42.928589 MEMORY 17.786085376
About to launch parallel Leiden runs
2024-03-16 18:33:42.950822 MEMORY 17.786085376
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.4s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    4.6s finished
Parallel Leiden runs finished
2024-03-16 18:33:47.528621 MEMORY 17.786085376
Quality: 0.4093168033685978
Quality: 0.4101304517449436
Quality: 0.41018352907565236
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 344 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 456 out of 456 | elapsed:    0.2s finished
Got subclusters: Counter({0: 93, 1: 88, 2: 87, 3: 86, 4: 52, 5: 36, 6: 29, 7: 20, 8: 5})
On pattern 12
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 456 samples in 0.004s...
[t-SNE] Computed neighbors for 456 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 456 / 456
[t-SNE] Mean sigma: 0.364686
[t-SNE] Computed conditional probabilities in 0.032s
[t-SNE] Iteration 50: error = 67.2550812, gradient norm = 0.4846382 (50 iterations in 2.080s)
[t-SNE] Iteration 100: error = 69.8884506, gradient norm = 0.4544815 (50 iterations in 2.084s)
[t-SNE] Iteration 150: error = 68.5006714, gradient norm = 0.4622019 (50 iterations in 2.116s)
[t-SNE] Iteration 200: error = 70.6272888, gradient norm = 0.4402282 (50 iterations in 2.109s)
[t-SNE] Iteration 250: error = 70.6285248, gradient norm = 0.4553622 (50 iterations in 2.089s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 70.628525
[t-SNE] Iteration 300: error = 1.3913933, gradient norm = 0.0036087 (50 iterations in 2.090s)
[t-SNE] Iteration 350: error = 1.3011838, gradient norm = 0.0015428 (50 iterations in 2.096s)
[t-SNE] Iteration 400: error = 1.2751267, gradient norm = 0.0014738 (50 iterations in 2.069s)
[t-SNE] Iteration 450: error = 1.2508034, gradient norm = 0.0013304 (50 iterations in 2.076s)
[t-SNE] Iteration 500: error = 1.2354665, gradient norm = 0.0005253 (50 iterations in 2.079s)
[t-SNE] Iteration 550: error = 1.2239307, gradient norm = 0.0005734 (50 iterations in 2.082s)
[t-SNE] Iteration 600: error = 1.2230245, gradient norm = 0.0001512 (50 iterations in 2.105s)
[t-SNE] Iteration 650: error = 1.2224457, gradient norm = 0.0001637 (50 iterations in 2.082s)
[t-SNE] Iteration 700: error = 1.2215081, gradient norm = 0.0000785 (50 iterations in 2.093s)
[t-SNE] Iteration 750: error = 1.2214359, gradient norm = 0.0000734 (50 iterations in 2.096s)
[t-SNE] Iteration 800: error = 1.2215536, gradient norm = 0.0000689 (50 iterations in 2.087s)
[t-SNE] Iteration 850: error = 1.2215729, gradient norm = 0.0000785 (50 iterations in 2.087s)
[t-SNE] Iteration 900: error = 1.2215396, gradient norm = 0.0000472 (50 iterations in 2.077s)
[t-SNE] Iteration 950: error = 1.2215288, gradient norm = 0.0000479 (50 iterations in 2.076s)
[t-SNE] Iteration 1000: error = 1.2214891, gradient norm = 0.0000976 (50 iterations in 2.072s)
[t-SNE] KL divergence after 1000 iterations: 1.221489
[t-SNE] Computed conditional probabilities for sample 456 / 456
[t-SNE] Mean sigma: 0.364686
Beginning preprocessing + Leiden
2024-03-16 18:34:30.127831 MEMORY 17.786085376
Affmat transformed
2024-03-16 18:34:30.134563 MEMORY 17.786085376
sources, targets, weights extracted
2024-03-16 18:34:30.138732 MEMORY 17.786085376
About to launch parallel Leiden runs
2024-03-16 18:34:30.161913 MEMORY 17.786085376
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.6s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    4.7s finished
Parallel Leiden runs finished
2024-03-16 18:34:34.840772 MEMORY 17.786085376
Quality: 0.3607375904184011
Quality: 0.3681654998504128
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 344 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 446 out of 446 | elapsed:    0.2s finished
Got subclusters: Counter({0: 103, 1: 78, 2: 77, 3: 76, 4: 68, 5: 27, 6: 27})
On pattern 13
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 446 samples in 0.004s...
[t-SNE] Computed neighbors for 446 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 446 / 446
[t-SNE] Mean sigma: 0.358198
[t-SNE] Computed conditional probabilities in 0.031s
[t-SNE] Iteration 50: error = 68.6937790, gradient norm = 0.4665870 (50 iterations in 2.085s)
[t-SNE] Iteration 100: error = 70.8963623, gradient norm = 0.4497656 (50 iterations in 2.083s)
[t-SNE] Iteration 150: error = 72.3129959, gradient norm = 0.4362941 (50 iterations in 2.106s)
[t-SNE] Iteration 200: error = 73.5048447, gradient norm = 0.3920576 (50 iterations in 2.086s)
[t-SNE] Iteration 250: error = 73.5808029, gradient norm = 0.4089555 (50 iterations in 2.076s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 73.580803
[t-SNE] Iteration 300: error = 1.4506936, gradient norm = 0.0038635 (50 iterations in 2.084s)
[t-SNE] Iteration 350: error = 1.2989206, gradient norm = 0.0028827 (50 iterations in 2.087s)
[t-SNE] Iteration 400: error = 1.2577548, gradient norm = 0.0009724 (50 iterations in 2.092s)
[t-SNE] Iteration 450: error = 1.2374704, gradient norm = 0.0015359 (50 iterations in 2.140s)
[t-SNE] Iteration 500: error = 1.2263376, gradient norm = 0.0004183 (50 iterations in 2.070s)
[t-SNE] Iteration 550: error = 1.2241528, gradient norm = 0.0002039 (50 iterations in 2.123s)
[t-SNE] Iteration 600: error = 1.2228818, gradient norm = 0.0002000 (50 iterations in 2.133s)
[t-SNE] Iteration 650: error = 1.2191153, gradient norm = 0.0002416 (50 iterations in 2.089s)
[t-SNE] Iteration 700: error = 1.2174299, gradient norm = 0.0002020 (50 iterations in 2.091s)
[t-SNE] Iteration 750: error = 1.2069166, gradient norm = 0.0004126 (50 iterations in 2.087s)
[t-SNE] Iteration 800: error = 1.2033603, gradient norm = 0.0002459 (50 iterations in 2.081s)
[t-SNE] Iteration 850: error = 1.2017926, gradient norm = 0.0001417 (50 iterations in 2.079s)
[t-SNE] Iteration 900: error = 1.2015908, gradient norm = 0.0000756 (50 iterations in 2.076s)
[t-SNE] Iteration 950: error = 1.2014550, gradient norm = 0.0000629 (50 iterations in 2.082s)
[t-SNE] Iteration 1000: error = 1.2014968, gradient norm = 0.0000543 (50 iterations in 2.079s)
[t-SNE] KL divergence after 1000 iterations: 1.201497
[t-SNE] Computed conditional probabilities for sample 446 / 446
[t-SNE] Mean sigma: 0.358198
Beginning preprocessing + Leiden
2024-03-16 18:35:17.511549 MEMORY 17.786085376
Affmat transformed
2024-03-16 18:35:17.518239 MEMORY 17.786085376
sources, targets, weights extracted
2024-03-16 18:35:17.522454 MEMORY 17.786085376
About to launch parallel Leiden runs
2024-03-16 18:35:17.527731 MEMORY 17.786085376
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.3s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    3.8s finished
Parallel Leiden runs finished
2024-03-16 18:35:21.348009 MEMORY 17.786085376
Quality: 0.35835182542089083
Quality: 0.3584981688087375
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 344 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 432 out of 432 | elapsed:    0.2s finished
Got subclusters: Counter({0: 83, 1: 77, 2: 76, 3: 70, 4: 51, 5: 42, 6: 31, 7: 16})
On pattern 14
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 432 samples in 0.004s...
[t-SNE] Computed neighbors for 432 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 432 / 432
[t-SNE] Mean sigma: 0.345033
[t-SNE] Computed conditional probabilities in 0.034s
[t-SNE] Iteration 50: error = 69.1117172, gradient norm = 0.4728210 (50 iterations in 2.073s)
[t-SNE] Iteration 100: error = 68.8531189, gradient norm = 0.4749955 (50 iterations in 2.076s)
[t-SNE] Iteration 150: error = 71.1602478, gradient norm = 0.4614703 (50 iterations in 2.088s)
[t-SNE] Iteration 200: error = 73.3831558, gradient norm = 0.4161820 (50 iterations in 2.110s)
[t-SNE] Iteration 250: error = 73.6871490, gradient norm = 0.4071238 (50 iterations in 2.091s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 73.687149
[t-SNE] Iteration 300: error = 1.3903065, gradient norm = 0.0044032 (50 iterations in 2.087s)
[t-SNE] Iteration 350: error = 1.2798735, gradient norm = 0.0019526 (50 iterations in 2.095s)
[t-SNE] Iteration 400: error = 1.2099116, gradient norm = 0.0016392 (50 iterations in 2.072s)
[t-SNE] Iteration 450: error = 1.1767138, gradient norm = 0.0008531 (50 iterations in 2.080s)
[t-SNE] Iteration 500: error = 1.1644955, gradient norm = 0.0010163 (50 iterations in 2.096s)
[t-SNE] Iteration 550: error = 1.1611696, gradient norm = 0.0007753 (50 iterations in 2.126s)
[t-SNE] Iteration 600: error = 1.1600218, gradient norm = 0.0001068 (50 iterations in 2.077s)
[t-SNE] Iteration 650: error = 1.1596498, gradient norm = 0.0000412 (50 iterations in 2.104s)
[t-SNE] Iteration 700: error = 1.1595060, gradient norm = 0.0000470 (50 iterations in 2.071s)
[t-SNE] Iteration 750: error = 1.1594464, gradient norm = 0.0000155 (50 iterations in 2.083s)
[t-SNE] Iteration 800: error = 1.1593935, gradient norm = 0.0000176 (50 iterations in 2.083s)
[t-SNE] Iteration 850: error = 1.1593013, gradient norm = 0.0000417 (50 iterations in 2.090s)
[t-SNE] Iteration 900: error = 1.1593045, gradient norm = 0.0000530 (50 iterations in 2.080s)
[t-SNE] Iteration 950: error = 1.1592183, gradient norm = 0.0000560 (50 iterations in 2.095s)
[t-SNE] Iteration 1000: error = 1.1591346, gradient norm = 0.0000569 (50 iterations in 2.092s)
[t-SNE] KL divergence after 1000 iterations: 1.159135
[t-SNE] Computed conditional probabilities for sample 432 / 432
[t-SNE] Mean sigma: 0.345033
Beginning preprocessing + Leiden
2024-03-16 18:36:03.901046 MEMORY 17.786085376
Affmat transformed
2024-03-16 18:36:03.907808 MEMORY 17.786085376
sources, targets, weights extracted
2024-03-16 18:36:03.911630 MEMORY 17.786085376
About to launch parallel Leiden runs
2024-03-16 18:36:03.916757 MEMORY 17.786085376
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.4s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    4.1s finished
Parallel Leiden runs finished
2024-03-16 18:36:07.983738 MEMORY 17.786085376
Quality: 0.36875352011976814
Quality: 0.37221982883498184
Quality: 0.3732502579017903
Quality: 0.3735747655125744
Quality: 0.3740972269116005
Quality: 0.3744275673005245
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 344 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 408 out of 408 | elapsed:    0.2s finished
Got subclusters: Counter({0: 126, 1: 84, 2: 81, 3: 71, 4: 33, 5: 14, 6: 12, 7: 11})
On pattern 15
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 408 samples in 0.004s...
[t-SNE] Computed neighbors for 408 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 408 / 408
[t-SNE] Mean sigma: 0.359492
[t-SNE] Computed conditional probabilities in 0.029s
[t-SNE] Iteration 50: error = 65.6069183, gradient norm = 0.5153194 (50 iterations in 2.082s)
[t-SNE] Iteration 100: error = 69.7928314, gradient norm = 0.4588795 (50 iterations in 2.076s)
[t-SNE] Iteration 150: error = 68.7017288, gradient norm = 0.4640142 (50 iterations in 2.126s)
[t-SNE] Iteration 200: error = 70.1109314, gradient norm = 0.4451568 (50 iterations in 2.099s)
[t-SNE] Iteration 250: error = 67.3073959, gradient norm = 0.4983963 (50 iterations in 2.105s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 67.307396
[t-SNE] Iteration 300: error = 1.3772334, gradient norm = 0.0042848 (50 iterations in 2.096s)
[t-SNE] Iteration 350: error = 1.2894624, gradient norm = 0.0014204 (50 iterations in 2.110s)
[t-SNE] Iteration 400: error = 1.2267075, gradient norm = 0.0018807 (50 iterations in 2.094s)
[t-SNE] Iteration 450: error = 1.1950125, gradient norm = 0.0008153 (50 iterations in 2.086s)
[t-SNE] Iteration 500: error = 1.1697875, gradient norm = 0.0014645 (50 iterations in 2.085s)
[t-SNE] Iteration 550: error = 1.1586486, gradient norm = 0.0008386 (50 iterations in 2.094s)
[t-SNE] Iteration 600: error = 1.1520212, gradient norm = 0.0003937 (50 iterations in 2.097s)
[t-SNE] Iteration 650: error = 1.1494669, gradient norm = 0.0002882 (50 iterations in 2.087s)
[t-SNE] Iteration 700: error = 1.1426953, gradient norm = 0.0003850 (50 iterations in 2.095s)
[t-SNE] Iteration 750: error = 1.1418929, gradient norm = 0.0000539 (50 iterations in 2.086s)
[t-SNE] Iteration 800: error = 1.1417121, gradient norm = 0.0000669 (50 iterations in 2.070s)
[t-SNE] Iteration 850: error = 1.1418120, gradient norm = 0.0000418 (50 iterations in 2.100s)
[t-SNE] Iteration 900: error = 1.1416879, gradient norm = 0.0000428 (50 iterations in 2.080s)
[t-SNE] Iteration 950: error = 1.1418731, gradient norm = 0.0000565 (50 iterations in 2.085s)
[t-SNE] Iteration 1000: error = 1.1419071, gradient norm = 0.0000550 (50 iterations in 2.091s)
[t-SNE] KL divergence after 1000 iterations: 1.141907
[t-SNE] Computed conditional probabilities for sample 408 / 408
[t-SNE] Mean sigma: 0.359492
Beginning preprocessing + Leiden
2024-03-16 18:36:50.592471 MEMORY 17.786085376
Affmat transformed
2024-03-16 18:36:50.599217 MEMORY 17.786085376
sources, targets, weights extracted
2024-03-16 18:36:50.602621 MEMORY 17.786085376
About to launch parallel Leiden runs
2024-03-16 18:36:50.620936 MEMORY 17.786085376
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.3s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    3.8s finished
Parallel Leiden runs finished
2024-03-16 18:36:54.447682 MEMORY 17.786085376
Quality: 0.37213301995352704
Quality: 0.3746474687968777
Quality: 0.37586145587042724
Quality: 0.3758972545901411
Quality: 0.37596993281984004
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 344 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 394 out of 394 | elapsed:    0.2s finished
Got subclusters: Counter({0: 102, 1: 83, 2: 69, 3: 35, 5: 34, 4: 34, 6: 26, 7: 25})
On pattern 16
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 394 samples in 0.004s...
[t-SNE] Computed neighbors for 394 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 394 / 394
[t-SNE] Mean sigma: 0.360829
[t-SNE] Computed conditional probabilities in 0.028s
[t-SNE] Iteration 50: error = 65.3643188, gradient norm = 0.4942019 (50 iterations in 2.074s)
[t-SNE] Iteration 100: error = 69.8602219, gradient norm = 0.4731478 (50 iterations in 2.078s)
[t-SNE] Iteration 150: error = 69.8045959, gradient norm = 0.4557546 (50 iterations in 2.089s)
[t-SNE] Iteration 200: error = 70.4065857, gradient norm = 0.4549926 (50 iterations in 2.100s)
[t-SNE] Iteration 250: error = 68.2627716, gradient norm = 0.4769942 (50 iterations in 2.100s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 68.262772
[t-SNE] Iteration 300: error = 1.1214657, gradient norm = 0.0053907 (50 iterations in 2.102s)
[t-SNE] Iteration 350: error = 1.0312788, gradient norm = 0.0015524 (50 iterations in 2.074s)
[t-SNE] Iteration 400: error = 0.9939851, gradient norm = 0.0014882 (50 iterations in 2.091s)
[t-SNE] Iteration 450: error = 0.9834788, gradient norm = 0.0009018 (50 iterations in 2.080s)
[t-SNE] Iteration 500: error = 0.9722222, gradient norm = 0.0008564 (50 iterations in 2.065s)
[t-SNE] Iteration 550: error = 0.9715918, gradient norm = 0.0001641 (50 iterations in 2.067s)
[t-SNE] Iteration 600: error = 0.9702840, gradient norm = 0.0001238 (50 iterations in 2.084s)
[t-SNE] Iteration 650: error = 0.9695314, gradient norm = 0.0001254 (50 iterations in 2.079s)
[t-SNE] Iteration 700: error = 0.9686745, gradient norm = 0.0002561 (50 iterations in 2.059s)
[t-SNE] Iteration 750: error = 0.9685262, gradient norm = 0.0000528 (50 iterations in 2.060s)
[t-SNE] Iteration 800: error = 0.9686700, gradient norm = 0.0000716 (50 iterations in 2.072s)
[t-SNE] Iteration 850: error = 0.9685678, gradient norm = 0.0000893 (50 iterations in 2.110s)
[t-SNE] Iteration 900: error = 0.9687881, gradient norm = 0.0000924 (50 iterations in 2.058s)
[t-SNE] Iteration 950: error = 0.9687382, gradient norm = 0.0000753 (50 iterations in 2.057s)
[t-SNE] Iteration 1000: error = 0.9686905, gradient norm = 0.0000517 (50 iterations in 2.071s)
[t-SNE] KL divergence after 1000 iterations: 0.968691
[t-SNE] Computed conditional probabilities for sample 394 / 394
[t-SNE] Mean sigma: 0.360829
Beginning preprocessing + Leiden
2024-03-16 18:37:36.754648 MEMORY 17.786085376
Affmat transformed
2024-03-16 18:37:36.761005 MEMORY 17.786085376
sources, targets, weights extracted
2024-03-16 18:37:36.764056 MEMORY 17.786085376
About to launch parallel Leiden runs
2024-03-16 18:37:36.769095 MEMORY 17.786085376
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.1s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    3.3s finished
Parallel Leiden runs finished
2024-03-16 18:37:40.093140 MEMORY 17.786085376
Quality: 0.4431355965530211
Quality: 0.4438430481452308
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 386 out of 386 | elapsed:    0.2s finished
Got subclusters: Counter({0: 82, 1: 81, 2: 74, 3: 69, 4: 31, 5: 31, 6: 21, 7: 5})
On pattern 17
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 386 samples in 0.004s...
[t-SNE] Computed neighbors for 386 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 386 / 386
[t-SNE] Mean sigma: 0.360926
[t-SNE] Computed conditional probabilities in 0.027s
[t-SNE] Iteration 50: error = 67.1359863, gradient norm = 0.4841180 (50 iterations in 2.052s)
[t-SNE] Iteration 100: error = 70.8005829, gradient norm = 0.4545333 (50 iterations in 2.066s)
[t-SNE] Iteration 150: error = 71.0258942, gradient norm = 0.4629867 (50 iterations in 2.117s)
[t-SNE] Iteration 200: error = 71.1349182, gradient norm = 0.4516743 (50 iterations in 2.071s)
[t-SNE] Iteration 250: error = 73.6842575, gradient norm = 0.4266579 (50 iterations in 2.052s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 73.684258
[t-SNE] Iteration 300: error = 1.3200145, gradient norm = 0.0049711 (50 iterations in 2.050s)
[t-SNE] Iteration 350: error = 1.1842693, gradient norm = 0.0020849 (50 iterations in 2.072s)
[t-SNE] Iteration 400: error = 1.1264896, gradient norm = 0.0010707 (50 iterations in 2.045s)
[t-SNE] Iteration 450: error = 1.1136019, gradient norm = 0.0007662 (50 iterations in 2.057s)
[t-SNE] Iteration 500: error = 1.1084195, gradient norm = 0.0003823 (50 iterations in 2.054s)
[t-SNE] Iteration 550: error = 1.0937951, gradient norm = 0.0011499 (50 iterations in 2.056s)
[t-SNE] Iteration 600: error = 1.0890263, gradient norm = 0.0003048 (50 iterations in 2.058s)
[t-SNE] Iteration 650: error = 1.0837897, gradient norm = 0.0002735 (50 iterations in 2.063s)
[t-SNE] Iteration 700: error = 1.0830280, gradient norm = 0.0002795 (50 iterations in 2.059s)
[t-SNE] Iteration 750: error = 1.0824596, gradient norm = 0.0001533 (50 iterations in 2.057s)
[t-SNE] Iteration 800: error = 1.0816572, gradient norm = 0.0001728 (50 iterations in 2.071s)
[t-SNE] Iteration 850: error = 1.0776476, gradient norm = 0.0003765 (50 iterations in 2.058s)
[t-SNE] Iteration 900: error = 1.0772367, gradient norm = 0.0000698 (50 iterations in 2.052s)
[t-SNE] Iteration 950: error = 1.0770842, gradient norm = 0.0000622 (50 iterations in 2.049s)
[t-SNE] Iteration 1000: error = 1.0770556, gradient norm = 0.0000563 (50 iterations in 2.099s)
[t-SNE] KL divergence after 1000 iterations: 1.077056
[t-SNE] Computed conditional probabilities for sample 386 / 386
[t-SNE] Mean sigma: 0.360926
Beginning preprocessing + Leiden
2024-03-16 18:38:22.052278 MEMORY 17.786085376
Affmat transformed
2024-03-16 18:38:22.058755 MEMORY 17.786085376
sources, targets, weights extracted
2024-03-16 18:38:22.062304 MEMORY 17.786085376
About to launch parallel Leiden runs
2024-03-16 18:38:22.096453 MEMORY 17.786085376
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.2s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    3.6s finished
Parallel Leiden runs finished
2024-03-16 18:38:25.719515 MEMORY 17.786085376
Quality: 0.36812438169589073
Quality: 0.3714385311446785
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 341 out of 341 | elapsed:    0.1s finished
Got subclusters: Counter({0: 114, 1: 88, 2: 69, 3: 61, 4: 44, 5: 10})
On pattern 18
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 341 samples in 0.003s...
[t-SNE] Computed neighbors for 341 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 341 / 341
[t-SNE] Mean sigma: 0.358613
[t-SNE] Computed conditional probabilities in 0.024s
[t-SNE] Iteration 50: error = 64.8919907, gradient norm = 0.4853600 (50 iterations in 2.047s)
[t-SNE] Iteration 100: error = 66.3727570, gradient norm = 0.4728916 (50 iterations in 2.071s)
[t-SNE] Iteration 150: error = 71.0939941, gradient norm = 0.4372191 (50 iterations in 2.053s)
[t-SNE] Iteration 200: error = 68.1749420, gradient norm = 0.4738274 (50 iterations in 2.089s)
[t-SNE] Iteration 250: error = 71.2675323, gradient norm = 0.4362366 (50 iterations in 2.049s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 71.267532
[t-SNE] Iteration 300: error = 1.2659681, gradient norm = 0.0050933 (50 iterations in 2.048s)
[t-SNE] Iteration 350: error = 1.1211982, gradient norm = 0.0021661 (50 iterations in 2.046s)
[t-SNE] Iteration 400: error = 1.0831680, gradient norm = 0.0024397 (50 iterations in 2.048s)
[t-SNE] Iteration 450: error = 1.0536408, gradient norm = 0.0014378 (50 iterations in 2.116s)
[t-SNE] Iteration 500: error = 1.0424608, gradient norm = 0.0005372 (50 iterations in 2.063s)
[t-SNE] Iteration 550: error = 1.0366783, gradient norm = 0.0004222 (50 iterations in 2.043s)
[t-SNE] Iteration 600: error = 1.0307692, gradient norm = 0.0003487 (50 iterations in 2.059s)
[t-SNE] Iteration 650: error = 1.0254118, gradient norm = 0.0006300 (50 iterations in 2.029s)
[t-SNE] Iteration 700: error = 1.0184178, gradient norm = 0.0012587 (50 iterations in 2.043s)
[t-SNE] Iteration 750: error = 1.0141391, gradient norm = 0.0002569 (50 iterations in 2.041s)
[t-SNE] Iteration 800: error = 1.0139805, gradient norm = 0.0000725 (50 iterations in 2.043s)
[t-SNE] Iteration 850: error = 1.0139718, gradient norm = 0.0000685 (50 iterations in 2.039s)
[t-SNE] Iteration 900: error = 1.0138692, gradient norm = 0.0000932 (50 iterations in 1.550s)
[t-SNE] Iteration 950: error = 1.0138761, gradient norm = 0.0000935 (50 iterations in 0.117s)
[t-SNE] Iteration 1000: error = 1.0137891, gradient norm = 0.0000637 (50 iterations in 0.248s)
[t-SNE] KL divergence after 1000 iterations: 1.013789
[t-SNE] Computed conditional probabilities for sample 341 / 341
[t-SNE] Mean sigma: 0.358613
Beginning preprocessing + Leiden
2024-03-16 18:39:03.150977 MEMORY 17.786085376
Affmat transformed
2024-03-16 18:39:03.156579 MEMORY 17.786085376
sources, targets, weights extracted
2024-03-16 18:39:03.159335 MEMORY 17.786085376
About to launch parallel Leiden runs
2024-03-16 18:39:03.165844 MEMORY 17.786085376
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.0s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    3.1s finished
Parallel Leiden runs finished
2024-03-16 18:39:06.241713 MEMORY 17.786085376
Quality: 0.34848408433545747
Quality: 0.3485511408613866
Quality: 0.34885631929254435
Quality: 0.3490506510382724
Quality: 0.3501188398802616
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 200 out of 247 | elapsed:    0.1s remaining:    0.0s
[Parallel(n_jobs=24)]: Done 247 out of 247 | elapsed:    0.1s finished
Got subclusters: Counter({0: 85, 1: 76, 2: 70, 3: 39, 4: 34, 5: 34, 6: 3})
On pattern 19
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 247 samples in 0.003s...
[t-SNE] Computed neighbors for 247 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 247 / 247
[t-SNE] Mean sigma: 0.387782
[t-SNE] Computed conditional probabilities in 0.018s
[t-SNE] Iteration 50: error = 65.1047287, gradient norm = 0.4873503 (50 iterations in 0.061s)
[t-SNE] Iteration 100: error = 62.2885513, gradient norm = 0.4981976 (50 iterations in 0.038s)
[t-SNE] Iteration 150: error = 61.4885979, gradient norm = 0.4940536 (50 iterations in 0.040s)
[t-SNE] Iteration 200: error = 60.9793701, gradient norm = 0.5286822 (50 iterations in 0.036s)
[t-SNE] Iteration 250: error = 63.8018074, gradient norm = 0.4649526 (50 iterations in 0.039s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 63.801807
[t-SNE] Iteration 300: error = 0.8834816, gradient norm = 0.0060190 (50 iterations in 0.037s)
[t-SNE] Iteration 350: error = 0.7090672, gradient norm = 0.0018936 (50 iterations in 0.035s)
[t-SNE] Iteration 400: error = 0.6820947, gradient norm = 0.0025296 (50 iterations in 0.035s)
[t-SNE] Iteration 450: error = 0.6772541, gradient norm = 0.0001736 (50 iterations in 0.035s)
[t-SNE] Iteration 500: error = 0.6773773, gradient norm = 0.0000903 (50 iterations in 0.036s)
[t-SNE] Iteration 550: error = 0.6774449, gradient norm = 0.0001020 (50 iterations in 0.034s)
[t-SNE] Iteration 600: error = 0.6772332, gradient norm = 0.0001155 (50 iterations in 0.035s)
[t-SNE] Iteration 650: error = 0.6772280, gradient norm = 0.0001438 (50 iterations in 0.038s)
[t-SNE] Iteration 700: error = 0.6772925, gradient norm = 0.0001194 (50 iterations in 0.036s)
[t-SNE] Iteration 750: error = 0.6771942, gradient norm = 0.0000938 (50 iterations in 0.036s)
[t-SNE] Iteration 800: error = 0.6775075, gradient norm = 0.0001793 (50 iterations in 0.038s)
[t-SNE] Iteration 850: error = 0.6773688, gradient norm = 0.0001397 (50 iterations in 0.035s)
[t-SNE] Iteration 900: error = 0.6771449, gradient norm = 0.0001394 (50 iterations in 0.036s)
[t-SNE] Iteration 950: error = 0.6772026, gradient norm = 0.0001709 (50 iterations in 0.035s)
[t-SNE] Iteration 1000: error = 0.6773762, gradient norm = 0.0001286 (50 iterations in 0.038s)
[t-SNE] KL divergence after 1000 iterations: 0.677376
[t-SNE] Computed conditional probabilities for sample 247 / 247
[t-SNE] Mean sigma: 0.387782
Beginning preprocessing + Leiden
2024-03-16 18:39:07.393795 MEMORY 17.786085376
Affmat transformed
2024-03-16 18:39:07.397692 MEMORY 17.786085376
sources, targets, weights extracted
2024-03-16 18:39:07.399424 MEMORY 17.786085376
About to launch parallel Leiden runs
2024-03-16 18:39:07.422662 MEMORY 17.786085376
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.8s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.4s finished
Parallel Leiden runs finished
2024-03-16 18:39:09.847484 MEMORY 17.786085376
Quality: 0.39822052299661703
Quality: 0.3985682506600614
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 186 out of 186 | elapsed:    0.1s finished
Got subclusters: Counter({0: 64, 1: 55, 2: 50, 3: 44, 4: 34})
On pattern 20
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 186 samples in 0.002s...
[t-SNE] Computed neighbors for 186 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 186 / 186
[t-SNE] Mean sigma: 0.475458
[t-SNE] Computed conditional probabilities in 0.013s
[t-SNE] Iteration 50: error = 61.6805878, gradient norm = 0.4581043 (50 iterations in 0.072s)
[t-SNE] Iteration 100: error = 59.7702637, gradient norm = 0.5157988 (50 iterations in 0.030s)
[t-SNE] Iteration 150: error = 61.3501549, gradient norm = 0.4959501 (50 iterations in 0.030s)
[t-SNE] Iteration 200: error = 56.5028381, gradient norm = 0.5530649 (50 iterations in 0.029s)
[t-SNE] Iteration 250: error = 58.4550858, gradient norm = 0.4890766 (50 iterations in 0.029s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 58.455086
[t-SNE] Iteration 300: error = 0.7316002, gradient norm = 0.0047298 (50 iterations in 0.029s)
[t-SNE] Iteration 350: error = 0.5953173, gradient norm = 0.0031844 (50 iterations in 0.031s)
[t-SNE] Iteration 400: error = 0.5734714, gradient norm = 0.0014175 (50 iterations in 0.030s)
[t-SNE] Iteration 450: error = 0.5728899, gradient norm = 0.0004270 (50 iterations in 0.032s)
[t-SNE] Iteration 500: error = 0.5731010, gradient norm = 0.0001665 (50 iterations in 0.032s)
[t-SNE] Iteration 550: error = 0.5730907, gradient norm = 0.0002118 (50 iterations in 0.030s)
[t-SNE] Iteration 600: error = 0.5728325, gradient norm = 0.0002928 (50 iterations in 0.028s)
[t-SNE] Iteration 650: error = 0.5726955, gradient norm = 0.0002250 (50 iterations in 0.029s)
[t-SNE] Iteration 700: error = 0.5728691, gradient norm = 0.0002130 (50 iterations in 0.028s)
[t-SNE] Iteration 750: error = 0.5729708, gradient norm = 0.0003053 (50 iterations in 0.028s)
[t-SNE] Iteration 800: error = 0.5728475, gradient norm = 0.0002510 (50 iterations in 0.028s)
[t-SNE] Iteration 850: error = 0.5729005, gradient norm = 0.0002236 (50 iterations in 0.028s)
[t-SNE] Iteration 900: error = 0.5728635, gradient norm = 0.0002939 (50 iterations in 0.030s)
[t-SNE] Iteration 950: error = 0.5730293, gradient norm = 0.0002708 (50 iterations in 0.029s)
[t-SNE] Iteration 1000: error = 0.5728546, gradient norm = 0.0002476 (50 iterations in 0.028s)
[t-SNE] Iteration 1000: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 1000 iterations: 0.572855
[t-SNE] Computed conditional probabilities for sample 186 / 186
[t-SNE] Mean sigma: 0.475458
Beginning preprocessing + Leiden
2024-03-16 18:39:10.806909 MEMORY 17.786085376
Affmat transformed
2024-03-16 18:39:10.809803 MEMORY 17.786085376
sources, targets, weights extracted
2024-03-16 18:39:10.810914 MEMORY 17.786085376
About to launch parallel Leiden runs
2024-03-16 18:39:10.815551 MEMORY 17.786085376
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.1s finished
Parallel Leiden runs finished
2024-03-16 18:39:12.957399 MEMORY 17.786085376
Quality: 0.3677045819200696
Quality: 0.3687041511644532
Quality: 0.36964991925439583
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 184 out of 184 | elapsed:    0.1s finished
Got subclusters: Counter({0: 61, 1: 44, 2: 41, 3: 40})
On pattern 21
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 184 samples in 0.002s...
[t-SNE] Computed neighbors for 184 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 184 / 184
[t-SNE] Mean sigma: 0.447550
[t-SNE] Computed conditional probabilities in 0.013s
[t-SNE] Iteration 50: error = 57.4640274, gradient norm = 0.5421488 (50 iterations in 0.031s)
[t-SNE] Iteration 100: error = 58.3092957, gradient norm = 0.4770520 (50 iterations in 0.034s)
[t-SNE] Iteration 150: error = 59.5652275, gradient norm = 0.4888670 (50 iterations in 0.031s)
[t-SNE] Iteration 200: error = 58.1405792, gradient norm = 0.4975308 (50 iterations in 0.031s)
[t-SNE] Iteration 250: error = 59.1857681, gradient norm = 0.5057236 (50 iterations in 0.032s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 59.185768
[t-SNE] Iteration 300: error = 0.8600593, gradient norm = 0.0100079 (50 iterations in 0.033s)
[t-SNE] Iteration 350: error = 0.6518767, gradient norm = 0.0038598 (50 iterations in 0.032s)
[t-SNE] Iteration 400: error = 0.5900617, gradient norm = 0.0010358 (50 iterations in 0.029s)
[t-SNE] Iteration 450: error = 0.5899917, gradient norm = 0.0002457 (50 iterations in 0.029s)
[t-SNE] Iteration 500: error = 0.5900502, gradient norm = 0.0001555 (50 iterations in 0.029s)
[t-SNE] Iteration 550: error = 0.5900264, gradient norm = 0.0001840 (50 iterations in 0.029s)
[t-SNE] Iteration 600: error = 0.5896404, gradient norm = 0.0003872 (50 iterations in 0.031s)
[t-SNE] Iteration 650: error = 0.5899025, gradient norm = 0.0001351 (50 iterations in 0.029s)
[t-SNE] Iteration 700: error = 0.5897333, gradient norm = 0.0001287 (50 iterations in 0.029s)
[t-SNE] Iteration 750: error = 0.5898150, gradient norm = 0.0001875 (50 iterations in 0.030s)
[t-SNE] Iteration 800: error = 0.5897997, gradient norm = 0.0001299 (50 iterations in 0.029s)
[t-SNE] Iteration 850: error = 0.5897474, gradient norm = 0.0001298 (50 iterations in 0.032s)
[t-SNE] Iteration 900: error = 0.5897643, gradient norm = 0.0000970 (50 iterations in 0.029s)
[t-SNE] Iteration 950: error = 0.5896599, gradient norm = 0.0001137 (50 iterations in 0.029s)
[t-SNE] Iteration 950: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 950 iterations: 0.589660
[t-SNE] Computed conditional probabilities for sample 184 / 184
[t-SNE] Mean sigma: 0.447550
Beginning preprocessing + Leiden
2024-03-16 18:39:13.857852 MEMORY 17.786085376
Affmat transformed
2024-03-16 18:39:13.862425 MEMORY 17.786085376
sources, targets, weights extracted
2024-03-16 18:39:13.863873 MEMORY 17.786085376
About to launch parallel Leiden runs
2024-03-16 18:39:13.869146 MEMORY 17.786085376
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.2s finished
Parallel Leiden runs finished
2024-03-16 18:39:16.043075 MEMORY 17.786085376
Quality: 0.337869655798903
Quality: 0.3382901650061858
Quality: 0.33931604752256855
Quality: 0.340061158593518
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 128 out of 128 | elapsed:    0.1s finished
Got subclusters: Counter({0: 55, 1: 47, 2: 31, 3: 30, 4: 21})
On pattern 22
[t-SNE] Computing 127 nearest neighbors...
[t-SNE] Indexed 128 samples in 0.001s...
[t-SNE] Computed neighbors for 128 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 128 / 128
[t-SNE] Mean sigma: 0.436657
[t-SNE] Computed conditional probabilities in 0.008s
[t-SNE] Iteration 50: error = 56.6679535, gradient norm = 0.5072456 (50 iterations in 0.024s)
[t-SNE] Iteration 100: error = 55.3367119, gradient norm = 0.5419287 (50 iterations in 0.026s)
[t-SNE] Iteration 150: error = 50.3960266, gradient norm = 0.5787858 (50 iterations in 0.026s)
[t-SNE] Iteration 200: error = 57.9948578, gradient norm = 0.4637631 (50 iterations in 0.024s)
[t-SNE] Iteration 250: error = 58.2305374, gradient norm = 0.4926041 (50 iterations in 0.026s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 58.230537
[t-SNE] Iteration 300: error = 0.8465934, gradient norm = 0.0091365 (50 iterations in 0.025s)
[t-SNE] Iteration 350: error = 0.6683527, gradient norm = 0.0062220 (50 iterations in 0.028s)
[t-SNE] Iteration 400: error = 0.4727603, gradient norm = 0.0048326 (50 iterations in 0.029s)
[t-SNE] Iteration 450: error = 0.4507980, gradient norm = 0.0007823 (50 iterations in 0.026s)
[t-SNE] Iteration 500: error = 0.4507791, gradient norm = 0.0004369 (50 iterations in 0.024s)
[t-SNE] Iteration 550: error = 0.4511077, gradient norm = 0.0003262 (50 iterations in 0.026s)
[t-SNE] Iteration 600: error = 0.4512506, gradient norm = 0.0002227 (50 iterations in 0.025s)
[t-SNE] Iteration 650: error = 0.4511532, gradient norm = 0.0001827 (50 iterations in 0.024s)
[t-SNE] Iteration 700: error = 0.4513602, gradient norm = 0.0002344 (50 iterations in 0.024s)
[t-SNE] Iteration 750: error = 0.4511667, gradient norm = 0.0001795 (50 iterations in 0.025s)
[t-SNE] Iteration 800: error = 0.4512623, gradient norm = 0.0001529 (50 iterations in 0.024s)
[t-SNE] Iteration 850: error = 0.4511619, gradient norm = 0.0002232 (50 iterations in 0.024s)
[t-SNE] Iteration 850: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 850 iterations: 0.451162
[t-SNE] Computed conditional probabilities for sample 128 / 128
[t-SNE] Mean sigma: 0.436656
Beginning preprocessing + Leiden
2024-03-16 18:39:16.704787 MEMORY 17.786085376
Affmat transformed
2024-03-16 18:39:16.706735 MEMORY 17.786085376
sources, targets, weights extracted
2024-03-16 18:39:16.707498 MEMORY 17.786085376
About to launch parallel Leiden runs
2024-03-16 18:39:16.712543 MEMORY 17.786085376
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.9s finished
Parallel Leiden runs finished
2024-03-16 18:39:18.603889 MEMORY 17.786085376
Quality: 0.26101295447388595
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 124 out of 124 | elapsed:    0.0s finished
Got subclusters: Counter({0: 41, 1: 28, 2: 24, 3: 16, 4: 13, 5: 6})
On pattern 23
[t-SNE] Computing 123 nearest neighbors...
[t-SNE] Indexed 124 samples in 0.001s...
[t-SNE] Computed neighbors for 124 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 124 / 124
[t-SNE] Mean sigma: 0.469823
[t-SNE] Computed conditional probabilities in 0.007s
[t-SNE] Iteration 50: error = 58.1434898, gradient norm = 0.4742220 (50 iterations in 0.052s)
[t-SNE] Iteration 100: error = 58.0533524, gradient norm = 0.4487336 (50 iterations in 0.024s)
[t-SNE] Iteration 150: error = 54.3948402, gradient norm = 0.5572605 (50 iterations in 0.024s)
[t-SNE] Iteration 200: error = 55.2601204, gradient norm = 0.5864375 (50 iterations in 0.025s)
[t-SNE] Iteration 250: error = 56.8873672, gradient norm = 0.4729723 (50 iterations in 0.024s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 56.887367
[t-SNE] Iteration 300: error = 0.9946844, gradient norm = 0.0085094 (50 iterations in 0.022s)
[t-SNE] Iteration 350: error = 0.4998820, gradient norm = 0.0130617 (50 iterations in 0.023s)
[t-SNE] Iteration 400: error = 0.4565414, gradient norm = 0.0013697 (50 iterations in 0.026s)
[t-SNE] Iteration 450: error = 0.4570660, gradient norm = 0.0003936 (50 iterations in 0.022s)
[t-SNE] Iteration 500: error = 0.4570545, gradient norm = 0.0004660 (50 iterations in 0.023s)
[t-SNE] Iteration 550: error = 0.4568354, gradient norm = 0.0003203 (50 iterations in 0.024s)
[t-SNE] Iteration 600: error = 0.4568394, gradient norm = 0.0002285 (50 iterations in 0.023s)
[t-SNE] Iteration 650: error = 0.4564484, gradient norm = 0.0001751 (50 iterations in 0.028s)
[t-SNE] Iteration 700: error = 0.4565965, gradient norm = 0.0002357 (50 iterations in 0.024s)
[t-SNE] Iteration 750: error = 0.4565622, gradient norm = 0.0002154 (50 iterations in 0.024s)
[t-SNE] Iteration 800: error = 0.4565260, gradient norm = 0.0001611 (50 iterations in 0.022s)
[t-SNE] Iteration 850: error = 0.4566759, gradient norm = 0.0002501 (50 iterations in 0.022s)
[t-SNE] Iteration 900: error = 0.4565674, gradient norm = 0.0001464 (50 iterations in 0.022s)
[t-SNE] Iteration 950: error = 0.4564505, gradient norm = 0.0001384 (50 iterations in 0.025s)
[t-SNE] Iteration 1000: error = 0.4564981, gradient norm = 0.0001356 (50 iterations in 0.022s)
[t-SNE] Iteration 1000: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 1000 iterations: 0.456498
[t-SNE] Computed conditional probabilities for sample 124 / 124
[t-SNE] Mean sigma: 0.469823
Beginning preprocessing + Leiden
2024-03-16 18:39:19.331218 MEMORY 17.786085376
Affmat transformed
2024-03-16 18:39:19.333498 MEMORY 17.786085376
sources, targets, weights extracted
2024-03-16 18:39:19.334295 MEMORY 17.786085376
About to launch parallel Leiden runs
2024-03-16 18:39:19.364304 MEMORY 17.786085376
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.9s finished
Parallel Leiden runs finished
2024-03-16 18:39:21.282947 MEMORY 17.786085376
Quality: 0.2769022515233745
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  93 out of  93 | elapsed:    0.0s finished
Got subclusters: Counter({0: 35, 1: 35, 2: 34, 3: 11, 4: 9})
On pattern 24
[t-SNE] Computing 92 nearest neighbors...
[t-SNE] Indexed 93 samples in 0.001s...
[t-SNE] Computed neighbors for 93 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 93 / 93
[t-SNE] Mean sigma: 0.510566
[t-SNE] Computed conditional probabilities in 0.004s
[t-SNE] Iteration 50: error = 57.6946526, gradient norm = 0.4637470 (50 iterations in 0.021s)
[t-SNE] Iteration 100: error = 52.1765823, gradient norm = 0.4534832 (50 iterations in 0.017s)
[t-SNE] Iteration 150: error = 53.4286613, gradient norm = 0.4569604 (50 iterations in 0.017s)
[t-SNE] Iteration 200: error = 52.3162193, gradient norm = 0.5469558 (50 iterations in 0.017s)
[t-SNE] Iteration 250: error = 53.3078613, gradient norm = 0.4812463 (50 iterations in 0.020s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 53.307861
[t-SNE] Iteration 300: error = 0.9050144, gradient norm = 0.0041048 (50 iterations in 0.017s)
[t-SNE] Iteration 350: error = 0.7804567, gradient norm = 0.0018408 (50 iterations in 0.017s)
[t-SNE] Iteration 400: error = 0.7189067, gradient norm = 0.0017475 (50 iterations in 0.017s)
[t-SNE] Iteration 450: error = 0.6361884, gradient norm = 0.0041509 (50 iterations in 0.017s)
[t-SNE] Iteration 500: error = 0.4852128, gradient norm = 0.0083584 (50 iterations in 0.017s)
[t-SNE] Iteration 550: error = 0.3064990, gradient norm = 0.0086676 (50 iterations in 0.018s)
[t-SNE] Iteration 600: error = 0.3025329, gradient norm = 0.0010586 (50 iterations in 0.017s)
[t-SNE] Iteration 650: error = 0.3023373, gradient norm = 0.0005605 (50 iterations in 0.019s)
[t-SNE] Iteration 700: error = 0.3023623, gradient norm = 0.0003585 (50 iterations in 0.018s)
[t-SNE] Iteration 750: error = 0.3021878, gradient norm = 0.0004706 (50 iterations in 0.018s)
[t-SNE] Iteration 800: error = 0.3022182, gradient norm = 0.0004597 (50 iterations in 0.017s)
[t-SNE] Iteration 850: error = 0.3023204, gradient norm = 0.0003684 (50 iterations in 0.017s)
[t-SNE] Iteration 900: error = 0.3023527, gradient norm = 0.0004053 (50 iterations in 0.018s)
[t-SNE] Iteration 950: error = 0.3023064, gradient norm = 0.0003155 (50 iterations in 0.017s)
[t-SNE] Iteration 1000: error = 0.3023612, gradient norm = 0.0004366 (50 iterations in 0.018s)
[t-SNE] KL divergence after 1000 iterations: 0.302361
[t-SNE] Computed conditional probabilities for sample 93 / 93
[t-SNE] Mean sigma: 0.510566
Beginning preprocessing + Leiden
2024-03-16 18:39:21.770390 MEMORY 17.786085376
Affmat transformed
2024-03-16 18:39:21.771706 MEMORY 17.786085376
sources, targets, weights extracted
2024-03-16 18:39:21.772297 MEMORY 17.786085376
About to launch parallel Leiden runs
2024-03-16 18:39:21.777165 MEMORY 17.786085376
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.8s finished
Parallel Leiden runs finished
2024-03-16 18:39:23.588171 MEMORY 17.786085376
Quality: 0.19771110260515082
Quality: 0.19836081825706903
Quality: 0.19929146840566547
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  89 out of  89 | elapsed:    0.0s finished
Got subclusters: Counter({0: 22, 1: 19, 2: 18, 3: 18, 4: 16})
On pattern 25
[t-SNE] Computing 88 nearest neighbors...
[t-SNE] Indexed 89 samples in 0.001s...
[t-SNE] Computed neighbors for 89 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 89 / 89
[t-SNE] Mean sigma: 0.529123
[t-SNE] Computed conditional probabilities in 0.004s
[t-SNE] Iteration 50: error = 53.5372238, gradient norm = 0.4623191 (50 iterations in 0.021s)
[t-SNE] Iteration 100: error = 52.5745964, gradient norm = 0.4469096 (50 iterations in 0.017s)
[t-SNE] Iteration 150: error = 53.2736397, gradient norm = 0.4605985 (50 iterations in 0.016s)
[t-SNE] Iteration 200: error = 53.7281570, gradient norm = 0.5447223 (50 iterations in 0.016s)
[t-SNE] Iteration 250: error = 51.9043083, gradient norm = 0.5522158 (50 iterations in 0.017s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 51.904308
[t-SNE] Iteration 300: error = 0.8909671, gradient norm = 0.0040126 (50 iterations in 0.017s)
[t-SNE] Iteration 350: error = 0.7738064, gradient norm = 0.0029242 (50 iterations in 0.020s)
[t-SNE] Iteration 400: error = 0.6831646, gradient norm = 0.0050035 (50 iterations in 0.016s)
[t-SNE] Iteration 450: error = 0.5657728, gradient norm = 0.0085137 (50 iterations in 0.016s)
[t-SNE] Iteration 500: error = 0.2062602, gradient norm = 0.0091198 (50 iterations in 0.017s)
[t-SNE] Iteration 550: error = 0.2002795, gradient norm = 0.0010780 (50 iterations in 0.016s)
[t-SNE] Iteration 600: error = 0.2003921, gradient norm = 0.0004520 (50 iterations in 0.016s)
[t-SNE] Iteration 650: error = 0.2002117, gradient norm = 0.0004884 (50 iterations in 0.017s)
[t-SNE] Iteration 700: error = 0.2003270, gradient norm = 0.0005148 (50 iterations in 0.017s)
[t-SNE] Iteration 750: error = 0.2003333, gradient norm = 0.0005217 (50 iterations in 0.017s)
[t-SNE] Iteration 800: error = 0.2004086, gradient norm = 0.0003218 (50 iterations in 0.017s)
[t-SNE] Iteration 850: error = 0.2004343, gradient norm = 0.0004952 (50 iterations in 0.016s)
[t-SNE] Iteration 900: error = 0.2004177, gradient norm = 0.0004316 (50 iterations in 0.016s)
[t-SNE] Iteration 950: error = 0.2004508, gradient norm = 0.0004513 (50 iterations in 0.016s)
[t-SNE] Iteration 1000: error = 0.2002536, gradient norm = 0.0005299 (50 iterations in 0.016s)
[t-SNE] Iteration 1000: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 1000 iterations: 0.200254
[t-SNE] Computed conditional probabilities for sample 89 / 89
[t-SNE] Mean sigma: 0.529123
Beginning preprocessing + Leiden
2024-03-16 18:39:24.043000 MEMORY 17.786085376
Affmat transformed
2024-03-16 18:39:24.044301 MEMORY 17.786085376
sources, targets, weights extracted
2024-03-16 18:39:24.044899 MEMORY 17.786085376
About to launch parallel Leiden runs
2024-03-16 18:39:24.049159 MEMORY 17.786085376
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.6s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.8s finished
Parallel Leiden runs finished
2024-03-16 18:39:25.859279 MEMORY 17.786085376
Quality: 0.1958257548335006
Quality: 0.19643444911903307
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  87 out of  87 | elapsed:    0.0s finished
Got subclusters: Counter({0: 35, 1: 25, 2: 17, 3: 6, 4: 6})
On pattern 26
[t-SNE] Computing 86 nearest neighbors...
[t-SNE] Indexed 87 samples in 0.001s...
[t-SNE] Computed neighbors for 87 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 87 / 87
[t-SNE] Mean sigma: 0.464757
[t-SNE] Computed conditional probabilities in 0.004s
[t-SNE] Iteration 50: error = 56.1754990, gradient norm = 0.4297958 (50 iterations in 0.036s)
[t-SNE] Iteration 100: error = 51.9907227, gradient norm = 0.4889104 (50 iterations in 0.016s)
[t-SNE] Iteration 150: error = 53.1932945, gradient norm = 0.4716511 (50 iterations in 0.017s)
[t-SNE] Iteration 200: error = 49.0459023, gradient norm = 0.5729645 (50 iterations in 0.017s)
[t-SNE] Iteration 250: error = 48.3653946, gradient norm = 0.6053138 (50 iterations in 0.016s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 48.365395
[t-SNE] Iteration 300: error = 0.8331446, gradient norm = 0.0043045 (50 iterations in 0.016s)
[t-SNE] Iteration 350: error = 0.6723517, gradient norm = 0.0058949 (50 iterations in 0.016s)
[t-SNE] Iteration 400: error = 0.5331105, gradient norm = 0.0083909 (50 iterations in 0.016s)
[t-SNE] Iteration 450: error = 0.2136503, gradient norm = 0.0064929 (50 iterations in 0.016s)
[t-SNE] Iteration 500: error = 0.2104940, gradient norm = 0.0008426 (50 iterations in 0.016s)
[t-SNE] Iteration 550: error = 0.2105556, gradient norm = 0.0007709 (50 iterations in 0.016s)
[t-SNE] Iteration 600: error = 0.2106271, gradient norm = 0.0008289 (50 iterations in 0.015s)
[t-SNE] Iteration 650: error = 0.2105384, gradient norm = 0.0007757 (50 iterations in 0.016s)
[t-SNE] Iteration 700: error = 0.2105357, gradient norm = 0.0007559 (50 iterations in 0.016s)
[t-SNE] Iteration 750: error = 0.2103671, gradient norm = 0.0006541 (50 iterations in 0.016s)
[t-SNE] Iteration 800: error = 0.2104587, gradient norm = 0.0007061 (50 iterations in 0.015s)
[t-SNE] Iteration 850: error = 0.2104932, gradient norm = 0.0006861 (50 iterations in 0.015s)
[t-SNE] Iteration 900: error = 0.2104621, gradient norm = 0.0009242 (50 iterations in 0.015s)
[t-SNE] Iteration 950: error = 0.2105254, gradient norm = 0.0009184 (50 iterations in 0.015s)
[t-SNE] Iteration 1000: error = 0.2103849, gradient norm = 0.0006611 (50 iterations in 0.016s)
[t-SNE] KL divergence after 1000 iterations: 0.210385
[t-SNE] Computed conditional probabilities for sample 87 / 87
[t-SNE] Mean sigma: 0.464757
Beginning preprocessing + Leiden
2024-03-16 18:39:26.320466 MEMORY 17.786085376
Affmat transformed
2024-03-16 18:39:26.321641 MEMORY 17.786085376
sources, targets, weights extracted
2024-03-16 18:39:26.322148 MEMORY 17.786085376
About to launch parallel Leiden runs
2024-03-16 18:39:26.327431 MEMORY 17.786085376
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.6s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.8s finished
Parallel Leiden runs finished
2024-03-16 18:39:28.111582 MEMORY 17.786085376
Quality: 0.18478356061023204
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  68 out of  68 | elapsed:    0.0s finished
Got subclusters: Counter({0: 33, 1: 28, 2: 26})
On pattern 27
[t-SNE] Computing 67 nearest neighbors...
[t-SNE] Indexed 68 samples in 0.001s...
[t-SNE] Computed neighbors for 68 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 68 / 68
[t-SNE] Mean sigma: 0.673118
[t-SNE] Computed conditional probabilities in 0.002s
[t-SNE] Iteration 50: error = 44.1612663, gradient norm = 0.5860776 (50 iterations in 0.015s)
[t-SNE] Iteration 100: error = 48.0460739, gradient norm = 0.4327721 (50 iterations in 0.012s)
[t-SNE] Iteration 150: error = 47.6660309, gradient norm = 0.6033575 (50 iterations in 0.012s)
[t-SNE] Iteration 200: error = 48.6857224, gradient norm = 0.5627262 (50 iterations in 0.012s)
[t-SNE] Iteration 250: error = 48.7468185, gradient norm = 0.5254304 (50 iterations in 0.012s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 48.746819
[t-SNE] Iteration 300: error = 0.8828039, gradient norm = 0.0014466 (50 iterations in 0.012s)
[t-SNE] Iteration 350: error = 0.7803130, gradient norm = 0.0009303 (50 iterations in 0.012s)
[t-SNE] Iteration 400: error = 0.7034711, gradient norm = 0.0008098 (50 iterations in 0.012s)
[t-SNE] Iteration 450: error = 0.6700576, gradient norm = 0.0004621 (50 iterations in 0.013s)
[t-SNE] Iteration 500: error = 0.6442594, gradient norm = 0.0004714 (50 iterations in 0.012s)
[t-SNE] Iteration 550: error = 0.6337769, gradient norm = 0.0004124 (50 iterations in 0.012s)
[t-SNE] Iteration 600: error = 0.6120690, gradient norm = 0.0010377 (50 iterations in 0.012s)
[t-SNE] Iteration 650: error = 0.5978178, gradient norm = 0.0002061 (50 iterations in 0.012s)
[t-SNE] Iteration 700: error = 0.5814496, gradient norm = 0.0005651 (50 iterations in 0.012s)
[t-SNE] Iteration 750: error = 0.5657150, gradient norm = 0.0004786 (50 iterations in 0.012s)
[t-SNE] Iteration 800: error = 0.5487630, gradient norm = 0.0003301 (50 iterations in 0.012s)
[t-SNE] Iteration 850: error = 0.5255802, gradient norm = 0.0008533 (50 iterations in 0.015s)
[t-SNE] Iteration 900: error = 0.5114987, gradient norm = 0.0183611 (50 iterations in 0.012s)
[t-SNE] Iteration 950: error = 0.9110001, gradient norm = 0.0127519 (50 iterations in 0.012s)
[t-SNE] Iteration 1000: error = 0.5804769, gradient norm = 0.0008449 (50 iterations in 0.012s)
[t-SNE] KL divergence after 1000 iterations: 0.580477
[t-SNE] Computed conditional probabilities for sample 68 / 68
[t-SNE] Mean sigma: 0.673118
Beginning preprocessing + Leiden
2024-03-16 18:39:28.452053 MEMORY 17.786085376
Affmat transformed
2024-03-16 18:39:28.452975 MEMORY 17.786085376
sources, targets, weights extracted
2024-03-16 18:39:28.453354 MEMORY 17.786085376
About to launch parallel Leiden runs
2024-03-16 18:39:28.458400 MEMORY 17.786085376
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.6s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.7s finished
Parallel Leiden runs finished
2024-03-16 18:39:30.161857 MEMORY 17.786085376
Quality: 0.2031078528443841
Got subclusters: Counter({0: 27, 1: 22, 2: 19})
On metacluster 0
Metacluster size 92497 limited to 20000
Relevant tasks:  ('head', 'testis')
Relevant signs:  (-1, -1)
TfModiscoSeqletsToPatternsFactory: seed=1234
(Round 1) num seqlets: 20000
(Round 1) Computing coarse affmat
2024-03-16 18:39:34.211866 MEMORY 17.783619584
Beginning embedding computation
MEMORY 17.783619584
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 152 tasks      | elapsed:    1.9s
[Parallel(n_jobs=24)]: Done 402 tasks      | elapsed:    4.7s
[Parallel(n_jobs=24)]: Done 752 tasks      | elapsed:    8.5s
[Parallel(n_jobs=24)]: Done 1202 tasks      | elapsed:   13.4s
[Parallel(n_jobs=24)]: Done 1752 tasks      | elapsed:   19.3s
[Parallel(n_jobs=24)]: Done 2402 tasks      | elapsed:   26.4s
[Parallel(n_jobs=24)]: Done 3152 tasks      | elapsed:   34.5s
[Parallel(n_jobs=24)]: Done 4002 tasks      | elapsed:   43.7s
[Parallel(n_jobs=24)]: Done 4952 tasks      | elapsed:   54.0s
[Parallel(n_jobs=24)]: Done 6002 tasks      | elapsed:  1.1min
[Parallel(n_jobs=24)]: Done 7152 tasks      | elapsed:  1.3min
[Parallel(n_jobs=24)]: Done 8402 tasks      | elapsed:  1.5min
[Parallel(n_jobs=24)]: Done 9752 tasks      | elapsed:  1.8min
[Parallel(n_jobs=24)]: Done 11202 tasks      | elapsed:  2.0min
[Parallel(n_jobs=24)]: Done 12752 tasks      | elapsed:  2.3min
[Parallel(n_jobs=24)]: Done 14402 tasks      | elapsed:  2.6min
[Parallel(n_jobs=24)]: Done 16152 tasks      | elapsed:  2.9min
[Parallel(n_jobs=24)]: Done 18002 tasks      | elapsed:  3.3min
[Parallel(n_jobs=24)]: Done 19952 tasks      | elapsed:  3.6min
[Parallel(n_jobs=24)]: Done 20000 out of 20000 | elapsed:  3.6min finished
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 152 tasks      | elapsed:    1.9s
[Parallel(n_jobs=24)]: Done 402 tasks      | elapsed:    4.6s
[Parallel(n_jobs=24)]: Done 752 tasks      | elapsed:    8.4s
[Parallel(n_jobs=24)]: Done 1202 tasks      | elapsed:   13.3s
[Parallel(n_jobs=24)]: Done 1752 tasks      | elapsed:   19.3s
[Parallel(n_jobs=24)]: Done 2402 tasks      | elapsed:   26.4s
[Parallel(n_jobs=24)]: Done 3152 tasks      | elapsed:   34.7s
[Parallel(n_jobs=24)]: Done 4002 tasks      | elapsed:   43.9s
[Parallel(n_jobs=24)]: Done 4952 tasks      | elapsed:   54.4s
[Parallel(n_jobs=24)]: Done 6002 tasks      | elapsed:  1.1min
[Parallel(n_jobs=24)]: Done 7152 tasks      | elapsed:  1.3min
[Parallel(n_jobs=24)]: Done 8402 tasks      | elapsed:  1.5min
[Parallel(n_jobs=24)]: Done 9752 tasks      | elapsed:  1.8min
[Parallel(n_jobs=24)]: Done 11202 tasks      | elapsed:  2.0min
[Parallel(n_jobs=24)]: Done 12752 tasks      | elapsed:  2.3min
[Parallel(n_jobs=24)]: Done 14402 tasks      | elapsed:  2.6min
[Parallel(n_jobs=24)]: Done 16152 tasks      | elapsed:  2.9min
[Parallel(n_jobs=24)]: Done 18002 tasks      | elapsed:  3.3min
[Parallel(n_jobs=24)]: Done 19952 tasks      | elapsed:  3.6min
[Parallel(n_jobs=24)]: Done 20000 out of 20000 | elapsed:  3.6min finished
At the beginning of embedding call
2024-03-16 18:39:34.212218 MEMORY 17.783619584
before computing embeddings fwd
2024-03-16 18:39:34.223139 MEMORY 17.78362368
after computing embeddings fwd
2024-03-16 18:43:11.827452 MEMORY 17.782849536
after computing embeddings rev
2024-03-16 18:46:50.240541 MEMORY 18.313682944
before computing sparse embeddings fwd
2024-03-16 18:46:50.240687 MEMORY 18.313682944
Constructing csr matrix...
csr matrix made in 2.4821300506591797 s
after computing sparse embeddings fwd
2024-03-16 18:46:53.604870 MEMORY 18.393800704
before computing sparse embeddings rev
2024-03-16 18:46:53.604974 MEMORY 18.393800704
Constructing csr matrix...
csr matrix made in 2.271085500717163 s
after computing sparse embeddings rev
2024-03-16 18:46:56.660979 MEMORY 18.47406592
Finished embedding computation in 445.24 s
MEMORY 18.005352448
Starting affinity matrix computations
MEMORY 18.005352448
Batching in slices of size 3355
  0%|          | 0/6 [00:00<?, ?it/s] 17%|â–ˆâ–‹        | 1/6 [00:08<00:44,  8.97s/it] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 2/6 [00:18<00:36,  9.03s/it] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 3/6 [00:27<00:27,  9.07s/it] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 4/6 [00:36<00:18,  9.06s/it] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 5/6 [00:45<00:09,  9.04s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:53<00:00,  8.93s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:53<00:00,  8.99s/it]
Finished affinity matrix computations in 54.08 s
MEMORY 18.00552448
(Round 1) Computed coarse affmat
2024-03-16 18:47:55.333280 MEMORY 17.844994048
(Round 1) Computing affinity matrix on nearest neighbors
2024-03-16 18:47:55.333423 MEMORY 17.844994048
Launching nearest neighbors affmat calculation job
MEMORY 17.92690176
Parallel runs completed
MEMORY 17.922695168
Job completed in: 70.01 s
MEMORY 17.922449408
Launching nearest neighbors affmat calculation job
MEMORY 17.920139264
Parallel runs completed
MEMORY 17.930354688
Job completed in: 70.41 s
MEMORY 17.928359936
(Round 1) Computed affinity matrix on nearest neighbors in 146.41 s
2024-03-16 18:50:21.748374 MEMORY 17.846489088
Filtered down to 18023 of 20000
(Round 1) Retained 18023 rows out of 20000 after filtering
2024-03-16 18:50:31.712136 MEMORY 17.846685696
(Round 1) Computing density adapted affmat
2024-03-16 18:50:36.733968 MEMORY 17.846685696
Symmetrizing nearest neighbors
Computing betas for density adaptation
Computing normalizing denominators
(Round 1) Computing clustering
2024-03-16 18:53:12.758039 MEMORY 17.833095168
Beginning preprocessing + Leiden
2024-03-16 18:53:12.782065 MEMORY 17.833095168
Affmat transformed
2024-03-16 18:53:12.782237 MEMORY 17.833095168
sources, targets, weights extracted
2024-03-16 18:53:13.434368 MEMORY 17.883619328
About to launch parallel Leiden runs
2024-03-16 18:53:13.600410 MEMORY 17.833086976
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:  1.7min
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:  6.0min finished
Parallel Leiden runs finished
2024-03-16 18:59:11.128536 MEMORY 17.833086976
Quality: 0.4991134964879385
Quality: 0.5000404791602292
Quality: 0.5000443430780286
Quality: 0.5000444854519493
Quality: 0.5000454094044289
Got 6 clusters after round 1
Counts:
{1: 3925, 0: 5643, 5: 1120, 4: 1721, 3: 2777, 2: 2837}
2024-03-16 18:59:11.182365 MEMORY 17.732042752
(Round 1) Aggregating seqlets in each cluster
2024-03-16 18:59:11.182504 MEMORY 17.732042752
Aggregating for cluster 0 with 5643 seqlets
2024-03-16 18:59:11.188486 MEMORY 17.732046848
Skipped 1 seqlets that went over sequence edge during flank expansion
Skipped 21 due to duplicates
Trimming eliminated 0 seqlets out of 5621
Aggregating for cluster 1 with 3925 seqlets
2024-03-16 18:59:26.717153 MEMORY 17.732050944
Skipped 1 seqlets that went over sequence edge during flank expansion
Skipped 32 due to duplicates
Trimming eliminated 0 seqlets out of 3892
Aggregating for cluster 2 with 2837 seqlets
2024-03-16 18:59:37.532355 MEMORY 17.732050944
Skipped 17 due to duplicates
Trimming eliminated 0 seqlets out of 2820
Aggregating for cluster 3 with 2777 seqlets
2024-03-16 18:59:45.718413 MEMORY 17.732071424
Skipped 1 seqlets that went over sequence edge during flank expansion
Skipped 3 due to duplicates
Trimming eliminated 0 seqlets out of 2773
Aggregating for cluster 4 with 1721 seqlets
2024-03-16 18:59:51.608570 MEMORY 17.732071424
Skipped 3 due to duplicates
Trimming eliminated 0 seqlets out of 1718
Aggregating for cluster 5 with 1120 seqlets
2024-03-16 18:59:55.242142 MEMORY 17.732071424
Skipped 1 seqlets that went over the sequence edge during flank expansion
Skipped 1 seqlets that went over sequence edge during flank expansion
Skipped 1 due to duplicates
Trimming eliminated 0 seqlets out of 1117
(Round 2) num seqlets: 17933
(Round 2) Computing coarse affmat
2024-03-16 18:59:59.765025 MEMORY 17.732071424
Beginning embedding computation
MEMORY 17.732071424
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 368 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done 1368 tasks      | elapsed:    2.1s
[Parallel(n_jobs=24)]: Done 2768 tasks      | elapsed:    4.2s
[Parallel(n_jobs=24)]: Done 4568 tasks      | elapsed:    6.7s
[Parallel(n_jobs=24)]: Done 6768 tasks      | elapsed:    9.8s
[Parallel(n_jobs=24)]: Done 9368 tasks      | elapsed:   13.5s
[Parallel(n_jobs=24)]: Done 12368 tasks      | elapsed:   17.6s
[Parallel(n_jobs=24)]: Done 15768 tasks      | elapsed:   22.2s
[Parallel(n_jobs=24)]: Done 17933 out of 17933 | elapsed:   25.0s finished
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 368 tasks      | elapsed:    0.8s
[Parallel(n_jobs=24)]: Done 1368 tasks      | elapsed:    2.1s
[Parallel(n_jobs=24)]: Done 2768 tasks      | elapsed:    3.9s
[Parallel(n_jobs=24)]: Done 4568 tasks      | elapsed:    6.3s
[Parallel(n_jobs=24)]: Done 6768 tasks      | elapsed:    9.2s
[Parallel(n_jobs=24)]: Done 9368 tasks      | elapsed:   12.5s
[Parallel(n_jobs=24)]: Done 12368 tasks      | elapsed:   16.3s
[Parallel(n_jobs=24)]: Done 15768 tasks      | elapsed:   20.7s
[Parallel(n_jobs=24)]: Done 17933 out of 17933 | elapsed:   23.5s finished
At the beginning of embedding call
2024-03-16 18:59:59.765255 MEMORY 17.732071424
before computing embeddings fwd
2024-03-16 18:59:59.773811 MEMORY 17.732071424
after computing embeddings fwd
2024-03-16 19:00:24.806174 MEMORY 17.951379456
after computing embeddings rev
2024-03-16 19:00:48.298650 MEMORY 18.671128576
before computing sparse embeddings fwd
2024-03-16 19:00:48.298743 MEMORY 18.671128576
Constructing csr matrix...
csr matrix made in 2.1636815071105957 s
after computing sparse embeddings fwd
2024-03-16 19:00:51.433167 MEMORY 18.742513664
before computing sparse embeddings rev
2024-03-16 19:00:51.433252 MEMORY 18.742513664
Constructing csr matrix...
csr matrix made in 1.9554345607757568 s
after computing sparse embeddings rev
2024-03-16 19:00:54.420010 MEMORY 18.849644544
Finished embedding computation in 57.93 s
MEMORY 18.263228416
Starting affinity matrix computations
MEMORY 18.26217984
Batching in slices of size 3742
  0%|          | 0/5 [00:00<?, ?it/s] 20%|â–ˆâ–ˆ        | 1/5 [00:09<00:39,  9.99s/it] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [00:19<00:29,  9.75s/it] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [00:29<00:19,  9.83s/it] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [00:39<00:10, 10.06s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [00:47<00:00,  9.07s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [00:47<00:00,  9.45s/it]
Finished affinity matrix computations in 47.32 s
MEMORY 18.262032384
(Round 2) Computed coarse affmat
2024-03-16 19:01:47.061066 MEMORY 18.083299328
(Round 2) Computing affinity matrix on nearest neighbors
2024-03-16 19:01:47.061224 MEMORY 18.083299328
Launching nearest neighbors affmat calculation job
MEMORY 18.083037184
Parallel runs completed
MEMORY 18.133016576
Job completed in: 33.31 s
MEMORY 18.130812928
Launching nearest neighbors affmat calculation job
MEMORY 18.128470016
Parallel runs completed
MEMORY 18.164887552
Job completed in: 33.16 s
MEMORY 18.16266752
(Round 2) Computed affinity matrix on nearest neighbors in 73.35 s
2024-03-16 19:03:00.438012 MEMORY 18.161299456
Not applying filtering for rounds above first round
2024-03-16 19:03:00.446562 MEMORY 18.161299456
(Round 2) Computing density adapted affmat
2024-03-16 19:03:07.623798 MEMORY 18.162036736
Symmetrizing nearest neighbors
Computing betas for density adaptation
Computing normalizing denominators
(Round 2) Computing clustering
2024-03-16 19:05:45.856409 MEMORY 18.306093056
Beginning preprocessing + Leiden
2024-03-16 19:05:45.881841 MEMORY 18.306093056
Affmat transformed
2024-03-16 19:05:45.881984 MEMORY 18.306093056
sources, targets, weights extracted
2024-03-16 19:05:46.575606 MEMORY 18.462048256
About to launch parallel Leiden runs
2024-03-16 19:05:46.725414 MEMORY 18.306093056
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:  1.4min
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:  4.8min finished
Parallel Leiden runs finished
2024-03-16 19:10:33.073600 MEMORY 18.307096576
Quality: 0.5832992485565924
Quality: 0.5835534013452671
Quality: 0.5839459338784686
Got 8 clusters after round 2
Counts:
{4: 2005, 2: 2750, 3: 2513, 6: 1355, 5: 1868, 1: 2983, 0: 3572, 7: 887}
2024-03-16 19:10:33.118732 MEMORY 18.151141376
(Round 2) Aggregating seqlets in each cluster
2024-03-16 19:10:33.118826 MEMORY 18.151141376
Aggregating for cluster 0 with 3572 seqlets
2024-03-16 19:10:33.126652 MEMORY 18.151141376
Skipped 3 due to duplicates
Trimming eliminated 0 seqlets out of 3569
Aggregating for cluster 1 with 2983 seqlets
2024-03-16 19:10:38.694548 MEMORY 18.15115776
Skipped 13 due to duplicates
Trimming eliminated 0 seqlets out of 2970
Aggregating for cluster 2 with 2750 seqlets
2024-03-16 19:10:43.881758 MEMORY 18.15115776
Skipped 3 due to duplicates
Trimming eliminated 0 seqlets out of 2747
Aggregating for cluster 3 with 2513 seqlets
2024-03-16 19:10:48.344625 MEMORY 18.15115776
Trimming eliminated 0 seqlets out of 2513
Aggregating for cluster 4 with 2005 seqlets
2024-03-16 19:10:54.351637 MEMORY 18.15115776
Skipped 6 due to duplicates
Trimming eliminated 0 seqlets out of 1999
Aggregating for cluster 5 with 1868 seqlets
2024-03-16 19:10:57.649465 MEMORY 18.15115776
Skipped 3 due to duplicates
Trimming eliminated 0 seqlets out of 1865
Aggregating for cluster 6 with 1355 seqlets
2024-03-16 19:11:00.763406 MEMORY 18.15115776
Trimming eliminated 0 seqlets out of 1355
Aggregating for cluster 7 with 887 seqlets
2024-03-16 19:11:03.144673 MEMORY 18.15115776
Skipped 5 due to duplicates
Trimming eliminated 0 seqlets out of 882
Got 8 clusters
Splitting into subclusters...
2024-03-16 19:11:04.591571 MEMORY 18.15115776
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 3315 tasks      | elapsed:    1.9s
[Parallel(n_jobs=24)]: Done 3569 out of 3569 | elapsed:    2.0s finished
Inspecting pattern 0 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 3569
[t-SNE] Computed conditional probabilities for sample 2000 / 3569
[t-SNE] Computed conditional probabilities for sample 3000 / 3569
[t-SNE] Computed conditional probabilities for sample 3569 / 3569
[t-SNE] Mean sigma: 0.302285
Beginning preprocessing + Leiden
2024-03-16 19:11:10.246570 MEMORY 18.151190528
Affmat transformed
2024-03-16 19:11:10.285918 MEMORY 18.151190528
sources, targets, weights extracted
2024-03-16 19:11:10.312441 MEMORY 18.151190528
About to launch parallel Leiden runs
2024-03-16 19:11:10.326941 MEMORY 18.151202816
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:   11.0s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   43.8s finished
Parallel Leiden runs finished
2024-03-16 19:11:54.101673 MEMORY 18.151202816
Quality: 0.5537345911702063
Quality: 0.5555196706800335
Quality: 0.5556496886639379
Quality: 0.556872726510668
Quality: 0.5569048888149191
Got subclusters: Counter({0: 672, 1: 575, 2: 463, 3: 435, 4: 347, 5: 340, 6: 223, 7: 207, 8: 168, 9: 139})
On merging iteration 1
Numbers for each pattern pre-subsample: [672, 575, 463, 435, 347, 340, 223, 207, 168, 139]
Numbers after subsampling: [300, 300, 300, 300, 300, 300, 223, 207, 168, 139]
Computing sims for pattern 0
Computed sims for pattern 0 in 3.703357696533203 s
Computing sims for pattern 1
Computed sims for pattern 1 in 3.7191946506500244 s
Computing sims for pattern 2
Computed sims for pattern 2 in 3.857126235961914 s
Computing sims for pattern 3
Computed sims for pattern 3 in 3.843238115310669 s
Computing sims for pattern 4
Computed sims for pattern 4 in 3.85288667678833 s
Computing sims for pattern 5
Computed sims for pattern 5 in 3.9569427967071533 s
Computing sims for pattern 6
Computed sims for pattern 6 in 3.590670108795166 s
Computing sims for pattern 7
Computed sims for pattern 7 in 3.003676176071167 s
Computing sims for pattern 8
Computed sims for pattern 8 in 2.3606181144714355 s
Computing sims for pattern 9
Computed sims for pattern 9 in 2.1634371280670166 s
Cluster sizes
[672 575 463 435 347 340 223 207 168 139]
Cross-contamination matrix:
[[1.   0.75 0.43 0.52 0.38 0.69 0.67 0.49 0.51 0.42]
 [0.69 1.   0.58 0.68 0.44 0.6  0.65 0.51 0.49 0.47]
 [0.5  0.71 1.   0.79 0.63 0.65 0.66 0.85 0.85 0.59]
 [0.46 0.66 0.63 1.   0.59 0.63 0.61 0.66 0.55 0.58]
 [0.43 0.57 0.63 0.74 1.   0.69 0.44 0.75 0.63 0.62]
 [0.64 0.61 0.53 0.66 0.57 1.   0.74 0.6  0.6  0.64]
 [0.53 0.57 0.46 0.55 0.28 0.65 1.   0.45 0.44 0.25]
 [0.29 0.36 0.55 0.49 0.45 0.41 0.36 1.   0.58 0.23]
 [0.53 0.58 0.79 0.64 0.59 0.66 0.62 0.81 1.   0.74]
 [0.23 0.3  0.25 0.39 0.32 0.41 0.2  0.27 0.43 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.89 0.75 0.76 0.69 0.93 0.94 0.71 0.7  0.53]
 [0.89 1.   0.81 0.81 0.69 0.82 0.86 0.68 0.64 0.56]
 [0.75 0.81 1.   0.82 0.76 0.74 0.74 0.82 0.86 0.61]
 [0.76 0.81 0.82 1.   0.79 0.79 0.79 0.75 0.74 0.63]
 [0.69 0.69 0.76 0.79 1.   0.74 0.63 0.73 0.75 0.56]
 [0.93 0.82 0.74 0.79 0.74 1.   0.89 0.73 0.74 0.62]
 [0.94 0.86 0.74 0.79 0.63 0.89 1.   0.7  0.74 0.48]
 [0.71 0.68 0.82 0.75 0.73 0.73 0.7  1.   0.8  0.47]
 [0.7  0.64 0.86 0.74 0.75 0.74 0.74 0.8  1.   0.68]
 [0.53 0.56 0.61 0.63 0.56 0.62 0.48 0.47 0.68 1.  ]]
Collapsing 0 & 6 with crosscontam 0.5318502120055724 and sim 0.9418829834990545
Collapsing 0 & 5 with crosscontam 0.6379766439506174 and sim 0.933696646797194
Collapsing 5 & 6 with crosscontam 0.6479880822518438 and sim 0.8949981200387312
Collapsing 0 & 1 with crosscontam 0.68770788345679 and sim 0.8906047126214691
Collapsing 1 & 6 with crosscontam 0.5698755139252358 and sim 0.8600538143540959
Collapsing 2 & 8 with crosscontam 0.7862149347172731 and sim 0.8596494051565433
Trimming eliminated 0 seqlets out of 895
Trimming eliminated 0 seqlets out of 1235
Trimming eliminated 0 seqlets out of 1810
Trimming eliminated 0 seqlets out of 631
Removed 1 duplicate seqlets
Unmerged patterns remapping: OrderedDict([(3, 2), (4, 3), (7, 4), (9, 5)])
Time spent on merging iteration: 11.987945795059204
On merging iteration 2
Numbers for each pattern pre-subsample: [1810, 630, 435, 347, 207, 139]
Numbers after subsampling: [300, 300, 300, 300, 207, 139]
Computing sims for pattern 0
Computed sims for pattern 0 in 2.1576290130615234 s
Computing sims for pattern 1
Computed sims for pattern 1 in 2.12089204788208 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.8728616237640381 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.8953180313110352 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.6958825588226318 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.49150824546813965 s
Cluster sizes
[1810  630  435  347  207  139]
Cross-contamination matrix:
[[1.   0.67 0.81 0.62 0.72 0.67]
 [0.62 1.   0.81 0.69 0.96 0.66]
 [0.53 0.58 1.   0.59 0.66 0.58]
 [0.49 0.61 0.74 1.   0.75 0.62]
 [0.32 0.56 0.49 0.45 1.   0.23]
 [0.26 0.31 0.39 0.32 0.27 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.74 0.8  0.71 0.72 0.54]
 [0.74 1.   0.79 0.77 0.85 0.6 ]
 [0.8  0.79 1.   0.79 0.75 0.63]
 [0.71 0.77 0.79 1.   0.73 0.56]
 [0.72 0.85 0.75 0.73 1.   0.47]
 [0.54 0.6  0.63 0.56 0.47 1.  ]]
Collapsing 1 & 4 with crosscontam 0.5634206928731382 and sim 0.8503194842120364
Trimming eliminated 0 seqlets out of 837
Unmerged patterns remapping: OrderedDict([(0, 0), (2, 2), (3, 3), (5, 4)])
Time spent on merging iteration: 1.7943329811096191
On merging iteration 3
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 2472 tasks      | elapsed:    1.1s
[Parallel(n_jobs=24)]: Done 2970 out of 2970 | elapsed:    1.3s finished
Numbers for each pattern pre-subsample: [1810, 837, 435, 347, 139]
Numbers after subsampling: [300, 300, 300, 300, 139]
Computing sims for pattern 0
Computed sims for pattern 0 in 0.4462423324584961 s
Computing sims for pattern 1
Computed sims for pattern 1 in 1.6925795078277588 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.42167186737060547 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.4263143539428711 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.24706768989562988 s
Cluster sizes
[1810  837  435  347  139]
Cross-contamination matrix:
[[1.   0.69 0.81 0.62 0.67]
 [0.6  1.   0.76 0.65 0.64]
 [0.53 0.58 1.   0.59 0.58]
 [0.49 0.6  0.74 1.   0.62]
 [0.26 0.31 0.39 0.32 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.72 0.8  0.71 0.54]
 [0.72 1.   0.73 0.73 0.55]
 [0.8  0.73 1.   0.79 0.63]
 [0.71 0.73 0.79 1.   0.56]
 [0.54 0.55 0.63 0.56 1.  ]]
Inspecting pattern 1 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 2970
[t-SNE] Computed conditional probabilities for sample 2000 / 2970
[t-SNE] Computed conditional probabilities for sample 2970 / 2970
[t-SNE] Mean sigma: 0.297897
Beginning preprocessing + Leiden
2024-03-16 19:12:55.323530 MEMORY 18.151305216
Affmat transformed
2024-03-16 19:12:55.358838 MEMORY 18.151305216
sources, targets, weights extracted
2024-03-16 19:12:55.384658 MEMORY 18.151305216
About to launch parallel Leiden runs
2024-03-16 19:12:55.397537 MEMORY 18.151305216
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    8.8s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   36.0s finished
Parallel Leiden runs finished
2024-03-16 19:13:31.353415 MEMORY 18.151305216
Quality: 0.5236379980060746
Quality: 0.5242372915500014
Quality: 0.5243543214937804
Quality: 0.5248489808480363
Quality: 0.5259901659835702
Quality: 0.5260063535989135
Quality: 0.527349719838758
Quality: 0.5280366980498553
Got subclusters: Counter({0: 557, 1: 523, 2: 334, 3: 330, 4: 297, 5: 282, 6: 247, 7: 238, 8: 107, 9: 55})
On merging iteration 1
Numbers for each pattern pre-subsample: [557, 523, 334, 330, 297, 282, 247, 238, 107, 55]
Numbers after subsampling: [300, 300, 300, 300, 297, 282, 247, 238, 107, 55]
Computing sims for pattern 0
Computed sims for pattern 0 in 3.5450401306152344 s
Computing sims for pattern 1
Computed sims for pattern 1 in 3.6692185401916504 s
Computing sims for pattern 2
Computed sims for pattern 2 in 3.72289776802063 s
Computing sims for pattern 3
Computed sims for pattern 3 in 3.5262451171875 s
Computing sims for pattern 4
Computed sims for pattern 4 in 3.66784405708313 s
Computing sims for pattern 5
Computed sims for pattern 5 in 5.955419063568115 s
Computing sims for pattern 6
Computed sims for pattern 6 in 2.694032907485962 s
Computing sims for pattern 7
Computed sims for pattern 7 in 3.4452991485595703 s
Computing sims for pattern 8
Computed sims for pattern 8 in 1.5881679058074951 s
Computing sims for pattern 9
Computed sims for pattern 9 in 1.0836536884307861 s
Cluster sizes
[557 523 334 330 297 282 247 238 107  55]
Cross-contamination matrix:
[[1.   0.51 0.52 0.5  0.61 0.78 0.73 0.64 0.55 0.62]
 [0.76 1.   0.74 0.81 0.6  0.69 0.49 0.42 0.68 0.63]
 [0.57 0.56 1.   0.84 0.58 0.79 0.64 0.53 0.32 0.42]
 [0.46 0.52 0.72 1.   0.49 0.63 0.69 0.42 0.31 0.47]
 [0.92 0.64 0.82 0.83 1.   0.9  0.81 0.78 0.54 0.55]
 [0.61 0.35 0.57 0.51 0.47 1.   0.68 0.57 0.41 0.36]
 [0.67 0.26 0.52 0.66 0.46 0.79 1.   0.64 0.39 0.35]
 [0.59 0.19 0.42 0.34 0.42 0.68 0.65 1.   0.73 0.18]
 [0.53 0.43 0.19 0.24 0.3  0.53 0.42 0.83 1.   0.16]
 [0.63 0.4  0.35 0.53 0.32 0.48 0.39 0.22 0.15 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.72 0.72 0.68 0.88 0.86 0.84 0.78 0.74 0.77]
 [0.72 1.   0.78 0.76 0.72 0.64 0.65 0.53 0.66 0.72]
 [0.72 0.78 1.   0.89 0.82 0.81 0.82 0.68 0.58 0.66]
 [0.68 0.76 0.89 1.   0.75 0.83 0.87 0.69 0.62 0.72]
 [0.88 0.72 0.82 0.75 1.   0.82 0.81 0.79 0.68 0.66]
 [0.86 0.64 0.81 0.83 0.82 1.   0.95 0.82 0.65 0.66]
 [0.84 0.65 0.82 0.87 0.81 0.95 1.   0.83 0.64 0.7 ]
 [0.78 0.53 0.68 0.69 0.79 0.82 0.83 1.   0.9  0.55]
 [0.74 0.66 0.58 0.62 0.68 0.65 0.64 0.9  1.   0.46]
 [0.77 0.72 0.66 0.72 0.66 0.66 0.7  0.55 0.46 1.  ]]
Collapsing 5 & 6 with crosscontam 0.6831783663577855 and sim 0.9490409082256983
Collapsing 7 & 8 with crosscontam 0.7340259131819464 and sim 0.8969911553284051
Collapsing 2 & 3 with crosscontam 0.7205076439506173 and sim 0.8949816037182323
Collapsing 0 & 4 with crosscontam 0.6111405427110612 and sim 0.8776010529320128
Collapsing 3 & 6 with crosscontam 0.6642524141202679 and sim 0.8679041452388984
Collapsing 0 & 5 with crosscontam 0.6134399529446068 and sim 0.8595431013203636
Trimming eliminated 0 seqlets out of 529
Trimming eliminated 0 seqlets out of 345
Trimming eliminated 0 seqlets out of 664
Trimming eliminated 0 seqlets out of 854
Skipped 2 due to duplicates
Trimming eliminated 0 seqlets out of 1191
Removed 1 duplicate seqlets
Skipped 1 due to duplicates
Trimming eliminated 0 seqlets out of 2043
Unmerged patterns remapping: OrderedDict([(1, 1), (9, 3)])
Time spent on merging iteration: 9.513349056243896
On merging iteration 2
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 2472 tasks      | elapsed:    1.1s
[Parallel(n_jobs=24)]: Done 2700 out of 2747 | elapsed:    1.2s remaining:    0.0s
[Parallel(n_jobs=24)]: Done 2747 out of 2747 | elapsed:    1.2s finished
Numbers for each pattern pre-subsample: [2043, 523, 345, 55]
Numbers after subsampling: [300, 300, 300, 55]
Computing sims for pattern 0
Computed sims for pattern 0 in 1.1401550769805908 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.8137919902801514 s
Computing sims for pattern 2
Computed sims for pattern 2 in 1.1956911087036133 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.245286226272583 s
Cluster sizes
[2043  523  345   55]
Cross-contamination matrix:
[[1.   0.8  0.91 0.84]
 [0.61 1.   0.61 0.63]
 [0.47 0.39 1.   0.26]
 [0.42 0.4  0.17 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.74 0.78 0.74]
 [0.74 1.   0.59 0.72]
 [0.78 0.59 1.   0.49]
 [0.74 0.72 0.49 1.  ]]
Inspecting pattern 2 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 2747
[t-SNE] Computed conditional probabilities for sample 2000 / 2747
[t-SNE] Computed conditional probabilities for sample 2747 / 2747
[t-SNE] Mean sigma: 0.258763
Beginning preprocessing + Leiden
2024-03-16 19:14:20.989112 MEMORY 18.151305216
Affmat transformed
2024-03-16 19:14:21.021429 MEMORY 18.151305216
sources, targets, weights extracted
2024-03-16 19:14:21.046317 MEMORY 18.151305216
About to launch parallel Leiden runs
2024-03-16 19:14:21.058518 MEMORY 18.151305216
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    9.1s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   30.5s finished
Parallel Leiden runs finished
2024-03-16 19:14:51.511520 MEMORY 18.151305216
Quality: 0.5281381230466738
Quality: 0.5286876585985083
Quality: 0.528783249602047
Quality: 0.5287993495694202
Got subclusters: Counter({0: 563, 1: 438, 2: 418, 3: 344, 4: 338, 5: 263, 6: 261, 7: 80, 8: 28, 9: 14})
On merging iteration 1
Numbers for each pattern pre-subsample: [563, 438, 418, 344, 338, 263, 261, 80, 28, 14]
Numbers after subsampling: [300, 300, 300, 300, 300, 263, 261, 80, 28, 14]
Computing sims for pattern 0
Computed sims for pattern 0 in 3.3426432609558105 s
Computing sims for pattern 1
Computed sims for pattern 1 in 3.4665064811706543 s
Computing sims for pattern 2
Computed sims for pattern 2 in 3.494940996170044 s
Computing sims for pattern 3
Computed sims for pattern 3 in 3.5166947841644287 s
Computing sims for pattern 4
Computed sims for pattern 4 in 5.909264087677002 s
Computing sims for pattern 5
Computed sims for pattern 5 in 2.9074506759643555 s
Computing sims for pattern 6
Computed sims for pattern 6 in 2.820477247238159 s
Computing sims for pattern 7
Computed sims for pattern 7 in 1.3021254539489746 s
Computing sims for pattern 8
Computed sims for pattern 8 in 0.6021780967712402 s
Computing sims for pattern 9
Computed sims for pattern 9 in 0.4357912540435791 s
Cluster sizes
[563 438 418 344 338 263 261  80  28  14]
Cross-contamination matrix:
[[1.   0.49 0.74 0.75 0.94 0.64 0.42 0.58 0.44 0.31]
 [0.74 1.   0.88 0.84 0.84 0.64 0.4  0.8  0.56 0.24]
 [0.68 0.52 1.   0.76 0.72 0.51 0.35 0.7  0.42 0.13]
 [0.78 0.59 0.85 1.   0.89 0.66 0.42 0.73 0.46 0.19]
 [0.83 0.43 0.65 0.73 1.   0.56 0.35 0.65 0.38 0.18]
 [0.93 0.67 0.87 0.93 0.98 1.   0.48 0.77 0.62 0.34]
 [0.82 0.57 0.85 0.82 0.89 0.61 1.   0.78 0.6  0.45]
 [0.4  0.35 0.58 0.51 0.59 0.32 0.22 1.   0.27 0.07]
 [0.3  0.22 0.35 0.29 0.36 0.26 0.16 0.31 1.   0.07]
 [0.41 0.18 0.22 0.21 0.35 0.24 0.25 0.23 0.18 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.9  0.93 0.93 0.97 0.92 0.83 0.85 0.8  0.71]
 [0.9  1.   0.93 0.95 0.93 0.9  0.76 0.87 0.76 0.61]
 [0.93 0.93 1.   0.97 0.95 0.93 0.87 0.88 0.78 0.56]
 [0.93 0.95 0.97 1.   0.96 0.94 0.84 0.88 0.77 0.59]
 [0.97 0.93 0.95 0.96 1.   0.93 0.84 0.93 0.82 0.67]
 [0.92 0.9  0.93 0.94 0.93 1.   0.78 0.85 0.75 0.61]
 [0.83 0.76 0.87 0.84 0.84 0.78 1.   0.77 0.73 0.6 ]
 [0.85 0.87 0.88 0.88 0.93 0.85 0.77 1.   0.74 0.57]
 [0.8  0.76 0.78 0.77 0.82 0.75 0.73 0.74 1.   0.65]
 [0.71 0.61 0.56 0.59 0.67 0.61 0.6  0.57 0.65 1.  ]]
Collapsing 2 & 3 with crosscontam 0.7598420928395062 and sim 0.9686009899571029
Collapsing 0 & 4 with crosscontam 0.8296226824691357 and sim 0.965011808905264
Collapsing 3 & 4 with crosscontam 0.7315262 and sim 0.9551713696253673
Collapsing 1 & 3 with crosscontam 0.5916399244444446 and sim 0.953472942976979
Collapsing 2 & 4 with crosscontam 0.6538396854320987 and sim 0.9518135644558684
Collapsing 3 & 5 with crosscontam 0.659334381636389 and sim 0.9412344981397254
Collapsing 0 & 2 with crosscontam 0.6772684790123455 and sim 0.9347911126391035
Collapsing 0 & 3 with crosscontam 0.7450371298765432 and sim 0.9313377361070992
Collapsing 1 & 4 with crosscontam 0.434270251851852 and sim 0.929559527442936
Collapsing 4 & 7 with crosscontam 0.5924545833333332 and sim 0.9285738102479207
Collapsing 4 & 5 with crosscontam 0.5637408691733559 and sim 0.9283829940212633
Collapsing 1 & 2 with crosscontam 0.5212487945679012 and sim 0.9271622034189138
Collapsing 2 & 5 with crosscontam 0.5069698143923391 and sim 0.9267969704456215
Collapsing 0 & 5 with crosscontam 0.6444012510913957 and sim 0.9221693143559878
Collapsing 1 & 5 with crosscontam 0.640686117448247 and sim 0.9042789766817197
Collapsing 2 & 7 with crosscontam 0.5785654947916667 and sim 0.8819711105741522
Collapsing 3 & 7 with crosscontam 0.5132813281249999 and sim 0.8769183979762423
Trimming eliminated 0 seqlets out of 762
Trimming eliminated 0 seqlets out of 901
Trimming eliminated 0 seqlets out of 1663
Trimming eliminated 0 seqlets out of 2101
Trimming eliminated 0 seqlets out of 2364
Trimming eliminated 0 seqlets out of 2444
Unmerged patterns remapping: OrderedDict([(6, 1), (8, 2), (9, 3)])
Time spent on merging iteration: 9.900258779525757
On merging iteration 2
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 2301 tasks      | elapsed:    1.0s
[Parallel(n_jobs=24)]: Done 2513 out of 2513 | elapsed:    1.0s finished
Numbers for each pattern pre-subsample: [2444, 261, 28, 14]
Numbers after subsampling: [300, 261, 28, 14]
Computing sims for pattern 0
Computed sims for pattern 0 in 1.013375997543335 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.3476278781890869 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.08451628684997559 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.059943199157714844 s
Cluster sizes
[2444  261   28   14]
Cross-contamination matrix:
[[1.   0.6  0.67 0.38]
 [0.77 1.   0.6  0.45]
 [0.29 0.16 1.   0.07]
 [0.29 0.25 0.18 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.84 0.81 0.65]
 [0.84 1.   0.73 0.6 ]
 [0.81 0.73 1.   0.65]
 [0.65 0.6  0.65 1.  ]]
Inspecting pattern 3 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 2513
[t-SNE] Computed conditional probabilities for sample 2000 / 2513
[t-SNE] Computed conditional probabilities for sample 2513 / 2513
[t-SNE] Mean sigma: 0.265120
Beginning preprocessing + Leiden
2024-03-16 19:15:34.669773 MEMORY 18.151305216
Affmat transformed
2024-03-16 19:15:34.698319 MEMORY 18.151305216
sources, targets, weights extracted
2024-03-16 19:15:34.720755 MEMORY 18.151305216
About to launch parallel Leiden runs
2024-03-16 19:15:34.734030 MEMORY 18.151297024
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    8.3s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   28.8s finished
Parallel Leiden runs finished
2024-03-16 19:16:03.581327 MEMORY 18.151297024
Quality: 0.529041322130264
Quality: 0.5307364979836979
Quality: 0.5315802740768704
Quality: 0.5316524257307536
Got subclusters: Counter({0: 624, 1: 559, 2: 469, 3: 414, 4: 329, 5: 118})
On merging iteration 1
Numbers for each pattern pre-subsample: [624, 559, 469, 414, 329, 118]
Numbers after subsampling: [300, 300, 300, 300, 300, 118]
Computing sims for pattern 0
Computed sims for pattern 0 in 1.7712993621826172 s
Computing sims for pattern 1
Computed sims for pattern 1 in 1.7751553058624268 s
Computing sims for pattern 2
Computed sims for pattern 2 in 1.8771214485168457 s
Computing sims for pattern 3
Computed sims for pattern 3 in 1.9330625534057617 s
Computing sims for pattern 4
Computed sims for pattern 4 in 2.010087490081787 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.9942941665649414 s
Cluster sizes
[624 559 469 414 329 118]
Cross-contamination matrix:
[[1.   0.44 0.54 0.21 0.28 0.28]
 [0.89 1.   0.71 0.54 0.69 0.72]
 [1.   0.73 1.   0.34 0.6  0.67]
 [0.85 0.83 0.58 1.   0.58 0.79]
 [0.87 0.92 0.81 0.51 1.   0.75]
 [0.62 0.7  0.64 0.48 0.52 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.88 0.9  0.85 0.83 0.75]
 [0.88 1.   0.91 0.89 0.94 0.89]
 [0.9  0.91 1.   0.77 0.89 0.87]
 [0.85 0.89 0.77 1.   0.84 0.84]
 [0.83 0.94 0.89 0.84 1.   0.87]
 [0.75 0.89 0.87 0.84 0.87 1.  ]]
Collapsing 1 & 4 with crosscontam 0.6888762227160492 and sim 0.9448989142376552
Collapsing 1 & 2 with crosscontam 0.7115801362962961 and sim 0.9085934376953076
Collapsing 0 & 2 with crosscontam 0.5356639209876544 and sim 0.9018204063355698
Collapsing 1 & 5 with crosscontam 0.7008655461366549 and sim 0.8945484145199067
Collapsing 2 & 4 with crosscontam 0.5995037841975308 and sim 0.8898099564018764
Collapsing 1 & 3 with crosscontam 0.5391944390123458 and sim 0.8893769348241964
Collapsing 4 & 5 with crosscontam 0.5227603276544015 and sim 0.8701842814858953
Collapsing 2 & 5 with crosscontam 0.6358093086440193 and sim 0.8697172309184161
Trimming eliminated 0 seqlets out of 888
Trimming eliminated 0 seqlets out of 1357
Trimming eliminated 0 seqlets out of 1981
Trimming eliminated 0 seqlets out of 2099
Skipped 1 due to duplicates
Trimming eliminated 0 seqlets out of 2512
Unmerged patterns remapping: OrderedDict()
Time spent on merging iteration: 13.01246690750122
On merging iteration 2
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 1812 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done 1952 out of 1999 | elapsed:    0.8s remaining:    0.0s
[Parallel(n_jobs=24)]: Done 1999 out of 1999 | elapsed:    0.8s finished
Numbers for each pattern pre-subsample: [2512]
Numbers after subsampling: [300]
Computing sims for pattern 0
Computed sims for pattern 0 in 1.33514404296875e-05 s
Cluster sizes
[2512]
Cross-contamination matrix:
[[1.]]
Pattern-to-pattern sim matrix:
[[1.]]
Inspecting pattern 4 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 1999
[t-SNE] Computed conditional probabilities for sample 1999 / 1999
[t-SNE] Mean sigma: 0.257277
Beginning preprocessing + Leiden
2024-03-16 19:16:31.691440 MEMORY 18.151305216
Affmat transformed
2024-03-16 19:16:31.714081 MEMORY 18.151305216
sources, targets, weights extracted
2024-03-16 19:16:31.731640 MEMORY 18.151305216
About to launch parallel Leiden runs
2024-03-16 19:16:31.741536 MEMORY 18.151305216
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    5.1s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   16.4s finished
Parallel Leiden runs finished
2024-03-16 19:16:48.181320 MEMORY 18.151305216
Quality: 0.5568580190414614
Quality: 0.557432825360189
Quality: 0.5575362465325581
Quality: 0.5575648752188088
Quality: 0.5576132722037835
Quality: 0.5576535393851773
Got subclusters: Counter({0: 354, 1: 328, 2: 321, 3: 305, 4: 286, 5: 195, 6: 110, 7: 51, 8: 49})
On merging iteration 1
Numbers for each pattern pre-subsample: [354, 328, 321, 305, 286, 195, 110, 51, 49]
Numbers after subsampling: [300, 300, 300, 300, 286, 195, 110, 51, 49]
Computing sims for pattern 0
Computed sims for pattern 0 in 3.0021870136260986 s
Computing sims for pattern 1
Computed sims for pattern 1 in 2.9943079948425293 s
Computing sims for pattern 2
Computed sims for pattern 2 in 3.1768908500671387 s
Computing sims for pattern 3
Computed sims for pattern 3 in 3.2173824310302734 s
Computing sims for pattern 4
Computed sims for pattern 4 in 2.9086902141571045 s
Computing sims for pattern 5
Computed sims for pattern 5 in 2.3535373210906982 s
Computing sims for pattern 6
Computed sims for pattern 6 in 1.3651621341705322 s
Computing sims for pattern 7
Computed sims for pattern 7 in 0.8371756076812744 s
Computing sims for pattern 8
Computed sims for pattern 8 in 0.7423994541168213 s
Cluster sizes
[354 328 321 305 286 195 110  51  49]
Cross-contamination matrix:
[[1.   0.62 0.84 0.43 0.63 0.47 0.64 0.32 0.41]
 [0.67 1.   0.92 0.57 0.82 0.54 0.71 0.31 0.36]
 [0.66 0.62 1.   0.36 0.59 0.37 0.63 0.25 0.23]
 [0.62 0.79 0.86 1.   0.87 0.52 0.62 0.39 0.43]
 [0.6  0.73 0.82 0.53 1.   0.47 0.57 0.23 0.28]
 [0.68 0.75 0.83 0.54 0.78 1.   0.75 0.27 0.46]
 [0.62 0.62 0.86 0.35 0.58 0.46 1.   0.24 0.29]
 [0.75 0.76 0.91 0.73 0.78 0.54 0.77 1.   0.57]
 [0.6  0.54 0.66 0.45 0.55 0.46 0.56 0.26 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.86 0.92 0.82 0.86 0.82 0.86 0.71 0.79]
 [0.86 1.   0.96 0.95 0.97 0.89 0.91 0.73 0.82]
 [0.92 0.96 1.   0.93 0.97 0.89 0.93 0.78 0.83]
 [0.82 0.95 0.93 1.   0.94 0.84 0.86 0.77 0.8 ]
 [0.86 0.97 0.97 0.94 1.   0.89 0.91 0.75 0.82]
 [0.82 0.89 0.89 0.84 0.89 1.   0.87 0.64 0.83]
 [0.86 0.91 0.93 0.86 0.91 0.87 1.   0.74 0.82]
 [0.71 0.73 0.78 0.77 0.75 0.64 0.74 1.   0.69]
 [0.79 0.82 0.83 0.8  0.82 0.83 0.82 0.69 1.  ]]
Collapsing 2 & 4 with crosscontam 0.5916394876974878 and sim 0.9733132113533771
Collapsing 1 & 4 with crosscontam 0.7313033163064948 and sim 0.9671924347814447
Collapsing 1 & 2 with crosscontam 0.6188677501234567 and sim 0.9581890468008453
Collapsing 1 & 3 with crosscontam 0.567243895802469 and sim 0.9524890571198257
Collapsing 3 & 4 with crosscontam 0.5327157334165011 and sim 0.9412006170901039
Collapsing 2 & 3 with crosscontam 0.3559627293827159 and sim 0.9327666427469778
Collapsing 2 & 6 with crosscontam 0.6277376781144779 and sim 0.9314912989657579
Collapsing 0 & 2 with crosscontam 0.6598359239506173 and sim 0.924077628556253
Collapsing 1 & 6 with crosscontam 0.624562434259955 and sim 0.9135431220509217
Collapsing 4 & 6 with crosscontam 0.5698397237578972 and sim 0.9102950182473869
Collapsing 1 & 5 with crosscontam 0.5440814579297246 and sim 0.8877428662749891
Collapsing 0 & 6 with crosscontam 0.6169375306786877 and sim 0.8597794652899704
Collapsing 0 & 4 with crosscontam 0.5970275354423724 and sim 0.8597608547804592
Collapsing 0 & 1 with crosscontam 0.6183212241975309 and sim 0.855503108043659
Trimming eliminated 0 seqlets out of 607
Trimming eliminated 0 seqlets out of 935
Trimming eliminated 0 seqlets out of 1240
Trimming eliminated 0 seqlets out of 1350
Trimming eliminated 0 seqlets out of 1704
Trimming eliminated 0 seqlets out of 1899
Unmerged patterns remapping: OrderedDict([(7, 1), (8, 2)])
Time spent on merging iteration: 8.247053623199463
On merging iteration 2
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 1635 tasks      | elapsed:    0.6s
[Parallel(n_jobs=24)]: Done 1865 out of 1865 | elapsed:    0.7s finished
Numbers for each pattern pre-subsample: [1899, 51, 49]
Numbers after subsampling: [300, 51, 49]
Computing sims for pattern 0
Computed sims for pattern 0 in 0.6492199897766113 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.11766695976257324 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.10864901542663574 s
Cluster sizes
[1899   51   49]
Cross-contamination matrix:
[[1.   0.44 0.51]
 [0.78 1.   0.57]
 [0.57 0.26 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.77 0.85]
 [0.77 1.   0.69]
 [0.85 0.69 1.  ]]
Inspecting pattern 5 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 1865
[t-SNE] Computed conditional probabilities for sample 1865 / 1865
[t-SNE] Mean sigma: 0.267244
Beginning preprocessing + Leiden
2024-03-16 19:17:20.356774 MEMORY 18.151305216
Affmat transformed
2024-03-16 19:17:20.378402 MEMORY 18.151305216
sources, targets, weights extracted
2024-03-16 19:17:20.396186 MEMORY 18.151305216
About to launch parallel Leiden runs
2024-03-16 19:17:20.406167 MEMORY 18.151305216
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    5.0s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   16.6s finished
Parallel Leiden runs finished
2024-03-16 19:17:37.054265 MEMORY 18.151305216
Quality: 0.5388843746913882
Quality: 0.538974996467645
Quality: 0.5389929515809655
Quality: 0.5390225797272135
Got subclusters: Counter({0: 511, 1: 386, 2: 379, 3: 342, 4: 194, 5: 27, 6: 15, 7: 9, 8: 2})
On merging iteration 1
Numbers for each pattern pre-subsample: [511, 386, 379, 342, 194, 27, 15, 9, 2]
Numbers after subsampling: [300, 300, 300, 300, 194, 27, 15, 9, 2]
Computing sims for pattern 0
Computed sims for pattern 0 in 2.8371081352233887 s
Computing sims for pattern 1
Computed sims for pattern 1 in 2.8542845249176025 s
Computing sims for pattern 2
Computed sims for pattern 2 in 6.179932594299316 s
Computing sims for pattern 3
Computed sims for pattern 3 in 2.8891942501068115 s
Computing sims for pattern 4
Computed sims for pattern 4 in 2.039937973022461 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.4447593688964844 s
Computing sims for pattern 6
Computed sims for pattern 6 in 0.33048391342163086 s
Computing sims for pattern 7
Computed sims for pattern 7 in 0.27411961555480957 s
Computing sims for pattern 8
Computed sims for pattern 8 in 0.21138381958007812 s
Cluster sizes
[511 386 379 342 194  27  15   9   2]
Cross-contamination matrix:
[[1.   0.94 0.5  0.71 0.74 0.72 0.04 0.41 0.39]
 [0.58 1.   0.26 0.62 0.67 0.49 0.01 0.2  0.27]
 [0.64 0.63 1.   0.46 0.44 0.49 0.04 0.67 0.06]
 [0.65 0.91 0.3  1.   0.81 0.41 0.02 0.16 0.34]
 [0.68 0.96 0.29 0.81 1.   0.44 0.03 0.23 0.31]
 [0.3  0.42 0.09 0.14 0.15 1.   0.   0.04 0.  ]
 [0.05 0.04 0.03 0.04 0.05 0.02 1.   0.04 0.01]
 [0.34 0.35 0.47 0.14 0.22 0.03 0.01 1.   0.02]
 [0.   0.   0.   0.   0.   0.   0.   0.   1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.91 0.78 0.87 0.89 0.8  0.32 0.74 0.69]
 [0.91 1.   0.69 0.92 0.94 0.8  0.32 0.71 0.73]
 [0.78 0.69 1.   0.66 0.67 0.62 0.16 0.73 0.49]
 [0.87 0.92 0.66 1.   0.96 0.64 0.38 0.61 0.66]
 [0.89 0.94 0.67 0.96 1.   0.64 0.39 0.67 0.69]
 [0.8  0.8  0.62 0.64 0.64 1.   0.14 0.54 0.56]
 [0.32 0.32 0.16 0.38 0.39 0.14 1.   0.25 0.27]
 [0.74 0.71 0.73 0.61 0.67 0.54 0.25 1.   0.54]
 [0.69 0.73 0.49 0.66 0.69 0.56 0.27 0.54 1.  ]]
Collapsing 3 & 4 with crosscontam 0.8092337067583049 and sim 0.9550011287818404
Collapsing 1 & 4 with crosscontam 0.6675673570064911 and sim 0.943231557315057
Collapsing 1 & 3 with crosscontam 0.6233016054320988 and sim 0.9154145535458516
Collapsing 0 & 1 with crosscontam 0.5840865160493827 and sim 0.913799300748003
Collapsing 0 & 4 with crosscontam 0.6825258243277348 and sim 0.88693251266226
Collapsing 0 & 3 with crosscontam 0.654823434074074 and sim 0.8746251778929087
Trimming eliminated 0 seqlets out of 536
Trimming eliminated 0 seqlets out of 922
Trimming eliminated 0 seqlets out of 1433
Unmerged patterns remapping: OrderedDict([(2, 1), (5, 2), (6, 3), (7, 4), (8, 5)])
Time spent on merging iteration: 3.075197696685791
On merging iteration 2
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 1290 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 1355 out of 1355 | elapsed:    0.3s finished
Numbers for each pattern pre-subsample: [1433, 379, 27, 15, 9, 2]
Numbers after subsampling: [300, 300, 27, 15, 9, 2]
Computing sims for pattern 0
Computed sims for pattern 0 in 1.5618550777435303 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.4308760166168213 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.08117866516113281 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.05988883972167969 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.05056881904602051 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.040575265884399414 s
Cluster sizes
[1433  379   27   15    9    2]
Cross-contamination matrix:
[[1.   0.45 0.69 0.03 0.36 0.48]
 [0.56 1.   0.49 0.04 0.67 0.06]
 [0.27 0.09 1.   0.   0.04 0.  ]
 [0.04 0.03 0.02 1.   0.04 0.01]
 [0.29 0.47 0.03 0.01 1.   0.02]
 [0.   0.   0.   0.   0.   1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.73 0.76 0.35 0.71 0.72]
 [0.73 1.   0.62 0.16 0.73 0.49]
 [0.76 0.62 1.   0.14 0.54 0.56]
 [0.35 0.16 0.14 1.   0.25 0.27]
 [0.71 0.73 0.54 0.25 1.   0.54]
 [0.72 0.49 0.56 0.27 0.54 1.  ]]
Inspecting pattern 6 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 1355
[t-SNE] Computed conditional probabilities for sample 1355 / 1355
[t-SNE] Mean sigma: 0.253774
Beginning preprocessing + Leiden
2024-03-16 19:18:02.529213 MEMORY 18.151305216
Affmat transformed
2024-03-16 19:18:02.545048 MEMORY 18.151305216
sources, targets, weights extracted
2024-03-16 19:18:02.558361 MEMORY 18.151305216
About to launch parallel Leiden runs
2024-03-16 19:18:02.567406 MEMORY 18.151305216
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    4.4s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   14.0s finished
Parallel Leiden runs finished
2024-03-16 19:18:16.606513 MEMORY 18.151305216
Quality: 0.43269744666959553
Quality: 0.4328185716386033
Got subclusters: Counter({0: 237, 1: 203, 2: 197, 3: 194, 4: 146, 5: 135, 6: 116, 7: 73, 8: 31, 9: 23})
On merging iteration 1
Numbers for each pattern pre-subsample: [237, 203, 197, 194, 146, 135, 116, 73, 31, 23]
Numbers after subsampling: [237, 203, 197, 194, 146, 135, 116, 73, 31, 23]
Computing sims for pattern 0
Computed sims for pattern 0 in 2.8807761669158936 s
Computing sims for pattern 1
Computed sims for pattern 1 in 2.363030195236206 s
Computing sims for pattern 2
Computed sims for pattern 2 in 2.2913942337036133 s
Computing sims for pattern 3
Computed sims for pattern 3 in 2.2149548530578613 s
Computing sims for pattern 4
Computed sims for pattern 4 in 1.5446147918701172 s
Computing sims for pattern 5
Computed sims for pattern 5 in 1.6551809310913086 s
Computing sims for pattern 6
Computed sims for pattern 6 in 1.3512177467346191 s
Computing sims for pattern 7
Computed sims for pattern 7 in 0.9929752349853516 s
Computing sims for pattern 8
Computed sims for pattern 8 in 0.48282885551452637 s
Computing sims for pattern 9
Computed sims for pattern 9 in 0.410137414932251 s
Cluster sizes
[237 203 197 194 146 135 116  73  31  23]
Cross-contamination matrix:
[[1.   0.47 0.81 0.75 0.52 0.22 0.59 0.18 0.42 0.5 ]
 [0.99 1.   0.96 1.   0.8  0.55 0.74 0.41 0.67 0.75]
 [0.87 0.48 1.   0.82 0.56 0.24 0.66 0.17 0.32 0.56]
 [0.85 0.61 0.87 1.   0.65 0.38 0.72 0.34 0.44 0.59]
 [0.95 0.72 0.96 0.95 1.   0.43 0.75 0.39 0.55 0.64]
 [0.8  0.78 0.87 0.89 0.7  1.   0.72 0.4  0.49 0.73]
 [0.85 0.55 0.88 0.87 0.62 0.36 1.   0.27 0.41 0.66]
 [0.72 0.66 0.74 0.86 0.69 0.43 0.62 1.   0.49 0.64]
 [0.76 0.59 0.64 0.66 0.55 0.31 0.52 0.3  1.   0.44]
 [0.54 0.34 0.58 0.5  0.3  0.18 0.42 0.13 0.18 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.91 0.97 0.95 0.92 0.78 0.92 0.73 0.86 0.89]
 [0.91 1.   0.9  0.94 0.92 0.86 0.84 0.75 0.87 0.8 ]
 [0.97 0.9  1.   0.96 0.92 0.82 0.94 0.7  0.81 0.91]
 [0.95 0.94 0.96 1.   0.93 0.84 0.93 0.79 0.85 0.87]
 [0.92 0.92 0.92 0.93 1.   0.78 0.86 0.75 0.84 0.81]
 [0.78 0.86 0.82 0.84 0.78 1.   0.76 0.6  0.72 0.78]
 [0.92 0.84 0.94 0.93 0.86 0.76 1.   0.69 0.77 0.85]
 [0.73 0.75 0.7  0.79 0.75 0.6  0.69 1.   0.66 0.74]
 [0.86 0.87 0.81 0.85 0.84 0.72 0.77 0.66 1.   0.7 ]
 [0.89 0.8  0.91 0.87 0.81 0.78 0.85 0.74 0.7  1.  ]]
Collapsing 0 & 2 with crosscontam 0.8073538025379747 and sim 0.9710429378722399
Collapsing 2 & 3 with crosscontam 0.8240914573192948 and sim 0.9624925904820418
Collapsing 0 & 3 with crosscontam 0.7502459953854037 and sim 0.9477764343386825
Collapsing 2 & 6 with crosscontam 0.6597086530817964 and sim 0.9409625147222439
Collapsing 1 & 3 with crosscontam 0.6135563318182489 and sim 0.937157759200362
Collapsing 3 & 4 with crosscontam 0.6463361481821672 and sim 0.9327506355940419
Collapsing 3 & 6 with crosscontam 0.7214150131650052 and sim 0.931019955854843
Collapsing 0 & 4 with crosscontam 0.5216116140804723 and sim 0.9217339128585451
Collapsing 0 & 6 with crosscontam 0.5852948218922487 and sim 0.9206092519044202
Collapsing 2 & 4 with crosscontam 0.5592943816323366 and sim 0.9197500160825623
Collapsing 1 & 4 with crosscontam 0.7218606678591719 and sim 0.9162610286625482
Collapsing 0 & 1 with crosscontam 0.4710939644441092 and sim 0.9094185202856155
Collapsing 2 & 9 with crosscontam 0.5590078213774299 and sim 0.9063257483852594
Collapsing 1 & 2 with crosscontam 0.4754924788634787 and sim 0.9040794756271321
Collapsing 1 & 8 with crosscontam 0.5932224381582498 and sim 0.8733508163686268
Aborting collapse as 8 & 9 have cross-contam 0.30546005669584964 and sim 0.6992015717925266
Collapsing 4 & 6 with crosscontam 0.6216704230854129 and sim 0.8622687502341698
Collapsing 1 & 5 with crosscontam 0.5481863565539631 and sim 0.8576341002837287
Trimming eliminated 0 seqlets out of 434
Trimming eliminated 0 seqlets out of 628
Trimming eliminated 0 seqlets out of 744
Trimming eliminated 0 seqlets out of 947
Trimming eliminated 0 seqlets out of 1093
Trimming eliminated 0 seqlets out of 1116
Trimming eliminated 0 seqlets out of 1251
Unmerged patterns remapping: OrderedDict([(7, 1), (8, 2)])
Time spent on merging iteration: 5.71298360824585
On merging iteration 2
Numbers for each pattern pre-subsample: [1251, 73, 31]
Numbers after subsampling: [300, 73, 31]
Computing sims for pattern 0
Computed sims for pattern 0 in 0.6240561008453369 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.15068316459655762 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.08140254020690918 s
Cluster sizes
[1251   73   31]
Cross-contamination matrix:
[[1.   0.46 0.65]
 [0.71 1.   0.49]
 [0.61 0.3  1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.76 0.86]
 [0.76 1.   0.66]
 [0.86 0.66 1.  ]]
Collapsing 0 & 2 with crosscontam 0.6143278171259776 and sim 0.8620961546538557
Trimming eliminated 0 seqlets out of 1282
Unmerged patterns remapping: OrderedDict([(1, 1)])
Time spent on merging iteration: 4.186421632766724
On merging iteration 3
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 882 out of 882 | elapsed:    0.2s finished
Numbers for each pattern pre-subsample: [1282, 73]
Numbers after subsampling: [300, 73]
Computing sims for pattern 0
Computed sims for pattern 0 in 0.32388973236083984 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.14666366577148438 s
Cluster sizes
[1282   73]
Cross-contamination matrix:
[[1.   0.51]
 [0.68 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.76]
 [0.76 1.  ]]
Inspecting pattern 7 for spurious merging
[t-SNE] Computed conditional probabilities for sample 882 / 882
[t-SNE] Mean sigma: 0.252488
Beginning preprocessing + Leiden
2024-03-16 19:18:45.029431 MEMORY 18.151305216
Affmat transformed
2024-03-16 19:18:45.039846 MEMORY 18.151305216
sources, targets, weights extracted
2024-03-16 19:18:45.048310 MEMORY 18.151305216
About to launch parallel Leiden runs
2024-03-16 19:18:45.070862 MEMORY 18.151305216
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    2.5s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    8.6s finished
Parallel Leiden runs finished
2024-03-16 19:18:53.710434 MEMORY 18.151305216
Quality: 0.43655341937271125
Quality: 0.4372891806464685
Quality: 0.4391225506581734
Quality: 0.43930215222446395
Got subclusters: Counter({0: 193, 1: 191, 2: 145, 3: 133, 4: 106, 5: 95, 6: 12, 7: 7})
On merging iteration 1
Numbers for each pattern pre-subsample: [193, 191, 145, 133, 106, 95, 12, 7]
Numbers after subsampling: [193, 191, 145, 133, 106, 95, 12, 7]
Computing sims for pattern 0
Computed sims for pattern 0 in 1.6656756401062012 s
Computing sims for pattern 1
Computed sims for pattern 1 in 1.6405653953552246 s
Computing sims for pattern 2
Computed sims for pattern 2 in 1.1439878940582275 s
Computing sims for pattern 3
Computed sims for pattern 3 in 1.1489741802215576 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.9066143035888672 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.992999792098999 s
Computing sims for pattern 6
Computed sims for pattern 6 in 0.21763277053833008 s
Computing sims for pattern 7
Computed sims for pattern 7 in 0.17290163040161133 s
Cluster sizes
[193 191 145 133 106  95  12   7]
Cross-contamination matrix:
[[1.   0.58 0.33 0.2  0.14 0.37 0.04 0.23]
 [1.   1.   0.65 0.42 0.26 0.71 0.16 0.48]
 [1.   1.   1.   0.7  0.46 0.81 0.28 0.68]
 [1.   0.98 0.93 1.   0.48 0.93 0.36 0.72]
 [0.95 0.89 0.75 0.5  1.   0.86 0.42 0.49]
 [1.   1.   0.8  0.72 0.51 1.   0.28 0.7 ]
 [0.27 0.3  0.41 0.34 0.35 0.22 1.   0.71]
 [0.54 0.46 0.31 0.28 0.07 0.39 0.31 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.99 0.94 0.88 0.77 0.92 0.57 0.8 ]
 [0.99 1.   0.93 0.88 0.77 0.92 0.59 0.81]
 [0.94 0.93 1.   0.9  0.8  0.87 0.6  0.76]
 [0.88 0.88 0.9  1.   0.71 0.91 0.53 0.74]
 [0.77 0.77 0.8  0.71 1.   0.82 0.63 0.7 ]
 [0.92 0.92 0.87 0.91 0.82 1.   0.65 0.81]
 [0.57 0.59 0.6  0.53 0.63 0.65 1.   0.77]
 [0.8  0.81 0.76 0.74 0.7  0.81 0.77 1.  ]]
Collapsing 0 & 1 with crosscontam 0.5753777694559707 and sim 0.9948804467513561
Collapsing 0 & 2 with crosscontam 0.32804374184551444 and sim 0.9388694376702884
Collapsing 1 & 2 with crosscontam 0.6462604658755435 and sim 0.9300704513292524
Collapsing 1 & 5 with crosscontam 0.7081779725679103 and sim 0.9224692432282912
Collapsing 0 & 5 with crosscontam 0.3682218683201426 and sim 0.9152320645268253
Collapsing 3 & 5 with crosscontam 0.7155538532875416 and sim 0.9111294985367615
Collapsing 2 & 3 with crosscontam 0.7013901016019486 and sim 0.9045281408880473
Collapsing 2 & 5 with crosscontam 0.7997186922794617 and sim 0.8674759777333519
Trimming eliminated 0 seqlets out of 384
Trimming eliminated 0 seqlets out of 529
Skipped 1 due to duplicates
Trimming eliminated 0 seqlets out of 623
Trimming eliminated 0 seqlets out of 756
Unmerged patterns remapping: OrderedDict([(4, 1), (6, 2), (7, 3)])
Time spent on merging iteration: 3.705322742462158
On merging iteration 2
Numbers for each pattern pre-subsample: [756, 106, 12, 7]
Numbers after subsampling: [300, 106, 12, 7]
Computing sims for pattern 0
Computed sims for pattern 0 in 0.9085090160369873 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.18718194961547852 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.0567936897277832 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.04938054084777832 s
Cluster sizes
[756 106  12   7]
Cross-contamination matrix:
[[1.   0.58 0.33 0.82]
 [0.74 1.   0.42 0.49]
 [0.3  0.35 1.   0.71]
 [0.42 0.07 0.31 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.8  0.64 0.83]
 [0.8  1.   0.63 0.7 ]
 [0.64 0.63 1.   0.77]
 [0.83 0.7  0.77 1.  ]]
Merging on 29 clusters
2024-03-16 19:19:06.553349 MEMORY 18.151305216
On merging iteration 1
Numbers for each pattern pre-subsample: [1810, 837, 435, 347, 139, 2043, 523, 345, 55, 2444, 261, 28, 14, 2512, 1899, 51, 49, 1433, 379, 27, 15, 9, 2, 1282, 73, 756, 106, 12, 7]
Numbers after subsampling: [300, 300, 300, 300, 139, 300, 300, 300, 55, 300, 261, 28, 14, 300, 300, 51, 49, 300, 300, 27, 15, 9, 2, 300, 73, 300, 106, 12, 7]
Computing sims for pattern 0
Computed sims for pattern 0 in 10.853154182434082 s
Computing sims for pattern 1
Computed sims for pattern 1 in 10.61301589012146 s
Computing sims for pattern 2
Computed sims for pattern 2 in 10.725095272064209 s
Computing sims for pattern 3
Computed sims for pattern 3 in 10.903627157211304 s
Computing sims for pattern 4
Computed sims for pattern 4 in 5.796086311340332 s
Computing sims for pattern 5
Computed sims for pattern 5 in 13.586771965026855 s
Computing sims for pattern 6
Computed sims for pattern 6 in 10.288016319274902 s
Computing sims for pattern 7
Computed sims for pattern 7 in 10.480870723724365 s
Computing sims for pattern 8
Computed sims for pattern 8 in 2.6978440284729004 s
Computing sims for pattern 9
Computed sims for pattern 9 in 10.333581686019897 s
Computing sims for pattern 10
Computed sims for pattern 10 in 8.34786343574524 s
Computing sims for pattern 11
Computed sims for pattern 11 in 1.5862817764282227 s
Computing sims for pattern 12
Computed sims for pattern 12 in 1.107489824295044 s
Computing sims for pattern 13
Computed sims for pattern 13 in 10.269001007080078 s
Computing sims for pattern 14
Computed sims for pattern 14 in 10.358551979064941 s
Computing sims for pattern 15
Computed sims for pattern 15 in 2.5138964653015137 s
Computing sims for pattern 16
Computed sims for pattern 16 in 2.2019619941711426 s
Computing sims for pattern 17
Computed sims for pattern 17 in 10.256110191345215 s
Computing sims for pattern 18
Computed sims for pattern 18 in 10.25247049331665 s
Computing sims for pattern 19
Computed sims for pattern 19 in 1.5237631797790527 s
Computing sims for pattern 20
Computed sims for pattern 20 in 1.1338884830474854 s
Computing sims for pattern 21
Computed sims for pattern 21 in 3.6786601543426514 s
Computing sims for pattern 22
Computed sims for pattern 22 in 0.7258639335632324 s
Computing sims for pattern 23
Computed sims for pattern 23 in 10.092220544815063 s
Computing sims for pattern 24
Computed sims for pattern 24 in 3.4029529094696045 s
Computing sims for pattern 25
Computed sims for pattern 25 in 10.366573095321655 s
Computing sims for pattern 26
Computed sims for pattern 26 in 4.195220708847046 s
Computing sims for pattern 27
Computed sims for pattern 27 in 1.0457708835601807 s
Computing sims for pattern 28
Computed sims for pattern 28 in 0.9145510196685791 s
Cluster sizes
[1810  837  435  347  139 2043  523  345   55 2444  261   28   14 2512
 1899   51   49 1433  379   27   15    9    2 1282   73  756  106   12
    7]
Cross-contamination matrix:
[[1.   0.69 0.81 0.62 0.67 0.67 0.49 0.77 0.56 0.12 0.17 0.16 0.26 0.1
  0.09 0.15 0.08 0.25 0.64 0.6  0.01 0.52 0.05 0.07 0.09 0.65 0.44 0.35
  0.53]
 [0.6  1.   0.76 0.65 0.64 0.49 0.31 0.85 0.24 0.16 0.17 0.2  0.22 0.27
  0.18 0.27 0.17 0.2  0.26 0.36 0.01 0.4  0.04 0.09 0.08 0.47 0.33 0.28
  0.43]
 [0.53 0.58 1.   0.59 0.58 0.29 0.18 0.41 0.21 0.06 0.09 0.06 0.18 0.18
  0.05 0.08 0.05 0.07 0.19 0.24 0.   0.13 0.04 0.02 0.03 0.41 0.26 0.11
  0.29]
 [0.49 0.6  0.74 1.   0.62 0.34 0.26 0.43 0.38 0.19 0.12 0.21 0.4  0.21
  0.1  0.1  0.06 0.07 0.15 0.17 0.   0.14 0.02 0.09 0.05 0.49 0.43 0.37
  0.3 ]
 [0.26 0.31 0.39 0.32 1.   0.14 0.11 0.25 0.18 0.06 0.09 0.05 0.17 0.08
  0.03 0.05 0.03 0.05 0.09 0.08 0.   0.06 0.04 0.05 0.02 0.33 0.17 0.16
  0.19]
 [0.77 0.67 0.56 0.54 0.49 1.   0.8  0.91 0.84 0.2  0.18 0.23 0.38 0.16
  0.23 0.32 0.26 0.29 0.48 0.49 0.18 0.55 0.09 0.17 0.15 0.67 0.43 0.48
  0.6 ]
 [0.38 0.3  0.24 0.27 0.24 0.61 1.   0.61 0.63 0.1  0.1  0.04 0.21 0.03
  0.09 0.34 0.11 0.06 0.1  0.22 0.1  0.14 0.22 0.12 0.1  0.31 0.19 0.38
  0.27]
 [0.35 0.6  0.31 0.27 0.21 0.47 0.39 1.   0.26 0.06 0.07 0.07 0.13 0.04
  0.11 0.3  0.12 0.07 0.17 0.13 0.03 0.06 0.09 0.08 0.04 0.32 0.17 0.16
  0.35]
 [0.27 0.11 0.15 0.23 0.21 0.42 0.4  0.17 1.   0.3  0.15 0.09 0.42 0.25
  0.21 0.17 0.01 0.14 0.1  0.21 0.02 0.04 0.   0.15 0.08 0.27 0.45 0.45
  0.21]
 [0.03 0.05 0.03 0.08 0.05 0.02 0.01 0.05 0.23 1.   0.6  0.67 0.38 0.51
  0.93 0.42 0.42 0.73 0.24 0.37 0.02 0.4  0.51 0.78 0.29 0.08 0.18 0.52
  0.38]
 [0.07 0.07 0.09 0.07 0.12 0.03 0.03 0.08 0.17 0.77 1.   0.6  0.45 0.42
  0.6  0.32 0.31 0.69 0.38 0.29 0.03 0.58 0.57 0.58 0.28 0.15 0.3  0.54
  0.56]
 [0.   0.01 0.   0.02 0.   0.   0.   0.01 0.04 0.29 0.16 1.   0.07 0.09
  0.23 0.1  0.05 0.25 0.06 0.08 0.   0.08 0.07 0.15 0.03 0.02 0.09 0.14
  0.05]
 [0.04 0.04 0.05 0.14 0.07 0.04 0.05 0.04 0.24 0.29 0.25 0.18 1.   0.35
  0.19 0.16 0.04 0.1  0.05 0.17 0.   0.07 0.03 0.12 0.01 0.08 0.13 0.46
  0.22]
 [0.06 0.18 0.19 0.16 0.14 0.04 0.02 0.07 0.3  0.7  0.47 0.46 0.63 1.
  0.76 0.44 0.52 0.44 0.19 0.3  0.02 0.23 0.43 0.57 0.24 0.09 0.2  0.57
  0.26]
 [0.01 0.03 0.02 0.03 0.02 0.02 0.02 0.05 0.1  0.74 0.3  0.4  0.17 0.43
  1.   0.44 0.51 0.56 0.12 0.21 0.01 0.22 0.3  0.62 0.15 0.02 0.07 0.23
  0.13]
 [0.07 0.16 0.09 0.09 0.05 0.11 0.23 0.35 0.22 0.6  0.38 0.5  0.37 0.38
  0.78 1.   0.57 0.5  0.19 0.38 0.06 0.25 0.27 0.44 0.14 0.11 0.17 0.36
  0.25]
 [0.   0.02 0.01 0.   0.   0.01 0.01 0.03 0.   0.29 0.12 0.11 0.03 0.22
  0.57 0.26 1.   0.26 0.05 0.07 0.   0.09 0.24 0.28 0.03 0.   0.02 0.06
  0.05]
 [0.06 0.04 0.03 0.02 0.03 0.03 0.01 0.04 0.08 0.66 0.46 0.5  0.12 0.24
  0.68 0.35 0.34 1.   0.45 0.69 0.03 0.36 0.48 0.49 0.12 0.03 0.12 0.19
  0.19]
 [0.28 0.09 0.13 0.06 0.09 0.13 0.03 0.17 0.08 0.25 0.3  0.25 0.09 0.11
  0.18 0.12 0.11 0.56 1.   0.49 0.04 0.67 0.06 0.12 0.04 0.19 0.45 0.11
  0.12]
 [0.03 0.01 0.01 0.   0.   0.01 0.   0.01 0.01 0.06 0.01 0.02 0.04 0.01
  0.05 0.06 0.01 0.27 0.09 1.   0.   0.04 0.   0.02 0.   0.   0.01 0.01
  0.  ]
 [0.   0.   0.   0.   0.   0.02 0.02 0.01 0.01 0.02 0.02 0.02 0.   0.01
  0.02 0.04 0.01 0.04 0.03 0.02 1.   0.04 0.01 0.02 0.02 0.   0.   0.01
  0.01]
 [0.1  0.05 0.02 0.01 0.01 0.05 0.02 0.03 0.   0.25 0.28 0.17 0.05 0.05
  0.21 0.09 0.09 0.29 0.47 0.03 0.01 1.   0.02 0.14 0.04 0.11 0.16 0.13
  0.18]
 [0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.
  0.   0.   0.   0.   0.   0.   0.   0.   1.   0.   0.   0.   0.   0.
  0.  ]
 [0.02 0.03 0.02 0.04 0.05 0.04 0.06 0.08 0.12 0.74 0.42 0.41 0.19 0.38
  0.76 0.29 0.39 0.52 0.12 0.24 0.02 0.26 0.44 1.   0.51 0.06 0.15 0.47
  0.27]
 [0.04 0.03 0.03 0.03 0.03 0.05 0.12 0.12 0.09 0.4  0.28 0.22 0.05 0.2
  0.33 0.12 0.12 0.24 0.06 0.04 0.02 0.21 0.13 0.68 1.   0.07 0.1  0.41
  0.23]
 [0.27 0.23 0.3  0.28 0.33 0.18 0.14 0.25 0.24 0.12 0.16 0.13 0.24 0.09
  0.06 0.08 0.02 0.08 0.21 0.09 0.   0.25 0.07 0.09 0.08 1.   0.58 0.33
  0.82]
 [0.17 0.13 0.2  0.24 0.13 0.11 0.08 0.13 0.4  0.21 0.25 0.09 0.23 0.13
  0.13 0.11 0.06 0.18 0.52 0.19 0.01 0.31 0.04 0.18 0.07 0.74 1.   0.42
  0.49]
 [0.11 0.09 0.1  0.17 0.12 0.11 0.15 0.12 0.34 0.57 0.42 0.35 0.6  0.42
  0.36 0.22 0.13 0.27 0.13 0.19 0.02 0.25 0.19 0.5  0.3  0.3  0.35 1.
  0.71]
 [0.02 0.   0.   0.01 0.01 0.02 0.   0.02 0.01 0.1  0.13 0.   0.04 0.02
  0.01 0.02 0.   0.03 0.   0.02 0.   0.16 0.11 0.04 0.02 0.42 0.07 0.31
  1.  ]]
Pattern-to-pattern sim matrix:
[[ 1.    0.72  0.8   0.71  0.54  0.84  0.64  0.76  0.66  0.27  0.33  0.36
   0.45  0.3   0.24  0.35  0.27  0.41  0.74  0.67 -0.19  0.58  0.35  0.17
   0.14  0.66  0.57  0.44  0.52]
 [ 0.72  1.    0.73  0.73  0.55  0.67  0.48  0.8   0.47  0.39  0.33  0.48
   0.47  0.44  0.39  0.54  0.33  0.45  0.52  0.55 -0.15  0.5   0.26  0.23
   0.12  0.53  0.54  0.35  0.52]
 [ 0.8   0.73  1.    0.79  0.63  0.6   0.43  0.56  0.41  0.27  0.36  0.33
   0.5   0.51  0.26  0.32  0.26  0.36  0.55  0.53 -0.17  0.42  0.27  0.11
   0.1   0.46  0.5   0.3   0.37]
 [ 0.71  0.73  0.79  1.    0.56  0.56  0.47  0.65  0.61  0.44  0.37  0.53
   0.57  0.55  0.32  0.38  0.26  0.28  0.47  0.42 -0.21  0.36  0.22  0.23
   0.11  0.52  0.64  0.51  0.42]
 [ 0.54  0.55  0.63  0.56  1.    0.44  0.34  0.46  0.43  0.28  0.39  0.31
   0.56  0.44  0.21  0.29  0.22  0.28  0.37  0.42 -0.2   0.3   0.26  0.19
   0.08  0.48  0.38  0.39  0.35]
 [ 0.84  0.67  0.6   0.56  0.44  1.    0.74  0.78  0.74  0.23  0.25  0.32
   0.44  0.27  0.27  0.39  0.35  0.36  0.59  0.55  0.13  0.54  0.32  0.14
   0.17  0.58  0.5   0.41  0.52]
 [ 0.64  0.48  0.43  0.47  0.34  0.74  1.    0.59  0.72  0.17  0.21  0.21
   0.39  0.16  0.19  0.48  0.22  0.2   0.37  0.45  0.16  0.32  0.31  0.31
   0.29  0.45  0.39  0.43  0.44]
 [ 0.76  0.8   0.56  0.65  0.46  0.78  0.59  1.    0.49  0.34  0.24  0.42
   0.55  0.33  0.45  0.69  0.49  0.37  0.47  0.46  0.18  0.35  0.33  0.32
   0.31  0.53  0.59  0.5   0.63]
 [ 0.66  0.47  0.41  0.61  0.43  0.74  0.72  0.49  1.    0.55  0.31  0.56
   0.68  0.55  0.48  0.53  0.26  0.37  0.47  0.48  0.09  0.32  0.35  0.36
   0.2   0.49  0.69  0.61  0.53]
 [ 0.27  0.39  0.27  0.44  0.28  0.23  0.17  0.34  0.55  1.    0.84  0.81
   0.65  0.76  0.95  0.7   0.72  0.88  0.53  0.63  0.29  0.65  0.74  0.9
   0.58  0.3   0.57  0.81  0.59]
 [ 0.33  0.33  0.36  0.37  0.39  0.25  0.21  0.24  0.31  0.84  1.    0.73
   0.6   0.66  0.77  0.51  0.66  0.83  0.64  0.48  0.29  0.72  0.68  0.74
   0.49  0.31  0.57  0.69  0.61]
 [ 0.36  0.48  0.33  0.53  0.31  0.32  0.21  0.42  0.56  0.81  0.73  1.
   0.65  0.65  0.74  0.62  0.56  0.74  0.59  0.58  0.13  0.5   0.64  0.67
   0.35  0.44  0.63  0.69  0.48]
 [ 0.45  0.47  0.5   0.57  0.56  0.44  0.39  0.55  0.68  0.65  0.6   0.65
   1.    0.76  0.57  0.63  0.44  0.48  0.39  0.53 -0.04  0.34  0.4   0.46
   0.19  0.52  0.6   0.78  0.57]
 [ 0.3   0.44  0.51  0.55  0.44  0.27  0.16  0.33  0.55  0.76  0.66  0.65
   0.76  1.    0.79  0.67  0.67  0.67  0.43  0.58  0.09  0.44  0.63  0.67
   0.4   0.25  0.45  0.69  0.56]
 [ 0.24  0.39  0.26  0.32  0.21  0.27  0.19  0.45  0.48  0.95  0.77  0.74
   0.57  0.79  1.    0.77  0.85  0.86  0.47  0.59  0.29  0.6   0.75  0.89
   0.54  0.2   0.48  0.72  0.5 ]
 [ 0.35  0.54  0.32  0.38  0.29  0.39  0.48  0.69  0.53  0.7   0.51  0.62
   0.63  0.67  0.77  1.    0.69  0.65  0.44  0.6   0.18  0.39  0.55  0.59
   0.25  0.31  0.52  0.65  0.44]
 [ 0.27  0.33  0.26  0.26  0.22  0.35  0.22  0.49  0.26  0.72  0.66  0.56
   0.44  0.67  0.85  0.69  1.    0.7   0.42  0.49  0.23  0.49  0.7   0.72
   0.35  0.11  0.31  0.53  0.41]
 [ 0.41  0.45  0.36  0.28  0.28  0.36  0.2   0.37  0.37  0.88  0.83  0.74
   0.48  0.67  0.86  0.65  0.7   1.    0.73  0.76  0.35  0.71  0.72  0.8
   0.47  0.21  0.4   0.6   0.55]
 [ 0.74  0.52  0.55  0.47  0.37  0.59  0.37  0.47  0.47  0.53  0.64  0.59
   0.39  0.43  0.47  0.44  0.42  0.73  1.    0.62  0.16  0.73  0.49  0.48
   0.29  0.47  0.68  0.39  0.39]
 [ 0.67  0.55  0.53  0.42  0.42  0.55  0.45  0.46  0.48  0.63  0.48  0.58
   0.53  0.58  0.59  0.6   0.49  0.76  0.62  1.    0.14  0.54  0.56  0.55
   0.18  0.3   0.46  0.52  0.47]
 [-0.19 -0.15 -0.17 -0.21 -0.2   0.13  0.16  0.18  0.09  0.29  0.29  0.13
  -0.04  0.09  0.29  0.18  0.23  0.35  0.16  0.14  1.    0.25  0.27  0.34
   0.29 -0.19 -0.06  0.14  0.14]
 [ 0.58  0.5   0.42  0.36  0.3   0.54  0.32  0.35  0.32  0.65  0.72  0.5
   0.34  0.44  0.6   0.39  0.49  0.71  0.73  0.54  0.25  1.    0.54  0.6
   0.43  0.34  0.48  0.43  0.52]
 [ 0.35  0.26  0.27  0.22  0.26  0.32  0.31  0.33  0.35  0.74  0.68  0.64
   0.4   0.63  0.75  0.55  0.7   0.72  0.49  0.56  0.27  0.54  1.    0.75
   0.29  0.19  0.38  0.55  0.45]
 [ 0.17  0.23  0.11  0.23  0.19  0.14  0.31  0.32  0.36  0.9   0.74  0.67
   0.46  0.67  0.89  0.59  0.72  0.8   0.48  0.55  0.34  0.6   0.75  1.
   0.76  0.22  0.5   0.77  0.57]
 [ 0.14  0.12  0.1   0.11  0.08  0.17  0.29  0.31  0.2   0.58  0.49  0.35
   0.19  0.4   0.54  0.25  0.35  0.47  0.29  0.18  0.29  0.43  0.29  0.76
   1.    0.13  0.26  0.52  0.41]
 [ 0.66  0.53  0.46  0.52  0.48  0.58  0.45  0.53  0.49  0.3   0.31  0.44
   0.52  0.25  0.2   0.31  0.11  0.21  0.47  0.3  -0.19  0.34  0.19  0.22
   0.13  1.    0.8   0.64  0.83]
 [ 0.57  0.54  0.5   0.64  0.38  0.5   0.39  0.59  0.69  0.57  0.57  0.63
   0.6   0.45  0.48  0.52  0.31  0.4   0.68  0.46 -0.06  0.48  0.38  0.5
   0.26  0.8   1.    0.63  0.7 ]
 [ 0.44  0.35  0.3   0.51  0.39  0.41  0.43  0.5   0.61  0.81  0.69  0.69
   0.78  0.69  0.72  0.65  0.53  0.6   0.39  0.52  0.14  0.43  0.55  0.77
   0.52  0.64  0.63  1.    0.77]
 [ 0.52  0.52  0.37  0.42  0.35  0.52  0.44  0.63  0.53  0.59  0.61  0.48
   0.57  0.56  0.5   0.44  0.41  0.55  0.39  0.47  0.14  0.52  0.45  0.57
   0.41  0.83  0.7   0.77  1.  ]]
Collapsing 9 & 14 with crosscontam 0.7352199540740743 and sim 0.9502617622195557
Collapsing 9 & 23 with crosscontam 0.7394033056790121 and sim 0.9000951760650981
Collapsing 14 & 23 with crosscontam 0.6229096646913579 and sim 0.8851013853440834
Collapsing 9 & 17 with crosscontam 0.6616780637037036 and sim 0.8811313536144565
Collapsing 14 & 17 with crosscontam 0.555471344197531 and sim 0.857073686394074
Skipped 3 due to duplicates
Trimming eliminated 0 seqlets out of 4340
Skipped 2 due to duplicates
Trimming eliminated 0 seqlets out of 5620
Skipped 4 due to duplicates
Trimming eliminated 0 seqlets out of 7049
Unmerged patterns remapping: OrderedDict([(0, 3), (1, 4), (2, 7), (3, 9), (4, 12), (5, 2), (6, 6), (7, 10), (8, 15), (10, 11), (11, 18), (12, 21), (13, 1), (15, 16), (16, 17), (18, 8), (19, 19), (20, 20), (21, 23), (22, 25), (24, 14), (25, 5), (26, 13), (27, 22), (28, 24)])
Time spent on merging iteration: 31.30115580558777
On merging iteration 2
Numbers for each pattern pre-subsample: [7049, 2512, 2043, 1810, 837, 756, 523, 435, 379, 347, 345, 261, 139, 106, 73, 55, 51, 49, 28, 27, 15, 14, 12, 9, 7, 2]
Numbers after subsampling: [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 261, 139, 106, 73, 55, 51, 49, 28, 27, 15, 14, 12, 9, 7, 2]
Computing sims for pattern 0
Computed sims for pattern 0 in 9.356810569763184 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.48998045921325684 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.5141656398773193 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.4945385456085205 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.437298059463501 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.40828943252563477 s
Computing sims for pattern 6
Computed sims for pattern 6 in 0.4057455062866211 s
Computing sims for pattern 7
Computed sims for pattern 7 in 0.4069187641143799 s
Computing sims for pattern 8
Computed sims for pattern 8 in 0.4317145347595215 s
Computing sims for pattern 9
Computed sims for pattern 9 in 0.4345278739929199 s
Computing sims for pattern 10
Computed sims for pattern 10 in 0.4398534297943115 s
Computing sims for pattern 11
Computed sims for pattern 11 in 0.3591616153717041 s
Computing sims for pattern 12
Computed sims for pattern 12 in 0.24201321601867676 s
Computing sims for pattern 13
Computed sims for pattern 13 in 0.18895173072814941 s
Computing sims for pattern 14
Computed sims for pattern 14 in 0.15737032890319824 s
Computing sims for pattern 15
Computed sims for pattern 15 in 0.12295126914978027 s
Computing sims for pattern 16
Computed sims for pattern 16 in 0.12255001068115234 s
Computing sims for pattern 17
Computed sims for pattern 17 in 0.1054391860961914 s
Computing sims for pattern 18
Computed sims for pattern 18 in 0.0807497501373291 s
Computing sims for pattern 19
Computed sims for pattern 19 in 0.07811617851257324 s
Computing sims for pattern 20
Computed sims for pattern 20 in 0.06377911567687988 s
Computing sims for pattern 21
Computed sims for pattern 21 in 0.05838418006896973 s
Computing sims for pattern 22
Computed sims for pattern 22 in 0.0562436580657959 s
Computing sims for pattern 23
Computed sims for pattern 23 in 0.04885268211364746 s
Computing sims for pattern 24
Computed sims for pattern 24 in 0.04744434356689453 s
Computing sims for pattern 25
Computed sims for pattern 25 in 0.041606903076171875 s
Cluster sizes
[7049 2512 2043 1810  837  756  523  435  379  347  345  261  139  106
   73   55   51   49   28   27   15   14   12    9    7    2]
Cross-contamination matrix:
[[1.   0.54 0.04 0.05 0.06 0.08 0.02 0.04 0.32 0.07 0.07 0.63 0.06 0.18
  0.38 0.21 0.5  0.58 0.71 0.51 0.03 0.33 0.5  0.46 0.35 0.62]
 [0.63 1.   0.04 0.06 0.18 0.09 0.02 0.19 0.19 0.16 0.07 0.47 0.14 0.2
  0.24 0.3  0.44 0.52 0.46 0.3  0.02 0.63 0.57 0.23 0.26 0.43]
 [0.22 0.16 1.   0.77 0.67 0.67 0.8  0.56 0.48 0.54 0.91 0.18 0.49 0.43
  0.15 0.84 0.32 0.26 0.23 0.49 0.18 0.38 0.48 0.55 0.6  0.09]
 [0.13 0.1  0.67 1.   0.69 0.65 0.49 0.81 0.64 0.62 0.77 0.17 0.67 0.44
  0.09 0.56 0.15 0.08 0.16 0.6  0.01 0.26 0.35 0.52 0.53 0.05]
 [0.16 0.27 0.49 0.6  1.   0.47 0.31 0.76 0.26 0.65 0.85 0.17 0.64 0.33
  0.08 0.24 0.27 0.17 0.2  0.36 0.01 0.22 0.28 0.4  0.43 0.04]
 [0.1  0.09 0.18 0.27 0.23 1.   0.14 0.3  0.21 0.28 0.25 0.16 0.33 0.58
  0.08 0.24 0.08 0.02 0.13 0.09 0.   0.24 0.33 0.25 0.82 0.07]
 [0.05 0.03 0.61 0.38 0.3  0.31 1.   0.24 0.1  0.27 0.61 0.1  0.24 0.19
  0.1  0.63 0.34 0.11 0.04 0.22 0.1  0.21 0.38 0.14 0.27 0.22]
 [0.05 0.18 0.29 0.53 0.58 0.41 0.18 1.   0.19 0.59 0.41 0.09 0.58 0.26
  0.03 0.21 0.08 0.05 0.06 0.24 0.   0.18 0.11 0.13 0.29 0.04]
 [0.28 0.11 0.13 0.28 0.09 0.19 0.03 0.13 1.   0.06 0.17 0.3  0.09 0.45
  0.04 0.08 0.12 0.11 0.25 0.49 0.04 0.09 0.11 0.67 0.12 0.06]
 [0.13 0.21 0.34 0.49 0.6  0.49 0.26 0.74 0.15 1.   0.43 0.12 0.62 0.43
  0.05 0.38 0.1  0.06 0.21 0.17 0.   0.4  0.37 0.14 0.3  0.02]
 [0.07 0.04 0.47 0.35 0.6  0.32 0.39 0.31 0.17 0.27 1.   0.07 0.21 0.17
  0.04 0.26 0.3  0.12 0.07 0.13 0.03 0.13 0.16 0.06 0.35 0.09]
 [0.7  0.42 0.03 0.07 0.07 0.15 0.03 0.09 0.38 0.07 0.08 1.   0.12 0.3
  0.28 0.17 0.32 0.31 0.6  0.29 0.03 0.45 0.54 0.58 0.56 0.57]
 [0.05 0.08 0.14 0.26 0.31 0.33 0.11 0.39 0.09 0.32 0.25 0.09 1.   0.17
  0.02 0.18 0.05 0.03 0.05 0.08 0.   0.17 0.16 0.06 0.19 0.04]
 [0.17 0.13 0.11 0.17 0.13 0.74 0.08 0.2  0.52 0.24 0.13 0.25 0.13 1.
  0.07 0.4  0.11 0.06 0.09 0.19 0.01 0.23 0.42 0.31 0.49 0.04]
 [0.41 0.2  0.05 0.04 0.03 0.07 0.12 0.03 0.06 0.03 0.12 0.28 0.03 0.1
  1.   0.09 0.12 0.12 0.22 0.04 0.02 0.05 0.41 0.21 0.23 0.13]
 [0.22 0.25 0.42 0.27 0.11 0.27 0.4  0.15 0.1  0.23 0.17 0.15 0.21 0.45
  0.08 1.   0.17 0.01 0.09 0.21 0.02 0.42 0.45 0.04 0.21 0.  ]
 [0.6  0.38 0.11 0.07 0.16 0.11 0.23 0.09 0.19 0.09 0.35 0.38 0.05 0.17
  0.14 0.22 1.   0.57 0.5  0.38 0.06 0.37 0.36 0.25 0.25 0.27]
 [0.36 0.22 0.01 0.   0.02 0.   0.01 0.01 0.05 0.   0.03 0.12 0.   0.02
  0.03 0.   0.26 1.   0.11 0.07 0.   0.03 0.06 0.09 0.05 0.24]
 [0.24 0.09 0.   0.   0.01 0.02 0.   0.   0.06 0.02 0.01 0.16 0.   0.09
  0.03 0.04 0.1  0.05 1.   0.08 0.   0.07 0.14 0.08 0.05 0.07]
 [0.09 0.01 0.01 0.03 0.01 0.   0.   0.01 0.09 0.   0.01 0.01 0.   0.01
  0.   0.01 0.06 0.01 0.02 1.   0.   0.04 0.01 0.04 0.   0.  ]
 [0.02 0.01 0.02 0.   0.   0.   0.02 0.   0.03 0.   0.01 0.02 0.   0.
  0.02 0.01 0.04 0.01 0.02 0.02 1.   0.   0.01 0.04 0.01 0.01]
 [0.19 0.35 0.04 0.04 0.04 0.08 0.05 0.05 0.05 0.14 0.04 0.25 0.07 0.13
  0.01 0.24 0.16 0.04 0.18 0.17 0.   1.   0.46 0.07 0.22 0.03]
 [0.45 0.42 0.11 0.11 0.09 0.3  0.15 0.1  0.13 0.17 0.12 0.42 0.12 0.35
  0.3  0.34 0.22 0.13 0.35 0.19 0.02 0.6  1.   0.25 0.71 0.19]
 [0.24 0.05 0.05 0.1  0.05 0.11 0.02 0.02 0.47 0.01 0.03 0.28 0.01 0.16
  0.04 0.   0.09 0.09 0.17 0.03 0.01 0.05 0.13 1.   0.18 0.02]
 [0.05 0.02 0.02 0.02 0.   0.42 0.   0.   0.   0.01 0.02 0.13 0.01 0.07
  0.02 0.01 0.02 0.   0.   0.02 0.   0.04 0.31 0.16 1.   0.11]
 [0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.
  0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   1.  ]]
Pattern-to-pattern sim matrix:
[[ 1.    0.76  0.26  0.27  0.39  0.25  0.18  0.27  0.54  0.34  0.37  0.84
   0.25  0.52  0.6   0.48  0.71  0.78  0.78  0.66  0.32  0.58  0.77  0.66
   0.56  0.77]
 [ 0.76  1.    0.27  0.3   0.44  0.25  0.16  0.51  0.43  0.55  0.33  0.66
   0.44  0.45  0.4   0.55  0.67  0.67  0.65  0.58  0.09  0.76  0.69  0.44
   0.56  0.63]
 [ 0.26  0.27  1.    0.84  0.67  0.58  0.74  0.6   0.59  0.56  0.78  0.25
   0.44  0.5   0.17  0.74  0.39  0.35  0.32  0.55  0.13  0.44  0.41  0.54
   0.52  0.32]
 [ 0.27  0.3   0.84  1.    0.72  0.66  0.64  0.8   0.74  0.71  0.76  0.33
   0.54  0.57  0.14  0.66  0.35  0.27  0.36  0.67 -0.19  0.45  0.44  0.58
   0.52  0.35]
 [ 0.39  0.44  0.67  0.72  1.    0.53  0.48  0.73  0.52  0.73  0.8   0.33
   0.55  0.54  0.12  0.47  0.54  0.33  0.48  0.55 -0.15  0.47  0.35  0.5
   0.52  0.26]
 [ 0.25  0.25  0.58  0.66  0.53  1.    0.45  0.46  0.47  0.52  0.53  0.31
   0.48  0.8   0.13  0.49  0.31  0.11  0.44  0.3  -0.19  0.52  0.64  0.34
   0.83  0.19]
 [ 0.18  0.16  0.74  0.64  0.48  0.45  1.    0.43  0.37  0.47  0.59  0.21
   0.34  0.39  0.29  0.72  0.48  0.22  0.21  0.45  0.16  0.39  0.43  0.32
   0.44  0.31]
 [ 0.27  0.51  0.6   0.8   0.73  0.46  0.43  1.    0.55  0.79  0.56  0.36
   0.63  0.5   0.1   0.41  0.32  0.26  0.33  0.53 -0.17  0.5   0.3   0.42
   0.37  0.27]
 [ 0.54  0.43  0.59  0.74  0.52  0.47  0.37  0.55  1.    0.47  0.47  0.64
   0.37  0.68  0.29  0.47  0.44  0.42  0.59  0.62  0.16  0.39  0.39  0.73
   0.39  0.49]
 [ 0.34  0.55  0.56  0.71  0.73  0.52  0.47  0.79  0.47  1.    0.65  0.37
   0.56  0.64  0.11  0.61  0.38  0.26  0.53  0.42 -0.21  0.57  0.51  0.36
   0.42  0.22]
 [ 0.37  0.33  0.78  0.76  0.8   0.53  0.59  0.56  0.47  0.65  1.    0.24
   0.46  0.59  0.31  0.49  0.69  0.49  0.42  0.46  0.18  0.55  0.5   0.35
   0.63  0.33]
 [ 0.84  0.66  0.25  0.33  0.33  0.31  0.21  0.36  0.64  0.37  0.24  1.
   0.39  0.57  0.49  0.31  0.51  0.66  0.73  0.48  0.29  0.6   0.69  0.72
   0.61  0.68]
 [ 0.25  0.44  0.44  0.54  0.55  0.48  0.34  0.63  0.37  0.56  0.46  0.39
   1.    0.38  0.08  0.43  0.29  0.22  0.31  0.42 -0.2   0.56  0.39  0.3
   0.35  0.26]
 [ 0.52  0.45  0.5   0.57  0.54  0.8   0.39  0.5   0.68  0.64  0.59  0.57
   0.38  1.    0.26  0.69  0.52  0.31  0.63  0.46 -0.06  0.6   0.63  0.48
   0.7   0.38]
 [ 0.6   0.4   0.17  0.14  0.12  0.13  0.29  0.1   0.29  0.11  0.31  0.49
   0.08  0.26  1.    0.2   0.25  0.35  0.35  0.18  0.29  0.19  0.52  0.43
   0.41  0.29]
 [ 0.48  0.55  0.74  0.66  0.47  0.49  0.72  0.41  0.47  0.61  0.49  0.31
   0.43  0.69  0.2   1.    0.53  0.26  0.56  0.48  0.09  0.68  0.61  0.32
   0.53  0.35]
 [ 0.71  0.67  0.39  0.35  0.54  0.31  0.48  0.32  0.44  0.38  0.69  0.51
   0.29  0.52  0.25  0.53  1.    0.69  0.62  0.6   0.18  0.63  0.65  0.39
   0.44  0.55]
 [ 0.78  0.67  0.35  0.27  0.33  0.11  0.22  0.26  0.42  0.26  0.49  0.66
   0.22  0.31  0.35  0.26  0.69  1.    0.56  0.49  0.23  0.44  0.53  0.49
   0.41  0.7 ]
 [ 0.78  0.65  0.32  0.36  0.48  0.44  0.21  0.33  0.59  0.53  0.42  0.73
   0.31  0.63  0.35  0.56  0.62  0.56  1.    0.58  0.13  0.65  0.69  0.5
   0.48  0.64]
 [ 0.66  0.58  0.55  0.67  0.55  0.3   0.45  0.53  0.62  0.42  0.46  0.48
   0.42  0.46  0.18  0.48  0.6   0.49  0.58  1.    0.14  0.53  0.52  0.54
   0.47  0.56]
 [ 0.32  0.09  0.13 -0.19 -0.15 -0.19  0.16 -0.17  0.16 -0.21  0.18  0.29
  -0.2  -0.06  0.29  0.09  0.18  0.23  0.13  0.14  1.   -0.04  0.14  0.25
   0.14  0.27]
 [ 0.58  0.76  0.44  0.45  0.47  0.52  0.39  0.5   0.39  0.57  0.55  0.6
   0.56  0.6   0.19  0.68  0.63  0.44  0.65  0.53 -0.04  1.    0.78  0.34
   0.57  0.4 ]
 [ 0.77  0.69  0.41  0.44  0.35  0.64  0.43  0.3   0.39  0.51  0.5   0.69
   0.39  0.63  0.52  0.61  0.65  0.53  0.69  0.52  0.14  0.78  1.    0.43
   0.77  0.55]
 [ 0.66  0.44  0.54  0.58  0.5   0.34  0.32  0.42  0.73  0.36  0.35  0.72
   0.3   0.48  0.43  0.32  0.39  0.49  0.5   0.54  0.25  0.34  0.43  1.
   0.52  0.54]
 [ 0.56  0.56  0.52  0.52  0.52  0.83  0.44  0.37  0.39  0.42  0.63  0.61
   0.35  0.7   0.41  0.53  0.44  0.41  0.48  0.47  0.14  0.57  0.77  0.52
   1.    0.45]
 [ 0.77  0.63  0.32  0.35  0.26  0.19  0.31  0.27  0.49  0.22  0.33  0.68
   0.26  0.38  0.29  0.35  0.55  0.7   0.64  0.56  0.27  0.4   0.55  0.54
   0.45  1.  ]]
Got 26 patterns after merging
2024-03-16 19:23:05.466816 MEMORY 18.151309312
Performing filtering
2024-03-16 19:23:05.467056 MEMORY 18.151309312
Got 18 patterns after filtering
2024-03-16 19:23:07.837855 MEMORY 18.151309312
Total time taken is 2616.2s
2024-03-16 19:23:07.838068 MEMORY 18.151309312
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done 2400 tasks      | elapsed:    3.1s
[Parallel(n_jobs=24)]: Done 5200 tasks      | elapsed:    6.3s
[Parallel(n_jobs=24)]: Done 7049 out of 7049 | elapsed:    8.4s finished
/ru-auth/local/home/lzhao/anaconda3/envs/jupyter-ml-clone/lib/python3.9/site-packages/sklearn/manifold/_t_sne.py:691: FutureWarning: 'square_distances' has been introduced in 0.24 to help phase out legacy squaring behavior. The 'legacy' setting will be removed in 1.1 (renaming of 0.26), and the default setting will be changed to True. In 1.3, 'square_distances' will be removed altogether, and distances will be squared by default. Set 'square_distances'=True to silence this warning.
  warnings.warn(
/ru-auth/local/home/lzhao/anaconda3/envs/jupyter-ml-clone/lib/python3.9/site-packages/sklearn/neighbors/_base.py:175: EfficiencyWarning: Precomputed sparse input was not sorted by data.
  warnings.warn('Precomputed sparse input was not sorted by data.',
Applying subclustering to the final motifs
On pattern 0
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 7049 samples in 0.047s...
[t-SNE] Computed neighbors for 7049 samples in 0.005s...
[t-SNE] Computed conditional probabilities for sample 1000 / 7049
[t-SNE] Computed conditional probabilities for sample 2000 / 7049
[t-SNE] Computed conditional probabilities for sample 3000 / 7049
[t-SNE] Computed conditional probabilities for sample 4000 / 7049
[t-SNE] Computed conditional probabilities for sample 5000 / 7049
[t-SNE] Computed conditional probabilities for sample 6000 / 7049
[t-SNE] Computed conditional probabilities for sample 7000 / 7049
[t-SNE] Computed conditional probabilities for sample 7049 / 7049
[t-SNE] Mean sigma: 0.246654
[t-SNE] Computed conditional probabilities in 0.501s
[t-SNE] Iteration 50: error = 84.5683670, gradient norm = 0.0000093 (50 iterations in 0.598s)
[t-SNE] Iteration 100: error = 84.5683746, gradient norm = 0.0000107 (50 iterations in 0.561s)
[t-SNE] Iteration 150: error = 84.5675735, gradient norm = 0.0003663 (50 iterations in 0.595s)
[t-SNE] Iteration 200: error = 84.4272156, gradient norm = 0.0032031 (50 iterations in 0.713s)
[t-SNE] Iteration 250: error = 84.1930542, gradient norm = 0.0001146 (50 iterations in 0.541s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 84.193054
[t-SNE] Iteration 300: error = 2.9787366, gradient norm = 0.0015107 (50 iterations in 0.526s)
[t-SNE] Iteration 350: error = 2.6889489, gradient norm = 0.0005009 (50 iterations in 0.504s)
[t-SNE] Iteration 400: error = 2.5763140, gradient norm = 0.0002587 (50 iterations in 0.501s)
[t-SNE] Iteration 450: error = 2.5143626, gradient norm = 0.0001721 (50 iterations in 0.515s)
[t-SNE] Iteration 500: error = 2.4754684, gradient norm = 0.0001281 (50 iterations in 0.522s)
[t-SNE] Iteration 550: error = 2.4484568, gradient norm = 0.0001006 (50 iterations in 0.518s)
[t-SNE] Iteration 600: error = 2.4290807, gradient norm = 0.0000829 (50 iterations in 0.558s)
[t-SNE] Iteration 650: error = 2.4150441, gradient norm = 0.0000710 (50 iterations in 0.530s)
[t-SNE] Iteration 700: error = 2.4044201, gradient norm = 0.0000625 (50 iterations in 0.536s)
[t-SNE] Iteration 750: error = 2.3961484, gradient norm = 0.0000640 (50 iterations in 0.531s)
[t-SNE] Iteration 800: error = 2.3894796, gradient norm = 0.0000570 (50 iterations in 0.527s)
[t-SNE] Iteration 850: error = 2.3842630, gradient norm = 0.0000528 (50 iterations in 0.506s)
[t-SNE] Iteration 900: error = 2.3802946, gradient norm = 0.0000508 (50 iterations in 0.511s)
[t-SNE] Iteration 950: error = 2.3777223, gradient norm = 0.0000581 (50 iterations in 0.517s)
[t-SNE] Iteration 1000: error = 2.3757041, gradient norm = 0.0000412 (50 iterations in 0.516s)
[t-SNE] KL divergence after 1000 iterations: 2.375704
[t-SNE] Computed conditional probabilities for sample 1000 / 7049
[t-SNE] Computed conditional probabilities for sample 2000 / 7049
[t-SNE] Computed conditional probabilities for sample 3000 / 7049
[t-SNE] Computed conditional probabilities for sample 4000 / 7049
[t-SNE] Computed conditional probabilities for sample 5000 / 7049
[t-SNE] Computed conditional probabilities for sample 6000 / 7049
[t-SNE] Computed conditional probabilities for sample 7000 / 7049
[t-SNE] Computed conditional probabilities for sample 7049 / 7049
[t-SNE] Mean sigma: 0.246654
Beginning preprocessing + Leiden
2024-03-16 19:23:34.973414 MEMORY 18.15588864
Affmat transformed
2024-03-16 19:23:35.064671 MEMORY 18.16989696
sources, targets, weights extracted
2024-03-16 19:23:35.128169 MEMORY 18.16989696
About to launch parallel Leiden runs
2024-03-16 19:23:35.156501 MEMORY 18.169872384
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:   24.2s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:  1.5min finished
Parallel Leiden runs finished
2024-03-16 19:25:02.407526 MEMORY 18.169872384
Quality: 0.6284573112400431
Quality: 0.6286068297455782
Quality: 0.632422132685952
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 2363 tasks      | elapsed:    0.8s
[Parallel(n_jobs=24)]: Done 2512 out of 2512 | elapsed:    0.8s finished
Got subclusters: Counter({0: 1310, 1: 1249, 2: 1227, 3: 808, 4: 732, 5: 443, 6: 412, 7: 406, 8: 270, 9: 192})
On pattern 1
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 2512 samples in 0.018s...
[t-SNE] Computed neighbors for 2512 samples in 0.002s...
[t-SNE] Computed conditional probabilities for sample 1000 / 2512
[t-SNE] Computed conditional probabilities for sample 2000 / 2512
[t-SNE] Computed conditional probabilities for sample 2512 / 2512
[t-SNE] Mean sigma: 0.266509
[t-SNE] Computed conditional probabilities in 0.172s
[t-SNE] Iteration 50: error = 72.4317017, gradient norm = 0.0685534 (50 iterations in 0.270s)
[t-SNE] Iteration 100: error = 72.4119110, gradient norm = 0.0487798 (50 iterations in 0.221s)
[t-SNE] Iteration 150: error = 72.4104385, gradient norm = 0.0444706 (50 iterations in 0.224s)
[t-SNE] Iteration 200: error = 72.4196777, gradient norm = 0.0538376 (50 iterations in 0.224s)
[t-SNE] Iteration 250: error = 72.4283295, gradient norm = 0.0606642 (50 iterations in 0.218s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 72.428329
[t-SNE] Iteration 300: error = 2.1401815, gradient norm = 0.0010381 (50 iterations in 0.191s)
[t-SNE] Iteration 350: error = 2.0272365, gradient norm = 0.0003892 (50 iterations in 0.184s)
[t-SNE] Iteration 400: error = 1.9816163, gradient norm = 0.0002200 (50 iterations in 0.186s)
[t-SNE] Iteration 450: error = 1.9592047, gradient norm = 0.0001306 (50 iterations in 0.184s)
[t-SNE] Iteration 500: error = 1.9475690, gradient norm = 0.0000969 (50 iterations in 0.185s)
[t-SNE] Iteration 550: error = 1.9400566, gradient norm = 0.0000706 (50 iterations in 0.187s)
[t-SNE] Iteration 600: error = 1.9344593, gradient norm = 0.0000637 (50 iterations in 0.187s)
[t-SNE] Iteration 650: error = 1.9305710, gradient norm = 0.0000533 (50 iterations in 0.188s)
[t-SNE] Iteration 700: error = 1.9273834, gradient norm = 0.0000718 (50 iterations in 0.184s)
[t-SNE] Iteration 750: error = 1.9253370, gradient norm = 0.0000414 (50 iterations in 0.184s)
[t-SNE] Iteration 800: error = 1.9236426, gradient norm = 0.0000325 (50 iterations in 0.184s)
[t-SNE] Iteration 850: error = 1.9222609, gradient norm = 0.0000328 (50 iterations in 0.184s)
[t-SNE] Iteration 900: error = 1.9212180, gradient norm = 0.0000323 (50 iterations in 0.185s)
[t-SNE] Iteration 950: error = 1.9203683, gradient norm = 0.0000299 (50 iterations in 0.186s)
[t-SNE] Iteration 1000: error = 1.9196332, gradient norm = 0.0000327 (50 iterations in 0.185s)
[t-SNE] KL divergence after 1000 iterations: 1.919633
[t-SNE] Computed conditional probabilities for sample 1000 / 2512
[t-SNE] Computed conditional probabilities for sample 2000 / 2512
[t-SNE] Computed conditional probabilities for sample 2512 / 2512
[t-SNE] Mean sigma: 0.266509
Beginning preprocessing + Leiden
2024-03-16 19:25:10.708548 MEMORY 18.169884672
Affmat transformed
2024-03-16 19:25:10.737021 MEMORY 18.169884672
sources, targets, weights extracted
2024-03-16 19:25:10.758909 MEMORY 18.169884672
About to launch parallel Leiden runs
2024-03-16 19:25:10.774207 MEMORY 18.169860096
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    8.4s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   26.3s finished
Parallel Leiden runs finished
2024-03-16 19:25:37.122019 MEMORY 18.169860096
Quality: 0.5317100008791406
Quality: 0.5321528960654132
Quality: 0.5340082345788909
Quality: 0.5340091874061492
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 1812 tasks      | elapsed:    0.6s
[Parallel(n_jobs=24)]: Done 1996 out of 2043 | elapsed:    0.7s remaining:    0.0s
[Parallel(n_jobs=24)]: Done 2043 out of 2043 | elapsed:    0.7s finished
Got subclusters: Counter({0: 617, 1: 470, 2: 457, 3: 387, 4: 361, 5: 212, 6: 8})
On pattern 2
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 2043 samples in 0.014s...
[t-SNE] Computed neighbors for 2043 samples in 0.002s...
[t-SNE] Computed conditional probabilities for sample 1000 / 2043
[t-SNE] Computed conditional probabilities for sample 2000 / 2043
[t-SNE] Computed conditional probabilities for sample 2043 / 2043
[t-SNE] Mean sigma: 0.305201
[t-SNE] Computed conditional probabilities in 0.139s
[t-SNE] Iteration 50: error = 70.7377243, gradient norm = 0.1213793 (50 iterations in 0.189s)
[t-SNE] Iteration 100: error = 71.1133118, gradient norm = 0.1025927 (50 iterations in 0.175s)
[t-SNE] Iteration 150: error = 71.1444931, gradient norm = 0.0864557 (50 iterations in 0.173s)
[t-SNE] Iteration 200: error = 70.8054504, gradient norm = 0.0869630 (50 iterations in 0.185s)
[t-SNE] Iteration 250: error = 70.7760925, gradient norm = 0.0898336 (50 iterations in 0.211s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 70.776093
[t-SNE] Iteration 300: error = 1.9888921, gradient norm = 0.0013991 (50 iterations in 0.178s)
[t-SNE] Iteration 350: error = 1.8795271, gradient norm = 0.0004191 (50 iterations in 0.155s)
[t-SNE] Iteration 400: error = 1.8376408, gradient norm = 0.0002076 (50 iterations in 0.152s)
[t-SNE] Iteration 450: error = 1.8195729, gradient norm = 0.0001174 (50 iterations in 0.160s)
[t-SNE] Iteration 500: error = 1.8095067, gradient norm = 0.0001046 (50 iterations in 0.187s)
[t-SNE] Iteration 550: error = 1.8047866, gradient norm = 0.0000769 (50 iterations in 0.155s)
[t-SNE] Iteration 600: error = 1.8017442, gradient norm = 0.0000611 (50 iterations in 0.155s)
[t-SNE] Iteration 650: error = 1.7994846, gradient norm = 0.0000528 (50 iterations in 0.158s)
[t-SNE] Iteration 700: error = 1.7977012, gradient norm = 0.0000520 (50 iterations in 0.155s)
[t-SNE] Iteration 750: error = 1.7965624, gradient norm = 0.0000419 (50 iterations in 0.158s)
[t-SNE] Iteration 800: error = 1.7955549, gradient norm = 0.0000403 (50 iterations in 0.155s)
[t-SNE] Iteration 850: error = 1.7949052, gradient norm = 0.0000372 (50 iterations in 0.156s)
[t-SNE] Iteration 900: error = 1.7941471, gradient norm = 0.0000349 (50 iterations in 0.152s)
[t-SNE] Iteration 950: error = 1.7935835, gradient norm = 0.0000331 (50 iterations in 0.157s)
[t-SNE] Iteration 1000: error = 1.7931310, gradient norm = 0.0000332 (50 iterations in 0.156s)
[t-SNE] KL divergence after 1000 iterations: 1.793131
[t-SNE] Computed conditional probabilities for sample 1000 / 2043
[t-SNE] Computed conditional probabilities for sample 2000 / 2043
[t-SNE] Computed conditional probabilities for sample 2043 / 2043
[t-SNE] Mean sigma: 0.305201
Beginning preprocessing + Leiden
2024-03-16 19:25:43.749715 MEMORY 18.16987648
Affmat transformed
2024-03-16 19:25:43.780460 MEMORY 18.16987648
sources, targets, weights extracted
2024-03-16 19:25:43.797990 MEMORY 18.16987648
About to launch parallel Leiden runs
2024-03-16 19:25:43.808116 MEMORY 18.16987648
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    5.8s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   18.9s finished
Parallel Leiden runs finished
2024-03-16 19:26:02.725188 MEMORY 18.16987648
Quality: 0.5094501858951779
Quality: 0.5119051369371584
Quality: 0.5143739699886993
Quality: 0.5144104668273822
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 1650 tasks      | elapsed:    0.5s
[Parallel(n_jobs=24)]: Done 1810 out of 1810 | elapsed:    0.5s finished
Got subclusters: Counter({0: 387, 1: 274, 2: 272, 3: 253, 4: 248, 5: 236, 6: 199, 7: 174})
On pattern 3
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 1810 samples in 0.013s...
[t-SNE] Computed neighbors for 1810 samples in 0.002s...
[t-SNE] Computed conditional probabilities for sample 1000 / 1810
[t-SNE] Computed conditional probabilities for sample 1810 / 1810
[t-SNE] Mean sigma: 0.303841
[t-SNE] Computed conditional probabilities in 0.135s
[t-SNE] Iteration 50: error = 69.4724655, gradient norm = 0.1203981 (50 iterations in 0.172s)
[t-SNE] Iteration 100: error = 69.6557083, gradient norm = 0.1120824 (50 iterations in 0.189s)
[t-SNE] Iteration 150: error = 69.6792297, gradient norm = 0.1169574 (50 iterations in 0.163s)
[t-SNE] Iteration 200: error = 69.5738754, gradient norm = 0.1066696 (50 iterations in 0.159s)
[t-SNE] Iteration 250: error = 69.6162491, gradient norm = 0.1139751 (50 iterations in 0.152s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 69.616249
[t-SNE] Iteration 300: error = 2.0928326, gradient norm = 0.0012832 (50 iterations in 0.138s)
[t-SNE] Iteration 350: error = 1.9889683, gradient norm = 0.0004680 (50 iterations in 0.138s)
[t-SNE] Iteration 400: error = 1.9511141, gradient norm = 0.0002237 (50 iterations in 0.136s)
[t-SNE] Iteration 450: error = 1.9330810, gradient norm = 0.0002070 (50 iterations in 0.137s)
[t-SNE] Iteration 500: error = 1.9241158, gradient norm = 0.0001300 (50 iterations in 0.138s)
[t-SNE] Iteration 550: error = 1.9184954, gradient norm = 0.0001363 (50 iterations in 0.141s)
[t-SNE] Iteration 600: error = 1.9122376, gradient norm = 0.0002239 (50 iterations in 0.136s)
[t-SNE] Iteration 650: error = 1.9088601, gradient norm = 0.0000906 (50 iterations in 0.136s)
[t-SNE] Iteration 700: error = 1.9065802, gradient norm = 0.0001112 (50 iterations in 0.140s)
[t-SNE] Iteration 750: error = 1.9049227, gradient norm = 0.0000876 (50 iterations in 0.139s)
[t-SNE] Iteration 800: error = 1.9039909, gradient norm = 0.0000712 (50 iterations in 0.138s)
[t-SNE] Iteration 850: error = 1.9033697, gradient norm = 0.0000725 (50 iterations in 0.138s)
[t-SNE] Iteration 900: error = 1.9025782, gradient norm = 0.0000630 (50 iterations in 0.137s)
[t-SNE] Iteration 950: error = 1.9016465, gradient norm = 0.0000568 (50 iterations in 0.141s)
[t-SNE] Iteration 1000: error = 1.9009416, gradient norm = 0.0000719 (50 iterations in 0.139s)
[t-SNE] KL divergence after 1000 iterations: 1.900942
[t-SNE] Computed conditional probabilities for sample 1000 / 1810
[t-SNE] Computed conditional probabilities for sample 1810 / 1810
[t-SNE] Mean sigma: 0.303841
Beginning preprocessing + Leiden
2024-03-16 19:26:08.407417 MEMORY 18.169888768
Affmat transformed
2024-03-16 19:26:08.431810 MEMORY 18.169888768
sources, targets, weights extracted
2024-03-16 19:26:08.447081 MEMORY 18.169888768
About to launch parallel Leiden runs
2024-03-16 19:26:08.457407 MEMORY 18.169872384
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    5.1s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   15.6s finished
Parallel Leiden runs finished
2024-03-16 19:26:24.080207 MEMORY 18.169872384
Quality: 0.5167261644069642
Quality: 0.516977669566046
Quality: 0.5171090042811676
Quality: 0.5172226159357247
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 837 out of 837 | elapsed:    0.2s finished
Got subclusters: Counter({0: 368, 1: 293, 2: 275, 3: 241, 4: 214, 5: 173, 6: 159, 7: 87})
On pattern 4
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 837 samples in 0.007s...
[t-SNE] Computed neighbors for 837 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 837 / 837
[t-SNE] Mean sigma: 0.319081
[t-SNE] Computed conditional probabilities in 0.058s
[t-SNE] Iteration 50: error = 68.7747498, gradient norm = 0.3474461 (50 iterations in 0.080s)
[t-SNE] Iteration 100: error = 71.3006439, gradient norm = 0.3282678 (50 iterations in 0.077s)
[t-SNE] Iteration 150: error = 69.7675552, gradient norm = 0.3569561 (50 iterations in 0.078s)
[t-SNE] Iteration 200: error = 70.2967072, gradient norm = 0.3161100 (50 iterations in 0.089s)
[t-SNE] Iteration 250: error = 70.8225098, gradient norm = 0.3235148 (50 iterations in 0.079s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 70.822510
[t-SNE] Iteration 300: error = 1.5479231, gradient norm = 0.0031878 (50 iterations in 0.085s)
[t-SNE] Iteration 350: error = 1.4922018, gradient norm = 0.0004770 (50 iterations in 0.074s)
[t-SNE] Iteration 400: error = 1.4770240, gradient norm = 0.0002464 (50 iterations in 0.079s)
[t-SNE] Iteration 450: error = 1.4711448, gradient norm = 0.0002148 (50 iterations in 0.075s)
[t-SNE] Iteration 500: error = 1.4634500, gradient norm = 0.0001655 (50 iterations in 0.080s)
[t-SNE] Iteration 550: error = 1.4616667, gradient norm = 0.0001171 (50 iterations in 0.074s)
[t-SNE] Iteration 600: error = 1.4600340, gradient norm = 0.0001408 (50 iterations in 0.073s)
[t-SNE] Iteration 650: error = 1.4594047, gradient norm = 0.0001643 (50 iterations in 0.074s)
[t-SNE] Iteration 700: error = 1.4570068, gradient norm = 0.0000827 (50 iterations in 0.072s)
[t-SNE] Iteration 750: error = 1.4564040, gradient norm = 0.0001019 (50 iterations in 0.070s)
[t-SNE] Iteration 800: error = 1.4553879, gradient norm = 0.0001281 (50 iterations in 0.080s)
[t-SNE] Iteration 850: error = 1.4548711, gradient norm = 0.0001284 (50 iterations in 0.070s)
[t-SNE] Iteration 900: error = 1.4544644, gradient norm = 0.0000464 (50 iterations in 0.072s)
[t-SNE] Iteration 950: error = 1.4542050, gradient norm = 0.0001054 (50 iterations in 0.070s)
[t-SNE] Iteration 1000: error = 1.4531972, gradient norm = 0.0002419 (50 iterations in 0.071s)
[t-SNE] KL divergence after 1000 iterations: 1.453197
[t-SNE] Computed conditional probabilities for sample 837 / 837
[t-SNE] Mean sigma: 0.319081
Beginning preprocessing + Leiden
2024-03-16 19:26:26.992852 MEMORY 18.169880576
Affmat transformed
2024-03-16 19:26:27.003271 MEMORY 18.169880576
sources, targets, weights extracted
2024-03-16 19:26:27.010105 MEMORY 18.169880576
About to launch parallel Leiden runs
2024-03-16 19:26:27.016636 MEMORY 18.169880576
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    2.2s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    6.6s finished
Parallel Leiden runs finished
2024-03-16 19:26:33.605951 MEMORY 18.169880576
Quality: 0.4613333869223836
Quality: 0.46153652111344756
Quality: 0.4615989848424479
Quality: 0.4622067276277058
Quality: 0.4622581238807384
Quality: 0.4624614347852932
Quality: 0.4624840362987418
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 756 out of 756 | elapsed:    0.3s finished
Got subclusters: Counter({0: 172, 2: 156, 1: 156, 3: 148, 4: 133, 5: 63, 6: 9})
On pattern 5
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 756 samples in 0.006s...
[t-SNE] Computed neighbors for 756 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 756 / 756
[t-SNE] Mean sigma: 0.255642
[t-SNE] Computed conditional probabilities in 0.057s
[t-SNE] Iteration 50: error = 65.6789703, gradient norm = 0.3777083 (50 iterations in 0.094s)
[t-SNE] Iteration 100: error = 67.7131119, gradient norm = 0.3549108 (50 iterations in 0.072s)
[t-SNE] Iteration 150: error = 66.5952682, gradient norm = 0.3670823 (50 iterations in 0.070s)
[t-SNE] Iteration 200: error = 67.4575500, gradient norm = 0.3539971 (50 iterations in 0.071s)
[t-SNE] Iteration 250: error = 66.4804382, gradient norm = 0.3889636 (50 iterations in 0.072s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 66.480438
[t-SNE] Iteration 300: error = 1.3182898, gradient norm = 0.0023106 (50 iterations in 0.068s)
[t-SNE] Iteration 350: error = 1.2844068, gradient norm = 0.0004836 (50 iterations in 0.066s)
[t-SNE] Iteration 400: error = 1.2667315, gradient norm = 0.0004905 (50 iterations in 0.066s)
[t-SNE] Iteration 450: error = 1.2600913, gradient norm = 0.0002937 (50 iterations in 0.066s)
[t-SNE] Iteration 500: error = 1.2572017, gradient norm = 0.0001389 (50 iterations in 0.066s)
[t-SNE] Iteration 550: error = 1.2553689, gradient norm = 0.0000891 (50 iterations in 0.066s)
[t-SNE] Iteration 600: error = 1.2540426, gradient norm = 0.0002404 (50 iterations in 0.066s)
[t-SNE] Iteration 650: error = 1.2483275, gradient norm = 0.0002662 (50 iterations in 0.069s)
[t-SNE] Iteration 700: error = 1.2427554, gradient norm = 0.0002671 (50 iterations in 0.066s)
[t-SNE] Iteration 750: error = 1.2358379, gradient norm = 0.0004538 (50 iterations in 0.068s)
[t-SNE] Iteration 800: error = 1.2265530, gradient norm = 0.0007365 (50 iterations in 0.066s)
[t-SNE] Iteration 850: error = 1.2177229, gradient norm = 0.0001907 (50 iterations in 0.066s)
[t-SNE] Iteration 900: error = 1.2163627, gradient norm = 0.0000871 (50 iterations in 0.066s)
[t-SNE] Iteration 950: error = 1.2144418, gradient norm = 0.0002156 (50 iterations in 0.066s)
[t-SNE] Iteration 1000: error = 1.2102549, gradient norm = 0.0002514 (50 iterations in 0.066s)
[t-SNE] KL divergence after 1000 iterations: 1.210255
[t-SNE] Computed conditional probabilities for sample 756 / 756
[t-SNE] Mean sigma: 0.255642
Beginning preprocessing + Leiden
2024-03-16 19:26:36.235889 MEMORY 18.169880576
Affmat transformed
2024-03-16 19:26:36.244725 MEMORY 18.169880576
sources, targets, weights extracted
2024-03-16 19:26:36.251883 MEMORY 18.169880576
About to launch parallel Leiden runs
2024-03-16 19:26:36.259868 MEMORY 18.169851904
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.9s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    6.0s finished
Parallel Leiden runs finished
2024-03-16 19:26:42.239883 MEMORY 18.169851904
Quality: 0.44963337958960586
Quality: 0.44988435652886594
Quality: 0.45038978740823815
Quality: 0.45061714658517604
Quality: 0.4512892762323065
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 344 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 523 out of 523 | elapsed:    0.3s finished
Got subclusters: Counter({0: 195, 1: 168, 2: 145, 3: 142, 4: 87, 5: 14, 6: 5})
On pattern 6
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 523 samples in 0.004s...
[t-SNE] Computed neighbors for 523 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 523 / 523
[t-SNE] Mean sigma: 0.342407
[t-SNE] Computed conditional probabilities in 0.037s
[t-SNE] Iteration 50: error = 67.4547043, gradient norm = 0.4572117 (50 iterations in 0.056s)
[t-SNE] Iteration 100: error = 69.9375992, gradient norm = 0.4409754 (50 iterations in 0.056s)
[t-SNE] Iteration 150: error = 68.3819427, gradient norm = 0.4658724 (50 iterations in 0.058s)
[t-SNE] Iteration 200: error = 70.6366882, gradient norm = 0.4391408 (50 iterations in 0.058s)
[t-SNE] Iteration 250: error = 70.3395691, gradient norm = 0.4366843 (50 iterations in 0.056s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 70.339569
[t-SNE] Iteration 300: error = 1.4995823, gradient norm = 0.0040458 (50 iterations in 0.057s)
[t-SNE] Iteration 350: error = 1.3894197, gradient norm = 0.0026089 (50 iterations in 0.054s)
[t-SNE] Iteration 400: error = 1.3331416, gradient norm = 0.0011005 (50 iterations in 0.057s)
[t-SNE] Iteration 450: error = 1.3079710, gradient norm = 0.0008900 (50 iterations in 0.054s)
[t-SNE] Iteration 500: error = 1.2967625, gradient norm = 0.0006096 (50 iterations in 0.057s)
[t-SNE] Iteration 550: error = 1.2831861, gradient norm = 0.0006881 (50 iterations in 0.054s)
[t-SNE] Iteration 600: error = 1.2710035, gradient norm = 0.0005352 (50 iterations in 0.054s)
[t-SNE] Iteration 650: error = 1.2632471, gradient norm = 0.0004747 (50 iterations in 0.054s)
[t-SNE] Iteration 700: error = 1.2553363, gradient norm = 0.0003651 (50 iterations in 0.054s)
[t-SNE] Iteration 750: error = 1.2529825, gradient norm = 0.0003277 (50 iterations in 0.054s)
[t-SNE] Iteration 800: error = 1.2446517, gradient norm = 0.0005326 (50 iterations in 0.054s)
[t-SNE] Iteration 850: error = 1.2425073, gradient norm = 0.0001944 (50 iterations in 0.053s)
[t-SNE] Iteration 900: error = 1.2386897, gradient norm = 0.0003972 (50 iterations in 0.055s)
[t-SNE] Iteration 950: error = 1.2372757, gradient norm = 0.0001207 (50 iterations in 0.054s)
[t-SNE] Iteration 1000: error = 1.2368643, gradient norm = 0.0000833 (50 iterations in 0.053s)
[t-SNE] KL divergence after 1000 iterations: 1.236864
[t-SNE] Computed conditional probabilities for sample 523 / 523
[t-SNE] Mean sigma: 0.342407
Beginning preprocessing + Leiden
2024-03-16 19:26:44.305504 MEMORY 18.169851904
Affmat transformed
2024-03-16 19:26:44.312230 MEMORY 18.169851904
sources, targets, weights extracted
2024-03-16 19:26:44.316386 MEMORY 18.169851904
About to launch parallel Leiden runs
2024-03-16 19:26:44.321916 MEMORY 18.169851904
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.3s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    4.3s finished
Parallel Leiden runs finished
2024-03-16 19:26:48.615569 MEMORY 18.169851904
Quality: 0.3950334810924195
Quality: 0.3968070495049855
Quality: 0.3973193193361247
Quality: 0.39760652093776055
Quality: 0.3976643684955797
Quality: 0.39767082563654726
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 344 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 435 out of 435 | elapsed:    0.2s finished
Got subclusters: Counter({0: 86, 1: 78, 2: 77, 4: 68, 3: 68, 5: 50, 6: 49, 7: 47})
On pattern 7
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 435 samples in 0.004s...
[t-SNE] Computed neighbors for 435 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 435 / 435
[t-SNE] Mean sigma: 0.333142
[t-SNE] Computed conditional probabilities in 0.033s
[t-SNE] Iteration 50: error = 68.9294434, gradient norm = 0.4564910 (50 iterations in 0.050s)
[t-SNE] Iteration 100: error = 72.3846512, gradient norm = 0.4755960 (50 iterations in 0.050s)
[t-SNE] Iteration 150: error = 73.4956818, gradient norm = 0.4342492 (50 iterations in 0.051s)
[t-SNE] Iteration 200: error = 75.1786957, gradient norm = 0.4290444 (50 iterations in 0.052s)
[t-SNE] Iteration 250: error = 73.7201233, gradient norm = 0.4469104 (50 iterations in 0.051s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 73.720123
[t-SNE] Iteration 300: error = 1.3903463, gradient norm = 0.0049545 (50 iterations in 0.049s)
[t-SNE] Iteration 350: error = 1.2689557, gradient norm = 0.0013071 (50 iterations in 0.048s)
[t-SNE] Iteration 400: error = 1.2416605, gradient norm = 0.0006562 (50 iterations in 0.049s)
[t-SNE] Iteration 450: error = 1.2285901, gradient norm = 0.0008270 (50 iterations in 0.048s)
[t-SNE] Iteration 500: error = 1.2183594, gradient norm = 0.0011010 (50 iterations in 0.048s)
[t-SNE] Iteration 550: error = 1.2089629, gradient norm = 0.0009564 (50 iterations in 0.048s)
[t-SNE] Iteration 600: error = 1.2042860, gradient norm = 0.0003972 (50 iterations in 0.048s)
[t-SNE] Iteration 650: error = 1.1912464, gradient norm = 0.0011129 (50 iterations in 0.051s)
[t-SNE] Iteration 700: error = 1.1842391, gradient norm = 0.0002386 (50 iterations in 0.048s)
[t-SNE] Iteration 750: error = 1.1836420, gradient norm = 0.0000763 (50 iterations in 0.048s)
[t-SNE] Iteration 800: error = 1.1836632, gradient norm = 0.0000710 (50 iterations in 0.047s)
[t-SNE] Iteration 850: error = 1.1835035, gradient norm = 0.0000649 (50 iterations in 0.048s)
[t-SNE] Iteration 900: error = 1.1833957, gradient norm = 0.0000732 (50 iterations in 0.052s)
[t-SNE] Iteration 950: error = 1.1835759, gradient norm = 0.0000476 (50 iterations in 0.048s)
[t-SNE] Iteration 1000: error = 1.1835028, gradient norm = 0.0000498 (50 iterations in 0.048s)
[t-SNE] KL divergence after 1000 iterations: 1.183503
[t-SNE] Computed conditional probabilities for sample 435 / 435
[t-SNE] Mean sigma: 0.333142
Beginning preprocessing + Leiden
2024-03-16 19:26:50.341788 MEMORY 18.169851904
Affmat transformed
2024-03-16 19:26:50.347160 MEMORY 18.169851904
sources, targets, weights extracted
2024-03-16 19:26:50.350509 MEMORY 18.169851904
About to launch parallel Leiden runs
2024-03-16 19:26:50.356186 MEMORY 18.169851904
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.2s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    3.4s finished
Parallel Leiden runs finished
2024-03-16 19:26:53.771135 MEMORY 18.169851904
Quality: 0.38303274872739634
Quality: 0.38376574782661343
Quality: 0.3837747240315006
Quality: 0.38410220317539023
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 379 out of 379 | elapsed:    0.1s finished
Got subclusters: Counter({0: 75, 1: 63, 2: 60, 3: 56, 4: 54, 5: 50, 6: 46, 7: 31})
On pattern 8
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 379 samples in 0.003s...
[t-SNE] Computed neighbors for 379 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 379 / 379
[t-SNE] Mean sigma: 0.314806
[t-SNE] Computed conditional probabilities in 0.027s
[t-SNE] Iteration 50: error = 70.1570969, gradient norm = 0.4430555 (50 iterations in 0.051s)
[t-SNE] Iteration 100: error = 75.7734909, gradient norm = 0.4060322 (50 iterations in 0.046s)
[t-SNE] Iteration 150: error = 71.9140549, gradient norm = 0.4292286 (50 iterations in 0.046s)
[t-SNE] Iteration 200: error = 75.4634018, gradient norm = 0.3977267 (50 iterations in 0.046s)
[t-SNE] Iteration 250: error = 75.7476501, gradient norm = 0.3999449 (50 iterations in 0.047s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 75.747650
[t-SNE] Iteration 300: error = 1.3276457, gradient norm = 0.0040280 (50 iterations in 0.046s)
[t-SNE] Iteration 350: error = 1.1313599, gradient norm = 0.0026823 (50 iterations in 0.045s)
[t-SNE] Iteration 400: error = 1.0513272, gradient norm = 0.0017345 (50 iterations in 0.044s)
[t-SNE] Iteration 450: error = 1.0178481, gradient norm = 0.0011779 (50 iterations in 0.044s)
[t-SNE] Iteration 500: error = 1.0090475, gradient norm = 0.0006148 (50 iterations in 0.044s)
[t-SNE] Iteration 550: error = 0.9859592, gradient norm = 0.0004254 (50 iterations in 0.044s)
[t-SNE] Iteration 600: error = 0.9835099, gradient norm = 0.0006780 (50 iterations in 0.044s)
[t-SNE] Iteration 650: error = 0.9808971, gradient norm = 0.0002354 (50 iterations in 0.044s)
[t-SNE] Iteration 700: error = 0.9808329, gradient norm = 0.0001204 (50 iterations in 0.044s)
[t-SNE] Iteration 750: error = 0.9807941, gradient norm = 0.0001911 (50 iterations in 0.044s)
[t-SNE] Iteration 800: error = 0.9803820, gradient norm = 0.0002395 (50 iterations in 0.044s)
[t-SNE] Iteration 850: error = 0.9799695, gradient norm = 0.0002858 (50 iterations in 0.045s)
[t-SNE] Iteration 900: error = 0.9741741, gradient norm = 0.0007468 (50 iterations in 0.045s)
[t-SNE] Iteration 950: error = 0.9718140, gradient norm = 0.0001146 (50 iterations in 0.046s)
[t-SNE] Iteration 1000: error = 0.9717545, gradient norm = 0.0000644 (50 iterations in 0.046s)
[t-SNE] KL divergence after 1000 iterations: 0.971754
[t-SNE] Computed conditional probabilities for sample 379 / 379
[t-SNE] Mean sigma: 0.314806
Beginning preprocessing + Leiden
2024-03-16 19:26:55.307092 MEMORY 18.169851904
Affmat transformed
2024-03-16 19:26:55.312430 MEMORY 18.169851904
sources, targets, weights extracted
2024-03-16 19:26:55.315675 MEMORY 18.169851904
About to launch parallel Leiden runs
2024-03-16 19:26:55.320375 MEMORY 18.169851904
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.1s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    3.4s finished
Parallel Leiden runs finished
2024-03-16 19:26:58.746515 MEMORY 18.169851904
Quality: 0.37021824197198017
Quality: 0.3704553950520786
Quality: 0.37049637463246377
Quality: 0.3705523773822351
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 300 out of 347 | elapsed:    0.1s remaining:    0.0s
[Parallel(n_jobs=24)]: Done 347 out of 347 | elapsed:    0.1s finished
Got subclusters: Counter({0: 99, 1: 87, 2: 80, 3: 73, 4: 40})
On pattern 9
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 347 samples in 0.004s...
[t-SNE] Computed neighbors for 347 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 347 / 347
[t-SNE] Mean sigma: 0.350946
[t-SNE] Computed conditional probabilities in 0.024s
[t-SNE] Iteration 50: error = 67.3410950, gradient norm = 0.4551154 (50 iterations in 0.045s)
[t-SNE] Iteration 100: error = 66.2270126, gradient norm = 0.4960165 (50 iterations in 0.044s)
[t-SNE] Iteration 150: error = 71.3072891, gradient norm = 0.4458762 (50 iterations in 0.065s)
[t-SNE] Iteration 200: error = 66.8298035, gradient norm = 0.5015391 (50 iterations in 0.046s)
[t-SNE] Iteration 250: error = 68.7517548, gradient norm = 0.4734604 (50 iterations in 0.045s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 68.751755
[t-SNE] Iteration 300: error = 1.2835472, gradient norm = 0.0053433 (50 iterations in 0.069s)
[t-SNE] Iteration 350: error = 1.1371770, gradient norm = 0.0034428 (50 iterations in 0.044s)
[t-SNE] Iteration 400: error = 1.0572278, gradient norm = 0.0020354 (50 iterations in 0.044s)
[t-SNE] Iteration 450: error = 1.0192857, gradient norm = 0.0009616 (50 iterations in 0.043s)
[t-SNE] Iteration 500: error = 1.0046273, gradient norm = 0.0006372 (50 iterations in 0.044s)
[t-SNE] Iteration 550: error = 1.0029976, gradient norm = 0.0002222 (50 iterations in 0.044s)
[t-SNE] Iteration 600: error = 1.0029522, gradient norm = 0.0000675 (50 iterations in 0.045s)
[t-SNE] Iteration 650: error = 1.0030249, gradient norm = 0.0001008 (50 iterations in 0.043s)
[t-SNE] Iteration 700: error = 1.0031288, gradient norm = 0.0001227 (50 iterations in 0.043s)
[t-SNE] Iteration 750: error = 1.0029916, gradient norm = 0.0001159 (50 iterations in 0.043s)
[t-SNE] Iteration 800: error = 1.0015118, gradient norm = 0.0001723 (50 iterations in 0.042s)
[t-SNE] Iteration 850: error = 1.0009106, gradient norm = 0.0001150 (50 iterations in 0.041s)
[t-SNE] Iteration 900: error = 1.0010879, gradient norm = 0.0001018 (50 iterations in 0.041s)
[t-SNE] Iteration 950: error = 1.0009121, gradient norm = 0.0001211 (50 iterations in 0.043s)
[t-SNE] Iteration 1000: error = 1.0009335, gradient norm = 0.0001174 (50 iterations in 0.042s)
[t-SNE] KL divergence after 1000 iterations: 1.000934
[t-SNE] Computed conditional probabilities for sample 347 / 347
[t-SNE] Mean sigma: 0.350947
Beginning preprocessing + Leiden
2024-03-16 19:27:00.220166 MEMORY 18.169851904
Affmat transformed
2024-03-16 19:27:00.226134 MEMORY 18.169851904
sources, targets, weights extracted
2024-03-16 19:27:00.229952 MEMORY 18.169851904
About to launch parallel Leiden runs
2024-03-16 19:27:00.235554 MEMORY 18.169851904
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.0s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    3.0s finished
Parallel Leiden runs finished
2024-03-16 19:27:03.217915 MEMORY 18.169851904
Quality: 0.36952256386686116
Quality: 0.36992143117263754
Quality: 0.37390631313347306
Quality: 0.3741528455860668
Quality: 0.37540537144813435
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 345 out of 345 | elapsed:    0.1s finished
Got subclusters: Counter({0: 86, 1: 80, 2: 70, 3: 52, 4: 45, 5: 12, 6: 2})
On pattern 10
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 345 samples in 0.003s...
[t-SNE] Computed neighbors for 345 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 345 / 345
[t-SNE] Mean sigma: 0.336594
[t-SNE] Computed conditional probabilities in 0.024s
[t-SNE] Iteration 50: error = 66.2604218, gradient norm = 0.4811639 (50 iterations in 0.065s)
[t-SNE] Iteration 100: error = 68.9965515, gradient norm = 0.4746033 (50 iterations in 0.043s)
[t-SNE] Iteration 150: error = 71.6805420, gradient norm = 0.4556126 (50 iterations in 0.059s)
[t-SNE] Iteration 200: error = 70.0745087, gradient norm = 0.4578482 (50 iterations in 0.056s)
[t-SNE] Iteration 250: error = 68.7517548, gradient norm = 0.4914675 (50 iterations in 0.046s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 68.751755
[t-SNE] Iteration 300: error = 1.2843311, gradient norm = 0.0056650 (50 iterations in 0.043s)
[t-SNE] Iteration 350: error = 1.1653352, gradient norm = 0.0027002 (50 iterations in 0.042s)
[t-SNE] Iteration 400: error = 1.0864058, gradient norm = 0.0020482 (50 iterations in 0.043s)
[t-SNE] Iteration 450: error = 1.0621732, gradient norm = 0.0012733 (50 iterations in 0.042s)
[t-SNE] Iteration 500: error = 1.0544678, gradient norm = 0.0003251 (50 iterations in 0.046s)
[t-SNE] Iteration 550: error = 1.0505577, gradient norm = 0.0004835 (50 iterations in 0.045s)
[t-SNE] Iteration 600: error = 1.0495220, gradient norm = 0.0001275 (50 iterations in 0.042s)
[t-SNE] Iteration 650: error = 1.0491024, gradient norm = 0.0001263 (50 iterations in 0.044s)
[t-SNE] Iteration 700: error = 1.0488683, gradient norm = 0.0000758 (50 iterations in 0.042s)
[t-SNE] Iteration 750: error = 1.0488327, gradient norm = 0.0001319 (50 iterations in 0.045s)
[t-SNE] Iteration 800: error = 1.0486404, gradient norm = 0.0000782 (50 iterations in 0.043s)
[t-SNE] Iteration 850: error = 1.0486667, gradient norm = 0.0002262 (50 iterations in 0.045s)
[t-SNE] Iteration 900: error = 1.0485264, gradient norm = 0.0001613 (50 iterations in 0.042s)
[t-SNE] Iteration 950: error = 1.0483701, gradient norm = 0.0000783 (50 iterations in 0.043s)
[t-SNE] Iteration 1000: error = 1.0478587, gradient norm = 0.0001531 (50 iterations in 0.045s)
[t-SNE] KL divergence after 1000 iterations: 1.047859
[t-SNE] Computed conditional probabilities for sample 345 / 345
[t-SNE] Mean sigma: 0.336594
Beginning preprocessing + Leiden
2024-03-16 19:27:04.720093 MEMORY 18.169851904
Affmat transformed
2024-03-16 19:27:04.724826 MEMORY 18.169851904
sources, targets, weights extracted
2024-03-16 19:27:04.727376 MEMORY 18.169851904
About to launch parallel Leiden runs
2024-03-16 19:27:04.732273 MEMORY 18.169851904
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.0s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    3.0s finished
Parallel Leiden runs finished
2024-03-16 19:27:07.703990 MEMORY 18.169851904
Quality: 0.3530175899389355
Quality: 0.353034556717165
Quality: 0.35386346377895717
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 261 out of 261 | elapsed:    0.1s finished
Got subclusters: Counter({0: 83, 1: 70, 2: 65, 3: 64, 4: 58, 5: 5})
On pattern 11
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 261 samples in 0.002s...
[t-SNE] Computed neighbors for 261 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 261 / 261
[t-SNE] Mean sigma: 0.352242
[t-SNE] Computed conditional probabilities in 0.018s
[t-SNE] Iteration 50: error = 66.6879501, gradient norm = 0.4820118 (50 iterations in 0.040s)
[t-SNE] Iteration 100: error = 66.5806198, gradient norm = 0.4649412 (50 iterations in 0.040s)
[t-SNE] Iteration 150: error = 66.8885803, gradient norm = 0.4486246 (50 iterations in 0.041s)
[t-SNE] Iteration 200: error = 66.9882126, gradient norm = 0.4792895 (50 iterations in 0.041s)
[t-SNE] Iteration 250: error = 66.3469849, gradient norm = 0.4820233 (50 iterations in 0.040s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 66.346985
[t-SNE] Iteration 300: error = 1.0805540, gradient norm = 0.0056095 (50 iterations in 0.039s)
[t-SNE] Iteration 350: error = 0.9004744, gradient norm = 0.0039192 (50 iterations in 0.039s)
[t-SNE] Iteration 400: error = 0.8092758, gradient norm = 0.0024209 (50 iterations in 0.038s)
[t-SNE] Iteration 450: error = 0.7725629, gradient norm = 0.0009306 (50 iterations in 0.042s)
[t-SNE] Iteration 500: error = 0.7652296, gradient norm = 0.0004089 (50 iterations in 0.037s)
[t-SNE] Iteration 550: error = 0.7538469, gradient norm = 0.0003291 (50 iterations in 0.037s)
[t-SNE] Iteration 600: error = 0.7494242, gradient norm = 0.0001538 (50 iterations in 0.039s)
[t-SNE] Iteration 650: error = 0.7492191, gradient norm = 0.0001669 (50 iterations in 0.038s)
[t-SNE] Iteration 700: error = 0.7493570, gradient norm = 0.0001340 (50 iterations in 0.040s)
[t-SNE] Iteration 750: error = 0.7495203, gradient norm = 0.0001500 (50 iterations in 0.039s)
[t-SNE] Iteration 800: error = 0.7494325, gradient norm = 0.0001118 (50 iterations in 0.038s)
[t-SNE] Iteration 850: error = 0.7494491, gradient norm = 0.0001093 (50 iterations in 0.039s)
[t-SNE] Iteration 900: error = 0.7492896, gradient norm = 0.0000779 (50 iterations in 0.037s)
[t-SNE] Iteration 950: error = 0.7490171, gradient norm = 0.0000716 (50 iterations in 0.039s)
[t-SNE] Iteration 1000: error = 0.7490436, gradient norm = 0.0000947 (50 iterations in 0.038s)
[t-SNE] KL divergence after 1000 iterations: 0.749044
[t-SNE] Computed conditional probabilities for sample 261 / 261
[t-SNE] Mean sigma: 0.352242
Beginning preprocessing + Leiden
2024-03-16 19:27:08.900000 MEMORY 18.169851904
Affmat transformed
2024-03-16 19:27:08.903639 MEMORY 18.169851904
sources, targets, weights extracted
2024-03-16 19:27:08.905345 MEMORY 18.169851904
About to launch parallel Leiden runs
2024-03-16 19:27:08.909373 MEMORY 18.169851904
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.9s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.7s finished
Parallel Leiden runs finished
2024-03-16 19:27:11.577825 MEMORY 18.169851904
Quality: 0.35042147473093155
Quality: 0.3533779847946238
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  92 out of 139 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=24)]: Done 139 out of 139 | elapsed:    0.1s finished
Got subclusters: Counter({1: 72, 0: 72, 2: 50, 3: 40, 4: 23, 5: 4})
On pattern 12
[t-SNE] Computing 138 nearest neighbors...
[t-SNE] Indexed 139 samples in 0.001s...
[t-SNE] Computed neighbors for 139 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 139 / 139
[t-SNE] Mean sigma: 0.393109
[t-SNE] Computed conditional probabilities in 0.012s
[t-SNE] Iteration 50: error = 55.6390305, gradient norm = 0.4854330 (50 iterations in 0.028s)
[t-SNE] Iteration 100: error = 54.7804222, gradient norm = 0.4823295 (50 iterations in 0.029s)
[t-SNE] Iteration 150: error = 56.7227364, gradient norm = 0.5546906 (50 iterations in 0.028s)
[t-SNE] Iteration 200: error = 56.3108406, gradient norm = 0.5154546 (50 iterations in 0.028s)
[t-SNE] Iteration 250: error = 56.7341766, gradient norm = 0.5017518 (50 iterations in 0.027s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 56.734177
[t-SNE] Iteration 300: error = 0.6203302, gradient norm = 0.0098290 (50 iterations in 0.027s)
[t-SNE] Iteration 350: error = 0.2885810, gradient norm = 0.0042592 (50 iterations in 0.030s)
[t-SNE] Iteration 400: error = 0.2858204, gradient norm = 0.0002263 (50 iterations in 0.027s)
[t-SNE] Iteration 450: error = 0.2857876, gradient norm = 0.0003791 (50 iterations in 0.027s)
[t-SNE] Iteration 500: error = 0.2857019, gradient norm = 0.0002144 (50 iterations in 0.027s)
[t-SNE] Iteration 550: error = 0.2857887, gradient norm = 0.0003281 (50 iterations in 0.028s)
[t-SNE] Iteration 600: error = 0.2857530, gradient norm = 0.0002487 (50 iterations in 0.027s)
[t-SNE] Iteration 650: error = 0.2857311, gradient norm = 0.0001770 (50 iterations in 0.027s)
[t-SNE] Iteration 700: error = 0.2857254, gradient norm = 0.0002536 (50 iterations in 0.027s)
[t-SNE] Iteration 750: error = 0.2857133, gradient norm = 0.0002026 (50 iterations in 0.027s)
[t-SNE] Iteration 800: error = 0.2857565, gradient norm = 0.0002831 (50 iterations in 0.027s)
[t-SNE] Iteration 850: error = 0.2857350, gradient norm = 0.0002384 (50 iterations in 0.028s)
[t-SNE] Iteration 850: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 850 iterations: 0.285735
[t-SNE] Computed conditional probabilities for sample 139 / 139
[t-SNE] Mean sigma: 0.393109
Beginning preprocessing + Leiden
2024-03-16 19:27:12.278484 MEMORY 18.169851904
Affmat transformed
2024-03-16 19:27:12.280497 MEMORY 18.169851904
sources, targets, weights extracted
2024-03-16 19:27:12.281250 MEMORY 18.169851904
About to launch parallel Leiden runs
2024-03-16 19:27:12.322947 MEMORY 18.169851904
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.9s finished
Parallel Leiden runs finished
2024-03-16 19:27:14.233729 MEMORY 18.169851904
Quality: 0.27206277397286904
Quality: 0.2720667733224121
Quality: 0.2743675216750901
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 106 out of 106 | elapsed:    0.0s finished
Got subclusters: Counter({0: 57, 1: 31, 2: 23, 3: 15, 4: 13})
On pattern 13
[t-SNE] Computing 105 nearest neighbors...
[t-SNE] Indexed 106 samples in 0.001s...
[t-SNE] Computed neighbors for 106 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 106 / 106
[t-SNE] Mean sigma: 0.438759
[t-SNE] Computed conditional probabilities in 0.005s
[t-SNE] Iteration 50: error = 50.9153366, gradient norm = 0.4768737 (50 iterations in 0.023s)
[t-SNE] Iteration 100: error = 49.6897163, gradient norm = 0.5643703 (50 iterations in 0.023s)
[t-SNE] Iteration 150: error = 53.1413918, gradient norm = 0.5392472 (50 iterations in 0.022s)
[t-SNE] Iteration 200: error = 52.7273903, gradient norm = 0.5498083 (50 iterations in 0.023s)
[t-SNE] Iteration 250: error = 55.5726776, gradient norm = 0.4990635 (50 iterations in 0.023s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 55.572678
[t-SNE] Iteration 300: error = 0.8902212, gradient norm = 0.0136628 (50 iterations in 0.022s)
[t-SNE] Iteration 350: error = 0.6287917, gradient norm = 0.0080619 (50 iterations in 0.022s)
[t-SNE] Iteration 400: error = 0.3812450, gradient norm = 0.0027305 (50 iterations in 0.021s)
[t-SNE] Iteration 450: error = 0.3759496, gradient norm = 0.0007523 (50 iterations in 0.022s)
[t-SNE] Iteration 500: error = 0.3766834, gradient norm = 0.0002575 (50 iterations in 0.022s)
[t-SNE] Iteration 550: error = 0.3766837, gradient norm = 0.0002629 (50 iterations in 0.022s)
[t-SNE] Iteration 600: error = 0.3766844, gradient norm = 0.0002566 (50 iterations in 0.021s)
[t-SNE] Iteration 650: error = 0.3767052, gradient norm = 0.0002527 (50 iterations in 0.022s)
[t-SNE] Iteration 700: error = 0.3767179, gradient norm = 0.0002904 (50 iterations in 0.022s)
[t-SNE] Iteration 750: error = 0.3766077, gradient norm = 0.0002698 (50 iterations in 0.022s)
[t-SNE] Iteration 800: error = 0.3767257, gradient norm = 0.0002467 (50 iterations in 0.022s)
[t-SNE] Iteration 800: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 800 iterations: 0.376726
[t-SNE] Computed conditional probabilities for sample 106 / 106
[t-SNE] Mean sigma: 0.438759
Beginning preprocessing + Leiden
2024-03-16 19:27:14.735012 MEMORY 18.169851904
Affmat transformed
2024-03-16 19:27:14.736586 MEMORY 18.169851904
sources, targets, weights extracted
2024-03-16 19:27:14.737230 MEMORY 18.169851904
About to launch parallel Leiden runs
2024-03-16 19:27:14.740882 MEMORY 18.169851904
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.8s finished
Parallel Leiden runs finished
2024-03-16 19:27:16.582582 MEMORY 18.169851904
Quality: 0.21861973750968275
Quality: 0.22106577829392318
Quality: 0.22110445695864114
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  73 out of  73 | elapsed:    0.0s finished
Got subclusters: Counter({0: 31, 1: 29, 2: 20, 3: 15, 4: 11})
On pattern 14
[t-SNE] Computing 72 nearest neighbors...
[t-SNE] Indexed 73 samples in 0.001s...
[t-SNE] Computed neighbors for 73 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 73 / 73
[t-SNE] Mean sigma: 0.544327
[t-SNE] Computed conditional probabilities in 0.003s
[t-SNE] Iteration 50: error = 48.2390823, gradient norm = 0.4520030 (50 iterations in 0.020s)
[t-SNE] Iteration 100: error = 46.0953827, gradient norm = 0.5800918 (50 iterations in 0.016s)
[t-SNE] Iteration 150: error = 48.4312897, gradient norm = 0.4603220 (50 iterations in 0.016s)
[t-SNE] Iteration 200: error = 49.9431229, gradient norm = 0.4340958 (50 iterations in 0.016s)
[t-SNE] Iteration 250: error = 52.0223923, gradient norm = 0.5405287 (50 iterations in 0.016s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 52.022392
[t-SNE] Iteration 300: error = 0.9227251, gradient norm = 0.0025186 (50 iterations in 0.017s)
[t-SNE] Iteration 350: error = 0.7265568, gradient norm = 0.0007141 (50 iterations in 0.017s)
[t-SNE] Iteration 400: error = 0.6803558, gradient norm = 0.0006969 (50 iterations in 0.016s)
[t-SNE] Iteration 450: error = 0.6526553, gradient norm = 0.0006308 (50 iterations in 0.016s)
[t-SNE] Iteration 500: error = 0.6285649, gradient norm = 0.0004452 (50 iterations in 0.016s)
[t-SNE] Iteration 550: error = 0.5943715, gradient norm = 0.0005559 (50 iterations in 0.018s)
[t-SNE] Iteration 600: error = 0.5816037, gradient norm = 0.0003384 (50 iterations in 0.016s)
[t-SNE] Iteration 650: error = 0.5792351, gradient norm = 0.0001132 (50 iterations in 0.017s)
[t-SNE] Iteration 700: error = 0.5750144, gradient norm = 0.0001703 (50 iterations in 0.017s)
[t-SNE] Iteration 750: error = 0.5686863, gradient norm = 0.0002008 (50 iterations in 0.017s)
[t-SNE] Iteration 800: error = 0.5535434, gradient norm = 0.0015352 (50 iterations in 0.017s)
[t-SNE] Iteration 850: error = 0.2393433, gradient norm = 0.0312355 (50 iterations in 0.015s)
[t-SNE] Iteration 900: error = 0.1672953, gradient norm = 0.0061503 (50 iterations in 0.016s)
[t-SNE] Iteration 950: error = 0.1659369, gradient norm = 0.0013273 (50 iterations in 0.015s)
[t-SNE] Iteration 1000: error = 0.1656575, gradient norm = 0.0006871 (50 iterations in 0.016s)
[t-SNE] KL divergence after 1000 iterations: 0.165657
[t-SNE] Computed conditional probabilities for sample 73 / 73
[t-SNE] Mean sigma: 0.544327
Beginning preprocessing + Leiden
2024-03-16 19:27:17.003407 MEMORY 18.169851904
Affmat transformed
2024-03-16 19:27:17.004741 MEMORY 18.169851904
sources, targets, weights extracted
2024-03-16 19:27:17.005265 MEMORY 18.169851904
About to launch parallel Leiden runs
2024-03-16 19:27:17.009617 MEMORY 18.169851904
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.6s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.7s finished
Parallel Leiden runs finished
2024-03-16 19:27:18.740724 MEMORY 18.169851904
Quality: 0.1241176782633874
Quality: 0.12464997238687661
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  55 out of  55 | elapsed:    0.0s finished
Got subclusters: Counter({1: 18, 0: 18, 2: 16, 3: 13, 4: 8})
On pattern 15
[t-SNE] Computing 54 nearest neighbors...
[t-SNE] Indexed 55 samples in 0.001s...
[t-SNE] Computed neighbors for 55 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 55 / 55
[t-SNE] Mean sigma: 0.869837
[t-SNE] Computed conditional probabilities in 0.001s
[t-SNE] Iteration 50: error = 45.0483208, gradient norm = 0.3779024 (50 iterations in 0.013s)
[t-SNE] Iteration 100: error = 46.6408005, gradient norm = 0.4359472 (50 iterations in 0.012s)
[t-SNE] Iteration 150: error = 43.8868599, gradient norm = 0.5700580 (50 iterations in 0.012s)
[t-SNE] Iteration 200: error = 47.1712875, gradient norm = 0.6079138 (50 iterations in 0.012s)
[t-SNE] Iteration 250: error = 44.3293190, gradient norm = 0.4902278 (50 iterations in 0.012s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 44.329319
[t-SNE] Iteration 300: error = 0.7478766, gradient norm = 0.0014284 (50 iterations in 0.012s)
[t-SNE] Iteration 350: error = 0.6605567, gradient norm = 0.0003668 (50 iterations in 0.012s)
[t-SNE] Iteration 400: error = 0.6380835, gradient norm = 0.0002691 (50 iterations in 0.011s)
[t-SNE] Iteration 450: error = 0.6207587, gradient norm = 0.0002535 (50 iterations in 0.011s)
[t-SNE] Iteration 500: error = 0.6066597, gradient norm = 0.0002489 (50 iterations in 0.011s)
[t-SNE] Iteration 550: error = 0.5922313, gradient norm = 0.0002134 (50 iterations in 0.011s)
[t-SNE] Iteration 600: error = 0.5776955, gradient norm = 0.0002711 (50 iterations in 0.011s)
[t-SNE] Iteration 650: error = 0.5681280, gradient norm = 0.0001877 (50 iterations in 0.011s)
[t-SNE] Iteration 700: error = 0.5600943, gradient norm = 0.0001962 (50 iterations in 0.011s)
[t-SNE] Iteration 750: error = 0.5537313, gradient norm = 0.0001377 (50 iterations in 0.011s)
[t-SNE] Iteration 800: error = 0.5493718, gradient norm = 0.0001737 (50 iterations in 0.011s)
[t-SNE] Iteration 850: error = 0.5403915, gradient norm = 0.0002232 (50 iterations in 0.011s)
[t-SNE] Iteration 900: error = 0.5275593, gradient norm = 0.0003424 (50 iterations in 0.011s)
[t-SNE] Iteration 950: error = 0.5099809, gradient norm = 0.0003281 (50 iterations in 0.011s)
[t-SNE] Iteration 1000: error = 0.5054603, gradient norm = 0.0002293 (50 iterations in 0.011s)
[t-SNE] KL divergence after 1000 iterations: 0.505460
[t-SNE] Computed conditional probabilities for sample 55 / 55
[t-SNE] Mean sigma: 0.869838
Beginning preprocessing + Leiden
2024-03-16 19:27:19.036541 MEMORY 18.169851904
Affmat transformed
2024-03-16 19:27:19.037409 MEMORY 18.169851904
sources, targets, weights extracted
2024-03-16 19:27:19.037772 MEMORY 18.169851904
About to launch parallel Leiden runs
2024-03-16 19:27:19.041585 MEMORY 18.169851904
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.6s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.7s finished
Parallel Leiden runs finished
2024-03-16 19:27:20.750487 MEMORY 18.169851904
Quality: 0.07961206986836364
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  51 out of  51 | elapsed:    0.0s finished
Got subclusters: Counter({0: 23, 1: 17, 2: 15})
On pattern 16
[t-SNE] Computing 50 nearest neighbors...
[t-SNE] Indexed 51 samples in 0.000s...
[t-SNE] Computed neighbors for 51 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 51 / 51
[t-SNE] Mean sigma: 11.046207
[t-SNE] Computed conditional probabilities in 0.001s
[t-SNE] Iteration 50: error = 44.8643532, gradient norm = 0.5631018 (50 iterations in 0.012s)
[t-SNE] Iteration 100: error = 43.6005478, gradient norm = 0.6487295 (50 iterations in 0.011s)
[t-SNE] Iteration 150: error = 44.7974739, gradient norm = 0.7175846 (50 iterations in 0.012s)
[t-SNE] Iteration 200: error = 39.9640274, gradient norm = 0.7166929 (50 iterations in 0.011s)
[t-SNE] Iteration 250: error = 44.4289856, gradient norm = 0.6850078 (50 iterations in 0.011s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 44.428986
[t-SNE] Iteration 300: error = 0.7314466, gradient norm = 0.0011534 (50 iterations in 0.012s)
[t-SNE] Iteration 350: error = 0.6261629, gradient norm = 0.0002629 (50 iterations in 0.011s)
[t-SNE] Iteration 400: error = 0.6206024, gradient norm = 0.0000919 (50 iterations in 0.011s)
[t-SNE] Iteration 450: error = 0.6192901, gradient norm = 0.0000283 (50 iterations in 0.011s)
[t-SNE] Iteration 500: error = 0.6186988, gradient norm = 0.0000292 (50 iterations in 0.011s)
[t-SNE] Iteration 550: error = 0.6192823, gradient norm = 0.0000291 (50 iterations in 0.011s)
[t-SNE] Iteration 600: error = 0.6189201, gradient norm = 0.0000367 (50 iterations in 0.011s)
[t-SNE] Iteration 650: error = 0.6170963, gradient norm = 0.0000555 (50 iterations in 0.011s)
[t-SNE] Iteration 700: error = 0.6170650, gradient norm = 0.0000664 (50 iterations in 0.011s)
[t-SNE] Iteration 750: error = 0.6160335, gradient norm = 0.0000889 (50 iterations in 0.011s)
[t-SNE] Iteration 800: error = 0.6166741, gradient norm = 0.0001087 (50 iterations in 0.011s)
[t-SNE] Iteration 850: error = 0.6146263, gradient norm = 0.0002391 (50 iterations in 0.011s)
[t-SNE] Iteration 900: error = 0.6071405, gradient norm = 0.0006266 (50 iterations in 0.011s)
[t-SNE] Iteration 950: error = 0.7442877, gradient norm = 0.0018618 (50 iterations in 0.011s)
[t-SNE] Iteration 1000: error = 0.6529208, gradient norm = 0.0005545 (50 iterations in 0.011s)
[t-SNE] KL divergence after 1000 iterations: 0.652921
[t-SNE] Computed conditional probabilities for sample 51 / 51
[t-SNE] Mean sigma: 10.944397
Beginning preprocessing + Leiden
2024-03-16 19:27:21.032630 MEMORY 18.169851904
Affmat transformed
2024-03-16 19:27:21.033433 MEMORY 18.169851904
sources, targets, weights extracted
2024-03-16 19:27:21.033787 MEMORY 18.169851904
About to launch parallel Leiden runs
2024-03-16 19:27:21.038392 MEMORY 18.169851904
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.6s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.7s finished
Parallel Leiden runs finished
2024-03-16 19:27:22.763955 MEMORY 18.169851904
Quality: 3.1086244689504336e-15
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  49 out of  49 | elapsed:    0.0s finished
Got subclusters: Counter({0: 51})
On pattern 17
[t-SNE] Computing 48 nearest neighbors...
[t-SNE] Indexed 49 samples in 0.000s...
[t-SNE] Computed neighbors for 49 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 49 / 49
[t-SNE] Mean sigma: 8.212238
[t-SNE] Computed conditional probabilities in 0.001s
[t-SNE] Iteration 50: error = 43.4472694, gradient norm = 0.5857604 (50 iterations in 0.013s)
[t-SNE] Iteration 100: error = 40.6592216, gradient norm = 0.7743018 (50 iterations in 0.011s)
[t-SNE] Iteration 150: error = 45.5610542, gradient norm = 0.4109302 (50 iterations in 0.012s)
[t-SNE] Iteration 200: error = 42.5960617, gradient norm = 0.5169663 (50 iterations in 0.011s)
[t-SNE] Iteration 250: error = 41.8250198, gradient norm = 0.2986331 (50 iterations in 0.011s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 41.825020
[t-SNE] Iteration 300: error = 0.9348612, gradient norm = 0.0016417 (50 iterations in 0.011s)
[t-SNE] Iteration 350: error = 0.7663162, gradient norm = 0.0005835 (50 iterations in 0.011s)
[t-SNE] Iteration 400: error = 0.6587478, gradient norm = 0.0002273 (50 iterations in 0.011s)
[t-SNE] Iteration 450: error = 0.6196160, gradient norm = 0.0001678 (50 iterations in 0.011s)
[t-SNE] Iteration 500: error = 0.6133763, gradient norm = 0.0000418 (50 iterations in 0.011s)
[t-SNE] Iteration 550: error = 0.6125914, gradient norm = 0.0000325 (50 iterations in 0.011s)
[t-SNE] Iteration 600: error = 0.6112281, gradient norm = 0.0000361 (50 iterations in 0.011s)
[t-SNE] Iteration 650: error = 0.6095163, gradient norm = 0.0000345 (50 iterations in 0.011s)
[t-SNE] Iteration 700: error = 0.6089945, gradient norm = 0.0000304 (50 iterations in 0.011s)
[t-SNE] Iteration 750: error = 0.6082269, gradient norm = 0.0000302 (50 iterations in 0.011s)
[t-SNE] Iteration 800: error = 0.6081038, gradient norm = 0.0000249 (50 iterations in 0.011s)
[t-SNE] Iteration 850: error = 0.6080843, gradient norm = 0.0000252 (50 iterations in 0.011s)
[t-SNE] Iteration 900: error = 0.6085784, gradient norm = 0.0000240 (50 iterations in 0.011s)
[t-SNE] Iteration 950: error = 0.6089703, gradient norm = 0.0000224 (50 iterations in 0.011s)
[t-SNE] Iteration 1000: error = 0.6093839, gradient norm = 0.0000271 (50 iterations in 0.011s)
[t-SNE] KL divergence after 1000 iterations: 0.609384
[t-SNE] Computed conditional probabilities for sample 49 / 49
[t-SNE] Mean sigma: 1125899906842624.000000
Beginning preprocessing + Leiden
2024-03-16 19:27:23.043760 MEMORY 18.169851904
Affmat transformed
2024-03-16 19:27:23.044541 MEMORY 18.169851904
sources, targets, weights extracted
2024-03-16 19:27:23.044882 MEMORY 18.169851904
About to launch parallel Leiden runs
2024-03-16 19:27:23.048626 MEMORY 18.169843712
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.6s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.7s finished
Parallel Leiden runs finished
2024-03-16 19:27:24.732995 MEMORY 18.169843712
Quality: 2.4868995751602976e-13
Got subclusters: Counter({0: 49})
