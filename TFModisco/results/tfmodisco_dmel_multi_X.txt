/ru-auth/local/home/xwu05/.local/lib/python3.9/site-packages/pandas/core/computation/expressions.py:21: UserWarning: Pandas requires version '2.8.0' or newer of 'numexpr' (version '2.7.3' currently installed).
  from pandas.core.computation.check import NUMEXPR_INSTALLED
/ru-auth/local/home/xwu05/.local/lib/python3.9/site-packages/pandas/core/arrays/masked.py:62: UserWarning: Pandas requires version '1.3.4' or newer of 'bottleneck' (version '1.3.2' currently installed).
  from pandas.core import (
[22;0t]0;IPython: detect_peaks_scripts/run_modelMEMORY 11.067416576
On task head
Computing windowed sums on original
Generating null dist
peak(mu)= -3.6020154250988173e-06
Computing threshold
Subsampling!
For increasing = True , the minimum IR precision was 0.4156696818981494 occurring at 0.0 implying a frac_neg of 0.71136079888584
To be conservative, adjusted frac neg is 0.95
For increasing = False , the minimum IR precision was 0.4498029909560874 occurring at -2.4792297104170302e-08 implying a frac_neg of 0.8175307818152596
To be conservative, adjusted frac neg is 0.95
Thresholds from null dist were -0.8918038020013581  and  0.536315568363321 with frac passing 0.035004
Final raw thresholds are -0.8918038020013581  and  0.536315568363321
Final transformed thresholds are -0.9828800576213266  and  0.9388666979161306
saving plot to figures/scoredist_0.png
Got 123385 coords
On task testis
Computing windowed sums on original
Generating null dist
peak(mu)= -1.4045563148283938e-05
Computing threshold
Subsampling!
For increasing = True , the minimum IR precision was 0.4200431941500023 occurring at 0.0 implying a frac_neg of 0.7242663417569133
To be conservative, adjusted frac neg is 0.95
For increasing = False , the minimum IR precision was 0.4495881476542768 occurring at -1.3933853892922343e-07 implying a frac_neg of 0.8168213415794736
To be conservative, adjusted frac neg is 0.95
Thresholds from null dist were -0.9917980132793609  and  0.7664139471838873 with frac passing 0.036778
Final raw thresholds are -0.9917980132793609  and  0.7664139471838873
Final transformed thresholds are -0.9737710066876836  and  0.9485934198622786
saving plot to figures/scoredist_1.png
Got 135044 coords
After resolving overlaps, got 175200 seqlets
Across all tasks, the weakest transformed threshold used was: 0.9387666979161307
MEMORY 11.92716288
175200 identified in total
min_metacluster_size_frac * len(seqlets) = 1752 is more than min_metacluster_size=100.
Using it as a new min_metacluster_size
6 activity patterns with support >= 1752 out of 8 possible patterns
Metacluster sizes:  [91456, 60626, 10875, 7812, 2477, 1954]
Idx to activities:  {0: '1,1', 1: '-1,-1', 2: '0,1', 3: '1,0', 4: '0,-1', 5: '-1,0'}
MEMORY 11.927179264
On metacluster 5
Metacluster size 1954
Relevant tasks:  ('head',)
Relevant signs:  (-1,)
TfModiscoSeqletsToPatternsFactory: seed=1234
(Round 1) num seqlets: 1954
(Round 1) Computing coarse affmat
2024-03-12 00:14:27.573382 MEMORY 11.925880832
Beginning embedding computation
MEMORY 11.925880832
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
At the beginning of embedding call
2024-03-12 00:14:27.574094 MEMORY 11.925880832
before computing embeddings fwd
2024-03-12 00:14:27.584688 MEMORY 11.925917696
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:   10.9s
[Parallel(n_jobs=24)]: Done 152 tasks      | elapsed:   13.0s
[Parallel(n_jobs=24)]: Done 402 tasks      | elapsed:   16.4s
[Parallel(n_jobs=24)]: Done 752 tasks      | elapsed:   21.2s
[Parallel(n_jobs=24)]: Done 1202 tasks      | elapsed:   27.3s
[Parallel(n_jobs=24)]: Done 1752 tasks      | elapsed:   34.4s
[Parallel(n_jobs=24)]: Done 1954 out of 1954 | elapsed:   37.0s finished
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 152 tasks      | elapsed:    2.3s
[Parallel(n_jobs=24)]: Done 402 tasks      | elapsed:    5.8s
[Parallel(n_jobs=24)]: Done 752 tasks      | elapsed:   10.5s
[Parallel(n_jobs=24)]: Done 1202 tasks      | elapsed:   16.5s
[Parallel(n_jobs=24)]: Done 1752 tasks      | elapsed:   23.7s
[Parallel(n_jobs=24)]: Done 1954 out of 1954 | elapsed:   26.4s finished
after computing embeddings fwd
2024-03-12 00:15:04.797101 MEMORY 11.990458368
after computing embeddings rev
2024-03-12 00:15:31.206966 MEMORY 12.070330368
before computing sparse embeddings fwd
2024-03-12 00:15:31.207128 MEMORY 12.070330368
Constructing csr matrix...
csr matrix made in 0.2725086212158203 s
after computing sparse embeddings fwd
2024-03-12 00:15:31.618035 MEMORY 12.070494208
before computing sparse embeddings rev
2024-03-12 00:15:31.618209 MEMORY 12.070494208
Constructing csr matrix...
csr matrix made in 0.26058077812194824 s
after computing sparse embeddings rev
2024-03-12 00:15:31.984317 MEMORY 12.070498304
Finished embedding computation in 66.06 s
MEMORY 11.989991424
Starting affinity matrix computations
MEMORY 11.98972928
Batching in slices of size 1954
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:01<00:00,  1.86s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:01<00:00,  1.86s/it]
Finished affinity matrix computations in 1.89 s
MEMORY 11.989897216
(Round 1) Computed coarse affmat
2024-03-12 00:15:36.541385 MEMORY 11.989897216
(Round 1) Computing affinity matrix on nearest neighbors
2024-03-12 00:15:36.541617 MEMORY 11.989897216
Launching nearest neighbors affmat calculation job
MEMORY 11.989897216
Parallel runs completed
MEMORY 12.092182528
Job completed in: 8.06 s
MEMORY 12.092182528
Launching nearest neighbors affmat calculation job
MEMORY 12.092182528
Parallel runs completed
MEMORY 12.114690048
Job completed in: 7.67 s
MEMORY 12.114788352
(Round 1) Computed affinity matrix on nearest neighbors in 16.86 s
2024-03-12 00:15:53.399796 MEMORY 12.093575168
Filtered down to 1943 of 1954
(Round 1) Retained 1943 rows out of 1954 after filtering
2024-03-12 00:15:54.845493 MEMORY 12.097990656
(Round 1) Computing density adapted affmat
2024-03-12 00:15:56.140446 MEMORY 12.112879616
Symmetrizing nearest neighbors
Computing betas for density adaptation
Computing normalizing denominators
(Round 1) Computing clustering
2024-03-12 00:16:11.764259 MEMORY 12.06933504
Beginning preprocessing + Leiden
2024-03-12 00:16:11.766627 MEMORY 12.06933504
Affmat transformed
2024-03-12 00:16:11.766763 MEMORY 12.06933504
sources, targets, weights extracted
2024-03-12 00:16:11.906600 MEMORY 12.069367808
About to launch parallel Leiden runs
2024-03-12 00:16:11.940874 MEMORY 12.069376
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    9.8s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   28.8s finished
Parallel Leiden runs finished
2024-03-12 00:16:40.790467 MEMORY 12.069277696
Quality: 0.21900390912957501
Got 3 clusters after round 1
Counts:
{0: 742, 1: 740, 2: 461}
2024-03-12 00:16:40.800808 MEMORY 12.069277696
(Round 1) Aggregating seqlets in each cluster
2024-03-12 00:16:40.800923 MEMORY 12.069277696
Aggregating for cluster 0 with 742 seqlets
2024-03-12 00:16:40.803849 MEMORY 12.069277696
Skipped 1 due to duplicates
Trimming eliminated 0 seqlets out of 741
Aggregating for cluster 1 with 740 seqlets
2024-03-12 00:16:43.012915 MEMORY 12.06929408
Skipped 1 due to duplicates
Trimming eliminated 0 seqlets out of 739
Aggregating for cluster 2 with 461 seqlets
2024-03-12 00:16:45.063642 MEMORY 12.06929408
Skipped 1 due to duplicates
Trimming eliminated 0 seqlets out of 460
(Round 2) num seqlets: 1940
(Round 2) Computing coarse affmat
2024-03-12 00:16:47.992094 MEMORY 12.069306368
Beginning embedding computation
MEMORY 12.069306368
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 368 tasks      | elapsed:    0.8s
[Parallel(n_jobs=24)]: Done 1368 tasks      | elapsed:    2.2s
[Parallel(n_jobs=24)]: Done 1940 out of 1940 | elapsed:    3.0s finished
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 272 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done 1272 tasks      | elapsed:    2.2s
[Parallel(n_jobs=24)]: Done 1940 out of 1940 | elapsed:    3.2s finished
At the beginning of embedding call
2024-03-12 00:16:47.992409 MEMORY 12.069306368
before computing embeddings fwd
2024-03-12 00:16:48.002827 MEMORY 12.069306368
after computing embeddings fwd
2024-03-12 00:16:51.033875 MEMORY 12.141543424
after computing embeddings rev
2024-03-12 00:16:54.253413 MEMORY 12.220542976
before computing sparse embeddings fwd
2024-03-12 00:16:54.253545 MEMORY 12.220542976
Constructing csr matrix...
csr matrix made in 0.25426506996154785 s
after computing sparse embeddings fwd
2024-03-12 00:16:54.599634 MEMORY 12.220604416
before computing sparse embeddings rev
2024-03-12 00:16:54.599743 MEMORY 12.220604416
Constructing csr matrix...
csr matrix made in 0.25304412841796875 s
after computing sparse embeddings rev
2024-03-12 00:16:54.917400 MEMORY 12.220604416
Finished embedding computation in 7.89 s
MEMORY 12.147990528
Starting affinity matrix computations
MEMORY 12.147990528
Batching in slices of size 1940
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:01<00:00,  1.90s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:01<00:00,  1.90s/it]
Finished affinity matrix computations in 1.91 s
MEMORY 12.147990528
(Round 2) Computed coarse affmat
2024-03-12 00:16:58.581037 MEMORY 12.147871744
(Round 2) Computing affinity matrix on nearest neighbors
2024-03-12 00:16:58.581250 MEMORY 12.147871744
Launching nearest neighbors affmat calculation job
MEMORY 12.147871744
Parallel runs completed
MEMORY 12.170727424
Job completed in: 4.27 s
MEMORY 12.168388608
Launching nearest neighbors affmat calculation job
MEMORY 12.168265728
Parallel runs completed
MEMORY 12.190498816
Job completed in: 4.29 s
MEMORY 12.179283968
(Round 2) Computed affinity matrix on nearest neighbors in 9.67 s
2024-03-12 00:17:08.248790 MEMORY 12.179161088
Not applying filtering for rounds above first round
2024-03-12 00:17:08.249220 MEMORY 12.179161088
(Round 2) Computing density adapted affmat
2024-03-12 00:17:09.423587 MEMORY 12.186943488
Symmetrizing nearest neighbors
Computing betas for density adaptation
Computing normalizing denominators
(Round 2) Computing clustering
2024-03-12 00:17:24.160064 MEMORY 12.146454528
Beginning preprocessing + Leiden
2024-03-12 00:17:24.162410 MEMORY 12.146454528
Affmat transformed
2024-03-12 00:17:24.162533 MEMORY 12.146454528
sources, targets, weights extracted
2024-03-12 00:17:24.223263 MEMORY 12.146454528
About to launch parallel Leiden runs
2024-03-12 00:17:24.256182 MEMORY 12.146454528
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    6.0s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   18.3s finished
Parallel Leiden runs finished
2024-03-12 00:17:42.531230 MEMORY 12.14656512
Quality: 0.28731404610906375
Quality: 0.2896322571380259
Got 3 clusters after round 2
Counts:
{1: 647, 0: 775, 2: 518}
2024-03-12 00:17:42.542629 MEMORY 12.14656512
(Round 2) Aggregating seqlets in each cluster
2024-03-12 00:17:42.542742 MEMORY 12.14656512
Aggregating for cluster 0 with 775 seqlets
2024-03-12 00:17:42.544434 MEMORY 12.14656512
Trimming eliminated 0 seqlets out of 775
Aggregating for cluster 1 with 647 seqlets
2024-03-12 00:17:44.064508 MEMORY 12.146577408
Trimming eliminated 0 seqlets out of 647
Aggregating for cluster 2 with 518 seqlets
2024-03-12 00:17:45.207662 MEMORY 12.146577408
Trimming eliminated 0 seqlets out of 518
Got 3 clusters
Splitting into subclusters...
2024-03-12 00:17:47.054571 MEMORY 12.146577408
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 775 out of 775 | elapsed:    0.2s finished
Inspecting pattern 0 for spurious merging
[t-SNE] Computed conditional probabilities for sample 775 / 775
[t-SNE] Mean sigma: 0.284130
Beginning preprocessing + Leiden
2024-03-12 00:17:48.123172 MEMORY 12.146778112
Affmat transformed
2024-03-12 00:17:48.133887 MEMORY 12.146819072
sources, targets, weights extracted
2024-03-12 00:17:48.141113 MEMORY 12.146819072
About to launch parallel Leiden runs
2024-03-12 00:17:48.200886 MEMORY 12.146823168
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    2.6s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    8.1s finished
Parallel Leiden runs finished
2024-03-12 00:17:56.346664 MEMORY 12.146823168
Quality: 0.43943931599766134
Quality: 0.441720896703195
Quality: 0.44175983264111707
Quality: 0.4418060146433377
Got subclusters: Counter({0: 190, 1: 155, 2: 133, 3: 107, 4: 102, 5: 83, 6: 5})
On merging iteration 1
Numbers for each pattern pre-subsample: [190, 155, 133, 107, 102, 83, 5]
Numbers after subsampling: [190, 155, 133, 107, 102, 83, 5]
Computing sims for pattern 0
Computed sims for pattern 0 in 1.1624197959899902 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.8865687847137451 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.8308053016662598 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.6488358974456787 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.6164638996124268 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.5898253917694092 s
Computing sims for pattern 6
Computed sims for pattern 6 in 0.12030673027038574 s
Cluster sizes
[190 155 133 107 102  83   5]
Cross-contamination matrix:
[[1.   0.73 0.21 0.72 0.13 0.63 0.28]
 [0.82 1.   0.19 0.75 0.16 0.68 0.21]
 [0.89 0.71 1.   0.96 0.52 0.61 0.74]
 [0.88 0.82 0.29 1.   0.21 0.63 0.28]
 [0.86 0.83 0.74 1.   1.   0.74 0.68]
 [0.84 0.8  0.22 0.7  0.17 1.   0.44]
 [0.01 0.   0.   0.01 0.   0.02 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.95 0.8  0.94 0.7  0.94 0.73]
 [0.95 1.   0.74 0.94 0.7  0.94 0.66]
 [0.8  0.74 1.   0.86 0.74 0.73 0.75]
 [0.94 0.94 0.86 1.   0.83 0.9  0.71]
 [0.7  0.7  0.74 0.83 1.   0.7  0.68]
 [0.94 0.94 0.73 0.9  0.7  1.   0.76]
 [0.73 0.66 0.75 0.71 0.68 0.76 1.  ]]
Collapsing 0 & 1 with crosscontam 0.7256916714088859 and sim 0.9527541691159772
Collapsing 0 & 5 with crosscontam 0.6288397514829693 and sim 0.9436221678565964
Collapsing 0 & 3 with crosscontam 0.724789227060973 and sim 0.9423313264627126
Collapsing 1 & 3 with crosscontam 0.7549859911903394 and sim 0.9414818305428124
Collapsing 1 & 5 with crosscontam 0.6798987160754055 and sim 0.938134691928122
Collapsing 3 & 5 with crosscontam 0.630606278497094 and sim 0.902298174190288
Trimming eliminated 0 seqlets out of 345
Trimming eliminated 0 seqlets out of 428
Trimming eliminated 0 seqlets out of 535
Unmerged patterns remapping: OrderedDict([(2, 1), (4, 2), (6, 3)])
Time spent on merging iteration: 1.396885633468628
On merging iteration 2
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 647 out of 647 | elapsed:    0.2s finished
Numbers for each pattern pre-subsample: [535, 133, 102, 5]
Numbers after subsampling: [300, 133, 102, 5]
Computing sims for pattern 0
Computed sims for pattern 0 in 0.8232903480529785 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.17902398109436035 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.13830828666687012 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.03766989707946777 s
Cluster sizes
[535 133 102   5]
Cross-contamination matrix:
[[1.   0.34 0.27 0.43]
 [0.8  1.   0.52 0.74]
 [0.88 0.74 1.   0.68]
 [0.01 0.   0.   1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.8  0.74 0.73]
 [0.8  1.   0.74 0.75]
 [0.74 0.74 1.   0.68]
 [0.73 0.75 0.68 1.  ]]
Inspecting pattern 1 for spurious merging
[t-SNE] Computed conditional probabilities for sample 647 / 647
[t-SNE] Mean sigma: 0.294022
Beginning preprocessing + Leiden
2024-03-12 00:18:04.858704 MEMORY 12.147163136
Affmat transformed
2024-03-12 00:18:04.868617 MEMORY 12.147163136
sources, targets, weights extracted
2024-03-12 00:18:04.874307 MEMORY 12.147163136
About to launch parallel Leiden runs
2024-03-12 00:18:04.919004 MEMORY 12.147163136
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.9s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    6.1s finished
Parallel Leiden runs finished
2024-03-12 00:18:11.021528 MEMORY 12.147163136
Quality: 0.4283221417234297
Quality: 0.4285807945268441
Quality: 0.42883515505852143
Quality: 0.4311148157150223
Quality: 0.4315182869054302
Quality: 0.432196620185749
Got subclusters: Counter({0: 112, 1: 107, 2: 100, 3: 89, 4: 82, 5: 57, 6: 53, 7: 47})
On merging iteration 1
Numbers for each pattern pre-subsample: [112, 107, 100, 89, 82, 57, 53, 47]
Numbers after subsampling: [112, 107, 100, 89, 82, 57, 53, 47]
Computing sims for pattern 0
Computed sims for pattern 0 in 0.8044664859771729 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.773897647857666 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.6918811798095703 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.7684566974639893 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.6657750606536865 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.48437070846557617 s
Computing sims for pattern 6
Computed sims for pattern 6 in 0.4437594413757324 s
Computing sims for pattern 7
Computed sims for pattern 7 in 0.3922457695007324 s
Cluster sizes
[112 107 100  89  82  57  53  47]
Cross-contamination matrix:
[[1.   0.39 0.6  0.68 0.79 0.51 0.51 0.69]
 [0.74 1.   1.   0.95 1.   0.65 0.59 0.74]
 [0.56 0.58 1.   0.88 0.81 0.55 0.43 0.69]
 [0.47 0.38 0.72 1.   0.57 0.45 0.29 0.51]
 [0.68 0.55 0.77 0.7  1.   0.46 0.41 0.62]
 [0.68 0.43 0.78 0.89 0.74 1.   0.48 0.84]
 [0.74 0.43 0.65 0.64 0.74 0.54 1.   0.57]
 [0.46 0.22 0.49 0.48 0.48 0.41 0.22 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.84 0.86 0.89 0.92 0.88 0.87 0.89]
 [0.84 1.   0.94 0.91 0.96 0.84 0.84 0.81]
 [0.86 0.94 1.   0.97 0.94 0.92 0.84 0.9 ]
 [0.89 0.91 0.97 1.   0.92 0.96 0.88 0.93]
 [0.92 0.96 0.94 0.92 1.   0.88 0.87 0.87]
 [0.88 0.84 0.92 0.96 0.88 1.   0.86 0.93]
 [0.87 0.84 0.84 0.88 0.87 0.86 1.   0.78]
 [0.89 0.81 0.9  0.93 0.87 0.93 0.78 1.  ]]
Collapsing 2 & 3 with crosscontam 0.7241226777347658 and sim 0.9697420279972137
Collapsing 3 & 5 with crosscontam 0.45311247106473473 and sim 0.9569577896738841
Collapsing 1 & 4 with crosscontam 0.5504323180800124 and sim 0.9553399102241327
Collapsing 1 & 2 with crosscontam 0.581283813084112 and sim 0.9406130069586683
Collapsing 2 & 4 with crosscontam 0.7658938494798393 and sim 0.9401199084157484
Collapsing 5 & 7 with crosscontam 0.4069037199106238 and sim 0.9306952994173269
Collapsing 3 & 7 with crosscontam 0.4765924547255067 and sim 0.9272840314414476
Collapsing 3 & 4 with crosscontam 0.5723023489460477 and sim 0.9181450674055769
Collapsing 2 & 5 with crosscontam 0.5466261754385964 and sim 0.9161855972183395
Collapsing 0 & 4 with crosscontam 0.6825248421070085 and sim 0.9150246803932771
Collapsing 1 & 3 with crosscontam 0.3810442357490551 and sim 0.9098165044533187
Collapsing 2 & 7 with crosscontam 0.489867563064061 and sim 0.9025603558193013
Collapsing 0 & 5 with crosscontam 0.5117262424236613 and sim 0.8781922615879878
Collapsing 0 & 6 with crosscontam 0.5052342439249959 and sim 0.8693424664227678
Collapsing 0 & 2 with crosscontam 0.5594915357142858 and sim 0.85823109537871
Trimming eliminated 0 seqlets out of 189
Trimming eliminated 0 seqlets out of 246
Trimming eliminated 0 seqlets out of 189
Trimming eliminated 0 seqlets out of 435
Trimming eliminated 0 seqlets out of 482
Trimming eliminated 0 seqlets out of 594
Trimming eliminated 0 seqlets out of 647
Unmerged patterns remapping: OrderedDict()
Time spent on merging iteration: 3.7031073570251465
On merging iteration 2
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 344 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 518 out of 518 | elapsed:    0.2s finished
Numbers for each pattern pre-subsample: [647]
Numbers after subsampling: [300]
Computing sims for pattern 0
Computed sims for pattern 0 in 4.76837158203125e-06 s
Cluster sizes
[647]
Cross-contamination matrix:
[[1.]]
Pattern-to-pattern sim matrix:
[[1.]]
Inspecting pattern 2 for spurious merging
[t-SNE] Computed conditional probabilities for sample 518 / 518
[t-SNE] Mean sigma: 0.373998
Beginning preprocessing + Leiden
2024-03-12 00:18:20.381598 MEMORY 12.147167232
Affmat transformed
2024-03-12 00:18:20.388376 MEMORY 12.147167232
sources, targets, weights extracted
2024-03-12 00:18:20.391930 MEMORY 12.147167232
About to launch parallel Leiden runs
2024-03-12 00:18:20.436850 MEMORY 12.147167232
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.5s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    4.4s finished
Parallel Leiden runs finished
2024-03-12 00:18:24.879259 MEMORY 12.147167232
Quality: 0.5103012529730241
Quality: 0.5123044357115797
Quality: 0.5134144607899448
Got subclusters: Counter({0: 149, 1: 100, 2: 84, 3: 68, 4: 61, 5: 56})
On merging iteration 1
Numbers for each pattern pre-subsample: [149, 100, 84, 68, 61, 56]
Numbers after subsampling: [149, 100, 84, 68, 61, 56]
Computing sims for pattern 0
Computed sims for pattern 0 in 0.8143875598907471 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.6142823696136475 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.5742745399475098 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.4323554039001465 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.37026357650756836 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.335308313369751 s
Cluster sizes
[149 100  84  68  61  56]
Cross-contamination matrix:
[[1.   0.04 0.57 0.37 0.41 0.41]
 [0.12 1.   0.12 0.32 0.61 0.21]
 [0.64 0.03 1.   0.32 0.3  0.39]
 [0.67 0.33 0.6  1.   0.72 0.59]
 [0.55 0.38 0.39 0.51 1.   0.44]
 [0.76 0.24 0.71 0.6  0.65 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.33 0.81 0.74 0.81 0.81]
 [0.33 1.   0.22 0.49 0.62 0.38]
 [0.81 0.22 1.   0.65 0.69 0.75]
 [0.74 0.49 0.65 1.   0.77 0.69]
 [0.81 0.62 0.69 0.77 1.   0.75]
 [0.81 0.38 0.75 0.69 0.75 1.  ]]
Merging on 11 clusters
2024-03-12 00:18:28.191691 MEMORY 12.147167232
On merging iteration 1
Numbers for each pattern pre-subsample: [535, 133, 102, 5, 647, 149, 100, 84, 68, 61, 56]
Numbers after subsampling: [300, 133, 102, 5, 300, 149, 100, 84, 68, 61, 56]
Computing sims for pattern 0
Computed sims for pattern 0 in 3.0640671253204346 s
Computing sims for pattern 1
Computed sims for pattern 1 in 1.5637001991271973 s
Computing sims for pattern 2
Computed sims for pattern 2 in 1.1511077880859375 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.19878172874450684 s
Computing sims for pattern 4
Computed sims for pattern 4 in 3.021531343460083 s
Computing sims for pattern 5
Computed sims for pattern 5 in 1.671283483505249 s
Computing sims for pattern 6
Computed sims for pattern 6 in 1.3019676208496094 s
Computing sims for pattern 7
Computed sims for pattern 7 in 2.1037967205047607 s
Computing sims for pattern 8
Computed sims for pattern 8 in 0.883352518081665 s
Computing sims for pattern 9
Computed sims for pattern 9 in 0.8243424892425537 s
Computing sims for pattern 10
Computed sims for pattern 10 in 0.7316269874572754 s
Cluster sizes
[535 133 102   5 647 149 100  84  68  61  56]
Cross-contamination matrix:
[[1.   0.34 0.27 0.43 0.56 0.65 0.01 0.44 0.24 0.27 0.26]
 [0.8  1.   0.52 0.74 0.29 0.47 0.01 0.39 0.27 0.36 0.3 ]
 [0.88 0.74 1.   0.68 0.34 0.43 0.03 0.33 0.27 0.37 0.38]
 [0.01 0.   0.   1.   0.   0.   0.   0.   0.   0.   0.01]
 [0.84 0.21 0.16 0.37 1.   0.83 0.02 0.57 0.32 0.3  0.33]
 [0.88 0.29 0.16 0.57 0.75 1.   0.04 0.57 0.37 0.41 0.41]
 [0.05 0.02 0.04 0.1  0.03 0.12 1.   0.12 0.32 0.61 0.21]
 [0.54 0.27 0.1  0.43 0.49 0.64 0.03 1.   0.32 0.3  0.39]
 [0.55 0.34 0.23 0.78 0.51 0.67 0.33 0.6  1.   0.72 0.59]
 [0.43 0.23 0.16 0.39 0.35 0.55 0.38 0.39 0.51 1.   0.44]
 [0.62 0.37 0.29 0.7  0.56 0.76 0.24 0.71 0.6  0.65 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.8  0.74 0.73 0.9  0.95 0.18 0.86 0.7  0.77 0.8 ]
 [0.8  1.   0.74 0.75 0.56 0.76 0.01 0.75 0.59 0.64 0.59]
 [0.74 0.74 1.   0.68 0.47 0.63 0.07 0.61 0.51 0.62 0.66]
 [0.73 0.75 0.68 1.   0.53 0.76 0.3  0.73 0.73 0.69 0.72]
 [0.9  0.56 0.47 0.53 1.   0.92 0.24 0.8  0.64 0.68 0.74]
 [0.95 0.76 0.63 0.76 0.92 1.   0.33 0.81 0.74 0.81 0.81]
 [0.18 0.01 0.07 0.3  0.24 0.33 1.   0.22 0.49 0.62 0.38]
 [0.86 0.75 0.61 0.73 0.8  0.81 0.22 1.   0.65 0.69 0.75]
 [0.7  0.59 0.51 0.73 0.64 0.74 0.49 0.65 1.   0.77 0.69]
 [0.77 0.64 0.62 0.69 0.68 0.81 0.62 0.69 0.77 1.   0.75]
 [0.8  0.59 0.66 0.72 0.74 0.81 0.38 0.75 0.69 0.75 1.  ]]
Collapsing 0 & 5 with crosscontam 0.6532659746457867 and sim 0.9485565003436505
Collapsing 4 & 5 with crosscontam 0.745928860047923 and sim 0.9223793545935584
Collapsing 0 & 4 with crosscontam 0.5640297328395063 and sim 0.902815702474479
Trimming eliminated 0 seqlets out of 684
Trimming eliminated 0 seqlets out of 1331
Unmerged patterns remapping: OrderedDict([(1, 1), (2, 2), (3, 8), (6, 3), (7, 4), (8, 5), (9, 6), (10, 7)])
Time spent on merging iteration: 3.8400847911834717
On merging iteration 2
Numbers for each pattern pre-subsample: [1331, 133, 102, 100, 84, 68, 61, 56, 5]
Numbers after subsampling: [300, 133, 102, 100, 84, 68, 61, 56, 5]
Computing sims for pattern 0
Computed sims for pattern 0 in 2.3451783657073975 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.18946123123168945 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.14973711967468262 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.1405489444732666 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.13509917259216309 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.12112641334533691 s
Computing sims for pattern 6
Computed sims for pattern 6 in 0.10890674591064453 s
Computing sims for pattern 7
Computed sims for pattern 7 in 0.10080099105834961 s
Computing sims for pattern 8
Computed sims for pattern 8 in 0.03580188751220703 s
Cluster sizes
[1331  133  102  100   84   68   61   56    5]
Cross-contamination matrix:
[[1.   0.34 0.27 0.03 0.63 0.35 0.36 0.37 0.49]
 [0.51 1.   0.52 0.01 0.39 0.27 0.36 0.3  0.74]
 [0.56 0.74 1.   0.03 0.33 0.27 0.37 0.38 0.68]
 [0.06 0.02 0.04 1.   0.12 0.32 0.61 0.21 0.1 ]
 [0.53 0.27 0.1  0.03 1.   0.32 0.3  0.39 0.43]
 [0.55 0.34 0.23 0.33 0.6  1.   0.72 0.59 0.78]
 [0.41 0.23 0.16 0.38 0.39 0.51 1.   0.44 0.39]
 [0.61 0.37 0.29 0.24 0.71 0.6  0.65 1.   0.7 ]
 [0.01 0.   0.   0.   0.   0.   0.   0.01 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.69 0.61 0.22 0.85 0.69 0.75 0.79 0.64]
 [0.69 1.   0.74 0.01 0.75 0.59 0.64 0.59 0.75]
 [0.61 0.74 1.   0.07 0.61 0.51 0.62 0.66 0.68]
 [0.22 0.01 0.07 1.   0.22 0.49 0.62 0.38 0.3 ]
 [0.85 0.75 0.61 0.22 1.   0.65 0.69 0.75 0.73]
 [0.69 0.59 0.51 0.49 0.65 1.   0.77 0.69 0.73]
 [0.75 0.64 0.62 0.62 0.69 0.77 1.   0.75 0.69]
 [0.79 0.59 0.66 0.38 0.75 0.69 0.75 1.   0.72]
 [0.64 0.75 0.68 0.3  0.73 0.73 0.69 0.72 1.  ]]
Got 9 patterns after merging
2024-03-12 00:18:51.617373 MEMORY 12.147294208
Performing filtering
2024-03-12 00:18:51.617631 MEMORY 12.147294208
Got 8 patterns after filtering
2024-03-12 00:18:51.935558 MEMORY 12.147294208
Total time taken is 265.12s
2024-03-12 00:18:51.935694 MEMORY 12.147294208
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 1331 out of 1331 | elapsed:    0.6s finished
/ru-auth/local/home/lzhao/anaconda3/envs/jupyter-ml-clone/lib/python3.9/site-packages/sklearn/manifold/_t_sne.py:691: FutureWarning: 'square_distances' has been introduced in 0.24 to help phase out legacy squaring behavior. The 'legacy' setting will be removed in 1.1 (renaming of 0.26), and the default setting will be changed to True. In 1.3, 'square_distances' will be removed altogether, and distances will be squared by default. Set 'square_distances'=True to silence this warning.
  warnings.warn(
/ru-auth/local/home/lzhao/anaconda3/envs/jupyter-ml-clone/lib/python3.9/site-packages/sklearn/neighbors/_base.py:175: EfficiencyWarning: Precomputed sparse input was not sorted by data.
  warnings.warn('Precomputed sparse input was not sorted by data.',
Applying subclustering to the final motifs
On pattern 0
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 1331 samples in 0.031s...
[t-SNE] Computed neighbors for 1331 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 1000 / 1331
[t-SNE] Computed conditional probabilities for sample 1331 / 1331
[t-SNE] Mean sigma: 0.277357
[t-SNE] Computed conditional probabilities in 0.101s
[t-SNE] Iteration 50: error = 66.8656082, gradient norm = 0.1952713 (50 iterations in 14.168s)
[t-SNE] Iteration 100: error = 66.7952423, gradient norm = 0.2020173 (50 iterations in 0.132s)
[t-SNE] Iteration 150: error = 66.8845291, gradient norm = 0.2058785 (50 iterations in 0.128s)
[t-SNE] Iteration 200: error = 67.4308624, gradient norm = 0.1955745 (50 iterations in 0.126s)
[t-SNE] Iteration 250: error = 67.1519775, gradient norm = 0.1748062 (50 iterations in 0.128s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 67.151978
[t-SNE] Iteration 300: error = 1.7486386, gradient norm = 0.0012298 (50 iterations in 0.116s)
[t-SNE] Iteration 350: error = 1.6655440, gradient norm = 0.0004110 (50 iterations in 0.113s)
[t-SNE] Iteration 400: error = 1.6352129, gradient norm = 0.0002393 (50 iterations in 0.114s)
[t-SNE] Iteration 450: error = 1.6154400, gradient norm = 0.0002775 (50 iterations in 0.115s)
[t-SNE] Iteration 500: error = 1.6070591, gradient norm = 0.0001484 (50 iterations in 0.113s)
[t-SNE] Iteration 550: error = 1.6032170, gradient norm = 0.0001507 (50 iterations in 0.114s)
[t-SNE] Iteration 600: error = 1.6000490, gradient norm = 0.0000962 (50 iterations in 0.115s)
[t-SNE] Iteration 650: error = 1.5980124, gradient norm = 0.0000927 (50 iterations in 0.116s)
[t-SNE] Iteration 700: error = 1.5965291, gradient norm = 0.0000675 (50 iterations in 0.114s)
[t-SNE] Iteration 750: error = 1.5956372, gradient norm = 0.0000574 (50 iterations in 0.112s)
[t-SNE] Iteration 800: error = 1.5948273, gradient norm = 0.0000634 (50 iterations in 0.115s)
[t-SNE] Iteration 850: error = 1.5931916, gradient norm = 0.0001053 (50 iterations in 0.113s)
[t-SNE] Iteration 900: error = 1.5928732, gradient norm = 0.0000470 (50 iterations in 0.113s)
[t-SNE] Iteration 950: error = 1.5927066, gradient norm = 0.0000557 (50 iterations in 0.114s)
[t-SNE] Iteration 1000: error = 1.5923434, gradient norm = 0.0000519 (50 iterations in 0.111s)
[t-SNE] KL divergence after 1000 iterations: 1.592343
[t-SNE] Computed conditional probabilities for sample 1000 / 1331
[t-SNE] Computed conditional probabilities for sample 1331 / 1331
[t-SNE] Mean sigma: 0.277357
Beginning preprocessing + Leiden
2024-03-12 00:19:10.599547 MEMORY 12.164980736
Affmat transformed
2024-03-12 00:19:10.617841 MEMORY 12.164980736
sources, targets, weights extracted
2024-03-12 00:19:10.628536 MEMORY 12.164980736
About to launch parallel Leiden runs
2024-03-12 00:19:10.663460 MEMORY 12.164980736
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    4.2s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   13.1s finished
Parallel Leiden runs finished
2024-03-12 00:19:23.752498 MEMORY 12.164980736
Quality: 0.5224685302869841
Quality: 0.522493813093905
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  86 out of 133 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=24)]: Done 133 out of 133 | elapsed:    0.1s finished
Got subclusters: Counter({0: 344, 1: 277, 2: 198, 3: 169, 4: 104, 5: 98, 6: 91, 7: 50})
On pattern 1
[t-SNE] Computing 132 nearest neighbors...
[t-SNE] Indexed 133 samples in 0.002s...
[t-SNE] Computed neighbors for 133 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 133 / 133
[t-SNE] Mean sigma: 0.418181
[t-SNE] Computed conditional probabilities in 0.008s
[t-SNE] Iteration 50: error = 53.9144821, gradient norm = 0.5761967 (50 iterations in 0.020s)
[t-SNE] Iteration 100: error = 54.0390778, gradient norm = 0.5321222 (50 iterations in 0.020s)
[t-SNE] Iteration 150: error = 52.3204765, gradient norm = 0.6377439 (50 iterations in 0.020s)
[t-SNE] Iteration 200: error = 53.5911674, gradient norm = 0.5314184 (50 iterations in 0.020s)
[t-SNE] Iteration 250: error = 56.7730064, gradient norm = 0.4989053 (50 iterations in 0.020s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 56.773006
[t-SNE] Iteration 300: error = 0.8235952, gradient norm = 0.0079184 (50 iterations in 0.020s)
[t-SNE] Iteration 350: error = 0.5219597, gradient norm = 0.0082919 (50 iterations in 0.020s)
[t-SNE] Iteration 400: error = 0.4552498, gradient norm = 0.0010452 (50 iterations in 0.020s)
[t-SNE] Iteration 450: error = 0.4552512, gradient norm = 0.0002771 (50 iterations in 0.020s)
[t-SNE] Iteration 500: error = 0.4553986, gradient norm = 0.0001297 (50 iterations in 0.020s)
[t-SNE] Iteration 550: error = 0.4553734, gradient norm = 0.0001258 (50 iterations in 0.019s)
[t-SNE] Iteration 600: error = 0.4553897, gradient norm = 0.0001187 (50 iterations in 0.022s)
[t-SNE] Iteration 650: error = 0.4553931, gradient norm = 0.0001541 (50 iterations in 0.020s)
[t-SNE] Iteration 700: error = 0.4554113, gradient norm = 0.0001705 (50 iterations in 0.019s)
[t-SNE] Iteration 750: error = 0.4553500, gradient norm = 0.0001731 (50 iterations in 0.019s)
[t-SNE] Iteration 750: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 750 iterations: 0.455350
[t-SNE] Computed conditional probabilities for sample 133 / 133
[t-SNE] Mean sigma: 0.418181
Beginning preprocessing + Leiden
2024-03-12 00:19:24.518063 MEMORY 12.164984832
Affmat transformed
2024-03-12 00:19:24.519987 MEMORY 12.164984832
sources, targets, weights extracted
2024-03-12 00:19:24.520708 MEMORY 12.164984832
About to launch parallel Leiden runs
2024-03-12 00:19:24.539394 MEMORY 12.164984832
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.8s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.2s finished
Parallel Leiden runs finished
2024-03-12 00:19:26.745080 MEMORY 12.164984832
Quality: 0.29528495353087514
Quality: 0.2974200304585466
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 102 out of 102 | elapsed:    0.0s finished
Got subclusters: Counter({0: 32, 1: 29, 2: 28, 3: 27, 4: 17})
On pattern 2
[t-SNE] Computing 101 nearest neighbors...
[t-SNE] Indexed 102 samples in 0.001s...
[t-SNE] Computed neighbors for 102 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 102 / 102
[t-SNE] Mean sigma: 0.485734
[t-SNE] Computed conditional probabilities in 0.005s
[t-SNE] Iteration 50: error = 53.4268188, gradient norm = 0.5141320 (50 iterations in 0.017s)
[t-SNE] Iteration 100: error = 50.0352402, gradient norm = 0.5519506 (50 iterations in 0.017s)
[t-SNE] Iteration 150: error = 50.8473053, gradient norm = 0.5509958 (50 iterations in 0.017s)
[t-SNE] Iteration 200: error = 48.3055878, gradient norm = 0.5700457 (50 iterations in 0.017s)
[t-SNE] Iteration 250: error = 49.6811066, gradient norm = 0.5636363 (50 iterations in 0.017s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 49.681107
[t-SNE] Iteration 300: error = 0.4221739, gradient norm = 0.0136375 (50 iterations in 0.016s)
[t-SNE] Iteration 350: error = 0.3176020, gradient norm = 0.0037649 (50 iterations in 0.016s)
[t-SNE] Iteration 400: error = 0.3165241, gradient norm = 0.0006475 (50 iterations in 0.016s)
[t-SNE] Iteration 450: error = 0.3163046, gradient norm = 0.0008020 (50 iterations in 0.017s)
[t-SNE] Iteration 500: error = 0.3163990, gradient norm = 0.0006557 (50 iterations in 0.016s)
[t-SNE] Iteration 550: error = 0.3164937, gradient norm = 0.0006961 (50 iterations in 0.016s)
[t-SNE] Iteration 600: error = 0.3166064, gradient norm = 0.0004370 (50 iterations in 0.016s)
[t-SNE] Iteration 650: error = 0.3164782, gradient norm = 0.0003733 (50 iterations in 0.016s)
[t-SNE] Iteration 700: error = 0.3165011, gradient norm = 0.0005317 (50 iterations in 0.016s)
[t-SNE] Iteration 750: error = 0.3165042, gradient norm = 0.0005227 (50 iterations in 0.016s)
[t-SNE] Iteration 800: error = 0.3163299, gradient norm = 0.0005032 (50 iterations in 0.016s)
[t-SNE] Iteration 800: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 800 iterations: 0.316330
[t-SNE] Computed conditional probabilities for sample 102 / 102
[t-SNE] Mean sigma: 0.485734
Beginning preprocessing + Leiden
2024-03-12 00:19:27.156438 MEMORY 12.164984832
Affmat transformed
2024-03-12 00:19:27.157709 MEMORY 12.164984832
sources, targets, weights extracted
2024-03-12 00:19:27.158228 MEMORY 12.164984832
About to launch parallel Leiden runs
2024-03-12 00:19:27.194748 MEMORY 12.164984832
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.0s finished
Parallel Leiden runs finished
2024-03-12 00:19:29.229015 MEMORY 12.164984832
Quality: 0.2567886182489387
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 100 out of 100 | elapsed:    0.0s finished
Got subclusters: Counter({0: 33, 1: 32, 2: 19, 3: 13, 4: 5})
On pattern 3
[t-SNE] Computing 99 nearest neighbors...
[t-SNE] Indexed 100 samples in 0.001s...
[t-SNE] Computed neighbors for 100 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 100 / 100
[t-SNE] Mean sigma: 0.546062
[t-SNE] Computed conditional probabilities in 0.005s
[t-SNE] Iteration 50: error = 54.6280174, gradient norm = 0.5306134 (50 iterations in 0.017s)
[t-SNE] Iteration 100: error = 52.0291443, gradient norm = 0.4677431 (50 iterations in 0.021s)
[t-SNE] Iteration 150: error = 48.6360245, gradient norm = 0.4971982 (50 iterations in 0.017s)
[t-SNE] Iteration 200: error = 50.3347511, gradient norm = 0.5675135 (50 iterations in 0.017s)
[t-SNE] Iteration 250: error = 49.9438667, gradient norm = 0.5881242 (50 iterations in 0.017s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 49.943867
[t-SNE] Iteration 300: error = 0.6414442, gradient norm = 0.0114611 (50 iterations in 0.017s)
[t-SNE] Iteration 350: error = 0.2064844, gradient norm = 0.0064976 (50 iterations in 0.016s)
[t-SNE] Iteration 400: error = 0.1323816, gradient norm = 0.0019505 (50 iterations in 0.017s)
[t-SNE] Iteration 450: error = 0.1310113, gradient norm = 0.0006196 (50 iterations in 0.017s)
[t-SNE] Iteration 500: error = 0.1311381, gradient norm = 0.0005576 (50 iterations in 0.016s)
[t-SNE] Iteration 550: error = 0.1310931, gradient norm = 0.0004998 (50 iterations in 0.017s)
[t-SNE] Iteration 600: error = 0.1309263, gradient norm = 0.0007023 (50 iterations in 0.016s)
[t-SNE] Iteration 650: error = 0.1310148, gradient norm = 0.0005237 (50 iterations in 0.017s)
[t-SNE] Iteration 700: error = 0.1309968, gradient norm = 0.0005734 (50 iterations in 0.016s)
[t-SNE] Iteration 750: error = 0.1311213, gradient norm = 0.0004773 (50 iterations in 0.017s)
[t-SNE] Iteration 800: error = 0.1311504, gradient norm = 0.0004633 (50 iterations in 0.016s)
[t-SNE] Iteration 850: error = 0.1310074, gradient norm = 0.0005580 (50 iterations in 0.016s)
[t-SNE] Iteration 900: error = 0.1309132, gradient norm = 0.0006732 (50 iterations in 0.016s)
[t-SNE] Iteration 950: error = 0.1310236, gradient norm = 0.0005898 (50 iterations in 0.016s)
[t-SNE] Iteration 1000: error = 0.1310035, gradient norm = 0.0006137 (50 iterations in 0.016s)
[t-SNE] KL divergence after 1000 iterations: 0.131004
[t-SNE] Computed conditional probabilities for sample 100 / 100
[t-SNE] Mean sigma: 0.546062
Beginning preprocessing + Leiden
2024-03-12 00:19:29.697052 MEMORY 12.164984832
Affmat transformed
2024-03-12 00:19:29.698407 MEMORY 12.164984832
sources, targets, weights extracted
2024-03-12 00:19:29.698915 MEMORY 12.164984832
About to launch parallel Leiden runs
2024-03-12 00:19:29.740187 MEMORY 12.164984832
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.0s finished
Parallel Leiden runs finished
2024-03-12 00:19:31.732335 MEMORY 12.164984832
Quality: 0.35819492875970693
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  84 out of  84 | elapsed:    0.0s finished
Got subclusters: Counter({0: 42, 1: 34, 2: 24})
On pattern 4
[t-SNE] Computing 83 nearest neighbors...
[t-SNE] Indexed 84 samples in 0.001s...
[t-SNE] Computed neighbors for 84 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 84 / 84
[t-SNE] Mean sigma: 0.516429
[t-SNE] Computed conditional probabilities in 0.003s
[t-SNE] Iteration 50: error = 49.2411461, gradient norm = 0.4979444 (50 iterations in 0.016s)
[t-SNE] Iteration 100: error = 50.0515938, gradient norm = 0.5260364 (50 iterations in 0.016s)
[t-SNE] Iteration 150: error = 52.2155647, gradient norm = 0.4894680 (50 iterations in 0.016s)
[t-SNE] Iteration 200: error = 50.6162300, gradient norm = 0.4477939 (50 iterations in 0.016s)
[t-SNE] Iteration 250: error = 50.8008919, gradient norm = 0.4535313 (50 iterations in 0.016s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 50.800892
[t-SNE] Iteration 300: error = 0.6804031, gradient norm = 0.0043937 (50 iterations in 0.016s)
[t-SNE] Iteration 350: error = 0.5432182, gradient norm = 0.0024874 (50 iterations in 0.015s)
[t-SNE] Iteration 400: error = 0.4305103, gradient norm = 0.0031392 (50 iterations in 0.015s)
[t-SNE] Iteration 450: error = 0.3580817, gradient norm = 0.0061115 (50 iterations in 0.015s)
[t-SNE] Iteration 500: error = 0.1471044, gradient norm = 0.0091256 (50 iterations in 0.016s)
[t-SNE] Iteration 550: error = 0.1423030, gradient norm = 0.0008362 (50 iterations in 0.016s)
[t-SNE] Iteration 600: error = 0.1423706, gradient norm = 0.0008633 (50 iterations in 0.016s)
[t-SNE] Iteration 650: error = 0.1435584, gradient norm = 0.0005425 (50 iterations in 0.018s)
[t-SNE] Iteration 700: error = 0.1435570, gradient norm = 0.0005055 (50 iterations in 0.016s)
[t-SNE] Iteration 750: error = 0.1436018, gradient norm = 0.0004507 (50 iterations in 0.015s)
[t-SNE] Iteration 800: error = 0.1433999, gradient norm = 0.0004239 (50 iterations in 0.016s)
[t-SNE] Iteration 850: error = 0.1436004, gradient norm = 0.0004414 (50 iterations in 0.016s)
[t-SNE] Iteration 900: error = 0.1434743, gradient norm = 0.0004340 (50 iterations in 0.015s)
[t-SNE] Iteration 900: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 900 iterations: 0.143474
[t-SNE] Computed conditional probabilities for sample 84 / 84
[t-SNE] Mean sigma: 0.516429
Beginning preprocessing + Leiden
2024-03-12 00:19:32.128186 MEMORY 12.164984832
Affmat transformed
2024-03-12 00:19:32.129297 MEMORY 12.164984832
sources, targets, weights extracted
2024-03-12 00:19:32.129750 MEMORY 12.164984832
About to launch parallel Leiden runs
2024-03-12 00:19:32.158481 MEMORY 12.164984832
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.0s finished
Parallel Leiden runs finished
2024-03-12 00:19:34.113548 MEMORY 12.164984832
Quality: 0.22492631129680105
Quality: 0.22726308338973464
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  68 out of  68 | elapsed:    0.0s finished
Got subclusters: Counter({0: 38, 1: 33, 2: 11, 3: 2})
On pattern 5
[t-SNE] Computing 67 nearest neighbors...
[t-SNE] Indexed 68 samples in 0.001s...
[t-SNE] Computed neighbors for 68 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 68 / 68
[t-SNE] Mean sigma: 0.646852
[t-SNE] Computed conditional probabilities in 0.002s
[t-SNE] Iteration 50: error = 47.7405586, gradient norm = 0.5756031 (50 iterations in 0.016s)
[t-SNE] Iteration 100: error = 52.6702385, gradient norm = 0.5059679 (50 iterations in 0.015s)
[t-SNE] Iteration 150: error = 47.2906609, gradient norm = 0.5075827 (50 iterations in 0.015s)
[t-SNE] Iteration 200: error = 45.9370384, gradient norm = 0.4836966 (50 iterations in 0.015s)
[t-SNE] Iteration 250: error = 44.9554939, gradient norm = 0.6436127 (50 iterations in 0.015s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 44.955494
[t-SNE] Iteration 300: error = 0.7762511, gradient norm = 0.0034120 (50 iterations in 0.014s)
[t-SNE] Iteration 350: error = 0.6782109, gradient norm = 0.0015030 (50 iterations in 0.014s)
[t-SNE] Iteration 400: error = 0.6150042, gradient norm = 0.0007713 (50 iterations in 0.014s)
[t-SNE] Iteration 450: error = 0.5834284, gradient norm = 0.0007698 (50 iterations in 0.017s)
[t-SNE] Iteration 500: error = 0.5496979, gradient norm = 0.0017290 (50 iterations in 0.015s)
[t-SNE] Iteration 550: error = 0.4733725, gradient norm = 0.0161921 (50 iterations in 0.015s)
[t-SNE] Iteration 600: error = 0.5908461, gradient norm = 0.0036473 (50 iterations in 0.015s)
[t-SNE] Iteration 650: error = 0.5075773, gradient norm = 0.0013020 (50 iterations in 0.015s)
[t-SNE] Iteration 700: error = 0.4772300, gradient norm = 0.0006272 (50 iterations in 0.015s)
[t-SNE] Iteration 750: error = 0.4426137, gradient norm = 0.0027776 (50 iterations in 0.015s)
[t-SNE] Iteration 800: error = 0.8184789, gradient norm = 0.0038482 (50 iterations in 0.015s)
[t-SNE] Iteration 850: error = 0.6555430, gradient norm = 0.0007296 (50 iterations in 0.018s)
[t-SNE] Iteration 900: error = 0.5816727, gradient norm = 0.0004987 (50 iterations in 0.015s)
[t-SNE] Iteration 950: error = 0.5437511, gradient norm = 0.0005995 (50 iterations in 0.015s)
[t-SNE] Iteration 1000: error = 0.5260140, gradient norm = 0.0002965 (50 iterations in 0.015s)
[t-SNE] KL divergence after 1000 iterations: 0.526014
[t-SNE] Computed conditional probabilities for sample 68 / 68
[t-SNE] Mean sigma: 0.646851
Beginning preprocessing + Leiden
2024-03-12 00:19:34.512992 MEMORY 12.164984832
Affmat transformed
2024-03-12 00:19:34.514144 MEMORY 12.164984832
sources, targets, weights extracted
2024-03-12 00:19:34.514592 MEMORY 12.164984832
About to launch parallel Leiden runs
2024-03-12 00:19:34.569853 MEMORY 12.164984832
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.9s finished
Parallel Leiden runs finished
2024-03-12 00:19:36.505234 MEMORY 12.164984832
Quality: 0.14860690447258085
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  61 out of  61 | elapsed:    0.0s finished
Got subclusters: Counter({0: 33, 1: 27, 2: 8})
On pattern 6
[t-SNE] Computing 60 nearest neighbors...
[t-SNE] Indexed 61 samples in 0.001s...
[t-SNE] Computed neighbors for 61 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 61 / 61
[t-SNE] Mean sigma: 0.740668
[t-SNE] Computed conditional probabilities in 0.002s
[t-SNE] Iteration 50: error = 45.5893974, gradient norm = 0.5423627 (50 iterations in 0.017s)
[t-SNE] Iteration 100: error = 46.5515709, gradient norm = 0.4562089 (50 iterations in 0.014s)
[t-SNE] Iteration 150: error = 47.1413651, gradient norm = 0.5527541 (50 iterations in 0.014s)
[t-SNE] Iteration 200: error = 42.5152016, gradient norm = 0.4987202 (50 iterations in 0.014s)
[t-SNE] Iteration 250: error = 44.5494232, gradient norm = 0.5734279 (50 iterations in 0.014s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 44.549423
[t-SNE] Iteration 300: error = 0.7907784, gradient norm = 0.0017538 (50 iterations in 0.014s)
[t-SNE] Iteration 350: error = 0.6495032, gradient norm = 0.0007874 (50 iterations in 0.014s)
[t-SNE] Iteration 400: error = 0.5944144, gradient norm = 0.0009481 (50 iterations in 0.014s)
[t-SNE] Iteration 450: error = 0.5701410, gradient norm = 0.0004026 (50 iterations in 0.014s)
[t-SNE] Iteration 500: error = 0.5531642, gradient norm = 0.0002609 (50 iterations in 0.017s)
[t-SNE] Iteration 550: error = 0.5409955, gradient norm = 0.0004765 (50 iterations in 0.013s)
[t-SNE] Iteration 600: error = 0.5323861, gradient norm = 0.0002013 (50 iterations in 0.014s)
[t-SNE] Iteration 650: error = 0.5273880, gradient norm = 0.0001942 (50 iterations in 0.013s)
[t-SNE] Iteration 700: error = 0.5232604, gradient norm = 0.0002078 (50 iterations in 0.013s)
[t-SNE] Iteration 750: error = 0.5175413, gradient norm = 0.0004073 (50 iterations in 0.013s)
[t-SNE] Iteration 800: error = 0.5098287, gradient norm = 0.0003042 (50 iterations in 0.014s)
[t-SNE] Iteration 850: error = 0.4934838, gradient norm = 0.0015939 (50 iterations in 0.014s)
[t-SNE] Iteration 900: error = 0.6379603, gradient norm = 0.0187600 (50 iterations in 0.014s)
[t-SNE] Iteration 950: error = 0.4782773, gradient norm = 0.0026012 (50 iterations in 0.014s)
[t-SNE] Iteration 1000: error = 0.4344002, gradient norm = 0.0010742 (50 iterations in 0.015s)
[t-SNE] KL divergence after 1000 iterations: 0.434400
[t-SNE] Computed conditional probabilities for sample 61 / 61
[t-SNE] Mean sigma: 0.740668
Beginning preprocessing + Leiden
2024-03-12 00:19:36.862257 MEMORY 12.164984832
Affmat transformed
2024-03-12 00:19:36.863251 MEMORY 12.164984832
sources, targets, weights extracted
2024-03-12 00:19:36.863688 MEMORY 12.164984832
About to launch parallel Leiden runs
2024-03-12 00:19:36.892837 MEMORY 12.164984832
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.9s finished
Parallel Leiden runs finished
2024-03-12 00:19:38.782881 MEMORY 12.164984832
Quality: 0.1251870166717779
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  56 out of  56 | elapsed:    0.0s finished
Got subclusters: Counter({0: 28, 1: 18, 2: 15})
On pattern 7
[t-SNE] Computing 55 nearest neighbors...
[t-SNE] Indexed 56 samples in 0.001s...
[t-SNE] Computed neighbors for 56 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 56 / 56
[t-SNE] Mean sigma: 0.897996
[t-SNE] Computed conditional probabilities in 0.002s
[t-SNE] Iteration 50: error = 47.3762703, gradient norm = 0.5895416 (50 iterations in 0.014s)
[t-SNE] Iteration 100: error = 43.6894188, gradient norm = 0.5697390 (50 iterations in 0.014s)
[t-SNE] Iteration 150: error = 43.2327614, gradient norm = 0.5480386 (50 iterations in 0.014s)
[t-SNE] Iteration 200: error = 45.2818947, gradient norm = 0.3782198 (50 iterations in 0.014s)
[t-SNE] Iteration 250: error = 43.4521561, gradient norm = 0.5037521 (50 iterations in 0.014s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 43.452156
[t-SNE] Iteration 300: error = 0.6837205, gradient norm = 0.0010970 (50 iterations in 0.013s)
[t-SNE] Iteration 350: error = 0.6214972, gradient norm = 0.0017274 (50 iterations in 0.013s)
[t-SNE] Iteration 400: error = 0.5746573, gradient norm = 0.0010971 (50 iterations in 0.013s)
[t-SNE] Iteration 450: error = 0.5505826, gradient norm = 0.0011114 (50 iterations in 0.013s)
[t-SNE] Iteration 500: error = 0.8771148, gradient norm = 0.0036547 (50 iterations in 0.014s)
[t-SNE] Iteration 550: error = 0.6851432, gradient norm = 0.0007528 (50 iterations in 0.013s)
[t-SNE] Iteration 600: error = 0.5887167, gradient norm = 0.0003113 (50 iterations in 0.013s)
[t-SNE] Iteration 650: error = 0.5736322, gradient norm = 0.0001104 (50 iterations in 0.013s)
[t-SNE] Iteration 700: error = 0.5668903, gradient norm = 0.0001506 (50 iterations in 0.013s)
[t-SNE] Iteration 750: error = 0.5492029, gradient norm = 0.0002146 (50 iterations in 0.013s)
[t-SNE] Iteration 800: error = 0.5202697, gradient norm = 0.0002387 (50 iterations in 0.013s)
[t-SNE] Iteration 850: error = 0.5030683, gradient norm = 0.0002035 (50 iterations in 0.013s)
[t-SNE] Iteration 900: error = 0.4904846, gradient norm = 0.0001512 (50 iterations in 0.013s)
[t-SNE] Iteration 950: error = 0.4836039, gradient norm = 0.0001298 (50 iterations in 0.013s)
[t-SNE] Iteration 1000: error = 0.4725820, gradient norm = 0.0001231 (50 iterations in 0.013s)
[t-SNE] KL divergence after 1000 iterations: 0.472582
[t-SNE] Computed conditional probabilities for sample 56 / 56
[t-SNE] Mean sigma: 0.897996
Beginning preprocessing + Leiden
2024-03-12 00:19:39.121672 MEMORY 12.164984832
Affmat transformed
2024-03-12 00:19:39.122590 MEMORY 12.164984832
sources, targets, weights extracted
2024-03-12 00:19:39.122968 MEMORY 12.164984832
About to launch parallel Leiden runs
2024-03-12 00:19:39.174046 MEMORY 12.164984832
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.9s finished
Parallel Leiden runs finished
2024-03-12 00:19:41.073130 MEMORY 12.164984832
Quality: 0.08798944405284347
Got subclusters: Counter({0: 31, 1: 25})
On metacluster 4
Metacluster size 2477
Relevant tasks:  ('testis',)
Relevant signs:  (-1,)
TfModiscoSeqletsToPatternsFactory: seed=1234
(Round 1) num seqlets: 2477
(Round 1) Computing coarse affmat
2024-03-12 00:19:42.685784 MEMORY 12.163936256
Beginning embedding computation
MEMORY 12.163936256
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 152 tasks      | elapsed:    2.3s
[Parallel(n_jobs=24)]: Done 402 tasks      | elapsed:    5.8s
[Parallel(n_jobs=24)]: Done 752 tasks      | elapsed:   10.5s
[Parallel(n_jobs=24)]: Done 1202 tasks      | elapsed:   16.7s
[Parallel(n_jobs=24)]: Done 1752 tasks      | elapsed:   24.0s
[Parallel(n_jobs=24)]: Done 2402 tasks      | elapsed:   32.6s
[Parallel(n_jobs=24)]: Done 2477 out of 2477 | elapsed:   33.6s finished
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 152 tasks      | elapsed:    2.3s
[Parallel(n_jobs=24)]: Done 402 tasks      | elapsed:    5.8s
[Parallel(n_jobs=24)]: Done 752 tasks      | elapsed:   10.7s
[Parallel(n_jobs=24)]: Done 1202 tasks      | elapsed:   16.8s
[Parallel(n_jobs=24)]: Done 1752 tasks      | elapsed:   24.1s
[Parallel(n_jobs=24)]: Done 2402 tasks      | elapsed:   32.8s
[Parallel(n_jobs=24)]: Done 2477 out of 2477 | elapsed:   33.8s finished
At the beginning of embedding call
2024-03-12 00:19:42.686069 MEMORY 12.163936256
before computing embeddings fwd
2024-03-12 00:19:42.696423 MEMORY 12.163936256
after computing embeddings fwd
2024-03-12 00:20:16.315265 MEMORY 12.163936256
after computing embeddings rev
2024-03-12 00:20:50.143109 MEMORY 12.247187456
before computing sparse embeddings fwd
2024-03-12 00:20:50.143263 MEMORY 12.247187456
Constructing csr matrix...
csr matrix made in 0.4018442630767822 s
after computing sparse embeddings fwd
2024-03-12 00:20:50.696240 MEMORY 12.247261184
before computing sparse embeddings rev
2024-03-12 00:20:50.696368 MEMORY 12.247261184
Constructing csr matrix...
csr matrix made in 0.32805371284484863 s
after computing sparse embeddings rev
2024-03-12 00:20:51.140989 MEMORY 12.247261184
Finished embedding computation in 69.94 s
MEMORY 12.18408448
Starting affinity matrix computations
MEMORY 12.183298048
Batching in slices of size 2477
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:02<00:00,  2.16s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:02<00:00,  2.16s/it]
Finished affinity matrix computations in 2.21 s
MEMORY 12.183298048
(Round 1) Computed coarse affmat
2024-03-12 00:20:56.123667 MEMORY 12.18306048
(Round 1) Computing affinity matrix on nearest neighbors
2024-03-12 00:20:56.123865 MEMORY 12.18306048
Launching nearest neighbors affmat calculation job
MEMORY 12.18306048
Parallel runs completed
MEMORY 12.285177856
Job completed in: 9.17 s
MEMORY 12.283224064
Launching nearest neighbors affmat calculation job
MEMORY 12.283318272
Parallel runs completed
MEMORY 12.309172224
Job completed in: 9.43 s
MEMORY 12.307427328
(Round 1) Computed affinity matrix on nearest neighbors in 19.88 s
2024-03-12 00:21:16.005532 MEMORY 12.30567424
Filtered down to 2443 of 2477
(Round 1) Retained 2443 rows out of 2477 after filtering
2024-03-12 00:21:17.589664 MEMORY 12.30567424
(Round 1) Computing density adapted affmat
2024-03-12 00:21:18.944902 MEMORY 12.30567424
Symmetrizing nearest neighbors
Computing betas for density adaptation
Computing normalizing denominators
(Round 1) Computing clustering
2024-03-12 00:21:37.065801 MEMORY 12.289380352
Beginning preprocessing + Leiden
2024-03-12 00:21:37.068485 MEMORY 12.289380352
Affmat transformed
2024-03-12 00:21:37.068599 MEMORY 12.289380352
sources, targets, weights extracted
2024-03-12 00:21:37.139616 MEMORY 12.289380352
About to launch parallel Leiden runs
2024-03-12 00:21:37.216668 MEMORY 12.289380352
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    6.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   21.4s finished
Parallel Leiden runs finished
2024-03-12 00:21:58.596520 MEMORY 12.289380352
Quality: 0.41046876021884654
Got 3 clusters after round 1
Counts:
{2: 577, 0: 1088, 1: 778}
2024-03-12 00:21:58.604462 MEMORY 12.289380352
(Round 1) Aggregating seqlets in each cluster
2024-03-12 00:21:58.604574 MEMORY 12.289380352
Aggregating for cluster 0 with 1088 seqlets
2024-03-12 00:21:58.607274 MEMORY 12.289380352
Trimming eliminated 0 seqlets out of 1088
Aggregating for cluster 1 with 778 seqlets
2024-03-12 00:22:02.671213 MEMORY 12.289544192
Trimming eliminated 0 seqlets out of 778
Aggregating for cluster 2 with 577 seqlets
2024-03-12 00:22:04.810544 MEMORY 12.289544192
Trimming eliminated 0 seqlets out of 577
(Round 2) num seqlets: 2443
(Round 2) Computing coarse affmat
2024-03-12 00:22:06.944072 MEMORY 12.289544192
Beginning embedding computation
MEMORY 12.289544192
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 272 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done 1272 tasks      | elapsed:    2.2s
[Parallel(n_jobs=24)]: Done 2443 out of 2443 | elapsed:    4.0s finished
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 272 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done 2112 tasks      | elapsed:    3.1s
[Parallel(n_jobs=24)]: Done 2443 out of 2443 | elapsed:    3.6s finished
At the beginning of embedding call
2024-03-12 00:22:06.944384 MEMORY 12.289544192
before computing embeddings fwd
2024-03-12 00:22:06.954276 MEMORY 12.289544192
after computing embeddings fwd
2024-03-12 00:22:10.985083 MEMORY 12.3350016
after computing embeddings rev
2024-03-12 00:22:14.599776 MEMORY 12.434804736
before computing sparse embeddings fwd
2024-03-12 00:22:14.599893 MEMORY 12.434804736
Constructing csr matrix...
csr matrix made in 0.3127610683441162 s
after computing sparse embeddings fwd
2024-03-12 00:22:15.016380 MEMORY 12.434874368
before computing sparse embeddings rev
2024-03-12 00:22:15.016502 MEMORY 12.434874368
Constructing csr matrix...
csr matrix made in 0.30632472038269043 s
after computing sparse embeddings rev
2024-03-12 00:22:15.430866 MEMORY 12.434874368
Finished embedding computation in 9.54 s
MEMORY 12.354658304
Starting affinity matrix computations
MEMORY 12.354658304
Batching in slices of size 2443
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:02<00:00,  2.30s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:02<00:00,  2.30s/it]
Finished affinity matrix computations in 2.31 s
MEMORY 12.354658304
(Round 2) Computed coarse affmat
2024-03-12 00:22:19.673030 MEMORY 12.354506752
(Round 2) Computing affinity matrix on nearest neighbors
2024-03-12 00:22:19.673248 MEMORY 12.354506752
Launching nearest neighbors affmat calculation job
MEMORY 12.354506752
Parallel runs completed
MEMORY 12.378468352
Job completed in: 5.04 s
MEMORY 12.37612544
Launching nearest neighbors affmat calculation job
MEMORY 12.375977984
Parallel runs completed
MEMORY 12.373864448
Job completed in: 5.31 s
MEMORY 12.37366784
(Round 2) Computed affinity matrix on nearest neighbors in 11.61 s
2024-03-12 00:22:31.285678 MEMORY 12.344819712
Not applying filtering for rounds above first round
2024-03-12 00:22:31.286203 MEMORY 12.344819712
(Round 2) Computing density adapted affmat
2024-03-12 00:22:32.637736 MEMORY 12.344819712
Symmetrizing nearest neighbors
Computing betas for density adaptation
Computing normalizing denominators
(Round 2) Computing clustering
2024-03-12 00:22:50.269867 MEMORY 12.319473664
Beginning preprocessing + Leiden
2024-03-12 00:22:50.272692 MEMORY 12.319473664
Affmat transformed
2024-03-12 00:22:50.272812 MEMORY 12.319473664
sources, targets, weights extracted
2024-03-12 00:22:50.342910 MEMORY 12.319473664
About to launch parallel Leiden runs
2024-03-12 00:22:50.410844 MEMORY 12.319473664
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    6.5s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   19.2s finished
Parallel Leiden runs finished
2024-03-12 00:23:09.590828 MEMORY 12.3196416
Quality: 0.4447790714959643
Got 3 clusters after round 2
Counts:
{0: 1056, 2: 595, 1: 792}
2024-03-12 00:23:09.600577 MEMORY 12.3196416
(Round 2) Aggregating seqlets in each cluster
2024-03-12 00:23:09.600691 MEMORY 12.3196416
Aggregating for cluster 0 with 1056 seqlets
2024-03-12 00:23:09.601744 MEMORY 12.3196416
Trimming eliminated 0 seqlets out of 1056
Aggregating for cluster 1 with 792 seqlets
2024-03-12 00:23:12.647357 MEMORY 12.319117312
Trimming eliminated 0 seqlets out of 792
Aggregating for cluster 2 with 595 seqlets
2024-03-12 00:23:14.203712 MEMORY 12.319117312
Trimming eliminated 0 seqlets out of 595
Got 3 clusters
Splitting into subclusters...
2024-03-12 00:23:15.411197 MEMORY 12.319117312
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 930 tasks      | elapsed:    0.4s
[Parallel(n_jobs=24)]: Done 1056 out of 1056 | elapsed:    0.5s finished
Inspecting pattern 0 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 1056
[t-SNE] Computed conditional probabilities for sample 1056 / 1056
[t-SNE] Mean sigma: 0.320594
Beginning preprocessing + Leiden
2024-03-12 00:23:17.125994 MEMORY 12.319117312
Affmat transformed
2024-03-12 00:23:17.140658 MEMORY 12.319117312
sources, targets, weights extracted
2024-03-12 00:23:17.149376 MEMORY 12.319117312
About to launch parallel Leiden runs
2024-03-12 00:23:17.207693 MEMORY 12.319117312
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    3.1s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    9.7s finished
Parallel Leiden runs finished
2024-03-12 00:23:26.862708 MEMORY 12.319117312
Quality: 0.4763286865598979
Quality: 0.4764307971322935
Quality: 0.47799526314987406
Got subclusters: Counter({0: 269, 1: 174, 2: 171, 3: 169, 4: 129, 5: 121, 6: 23})
On merging iteration 1
Numbers for each pattern pre-subsample: [269, 174, 171, 169, 129, 121, 23]
Numbers after subsampling: [269, 174, 171, 169, 129, 121, 23]
Computing sims for pattern 0
Computed sims for pattern 0 in 1.5169916152954102 s
Computing sims for pattern 1
Computed sims for pattern 1 in 1.1352198123931885 s
Computing sims for pattern 2
Computed sims for pattern 2 in 1.1041185855865479 s
Computing sims for pattern 3
Computed sims for pattern 3 in 1.0796186923980713 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.9095723628997803 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.8436274528503418 s
Computing sims for pattern 6
Computed sims for pattern 6 in 0.25755763053894043 s
Cluster sizes
[269 174 171 169 129 121  23]
Cross-contamination matrix:
[[1.   0.65 0.72 0.73 0.54 0.75 0.5 ]
 [0.41 1.   0.58 0.68 0.62 0.52 0.63]
 [0.54 0.67 1.   0.78 0.54 0.46 0.73]
 [0.38 0.56 0.55 1.   0.57 0.48 0.59]
 [0.42 0.77 0.46 0.85 1.   0.57 0.89]
 [0.65 0.69 0.55 0.78 0.59 1.   0.44]
 [0.05 0.21 0.2  0.26 0.3  0.03 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.84 0.88 0.79 0.78 0.88 0.62]
 [0.84 1.   0.82 0.82 0.83 0.83 0.71]
 [0.88 0.82 1.   0.83 0.77 0.79 0.78]
 [0.79 0.82 0.83 1.   0.85 0.82 0.7 ]
 [0.78 0.83 0.77 0.85 1.   0.77 0.75]
 [0.88 0.83 0.79 0.82 0.77 1.   0.58]
 [0.62 0.71 0.78 0.7  0.75 0.58 1.  ]]
Collapsing 0 & 5 with crosscontam 0.6519232385374352 and sim 0.8831967403132035
Collapsing 0 & 2 with crosscontam 0.5363353859775668 and sim 0.8829681655648665
Collapsing 3 & 4 with crosscontam 0.5697103680263598 and sim 0.8534566789128597
Trimming eliminated 0 seqlets out of 390
Trimming eliminated 0 seqlets out of 561
Trimming eliminated 0 seqlets out of 298
Unmerged patterns remapping: OrderedDict([(1, 2), (6, 3)])
Time spent on merging iteration: 2.3693764209747314
On merging iteration 2
Numbers for each pattern pre-subsample: [561, 298, 174, 23]
Numbers after subsampling: [300, 298, 174, 23]
Computing sims for pattern 0
Computed sims for pattern 0 in 0.933476448059082 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.9332711696624756 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.45139408111572266 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.11821246147155762 s
Cluster sizes
[561 298 174  23]
Cross-contamination matrix:
[[1.   0.87 0.87 0.71]
 [0.61 1.   0.79 0.83]
 [0.46 0.64 1.   0.63]
 [0.08 0.23 0.21 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.85 0.86 0.66]
 [0.85 1.   0.85 0.7 ]
 [0.86 0.85 1.   0.71]
 [0.66 0.7  0.71 1.  ]]
Collapsing 1 & 2 with crosscontam 0.6406829469530884 and sim 0.8515282881438415
Trimming eliminated 0 seqlets out of 472
Unmerged patterns remapping: OrderedDict([(0, 0), (3, 2)])
Time spent on merging iteration: 0.9968163967132568
On merging iteration 3
Numbers for each pattern pre-subsample: [561, 472, 23]
Numbers after subsampling: [300, 300, 23]
Computing sims for pattern 0
Computed sims for pattern 0 in 0.3479034900665283 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.6150457859039307 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.06038784980773926 s
Cluster sizes
[561 472  23]
Cross-contamination matrix:
[[1.   0.88 0.71]
 [0.74 1.   0.92]
 [0.08 0.21 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.88 0.66]
 [0.88 1.   0.71]
 [0.66 0.71 1.  ]]
Collapsing 0 & 1 with crosscontam 0.7446944972839507 and sim 0.8823619094688443
Trimming eliminated 0 seqlets out of 1033
Unmerged patterns remapping: OrderedDict([(2, 1)])
Time spent on merging iteration: 1.9902229309082031
On merging iteration 4
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 792 out of 792 | elapsed:    0.2s finished
Numbers for each pattern pre-subsample: [1033, 23]
Numbers after subsampling: [300, 23]
Computing sims for pattern 0
Computed sims for pattern 0 in 0.2565019130706787 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.05697894096374512 s
Cluster sizes
[1033   23]
Cross-contamination matrix:
[[1.   0.84]
 [0.09 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.68]
 [0.68 1.  ]]
Inspecting pattern 1 for spurious merging
[t-SNE] Computed conditional probabilities for sample 792 / 792
[t-SNE] Mean sigma: 0.330923
Beginning preprocessing + Leiden
2024-03-12 00:23:44.011030 MEMORY 12.319117312
Affmat transformed
2024-03-12 00:23:44.021682 MEMORY 12.319117312
sources, targets, weights extracted
2024-03-12 00:23:44.027918 MEMORY 12.319117312
About to launch parallel Leiden runs
2024-03-12 00:23:44.041227 MEMORY 12.319117312
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    2.3s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    7.5s finished
Parallel Leiden runs finished
2024-03-12 00:23:51.564752 MEMORY 12.319117312
Quality: 0.4709271631035245
Quality: 0.47288393648377924
Quality: 0.47328571754965515
Got subclusters: Counter({0: 183, 1: 141, 2: 131, 3: 114, 4: 113, 5: 110})
On merging iteration 1
Numbers for each pattern pre-subsample: [183, 141, 131, 114, 113, 110]
Numbers after subsampling: [183, 141, 131, 114, 113, 110]
Computing sims for pattern 0
Computed sims for pattern 0 in 1.021204948425293 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.8548755645751953 s
Computing sims for pattern 2
Computed sims for pattern 2 in 1.8320164680480957 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.6990690231323242 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.678206205368042 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.6624729633331299 s
Cluster sizes
[183 141 131 114 113 110]
Cross-contamination matrix:
[[1.   0.59 0.56 0.54 0.24 0.43]
 [0.88 1.   0.58 0.58 0.23 0.52]
 [0.57 0.37 1.   0.73 0.42 0.58]
 [0.54 0.34 0.73 1.   0.28 0.59]
 [0.58 0.33 0.81 0.63 1.   0.47]
 [0.67 0.48 0.8  0.83 0.33 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.91 0.85 0.83 0.68 0.86]
 [0.91 1.   0.81 0.78 0.56 0.82]
 [0.85 0.81 1.   0.87 0.78 0.9 ]
 [0.83 0.78 0.87 1.   0.63 0.86]
 [0.68 0.56 0.78 0.63 1.   0.62]
 [0.86 0.82 0.9  0.86 0.62 1.  ]]
Collapsing 0 & 1 with crosscontam 0.591580553323594 and sim 0.9146123219155401
Collapsing 2 & 5 with crosscontam 0.5842088323745873 and sim 0.9023975973709581
Collapsing 2 & 3 with crosscontam 0.7278711052134057 and sim 0.8723767689979665
Collapsing 3 & 5 with crosscontam 0.5877504696574531 and sim 0.8625547701783971
Trimming eliminated 0 seqlets out of 324
Trimming eliminated 0 seqlets out of 241
Trimming eliminated 0 seqlets out of 355
Unmerged patterns remapping: OrderedDict([(4, 2)])
Time spent on merging iteration: 1.8251738548278809
On merging iteration 2
Numbers for each pattern pre-subsample: [355, 324, 113]
Numbers after subsampling: [300, 300, 113]
Computing sims for pattern 0
Computed sims for pattern 0 in 0.6847145557403564 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.694033145904541 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.3352384567260742 s
Cluster sizes
[355 324 113]
Cross-contamination matrix:
[[1.   0.66 0.48]
 [0.67 1.   0.34]
 [0.66 0.48 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.88 0.72]
 [0.88 1.   0.64]
 [0.72 0.64 1.  ]]
Collapsing 0 & 1 with crosscontam 0.6597921639506172 and sim 0.8825771135792089
Trimming eliminated 0 seqlets out of 679
Unmerged patterns remapping: OrderedDict([(2, 1)])
Time spent on merging iteration: 1.3889868259429932
On merging iteration 3
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 595 out of 595 | elapsed:    0.2s finished
Numbers for each pattern pre-subsample: [679, 113]
Numbers after subsampling: [300, 113]
Computing sims for pattern 0
Computed sims for pattern 0 in 0.3105931282043457 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.16309142112731934 s
Cluster sizes
[679 113]
Cross-contamination matrix:
[[1.   0.55]
 [0.58 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.69]
 [0.69 1.  ]]
Inspecting pattern 2 for spurious merging
[t-SNE] Computed conditional probabilities for sample 595 / 595
[t-SNE] Mean sigma: 0.311908
Beginning preprocessing + Leiden
2024-03-12 00:24:02.863514 MEMORY 12.319117312
Affmat transformed
2024-03-12 00:24:02.871066 MEMORY 12.319117312
sources, targets, weights extracted
2024-03-12 00:24:02.875501 MEMORY 12.319117312
About to launch parallel Leiden runs
2024-03-12 00:24:02.921506 MEMORY 12.319117312
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    5.5s finished
Parallel Leiden runs finished
2024-03-12 00:24:08.399600 MEMORY 12.319117312
Quality: 0.40922519686452163
Quality: 0.4133947857771533
Quality: 0.4136929554212657
Quality: 0.41549676476516867
Got subclusters: Counter({0: 122, 1: 120, 2: 118, 3: 109, 4: 107, 5: 19})
On merging iteration 1
Numbers for each pattern pre-subsample: [122, 120, 118, 109, 107, 19]
Numbers after subsampling: [122, 120, 118, 109, 107, 19]
Computing sims for pattern 0
Computed sims for pattern 0 in 0.6619827747344971 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.6686275005340576 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.6467666625976562 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.6011672019958496 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.5898294448852539 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.1685774326324463 s
Cluster sizes
[122 120 118 109 107  19]
Cross-contamination matrix:
[[1.   0.59 0.57 0.69 0.77 0.74]
 [0.75 1.   0.6  0.84 0.68 0.85]
 [0.76 0.63 1.   0.67 0.74 0.87]
 [0.74 0.7  0.55 1.   0.77 0.81]
 [0.73 0.52 0.54 0.69 1.   0.67]
 [0.33 0.26 0.3  0.38 0.32 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.9  0.87 0.91 0.9  0.84]
 [0.9  1.   0.88 0.93 0.85 0.87]
 [0.87 0.88 1.   0.87 0.86 0.83]
 [0.91 0.93 0.87 1.   0.9  0.9 ]
 [0.9  0.85 0.86 0.9  1.   0.8 ]
 [0.84 0.87 0.83 0.9  0.8  1.  ]]
Collapsing 1 & 3 with crosscontam 0.6961267534034632 and sim 0.9291409365707974
Collapsing 0 & 3 with crosscontam 0.6855126579927537 and sim 0.91023107418422
Collapsing 0 & 4 with crosscontam 0.7344564940865306 and sim 0.8994692288179627
Collapsing 3 & 4 with crosscontam 0.6918178427243671 and sim 0.8987436156426545
Collapsing 0 & 1 with crosscontam 0.589881458506806 and sim 0.8977742819377632
Collapsing 1 & 2 with crosscontam 0.6028436519146265 and sim 0.878463796061473
Collapsing 2 & 3 with crosscontam 0.5501615950986296 and sim 0.8701072149964717
Collapsing 0 & 2 with crosscontam 0.5714436338619846 and sim 0.8689062164991682
Collapsing 2 & 4 with crosscontam 0.5428076222353841 and sim 0.8613064684066324
Trimming eliminated 0 seqlets out of 229
Trimming eliminated 0 seqlets out of 351
Trimming eliminated 0 seqlets out of 458
Trimming eliminated 0 seqlets out of 576
Unmerged patterns remapping: OrderedDict([(5, 1)])
Time spent on merging iteration: 2.252318859100342
On merging iteration 2
Numbers for each pattern pre-subsample: [576, 19]
Numbers after subsampling: [300, 19]
Computing sims for pattern 0
Computed sims for pattern 0 in 0.26746630668640137 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.055849313735961914 s
Cluster sizes
[576  19]
Cross-contamination matrix:
[[1.   1.  ]
 [0.31 1.  ]]
Pattern-to-pattern sim matrix:
[[1.  0.9]
 [0.9 1. ]]
Merging on 6 clusters
2024-03-12 00:24:14.352072 MEMORY 12.319117312
On merging iteration 1
Numbers for each pattern pre-subsample: [1033, 23, 679, 113, 576, 19]
Numbers after subsampling: [300, 23, 300, 113, 300, 19]
Computing sims for pattern 0
Computed sims for pattern 0 in 1.5872933864593506 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.23287725448608398 s
Computing sims for pattern 2
Computed sims for pattern 2 in 1.544086217880249 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.7022390365600586 s
Computing sims for pattern 4
Computed sims for pattern 4 in 1.6109812259674072 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.21017789840698242 s
Cluster sizes
[1033   23  679  113  576   19]
Cross-contamination matrix:
[[1.   0.84 0.16 0.17 0.16 0.14]
 [0.09 1.   0.   0.   0.   0.  ]
 [0.18 0.12 1.   0.55 0.51 0.41]
 [0.2  0.1  0.58 1.   0.18 0.16]
 [0.15 0.1  0.39 0.13 1.   1.  ]
 [0.   0.   0.01 0.   0.31 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.68 0.43 0.49 0.41 0.41]
 [0.68 1.   0.33 0.34 0.31 0.32]
 [0.43 0.33 1.   0.69 0.68 0.56]
 [0.49 0.34 0.69 1.   0.41 0.36]
 [0.41 0.31 0.68 0.41 1.   0.9 ]
 [0.41 0.32 0.56 0.36 0.9  1.  ]]
Got 6 patterns after merging
2024-03-12 00:24:20.714240 MEMORY 12.319117312
Performing filtering
2024-03-12 00:24:20.714472 MEMORY 12.319117312
Got 4 patterns after filtering
2024-03-12 00:24:21.135357 MEMORY 12.319117312
Total time taken is 279.34s
2024-03-12 00:24:21.135560 MEMORY 12.319117312
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 930 tasks      | elapsed:    0.4s
[Parallel(n_jobs=24)]: Done 1033 out of 1033 | elapsed:    0.5s finished
/ru-auth/local/home/lzhao/anaconda3/envs/jupyter-ml-clone/lib/python3.9/site-packages/sklearn/manifold/_t_sne.py:691: FutureWarning: 'square_distances' has been introduced in 0.24 to help phase out legacy squaring behavior. The 'legacy' setting will be removed in 1.1 (renaming of 0.26), and the default setting will be changed to True. In 1.3, 'square_distances' will be removed altogether, and distances will be squared by default. Set 'square_distances'=True to silence this warning.
  warnings.warn(
/ru-auth/local/home/lzhao/anaconda3/envs/jupyter-ml-clone/lib/python3.9/site-packages/sklearn/neighbors/_base.py:175: EfficiencyWarning: Precomputed sparse input was not sorted by data.
  warnings.warn('Precomputed sparse input was not sorted by data.',
Applying subclustering to the final motifs
On pattern 0
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 1033 samples in 0.007s...
[t-SNE] Computed neighbors for 1033 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 1000 / 1033
[t-SNE] Computed conditional probabilities for sample 1033 / 1033
[t-SNE] Mean sigma: 0.320978
[t-SNE] Computed conditional probabilities in 0.079s
[t-SNE] Iteration 50: error = 66.8340988, gradient norm = 0.2912085 (50 iterations in 0.101s)
[t-SNE] Iteration 100: error = 66.2186966, gradient norm = 0.3016365 (50 iterations in 0.102s)
[t-SNE] Iteration 150: error = 66.0615463, gradient norm = 0.2881184 (50 iterations in 0.096s)
[t-SNE] Iteration 200: error = 67.3553848, gradient norm = 0.2740721 (50 iterations in 0.095s)
[t-SNE] Iteration 250: error = 66.2348862, gradient norm = 0.2792968 (50 iterations in 0.095s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 66.234886
[t-SNE] Iteration 300: error = 1.7232774, gradient norm = 0.0017803 (50 iterations in 0.086s)
[t-SNE] Iteration 350: error = 1.6517617, gradient norm = 0.0008006 (50 iterations in 0.083s)
[t-SNE] Iteration 400: error = 1.6261346, gradient norm = 0.0002308 (50 iterations in 0.084s)
[t-SNE] Iteration 450: error = 1.6143929, gradient norm = 0.0001984 (50 iterations in 0.084s)
[t-SNE] Iteration 500: error = 1.6093998, gradient norm = 0.0001337 (50 iterations in 0.084s)
[t-SNE] Iteration 550: error = 1.6062949, gradient norm = 0.0001014 (50 iterations in 0.084s)
[t-SNE] Iteration 600: error = 1.6032739, gradient norm = 0.0001674 (50 iterations in 0.084s)
[t-SNE] Iteration 650: error = 1.6022145, gradient norm = 0.0000682 (50 iterations in 0.086s)
[t-SNE] Iteration 700: error = 1.6012551, gradient norm = 0.0000661 (50 iterations in 0.084s)
[t-SNE] Iteration 750: error = 1.5999050, gradient norm = 0.0001284 (50 iterations in 0.084s)
[t-SNE] Iteration 800: error = 1.5974950, gradient norm = 0.0001087 (50 iterations in 0.088s)
[t-SNE] Iteration 850: error = 1.5936111, gradient norm = 0.0001061 (50 iterations in 0.087s)
[t-SNE] Iteration 900: error = 1.5931903, gradient norm = 0.0000572 (50 iterations in 0.085s)
[t-SNE] Iteration 950: error = 1.5926033, gradient norm = 0.0000656 (50 iterations in 0.084s)
[t-SNE] Iteration 1000: error = 1.5924196, gradient norm = 0.0000576 (50 iterations in 0.084s)
[t-SNE] KL divergence after 1000 iterations: 1.592420
[t-SNE] Computed conditional probabilities for sample 1000 / 1033
[t-SNE] Computed conditional probabilities for sample 1033 / 1033
[t-SNE] Mean sigma: 0.320978
Beginning preprocessing + Leiden
2024-03-12 00:24:24.604531 MEMORY 12.319117312
Affmat transformed
2024-03-12 00:24:24.617350 MEMORY 12.319117312
sources, targets, weights extracted
2024-03-12 00:24:24.625136 MEMORY 12.319117312
About to launch parallel Leiden runs
2024-03-12 00:24:24.681448 MEMORY 12.319117312
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    3.2s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    9.1s finished
Parallel Leiden runs finished
2024-03-12 00:24:33.832216 MEMORY 12.319117312
Quality: 0.46880590786789506
Quality: 0.4698085650747093
Quality: 0.4701022689184383
Quality: 0.4704456171195778
Quality: 0.47051930144566784
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 679 out of 679 | elapsed:    0.3s finished
Got subclusters: Counter({0: 207, 1: 200, 2: 197, 3: 164, 4: 140, 5: 125})
On pattern 1
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 679 samples in 0.005s...
[t-SNE] Computed neighbors for 679 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 679 / 679
[t-SNE] Mean sigma: 0.330690
[t-SNE] Computed conditional probabilities in 0.051s
[t-SNE] Iteration 50: error = 66.0809021, gradient norm = 0.4289135 (50 iterations in 0.062s)
[t-SNE] Iteration 100: error = 68.5757141, gradient norm = 0.3949916 (50 iterations in 0.063s)
[t-SNE] Iteration 150: error = 69.0426025, gradient norm = 0.3908129 (50 iterations in 0.064s)
[t-SNE] Iteration 200: error = 69.7331314, gradient norm = 0.3849629 (50 iterations in 0.063s)
[t-SNE] Iteration 250: error = 68.0890961, gradient norm = 0.3949068 (50 iterations in 0.063s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 68.089096
[t-SNE] Iteration 300: error = 1.4157593, gradient norm = 0.0024188 (50 iterations in 0.061s)
[t-SNE] Iteration 350: error = 1.3572580, gradient norm = 0.0007750 (50 iterations in 0.058s)
[t-SNE] Iteration 400: error = 1.3392930, gradient norm = 0.0004110 (50 iterations in 0.058s)
[t-SNE] Iteration 450: error = 1.3249472, gradient norm = 0.0005010 (50 iterations in 0.060s)
[t-SNE] Iteration 500: error = 1.3197346, gradient norm = 0.0002428 (50 iterations in 0.058s)
[t-SNE] Iteration 550: error = 1.3171288, gradient norm = 0.0001153 (50 iterations in 0.059s)
[t-SNE] Iteration 600: error = 1.3162197, gradient norm = 0.0001444 (50 iterations in 0.058s)
[t-SNE] Iteration 650: error = 1.3131982, gradient norm = 0.0002433 (50 iterations in 0.058s)
[t-SNE] Iteration 700: error = 1.3085090, gradient norm = 0.0002184 (50 iterations in 0.059s)
[t-SNE] Iteration 750: error = 1.3019819, gradient norm = 0.0003652 (50 iterations in 0.058s)
[t-SNE] Iteration 800: error = 1.2999715, gradient norm = 0.0001025 (50 iterations in 0.058s)
[t-SNE] Iteration 850: error = 1.2987447, gradient norm = 0.0000830 (50 iterations in 0.058s)
[t-SNE] Iteration 900: error = 1.2980818, gradient norm = 0.0000577 (50 iterations in 0.058s)
[t-SNE] Iteration 950: error = 1.2977717, gradient norm = 0.0000544 (50 iterations in 0.058s)
[t-SNE] Iteration 1000: error = 1.2975135, gradient norm = 0.0000475 (50 iterations in 0.058s)
[t-SNE] KL divergence after 1000 iterations: 1.297513
[t-SNE] Computed conditional probabilities for sample 679 / 679
[t-SNE] Mean sigma: 0.330690
Beginning preprocessing + Leiden
2024-03-12 00:24:36.210288 MEMORY 12.319117312
Affmat transformed
2024-03-12 00:24:36.218736 MEMORY 12.319117312
sources, targets, weights extracted
2024-03-12 00:24:36.223529 MEMORY 12.319117312
About to launch parallel Leiden runs
2024-03-12 00:24:36.284910 MEMORY 12.319117312
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.9s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    6.0s finished
Parallel Leiden runs finished
2024-03-12 00:24:42.335452 MEMORY 12.319117312
Quality: 0.4497918668804605
Quality: 0.450712715569112
Quality: 0.45162735197595955
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 576 out of 576 | elapsed:    0.2s finished
Got subclusters: Counter({0: 171, 1: 142, 2: 138, 3: 117, 4: 70, 5: 41})
On pattern 2
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 576 samples in 0.004s...
[t-SNE] Computed neighbors for 576 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 576 / 576
[t-SNE] Mean sigma: 0.317195
[t-SNE] Computed conditional probabilities in 0.040s
[t-SNE] Iteration 50: error = 67.2577209, gradient norm = 0.4367465 (50 iterations in 0.055s)
[t-SNE] Iteration 100: error = 69.6136856, gradient norm = 0.4058009 (50 iterations in 0.056s)
[t-SNE] Iteration 150: error = 66.7815170, gradient norm = 0.4411076 (50 iterations in 0.057s)
[t-SNE] Iteration 200: error = 67.6727829, gradient norm = 0.4402045 (50 iterations in 0.056s)
[t-SNE] Iteration 250: error = 68.0517197, gradient norm = 0.4343227 (50 iterations in 0.056s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 68.051720
[t-SNE] Iteration 300: error = 1.3493267, gradient norm = 0.0034299 (50 iterations in 0.055s)
[t-SNE] Iteration 350: error = 1.2841424, gradient norm = 0.0007234 (50 iterations in 0.051s)
[t-SNE] Iteration 400: error = 1.2463732, gradient norm = 0.0011287 (50 iterations in 0.051s)
[t-SNE] Iteration 450: error = 1.2258558, gradient norm = 0.0003722 (50 iterations in 0.051s)
[t-SNE] Iteration 500: error = 1.2215370, gradient norm = 0.0003495 (50 iterations in 0.050s)
[t-SNE] Iteration 550: error = 1.2190368, gradient norm = 0.0001044 (50 iterations in 0.050s)
[t-SNE] Iteration 600: error = 1.2184174, gradient norm = 0.0001000 (50 iterations in 0.050s)
[t-SNE] Iteration 650: error = 1.2177123, gradient norm = 0.0001306 (50 iterations in 0.050s)
[t-SNE] Iteration 700: error = 1.2175736, gradient norm = 0.0001289 (50 iterations in 0.051s)
[t-SNE] Iteration 750: error = 1.2173071, gradient norm = 0.0000572 (50 iterations in 0.050s)
[t-SNE] Iteration 800: error = 1.2171376, gradient norm = 0.0000506 (50 iterations in 0.050s)
[t-SNE] Iteration 850: error = 1.2171268, gradient norm = 0.0000457 (50 iterations in 0.050s)
[t-SNE] Iteration 900: error = 1.2170914, gradient norm = 0.0000488 (50 iterations in 0.050s)
[t-SNE] Iteration 950: error = 1.2170852, gradient norm = 0.0000643 (50 iterations in 0.050s)
[t-SNE] Iteration 1000: error = 1.2169778, gradient norm = 0.0000389 (50 iterations in 0.050s)
[t-SNE] KL divergence after 1000 iterations: 1.216978
[t-SNE] Computed conditional probabilities for sample 576 / 576
[t-SNE] Mean sigma: 0.317195
Beginning preprocessing + Leiden
2024-03-12 00:24:44.279907 MEMORY 12.319117312
Affmat transformed
2024-03-12 00:24:44.287323 MEMORY 12.319117312
sources, targets, weights extracted
2024-03-12 00:24:44.291528 MEMORY 12.319117312
About to launch parallel Leiden runs
2024-03-12 00:24:44.337773 MEMORY 12.319117312
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    5.4s finished
Parallel Leiden runs finished
2024-03-12 00:24:49.707947 MEMORY 12.319117312
Quality: 0.42536442626050447
Quality: 0.42575289478553124
Quality: 0.4259096135853163
Quality: 0.4267945850377464
Quality: 0.4280382797682082
Quality: 0.42935826484678324
Quality: 0.4306445987061791
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  66 out of 113 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=24)]: Done 113 out of 113 | elapsed:    0.0s finished
Got subclusters: Counter({0: 136, 1: 128, 2: 91, 3: 76, 4: 76, 5: 69})
On pattern 3
[t-SNE] Computing 112 nearest neighbors...
[t-SNE] Indexed 113 samples in 0.001s...
[t-SNE] Computed neighbors for 113 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 113 / 113
[t-SNE] Mean sigma: 0.466471
[t-SNE] Computed conditional probabilities in 0.006s
[t-SNE] Iteration 50: error = 53.1103096, gradient norm = 0.5107132 (50 iterations in 0.020s)
[t-SNE] Iteration 100: error = 52.7162323, gradient norm = 0.4959784 (50 iterations in 0.019s)
[t-SNE] Iteration 150: error = 53.5094566, gradient norm = 0.4749650 (50 iterations in 0.019s)
[t-SNE] Iteration 200: error = 52.3997269, gradient norm = 0.5764512 (50 iterations in 0.019s)
[t-SNE] Iteration 250: error = 54.9532661, gradient norm = 0.5488532 (50 iterations in 0.019s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 54.953266
[t-SNE] Iteration 300: error = 0.7788050, gradient norm = 0.0094829 (50 iterations in 0.018s)
[t-SNE] Iteration 350: error = 0.3932167, gradient norm = 0.0129069 (50 iterations in 0.018s)
[t-SNE] Iteration 400: error = 0.3471493, gradient norm = 0.0008592 (50 iterations in 0.019s)
[t-SNE] Iteration 450: error = 0.3471483, gradient norm = 0.0003976 (50 iterations in 0.049s)
[t-SNE] Iteration 500: error = 0.3473491, gradient norm = 0.0004420 (50 iterations in 0.020s)
[t-SNE] Iteration 550: error = 0.3471465, gradient norm = 0.0004150 (50 iterations in 0.018s)
[t-SNE] Iteration 600: error = 0.3470770, gradient norm = 0.0003587 (50 iterations in 0.019s)
[t-SNE] Iteration 650: error = 0.3472467, gradient norm = 0.0004073 (50 iterations in 0.018s)
[t-SNE] Iteration 700: error = 0.3472764, gradient norm = 0.0003939 (50 iterations in 0.018s)
[t-SNE] Iteration 750: error = 0.3471761, gradient norm = 0.0005832 (50 iterations in 0.018s)
[t-SNE] Iteration 800: error = 0.3472284, gradient norm = 0.0003696 (50 iterations in 0.019s)
[t-SNE] Iteration 850: error = 0.3472339, gradient norm = 0.0003285 (50 iterations in 0.018s)
[t-SNE] Iteration 900: error = 0.3471988, gradient norm = 0.0002737 (50 iterations in 0.019s)
[t-SNE] Iteration 950: error = 0.3473116, gradient norm = 0.0004327 (50 iterations in 0.019s)
[t-SNE] Iteration 950: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 950 iterations: 0.347312
[t-SNE] Computed conditional probabilities for sample 113 / 113
[t-SNE] Mean sigma: 0.466471
Beginning preprocessing + Leiden
2024-03-12 00:24:50.322008 MEMORY 12.319117312
Affmat transformed
2024-03-12 00:24:50.323606 MEMORY 12.319117312
sources, targets, weights extracted
2024-03-12 00:24:50.324293 MEMORY 12.319117312
About to launch parallel Leiden runs
2024-03-12 00:24:50.352053 MEMORY 12.319117312
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.8s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.1s finished
Parallel Leiden runs finished
2024-03-12 00:24:52.486427 MEMORY 12.319117312
Quality: 0.28343103403661096
Quality: 0.2846693275749087
Got subclusters: Counter({0: 41, 1: 31, 2: 31, 3: 10})
On metacluster 3
Metacluster size 7812
Relevant tasks:  ('head',)
Relevant signs:  (1,)
TfModiscoSeqletsToPatternsFactory: seed=1234
(Round 1) num seqlets: 7812
(Round 1) Computing coarse affmat
2024-03-12 00:24:54.107552 MEMORY 12.319117312
Beginning embedding computation
MEMORY 12.319117312
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 152 tasks      | elapsed:    2.4s
[Parallel(n_jobs=24)]: Done 402 tasks      | elapsed:    5.8s
[Parallel(n_jobs=24)]: Done 752 tasks      | elapsed:   10.6s
[Parallel(n_jobs=24)]: Done 1202 tasks      | elapsed:   16.7s
[Parallel(n_jobs=24)]: Done 1752 tasks      | elapsed:   24.0s
[Parallel(n_jobs=24)]: Done 2402 tasks      | elapsed:   32.7s
[Parallel(n_jobs=24)]: Done 3152 tasks      | elapsed:   43.2s
[Parallel(n_jobs=24)]: Done 4002 tasks      | elapsed:   54.9s
[Parallel(n_jobs=24)]: Done 4952 tasks      | elapsed:  1.1min
[Parallel(n_jobs=24)]: Done 6002 tasks      | elapsed:  1.4min
[Parallel(n_jobs=24)]: Done 7152 tasks      | elapsed:  1.6min
[Parallel(n_jobs=24)]: Done 7812 out of 7812 | elapsed:  1.8min finished
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 152 tasks      | elapsed:    2.3s
[Parallel(n_jobs=24)]: Done 402 tasks      | elapsed:    5.7s
[Parallel(n_jobs=24)]: Done 752 tasks      | elapsed:   10.5s
[Parallel(n_jobs=24)]: Done 1202 tasks      | elapsed:   16.6s
[Parallel(n_jobs=24)]: Done 1752 tasks      | elapsed:   24.0s
[Parallel(n_jobs=24)]: Done 2402 tasks      | elapsed:   33.0s
[Parallel(n_jobs=24)]: Done 3152 tasks      | elapsed:   43.3s
[Parallel(n_jobs=24)]: Done 4002 tasks      | elapsed:   54.8s
[Parallel(n_jobs=24)]: Done 4952 tasks      | elapsed:  1.1min
[Parallel(n_jobs=24)]: Done 6002 tasks      | elapsed:  1.4min
[Parallel(n_jobs=24)]: Done 7152 tasks      | elapsed:  1.6min
[Parallel(n_jobs=24)]: Done 7812 out of 7812 | elapsed:  1.8min finished
At the beginning of embedding call
2024-03-12 00:24:54.107984 MEMORY 12.319117312
before computing embeddings fwd
2024-03-12 00:24:54.118101 MEMORY 12.319117312
after computing embeddings fwd
2024-03-12 00:26:41.302965 MEMORY 12.485378048
after computing embeddings rev
2024-03-12 00:28:27.924503 MEMORY 12.804399104
before computing sparse embeddings fwd
2024-03-12 00:28:27.924633 MEMORY 12.804399104
Constructing csr matrix...
csr matrix made in 1.088963270187378 s
after computing sparse embeddings fwd
2024-03-12 00:28:29.387612 MEMORY 12.804640768
before computing sparse embeddings rev
2024-03-12 00:28:29.387742 MEMORY 12.804640768
Constructing csr matrix...
csr matrix made in 1.0012528896331787 s
after computing sparse embeddings rev
2024-03-12 00:28:30.724985 MEMORY 12.804640768
Finished embedding computation in 217.92 s
MEMORY 12.497408
Starting affinity matrix computations
MEMORY 12.497408
Batching in slices of size 7812
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:07<00:00,  7.53s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:07<00:00,  7.53s/it]
Finished affinity matrix computations in 7.59 s
MEMORY 12.497408
(Round 1) Computed coarse affmat
2024-03-12 00:28:40.622735 MEMORY 12.497117184
(Round 1) Computing affinity matrix on nearest neighbors
2024-03-12 00:28:40.622940 MEMORY 12.497117184
Launching nearest neighbors affmat calculation job
MEMORY 12.497117184
Parallel runs completed
MEMORY 12.57166848
Job completed in: 26.7 s
MEMORY 12.57043968
Launching nearest neighbors affmat calculation job
MEMORY 12.5688832
Parallel runs completed
MEMORY 12.677480448
Job completed in: 26.9 s
MEMORY 12.676632576
(Round 1) Computed affinity matrix on nearest neighbors in 55.92 s
2024-03-12 00:29:36.547755 MEMORY 12.67472384
Filtered down to 7409 of 7812
(Round 1) Retained 7409 rows out of 7812 after filtering
2024-03-12 00:29:41.589745 MEMORY 12.67472384
(Round 1) Computing density adapted affmat
2024-03-12 00:29:44.577081 MEMORY 12.701720576
Symmetrizing nearest neighbors
Computing betas for density adaptation
Computing normalizing denominators
(Round 1) Computing clustering
2024-03-12 00:30:48.319543 MEMORY 12.805394432
Beginning preprocessing + Leiden
2024-03-12 00:30:48.330618 MEMORY 12.805394432
Affmat transformed
2024-03-12 00:30:48.330836 MEMORY 12.805394432
sources, targets, weights extracted
2024-03-12 00:30:48.571927 MEMORY 12.805394432
About to launch parallel Leiden runs
2024-03-12 00:30:48.687173 MEMORY 12.805394432
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:   40.5s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:  2.6min finished
Parallel Leiden runs finished
2024-03-12 00:33:24.154889 MEMORY 12.808384512
Quality: 0.3492622618713979
Quality: 0.34928302971823344
Quality: 0.34928472361913065
Got 6 clusters after round 1
Counts:
{3: 1191, 2: 1552, 1: 1671, 5: 424, 0: 1791, 4: 780}
2024-03-12 00:33:24.180011 MEMORY 12.808384512
(Round 1) Aggregating seqlets in each cluster
2024-03-12 00:33:24.180130 MEMORY 12.808384512
Aggregating for cluster 0 with 1791 seqlets
2024-03-12 00:33:24.186727 MEMORY 12.808384512
Removed 4 duplicate seqlets
Skipped 6 due to duplicates
Trimming eliminated 0 seqlets out of 1781
Removed 1 duplicate seqlets
Aggregating for cluster 1 with 1671 seqlets
2024-03-12 00:33:29.236498 MEMORY 12.808507392
Skipped 5 due to duplicates
Trimming eliminated 0 seqlets out of 1666
Aggregating for cluster 2 with 1552 seqlets
2024-03-12 00:33:34.746739 MEMORY 12.808507392
Skipped 2 due to duplicates
Trimming eliminated 0 seqlets out of 1550
Aggregating for cluster 3 with 1191 seqlets
2024-03-12 00:33:38.839332 MEMORY 12.808507392
Skipped 2 due to duplicates
Trimming eliminated 0 seqlets out of 1189
Removed 1 duplicate seqlets
Aggregating for cluster 4 with 780 seqlets
2024-03-12 00:33:42.050499 MEMORY 12.808507392
Skipped 1 seqlets that went over sequence edge during flank expansion
Trimming eliminated 0 seqlets out of 779
Aggregating for cluster 5 with 424 seqlets
2024-03-12 00:33:44.383204 MEMORY 12.808507392
Trimming eliminated 0 seqlets out of 424
Dropping cluster 5 with 424 seqlets due to sign disagreement
(Round 2) num seqlets: 6963
(Round 2) Computing coarse affmat
2024-03-12 00:33:46.811369 MEMORY 12.808507392
Beginning embedding computation
MEMORY 12.808507392
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 272 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done 1272 tasks      | elapsed:    2.2s
[Parallel(n_jobs=24)]: Done 2672 tasks      | elapsed:    4.4s
[Parallel(n_jobs=24)]: Done 4472 tasks      | elapsed:    7.2s
[Parallel(n_jobs=24)]: Done 6672 tasks      | elapsed:   10.8s
[Parallel(n_jobs=24)]: Done 6916 out of 6963 | elapsed:   11.1s remaining:    0.1s
[Parallel(n_jobs=24)]: Done 6963 out of 6963 | elapsed:   11.1s finished
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 320 tasks      | elapsed:    0.8s
[Parallel(n_jobs=24)]: Done 2256 tasks      | elapsed:    3.1s
[Parallel(n_jobs=24)]: Done 5056 tasks      | elapsed:    6.4s
[Parallel(n_jobs=24)]: Done 6963 out of 6963 | elapsed:    8.6s finished
At the beginning of embedding call
2024-03-12 00:33:46.811670 MEMORY 12.808507392
before computing embeddings fwd
2024-03-12 00:33:46.822869 MEMORY 12.808507392
after computing embeddings fwd
2024-03-12 00:33:57.957830 MEMORY 13.05544704
after computing embeddings rev
2024-03-12 00:34:06.547930 MEMORY 13.339561984
before computing sparse embeddings fwd
2024-03-12 00:34:06.548045 MEMORY 13.339561984
Constructing csr matrix...
csr matrix made in 0.96608567237854 s
after computing sparse embeddings fwd
2024-03-12 00:34:07.859271 MEMORY 13.339779072
before computing sparse embeddings rev
2024-03-12 00:34:07.859398 MEMORY 13.339779072
Constructing csr matrix...
csr matrix made in 0.882601261138916 s
after computing sparse embeddings rev
2024-03-12 00:34:08.992411 MEMORY 13.339779072
Finished embedding computation in 23.7 s
MEMORY 13.05778176
Starting affinity matrix computations
MEMORY 13.05778176
Batching in slices of size 6963
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:08<00:00,  8.33s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:08<00:00,  8.33s/it]
Finished affinity matrix computations in 8.36 s
MEMORY 13.05778176
(Round 2) Computed coarse affmat
2024-03-12 00:34:19.923884 MEMORY 13.057273856
(Round 2) Computing affinity matrix on nearest neighbors
2024-03-12 00:34:19.924116 MEMORY 13.057273856
Launching nearest neighbors affmat calculation job
MEMORY 13.057273856
Parallel runs completed
MEMORY 13.078540288
Job completed in: 14.83 s
MEMORY 13.076217856
Launching nearest neighbors affmat calculation job
MEMORY 13.076217856
Parallel runs completed
MEMORY 13.099053056
Job completed in: 13.32 s
MEMORY 13.09876224
(Round 2) Computed affinity matrix on nearest neighbors in 30.44 s
2024-03-12 00:34:50.387839 MEMORY 13.050630144
Not applying filtering for rounds above first round
2024-03-12 00:34:50.389794 MEMORY 13.050630144
(Round 2) Computing density adapted affmat
2024-03-12 00:34:53.019630 MEMORY 13.057933312
Symmetrizing nearest neighbors
Computing betas for density adaptation
Computing normalizing denominators
(Round 2) Computing clustering
2024-03-12 00:35:53.572125 MEMORY 13.047779328
Beginning preprocessing + Leiden
2024-03-12 00:35:53.583391 MEMORY 13.047779328
Affmat transformed
2024-03-12 00:35:53.583585 MEMORY 13.047779328
sources, targets, weights extracted
2024-03-12 00:35:53.813540 MEMORY 13.047779328
About to launch parallel Leiden runs
2024-03-12 00:35:53.916321 MEMORY 13.047779328
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:   32.1s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:  1.8min finished
Parallel Leiden runs finished
2024-03-12 00:37:41.375361 MEMORY 13.047779328
Quality: 0.457269349318921
Got 4 clusters after round 2
Counts:
{1: 1736, 3: 1321, 0: 2357, 2: 1549}
2024-03-12 00:37:41.398175 MEMORY 13.047779328
(Round 2) Aggregating seqlets in each cluster
2024-03-12 00:37:41.398297 MEMORY 13.047779328
Aggregating for cluster 0 with 2357 seqlets
2024-03-12 00:37:41.400943 MEMORY 13.047779328
Skipped 3 due to duplicates
Trimming eliminated 0 seqlets out of 2354
Aggregating for cluster 1 with 1736 seqlets
2024-03-12 00:37:46.177238 MEMORY 13.047779328
Skipped 4 due to duplicates
Trimming eliminated 0 seqlets out of 1732
Aggregating for cluster 2 with 1549 seqlets
2024-03-12 00:37:49.742953 MEMORY 13.047779328
Skipped 1 due to duplicates
Trimming eliminated 0 seqlets out of 1548
Aggregating for cluster 3 with 1321 seqlets
2024-03-12 00:37:53.920277 MEMORY 13.047779328
Skipped 3 due to duplicates
Trimming eliminated 0 seqlets out of 1318
Got 4 clusters
Splitting into subclusters...
2024-03-12 00:37:56.842388 MEMORY 13.047779328
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 2307 out of 2354 | elapsed:    0.6s remaining:    0.0s
[Parallel(n_jobs=24)]: Done 2354 out of 2354 | elapsed:    0.6s finished
Inspecting pattern 0 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 2354
[t-SNE] Computed conditional probabilities for sample 2000 / 2354
[t-SNE] Computed conditional probabilities for sample 2354 / 2354
[t-SNE] Mean sigma: 0.310883
Beginning preprocessing + Leiden
2024-03-12 00:38:00.063842 MEMORY 13.047906304
Affmat transformed
2024-03-12 00:38:00.099788 MEMORY 13.047906304
sources, targets, weights extracted
2024-03-12 00:38:00.121022 MEMORY 13.047906304
About to launch parallel Leiden runs
2024-03-12 00:38:00.162978 MEMORY 13.047906304
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    9.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   33.0s finished
Parallel Leiden runs finished
2024-03-12 00:38:33.143079 MEMORY 13.047906304
Quality: 0.4680343176295759
Quality: 0.47106087239469985
Quality: 0.4712974900592632
Quality: 0.47199157902430083
Quality: 0.472301731758394
Quality: 0.47307385567762805
Quality: 0.4734777571673848
Quality: 0.473605744679375
Got subclusters: Counter({0: 434, 1: 362, 2: 332, 3: 310, 4: 280, 5: 267, 6: 254, 7: 51, 8: 41, 9: 23})
On merging iteration 1
Numbers for each pattern pre-subsample: [434, 362, 332, 310, 280, 267, 254, 51, 41, 23]
Numbers after subsampling: [300, 300, 300, 300, 280, 267, 254, 51, 41, 23]
Computing sims for pattern 0
Computed sims for pattern 0 in 2.853384256362915 s
Computing sims for pattern 1
Computed sims for pattern 1 in 2.9216341972351074 s
Computing sims for pattern 2
Computed sims for pattern 2 in 2.9072370529174805 s
Computing sims for pattern 3
Computed sims for pattern 3 in 2.9414749145507812 s
Computing sims for pattern 4
Computed sims for pattern 4 in 2.686988115310669 s
Computing sims for pattern 5
Computed sims for pattern 5 in 2.656818151473999 s
Computing sims for pattern 6
Computed sims for pattern 6 in 2.3917346000671387 s
Computing sims for pattern 7
Computed sims for pattern 7 in 0.7466070652008057 s
Computing sims for pattern 8
Computed sims for pattern 8 in 0.6490154266357422 s
Computing sims for pattern 9
Computed sims for pattern 9 in 0.4754960536956787 s
Cluster sizes
[434 362 332 310 280 267 254  51  41  23]
Cross-contamination matrix:
[[1.   0.58 0.61 0.78 0.5  0.48 0.66 0.45 0.48 0.54]
 [0.65 1.   0.73 1.   0.72 0.64 0.88 0.78 0.53 0.73]
 [0.53 0.61 1.   1.   0.7  0.62 0.77 0.64 0.51 0.68]
 [0.32 0.4  0.54 1.   0.45 0.41 0.53 0.38 0.27 0.39]
 [0.56 0.68 0.79 1.   1.   0.61 0.82 0.57 0.66 0.65]
 [0.65 0.67 0.76 1.   0.69 1.   0.84 0.73 0.78 0.77]
 [0.5  0.64 0.67 0.98 0.61 0.57 1.   0.61 0.52 0.53]
 [0.55 0.59 0.57 0.76 0.41 0.53 0.64 1.   0.36 0.54]
 [0.53 0.49 0.55 0.8  0.64 0.68 0.69 0.44 1.   0.45]
 [0.34 0.47 0.53 0.73 0.44 0.47 0.49 0.45 0.34 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.85 0.83 0.84 0.8  0.82 0.8  0.75 0.81 0.76]
 [0.85 1.   0.89 0.93 0.88 0.85 0.9  0.82 0.86 0.82]
 [0.83 0.89 1.   0.95 0.93 0.87 0.92 0.8  0.84 0.88]
 [0.84 0.93 0.95 1.   0.9  0.91 0.92 0.82 0.83 0.86]
 [0.8  0.88 0.93 0.9  1.   0.83 0.89 0.75 0.88 0.85]
 [0.82 0.85 0.87 0.91 0.83 1.   0.87 0.81 0.9  0.85]
 [0.8  0.9  0.92 0.92 0.89 0.87 1.   0.78 0.84 0.84]
 [0.75 0.82 0.8  0.82 0.75 0.81 0.78 1.   0.77 0.75]
 [0.81 0.86 0.84 0.83 0.88 0.9  0.84 0.77 1.   0.77]
 [0.76 0.82 0.88 0.86 0.85 0.85 0.84 0.75 0.77 1.  ]]
Collapsing 2 & 3 with crosscontam 0.5422165002469137 and sim 0.9516223359622962
Collapsing 2 & 4 with crosscontam 0.7025960402116402 and sim 0.9258171907462296
Collapsing 1 & 3 with crosscontam 0.40382289975308616 and sim 0.9252273844773499
Collapsing 3 & 6 with crosscontam 0.5343459434237388 and sim 0.9223702628757027
Collapsing 2 & 6 with crosscontam 0.6701647030853115 and sim 0.9200005355867882
Collapsing 3 & 5 with crosscontam 0.41225260424469434 and sim 0.913609429008206
Collapsing 3 & 4 with crosscontam 0.4499245386243387 and sim 0.9048684874328916
Collapsing 5 & 8 with crosscontam 0.6764994519318024 and sim 0.8993805515540986
Collapsing 1 & 6 with crosscontam 0.6369076893009431 and sim 0.8986100729666939
Collapsing 1 & 2 with crosscontam 0.612206704691358 and sim 0.8945713871909692
Collapsing 4 & 6 with crosscontam 0.6134306914283121 and sim 0.8906210525569184
Collapsing 2 & 9 with crosscontam 0.5263307854579327 and sim 0.8813444788371789
Collapsing 1 & 4 with crosscontam 0.6795862943391642 and sim 0.8790299009099476
Collapsing 4 & 8 with crosscontam 0.6416694476284439 and sim 0.8751720109138332
Collapsing 2 & 5 with crosscontam 0.620834535164378 and sim 0.8748141717352405
Collapsing 5 & 6 with crosscontam 0.5729090183002685 and sim 0.8744948213694744
Trimming eliminated 0 seqlets out of 642
Trimming eliminated 0 seqlets out of 922
Trimming eliminated 0 seqlets out of 1284
Trimming eliminated 0 seqlets out of 1538
Removed 1 duplicate seqlets
Trimming eliminated 0 seqlets out of 1804
Trimming eliminated 0 seqlets out of 1845
Trimming eliminated 0 seqlets out of 1868
Unmerged patterns remapping: OrderedDict([(0, 1), (7, 2)])
Time spent on merging iteration: 19.010608911514282
On merging iteration 2
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 1650 tasks      | elapsed:    0.4s
[Parallel(n_jobs=24)]: Done 1732 out of 1732 | elapsed:    0.4s finished
Numbers for each pattern pre-subsample: [1868, 434, 51]
Numbers after subsampling: [300, 300, 51]
Computing sims for pattern 0
Computed sims for pattern 0 in 0.6494696140289307 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.3607306480407715 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.09771728515625 s
Cluster sizes
[1868  434   51]
Cross-contamination matrix:
[[1.   0.75 0.8 ]
 [0.63 1.   0.45]
 [0.56 0.55 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.84 0.81]
 [0.84 1.   0.75]
 [0.81 0.75 1.  ]]
Inspecting pattern 1 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 1732
[t-SNE] Computed conditional probabilities for sample 1732 / 1732
[t-SNE] Mean sigma: 0.342373
Beginning preprocessing + Leiden
2024-03-12 00:39:17.300837 MEMORY 13.050904576
Affmat transformed
2024-03-12 00:39:17.326700 MEMORY 13.050904576
sources, targets, weights extracted
2024-03-12 00:39:17.339170 MEMORY 13.050904576
About to launch parallel Leiden runs
2024-03-12 00:39:17.452663 MEMORY 13.050904576
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    5.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   19.4s finished
Parallel Leiden runs finished
2024-03-12 00:39:36.869493 MEMORY 13.050904576
Quality: 0.47640672387298433
Quality: 0.47799567423872663
Quality: 0.4792835680404166
Quality: 0.4812417616559625
Quality: 0.48127222630015254
Got subclusters: Counter({0: 342, 1: 283, 2: 262, 3: 229, 4: 184, 5: 162, 6: 128, 7: 112, 8: 30})
On merging iteration 1
Numbers for each pattern pre-subsample: [342, 283, 262, 229, 184, 162, 128, 112, 30]
Numbers after subsampling: [300, 283, 262, 229, 184, 162, 128, 112, 30]
Computing sims for pattern 0
Computed sims for pattern 0 in 2.5297491550445557 s
Computing sims for pattern 1
Computed sims for pattern 1 in 2.391972541809082 s
Computing sims for pattern 2
Computed sims for pattern 2 in 2.1343417167663574 s
Computing sims for pattern 3
Computed sims for pattern 3 in 2.3666443824768066 s
Computing sims for pattern 4
Computed sims for pattern 4 in 1.7849647998809814 s
Computing sims for pattern 5
Computed sims for pattern 5 in 1.5530736446380615 s
Computing sims for pattern 6
Computed sims for pattern 6 in 1.3750505447387695 s
Computing sims for pattern 7
Computed sims for pattern 7 in 1.1467602252960205 s
Computing sims for pattern 8
Computed sims for pattern 8 in 0.457277774810791 s
Cluster sizes
[342 283 262 229 184 162 128 112  30]
Cross-contamination matrix:
[[1.   0.67 0.45 0.65 0.65 0.49 0.53 0.65 0.12]
 [0.61 1.   0.54 0.54 0.4  0.54 0.52 0.63 0.2 ]
 [0.64 0.82 1.   0.59 0.52 0.65 0.59 0.74 0.28]
 [0.51 0.5  0.48 1.   0.49 0.52 0.66 0.59 0.19]
 [0.68 0.49 0.37 0.45 1.   0.4  0.38 0.44 0.22]
 [0.58 0.78 0.62 0.56 0.53 1.   0.6  0.73 0.29]
 [0.55 0.61 0.43 0.62 0.39 0.46 1.   0.65 0.21]
 [0.71 0.76 0.6  0.6  0.48 0.61 0.68 1.   0.19]
 [0.43 0.57 0.46 0.46 0.54 0.51 0.48 0.45 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.77 0.81 0.78 0.71 0.76 0.75 0.84 0.53]
 [0.77 1.   0.87 0.75 0.62 0.83 0.76 0.85 0.67]
 [0.81 0.87 1.   0.78 0.66 0.83 0.77 0.88 0.61]
 [0.78 0.75 0.78 1.   0.55 0.76 0.8  0.8  0.52]
 [0.71 0.62 0.66 0.55 1.   0.62 0.62 0.63 0.68]
 [0.76 0.83 0.83 0.76 0.62 1.   0.79 0.86 0.71]
 [0.75 0.76 0.77 0.8  0.62 0.79 1.   0.81 0.62]
 [0.84 0.85 0.88 0.8  0.63 0.86 0.81 1.   0.61]
 [0.53 0.67 0.61 0.52 0.68 0.71 0.62 0.61 1.  ]]
Collapsing 2 & 7 with crosscontam 0.6004391803664624 and sim 0.8766235330532437
Collapsing 1 & 2 with crosscontam 0.5391194605768299 and sim 0.8738117738708305
Collapsing 5 & 7 with crosscontam 0.612728346133427 and sim 0.8617608116125421
Trimming eliminated 0 seqlets out of 374
Trimming eliminated 0 seqlets out of 657
Skipped 1 due to duplicates
Trimming eliminated 0 seqlets out of 818
Unmerged patterns remapping: OrderedDict([(0, 1), (3, 2), (4, 3), (6, 4), (8, 5)])
Time spent on merging iteration: 5.024006605148315
On merging iteration 2
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 1548 out of 1548 | elapsed:    0.5s finished
Numbers for each pattern pre-subsample: [818, 342, 229, 184, 128, 30]
Numbers after subsampling: [300, 300, 229, 184, 128, 30]
Computing sims for pattern 0
Computed sims for pattern 0 in 1.6329548358917236 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.3761885166168213 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.3280601501464844 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.25776052474975586 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.19426441192626953 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.07031393051147461 s
Cluster sizes
[818 342 229 184 128  30]
Cross-contamination matrix:
[[1.   0.88 0.8  0.67 0.82 0.38]
 [0.56 1.   0.65 0.65 0.53 0.12]
 [0.51 0.51 1.   0.49 0.66 0.19]
 [0.4  0.68 0.45 1.   0.38 0.22]
 [0.53 0.55 0.62 0.39 1.   0.21]
 [0.49 0.43 0.46 0.54 0.48 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.84 0.81 0.66 0.81 0.67]
 [0.84 1.   0.78 0.71 0.75 0.53]
 [0.81 0.78 1.   0.55 0.8  0.52]
 [0.66 0.71 0.55 1.   0.62 0.68]
 [0.81 0.75 0.8  0.62 1.   0.62]
 [0.67 0.53 0.52 0.68 0.62 1.  ]]
Inspecting pattern 2 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 1548
[t-SNE] Computed conditional probabilities for sample 1548 / 1548
[t-SNE] Mean sigma: 0.355920
Beginning preprocessing + Leiden
2024-03-12 00:40:02.895304 MEMORY 13.054275584
Affmat transformed
2024-03-12 00:40:02.916343 MEMORY 13.054275584
sources, targets, weights extracted
2024-03-12 00:40:02.928687 MEMORY 13.054275584
About to launch parallel Leiden runs
2024-03-12 00:40:02.975165 MEMORY 13.054275584
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    5.2s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   18.4s finished
Parallel Leiden runs finished
2024-03-12 00:40:21.333326 MEMORY 13.054275584
Quality: 0.4658986454800187
Quality: 0.46749002442102455
Got subclusters: Counter({0: 309, 1: 263, 2: 230, 3: 227, 4: 202, 5: 174, 6: 87, 7: 56})
On merging iteration 1
Numbers for each pattern pre-subsample: [309, 263, 230, 227, 202, 174, 87, 56]
Numbers after subsampling: [300, 263, 230, 227, 202, 174, 87, 56]
Computing sims for pattern 0
Computed sims for pattern 0 in 2.3211066722869873 s
Computing sims for pattern 1
Computed sims for pattern 1 in 1.97249436378479 s
Computing sims for pattern 2
Computed sims for pattern 2 in 2.075763702392578 s
Computing sims for pattern 3
Computed sims for pattern 3 in 2.0760490894317627 s
Computing sims for pattern 4
Computed sims for pattern 4 in 1.7711105346679688 s
Computing sims for pattern 5
Computed sims for pattern 5 in 1.4622101783752441 s
Computing sims for pattern 6
Computed sims for pattern 6 in 0.9081764221191406 s
Computing sims for pattern 7
Computed sims for pattern 7 in 0.6336469650268555 s
Cluster sizes
[309 263 230 227 202 174  87  56]
Cross-contamination matrix:
[[1.   0.77 0.74 0.63 0.59 0.66 0.51 0.79]
 [0.5  1.   0.64 0.7  0.55 0.6  0.4  0.58]
 [0.55 0.72 1.   0.55 0.42 0.67 0.48 0.87]
 [0.56 0.93 0.67 1.   0.61 0.61 0.53 0.82]
 [0.65 0.91 0.67 0.76 1.   0.62 0.48 0.68]
 [0.54 0.75 0.75 0.57 0.45 1.   0.47 0.7 ]
 [0.37 0.47 0.49 0.43 0.29 0.42 1.   0.61]
 [0.32 0.37 0.54 0.4  0.22 0.35 0.34 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.75 0.74 0.65 0.73 0.78 0.61 0.74]
 [0.75 1.   0.75 0.89 0.83 0.85 0.67 0.69]
 [0.74 0.75 1.   0.71 0.64 0.8  0.68 0.85]
 [0.65 0.89 0.71 1.   0.73 0.78 0.66 0.75]
 [0.73 0.83 0.64 0.73 1.   0.65 0.55 0.68]
 [0.78 0.85 0.8  0.78 0.65 1.   0.72 0.73]
 [0.61 0.67 0.68 0.66 0.55 0.72 1.   0.71]
 [0.74 0.69 0.85 0.75 0.68 0.73 0.71 1.  ]]
Collapsing 1 & 3 with crosscontam 0.7037670410822092 and sim 0.8879149727549392
Collapsing 1 & 5 with crosscontam 0.5952530531417368 and sim 0.853563078812334
Collapsing 2 & 7 with crosscontam 0.5406677810875902 and sim 0.8513642756677371
Trimming eliminated 0 seqlets out of 490
Trimming eliminated 0 seqlets out of 664
Trimming eliminated 0 seqlets out of 286
Unmerged patterns remapping: OrderedDict([(0, 1), (4, 3), (6, 4)])
Time spent on merging iteration: 2.937502145767212
On merging iteration 2
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 1318 out of 1318 | elapsed:    0.5s finished
Numbers for each pattern pre-subsample: [664, 309, 286, 202, 87]
Numbers after subsampling: [300, 300, 286, 202, 87]
Computing sims for pattern 0
Computed sims for pattern 0 in 1.3771302700042725 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.7436656951904297 s
Computing sims for pattern 2
Computed sims for pattern 2 in 1.265106201171875 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.5499465465545654 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.27912020683288574 s
Cluster sizes
[664 309 286 202  87]
Cross-contamination matrix:
[[1.   0.75 0.89 0.79 0.68]
 [0.64 1.   0.75 0.59 0.51]
 [0.62 0.57 1.   0.43 0.53]
 [0.76 0.65 0.66 1.   0.48]
 [0.43 0.37 0.51 0.29 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.75 0.78 0.8  0.7 ]
 [0.75 1.   0.75 0.73 0.61]
 [0.78 0.75 1.   0.65 0.7 ]
 [0.8  0.73 0.65 1.   0.55]
 [0.7  0.61 0.7  0.55 1.  ]]
Inspecting pattern 3 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 1318
[t-SNE] Computed conditional probabilities for sample 1318 / 1318
[t-SNE] Mean sigma: 0.335358
Beginning preprocessing + Leiden
2024-03-12 00:40:43.707886 MEMORY 13.054464
Affmat transformed
2024-03-12 00:40:43.725759 MEMORY 13.054464
sources, targets, weights extracted
2024-03-12 00:40:43.737955 MEMORY 13.054464
About to launch parallel Leiden runs
2024-03-12 00:40:43.814284 MEMORY 13.054464
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    4.6s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   14.0s finished
Parallel Leiden runs finished
2024-03-12 00:40:57.803091 MEMORY 13.054464
Quality: 0.4614704876549405
Quality: 0.46234189249830043
Quality: 0.4636611574830345
Quality: 0.463751546512219
Got subclusters: Counter({0: 273, 1: 245, 2: 161, 3: 158, 4: 154, 5: 149, 6: 80, 7: 50, 8: 42, 9: 6})
On merging iteration 1
Numbers for each pattern pre-subsample: [273, 245, 161, 158, 154, 149, 80, 50, 42, 6]
Numbers after subsampling: [273, 245, 161, 158, 154, 149, 80, 50, 42, 6]
Computing sims for pattern 0
Computed sims for pattern 0 in 2.357433795928955 s
Computing sims for pattern 1
Computed sims for pattern 1 in 1.9576029777526855 s
Computing sims for pattern 2
Computed sims for pattern 2 in 1.5166435241699219 s
Computing sims for pattern 3
Computed sims for pattern 3 in 1.4908134937286377 s
Computing sims for pattern 4
Computed sims for pattern 4 in 1.435706377029419 s
Computing sims for pattern 5
Computed sims for pattern 5 in 2.6100540161132812 s
Computing sims for pattern 6
Computed sims for pattern 6 in 0.935429573059082 s
Computing sims for pattern 7
Computed sims for pattern 7 in 0.6246857643127441 s
Computing sims for pattern 8
Computed sims for pattern 8 in 0.5466551780700684 s
Computing sims for pattern 9
Computed sims for pattern 9 in 0.19542455673217773 s
Cluster sizes
[273 245 161 158 154 149  80  50  42   6]
Cross-contamination matrix:
[[1.   0.63 0.68 0.7  0.66 0.68 0.27 0.51 0.25 0.7 ]
 [0.33 1.   0.66 0.72 0.53 0.64 0.41 0.42 0.14 0.29]
 [0.5  0.84 1.   0.78 0.57 0.62 0.61 0.5  0.18 0.27]
 [0.44 0.8  0.68 1.   0.59 0.53 0.31 0.44 0.18 0.22]
 [0.64 0.87 0.74 0.87 1.   0.65 0.25 0.52 0.36 0.45]
 [0.51 0.83 0.47 0.49 0.5  1.   0.48 0.56 0.12 0.35]
 [0.47 0.92 0.99 0.7  0.44 0.83 1.   0.61 0.29 0.36]
 [0.52 0.77 0.71 0.72 0.55 0.73 0.42 1.   0.22 0.34]
 [0.67 0.76 0.72 0.78 0.82 0.65 0.51 0.62 1.   0.54]
 [0.06 0.03 0.01 0.01 0.02 0.01 0.   0.06 0.   1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.66 0.78 0.8  0.83 0.68 0.6  0.77 0.67 0.52]
 [0.66 1.   0.88 0.87 0.78 0.84 0.79 0.71 0.6  0.43]
 [0.78 0.88 1.   0.9  0.82 0.77 0.87 0.85 0.64 0.32]
 [0.8  0.87 0.9  1.   0.91 0.73 0.7  0.8  0.81 0.36]
 [0.83 0.78 0.82 0.91 1.   0.68 0.65 0.77 0.77 0.44]
 [0.68 0.84 0.77 0.73 0.68 1.   0.78 0.75 0.56 0.37]
 [0.6  0.79 0.87 0.7  0.65 0.78 1.   0.69 0.57 0.19]
 [0.77 0.71 0.85 0.8  0.77 0.75 0.69 1.   0.67 0.4 ]
 [0.67 0.6  0.64 0.81 0.77 0.56 0.57 0.67 1.   0.31]
 [0.52 0.43 0.32 0.36 0.44 0.37 0.19 0.4  0.31 1.  ]]
Collapsing 3 & 4 with crosscontam 0.587658498499223 and sim 0.9105797700383713
Collapsing 2 & 3 with crosscontam 0.680127051796477 and sim 0.8973455318365319
Collapsing 1 & 2 with crosscontam 0.6570299549312093 and sim 0.8821364142945576
Collapsing 2 & 6 with crosscontam 0.6059178377875825 and sim 0.8711185132381126
Aborting collapse as 4 & 6 have cross-contam 0.3435555625137586 and sim 0.6549372817789321
Collapsing 1 & 3 with crosscontam 0.7224399081972108 and sim 0.8708954364696506
Collapsing 2 & 7 with crosscontam 0.5039923264213457 and sim 0.8515991631636812
Trimming eliminated 0 seqlets out of 312
Trimming eliminated 0 seqlets out of 473
Removed 1 duplicate seqlets
Trimming eliminated 0 seqlets out of 717
Trimming eliminated 0 seqlets out of 767
Unmerged patterns remapping: OrderedDict([(0, 1), (5, 2), (6, 3), (8, 4), (9, 5)])
Time spent on merging iteration: 3.524240732192993
On merging iteration 2
Numbers for each pattern pre-subsample: [767, 273, 149, 80, 42, 6]
Numbers after subsampling: [300, 273, 149, 80, 42, 6]
Computing sims for pattern 0
Computed sims for pattern 0 in 1.4839017391204834 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.31690144538879395 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.1922435760498047 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.1348567008972168 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.08981728553771973 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.0372161865234375 s
Cluster sizes
[767 273 149  80  42   6]
Cross-contamination matrix:
[[1.   0.7  0.84 0.6  0.37 0.51]
 [0.65 1.   0.68 0.27 0.25 0.7 ]
 [0.61 0.51 1.   0.48 0.12 0.35]
 [0.73 0.47 0.83 1.   0.29 0.36]
 [0.75 0.67 0.65 0.51 1.   0.54]
 [0.02 0.06 0.01 0.   0.   1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.8  0.78 0.74 0.75 0.43]
 [0.8  1.   0.68 0.6  0.67 0.52]
 [0.78 0.68 1.   0.78 0.56 0.37]
 [0.74 0.6  0.78 1.   0.57 0.19]
 [0.75 0.67 0.56 0.57 1.   0.31]
 [0.43 0.52 0.37 0.19 0.31 1.  ]]
Merging on 20 clusters
2024-03-12 00:41:17.527808 MEMORY 13.054464
On merging iteration 1
Numbers for each pattern pre-subsample: [1868, 434, 51, 818, 342, 229, 184, 128, 30, 664, 309, 286, 202, 87, 767, 273, 149, 80, 42, 6]
Numbers after subsampling: [300, 300, 51, 300, 300, 229, 184, 128, 30, 300, 300, 286, 202, 87, 300, 273, 149, 80, 42, 6]
Computing sims for pattern 0
Computed sims for pattern 0 in 6.222607612609863 s
Computing sims for pattern 1
Computed sims for pattern 1 in 6.320646286010742 s
Computing sims for pattern 2
Computed sims for pattern 2 in 1.523289680480957 s
Computing sims for pattern 3
Computed sims for pattern 3 in 6.182655572891235 s
Computing sims for pattern 4
Computed sims for pattern 4 in 6.211225509643555 s
Computing sims for pattern 5
Computed sims for pattern 5 in 6.715776205062866 s
Computing sims for pattern 6
Computed sims for pattern 6 in 4.232326030731201 s
Computing sims for pattern 7
Computed sims for pattern 7 in 3.1510000228881836 s
Computing sims for pattern 8
Computed sims for pattern 8 in 1.053457498550415 s
Computing sims for pattern 9
Computed sims for pattern 9 in 6.344305038452148 s
Computing sims for pattern 10
Computed sims for pattern 10 in 6.336487531661987 s
Computing sims for pattern 11
Computed sims for pattern 11 in 5.803144693374634 s
Computing sims for pattern 12
Computed sims for pattern 12 in 4.830811023712158 s
Computing sims for pattern 13
Computed sims for pattern 13 in 2.3741047382354736 s
Computing sims for pattern 14
Computed sims for pattern 14 in 6.271493911743164 s
Computing sims for pattern 15
Computed sims for pattern 15 in 5.408380031585693 s
Computing sims for pattern 16
Computed sims for pattern 16 in 3.2630932331085205 s
Computing sims for pattern 17
Computed sims for pattern 17 in 2.1877341270446777 s
Computing sims for pattern 18
Computed sims for pattern 18 in 1.2891144752502441 s
Computing sims for pattern 19
Computed sims for pattern 19 in 0.5515639781951904 s
Cluster sizes
[1868  434   51  818  342  229  184  128   30  664  309  286  202   87
  767  273  149   80   42    6]
Cross-contamination matrix:
[[1.   0.75 0.8  0.59 0.58 0.59 0.33 0.54 0.19 0.23 0.19 0.23 0.13 0.12
  0.15 0.15 0.24 0.21 0.13 0.21]
 [0.63 1.   0.45 0.41 0.41 0.41 0.19 0.33 0.12 0.12 0.13 0.1  0.08 0.06
  0.09 0.15 0.14 0.15 0.09 0.07]
 [0.56 0.55 1.   0.32 0.31 0.31 0.31 0.25 0.07 0.14 0.03 0.12 0.06 0.14
  0.11 0.2  0.1  0.07 0.04 0.32]
 [0.76 0.7  0.67 1.   0.88 0.8  0.67 0.82 0.38 0.25 0.38 0.31 0.22 0.11
  0.19 0.52 0.48 0.48 0.22 0.49]
 [0.5  0.42 0.37 0.56 1.   0.65 0.65 0.53 0.12 0.18 0.13 0.17 0.14 0.05
  0.2  0.25 0.28 0.46 0.09 0.41]
 [0.56 0.46 0.47 0.51 0.51 1.   0.49 0.66 0.19 0.12 0.17 0.12 0.1  0.04
  0.13 0.12 0.17 0.19 0.1  0.24]
 [0.27 0.23 0.4  0.4  0.68 0.45 1.   0.38 0.22 0.09 0.26 0.08 0.11 0.02
  0.14 0.35 0.13 0.41 0.09 0.6 ]
 [0.46 0.38 0.31 0.53 0.55 0.62 0.39 1.   0.21 0.11 0.19 0.1  0.11 0.04
  0.09 0.08 0.14 0.19 0.1  0.3 ]
 [0.42 0.43 0.33 0.49 0.43 0.46 0.54 0.48 1.   0.31 0.34 0.2  0.32 0.12
  0.39 0.31 0.27 0.28 0.77 0.56]
 [0.43 0.36 0.41 0.33 0.44 0.28 0.25 0.27 0.29 1.   0.75 0.89 0.79 0.68
  0.68 0.71 0.76 0.49 0.38 0.62]
 [0.28 0.27 0.11 0.37 0.27 0.29 0.41 0.32 0.25 0.64 1.   0.75 0.59 0.51
  0.49 0.61 0.63 0.32 0.26 0.93]
 [0.2  0.15 0.17 0.19 0.21 0.12 0.11 0.11 0.13 0.62 0.57 1.   0.43 0.53
  0.51 0.52 0.8  0.33 0.19 0.44]
 [0.24 0.25 0.21 0.27 0.34 0.22 0.28 0.25 0.27 0.76 0.65 0.66 1.   0.48
  0.49 0.46 0.51 0.3  0.26 0.59]
 [0.1  0.08 0.22 0.06 0.07 0.04 0.03 0.04 0.03 0.43 0.37 0.51 0.29 1.
  0.2  0.18 0.29 0.08 0.05 0.11]
 [0.16 0.14 0.19 0.14 0.26 0.17 0.19 0.13 0.2  0.42 0.37 0.52 0.32 0.22
  1.   0.7  0.84 0.6  0.37 0.51]
 [0.12 0.17 0.26 0.33 0.28 0.14 0.37 0.09 0.14 0.38 0.4  0.44 0.22 0.15
  0.65 1.   0.68 0.27 0.25 0.7 ]
 [0.15 0.1  0.06 0.12 0.1  0.13 0.09 0.11 0.06 0.32 0.31 0.58 0.21 0.18
  0.61 0.51 1.   0.48 0.12 0.35]
 [0.34 0.29 0.22 0.46 0.69 0.35 0.6  0.34 0.25 0.4  0.34 0.49 0.26 0.14
  0.73 0.47 0.83 1.   0.29 0.36]
 [0.44 0.44 0.32 0.45 0.47 0.43 0.44 0.46 0.9  0.56 0.51 0.43 0.49 0.26
  0.75 0.67 0.65 0.51 1.   0.54]
 [0.   0.   0.02 0.   0.02 0.   0.03 0.01 0.   0.01 0.11 0.01 0.01 0.
  0.02 0.06 0.01 0.   0.   1.  ]]
Pattern-to-pattern sim matrix:
[[ 1.    0.84  0.81  0.79  0.76  0.79  0.47  0.76  0.53  0.46  0.25  0.36
   0.29  0.12  0.36  0.34  0.39  0.42  0.45  0.32]
 [ 0.84  1.    0.75  0.78  0.74  0.78  0.42  0.76  0.53  0.38  0.21  0.19
   0.32  0.01  0.32  0.32  0.32  0.37  0.41  0.25]
 [ 0.81  0.75  1.    0.72  0.66  0.69  0.46  0.67  0.51  0.38  0.24  0.28
   0.32  0.2   0.41  0.45  0.29  0.28  0.34  0.47]
 [ 0.79  0.78  0.72  1.    0.84  0.81  0.66  0.81  0.67  0.41  0.38  0.26
   0.34 -0.05  0.35  0.44  0.41  0.48  0.5   0.47]
 [ 0.76  0.74  0.66  0.84  1.    0.78  0.71  0.75  0.53  0.4   0.26  0.32
   0.27  0.01  0.32  0.36  0.39  0.58  0.39  0.45]
 [ 0.79  0.78  0.69  0.81  0.78  1.    0.55  0.8   0.52  0.41  0.31  0.18
   0.34 -0.02  0.39  0.44  0.43  0.44  0.4   0.34]
 [ 0.47  0.42  0.46  0.66  0.71  0.55  1.    0.62  0.68  0.32  0.42  0.1
   0.3   0.07  0.31  0.49  0.34  0.52  0.42  0.65]
 [ 0.76  0.76  0.67  0.81  0.75  0.8   0.62  1.    0.62  0.47  0.37  0.16
   0.44  0.03  0.35  0.38  0.45  0.5   0.47  0.48]
 [ 0.53  0.53  0.51  0.67  0.53  0.52  0.68  0.62  1.    0.44  0.34  0.25
   0.43 -0.06  0.45  0.37  0.41  0.41  0.79  0.42]
 [ 0.46  0.38  0.38  0.41  0.4   0.41  0.32  0.47  0.44  1.    0.75  0.78
   0.8   0.7   0.64  0.66  0.64  0.58  0.57  0.44]
 [ 0.25  0.21  0.24  0.38  0.26  0.31  0.42  0.37  0.34  0.75  1.    0.75
   0.73  0.61  0.5   0.57  0.63  0.33  0.35  0.65]
 [ 0.36  0.19  0.28  0.26  0.32  0.18  0.1   0.16  0.25  0.78  0.75  1.
   0.65  0.7   0.56  0.55  0.84  0.56  0.35  0.38]
 [ 0.29  0.32  0.32  0.34  0.27  0.34  0.3   0.44  0.43  0.8   0.73  0.65
   1.    0.55  0.5   0.41  0.48  0.31  0.42  0.52]
 [ 0.12  0.01  0.2  -0.05  0.01 -0.02  0.07  0.03 -0.06  0.7   0.61  0.7
   0.55  1.    0.31  0.35  0.48  0.2   0.04  0.28]
 [ 0.36  0.32  0.41  0.35  0.32  0.39  0.31  0.35  0.45  0.64  0.5   0.56
   0.5   0.31  1.    0.8   0.78  0.74  0.75  0.43]
 [ 0.34  0.32  0.45  0.44  0.36  0.44  0.49  0.38  0.37  0.66  0.57  0.55
   0.41  0.35  0.8   1.    0.68  0.6   0.67  0.52]
 [ 0.39  0.32  0.29  0.41  0.39  0.43  0.34  0.45  0.41  0.64  0.63  0.84
   0.48  0.48  0.78  0.68  1.    0.78  0.56  0.37]
 [ 0.42  0.37  0.28  0.48  0.58  0.44  0.52  0.5   0.41  0.58  0.33  0.56
   0.31  0.2   0.74  0.6   0.78  1.    0.57  0.19]
 [ 0.45  0.41  0.34  0.5   0.39  0.4   0.42  0.47  0.79  0.57  0.35  0.35
   0.42  0.04  0.75  0.67  0.56  0.57  1.    0.31]
 [ 0.32  0.25  0.47  0.47  0.45  0.34  0.65  0.48  0.42  0.44  0.65  0.38
   0.52  0.28  0.43  0.52  0.37  0.19  0.31  1.  ]]
Got 20 patterns after merging
2024-03-12 00:42:44.982413 MEMORY 13.056802816
Performing filtering
2024-03-12 00:42:44.982700 MEMORY 13.056802816
Got 19 patterns after filtering
2024-03-12 00:42:47.407581 MEMORY 13.056806912
Total time taken is 1074.32s
2024-03-12 00:42:47.407781 MEMORY 13.056806912
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 1650 tasks      | elapsed:    0.4s
[Parallel(n_jobs=24)]: Done 1868 out of 1868 | elapsed:    0.5s finished
/ru-auth/local/home/lzhao/anaconda3/envs/jupyter-ml-clone/lib/python3.9/site-packages/sklearn/manifold/_t_sne.py:691: FutureWarning: 'square_distances' has been introduced in 0.24 to help phase out legacy squaring behavior. The 'legacy' setting will be removed in 1.1 (renaming of 0.26), and the default setting will be changed to True. In 1.3, 'square_distances' will be removed altogether, and distances will be squared by default. Set 'square_distances'=True to silence this warning.
  warnings.warn(
/ru-auth/local/home/lzhao/anaconda3/envs/jupyter-ml-clone/lib/python3.9/site-packages/sklearn/neighbors/_base.py:175: EfficiencyWarning: Precomputed sparse input was not sorted by data.
  warnings.warn('Precomputed sparse input was not sorted by data.',
Applying subclustering to the final motifs
On pattern 0
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 1868 samples in 0.011s...
[t-SNE] Computed neighbors for 1868 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 1000 / 1868
[t-SNE] Computed conditional probabilities for sample 1868 / 1868
[t-SNE] Mean sigma: 0.312091
[t-SNE] Computed conditional probabilities in 0.131s
[t-SNE] Iteration 50: error = 69.3263626, gradient norm = 0.1114725 (50 iterations in 0.201s)
[t-SNE] Iteration 100: error = 69.3656464, gradient norm = 0.1042533 (50 iterations in 0.185s)
[t-SNE] Iteration 150: error = 69.2953568, gradient norm = 0.0937510 (50 iterations in 0.188s)
[t-SNE] Iteration 200: error = 69.4687271, gradient norm = 0.1021306 (50 iterations in 0.189s)
[t-SNE] Iteration 250: error = 69.3079529, gradient norm = 0.1014204 (50 iterations in 0.190s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 69.307953
[t-SNE] Iteration 300: error = 2.2687511, gradient norm = 0.0013054 (50 iterations in 0.162s)
[t-SNE] Iteration 350: error = 2.1581924, gradient norm = 0.0005064 (50 iterations in 0.157s)
[t-SNE] Iteration 400: error = 2.1139357, gradient norm = 0.0002807 (50 iterations in 0.156s)
[t-SNE] Iteration 450: error = 2.0931928, gradient norm = 0.0001648 (50 iterations in 0.156s)
[t-SNE] Iteration 500: error = 2.0821266, gradient norm = 0.0001256 (50 iterations in 0.256s)
[t-SNE] Iteration 550: error = 2.0756910, gradient norm = 0.0001044 (50 iterations in 0.159s)
[t-SNE] Iteration 600: error = 2.0705373, gradient norm = 0.0000790 (50 iterations in 0.157s)
[t-SNE] Iteration 650: error = 2.0674040, gradient norm = 0.0000907 (50 iterations in 0.156s)
[t-SNE] Iteration 700: error = 2.0649848, gradient norm = 0.0000913 (50 iterations in 0.157s)
[t-SNE] Iteration 750: error = 2.0624518, gradient norm = 0.0000947 (50 iterations in 0.156s)
[t-SNE] Iteration 800: error = 2.0597832, gradient norm = 0.0000907 (50 iterations in 0.158s)
[t-SNE] Iteration 850: error = 2.0577312, gradient norm = 0.0000768 (50 iterations in 0.157s)
[t-SNE] Iteration 900: error = 2.0560005, gradient norm = 0.0001473 (50 iterations in 0.156s)
[t-SNE] Iteration 950: error = 2.0548756, gradient norm = 0.0000935 (50 iterations in 0.158s)
[t-SNE] Iteration 1000: error = 2.0530722, gradient norm = 0.0000711 (50 iterations in 0.158s)
[t-SNE] KL divergence after 1000 iterations: 2.053072
[t-SNE] Computed conditional probabilities for sample 1000 / 1868
[t-SNE] Computed conditional probabilities for sample 1868 / 1868
[t-SNE] Mean sigma: 0.312091
Beginning preprocessing + Leiden
2024-03-12 00:42:53.506678 MEMORY 13.056806912
Affmat transformed
2024-03-12 00:42:53.530229 MEMORY 13.056806912
sources, targets, weights extracted
2024-03-12 00:42:53.546433 MEMORY 13.056806912
About to launch parallel Leiden runs
2024-03-12 00:42:53.600536 MEMORY 13.056806912
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    7.2s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   23.5s finished
Parallel Leiden runs finished
2024-03-12 00:43:17.107357 MEMORY 13.056806912
Quality: 0.4503891606960708
Quality: 0.45230888214229925
Quality: 0.4547787079800042
Quality: 0.4548835710364251
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 818 out of 818 | elapsed:    0.2s finished
Got subclusters: Counter({0: 260, 1: 247, 2: 233, 3: 215, 4: 204, 5: 194, 6: 158, 7: 128, 8: 102, 9: 98, 10: 29})
On pattern 1
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 818 samples in 0.006s...
[t-SNE] Computed neighbors for 818 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 818 / 818
[t-SNE] Mean sigma: 0.355975
[t-SNE] Computed conditional probabilities in 0.061s
[t-SNE] Iteration 50: error = 67.2526169, gradient norm = 0.3571755 (50 iterations in 0.075s)
[t-SNE] Iteration 100: error = 67.4046478, gradient norm = 0.3491372 (50 iterations in 0.075s)
[t-SNE] Iteration 150: error = 67.4253464, gradient norm = 0.3455615 (50 iterations in 0.075s)
[t-SNE] Iteration 200: error = 68.0072327, gradient norm = 0.3475127 (50 iterations in 0.076s)
[t-SNE] Iteration 250: error = 68.9129944, gradient norm = 0.3343647 (50 iterations in 0.076s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 68.912994
[t-SNE] Iteration 300: error = 1.7262061, gradient norm = 0.0033473 (50 iterations in 0.070s)
[t-SNE] Iteration 350: error = 1.6246703, gradient norm = 0.0006663 (50 iterations in 0.068s)
[t-SNE] Iteration 400: error = 1.6028169, gradient norm = 0.0004084 (50 iterations in 0.068s)
[t-SNE] Iteration 450: error = 1.5936801, gradient norm = 0.0002337 (50 iterations in 0.068s)
[t-SNE] Iteration 500: error = 1.5871215, gradient norm = 0.0001752 (50 iterations in 0.068s)
[t-SNE] Iteration 550: error = 1.5843599, gradient norm = 0.0003412 (50 iterations in 0.068s)
[t-SNE] Iteration 600: error = 1.5831594, gradient norm = 0.0000886 (50 iterations in 0.069s)
[t-SNE] Iteration 650: error = 1.5823417, gradient norm = 0.0000598 (50 iterations in 0.068s)
[t-SNE] Iteration 700: error = 1.5814543, gradient norm = 0.0000525 (50 iterations in 0.068s)
[t-SNE] Iteration 750: error = 1.5808917, gradient norm = 0.0000590 (50 iterations in 0.068s)
[t-SNE] Iteration 800: error = 1.5805336, gradient norm = 0.0000347 (50 iterations in 0.068s)
[t-SNE] Iteration 850: error = 1.5802928, gradient norm = 0.0000334 (50 iterations in 0.068s)
[t-SNE] Iteration 900: error = 1.5800515, gradient norm = 0.0000371 (50 iterations in 0.068s)
[t-SNE] Iteration 950: error = 1.5799826, gradient norm = 0.0000218 (50 iterations in 0.068s)
[t-SNE] Iteration 1000: error = 1.5798448, gradient norm = 0.0000341 (50 iterations in 0.068s)
[t-SNE] KL divergence after 1000 iterations: 1.579845
[t-SNE] Computed conditional probabilities for sample 818 / 818
[t-SNE] Mean sigma: 0.355975
Beginning preprocessing + Leiden
2024-03-12 00:43:19.996235 MEMORY 13.056806912
Affmat transformed
2024-03-12 00:43:20.007372 MEMORY 13.056806912
sources, targets, weights extracted
2024-03-12 00:43:20.013381 MEMORY 13.056806912
About to launch parallel Leiden runs
2024-03-12 00:43:20.049873 MEMORY 13.056806912
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    2.2s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    8.4s finished
Parallel Leiden runs finished
2024-03-12 00:43:28.419286 MEMORY 13.056806912
Quality: 0.43255459106994365
Quality: 0.43349873132041117
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 720 out of 767 | elapsed:    0.2s remaining:    0.0s
[Parallel(n_jobs=24)]: Done 767 out of 767 | elapsed:    0.2s finished
Got subclusters: Counter({0: 180, 1: 152, 2: 136, 3: 113, 4: 92, 5: 88, 6: 57})
On pattern 2
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 767 samples in 0.005s...
[t-SNE] Computed neighbors for 767 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 767 / 767
[t-SNE] Mean sigma: 0.335874
[t-SNE] Computed conditional probabilities in 0.057s
[t-SNE] Iteration 50: error = 68.7849579, gradient norm = 0.3631284 (50 iterations in 0.074s)
[t-SNE] Iteration 100: error = 69.6865463, gradient norm = 0.3529711 (50 iterations in 0.075s)
[t-SNE] Iteration 150: error = 69.2481079, gradient norm = 0.3360458 (50 iterations in 0.075s)
[t-SNE] Iteration 200: error = 68.5434265, gradient norm = 0.3537164 (50 iterations in 0.077s)
[t-SNE] Iteration 250: error = 68.7896805, gradient norm = 0.3422284 (50 iterations in 0.075s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 68.789680
[t-SNE] Iteration 300: error = 1.6011721, gradient norm = 0.0027194 (50 iterations in 0.069s)
[t-SNE] Iteration 350: error = 1.5577137, gradient norm = 0.0004784 (50 iterations in 0.068s)
[t-SNE] Iteration 400: error = 1.5362395, gradient norm = 0.0003638 (50 iterations in 0.068s)
[t-SNE] Iteration 450: error = 1.5306464, gradient norm = 0.0001882 (50 iterations in 0.068s)
[t-SNE] Iteration 500: error = 1.5259676, gradient norm = 0.0001985 (50 iterations in 0.069s)
[t-SNE] Iteration 550: error = 1.5226771, gradient norm = 0.0001495 (50 iterations in 0.068s)
[t-SNE] Iteration 600: error = 1.5192961, gradient norm = 0.0001945 (50 iterations in 0.068s)
[t-SNE] Iteration 650: error = 1.5148549, gradient norm = 0.0002145 (50 iterations in 0.068s)
[t-SNE] Iteration 700: error = 1.5104631, gradient norm = 0.0002928 (50 iterations in 0.068s)
[t-SNE] Iteration 750: error = 1.5065418, gradient norm = 0.0001924 (50 iterations in 0.069s)
[t-SNE] Iteration 800: error = 1.5055337, gradient norm = 0.0001139 (50 iterations in 0.068s)
[t-SNE] Iteration 850: error = 1.5041207, gradient norm = 0.0001334 (50 iterations in 0.086s)
[t-SNE] Iteration 900: error = 1.5036237, gradient norm = 0.0001218 (50 iterations in 0.069s)
[t-SNE] Iteration 950: error = 1.5024796, gradient norm = 0.0000822 (50 iterations in 0.070s)
[t-SNE] Iteration 1000: error = 1.5023171, gradient norm = 0.0000541 (50 iterations in 0.070s)
[t-SNE] KL divergence after 1000 iterations: 1.502317
[t-SNE] Computed conditional probabilities for sample 767 / 767
[t-SNE] Mean sigma: 0.335874
Beginning preprocessing + Leiden
2024-03-12 00:43:31.176308 MEMORY 13.056806912
Affmat transformed
2024-03-12 00:43:31.186830 MEMORY 13.056806912
sources, targets, weights extracted
2024-03-12 00:43:31.193376 MEMORY 13.056806912
About to launch parallel Leiden runs
2024-03-12 00:43:31.227296 MEMORY 13.056806912
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    2.2s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    7.3s finished
Parallel Leiden runs finished
2024-03-12 00:43:38.563311 MEMORY 13.056806912
Quality: 0.41379064471822846
Quality: 0.41499338585906703
Quality: 0.4161381857786704
Quality: 0.4161395930732057
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 664 out of 664 | elapsed:    0.2s finished
Got subclusters: Counter({0: 169, 1: 140, 2: 128, 3: 127, 4: 116, 5: 87})
On pattern 3
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 664 samples in 0.005s...
[t-SNE] Computed neighbors for 664 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 664 / 664
[t-SNE] Mean sigma: 0.367826
[t-SNE] Computed conditional probabilities in 0.050s
[t-SNE] Iteration 50: error = 65.8584747, gradient norm = 0.4381872 (50 iterations in 0.065s)
[t-SNE] Iteration 100: error = 68.2036133, gradient norm = 0.4072383 (50 iterations in 0.065s)
[t-SNE] Iteration 150: error = 66.8638687, gradient norm = 0.4158624 (50 iterations in 0.065s)
[t-SNE] Iteration 200: error = 66.6985245, gradient norm = 0.4308051 (50 iterations in 0.067s)
[t-SNE] Iteration 250: error = 66.7291641, gradient norm = 0.4174441 (50 iterations in 0.065s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 66.729164
[t-SNE] Iteration 300: error = 1.6638563, gradient norm = 0.0030060 (50 iterations in 0.061s)
[t-SNE] Iteration 350: error = 1.5990188, gradient norm = 0.0008098 (50 iterations in 0.060s)
[t-SNE] Iteration 400: error = 1.5800116, gradient norm = 0.0003186 (50 iterations in 0.062s)
[t-SNE] Iteration 450: error = 1.5736411, gradient norm = 0.0003262 (50 iterations in 0.059s)
[t-SNE] Iteration 500: error = 1.5694395, gradient norm = 0.0002602 (50 iterations in 0.060s)
[t-SNE] Iteration 550: error = 1.5660681, gradient norm = 0.0001594 (50 iterations in 0.060s)
[t-SNE] Iteration 600: error = 1.5644714, gradient norm = 0.0001369 (50 iterations in 0.062s)
[t-SNE] Iteration 650: error = 1.5624796, gradient norm = 0.0001428 (50 iterations in 0.060s)
[t-SNE] Iteration 700: error = 1.5615222, gradient norm = 0.0001579 (50 iterations in 0.060s)
[t-SNE] Iteration 750: error = 1.5607578, gradient norm = 0.0000630 (50 iterations in 0.060s)
[t-SNE] Iteration 800: error = 1.5599157, gradient norm = 0.0000868 (50 iterations in 0.059s)
[t-SNE] Iteration 850: error = 1.5597155, gradient norm = 0.0000740 (50 iterations in 0.076s)
[t-SNE] Iteration 900: error = 1.5592941, gradient norm = 0.0000648 (50 iterations in 0.059s)
[t-SNE] Iteration 950: error = 1.5592891, gradient norm = 0.0000605 (50 iterations in 0.058s)
[t-SNE] Iteration 1000: error = 1.5591611, gradient norm = 0.0000441 (50 iterations in 0.059s)
[t-SNE] KL divergence after 1000 iterations: 1.559161
[t-SNE] Computed conditional probabilities for sample 664 / 664
[t-SNE] Mean sigma: 0.367826
Beginning preprocessing + Leiden
2024-03-12 00:43:40.888951 MEMORY 13.056806912
Affmat transformed
2024-03-12 00:43:40.897263 MEMORY 13.056806912
sources, targets, weights extracted
2024-03-12 00:43:40.902022 MEMORY 13.056806912
About to launch parallel Leiden runs
2024-03-12 00:43:40.926481 MEMORY 13.056806912
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.9s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    6.0s finished
Parallel Leiden runs finished
2024-03-12 00:43:46.953780 MEMORY 13.056806912
Quality: 0.4053015424793721
Quality: 0.40585506012040173
Quality: 0.40778271383933634
Quality: 0.4078535173955433
Quality: 0.40793906829178334
Quality: 0.4080048532420981
Quality: 0.40846915679272516
Quality: 0.4085928833962472
Quality: 0.40864041731675677
Quality: 0.40873266984463474
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 344 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 434 out of 434 | elapsed:    0.2s finished
Got subclusters: Counter({0: 128, 1: 109, 2: 99, 3: 82, 4: 70, 5: 65, 6: 60, 7: 47, 8: 4})
On pattern 4
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 434 samples in 0.003s...
[t-SNE] Computed neighbors for 434 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 434 / 434
[t-SNE] Mean sigma: 0.354958
[t-SNE] Computed conditional probabilities in 0.033s
[t-SNE] Iteration 50: error = 67.7315063, gradient norm = 0.4702457 (50 iterations in 0.047s)
[t-SNE] Iteration 100: error = 69.0211105, gradient norm = 0.4638847 (50 iterations in 0.045s)
[t-SNE] Iteration 150: error = 70.8281326, gradient norm = 0.4361604 (50 iterations in 0.044s)
[t-SNE] Iteration 200: error = 69.5850906, gradient norm = 0.4643288 (50 iterations in 0.044s)
[t-SNE] Iteration 250: error = 71.0635910, gradient norm = 0.4125181 (50 iterations in 0.048s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 71.063591
[t-SNE] Iteration 300: error = 1.3103390, gradient norm = 0.0031713 (50 iterations in 0.043s)
[t-SNE] Iteration 350: error = 1.2622603, gradient norm = 0.0008701 (50 iterations in 0.043s)
[t-SNE] Iteration 400: error = 1.2402376, gradient norm = 0.0008670 (50 iterations in 0.042s)
[t-SNE] Iteration 450: error = 1.2289872, gradient norm = 0.0009277 (50 iterations in 0.042s)
[t-SNE] Iteration 500: error = 1.2233093, gradient norm = 0.0002192 (50 iterations in 0.042s)
[t-SNE] Iteration 550: error = 1.2225058, gradient norm = 0.0001240 (50 iterations in 0.042s)
[t-SNE] Iteration 600: error = 1.2206842, gradient norm = 0.0003241 (50 iterations in 0.042s)
[t-SNE] Iteration 650: error = 1.2191240, gradient norm = 0.0000939 (50 iterations in 0.042s)
[t-SNE] Iteration 700: error = 1.2191153, gradient norm = 0.0000984 (50 iterations in 0.043s)
[t-SNE] Iteration 750: error = 1.2189040, gradient norm = 0.0000803 (50 iterations in 0.043s)
[t-SNE] Iteration 800: error = 1.2189877, gradient norm = 0.0000809 (50 iterations in 0.043s)
[t-SNE] Iteration 850: error = 1.2188290, gradient norm = 0.0000798 (50 iterations in 0.043s)
[t-SNE] Iteration 900: error = 1.2187040, gradient norm = 0.0001582 (50 iterations in 0.043s)
[t-SNE] Iteration 950: error = 1.2186681, gradient norm = 0.0000656 (50 iterations in 0.043s)
[t-SNE] Iteration 1000: error = 1.2186656, gradient norm = 0.0000838 (50 iterations in 0.043s)
[t-SNE] KL divergence after 1000 iterations: 1.218666
[t-SNE] Computed conditional probabilities for sample 434 / 434
[t-SNE] Mean sigma: 0.354957
Beginning preprocessing + Leiden
2024-03-12 00:43:48.559395 MEMORY 13.056806912
Affmat transformed
2024-03-12 00:43:48.564709 MEMORY 13.056806912
sources, targets, weights extracted
2024-03-12 00:43:48.567913 MEMORY 13.056806912
About to launch parallel Leiden runs
2024-03-12 00:43:48.640109 MEMORY 13.056806912
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.5s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    4.5s finished
Parallel Leiden runs finished
2024-03-12 00:43:53.121401 MEMORY 13.056806912
Quality: 0.35809545265682835
Quality: 0.35840832513440485
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 342 out of 342 | elapsed:    0.1s finished
Got subclusters: Counter({0: 86, 1: 83, 2: 63, 3: 62, 4: 52, 5: 50, 6: 38})
On pattern 5
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 342 samples in 0.002s...
[t-SNE] Computed neighbors for 342 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 342 / 342
[t-SNE] Mean sigma: 0.365303
[t-SNE] Computed conditional probabilities in 0.023s
[t-SNE] Iteration 50: error = 63.1053429, gradient norm = 0.5157356 (50 iterations in 0.038s)
[t-SNE] Iteration 100: error = 65.8976212, gradient norm = 0.4939024 (50 iterations in 0.038s)
[t-SNE] Iteration 150: error = 66.1326141, gradient norm = 0.4926720 (50 iterations in 0.038s)
[t-SNE] Iteration 200: error = 68.9181595, gradient norm = 0.4613938 (50 iterations in 0.038s)
[t-SNE] Iteration 250: error = 68.7439575, gradient norm = 0.4800651 (50 iterations in 0.038s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 68.743958
[t-SNE] Iteration 300: error = 1.2203093, gradient norm = 0.0050890 (50 iterations in 0.037s)
[t-SNE] Iteration 350: error = 1.1509025, gradient norm = 0.0018313 (50 iterations in 0.036s)
[t-SNE] Iteration 400: error = 1.0939773, gradient norm = 0.0013696 (50 iterations in 0.036s)
[t-SNE] Iteration 450: error = 1.0748016, gradient norm = 0.0008402 (50 iterations in 0.036s)
[t-SNE] Iteration 500: error = 1.0718635, gradient norm = 0.0002734 (50 iterations in 0.036s)
[t-SNE] Iteration 550: error = 1.0698779, gradient norm = 0.0003287 (50 iterations in 0.036s)
[t-SNE] Iteration 600: error = 1.0693152, gradient norm = 0.0002001 (50 iterations in 0.036s)
[t-SNE] Iteration 650: error = 1.0669239, gradient norm = 0.0002965 (50 iterations in 0.036s)
[t-SNE] Iteration 700: error = 1.0658734, gradient norm = 0.0001076 (50 iterations in 0.036s)
[t-SNE] Iteration 750: error = 1.0655732, gradient norm = 0.0002581 (50 iterations in 0.036s)
[t-SNE] Iteration 800: error = 1.0656210, gradient norm = 0.0000919 (50 iterations in 0.036s)
[t-SNE] Iteration 850: error = 1.0658600, gradient norm = 0.0000762 (50 iterations in 0.036s)
[t-SNE] Iteration 900: error = 1.0657117, gradient norm = 0.0000536 (50 iterations in 0.036s)
[t-SNE] Iteration 950: error = 1.0655630, gradient norm = 0.0000845 (50 iterations in 0.036s)
[t-SNE] Iteration 1000: error = 1.0654856, gradient norm = 0.0000796 (50 iterations in 0.036s)
[t-SNE] KL divergence after 1000 iterations: 1.065486
[t-SNE] Computed conditional probabilities for sample 342 / 342
[t-SNE] Mean sigma: 0.365303
Beginning preprocessing + Leiden
2024-03-12 00:43:54.401649 MEMORY 13.056806912
Affmat transformed
2024-03-12 00:43:54.406103 MEMORY 13.056806912
sources, targets, weights extracted
2024-03-12 00:43:54.408453 MEMORY 13.056806912
About to launch parallel Leiden runs
2024-03-12 00:43:54.465625 MEMORY 13.056806912
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.2s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    3.5s finished
Parallel Leiden runs finished
2024-03-12 00:43:57.985861 MEMORY 13.056806912
Quality: 0.3517401956566023
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 309 out of 309 | elapsed:    0.1s finished
Got subclusters: Counter({0: 80, 1: 63, 2: 53, 3: 46, 4: 34, 5: 33, 6: 28, 7: 5})
On pattern 6
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 309 samples in 0.002s...
[t-SNE] Computed neighbors for 309 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 309 / 309
[t-SNE] Mean sigma: 0.411363
[t-SNE] Computed conditional probabilities in 0.021s
[t-SNE] Iteration 50: error = 61.7520905, gradient norm = 0.5203462 (50 iterations in 0.036s)
[t-SNE] Iteration 100: error = 64.1932602, gradient norm = 0.5180266 (50 iterations in 0.037s)
[t-SNE] Iteration 150: error = 66.1643372, gradient norm = 0.4494660 (50 iterations in 0.037s)
[t-SNE] Iteration 200: error = 65.6961060, gradient norm = 0.4838882 (50 iterations in 0.037s)
[t-SNE] Iteration 250: error = 64.0735474, gradient norm = 0.5181659 (50 iterations in 0.037s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 64.073547
[t-SNE] Iteration 300: error = 1.1879882, gradient norm = 0.0047194 (50 iterations in 0.035s)
[t-SNE] Iteration 350: error = 1.0748250, gradient norm = 0.0028904 (50 iterations in 0.034s)
[t-SNE] Iteration 400: error = 1.0141274, gradient norm = 0.0015784 (50 iterations in 0.034s)
[t-SNE] Iteration 450: error = 1.0079782, gradient norm = 0.0004914 (50 iterations in 0.034s)
[t-SNE] Iteration 500: error = 0.9997112, gradient norm = 0.0006236 (50 iterations in 0.034s)
[t-SNE] Iteration 550: error = 0.9889898, gradient norm = 0.0004997 (50 iterations in 0.034s)
[t-SNE] Iteration 600: error = 0.9685444, gradient norm = 0.0017620 (50 iterations in 0.034s)
[t-SNE] Iteration 650: error = 0.9628765, gradient norm = 0.0009473 (50 iterations in 0.034s)
[t-SNE] Iteration 700: error = 0.9555253, gradient norm = 0.0004427 (50 iterations in 0.034s)
[t-SNE] Iteration 750: error = 0.9499725, gradient norm = 0.0005259 (50 iterations in 0.034s)
[t-SNE] Iteration 800: error = 0.9460207, gradient norm = 0.0014414 (50 iterations in 0.034s)
[t-SNE] Iteration 850: error = 0.9447550, gradient norm = 0.0001367 (50 iterations in 0.034s)
[t-SNE] Iteration 900: error = 0.9448181, gradient norm = 0.0001066 (50 iterations in 0.034s)
[t-SNE] Iteration 950: error = 0.9450046, gradient norm = 0.0001284 (50 iterations in 0.034s)
[t-SNE] Iteration 1000: error = 0.9450740, gradient norm = 0.0001057 (50 iterations in 0.034s)
[t-SNE] KL divergence after 1000 iterations: 0.945074
[t-SNE] Computed conditional probabilities for sample 309 / 309
[t-SNE] Mean sigma: 0.411363
Beginning preprocessing + Leiden
2024-03-12 00:43:59.274297 MEMORY 13.056806912
Affmat transformed
2024-03-12 00:43:59.278628 MEMORY 13.056806912
sources, targets, weights extracted
2024-03-12 00:43:59.280840 MEMORY 13.056806912
About to launch parallel Leiden runs
2024-03-12 00:43:59.337734 MEMORY 13.056806912
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.0s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    3.3s finished
Parallel Leiden runs finished
2024-03-12 00:44:02.672087 MEMORY 13.056806912
Quality: 0.3743861163610402
Quality: 0.37494927191575744
Quality: 0.3750906448428018
Quality: 0.3753776554920947
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 286 out of 286 | elapsed:    0.1s finished
Got subclusters: Counter({0: 76, 1: 54, 2: 51, 3: 41, 4: 35, 5: 27, 6: 25})
On pattern 7
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 286 samples in 0.002s...
[t-SNE] Computed neighbors for 286 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 286 / 286
[t-SNE] Mean sigma: 0.399517
[t-SNE] Computed conditional probabilities in 0.019s
[t-SNE] Iteration 50: error = 61.5327187, gradient norm = 0.5318215 (50 iterations in 0.034s)
[t-SNE] Iteration 100: error = 64.3758011, gradient norm = 0.4752034 (50 iterations in 0.035s)
[t-SNE] Iteration 150: error = 61.8594551, gradient norm = 0.5308514 (50 iterations in 0.034s)
[t-SNE] Iteration 200: error = 65.8255844, gradient norm = 0.4867547 (50 iterations in 0.035s)
[t-SNE] Iteration 250: error = 66.5251617, gradient norm = 0.4712807 (50 iterations in 0.035s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 66.525162
[t-SNE] Iteration 300: error = 1.1674918, gradient norm = 0.0056364 (50 iterations in 0.033s)
[t-SNE] Iteration 350: error = 1.0404385, gradient norm = 0.0037941 (50 iterations in 0.032s)
[t-SNE] Iteration 400: error = 0.9958228, gradient norm = 0.0020826 (50 iterations in 0.032s)
[t-SNE] Iteration 450: error = 0.9527259, gradient norm = 0.0016087 (50 iterations in 0.037s)
[t-SNE] Iteration 500: error = 0.8891038, gradient norm = 0.0016604 (50 iterations in 0.033s)
[t-SNE] Iteration 550: error = 0.8740666, gradient norm = 0.0013222 (50 iterations in 0.033s)
[t-SNE] Iteration 600: error = 0.8729475, gradient norm = 0.0001317 (50 iterations in 0.032s)
[t-SNE] Iteration 650: error = 0.8730086, gradient norm = 0.0001172 (50 iterations in 0.032s)
[t-SNE] Iteration 700: error = 0.8667511, gradient norm = 0.0005279 (50 iterations in 0.032s)
[t-SNE] Iteration 750: error = 0.8671681, gradient norm = 0.0001303 (50 iterations in 0.032s)
[t-SNE] Iteration 800: error = 0.8670652, gradient norm = 0.0001106 (50 iterations in 0.032s)
[t-SNE] Iteration 850: error = 0.8672038, gradient norm = 0.0000956 (50 iterations in 0.032s)
[t-SNE] Iteration 900: error = 0.8672730, gradient norm = 0.0000755 (50 iterations in 0.032s)
[t-SNE] Iteration 950: error = 0.8670719, gradient norm = 0.0001130 (50 iterations in 0.032s)
[t-SNE] Iteration 1000: error = 0.8674054, gradient norm = 0.0001239 (50 iterations in 0.032s)
[t-SNE] KL divergence after 1000 iterations: 0.867405
[t-SNE] Computed conditional probabilities for sample 286 / 286
[t-SNE] Mean sigma: 0.399517
Beginning preprocessing + Leiden
2024-03-12 00:44:03.805778 MEMORY 13.056806912
Affmat transformed
2024-03-12 00:44:03.809841 MEMORY 13.056806912
sources, targets, weights extracted
2024-03-12 00:44:03.811669 MEMORY 13.056806912
About to launch parallel Leiden runs
2024-03-12 00:44:03.861629 MEMORY 13.056806912
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.0s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    3.1s finished
Parallel Leiden runs finished
2024-03-12 00:44:06.998036 MEMORY 13.056806912
Quality: 0.36512827273029563
Quality: 0.3655697483321981
Quality: 0.365643566585881
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 273 out of 273 | elapsed:    0.1s finished
Got subclusters: Counter({0: 77, 1: 67, 2: 45, 3: 36, 4: 34, 5: 27})
On pattern 8
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 273 samples in 0.002s...
[t-SNE] Computed neighbors for 273 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 273 / 273
[t-SNE] Mean sigma: 0.389154
[t-SNE] Computed conditional probabilities in 0.020s
[t-SNE] Iteration 50: error = 62.0405960, gradient norm = 0.4990052 (50 iterations in 0.033s)
[t-SNE] Iteration 100: error = 61.1185455, gradient norm = 0.5072864 (50 iterations in 0.032s)
[t-SNE] Iteration 150: error = 63.5617142, gradient norm = 0.5036883 (50 iterations in 0.032s)
[t-SNE] Iteration 200: error = 66.9588165, gradient norm = 0.4714069 (50 iterations in 0.033s)
[t-SNE] Iteration 250: error = 62.2014923, gradient norm = 0.5086846 (50 iterations in 0.032s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 62.201492
[t-SNE] Iteration 300: error = 1.1750321, gradient norm = 0.0049385 (50 iterations in 0.031s)
[t-SNE] Iteration 350: error = 1.0506763, gradient norm = 0.0036062 (50 iterations in 0.031s)
[t-SNE] Iteration 400: error = 1.0196997, gradient norm = 0.0020641 (50 iterations in 0.031s)
[t-SNE] Iteration 450: error = 1.0119171, gradient norm = 0.0010121 (50 iterations in 0.031s)
[t-SNE] Iteration 500: error = 1.0096439, gradient norm = 0.0009017 (50 iterations in 0.030s)
[t-SNE] Iteration 550: error = 1.0011839, gradient norm = 0.0004420 (50 iterations in 0.031s)
[t-SNE] Iteration 600: error = 1.0001364, gradient norm = 0.0002566 (50 iterations in 0.031s)
[t-SNE] Iteration 650: error = 0.9999930, gradient norm = 0.0001282 (50 iterations in 0.031s)
[t-SNE] Iteration 700: error = 1.0000303, gradient norm = 0.0000978 (50 iterations in 0.030s)
[t-SNE] Iteration 750: error = 0.9998347, gradient norm = 0.0001026 (50 iterations in 0.032s)
[t-SNE] Iteration 800: error = 0.9998150, gradient norm = 0.0001200 (50 iterations in 0.031s)
[t-SNE] Iteration 850: error = 0.9998580, gradient norm = 0.0000571 (50 iterations in 0.030s)
[t-SNE] Iteration 900: error = 0.9998764, gradient norm = 0.0000830 (50 iterations in 0.031s)
[t-SNE] Iteration 950: error = 0.9998588, gradient norm = 0.0001093 (50 iterations in 0.031s)
[t-SNE] Iteration 1000: error = 0.9998163, gradient norm = 0.0001163 (50 iterations in 0.030s)
[t-SNE] KL divergence after 1000 iterations: 0.999816
[t-SNE] Computed conditional probabilities for sample 273 / 273
[t-SNE] Mean sigma: 0.389154
Beginning preprocessing + Leiden
2024-03-12 00:44:08.060277 MEMORY 13.056806912
Affmat transformed
2024-03-12 00:44:08.063829 MEMORY 13.056806912
sources, targets, weights extracted
2024-03-12 00:44:08.065439 MEMORY 13.056806912
About to launch parallel Leiden runs
2024-03-12 00:44:08.093055 MEMORY 13.056806912
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.0s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    3.0s finished
Parallel Leiden runs finished
2024-03-12 00:44:11.137929 MEMORY 13.056806912
Quality: 0.3376006854150051
Quality: 0.3394509795622936
Quality: 0.341739080666462
Quality: 0.3434210596969607
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 229 out of 229 | elapsed:    0.1s finished
Got subclusters: Counter({0: 64, 1: 58, 2: 55, 3: 53, 4: 43})
On pattern 9
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 229 samples in 0.002s...
[t-SNE] Computed neighbors for 229 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 229 / 229
[t-SNE] Mean sigma: 0.407746
[t-SNE] Computed conditional probabilities in 0.016s
[t-SNE] Iteration 50: error = 62.0722694, gradient norm = 0.4805791 (50 iterations in 0.036s)
[t-SNE] Iteration 100: error = 59.2039795, gradient norm = 0.5223703 (50 iterations in 0.029s)
[t-SNE] Iteration 150: error = 61.5160828, gradient norm = 0.4674987 (50 iterations in 0.029s)
[t-SNE] Iteration 200: error = 61.8496399, gradient norm = 0.4659227 (50 iterations in 0.029s)
[t-SNE] Iteration 250: error = 59.5676804, gradient norm = 0.4849741 (50 iterations in 0.029s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 59.567680
[t-SNE] Iteration 300: error = 0.8199738, gradient norm = 0.0050351 (50 iterations in 0.029s)
[t-SNE] Iteration 350: error = 0.7514397, gradient norm = 0.0040487 (50 iterations in 0.029s)
[t-SNE] Iteration 400: error = 0.7263264, gradient norm = 0.0009177 (50 iterations in 0.028s)
[t-SNE] Iteration 450: error = 0.7235520, gradient norm = 0.0004362 (50 iterations in 0.029s)
[t-SNE] Iteration 500: error = 0.7235134, gradient norm = 0.0002373 (50 iterations in 0.028s)
[t-SNE] Iteration 550: error = 0.7209281, gradient norm = 0.0002369 (50 iterations in 0.028s)
[t-SNE] Iteration 600: error = 0.7203724, gradient norm = 0.0002257 (50 iterations in 0.029s)
[t-SNE] Iteration 650: error = 0.7206373, gradient norm = 0.0001998 (50 iterations in 0.028s)
[t-SNE] Iteration 700: error = 0.7205479, gradient norm = 0.0001924 (50 iterations in 0.028s)
[t-SNE] Iteration 750: error = 0.7205248, gradient norm = 0.0001961 (50 iterations in 0.029s)
[t-SNE] Iteration 800: error = 0.7207202, gradient norm = 0.0001667 (50 iterations in 0.028s)
[t-SNE] Iteration 850: error = 0.7205565, gradient norm = 0.0001422 (50 iterations in 0.029s)
[t-SNE] Iteration 900: error = 0.7205553, gradient norm = 0.0001541 (50 iterations in 0.028s)
[t-SNE] Iteration 950: error = 0.7207153, gradient norm = 0.0001626 (50 iterations in 0.029s)
[t-SNE] Iteration 950: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 950 iterations: 0.720715
[t-SNE] Computed conditional probabilities for sample 229 / 229
[t-SNE] Mean sigma: 0.407746
Beginning preprocessing + Leiden
2024-03-12 00:44:12.088190 MEMORY 13.056806912
Affmat transformed
2024-03-12 00:44:12.091135 MEMORY 13.056806912
sources, targets, weights extracted
2024-03-12 00:44:12.092435 MEMORY 13.056806912
About to launch parallel Leiden runs
2024-03-12 00:44:12.138222 MEMORY 13.056806912
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.9s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.7s finished
Parallel Leiden runs finished
2024-03-12 00:44:14.829315 MEMORY 13.056806912
Quality: 0.36228892792740763
Quality: 0.3623136607579963
Quality: 0.3623644461785198
Quality: 0.3623645598196293
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 202 out of 202 | elapsed:    0.1s finished
Got subclusters: Counter({0: 65, 1: 61, 2: 46, 3: 30, 4: 27})
On pattern 10
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 202 samples in 0.002s...
[t-SNE] Computed neighbors for 202 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 202 / 202
[t-SNE] Mean sigma: 0.456668
[t-SNE] Computed conditional probabilities in 0.014s
[t-SNE] Iteration 50: error = 58.3680687, gradient norm = 0.5539331 (50 iterations in 0.027s)
[t-SNE] Iteration 100: error = 61.7855797, gradient norm = 0.4741655 (50 iterations in 0.027s)
[t-SNE] Iteration 150: error = 58.8863335, gradient norm = 0.5005323 (50 iterations in 0.027s)
[t-SNE] Iteration 200: error = 59.0087700, gradient norm = 0.4901539 (50 iterations in 0.027s)
[t-SNE] Iteration 250: error = 56.8659554, gradient norm = 0.5684949 (50 iterations in 0.027s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 56.865955
[t-SNE] Iteration 300: error = 0.9484670, gradient norm = 0.0068206 (50 iterations in 0.027s)
[t-SNE] Iteration 350: error = 0.7393870, gradient norm = 0.0036044 (50 iterations in 0.026s)
[t-SNE] Iteration 400: error = 0.7217537, gradient norm = 0.0018266 (50 iterations in 0.026s)
[t-SNE] Iteration 450: error = 0.7151191, gradient norm = 0.0002166 (50 iterations in 0.026s)
[t-SNE] Iteration 500: error = 0.7150629, gradient norm = 0.0001171 (50 iterations in 0.026s)
[t-SNE] Iteration 550: error = 0.7151030, gradient norm = 0.0000722 (50 iterations in 0.026s)
[t-SNE] Iteration 600: error = 0.7150905, gradient norm = 0.0000613 (50 iterations in 0.026s)
[t-SNE] Iteration 650: error = 0.7150915, gradient norm = 0.0000841 (50 iterations in 0.026s)
[t-SNE] Iteration 700: error = 0.7151076, gradient norm = 0.0000579 (50 iterations in 0.026s)
[t-SNE] Iteration 750: error = 0.7150434, gradient norm = 0.0000594 (50 iterations in 0.026s)
[t-SNE] Iteration 800: error = 0.7150711, gradient norm = 0.0000826 (50 iterations in 0.026s)
[t-SNE] Iteration 850: error = 0.7151582, gradient norm = 0.0001419 (50 iterations in 0.026s)
[t-SNE] Iteration 900: error = 0.7151024, gradient norm = 0.0000693 (50 iterations in 0.026s)
[t-SNE] Iteration 950: error = 0.7150773, gradient norm = 0.0000862 (50 iterations in 0.026s)
[t-SNE] Iteration 1000: error = 0.7150825, gradient norm = 0.0000634 (50 iterations in 0.026s)
[t-SNE] KL divergence after 1000 iterations: 0.715082
[t-SNE] Computed conditional probabilities for sample 202 / 202
[t-SNE] Mean sigma: 0.456669
Beginning preprocessing + Leiden
2024-03-12 00:44:15.699421 MEMORY 13.056806912
Affmat transformed
2024-03-12 00:44:15.702111 MEMORY 13.056806912
sources, targets, weights extracted
2024-03-12 00:44:15.703207 MEMORY 13.056806912
About to launch parallel Leiden runs
2024-03-12 00:44:15.741657 MEMORY 13.056806912
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.9s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.5s finished
Parallel Leiden runs finished
2024-03-12 00:44:18.291843 MEMORY 13.056806912
Quality: 0.34081284853433585
Quality: 0.34089302566637975
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 184 out of 184 | elapsed:    0.1s finished
Got subclusters: Counter({0: 64, 1: 63, 2: 53, 3: 14, 4: 8})
On pattern 11
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 184 samples in 0.002s...
[t-SNE] Computed neighbors for 184 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 184 / 184
[t-SNE] Mean sigma: 0.417523
[t-SNE] Computed conditional probabilities in 0.012s
[t-SNE] Iteration 50: error = 56.3723526, gradient norm = 0.5223815 (50 iterations in 0.039s)
[t-SNE] Iteration 100: error = 60.3141022, gradient norm = 0.4648234 (50 iterations in 0.025s)
[t-SNE] Iteration 150: error = 57.4438286, gradient norm = 0.4904767 (50 iterations in 0.025s)
[t-SNE] Iteration 200: error = 57.3381882, gradient norm = 0.5524285 (50 iterations in 0.025s)
[t-SNE] Iteration 250: error = 58.0838661, gradient norm = 0.5088754 (50 iterations in 0.025s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 58.083866
[t-SNE] Iteration 300: error = 0.8895566, gradient norm = 0.0104732 (50 iterations in 0.025s)
[t-SNE] Iteration 350: error = 0.7095969, gradient norm = 0.0034613 (50 iterations in 0.025s)
[t-SNE] Iteration 400: error = 0.6938499, gradient norm = 0.0005291 (50 iterations in 0.025s)
[t-SNE] Iteration 450: error = 0.6823114, gradient norm = 0.0005062 (50 iterations in 0.025s)
[t-SNE] Iteration 500: error = 0.6717805, gradient norm = 0.0014405 (50 iterations in 0.025s)
[t-SNE] Iteration 550: error = 0.6692865, gradient norm = 0.0003442 (50 iterations in 0.027s)
[t-SNE] Iteration 600: error = 0.6688667, gradient norm = 0.0002333 (50 iterations in 0.025s)
[t-SNE] Iteration 650: error = 0.6686763, gradient norm = 0.0003918 (50 iterations in 0.025s)
[t-SNE] Iteration 700: error = 0.6655279, gradient norm = 0.0013524 (50 iterations in 0.025s)
[t-SNE] Iteration 750: error = 0.6643822, gradient norm = 0.0001853 (50 iterations in 0.025s)
[t-SNE] Iteration 800: error = 0.6640130, gradient norm = 0.0002568 (50 iterations in 0.025s)
[t-SNE] Iteration 850: error = 0.6638680, gradient norm = 0.0002375 (50 iterations in 0.025s)
[t-SNE] Iteration 900: error = 0.6638063, gradient norm = 0.0002906 (50 iterations in 0.025s)
[t-SNE] Iteration 950: error = 0.6641724, gradient norm = 0.0002252 (50 iterations in 0.025s)
[t-SNE] Iteration 1000: error = 0.6637101, gradient norm = 0.0002984 (50 iterations in 0.025s)
[t-SNE] KL divergence after 1000 iterations: 0.663710
[t-SNE] Computed conditional probabilities for sample 184 / 184
[t-SNE] Mean sigma: 0.417523
Beginning preprocessing + Leiden
2024-03-12 00:44:19.118480 MEMORY 13.056806912
Affmat transformed
2024-03-12 00:44:19.121266 MEMORY 13.056806912
sources, targets, weights extracted
2024-03-12 00:44:19.122297 MEMORY 13.056806912
About to launch parallel Leiden runs
2024-03-12 00:44:19.149589 MEMORY 13.056806912
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.8s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.5s finished
Parallel Leiden runs finished
2024-03-12 00:44:21.607070 MEMORY 13.056806912
Quality: 0.3098001479181915
Quality: 0.3108683220215492
Quality: 0.3110412255577009
Quality: 0.3112853654245039
Quality: 0.31156973439411806
Quality: 0.31163911953709267
Quality: 0.3116696072665599
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 102 out of 149 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=24)]: Done 149 out of 149 | elapsed:    0.1s finished
Got subclusters: Counter({0: 39, 1: 36, 2: 34, 3: 32, 4: 18, 5: 14, 6: 11})
On pattern 12
[t-SNE] Computing 148 nearest neighbors...
[t-SNE] Indexed 149 samples in 0.001s...
[t-SNE] Computed neighbors for 149 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 149 / 149
[t-SNE] Mean sigma: 0.424933
[t-SNE] Computed conditional probabilities in 0.010s
[t-SNE] Iteration 50: error = 56.0109406, gradient norm = 0.5345138 (50 iterations in 0.024s)
[t-SNE] Iteration 100: error = 58.7944717, gradient norm = 0.5067306 (50 iterations in 0.026s)
[t-SNE] Iteration 150: error = 56.1756706, gradient norm = 0.5178589 (50 iterations in 0.023s)
[t-SNE] Iteration 200: error = 55.2025566, gradient norm = 0.5481914 (50 iterations in 0.023s)
[t-SNE] Iteration 250: error = 53.3045158, gradient norm = 0.5953020 (50 iterations in 0.024s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 53.304516
[t-SNE] Iteration 300: error = 0.7055389, gradient norm = 0.0127724 (50 iterations in 0.024s)
[t-SNE] Iteration 350: error = 0.5155964, gradient norm = 0.0021131 (50 iterations in 0.024s)
[t-SNE] Iteration 400: error = 0.5099828, gradient norm = 0.0004301 (50 iterations in 0.025s)
[t-SNE] Iteration 450: error = 0.5101970, gradient norm = 0.0002614 (50 iterations in 0.025s)
[t-SNE] Iteration 500: error = 0.5102192, gradient norm = 0.0002820 (50 iterations in 0.024s)
[t-SNE] Iteration 550: error = 0.5101558, gradient norm = 0.0002955 (50 iterations in 0.024s)
[t-SNE] Iteration 600: error = 0.5102257, gradient norm = 0.0002981 (50 iterations in 0.026s)
[t-SNE] Iteration 650: error = 0.5103417, gradient norm = 0.0003169 (50 iterations in 0.025s)
[t-SNE] Iteration 700: error = 0.5102152, gradient norm = 0.0002467 (50 iterations in 0.025s)
[t-SNE] Iteration 750: error = 0.5101603, gradient norm = 0.0002907 (50 iterations in 0.024s)
[t-SNE] Iteration 750: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 750 iterations: 0.510160
[t-SNE] Computed conditional probabilities for sample 149 / 149
[t-SNE] Mean sigma: 0.424933
Beginning preprocessing + Leiden
2024-03-12 00:44:22.224063 MEMORY 13.056806912
Affmat transformed
2024-03-12 00:44:22.226084 MEMORY 13.056806912
sources, targets, weights extracted
2024-03-12 00:44:22.226866 MEMORY 13.056806912
About to launch parallel Leiden runs
2024-03-12 00:44:22.297890 MEMORY 13.056806912
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.8s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.3s finished
Parallel Leiden runs finished
2024-03-12 00:44:24.572996 MEMORY 13.056806912
Quality: 0.25183653027084435
Quality: 0.25582262040858006
Quality: 0.255886465071306
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 128 out of 128 | elapsed:    0.1s finished
Got subclusters: Counter({0: 37, 1: 30, 2: 27, 3: 26, 4: 17, 5: 12})
On pattern 13
[t-SNE] Computing 127 nearest neighbors...
[t-SNE] Indexed 128 samples in 0.001s...
[t-SNE] Computed neighbors for 128 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 128 / 128
[t-SNE] Mean sigma: 0.465384
[t-SNE] Computed conditional probabilities in 0.008s
[t-SNE] Iteration 50: error = 57.3777542, gradient norm = 0.5002781 (50 iterations in 0.032s)
[t-SNE] Iteration 100: error = 54.5878334, gradient norm = 0.5669219 (50 iterations in 0.021s)
[t-SNE] Iteration 150: error = 51.2780685, gradient norm = 0.5690187 (50 iterations in 0.021s)
[t-SNE] Iteration 200: error = 52.3939590, gradient norm = 0.6504290 (50 iterations in 0.021s)
[t-SNE] Iteration 250: error = 54.2776413, gradient norm = 0.5724179 (50 iterations in 0.021s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 54.277641
[t-SNE] Iteration 300: error = 0.6239884, gradient norm = 0.0183447 (50 iterations in 0.021s)
[t-SNE] Iteration 350: error = 0.4599238, gradient norm = 0.0035687 (50 iterations in 0.021s)
[t-SNE] Iteration 400: error = 0.4452015, gradient norm = 0.0004684 (50 iterations in 0.021s)
[t-SNE] Iteration 450: error = 0.4450997, gradient norm = 0.0003166 (50 iterations in 0.021s)
[t-SNE] Iteration 500: error = 0.4450909, gradient norm = 0.0002823 (50 iterations in 0.023s)
[t-SNE] Iteration 550: error = 0.4452238, gradient norm = 0.0002786 (50 iterations in 0.021s)
[t-SNE] Iteration 600: error = 0.4457149, gradient norm = 0.0002608 (50 iterations in 0.021s)
[t-SNE] Iteration 650: error = 0.4455757, gradient norm = 0.0002116 (50 iterations in 0.021s)
[t-SNE] Iteration 700: error = 0.4454055, gradient norm = 0.0002770 (50 iterations in 0.021s)
[t-SNE] Iteration 750: error = 0.4456123, gradient norm = 0.0002469 (50 iterations in 0.021s)
[t-SNE] Iteration 800: error = 0.4453098, gradient norm = 0.0003157 (50 iterations in 0.021s)
[t-SNE] Iteration 850: error = 0.4452669, gradient norm = 0.0002164 (50 iterations in 0.021s)
[t-SNE] Iteration 850: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 850 iterations: 0.445267
[t-SNE] Computed conditional probabilities for sample 128 / 128
[t-SNE] Mean sigma: 0.465384
Beginning preprocessing + Leiden
2024-03-12 00:44:25.152499 MEMORY 13.056806912
Affmat transformed
2024-03-12 00:44:25.154718 MEMORY 13.056806912
sources, targets, weights extracted
2024-03-12 00:44:25.155468 MEMORY 13.056806912
About to launch parallel Leiden runs
2024-03-12 00:44:25.181615 MEMORY 13.056806912
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.1s finished
Parallel Leiden runs finished
2024-03-12 00:44:27.312644 MEMORY 13.056806912
Quality: 0.255841779921477
Quality: 0.2625122268981045
Quality: 0.2647920788894062
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  87 out of  87 | elapsed:    0.0s finished
Got subclusters: Counter({0: 35, 1: 32, 2: 27, 3: 26, 4: 8})
On pattern 14
[t-SNE] Computing 86 nearest neighbors...
[t-SNE] Indexed 87 samples in 0.001s...
[t-SNE] Computed neighbors for 87 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 87 / 87
[t-SNE] Mean sigma: 0.573251
[t-SNE] Computed conditional probabilities in 0.004s
[t-SNE] Iteration 50: error = 55.4171982, gradient norm = 0.4908526 (50 iterations in 0.017s)
[t-SNE] Iteration 100: error = 51.4038353, gradient norm = 0.4943902 (50 iterations in 0.017s)
[t-SNE] Iteration 150: error = 50.7079315, gradient norm = 0.5322926 (50 iterations in 0.017s)
[t-SNE] Iteration 200: error = 52.9885864, gradient norm = 0.4874762 (50 iterations in 0.017s)
[t-SNE] Iteration 250: error = 50.7747269, gradient norm = 0.5135078 (50 iterations in 0.017s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 50.774727
[t-SNE] Iteration 300: error = 0.6925657, gradient norm = 0.0047245 (50 iterations in 0.017s)
[t-SNE] Iteration 350: error = 0.4758397, gradient norm = 0.0107307 (50 iterations in 0.017s)
[t-SNE] Iteration 400: error = 0.2109323, gradient norm = 0.0047755 (50 iterations in 0.017s)
[t-SNE] Iteration 450: error = 0.2102155, gradient norm = 0.0009516 (50 iterations in 0.017s)
[t-SNE] Iteration 500: error = 0.2099223, gradient norm = 0.0006726 (50 iterations in 0.017s)
[t-SNE] Iteration 550: error = 0.2098942, gradient norm = 0.0007713 (50 iterations in 0.017s)
[t-SNE] Iteration 600: error = 0.2098216, gradient norm = 0.0008736 (50 iterations in 0.017s)
[t-SNE] Iteration 650: error = 0.2096446, gradient norm = 0.0006909 (50 iterations in 0.017s)
[t-SNE] Iteration 700: error = 0.2098366, gradient norm = 0.0007539 (50 iterations in 0.017s)
[t-SNE] Iteration 750: error = 0.2098523, gradient norm = 0.0004733 (50 iterations in 0.017s)
[t-SNE] Iteration 800: error = 0.2097666, gradient norm = 0.0007078 (50 iterations in 0.017s)
[t-SNE] Iteration 850: error = 0.2097645, gradient norm = 0.0007124 (50 iterations in 0.017s)
[t-SNE] Iteration 900: error = 0.2100575, gradient norm = 0.0008573 (50 iterations in 0.017s)
[t-SNE] Iteration 950: error = 0.2097964, gradient norm = 0.0006505 (50 iterations in 0.017s)
[t-SNE] Iteration 1000: error = 0.2100756, gradient norm = 0.0007269 (50 iterations in 0.016s)
[t-SNE] Iteration 1000: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 1000 iterations: 0.210076
[t-SNE] Computed conditional probabilities for sample 87 / 87
[t-SNE] Mean sigma: 0.573251
Beginning preprocessing + Leiden
2024-03-12 00:44:27.768097 MEMORY 13.056806912
Affmat transformed
2024-03-12 00:44:27.769267 MEMORY 13.056806912
sources, targets, weights extracted
2024-03-12 00:44:27.769743 MEMORY 13.056806912
About to launch parallel Leiden runs
2024-03-12 00:44:27.774123 MEMORY 13.056806912
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.0s finished
Parallel Leiden runs finished
2024-03-12 00:44:29.774727 MEMORY 13.056806912
Quality: 0.21469640269046128
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  80 out of  80 | elapsed:    0.0s finished
Got subclusters: Counter({0: 35, 1: 32, 2: 20})
On pattern 15
[t-SNE] Computing 79 nearest neighbors...
[t-SNE] Indexed 80 samples in 0.001s...
[t-SNE] Computed neighbors for 80 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 80 / 80
[t-SNE] Mean sigma: 0.637819
[t-SNE] Computed conditional probabilities in 0.003s
[t-SNE] Iteration 50: error = 51.5992546, gradient norm = 0.4837724 (50 iterations in 0.017s)
[t-SNE] Iteration 100: error = 49.2786827, gradient norm = 0.5158642 (50 iterations in 0.017s)
[t-SNE] Iteration 150: error = 48.4882240, gradient norm = 0.4614796 (50 iterations in 0.016s)
[t-SNE] Iteration 200: error = 49.7247162, gradient norm = 0.4742535 (50 iterations in 0.017s)
[t-SNE] Iteration 250: error = 53.5538254, gradient norm = 0.4803481 (50 iterations in 0.017s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 53.553825
[t-SNE] Iteration 300: error = 0.8825377, gradient norm = 0.0026434 (50 iterations in 0.017s)
[t-SNE] Iteration 350: error = 0.7416054, gradient norm = 0.0014208 (50 iterations in 0.016s)
[t-SNE] Iteration 400: error = 0.6577971, gradient norm = 0.0009644 (50 iterations in 0.016s)
[t-SNE] Iteration 450: error = 0.6079547, gradient norm = 0.0014951 (50 iterations in 0.016s)
[t-SNE] Iteration 500: error = 0.5749882, gradient norm = 0.0008265 (50 iterations in 0.017s)
[t-SNE] Iteration 550: error = 0.5530959, gradient norm = 0.0006618 (50 iterations in 0.021s)
[t-SNE] Iteration 600: error = 0.5315748, gradient norm = 0.0013567 (50 iterations in 0.018s)
[t-SNE] Iteration 650: error = 0.4113679, gradient norm = 0.0208412 (50 iterations in 0.017s)
[t-SNE] Iteration 700: error = 0.1774105, gradient norm = 0.0062643 (50 iterations in 0.017s)
[t-SNE] Iteration 750: error = 0.1761945, gradient norm = 0.0007799 (50 iterations in 0.017s)
[t-SNE] Iteration 800: error = 0.1762318, gradient norm = 0.0009498 (50 iterations in 0.017s)
[t-SNE] Iteration 850: error = 0.1762831, gradient norm = 0.0008303 (50 iterations in 0.017s)
[t-SNE] Iteration 900: error = 0.1763222, gradient norm = 0.0009655 (50 iterations in 0.017s)
[t-SNE] Iteration 950: error = 0.1763501, gradient norm = 0.0008516 (50 iterations in 0.017s)
[t-SNE] Iteration 1000: error = 0.1762560, gradient norm = 0.0010974 (50 iterations in 0.017s)
[t-SNE] KL divergence after 1000 iterations: 0.176256
[t-SNE] Computed conditional probabilities for sample 80 / 80
[t-SNE] Mean sigma: 0.637819
Beginning preprocessing + Leiden
2024-03-12 00:44:30.225772 MEMORY 13.056806912
Affmat transformed
2024-03-12 00:44:30.226970 MEMORY 13.056806912
sources, targets, weights extracted
2024-03-12 00:44:30.227475 MEMORY 13.056806912
About to launch parallel Leiden runs
2024-03-12 00:44:30.282170 MEMORY 13.056806912
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.0s finished
Parallel Leiden runs finished
2024-03-12 00:44:32.260108 MEMORY 13.056806912
Quality: 0.19016699354438651
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  51 out of  51 | elapsed:    0.0s finished
Got subclusters: Counter({0: 39, 1: 24, 2: 17})
On pattern 16
[t-SNE] Computing 50 nearest neighbors...
[t-SNE] Indexed 51 samples in 0.000s...
[t-SNE] Computed neighbors for 51 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 51 / 51
[t-SNE] Mean sigma: 11.723122
[t-SNE] Computed conditional probabilities in 0.001s
[t-SNE] Iteration 50: error = 46.7195053, gradient norm = 0.4481156 (50 iterations in 0.047s)
[t-SNE] Iteration 100: error = 46.1208038, gradient norm = 0.4909516 (50 iterations in 0.014s)
[t-SNE] Iteration 150: error = 42.9561272, gradient norm = 0.4561576 (50 iterations in 0.014s)
[t-SNE] Iteration 200: error = 40.5693283, gradient norm = 0.4461800 (50 iterations in 0.014s)
[t-SNE] Iteration 250: error = 40.7956734, gradient norm = 0.7110342 (50 iterations in 0.014s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 40.795673
[t-SNE] Iteration 300: error = 0.6355536, gradient norm = 0.0008329 (50 iterations in 0.013s)
[t-SNE] Iteration 350: error = 0.6180592, gradient norm = 0.0001775 (50 iterations in 0.013s)
[t-SNE] Iteration 400: error = 0.6158653, gradient norm = 0.0001558 (50 iterations in 0.013s)
[t-SNE] Iteration 450: error = 0.6153423, gradient norm = 0.0001025 (50 iterations in 0.013s)
[t-SNE] Iteration 500: error = 0.6131064, gradient norm = 0.0006256 (50 iterations in 0.013s)
[t-SNE] Iteration 550: error = 0.8602064, gradient norm = 0.0605113 (50 iterations in 0.013s)
[t-SNE] Iteration 600: error = 0.7701235, gradient norm = 0.0010583 (50 iterations in 0.013s)
[t-SNE] Iteration 650: error = 0.6804556, gradient norm = 0.0002986 (50 iterations in 0.013s)
[t-SNE] Iteration 700: error = 0.6319494, gradient norm = 0.0002489 (50 iterations in 0.013s)
[t-SNE] Iteration 750: error = 0.6212810, gradient norm = 0.0000531 (50 iterations in 0.013s)
[t-SNE] Iteration 800: error = 0.6198219, gradient norm = 0.0000517 (50 iterations in 0.013s)
[t-SNE] Iteration 850: error = 0.6190602, gradient norm = 0.0000343 (50 iterations in 0.013s)
[t-SNE] Iteration 850: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 850 iterations: 0.619060
[t-SNE] Computed conditional probabilities for sample 51 / 51
[t-SNE] Mean sigma: 11.785314
Beginning preprocessing + Leiden
2024-03-12 00:44:32.589506 MEMORY 13.056806912
Affmat transformed
2024-03-12 00:44:32.590445 MEMORY 13.056806912
sources, targets, weights extracted
2024-03-12 00:44:32.590862 MEMORY 13.056806912
About to launch parallel Leiden runs
2024-03-12 00:44:32.645907 MEMORY 13.056806912
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.8s finished
Parallel Leiden runs finished
2024-03-12 00:44:34.483776 MEMORY 13.056806912
Quality: 4.218847493575592e-15
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done  38 out of  42 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=24)]: Done  42 out of  42 | elapsed:    0.0s finished
Got subclusters: Counter({0: 51})
On pattern 17
[t-SNE] Computing 41 nearest neighbors...
[t-SNE] Indexed 42 samples in 0.001s...
[t-SNE] Computed neighbors for 42 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 42 / 42
[t-SNE] Mean sigma: 22.832194
[t-SNE] Computed conditional probabilities in 0.001s
[t-SNE] Iteration 50: error = 42.7344475, gradient norm = 0.7148606 (50 iterations in 0.019s)
[t-SNE] Iteration 100: error = 46.5889091, gradient norm = 0.6780425 (50 iterations in 0.014s)
[t-SNE] Iteration 150: error = 42.5325508, gradient norm = 0.4177661 (50 iterations in 0.014s)
[t-SNE] Iteration 200: error = 42.4846649, gradient norm = 0.3039044 (50 iterations in 0.014s)
[t-SNE] Iteration 250: error = 41.9853935, gradient norm = 0.5553961 (50 iterations in 0.014s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 41.985394
[t-SNE] Iteration 300: error = 0.6035308, gradient norm = 0.0008781 (50 iterations in 0.014s)
[t-SNE] Iteration 350: error = 0.5777701, gradient norm = 0.0001869 (50 iterations in 0.014s)
[t-SNE] Iteration 400: error = 0.5750170, gradient norm = 0.0000554 (50 iterations in 0.014s)
[t-SNE] Iteration 450: error = 0.5746137, gradient norm = 0.0000330 (50 iterations in 0.014s)
[t-SNE] Iteration 500: error = 0.5745019, gradient norm = 0.0000335 (50 iterations in 0.014s)
[t-SNE] Iteration 550: error = 0.5741590, gradient norm = 0.0000405 (50 iterations in 0.014s)
[t-SNE] Iteration 600: error = 0.5723917, gradient norm = 0.0000985 (50 iterations in 0.014s)
[t-SNE] Iteration 650: error = 0.5640401, gradient norm = 0.0080981 (50 iterations in 0.014s)
[t-SNE] Iteration 700: error = 0.6709428, gradient norm = 0.0014714 (50 iterations in 0.014s)
[t-SNE] Iteration 750: error = 0.5866889, gradient norm = 0.0002909 (50 iterations in 0.014s)
[t-SNE] Iteration 800: error = 0.5788245, gradient norm = 0.0000850 (50 iterations in 0.014s)
[t-SNE] Iteration 850: error = 0.5763348, gradient norm = 0.0000427 (50 iterations in 0.014s)
[t-SNE] Iteration 900: error = 0.5757945, gradient norm = 0.0000397 (50 iterations in 0.014s)
[t-SNE] Iteration 950: error = 0.5751072, gradient norm = 0.0000333 (50 iterations in 0.014s)
[t-SNE] Iteration 1000: error = 0.5745050, gradient norm = 0.0000525 (50 iterations in 0.014s)
[t-SNE] Iteration 1000: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 1000 iterations: 0.574505
[t-SNE] Computed conditional probabilities for sample 42 / 42
[t-SNE] Mean sigma: 1125899906842624.000000
Beginning preprocessing + Leiden
2024-03-12 00:44:34.817310 MEMORY 13.056806912
Affmat transformed
2024-03-12 00:44:34.818180 MEMORY 13.056806912
sources, targets, weights extracted
2024-03-12 00:44:34.818552 MEMORY 13.056806912
About to launch parallel Leiden runs
2024-03-12 00:44:34.852570 MEMORY 13.056806912
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.9s finished
Parallel Leiden runs finished
2024-03-12 00:44:36.729125 MEMORY 13.056806912
Quality: -1.905142710256783e-13
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done  14 out of  30 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=24)]: Done  30 out of  30 | elapsed:    0.0s finished
Got subclusters: Counter({0: 42})
On pattern 18
[t-SNE] Computing 29 nearest neighbors...
[t-SNE] Indexed 30 samples in 0.001s...
[t-SNE] Computed neighbors for 30 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 30 / 30
[t-SNE] Mean sigma: 13.603685
[t-SNE] Computed conditional probabilities in 0.001s
[t-SNE] Iteration 50: error = 48.8252640, gradient norm = 0.5373192 (50 iterations in 0.013s)
[t-SNE] Iteration 100: error = 43.6821480, gradient norm = 0.5386305 (50 iterations in 0.013s)
[t-SNE] Iteration 150: error = 43.1329079, gradient norm = 0.6022826 (50 iterations in 0.013s)
[t-SNE] Iteration 200: error = 50.8110085, gradient norm = 0.3521021 (50 iterations in 0.013s)
[t-SNE] Iteration 250: error = 44.9909401, gradient norm = 0.4331905 (50 iterations in 0.013s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 44.990940
[t-SNE] Iteration 300: error = 0.5664289, gradient norm = 0.0009113 (50 iterations in 0.013s)
[t-SNE] Iteration 350: error = 0.5028543, gradient norm = 0.0001343 (50 iterations in 0.013s)
[t-SNE] Iteration 400: error = 0.5007361, gradient norm = 0.0000633 (50 iterations in 0.013s)
[t-SNE] Iteration 450: error = 0.5001402, gradient norm = 0.0000346 (50 iterations in 0.013s)
[t-SNE] Iteration 500: error = 0.4994861, gradient norm = 0.0000357 (50 iterations in 0.013s)
[t-SNE] Iteration 550: error = 0.4990925, gradient norm = 0.0000220 (50 iterations in 0.013s)
[t-SNE] Iteration 600: error = 0.4991608, gradient norm = 0.0000208 (50 iterations in 0.013s)
[t-SNE] Iteration 650: error = 0.4990238, gradient norm = 0.0000200 (50 iterations in 0.013s)
[t-SNE] Iteration 700: error = 0.4992202, gradient norm = 0.0000182 (50 iterations in 0.013s)
[t-SNE] Iteration 750: error = 0.4988244, gradient norm = 0.0000282 (50 iterations in 0.013s)
[t-SNE] Iteration 800: error = 0.4984099, gradient norm = 0.0000489 (50 iterations in 0.013s)
[t-SNE] Iteration 850: error = 0.4989448, gradient norm = 0.0000320 (50 iterations in 0.013s)
[t-SNE] Iteration 900: error = 0.4986230, gradient norm = 0.0003830 (50 iterations in 0.013s)
[t-SNE] Iteration 950: error = 0.4964581, gradient norm = 0.0004371 (50 iterations in 0.013s)
[t-SNE] Iteration 1000: error = 0.4972441, gradient norm = 0.0002514 (50 iterations in 0.013s)
[t-SNE] KL divergence after 1000 iterations: 0.497244
[t-SNE] Computed conditional probabilities for sample 30 / 30
[t-SNE] Mean sigma: 1125899906842624.000000
Beginning preprocessing + Leiden
2024-03-12 00:44:37.025808 MEMORY 13.056806912
Affmat transformed
2024-03-12 00:44:37.026630 MEMORY 13.056806912
sources, targets, weights extracted
2024-03-12 00:44:37.026979 MEMORY 13.056806912
About to launch parallel Leiden runs
2024-03-12 00:44:37.058548 MEMORY 13.056806912
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.9s finished
Parallel Leiden runs finished
2024-03-12 00:44:38.939603 MEMORY 13.056806912
Quality: 1.9095836023552904e-14
Got subclusters: Counter({0: 30})
On metacluster 2
Metacluster size 10875
Relevant tasks:  ('testis',)
Relevant signs:  (1,)
TfModiscoSeqletsToPatternsFactory: seed=1234
(Round 1) num seqlets: 10875
(Round 1) Computing coarse affmat
2024-03-12 00:44:40.841791 MEMORY 13.055496192
Beginning embedding computation
MEMORY 13.055496192
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 152 tasks      | elapsed:    2.4s
[Parallel(n_jobs=24)]: Done 402 tasks      | elapsed:    5.8s
[Parallel(n_jobs=24)]: Done 752 tasks      | elapsed:   10.6s
[Parallel(n_jobs=24)]: Done 1202 tasks      | elapsed:   16.8s
[Parallel(n_jobs=24)]: Done 1752 tasks      | elapsed:   24.4s
[Parallel(n_jobs=24)]: Done 2402 tasks      | elapsed:   33.4s
[Parallel(n_jobs=24)]: Done 3152 tasks      | elapsed:   43.6s
[Parallel(n_jobs=24)]: Done 4002 tasks      | elapsed:   55.3s
[Parallel(n_jobs=24)]: Done 4952 tasks      | elapsed:  1.1min
[Parallel(n_jobs=24)]: Done 6002 tasks      | elapsed:  1.4min
[Parallel(n_jobs=24)]: Done 7152 tasks      | elapsed:  1.6min
[Parallel(n_jobs=24)]: Done 8402 tasks      | elapsed:  1.9min
[Parallel(n_jobs=24)]: Done 9752 tasks      | elapsed:  2.2min
[Parallel(n_jobs=24)]: Done 10875 out of 10875 | elapsed:  2.5min finished
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 152 tasks      | elapsed:    2.3s
[Parallel(n_jobs=24)]: Done 402 tasks      | elapsed:    5.6s
[Parallel(n_jobs=24)]: Done 752 tasks      | elapsed:   10.2s
[Parallel(n_jobs=24)]: Done 1202 tasks      | elapsed:   16.5s
[Parallel(n_jobs=24)]: Done 1752 tasks      | elapsed:   24.1s
[Parallel(n_jobs=24)]: Done 2402 tasks      | elapsed:   32.9s
[Parallel(n_jobs=24)]: Done 3152 tasks      | elapsed:   43.0s
[Parallel(n_jobs=24)]: Done 4002 tasks      | elapsed:   54.6s
[Parallel(n_jobs=24)]: Done 4952 tasks      | elapsed:  1.1min
[Parallel(n_jobs=24)]: Done 6002 tasks      | elapsed:  1.4min
[Parallel(n_jobs=24)]: Done 7152 tasks      | elapsed:  1.6min
[Parallel(n_jobs=24)]: Done 8402 tasks      | elapsed:  1.9min
[Parallel(n_jobs=24)]: Done 9752 tasks      | elapsed:  2.2min
[Parallel(n_jobs=24)]: Done 10875 out of 10875 | elapsed:  2.5min finished
At the beginning of embedding call
2024-03-12 00:44:40.842092 MEMORY 13.055496192
before computing embeddings fwd
2024-03-12 00:44:40.852500 MEMORY 13.055496192
after computing embeddings fwd
2024-03-12 00:47:09.167803 MEMORY 13.055496192
after computing embeddings rev
2024-03-12 00:49:36.731215 MEMORY 13.417734144
before computing sparse embeddings fwd
2024-03-12 00:49:36.731354 MEMORY 13.417734144
Constructing csr matrix...
csr matrix made in 1.575108528137207 s
after computing sparse embeddings fwd
2024-03-12 00:49:38.850259 MEMORY 13.483073536
before computing sparse embeddings rev
2024-03-12 00:49:38.859400 MEMORY 13.483073536
Constructing csr matrix...
csr matrix made in 1.4959373474121094 s
after computing sparse embeddings rev
2024-03-12 00:49:40.881387 MEMORY 13.548593152
Finished embedding computation in 302.19 s
MEMORY 13.212786688
Starting affinity matrix computations
MEMORY 13.2122624
Batching in slices of size 6170
  0%|          | 0/2 [00:00<?, ?it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:09<00:09,  9.04s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:16<00:00,  8.02s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:16<00:00,  8.18s/it]
Finished affinity matrix computations in 16.43 s
MEMORY 13.233897472
(Round 1) Computed coarse affmat
2024-03-12 00:50:00.968822 MEMORY 13.103120384
(Round 1) Computing affinity matrix on nearest neighbors
2024-03-12 00:50:00.969026 MEMORY 13.103120384
Launching nearest neighbors affmat calculation job
MEMORY 13.103120384
Parallel runs completed
MEMORY 13.100261376
Job completed in: 36.26 s
MEMORY 13.095993344
Launching nearest neighbors affmat calculation job
MEMORY 13.095718912
Parallel runs completed
MEMORY 13.139390464
Job completed in: 36.62 s
MEMORY 13.139464192
(Round 1) Computed affinity matrix on nearest neighbors in 75.98 s
2024-03-12 00:51:16.950923 MEMORY 13.137637376
Filtered down to 10002 of 10875
(Round 1) Retained 10002 rows out of 10875 after filtering
2024-03-12 00:51:24.050032 MEMORY 13.137637376
(Round 1) Computing density adapted affmat
2024-03-12 00:51:27.269991 MEMORY 13.137637376
Symmetrizing nearest neighbors
Computing betas for density adaptation
Computing normalizing denominators
(Round 1) Computing clustering
2024-03-12 00:52:57.391572 MEMORY 13.194539008
Beginning preprocessing + Leiden
2024-03-12 00:52:57.407959 MEMORY 13.194539008
Affmat transformed
2024-03-12 00:52:57.408188 MEMORY 13.194539008
sources, targets, weights extracted
2024-03-12 00:52:57.784658 MEMORY 13.26651392
About to launch parallel Leiden runs
2024-03-12 00:52:57.903781 MEMORY 13.15510272
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:  1.0min
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:  4.8min finished
Parallel Leiden runs finished
2024-03-12 00:57:46.606537 MEMORY 13.15510272
Quality: 0.3769068385251683
Quality: 0.376916366017024
Quality: 0.3769249771410962
Quality: 0.37692862944978556
Quality: 0.37692868904266363
Got 6 clusters after round 1
Counts:
{5: 1005, 4: 1073, 2: 1910, 3: 1905, 1: 1968, 0: 2141}
2024-03-12 00:57:46.639199 MEMORY 13.071446016
(Round 1) Aggregating seqlets in each cluster
2024-03-12 00:57:46.639331 MEMORY 13.071446016
Aggregating for cluster 0 with 2141 seqlets
2024-03-12 00:57:46.644982 MEMORY 13.071446016
Skipped 3 due to duplicates
Trimming eliminated 0 seqlets out of 2138
Aggregating for cluster 1 with 1968 seqlets
2024-03-12 00:57:52.807406 MEMORY 13.071446016
Skipped 3 due to duplicates
Trimming eliminated 0 seqlets out of 1965
Aggregating for cluster 2 with 1910 seqlets
2024-03-12 00:57:58.490583 MEMORY 13.071446016
Skipped 1 due to duplicates
Trimming eliminated 0 seqlets out of 1909
Aggregating for cluster 3 with 1905 seqlets
2024-03-12 00:58:03.741048 MEMORY 13.071446016
Skipped 1 due to duplicates
Trimming eliminated 0 seqlets out of 1904
Aggregating for cluster 4 with 1073 seqlets
2024-03-12 00:58:10.836754 MEMORY 13.071446016
Skipped 5 seqlets that went over sequence edge during flank expansion
Skipped 3 due to duplicates
Trimming eliminated 0 seqlets out of 1065
Aggregating for cluster 5 with 1005 seqlets
2024-03-12 00:58:14.453828 MEMORY 13.071446016
Skipped 2 due to duplicates
Trimming eliminated 0 seqlets out of 1003
(Round 2) num seqlets: 9983
(Round 2) Computing coarse affmat
2024-03-12 00:58:18.601256 MEMORY 13.071446016
Beginning embedding computation
MEMORY 13.071446016
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 272 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done 1272 tasks      | elapsed:    2.3s
[Parallel(n_jobs=24)]: Done 2672 tasks      | elapsed:    4.4s
[Parallel(n_jobs=24)]: Done 4472 tasks      | elapsed:    7.2s
[Parallel(n_jobs=24)]: Done 6672 tasks      | elapsed:   10.5s
[Parallel(n_jobs=24)]: Done 9272 tasks      | elapsed:   14.4s
[Parallel(n_jobs=24)]: Done 9936 out of 9983 | elapsed:   15.4s remaining:    0.1s
[Parallel(n_jobs=24)]: Done 9983 out of 9983 | elapsed:   15.5s finished
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 272 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done 1272 tasks      | elapsed:    2.3s
[Parallel(n_jobs=24)]: Done 2672 tasks      | elapsed:    4.4s
[Parallel(n_jobs=24)]: Done 4472 tasks      | elapsed:    7.3s
[Parallel(n_jobs=24)]: Done 6672 tasks      | elapsed:   10.7s
[Parallel(n_jobs=24)]: Done 9272 tasks      | elapsed:   14.7s
[Parallel(n_jobs=24)]: Done 9936 out of 9983 | elapsed:   15.7s remaining:    0.1s
[Parallel(n_jobs=24)]: Done 9983 out of 9983 | elapsed:   15.8s finished
At the beginning of embedding call
2024-03-12 00:58:18.601578 MEMORY 13.071446016
before computing embeddings fwd
2024-03-12 00:58:18.612237 MEMORY 13.071446016
after computing embeddings fwd
2024-03-12 00:58:34.084864 MEMORY 13.27050752
after computing embeddings rev
2024-03-12 00:58:49.840674 MEMORY 13.682327552
before computing sparse embeddings fwd
2024-03-12 00:58:49.840788 MEMORY 13.682327552
Constructing csr matrix...
csr matrix made in 1.3591501712799072 s
after computing sparse embeddings fwd
2024-03-12 00:58:51.660729 MEMORY 13.87495424
before computing sparse embeddings rev
2024-03-12 00:58:51.660854 MEMORY 13.87495424
Constructing csr matrix...
csr matrix made in 1.3269872665405273 s
after computing sparse embeddings rev
2024-03-12 00:58:53.398783 MEMORY 13.954801664
Finished embedding computation in 37.07 s
MEMORY 13.625286656
Starting affinity matrix computations
MEMORY 13.624762368
Batching in slices of size 6722
  0%|          | 0/2 [00:00<?, ?it/s] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:10<00:10, 10.30s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:15<00:00,  7.51s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:15<00:00,  7.93s/it]
Finished affinity matrix computations in 15.9 s
MEMORY 13.6645632
(Round 2) Computed coarse affmat
2024-03-12 00:59:12.965963 MEMORY 13.351870464
(Round 2) Computing affinity matrix on nearest neighbors
2024-03-12 00:59:12.966171 MEMORY 13.351870464
Launching nearest neighbors affmat calculation job
MEMORY 13.3807104
Parallel runs completed
MEMORY 13.406724096
Job completed in: 20.52 s
MEMORY 13.404454912
Launching nearest neighbors affmat calculation job
MEMORY 13.402185728
Parallel runs completed
MEMORY 13.407649792
Job completed in: 19.37 s
MEMORY 13.407612928
(Round 2) Computed affinity matrix on nearest neighbors in 42.83 s
2024-03-12 00:59:55.799902 MEMORY 13.40536832
Not applying filtering for rounds above first round
2024-03-12 00:59:55.801098 MEMORY 13.40536832
(Round 2) Computing density adapted affmat
2024-03-12 00:59:59.373091 MEMORY 13.40536832
Symmetrizing nearest neighbors
Computing betas for density adaptation
Computing normalizing denominators
(Round 2) Computing clustering
2024-03-12 01:01:29.216414 MEMORY 13.765378048
Beginning preprocessing + Leiden
2024-03-12 01:01:29.233288 MEMORY 13.765378048
Affmat transformed
2024-03-12 01:01:29.233511 MEMORY 13.765378048
sources, targets, weights extracted
2024-03-12 01:01:29.605532 MEMORY 13.835177984
About to launch parallel Leiden runs
2024-03-12 01:01:29.720922 MEMORY 13.720461312
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:   52.3s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:  3.0min finished
Parallel Leiden runs finished
2024-03-12 01:04:30.101109 MEMORY 13.720461312
Quality: 0.4359392719858814
Quality: 0.43595526631237647
Quality: 0.4359554298091613
Quality: 0.43595574327460035
Quality: 0.4359560011097089
Got 6 clusters after round 2
Counts:
{0: 2232, 2: 1817, 3: 1708, 1: 1955, 5: 947, 4: 1324}
2024-03-12 01:04:30.129677 MEMORY 13.634322432
(Round 2) Aggregating seqlets in each cluster
2024-03-12 01:04:30.129804 MEMORY 13.634322432
Aggregating for cluster 0 with 2232 seqlets
2024-03-12 01:04:30.137033 MEMORY 13.634322432
Skipped 2 due to duplicates
Trimming eliminated 0 seqlets out of 2230
Aggregating for cluster 1 with 1955 seqlets
2024-03-12 01:04:35.018736 MEMORY 13.634322432
Skipped 1 due to duplicates
Trimming eliminated 0 seqlets out of 1954
Aggregating for cluster 2 with 1817 seqlets
2024-03-12 01:04:39.027902 MEMORY 13.634322432
Skipped 2 due to duplicates
Trimming eliminated 0 seqlets out of 1815
Aggregating for cluster 3 with 1708 seqlets
2024-03-12 01:04:42.517904 MEMORY 13.634322432
Skipped 2 due to duplicates
Trimming eliminated 0 seqlets out of 1706
Aggregating for cluster 4 with 1324 seqlets
2024-03-12 01:04:47.220059 MEMORY 13.634322432
Skipped 1 due to duplicates
Trimming eliminated 0 seqlets out of 1323
Aggregating for cluster 5 with 947 seqlets
2024-03-12 01:04:50.035223 MEMORY 13.634322432
Trimming eliminated 0 seqlets out of 947
Got 6 clusters
Splitting into subclusters...
2024-03-12 01:04:52.019476 MEMORY 13.634322432
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 1974 tasks      | elapsed:    0.5s
[Parallel(n_jobs=24)]: Done 2230 out of 2230 | elapsed:    0.6s finished
Inspecting pattern 0 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 2230
[t-SNE] Computed conditional probabilities for sample 2000 / 2230
[t-SNE] Computed conditional probabilities for sample 2230 / 2230
[t-SNE] Mean sigma: 0.335841
Beginning preprocessing + Leiden
2024-03-12 01:04:55.033194 MEMORY 13.634322432
Affmat transformed
2024-03-12 01:04:55.062998 MEMORY 13.634322432
sources, targets, weights extracted
2024-03-12 01:04:55.079126 MEMORY 13.634322432
About to launch parallel Leiden runs
2024-03-12 01:04:55.139418 MEMORY 13.634322432
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    8.3s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   31.2s finished
Parallel Leiden runs finished
2024-03-12 01:05:26.327623 MEMORY 13.634322432
Quality: 0.4868455743582325
Quality: 0.4872959913237804
Quality: 0.4874704671787376
Quality: 0.48831908084943537
Got subclusters: Counter({0: 409, 1: 353, 2: 331, 3: 304, 4: 301, 5: 286, 6: 200, 7: 46})
On merging iteration 1
Numbers for each pattern pre-subsample: [409, 353, 331, 304, 301, 286, 200, 46]
Numbers after subsampling: [300, 300, 300, 300, 300, 286, 200, 46]
Computing sims for pattern 0
Computed sims for pattern 0 in 2.3221516609191895 s
Computing sims for pattern 1
Computed sims for pattern 1 in 2.3597185611724854 s
Computing sims for pattern 2
Computed sims for pattern 2 in 2.384263038635254 s
Computing sims for pattern 3
Computed sims for pattern 3 in 2.408475637435913 s
Computing sims for pattern 4
Computed sims for pattern 4 in 2.462843418121338 s
Computing sims for pattern 5
Computed sims for pattern 5 in 2.3194150924682617 s
Computing sims for pattern 6
Computed sims for pattern 6 in 1.8987736701965332 s
Computing sims for pattern 7
Computed sims for pattern 7 in 0.5939517021179199 s
Cluster sizes
[409 353 331 304 301 286 200  46]
Cross-contamination matrix:
[[1.   0.47 0.6  0.35 0.35 0.5  0.7  0.71]
 [0.6  1.   0.79 0.5  0.22 0.53 0.63 0.54]
 [0.66 0.71 1.   0.53 0.6  0.57 0.73 0.73]
 [0.23 0.55 0.63 1.   0.83 0.7  0.24 0.26]
 [0.53 0.3  0.46 0.56 1.   0.57 0.43 0.45]
 [0.65 0.56 0.65 0.67 0.83 1.   0.79 0.85]
 [0.69 0.51 0.67 0.4  0.77 0.63 1.   0.7 ]
 [0.57 0.43 0.57 0.38 0.46 0.59 0.62 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.63 0.71 0.53 0.79 0.69 0.8  0.77]
 [0.63 1.   0.91 0.71 0.67 0.76 0.74 0.76]
 [0.71 0.91 1.   0.69 0.69 0.75 0.8  0.84]
 [0.53 0.71 0.69 1.   0.76 0.68 0.68 0.55]
 [0.79 0.67 0.69 0.76 1.   0.84 0.88 0.67]
 [0.69 0.76 0.75 0.68 0.84 1.   0.85 0.78]
 [0.8  0.74 0.8  0.68 0.88 0.85 1.   0.79]
 [0.77 0.76 0.84 0.55 0.67 0.78 0.79 1.  ]]
Collapsing 1 & 2 with crosscontam 0.7079339269135803 and sim 0.9097708615832721
Collapsing 5 & 6 with crosscontam 0.6310783601398602 and sim 0.8539685021003731
Trimming eliminated 0 seqlets out of 684
Trimming eliminated 0 seqlets out of 486
Unmerged patterns remapping: OrderedDict([(0, 2), (3, 3), (4, 4), (7, 5)])
Time spent on merging iteration: 3.1530137062072754
On merging iteration 2
Numbers for each pattern pre-subsample: [684, 486, 409, 304, 301, 46]
Numbers after subsampling: [300, 300, 300, 300, 300, 46]
Computing sims for pattern 0
Computed sims for pattern 0 in 1.759103536605835 s
Computing sims for pattern 1
Computed sims for pattern 1 in 1.760831594467163 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.730677604675293 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.7634720802307129 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.7326934337615967 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.17366504669189453 s
Cluster sizes
[684 486 409 304 301  46]
Cross-contamination matrix:
[[1.   0.78 0.81 0.67 0.44 0.81]
 [0.73 1.   0.82 0.73 0.96 0.93]
 [0.5  0.57 1.   0.35 0.35 0.71]
 [0.55 0.66 0.23 1.   0.83 0.26]
 [0.36 0.61 0.53 0.56 1.   0.45]
 [0.45 0.58 0.57 0.38 0.46 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.82 0.69 0.68 0.7  0.8 ]
 [0.82 1.   0.77 0.63 0.88 0.8 ]
 [0.69 0.77 1.   0.53 0.79 0.77]
 [0.68 0.63 0.53 1.   0.76 0.55]
 [0.7  0.88 0.79 0.76 1.   0.67]
 [0.8  0.8  0.77 0.55 0.67 1.  ]]
Collapsing 1 & 4 with crosscontam 0.6090902809876544 and sim 0.8828376958322557
Skipped 1 due to duplicates
Trimming eliminated 0 seqlets out of 786
Unmerged patterns remapping: OrderedDict([(0, 1), (2, 2), (3, 3), (5, 4)])
Time spent on merging iteration: 3.1188130378723145
On merging iteration 3
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 1650 tasks      | elapsed:    0.4s
[Parallel(n_jobs=24)]: Done 1954 out of 1954 | elapsed:    0.5s finished
Numbers for each pattern pre-subsample: [786, 684, 409, 304, 46]
Numbers after subsampling: [300, 300, 300, 300, 46]
Computing sims for pattern 0
Computed sims for pattern 0 in 1.39365816116333 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.3734626770019531 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.37029075622558594 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.3760406970977783 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.09453058242797852 s
Cluster sizes
[786 684 409 304  46]
Cross-contamination matrix:
[[1.   0.78 0.89 0.75 0.92]
 [0.74 1.   0.81 0.67 0.81]
 [0.55 0.5  1.   0.35 0.71]
 [0.67 0.55 0.23 1.   0.26]
 [0.5  0.45 0.57 0.38 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.82 0.78 0.67 0.78]
 [0.82 1.   0.69 0.68 0.8 ]
 [0.78 0.69 1.   0.53 0.77]
 [0.67 0.68 0.53 1.   0.55]
 [0.78 0.8  0.77 0.55 1.  ]]
Inspecting pattern 1 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 1954
[t-SNE] Computed conditional probabilities for sample 1954 / 1954
[t-SNE] Mean sigma: 0.315476
Beginning preprocessing + Leiden
2024-03-12 01:06:00.997968 MEMORY 13.634322432
Affmat transformed
2024-03-12 01:06:01.024335 MEMORY 13.634322432
sources, targets, weights extracted
2024-03-12 01:06:01.039499 MEMORY 13.634322432
About to launch parallel Leiden runs
2024-03-12 01:06:01.097288 MEMORY 13.634322432
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    6.8s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   22.9s finished
Parallel Leiden runs finished
2024-03-12 01:06:23.969584 MEMORY 13.634322432
Quality: 0.4819675174354024
Quality: 0.4822485574640208
Quality: 0.48289111354694475
Quality: 0.4841764717100329
Quality: 0.4843001566638578
Quality: 0.4847844855463033
Got subclusters: Counter({1: 343, 0: 343, 2: 290, 3: 270, 4: 254, 5: 181, 6: 152, 7: 96, 8: 25})
On merging iteration 1
Numbers for each pattern pre-subsample: [343, 343, 290, 270, 254, 181, 152, 96, 25]
Numbers after subsampling: [300, 300, 290, 270, 254, 181, 152, 96, 25]
Computing sims for pattern 0
Computed sims for pattern 0 in 2.56032657623291 s
Computing sims for pattern 1
Computed sims for pattern 1 in 2.668642044067383 s
Computing sims for pattern 2
Computed sims for pattern 2 in 2.553396224975586 s
Computing sims for pattern 3
Computed sims for pattern 3 in 2.284791946411133 s
Computing sims for pattern 4
Computed sims for pattern 4 in 2.081374406814575 s
Computing sims for pattern 5
Computed sims for pattern 5 in 1.8022170066833496 s
Computing sims for pattern 6
Computed sims for pattern 6 in 1.4471397399902344 s
Computing sims for pattern 7
Computed sims for pattern 7 in 0.9745907783508301 s
Computing sims for pattern 8
Computed sims for pattern 8 in 0.42461514472961426 s
Cluster sizes
[343 343 290 270 254 181 152  96  25]
Cross-contamination matrix:
[[1.   0.66 0.7  0.92 0.77 0.68 0.91 0.79 0.71]
 [0.38 1.   0.71 0.69 0.63 0.67 0.64 0.7  0.49]
 [0.38 0.73 1.   0.81 0.37 0.56 0.43 0.63 0.34]
 [0.58 0.52 0.66 1.   0.6  0.6  0.8  0.7  0.38]
 [0.64 0.76 0.63 0.78 1.   0.61 0.85 0.65 0.6 ]
 [0.54 0.75 0.62 0.74 0.53 1.   0.62 0.67 0.6 ]
 [0.56 0.6  0.52 0.77 0.66 0.45 1.   0.59 0.45]
 [0.42 0.6  0.47 0.68 0.37 0.51 0.48 1.   0.45]
 [0.15 0.31 0.13 0.27 0.23 0.35 0.3  0.34 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.76 0.75 0.89 0.89 0.79 0.93 0.82 0.72]
 [0.76 1.   0.86 0.81 0.81 0.87 0.81 0.85 0.67]
 [0.75 0.86 1.   0.82 0.71 0.78 0.77 0.77 0.65]
 [0.89 0.81 0.82 1.   0.88 0.78 0.92 0.9  0.69]
 [0.89 0.81 0.71 0.88 1.   0.76 0.9  0.81 0.67]
 [0.79 0.87 0.78 0.78 0.76 1.   0.73 0.82 0.71]
 [0.93 0.81 0.77 0.92 0.9  0.73 1.   0.88 0.71]
 [0.82 0.85 0.77 0.9  0.81 0.82 0.88 1.   0.68]
 [0.72 0.67 0.65 0.69 0.67 0.71 0.71 0.68 1.  ]]
Collapsing 0 & 6 with crosscontam 0.5630011094000584 and sim 0.9254396737284135
Collapsing 3 & 6 with crosscontam 0.7700506152702857 and sim 0.9236913077128446
Collapsing 3 & 7 with crosscontam 0.678473344130444 and sim 0.9008241530102951
Collapsing 4 & 6 with crosscontam 0.6575602970922738 and sim 0.8957708370773678
Collapsing 0 & 4 with crosscontam 0.6376311396192347 and sim 0.8948237070293966
Collapsing 0 & 3 with crosscontam 0.5815370258598791 and sim 0.8852012894924093
Collapsing 3 & 4 with crosscontam 0.5994655534313356 and sim 0.8800543497572062
Collapsing 1 & 5 with crosscontam 0.6733021158174748 and sim 0.8693764064971901
Collapsing 1 & 2 with crosscontam 0.710106851596424 and sim 0.8621446263867194
Trimming eliminated 0 seqlets out of 495
Trimming eliminated 0 seqlets out of 765
Trimming eliminated 0 seqlets out of 861
Trimming eliminated 0 seqlets out of 1115
Trimming eliminated 0 seqlets out of 524
Trimming eliminated 0 seqlets out of 814
Unmerged patterns remapping: OrderedDict([(8, 2)])
Time spent on merging iteration: 9.803385734558105
On merging iteration 2
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 1650 tasks      | elapsed:    0.4s
[Parallel(n_jobs=24)]: Done 1815 out of 1815 | elapsed:    0.4s finished
Numbers for each pattern pre-subsample: [1115, 814, 25]
Numbers after subsampling: [300, 300, 25]
Computing sims for pattern 0
Computed sims for pattern 0 in 0.6471967697143555 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.6403458118438721 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.11966228485107422 s
Cluster sizes
[1115  814   25]
Cross-contamination matrix:
[[1.   0.79 0.91]
 [0.74 1.   0.69]
 [0.27 0.25 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.73 0.72]
 [0.73 1.   0.67]
 [0.72 0.67 1.  ]]
Inspecting pattern 2 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 1815
[t-SNE] Computed conditional probabilities for sample 1815 / 1815
[t-SNE] Mean sigma: 0.318713
Beginning preprocessing + Leiden
2024-03-12 01:06:54.655787 MEMORY 13.634322432
Affmat transformed
2024-03-12 01:06:54.679149 MEMORY 13.634322432
sources, targets, weights extracted
2024-03-12 01:06:54.693179 MEMORY 13.634322432
About to launch parallel Leiden runs
2024-03-12 01:06:54.739559 MEMORY 13.634322432
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    6.4s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   22.9s finished
Parallel Leiden runs finished
2024-03-12 01:07:17.597945 MEMORY 13.634322432
Quality: 0.4669319348805804
Quality: 0.46712181903614236
Quality: 0.46815289714155417
Quality: 0.4687374339361476
Quality: 0.46997684076983914
Quality: 0.4701097046323238
Quality: 0.4707095498816743
Got subclusters: Counter({0: 351, 1: 325, 2: 275, 3: 274, 4: 233, 5: 227, 6: 130})
On merging iteration 1
Numbers for each pattern pre-subsample: [351, 325, 275, 274, 233, 227, 130]
Numbers after subsampling: [300, 300, 275, 274, 233, 227, 130]
Computing sims for pattern 0
Computed sims for pattern 0 in 2.0550906658172607 s
Computing sims for pattern 1
Computed sims for pattern 1 in 2.1282544136047363 s
Computing sims for pattern 2
Computed sims for pattern 2 in 1.8558597564697266 s
Computing sims for pattern 3
Computed sims for pattern 3 in 1.8440723419189453 s
Computing sims for pattern 4
Computed sims for pattern 4 in 1.9494407176971436 s
Computing sims for pattern 5
Computed sims for pattern 5 in 1.8489458560943604 s
Computing sims for pattern 6
Computed sims for pattern 6 in 1.1054420471191406 s
Cluster sizes
[351 325 275 274 233 227 130]
Cross-contamination matrix:
[[1.   0.67 0.48 0.78 0.6  0.68 0.49]
 [0.8  1.   0.68 0.66 0.62 0.64 0.64]
 [0.54 0.71 1.   0.66 0.49 0.81 0.52]
 [0.7  0.53 0.57 1.   0.53 0.78 0.46]
 [0.74 0.61 0.54 0.73 1.   0.73 0.54]
 [0.59 0.43 0.66 0.75 0.51 1.   0.38]
 [0.81 0.73 0.78 0.84 0.74 0.76 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.84 0.64 0.85 0.88 0.79 0.78]
 [0.84 1.   0.76 0.68 0.84 0.62 0.81]
 [0.64 0.76 1.   0.68 0.82 0.82 0.83]
 [0.85 0.68 0.68 1.   0.87 0.87 0.78]
 [0.88 0.84 0.82 0.87 1.   0.85 0.91]
 [0.79 0.62 0.82 0.87 0.85 1.   0.78]
 [0.78 0.81 0.83 0.78 0.91 0.78 1.  ]]
Collapsing 4 & 6 with crosscontam 0.5376734314825535 and sim 0.9104139347988791
Collapsing 0 & 4 with crosscontam 0.6020493632172945 and sim 0.8790574613317126
Collapsing 3 & 5 with crosscontam 0.7545739669597866 and sim 0.8687510219487705
Collapsing 3 & 4 with crosscontam 0.530126862505172 and sim 0.8661126264396923
Collapsing 0 & 3 with crosscontam 0.7049919309665638 and sim 0.850416878313981
Trimming eliminated 0 seqlets out of 363
Trimming eliminated 0 seqlets out of 714
Trimming eliminated 0 seqlets out of 501
Trimming eliminated 0 seqlets out of 1215
Unmerged patterns remapping: OrderedDict([(1, 1), (2, 2)])
Time spent on merging iteration: 6.00618052482605
On merging iteration 2
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 1650 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 1706 out of 1706 | elapsed:    0.4s finished
Numbers for each pattern pre-subsample: [1215, 325, 275]
Numbers after subsampling: [300, 300, 275]
Computing sims for pattern 0
Computed sims for pattern 0 in 0.7102029323577881 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.37615418434143066 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.3342554569244385 s
Cluster sizes
[1215  325  275]
Cross-contamination matrix:
[[1.   0.88 0.88]
 [0.65 1.   0.68]
 [0.59 0.71 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.81 0.8 ]
 [0.81 1.   0.76]
 [0.8  0.76 1.  ]]
Inspecting pattern 3 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 1706
[t-SNE] Computed conditional probabilities for sample 1706 / 1706
[t-SNE] Mean sigma: 0.339432
Beginning preprocessing + Leiden
2024-03-12 01:07:39.586213 MEMORY 13.634322432
Affmat transformed
2024-03-12 01:07:39.607739 MEMORY 13.634322432
sources, targets, weights extracted
2024-03-12 01:07:39.620237 MEMORY 13.634322432
About to launch parallel Leiden runs
2024-03-12 01:07:39.673047 MEMORY 13.634322432
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    5.3s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   16.5s finished
Parallel Leiden runs finished
2024-03-12 01:07:56.208767 MEMORY 13.634322432
Quality: 0.5226097838433672
Quality: 0.5230993847900663
Quality: 0.5234017086536036
Got subclusters: Counter({0: 324, 1: 297, 2: 246, 3: 221, 4: 201, 5: 172, 6: 159, 7: 86})
On merging iteration 1
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 1323 out of 1323 | elapsed:    0.6s finished
Numbers for each pattern pre-subsample: [324, 297, 246, 221, 201, 172, 159, 86]
Numbers after subsampling: [300, 297, 246, 221, 201, 172, 159, 86]
Computing sims for pattern 0
Computed sims for pattern 0 in 2.306239366531372 s
Computing sims for pattern 1
Computed sims for pattern 1 in 3.8066039085388184 s
Computing sims for pattern 2
Computed sims for pattern 2 in 1.7238271236419678 s
Computing sims for pattern 3
Computed sims for pattern 3 in 2.0008726119995117 s
Computing sims for pattern 4
Computed sims for pattern 4 in 1.7366905212402344 s
Computing sims for pattern 5
Computed sims for pattern 5 in 1.4413251876831055 s
Computing sims for pattern 6
Computed sims for pattern 6 in 1.3217296600341797 s
Computing sims for pattern 7
Computed sims for pattern 7 in 0.8810751438140869 s
Cluster sizes
[324 297 246 221 201 172 159  86]
Cross-contamination matrix:
[[1.   0.53 0.23 0.45 0.68 0.51 0.43 0.42]
 [0.85 1.   0.61 0.71 0.79 0.65 0.64 0.59]
 [0.44 0.48 1.   0.26 0.52 0.45 0.56 0.43]
 [0.7  0.62 0.21 1.   0.86 0.61 0.48 0.54]
 [0.61 0.39 0.29 0.65 1.   0.56 0.48 0.35]
 [0.86 0.56 0.48 0.77 0.92 1.   0.65 0.41]
 [0.88 0.77 0.72 0.71 0.94 0.76 1.   0.52]
 [0.68 0.54 0.51 0.71 0.69 0.46 0.48 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.77 0.51 0.73 0.83 0.8  0.8  0.6 ]
 [0.77 1.   0.67 0.79 0.7  0.77 0.76 0.74]
 [0.51 0.67 1.   0.44 0.53 0.62 0.7  0.6 ]
 [0.73 0.79 0.44 1.   0.81 0.8  0.69 0.73]
 [0.83 0.7  0.53 0.81 1.   0.82 0.77 0.59]
 [0.8  0.77 0.62 0.8  0.82 1.   0.72 0.64]
 [0.8  0.76 0.7  0.69 0.77 0.72 1.   0.54]
 [0.6  0.74 0.6  0.73 0.59 0.64 0.54 1.  ]]
Inspecting pattern 4 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 1323
[t-SNE] Computed conditional probabilities for sample 1323 / 1323
[t-SNE] Mean sigma: 0.331921
Beginning preprocessing + Leiden
2024-03-12 01:08:13.958903 MEMORY 13.634322432
Affmat transformed
2024-03-12 01:08:13.978057 MEMORY 13.634322432
sources, targets, weights extracted
2024-03-12 01:08:13.990252 MEMORY 13.634322432
About to launch parallel Leiden runs
2024-03-12 01:08:14.037062 MEMORY 13.634322432
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    4.5s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   14.2s finished
Parallel Leiden runs finished
2024-03-12 01:08:28.286237 MEMORY 13.634322432
Quality: 0.42501632465830197
Quality: 0.4267789982673887
Quality: 0.4273347095211606
Quality: 0.4278149536645492
Quality: 0.42905395280041664
Got subclusters: Counter({0: 278, 1: 240, 2: 171, 3: 167, 4: 166, 5: 141, 6: 92, 7: 68})
On merging iteration 1
Numbers for each pattern pre-subsample: [278, 240, 171, 167, 166, 141, 92, 68]
Numbers after subsampling: [278, 240, 171, 167, 166, 141, 92, 68]
Computing sims for pattern 0
Computed sims for pattern 0 in 1.8884458541870117 s
Computing sims for pattern 1
Computed sims for pattern 1 in 1.5227081775665283 s
Computing sims for pattern 2
Computed sims for pattern 2 in 1.288524866104126 s
Computing sims for pattern 3
Computed sims for pattern 3 in 1.24106764793396 s
Computing sims for pattern 4
Computed sims for pattern 4 in 1.2486002445220947 s
Computing sims for pattern 5
Computed sims for pattern 5 in 1.1706416606903076 s
Computing sims for pattern 6
Computed sims for pattern 6 in 0.8562624454498291 s
Computing sims for pattern 7
Computed sims for pattern 7 in 0.6555867195129395 s
Cluster sizes
[278 240 171 167 166 141  92  68]
Cross-contamination matrix:
[[1.   0.64 0.86 0.6  0.63 0.93 0.8  0.66]
 [0.51 1.   0.79 0.64 0.92 0.83 0.78 0.72]
 [0.53 0.42 1.   0.54 0.77 0.81 0.67 0.58]
 [0.51 0.68 0.8  1.   0.78 0.85 0.74 0.74]
 [0.4  0.77 0.82 0.57 1.   0.79 0.72 0.56]
 [0.47 0.51 0.69 0.5  0.63 1.   0.52 0.45]
 [0.52 0.63 0.73 0.58 0.73 0.73 1.   0.49]
 [0.53 0.72 0.77 0.7  0.66 0.82 0.62 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.79 0.89 0.74 0.7  0.89 0.84 0.81]
 [0.79 1.   0.79 0.76 0.92 0.83 0.81 0.78]
 [0.89 0.79 1.   0.75 0.81 0.86 0.86 0.79]
 [0.74 0.76 0.75 1.   0.77 0.74 0.82 0.82]
 [0.7  0.92 0.81 0.77 1.   0.77 0.86 0.68]
 [0.89 0.83 0.86 0.74 0.77 1.   0.8  0.76]
 [0.84 0.81 0.86 0.82 0.86 0.8  1.   0.72]
 [0.81 0.78 0.79 0.82 0.68 0.76 0.72 1.  ]]
Collapsing 1 & 4 with crosscontam 0.7699976783312668 and sim 0.923831433868331
Collapsing 0 & 2 with crosscontam 0.5293021152492976 and sim 0.8863902412293648
Collapsing 2 & 5 with crosscontam 0.6931770933491586 and sim 0.8622208705244392
Collapsing 2 & 6 with crosscontam 0.6728461537184001 and sim 0.861483824504363
Collapsing 4 & 6 with crosscontam 0.7164711057271935 and sim 0.8571642669943309
Trimming eliminated 0 seqlets out of 406
Trimming eliminated 0 seqlets out of 449
Trimming eliminated 0 seqlets out of 590
Trimming eliminated 0 seqlets out of 682
Removed 1 duplicate seqlets
Trimming eliminated 0 seqlets out of 1087
Unmerged patterns remapping: OrderedDict([(3, 1), (7, 2)])
Time spent on merging iteration: 6.323164224624634
On merging iteration 2
Numbers for each pattern pre-subsample: [1087, 167, 68]
Numbers after subsampling: [300, 167, 68]
Computing sims for pattern 0
Computed sims for pattern 0 in 0.5968506336212158 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.2113044261932373 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.11404824256896973 s
Cluster sizes
[1087  167   68]
Cross-contamination matrix:
[[1.   0.93 0.93]
 [0.69 1.   0.74]
 [0.64 0.7  1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.82 0.86]
 [0.82 1.   0.82]
 [0.86 0.82 1.  ]]
Collapsing 0 & 2 with crosscontam 0.6444730392156863 and sim 0.8594147143440722
Trimming eliminated 0 seqlets out of 1155
Unmerged patterns remapping: OrderedDict([(1, 1)])
Time spent on merging iteration: 3.223886489868164
On merging iteration 3
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 947 out of 947 | elapsed:    0.4s finished
Numbers for each pattern pre-subsample: [1155, 167]
Numbers after subsampling: [300, 167]
Computing sims for pattern 0
Computed sims for pattern 0 in 0.31344175338745117 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.20954227447509766 s
Cluster sizes
[1155  167]
Cross-contamination matrix:
[[1.   0.94]
 [0.67 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.83]
 [0.83 1.  ]]
Inspecting pattern 5 for spurious merging
[t-SNE] Computed conditional probabilities for sample 947 / 947
[t-SNE] Mean sigma: 0.382100
Beginning preprocessing + Leiden
2024-03-12 01:08:50.245808 MEMORY 13.634322432
Affmat transformed
2024-03-12 01:08:50.258084 MEMORY 13.634322432
sources, targets, weights extracted
2024-03-12 01:08:50.265011 MEMORY 13.634322432
About to launch parallel Leiden runs
2024-03-12 01:08:50.302357 MEMORY 13.634322432
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    2.9s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    9.4s finished
Parallel Leiden runs finished
2024-03-12 01:08:59.684831 MEMORY 13.634322432
Quality: 0.44745900796776106
Quality: 0.44836572625314086
Quality: 0.44874479299272363
Quality: 0.4491623883093647
Got subclusters: Counter({0: 256, 1: 177, 2: 125, 3: 111, 4: 108, 5: 94, 6: 64, 7: 12})
On merging iteration 1
Numbers for each pattern pre-subsample: [256, 177, 125, 111, 108, 94, 64, 12]
Numbers after subsampling: [256, 177, 125, 111, 108, 94, 64, 12]
Computing sims for pattern 0
Computed sims for pattern 0 in 1.6203317642211914 s
Computing sims for pattern 1
Computed sims for pattern 1 in 1.334017276763916 s
Computing sims for pattern 2
Computed sims for pattern 2 in 1.0037550926208496 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.8890225887298584 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.8360714912414551 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.8560404777526855 s
Computing sims for pattern 6
Computed sims for pattern 6 in 0.5920805931091309 s
Computing sims for pattern 7
Computed sims for pattern 7 in 0.19004344940185547 s
Cluster sizes
[256 177 125 111 108  94  64  12]
Cross-contamination matrix:
[[1.   0.31 0.39 0.24 0.48 0.55 0.31 0.49]
 [0.6  1.   0.61 0.22 0.68 0.78 0.7  0.56]
 [0.88 0.79 1.   0.59 0.82 0.87 0.78 0.75]
 [0.44 0.19 0.39 1.   0.58 0.2  0.21 0.35]
 [0.77 0.64 0.59 0.62 1.   0.71 0.67 0.55]
 [0.81 0.69 0.6  0.18 0.66 1.   0.45 0.62]
 [0.5  0.6  0.48 0.17 0.61 0.42 1.   0.24]
 [0.46 0.28 0.25 0.2  0.3  0.38 0.16 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.6  0.8  0.52 0.71 0.85 0.5  0.63]
 [0.6  1.   0.63 0.39 0.66 0.69 0.66 0.51]
 [0.8  0.63 1.   0.39 0.67 0.9  0.64 0.66]
 [0.52 0.39 0.39 1.   0.54 0.42 0.33 0.46]
 [0.71 0.66 0.67 0.54 1.   0.73 0.58 0.53]
 [0.85 0.69 0.9  0.42 0.73 1.   0.59 0.65]
 [0.5  0.66 0.64 0.33 0.58 0.59 1.   0.37]
 [0.63 0.51 0.66 0.46 0.53 0.65 0.37 1.  ]]
Collapsing 2 & 5 with crosscontam 0.5974383710738467 and sim 0.9033174298691207
Collapsing 0 & 5 with crosscontam 0.545942334418601 and sim 0.8528969476154316
Trimming eliminated 0 seqlets out of 219
Removed 1 duplicate seqlets
Removed 1 duplicate seqlets
Trimming eliminated 0 seqlets out of 473
Unmerged patterns remapping: OrderedDict([(1, 1), (3, 2), (4, 3), (6, 4), (7, 5)])
Time spent on merging iteration: 1.9805552959442139
On merging iteration 2
Numbers for each pattern pre-subsample: [473, 177, 111, 108, 64, 12]
Numbers after subsampling: [300, 177, 111, 108, 64, 12]
Computing sims for pattern 0
Computed sims for pattern 0 in 1.5039856433868408 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.24222326278686523 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.1617870330810547 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.15307259559631348 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.11208176612854004 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.0433349609375 s
Cluster sizes
[473 177 111 108  64  12]
Cross-contamination matrix:
[[1.   0.67 0.48 0.77 0.66 0.88]
 [0.59 1.   0.22 0.68 0.7  0.56]
 [0.36 0.19 1.   0.58 0.21 0.35]
 [0.69 0.64 0.62 1.   0.67 0.55]
 [0.41 0.6  0.17 0.61 1.   0.24]
 [0.39 0.28 0.2  0.3  0.16 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.64 0.44 0.73 0.57 0.7 ]
 [0.64 1.   0.39 0.66 0.66 0.51]
 [0.44 0.39 1.   0.54 0.33 0.46]
 [0.73 0.66 0.54 1.   0.58 0.53]
 [0.57 0.66 0.33 0.58 1.   0.37]
 [0.7  0.51 0.46 0.53 0.37 1.  ]]
Merging on 27 clusters
2024-03-12 01:09:11.292016 MEMORY 13.634322432
On merging iteration 1
Numbers for each pattern pre-subsample: [786, 684, 409, 304, 46, 1115, 814, 25, 1215, 325, 275, 324, 297, 246, 221, 201, 172, 159, 86, 1155, 167, 473, 177, 111, 108, 64, 12]
Numbers after subsampling: [300, 300, 300, 300, 46, 300, 300, 25, 300, 300, 275, 300, 297, 246, 221, 201, 172, 159, 86, 300, 167, 300, 177, 111, 108, 64, 12]
Computing sims for pattern 0
Computed sims for pattern 0 in 8.666180610656738 s
Computing sims for pattern 1
Computed sims for pattern 1 in 8.586655139923096 s
Computing sims for pattern 2
Computed sims for pattern 2 in 8.518078327178955 s
Computing sims for pattern 3
Computed sims for pattern 3 in 8.429126977920532 s
Computing sims for pattern 4
Computed sims for pattern 4 in 1.8429770469665527 s
Computing sims for pattern 5
Computed sims for pattern 5 in 10.742356061935425 s
Computing sims for pattern 6
Computed sims for pattern 6 in 8.563786029815674 s
Computing sims for pattern 7
Computed sims for pattern 7 in 1.3142178058624268 s
Computing sims for pattern 8
Computed sims for pattern 8 in 8.662837505340576 s
Computing sims for pattern 9
Computed sims for pattern 9 in 8.641535520553589 s
Computing sims for pattern 10
Computed sims for pattern 10 in 7.561329364776611 s
Computing sims for pattern 11
Computed sims for pattern 11 in 8.59049677848816 s
Computing sims for pattern 12
Computed sims for pattern 12 in 8.508918285369873 s
Computing sims for pattern 13
Computed sims for pattern 13 in 6.261033296585083 s
Computing sims for pattern 14
Computed sims for pattern 14 in 9.543755769729614 s
Computing sims for pattern 15
Computed sims for pattern 15 in 6.497931718826294 s
Computing sims for pattern 16
Computed sims for pattern 16 in 5.343384265899658 s
Computing sims for pattern 17
Computed sims for pattern 17 in 4.895260334014893 s
Computing sims for pattern 18
Computed sims for pattern 18 in 3.293205499649048 s
Computing sims for pattern 19
Computed sims for pattern 19 in 8.605714559555054 s
Computing sims for pattern 20
Computed sims for pattern 20 in 5.120730876922607 s
Computing sims for pattern 21
Computed sims for pattern 21 in 8.571263790130615 s
Computing sims for pattern 22
Computed sims for pattern 22 in 5.487001657485962 s
Computing sims for pattern 23
Computed sims for pattern 23 in 3.6512157917022705 s
Computing sims for pattern 24
Computed sims for pattern 24 in 5.688958168029785 s
Computing sims for pattern 25
Computed sims for pattern 25 in 2.4996602535247803 s
Computing sims for pattern 26
Computed sims for pattern 26 in 0.8901798725128174 s
Cluster sizes
[ 786  684  409  304   46 1115  814   25 1215  325  275  324  297  246
  221  201  172  159   86 1155  167  473  177  111  108   64   12]
Cross-contamination matrix:
[[1.   0.78 0.89 0.75 0.92 0.51 0.31 0.49 0.68 0.59 0.6  0.5  0.47 0.42
  0.43 0.47 0.51 0.46 0.34 0.42 0.39 0.09 0.23 0.17 0.22 0.24 0.04]
 [0.74 1.   0.81 0.67 0.81 0.52 0.51 0.51 0.46 0.38 0.35 0.6  0.55 0.43
  0.55 0.71 0.67 0.6  0.48 0.42 0.45 0.08 0.28 0.17 0.12 0.19 0.05]
 [0.55 0.5  1.   0.35 0.71 0.19 0.15 0.16 0.35 0.33 0.32 0.23 0.26 0.15
  0.35 0.35 0.25 0.3  0.19 0.17 0.15 0.03 0.1  0.1  0.08 0.08 0.01]
 [0.67 0.55 0.23 1.   0.26 0.61 0.6  0.56 0.57 0.36 0.31 0.49 0.37 0.23
  0.16 0.21 0.17 0.52 0.49 0.56 0.49 0.05 0.24 0.17 0.09 0.08 0.03]
 [0.5  0.45 0.57 0.38 1.   0.29 0.16 0.29 0.38 0.29 0.24 0.4  0.28 0.26
  0.27 0.42 0.44 0.48 0.16 0.21 0.11 0.03 0.06 0.06 0.05 0.05 0.01]
 [0.29 0.39 0.37 0.62 0.47 1.   0.79 0.91 0.68 0.68 0.49 0.74 0.49 0.21
  0.62 0.82 0.6  0.48 0.45 0.58 0.46 0.08 0.18 0.29 0.16 0.2  0.06]
 [0.19 0.33 0.3  0.48 0.32 0.74 1.   0.69 0.59 0.75 0.58 0.64 0.61 0.31
  0.44 0.62 0.42 0.53 0.45 0.49 0.46 0.1  0.21 0.33 0.16 0.23 0.05]
 [0.05 0.06 0.02 0.1  0.09 0.27 0.25 1.   0.11 0.06 0.07 0.16 0.06 0.02
  0.04 0.11 0.05 0.07 0.04 0.06 0.04 0.01 0.02 0.06 0.03 0.01 0.02]
 [0.55 0.61 0.6  0.63 0.59 0.66 0.62 0.61 1.   0.88 0.88 0.46 0.36 0.2
  0.35 0.5  0.37 0.4  0.25 0.51 0.52 0.08 0.22 0.33 0.19 0.17 0.04]
 [0.31 0.22 0.41 0.27 0.3  0.47 0.62 0.29 0.65 1.   0.68 0.23 0.3  0.08
  0.28 0.23 0.21 0.2  0.17 0.25 0.32 0.03 0.1  0.21 0.11 0.08 0.01]
 [0.27 0.17 0.37 0.22 0.22 0.31 0.4  0.26 0.59 0.71 1.   0.13 0.16 0.08
  0.19 0.17 0.15 0.12 0.09 0.2  0.21 0.05 0.12 0.34 0.15 0.09 0.03]
 [0.13 0.2  0.13 0.25 0.29 0.47 0.4  0.35 0.29 0.22 0.16 1.   0.53 0.23
  0.45 0.68 0.51 0.43 0.42 0.29 0.15 0.01 0.04 0.04 0.04 0.09 0.01]
 [0.28 0.33 0.34 0.29 0.4  0.49 0.64 0.4  0.38 0.47 0.33 0.85 1.   0.61
  0.71 0.79 0.65 0.64 0.59 0.38 0.3  0.03 0.1  0.09 0.05 0.13 0.02]
 [0.16 0.18 0.17 0.13 0.32 0.16 0.18 0.16 0.16 0.14 0.2  0.44 0.48 1.
  0.26 0.52 0.45 0.56 0.43 0.12 0.1  0.02 0.06 0.03 0.03 0.08 0.  ]
 [0.16 0.24 0.28 0.2  0.27 0.45 0.3  0.29 0.21 0.29 0.23 0.7  0.62 0.21
  1.   0.86 0.61 0.48 0.54 0.34 0.2  0.02 0.05 0.04 0.03 0.11 0.02]
 [0.09 0.22 0.16 0.12 0.25 0.41 0.25 0.34 0.17 0.15 0.1  0.61 0.39 0.29
  0.65 1.   0.56 0.48 0.35 0.29 0.18 0.01 0.04 0.03 0.02 0.06 0.  ]
 [0.23 0.32 0.26 0.29 0.48 0.53 0.32 0.36 0.32 0.3  0.23 0.86 0.56 0.48
  0.77 0.92 1.   0.65 0.41 0.44 0.28 0.01 0.06 0.06 0.03 0.1  0.01]
 [0.31 0.4  0.43 0.47 0.62 0.51 0.57 0.52 0.44 0.32 0.23 0.88 0.77 0.72
  0.71 0.94 0.76 1.   0.52 0.44 0.26 0.04 0.08 0.08 0.06 0.09 0.04]
 [0.17 0.26 0.22 0.38 0.44 0.41 0.45 0.31 0.24 0.28 0.17 0.68 0.54 0.51
  0.71 0.69 0.46 0.48 1.   0.31 0.25 0.05 0.16 0.09 0.08 0.12 0.04]
 [0.38 0.56 0.46 0.77 0.53 0.81 0.78 0.68 0.71 0.62 0.56 0.71 0.61 0.3
  0.69 0.83 0.65 0.6  0.53 1.   0.94 0.11 0.44 0.27 0.21 0.23 0.09]
 [0.19 0.33 0.24 0.43 0.17 0.39 0.42 0.29 0.46 0.4  0.33 0.29 0.25 0.11
  0.24 0.4  0.27 0.23 0.21 0.67 1.   0.09 0.48 0.04 0.2  0.19 0.06]
 [0.17 0.14 0.18 0.16 0.17 0.23 0.25 0.25 0.18 0.19 0.23 0.16 0.08 0.16
  0.14 0.18 0.09 0.15 0.19 0.18 0.29 1.   0.67 0.48 0.77 0.66 0.88]
 [0.25 0.3  0.25 0.35 0.22 0.29 0.35 0.26 0.36 0.32 0.38 0.17 0.2  0.2
  0.18 0.28 0.2  0.17 0.32 0.48 0.76 0.59 1.   0.22 0.68 0.7  0.56]
 [0.22 0.18 0.26 0.28 0.23 0.43 0.49 0.36 0.47 0.49 0.69 0.14 0.14 0.1
  0.14 0.22 0.14 0.13 0.16 0.25 0.09 0.36 0.19 1.   0.58 0.21 0.35]
 [0.23 0.13 0.23 0.15 0.18 0.25 0.27 0.4  0.31 0.32 0.42 0.17 0.08 0.1
  0.13 0.13 0.11 0.09 0.17 0.21 0.38 0.69 0.64 0.62 1.   0.67 0.55]
 [0.13 0.1  0.13 0.1  0.1  0.19 0.16 0.32 0.2  0.2  0.24 0.1  0.12 0.17
  0.12 0.14 0.09 0.09 0.1  0.15 0.25 0.41 0.6  0.17 0.61 1.   0.24]
 [0.01 0.02 0.02 0.02 0.02 0.03 0.04 0.14 0.02 0.01 0.05 0.01 0.01 0.
  0.02 0.02 0.01 0.01 0.03 0.02 0.07 0.39 0.28 0.2  0.3  0.16 1.  ]]
Pattern-to-pattern sim matrix:
[[ 1.    0.82  0.78  0.67  0.78  0.64  0.39  0.39  0.81  0.74  0.76  0.41
   0.58  0.51  0.52  0.48  0.53  0.51  0.48  0.59  0.56 -0.02  0.27  0.05
   0.21  0.46 -0.  ]
 [ 0.82  1.    0.69  0.68  0.8   0.64  0.51  0.49  0.79  0.6   0.61  0.65
   0.63  0.51  0.59  0.65  0.63  0.75  0.56  0.71  0.67 -0.09  0.29  0.05
   0.08  0.45  0.05]
 [ 0.78  0.69  1.    0.53  0.77  0.48  0.43  0.33  0.79  0.73  0.76  0.4
   0.57  0.46  0.61  0.51  0.48  0.54  0.51  0.58  0.53 -0.09  0.32  0.09
   0.26  0.46  0.07]
 [ 0.67  0.68  0.53  1.    0.55  0.67  0.72  0.6   0.77  0.4   0.42  0.64
   0.61  0.45  0.51  0.57  0.53  0.73  0.55  0.75  0.69 -0.02  0.35  0.09
   0.07  0.21  0.11]
 [ 0.78  0.8   0.77  0.55  1.    0.61  0.46  0.58  0.77  0.54  0.52  0.7
   0.58  0.52  0.57  0.67  0.69  0.75  0.44  0.66  0.5  -0.02  0.16 -0.02
   0.09  0.29  0.07]
 [ 0.64  0.64  0.48  0.67  0.61  1.    0.73  0.72  0.72  0.67  0.54  0.81
   0.6   0.35  0.75  0.83  0.73  0.63  0.55  0.8   0.58  0.02  0.22  0.22
   0.22  0.28  0.13]
 [ 0.39  0.51  0.43  0.72  0.46  0.73  1.    0.67  0.7   0.73  0.54  0.77
   0.85  0.52  0.63  0.68  0.71  0.81  0.71  0.77  0.62  0.09  0.38  0.22
   0.24  0.4   0.16]
 [ 0.39  0.49  0.33  0.6   0.58  0.72  0.67  1.    0.61  0.4   0.36  0.61
   0.5   0.35  0.49  0.61  0.52  0.6   0.44  0.59  0.47  0.21  0.31  0.31
   0.34  0.34  0.25]
 [ 0.81  0.79  0.79  0.77  0.77  0.72  0.7   0.61  1.    0.81  0.8   0.69
   0.66  0.45  0.59  0.67  0.62  0.67  0.56  0.77  0.69 -0.04  0.35  0.17
   0.22  0.36  0.05]
 [ 0.74  0.6   0.73  0.4   0.54  0.67  0.73  0.4   0.81  1.    0.76  0.54
   0.67  0.35  0.65  0.53  0.63  0.49  0.64  0.62  0.62 -0.05  0.23  0.2
   0.22  0.26  0.11]
 [ 0.76  0.61  0.76  0.42  0.52  0.54  0.54  0.36  0.8   0.76  1.    0.36
   0.54  0.44  0.6   0.46  0.53  0.39  0.46  0.59  0.52  0.01  0.32  0.33
   0.33  0.33  0.11]
 [ 0.41  0.65  0.4   0.64  0.7   0.81  0.77  0.61  0.69  0.54  0.36  1.
   0.77  0.51  0.73  0.83  0.8   0.8   0.6   0.76  0.53 -0.12  0.3   0.08
   0.04  0.23  0.15]
 [ 0.58  0.63  0.57  0.61  0.58  0.6   0.85  0.5   0.66  0.67  0.54  0.77
   1.    0.67  0.79  0.7   0.77  0.76  0.74  0.75  0.58 -0.12  0.31  0.03
   0.09  0.33  0.06]
 [ 0.51  0.51  0.46  0.45  0.52  0.35  0.52  0.35  0.45  0.35  0.44  0.51
   0.67  1.    0.44  0.53  0.62  0.7   0.6   0.48  0.44 -0.09  0.24  0.01
   0.09  0.29  0.08]
 [ 0.52  0.59  0.61  0.51  0.57  0.75  0.63  0.49  0.59  0.65  0.6   0.73
   0.79  0.44  1.    0.81  0.8   0.69  0.73  0.8   0.65 -0.08  0.23  0.03
   0.08  0.46  0.12]
 [ 0.48  0.65  0.51  0.57  0.67  0.83  0.68  0.61  0.67  0.53  0.46  0.83
   0.7   0.53  0.81  1.    0.82  0.77  0.59  0.81  0.66 -0.05  0.21  0.08
   0.09  0.32  0.16]
 [ 0.53  0.63  0.48  0.53  0.69  0.73  0.71  0.52  0.62  0.63  0.53  0.8
   0.77  0.62  0.8   0.82  1.    0.72  0.64  0.74  0.61 -0.14  0.23  0.02
   0.    0.38  0.09]
 [ 0.51  0.75  0.54  0.73  0.75  0.63  0.81  0.6   0.67  0.49  0.39  0.8
   0.76  0.7   0.69  0.77  0.72  1.    0.54  0.73  0.55 -0.1   0.21  0.
   0.04  0.17  0.14]
 [ 0.48  0.56  0.51  0.55  0.44  0.55  0.71  0.44  0.56  0.64  0.46  0.6
   0.74  0.6   0.73  0.59  0.64  0.54  1.    0.57  0.48  0.    0.32  0.11
   0.19  0.25  0.16]
 [ 0.59  0.71  0.58  0.75  0.66  0.8   0.77  0.59  0.77  0.62  0.59  0.76
   0.75  0.48  0.8   0.81  0.74  0.73  0.57  1.    0.83 -0.04  0.45  0.04
   0.07  0.38  0.04]
 [ 0.56  0.67  0.53  0.69  0.5   0.58  0.62  0.47  0.69  0.62  0.52  0.53
   0.58  0.44  0.65  0.66  0.61  0.55  0.48  0.83  1.    0.11  0.67  0.17
   0.21  0.45  0.13]
 [-0.02 -0.09 -0.09 -0.02 -0.02  0.02  0.09  0.21 -0.04 -0.05  0.01 -0.12
  -0.12 -0.09 -0.08 -0.05 -0.14 -0.1   0.   -0.04  0.11  1.    0.64  0.44
   0.73  0.57  0.7 ]
 [ 0.27  0.29  0.32  0.35  0.16  0.22  0.38  0.31  0.35  0.23  0.32  0.3
   0.31  0.24  0.23  0.21  0.23  0.21  0.32  0.45  0.67  0.64  1.    0.39
   0.66  0.66  0.51]
 [ 0.05  0.05  0.09  0.09 -0.02  0.22  0.22  0.31  0.17  0.2   0.33  0.08
   0.03  0.01  0.03  0.08  0.02  0.    0.11  0.04  0.17  0.44  0.39  1.
   0.54  0.33  0.46]
 [ 0.21  0.08  0.26  0.07  0.09  0.22  0.24  0.34  0.22  0.22  0.33  0.04
   0.09  0.09  0.08  0.09  0.    0.04  0.19  0.07  0.21  0.73  0.66  0.54
   1.    0.58  0.53]
 [ 0.46  0.45  0.46  0.21  0.29  0.28  0.4   0.34  0.36  0.26  0.33  0.23
   0.33  0.29  0.46  0.32  0.38  0.17  0.25  0.38  0.45  0.57  0.66  0.33
   0.58  1.    0.37]
 [-0.    0.05  0.07  0.11  0.07  0.13  0.16  0.25  0.05  0.11  0.11  0.15
   0.06  0.08  0.12  0.16  0.09  0.14  0.16  0.04  0.13  0.7   0.51  0.46
   0.53  0.37  1.  ]]
Got 27 patterns after merging
2024-03-12 01:12:07.986074 MEMORY 13.634322432
Performing filtering
2024-03-12 01:12:07.986397 MEMORY 13.634322432
Got 25 patterns after filtering
2024-03-12 01:12:09.622095 MEMORY 13.634326528
Total time taken is 1649.87s
2024-03-12 01:12:09.622321 MEMORY 13.634326528
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 1215 out of 1215 | elapsed:    0.4s finished
/ru-auth/local/home/lzhao/anaconda3/envs/jupyter-ml-clone/lib/python3.9/site-packages/sklearn/manifold/_t_sne.py:691: FutureWarning: 'square_distances' has been introduced in 0.24 to help phase out legacy squaring behavior. The 'legacy' setting will be removed in 1.1 (renaming of 0.26), and the default setting will be changed to True. In 1.3, 'square_distances' will be removed altogether, and distances will be squared by default. Set 'square_distances'=True to silence this warning.
  warnings.warn(
/ru-auth/local/home/lzhao/anaconda3/envs/jupyter-ml-clone/lib/python3.9/site-packages/sklearn/neighbors/_base.py:175: EfficiencyWarning: Precomputed sparse input was not sorted by data.
  warnings.warn('Precomputed sparse input was not sorted by data.',
Applying subclustering to the final motifs
On pattern 0
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 1215 samples in 0.009s...
[t-SNE] Computed neighbors for 1215 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 1000 / 1215
[t-SNE] Computed conditional probabilities for sample 1215 / 1215
[t-SNE] Mean sigma: 0.326047
[t-SNE] Computed conditional probabilities in 0.093s
[t-SNE] Iteration 50: error = 66.9501266, gradient norm = 0.2401061 (50 iterations in 0.127s)
[t-SNE] Iteration 100: error = 67.5804672, gradient norm = 0.2163360 (50 iterations in 0.125s)
[t-SNE] Iteration 150: error = 67.8741074, gradient norm = 0.2293068 (50 iterations in 0.127s)
[t-SNE] Iteration 200: error = 68.2706909, gradient norm = 0.2086651 (50 iterations in 0.127s)
[t-SNE] Iteration 250: error = 67.9401855, gradient norm = 0.2086094 (50 iterations in 0.133s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 67.940186
[t-SNE] Iteration 300: error = 1.9488713, gradient norm = 0.0014319 (50 iterations in 0.108s)
[t-SNE] Iteration 350: error = 1.8814825, gradient norm = 0.0004768 (50 iterations in 0.102s)
[t-SNE] Iteration 400: error = 1.8491167, gradient norm = 0.0003496 (50 iterations in 0.102s)
[t-SNE] Iteration 450: error = 1.8350374, gradient norm = 0.0002052 (50 iterations in 0.103s)
[t-SNE] Iteration 500: error = 1.8294157, gradient norm = 0.0001084 (50 iterations in 0.104s)
[t-SNE] Iteration 550: error = 1.8250399, gradient norm = 0.0000889 (50 iterations in 0.102s)
[t-SNE] Iteration 600: error = 1.8220860, gradient norm = 0.0000708 (50 iterations in 0.105s)
[t-SNE] Iteration 650: error = 1.8205186, gradient norm = 0.0000544 (50 iterations in 0.103s)
[t-SNE] Iteration 700: error = 1.8193266, gradient norm = 0.0000591 (50 iterations in 0.102s)
[t-SNE] Iteration 750: error = 1.8185910, gradient norm = 0.0000508 (50 iterations in 0.104s)
[t-SNE] Iteration 800: error = 1.8180311, gradient norm = 0.0000420 (50 iterations in 0.105s)
[t-SNE] Iteration 850: error = 1.8176731, gradient norm = 0.0000660 (50 iterations in 0.104s)
[t-SNE] Iteration 900: error = 1.8171867, gradient norm = 0.0000406 (50 iterations in 0.104s)
[t-SNE] Iteration 950: error = 1.8169537, gradient norm = 0.0000394 (50 iterations in 0.102s)
[t-SNE] Iteration 1000: error = 1.8168445, gradient norm = 0.0000315 (50 iterations in 0.105s)
[t-SNE] KL divergence after 1000 iterations: 1.816844
[t-SNE] Computed conditional probabilities for sample 1000 / 1215
[t-SNE] Computed conditional probabilities for sample 1215 / 1215
[t-SNE] Mean sigma: 0.326047
Beginning preprocessing + Leiden
2024-03-12 01:12:13.706741 MEMORY 13.634330624
Affmat transformed
2024-03-12 01:12:13.722701 MEMORY 13.634330624
sources, targets, weights extracted
2024-03-12 01:12:13.732724 MEMORY 13.634330624
About to launch parallel Leiden runs
2024-03-12 01:12:13.777891 MEMORY 13.634330624
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    3.6s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   11.9s finished
Parallel Leiden runs finished
2024-03-12 01:12:25.713488 MEMORY 13.634330624
Quality: 0.44370078017787606
Quality: 0.44581489106130334
Quality: 0.4474178027212705
Quality: 0.4474721201047589
Quality: 0.4477006815526252
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 1108 out of 1155 | elapsed:    0.3s remaining:    0.0s
[Parallel(n_jobs=24)]: Done 1155 out of 1155 | elapsed:    0.3s finished
Got subclusters: Counter({0: 254, 1: 250, 2: 184, 3: 183, 4: 109, 5: 107, 6: 81, 7: 30, 8: 17})
On pattern 1
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 1155 samples in 0.008s...
[t-SNE] Computed neighbors for 1155 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 1000 / 1155
[t-SNE] Computed conditional probabilities for sample 1155 / 1155
[t-SNE] Mean sigma: 0.340017
[t-SNE] Computed conditional probabilities in 0.086s
[t-SNE] Iteration 50: error = 67.9693680, gradient norm = 0.2451163 (50 iterations in 0.114s)
[t-SNE] Iteration 100: error = 68.6287766, gradient norm = 0.2292552 (50 iterations in 0.125s)
[t-SNE] Iteration 150: error = 68.3857040, gradient norm = 0.2425045 (50 iterations in 0.117s)
[t-SNE] Iteration 200: error = 68.6671219, gradient norm = 0.2377490 (50 iterations in 0.116s)
[t-SNE] Iteration 250: error = 69.4695206, gradient norm = 0.2224959 (50 iterations in 0.116s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 69.469521
[t-SNE] Iteration 300: error = 1.7795134, gradient norm = 0.0017877 (50 iterations in 0.102s)
[t-SNE] Iteration 350: error = 1.7227670, gradient norm = 0.0004837 (50 iterations in 0.103s)
[t-SNE] Iteration 400: error = 1.7005911, gradient norm = 0.0002329 (50 iterations in 0.101s)
[t-SNE] Iteration 450: error = 1.6901318, gradient norm = 0.0001286 (50 iterations in 0.101s)
[t-SNE] Iteration 500: error = 1.6857010, gradient norm = 0.0000938 (50 iterations in 0.100s)
[t-SNE] Iteration 550: error = 1.6831440, gradient norm = 0.0000886 (50 iterations in 0.101s)
[t-SNE] Iteration 600: error = 1.6819427, gradient norm = 0.0000608 (50 iterations in 0.100s)
[t-SNE] Iteration 650: error = 1.6808996, gradient norm = 0.0000407 (50 iterations in 0.099s)
[t-SNE] Iteration 700: error = 1.6801685, gradient norm = 0.0000325 (50 iterations in 0.099s)
[t-SNE] Iteration 750: error = 1.6794988, gradient norm = 0.0000353 (50 iterations in 0.099s)
[t-SNE] Iteration 800: error = 1.6791271, gradient norm = 0.0000380 (50 iterations in 0.101s)
[t-SNE] Iteration 850: error = 1.6788954, gradient norm = 0.0000327 (50 iterations in 0.099s)
[t-SNE] Iteration 900: error = 1.6786685, gradient norm = 0.0000308 (50 iterations in 0.100s)
[t-SNE] Iteration 950: error = 1.6784908, gradient norm = 0.0000349 (50 iterations in 0.100s)
[t-SNE] Iteration 1000: error = 1.6782987, gradient norm = 0.0000240 (50 iterations in 0.100s)
[t-SNE] KL divergence after 1000 iterations: 1.678299
[t-SNE] Computed conditional probabilities for sample 1000 / 1155
[t-SNE] Computed conditional probabilities for sample 1155 / 1155
[t-SNE] Mean sigma: 0.340017
Beginning preprocessing + Leiden
2024-03-12 01:12:29.688024 MEMORY 13.634330624
Affmat transformed
2024-03-12 01:12:29.704302 MEMORY 13.634330624
sources, targets, weights extracted
2024-03-12 01:12:29.714101 MEMORY 13.634330624
About to launch parallel Leiden runs
2024-03-12 01:12:29.721723 MEMORY 13.634330624
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    3.8s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   12.6s finished
Parallel Leiden runs finished
2024-03-12 01:12:42.328992 MEMORY 13.634330624
Quality: 0.4408136540298033
Quality: 0.4421650694200279
Quality: 0.4432428193263652
Quality: 0.4435594989292015
Quality: 0.4439666933969016
Quality: 0.4441098827025681
Quality: 0.4443121865632365
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 1115 out of 1115 | elapsed:    0.3s finished
Got subclusters: Counter({0: 252, 1: 188, 2: 176, 3: 142, 4: 124, 5: 121, 6: 110, 7: 42})
On pattern 2
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 1115 samples in 0.008s...
[t-SNE] Computed neighbors for 1115 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 1000 / 1115
[t-SNE] Computed conditional probabilities for sample 1115 / 1115
[t-SNE] Mean sigma: 0.322180
[t-SNE] Computed conditional probabilities in 0.084s
[t-SNE] Iteration 50: error = 65.8623123, gradient norm = 0.2789546 (50 iterations in 0.111s)
[t-SNE] Iteration 100: error = 66.6398621, gradient norm = 0.2536589 (50 iterations in 0.111s)
[t-SNE] Iteration 150: error = 66.9363327, gradient norm = 0.2643012 (50 iterations in 0.109s)
[t-SNE] Iteration 200: error = 66.5478973, gradient norm = 0.2671438 (50 iterations in 0.113s)
[t-SNE] Iteration 250: error = 66.7011795, gradient norm = 0.2570735 (50 iterations in 0.108s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 66.701180
[t-SNE] Iteration 300: error = 1.9001064, gradient norm = 0.0018098 (50 iterations in 0.100s)
[t-SNE] Iteration 350: error = 1.8454579, gradient norm = 0.0003344 (50 iterations in 0.094s)
[t-SNE] Iteration 400: error = 1.8217140, gradient norm = 0.0002407 (50 iterations in 0.095s)
[t-SNE] Iteration 450: error = 1.8135265, gradient norm = 0.0001366 (50 iterations in 0.095s)
[t-SNE] Iteration 500: error = 1.8092009, gradient norm = 0.0000901 (50 iterations in 0.094s)
[t-SNE] Iteration 550: error = 1.8065127, gradient norm = 0.0000699 (50 iterations in 0.094s)
[t-SNE] Iteration 600: error = 1.8045573, gradient norm = 0.0000724 (50 iterations in 0.095s)
[t-SNE] Iteration 650: error = 1.8037217, gradient norm = 0.0000617 (50 iterations in 0.096s)
[t-SNE] Iteration 700: error = 1.8030583, gradient norm = 0.0000553 (50 iterations in 0.095s)
[t-SNE] Iteration 750: error = 1.8025652, gradient norm = 0.0000411 (50 iterations in 0.097s)
[t-SNE] Iteration 800: error = 1.8021109, gradient norm = 0.0000410 (50 iterations in 0.094s)
[t-SNE] Iteration 850: error = 1.8018924, gradient norm = 0.0000382 (50 iterations in 0.096s)
[t-SNE] Iteration 900: error = 1.8016094, gradient norm = 0.0000468 (50 iterations in 0.095s)
[t-SNE] Iteration 950: error = 1.8013783, gradient norm = 0.0000843 (50 iterations in 0.097s)
[t-SNE] Iteration 1000: error = 1.8010621, gradient norm = 0.0000933 (50 iterations in 0.097s)
[t-SNE] KL divergence after 1000 iterations: 1.801062
[t-SNE] Computed conditional probabilities for sample 1000 / 1115
[t-SNE] Computed conditional probabilities for sample 1115 / 1115
[t-SNE] Mean sigma: 0.322180
Beginning preprocessing + Leiden
2024-03-12 01:12:46.120790 MEMORY 13.634330624
Affmat transformed
2024-03-12 01:12:46.135137 MEMORY 13.634330624
sources, targets, weights extracted
2024-03-12 01:12:46.144400 MEMORY 13.634330624
About to launch parallel Leiden runs
2024-03-12 01:12:46.172806 MEMORY 13.634330624
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    3.5s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   11.0s finished
Parallel Leiden runs finished
2024-03-12 01:12:57.137483 MEMORY 13.634330624
Quality: 0.41674435386890063
Quality: 0.41732307731052093
Quality: 0.41750825722221
Quality: 0.4178198268404553
Quality: 0.41787352792313137
Quality: 0.41792252462963325
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 814 out of 814 | elapsed:    0.2s finished
Got subclusters: Counter({0: 160, 1: 142, 2: 139, 4: 135, 3: 135, 5: 132, 6: 109, 7: 83, 8: 80})
On pattern 3
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 814 samples in 0.006s...
[t-SNE] Computed neighbors for 814 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 814 / 814
[t-SNE] Mean sigma: 0.337947
[t-SNE] Computed conditional probabilities in 0.060s
[t-SNE] Iteration 50: error = 66.3746109, gradient norm = 0.3669834 (50 iterations in 0.077s)
[t-SNE] Iteration 100: error = 68.0631714, gradient norm = 0.3418896 (50 iterations in 0.077s)
[t-SNE] Iteration 150: error = 68.6739044, gradient norm = 0.3331898 (50 iterations in 0.077s)
[t-SNE] Iteration 200: error = 68.5378952, gradient norm = 0.3466842 (50 iterations in 0.078s)
[t-SNE] Iteration 250: error = 68.9517975, gradient norm = 0.3122953 (50 iterations in 0.078s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 68.951797
[t-SNE] Iteration 300: error = 1.6005313, gradient norm = 0.0021285 (50 iterations in 0.073s)
[t-SNE] Iteration 350: error = 1.5060668, gradient norm = 0.0008143 (50 iterations in 0.070s)
[t-SNE] Iteration 400: error = 1.4875838, gradient norm = 0.0003818 (50 iterations in 0.070s)
[t-SNE] Iteration 450: error = 1.4798992, gradient norm = 0.0001952 (50 iterations in 0.070s)
[t-SNE] Iteration 500: error = 1.4754002, gradient norm = 0.0002069 (50 iterations in 0.070s)
[t-SNE] Iteration 550: error = 1.4738425, gradient norm = 0.0001565 (50 iterations in 0.071s)
[t-SNE] Iteration 600: error = 1.4709048, gradient norm = 0.0001309 (50 iterations in 0.070s)
[t-SNE] Iteration 650: error = 1.4688625, gradient norm = 0.0001190 (50 iterations in 0.070s)
[t-SNE] Iteration 700: error = 1.4677899, gradient norm = 0.0000708 (50 iterations in 0.070s)
[t-SNE] Iteration 750: error = 1.4670024, gradient norm = 0.0001023 (50 iterations in 0.070s)
[t-SNE] Iteration 800: error = 1.4668238, gradient norm = 0.0000765 (50 iterations in 0.070s)
[t-SNE] Iteration 850: error = 1.4666090, gradient norm = 0.0000605 (50 iterations in 0.070s)
[t-SNE] Iteration 900: error = 1.4662794, gradient norm = 0.0000669 (50 iterations in 0.070s)
[t-SNE] Iteration 950: error = 1.4658629, gradient norm = 0.0000571 (50 iterations in 0.070s)
[t-SNE] Iteration 1000: error = 1.4657161, gradient norm = 0.0000442 (50 iterations in 0.070s)
[t-SNE] KL divergence after 1000 iterations: 1.465716
[t-SNE] Computed conditional probabilities for sample 814 / 814
[t-SNE] Mean sigma: 0.337947
Beginning preprocessing + Leiden
2024-03-12 01:12:59.883305 MEMORY 13.634330624
Affmat transformed
2024-03-12 01:12:59.893526 MEMORY 13.634330624
sources, targets, weights extracted
2024-03-12 01:12:59.899686 MEMORY 13.634330624
About to launch parallel Leiden runs
2024-03-12 01:12:59.919793 MEMORY 13.634330624
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    2.4s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    8.0s finished
Parallel Leiden runs finished
2024-03-12 01:13:07.928820 MEMORY 13.634330624
Quality: 0.45487884564885744
Quality: 0.4569865603627388
Quality: 0.458139375504228
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 786 out of 786 | elapsed:    0.2s finished
Got subclusters: Counter({0: 175, 1: 170, 2: 167, 3: 140, 4: 97, 5: 65})
On pattern 4
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 786 samples in 0.005s...
[t-SNE] Computed neighbors for 786 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 786 / 786
[t-SNE] Mean sigma: 0.360576
[t-SNE] Computed conditional probabilities in 0.054s
[t-SNE] Iteration 50: error = 66.4206543, gradient norm = 0.3678505 (50 iterations in 0.075s)
[t-SNE] Iteration 100: error = 65.3613586, gradient norm = 0.3877443 (50 iterations in 0.075s)
[t-SNE] Iteration 150: error = 67.7568970, gradient norm = 0.3543000 (50 iterations in 0.075s)
[t-SNE] Iteration 200: error = 67.5783386, gradient norm = 0.3750234 (50 iterations in 0.075s)
[t-SNE] Iteration 250: error = 67.5206833, gradient norm = 0.3598688 (50 iterations in 0.076s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 67.520683
[t-SNE] Iteration 300: error = 1.7164452, gradient norm = 0.0025585 (50 iterations in 0.071s)
[t-SNE] Iteration 350: error = 1.6388279, gradient norm = 0.0007926 (50 iterations in 0.067s)
[t-SNE] Iteration 400: error = 1.5915424, gradient norm = 0.0006778 (50 iterations in 0.068s)
[t-SNE] Iteration 450: error = 1.5741098, gradient norm = 0.0003992 (50 iterations in 0.069s)
[t-SNE] Iteration 500: error = 1.5559931, gradient norm = 0.0004148 (50 iterations in 0.067s)
[t-SNE] Iteration 550: error = 1.5480309, gradient norm = 0.0003091 (50 iterations in 0.070s)
[t-SNE] Iteration 600: error = 1.5433744, gradient norm = 0.0002402 (50 iterations in 0.067s)
[t-SNE] Iteration 650: error = 1.5404267, gradient norm = 0.0001656 (50 iterations in 0.068s)
[t-SNE] Iteration 700: error = 1.5370150, gradient norm = 0.0003058 (50 iterations in 0.067s)
[t-SNE] Iteration 750: error = 1.5340680, gradient norm = 0.0001564 (50 iterations in 0.067s)
[t-SNE] Iteration 800: error = 1.5325854, gradient norm = 0.0000881 (50 iterations in 0.067s)
[t-SNE] Iteration 850: error = 1.5318379, gradient norm = 0.0000938 (50 iterations in 0.067s)
[t-SNE] Iteration 900: error = 1.5314153, gradient norm = 0.0000581 (50 iterations in 0.067s)
[t-SNE] Iteration 950: error = 1.5311561, gradient norm = 0.0000495 (50 iterations in 0.067s)
[t-SNE] Iteration 1000: error = 1.5307386, gradient norm = 0.0000480 (50 iterations in 0.067s)
[t-SNE] KL divergence after 1000 iterations: 1.530739
[t-SNE] Computed conditional probabilities for sample 786 / 786
[t-SNE] Mean sigma: 0.360576
Beginning preprocessing + Leiden
2024-03-12 01:13:10.525434 MEMORY 13.634330624
Affmat transformed
2024-03-12 01:13:10.536026 MEMORY 13.634330624
sources, targets, weights extracted
2024-03-12 01:13:10.541742 MEMORY 13.634330624
About to launch parallel Leiden runs
2024-03-12 01:13:10.576626 MEMORY 13.634330624
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    2.4s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    7.3s finished
Parallel Leiden runs finished
2024-03-12 01:13:17.912328 MEMORY 13.634330624
Quality: 0.4215866594371814
Quality: 0.42386568025308397
Quality: 0.4245730229658765
Quality: 0.4245780877164194
Quality: 0.42474273208276525
Quality: 0.425086336127606
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 684 out of 684 | elapsed:    0.2s finished
Got subclusters: Counter({0: 168, 1: 162, 2: 160, 3: 100, 4: 99, 5: 52, 6: 29, 7: 16})
On pattern 5
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 684 samples in 0.005s...
[t-SNE] Computed neighbors for 684 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 684 / 684
[t-SNE] Mean sigma: 0.363945
[t-SNE] Computed conditional probabilities in 0.047s
[t-SNE] Iteration 50: error = 68.0184784, gradient norm = 0.3950747 (50 iterations in 0.066s)
[t-SNE] Iteration 100: error = 67.7090378, gradient norm = 0.3910865 (50 iterations in 0.068s)
[t-SNE] Iteration 150: error = 68.9423447, gradient norm = 0.3899937 (50 iterations in 0.067s)
[t-SNE] Iteration 200: error = 69.1709442, gradient norm = 0.3894874 (50 iterations in 0.070s)
[t-SNE] Iteration 250: error = 68.8946686, gradient norm = 0.3883686 (50 iterations in 0.070s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 68.894669
[t-SNE] Iteration 300: error = 1.5506257, gradient norm = 0.0027276 (50 iterations in 0.063s)
[t-SNE] Iteration 350: error = 1.4987383, gradient norm = 0.0006957 (50 iterations in 0.061s)
[t-SNE] Iteration 400: error = 1.4777844, gradient norm = 0.0005958 (50 iterations in 0.061s)
[t-SNE] Iteration 450: error = 1.4611315, gradient norm = 0.0007936 (50 iterations in 0.061s)
[t-SNE] Iteration 500: error = 1.4537021, gradient norm = 0.0002650 (50 iterations in 0.061s)
[t-SNE] Iteration 550: error = 1.4428296, gradient norm = 0.0005021 (50 iterations in 0.066s)
[t-SNE] Iteration 600: error = 1.4333860, gradient norm = 0.0003633 (50 iterations in 0.061s)
[t-SNE] Iteration 650: error = 1.4281683, gradient norm = 0.0001688 (50 iterations in 0.061s)
[t-SNE] Iteration 700: error = 1.4262017, gradient norm = 0.0001742 (50 iterations in 0.061s)
[t-SNE] Iteration 750: error = 1.4251515, gradient norm = 0.0000955 (50 iterations in 0.061s)
[t-SNE] Iteration 800: error = 1.4244795, gradient norm = 0.0000826 (50 iterations in 0.061s)
[t-SNE] Iteration 850: error = 1.4243073, gradient norm = 0.0000580 (50 iterations in 0.061s)
[t-SNE] Iteration 900: error = 1.4241610, gradient norm = 0.0000407 (50 iterations in 0.061s)
[t-SNE] Iteration 950: error = 1.4239610, gradient norm = 0.0000335 (50 iterations in 0.061s)
[t-SNE] Iteration 1000: error = 1.4237700, gradient norm = 0.0000295 (50 iterations in 0.061s)
[t-SNE] KL divergence after 1000 iterations: 1.423770
[t-SNE] Computed conditional probabilities for sample 684 / 684
[t-SNE] Mean sigma: 0.363945
Beginning preprocessing + Leiden
2024-03-12 01:13:20.302910 MEMORY 13.634330624
Affmat transformed
2024-03-12 01:13:20.312691 MEMORY 13.634330624
sources, targets, weights extracted
2024-03-12 01:13:20.317712 MEMORY 13.634330624
About to launch parallel Leiden runs
2024-03-12 01:13:20.336331 MEMORY 13.634330624
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    2.1s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    6.2s finished
Parallel Leiden runs finished
2024-03-12 01:13:26.547923 MEMORY 13.634330624
Quality: 0.41332984539640016
Quality: 0.4183046190727107
Quality: 0.4199381125875989
Quality: 0.4203668917921614
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 344 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 473 out of 473 | elapsed:    0.2s finished
Got subclusters: Counter({0: 186, 1: 119, 2: 108, 3: 98, 4: 70, 5: 67, 6: 36})
On pattern 6
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 473 samples in 0.004s...
[t-SNE] Computed neighbors for 473 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 473 / 473
[t-SNE] Mean sigma: 0.395438
[t-SNE] Computed conditional probabilities in 0.035s
[t-SNE] Iteration 50: error = 65.0520248, gradient norm = 0.5005670 (50 iterations in 0.050s)
[t-SNE] Iteration 100: error = 65.2626877, gradient norm = 0.4821443 (50 iterations in 0.050s)
[t-SNE] Iteration 150: error = 65.4851456, gradient norm = 0.4871677 (50 iterations in 0.050s)
[t-SNE] Iteration 200: error = 67.6759033, gradient norm = 0.4682841 (50 iterations in 0.050s)
[t-SNE] Iteration 250: error = 70.0112991, gradient norm = 0.4476151 (50 iterations in 0.050s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 70.011299
[t-SNE] Iteration 300: error = 1.3900055, gradient norm = 0.0043821 (50 iterations in 0.048s)
[t-SNE] Iteration 350: error = 1.3019148, gradient norm = 0.0014665 (50 iterations in 0.047s)
[t-SNE] Iteration 400: error = 1.2731231, gradient norm = 0.0014839 (50 iterations in 0.047s)
[t-SNE] Iteration 450: error = 1.2533804, gradient norm = 0.0009775 (50 iterations in 0.047s)
[t-SNE] Iteration 500: error = 1.2271336, gradient norm = 0.0008918 (50 iterations in 0.047s)
[t-SNE] Iteration 550: error = 1.2024032, gradient norm = 0.0008810 (50 iterations in 0.047s)
[t-SNE] Iteration 600: error = 1.1824597, gradient norm = 0.0008902 (50 iterations in 0.047s)
[t-SNE] Iteration 650: error = 1.1614461, gradient norm = 0.0003568 (50 iterations in 0.046s)
[t-SNE] Iteration 700: error = 1.1601316, gradient norm = 0.0002569 (50 iterations in 0.046s)
[t-SNE] Iteration 750: error = 1.1465172, gradient norm = 0.0005639 (50 iterations in 0.047s)
[t-SNE] Iteration 800: error = 1.1416466, gradient norm = 0.0001792 (50 iterations in 0.047s)
[t-SNE] Iteration 850: error = 1.1387526, gradient norm = 0.0004010 (50 iterations in 0.046s)
[t-SNE] Iteration 900: error = 1.1374398, gradient norm = 0.0000808 (50 iterations in 0.046s)
[t-SNE] Iteration 950: error = 1.1373059, gradient norm = 0.0000591 (50 iterations in 0.046s)
[t-SNE] Iteration 1000: error = 1.1372439, gradient norm = 0.0000687 (50 iterations in 0.046s)
[t-SNE] KL divergence after 1000 iterations: 1.137244
[t-SNE] Computed conditional probabilities for sample 473 / 473
[t-SNE] Mean sigma: 0.395438
Beginning preprocessing + Leiden
2024-03-12 01:13:28.305465 MEMORY 13.634330624
Affmat transformed
2024-03-12 01:13:28.311485 MEMORY 13.634330624
sources, targets, weights extracted
2024-03-12 01:13:28.314747 MEMORY 13.634330624
About to launch parallel Leiden runs
2024-03-12 01:13:28.356198 MEMORY 13.634330624
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.5s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    4.8s finished
Parallel Leiden runs finished
2024-03-12 01:13:33.108085 MEMORY 13.634330624
Quality: 0.39153670967649273
Quality: 0.3921545675495816
Quality: 0.39252901304454874
Quality: 0.39261978170751366
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 344 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 409 out of 409 | elapsed:    0.1s finished
Got subclusters: Counter({0: 112, 1: 108, 2: 90, 3: 88, 4: 75})
On pattern 7
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 409 samples in 0.003s...
[t-SNE] Computed neighbors for 409 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 409 / 409
[t-SNE] Mean sigma: 0.366759
[t-SNE] Computed conditional probabilities in 0.029s
[t-SNE] Iteration 50: error = 61.5914459, gradient norm = 0.5447767 (50 iterations in 0.054s)
[t-SNE] Iteration 100: error = 67.4339676, gradient norm = 0.4740474 (50 iterations in 0.043s)
[t-SNE] Iteration 150: error = 65.9598312, gradient norm = 0.4809167 (50 iterations in 0.043s)
[t-SNE] Iteration 200: error = 65.8880081, gradient norm = 0.4905358 (50 iterations in 0.044s)
[t-SNE] Iteration 250: error = 65.9809036, gradient norm = 0.4993996 (50 iterations in 0.044s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 65.980904
[t-SNE] Iteration 300: error = 1.2876379, gradient norm = 0.0031617 (50 iterations in 0.041s)
[t-SNE] Iteration 350: error = 1.2287091, gradient norm = 0.0010691 (50 iterations in 0.041s)
[t-SNE] Iteration 400: error = 1.2134372, gradient norm = 0.0011142 (50 iterations in 0.041s)
[t-SNE] Iteration 450: error = 1.1987877, gradient norm = 0.0004256 (50 iterations in 0.041s)
[t-SNE] Iteration 500: error = 1.1850699, gradient norm = 0.0009486 (50 iterations in 0.043s)
[t-SNE] Iteration 550: error = 1.1709102, gradient norm = 0.0007796 (50 iterations in 0.041s)
[t-SNE] Iteration 600: error = 1.1669708, gradient norm = 0.0002019 (50 iterations in 0.041s)
[t-SNE] Iteration 650: error = 1.1669554, gradient norm = 0.0000914 (50 iterations in 0.042s)
[t-SNE] Iteration 700: error = 1.1665583, gradient norm = 0.0001123 (50 iterations in 0.040s)
[t-SNE] Iteration 750: error = 1.1664649, gradient norm = 0.0000842 (50 iterations in 0.041s)
[t-SNE] Iteration 800: error = 1.1661996, gradient norm = 0.0000831 (50 iterations in 0.041s)
[t-SNE] Iteration 850: error = 1.1662509, gradient norm = 0.0000899 (50 iterations in 0.041s)
[t-SNE] Iteration 900: error = 1.1661117, gradient norm = 0.0000717 (50 iterations in 0.041s)
[t-SNE] Iteration 950: error = 1.1660290, gradient norm = 0.0000564 (50 iterations in 0.040s)
[t-SNE] Iteration 1000: error = 1.1660000, gradient norm = 0.0000268 (50 iterations in 0.040s)
[t-SNE] KL divergence after 1000 iterations: 1.166000
[t-SNE] Computed conditional probabilities for sample 409 / 409
[t-SNE] Mean sigma: 0.366759
Beginning preprocessing + Leiden
2024-03-12 01:13:34.617891 MEMORY 13.634330624
Affmat transformed
2024-03-12 01:13:34.623903 MEMORY 13.634330624
sources, targets, weights extracted
2024-03-12 01:13:34.626575 MEMORY 13.634330624
About to launch parallel Leiden runs
2024-03-12 01:13:34.647868 MEMORY 13.634330624
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.4s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    4.0s finished
Parallel Leiden runs finished
2024-03-12 01:13:38.649994 MEMORY 13.634330624
Quality: 0.3823809468184305
Quality: 0.38241162401656437
Quality: 0.382456125531869
Quality: 0.382678744316849
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 272 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 325 out of 325 | elapsed:    0.1s finished
Got subclusters: Counter({0: 86, 1: 77, 2: 72, 3: 70, 4: 60, 5: 44})
On pattern 8
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 325 samples in 0.003s...
[t-SNE] Computed neighbors for 325 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 325 / 325
[t-SNE] Mean sigma: 0.368318
[t-SNE] Computed conditional probabilities in 0.025s
[t-SNE] Iteration 50: error = 64.6136246, gradient norm = 0.5083962 (50 iterations in 0.037s)
[t-SNE] Iteration 100: error = 65.8168182, gradient norm = 0.4936679 (50 iterations in 0.037s)
[t-SNE] Iteration 150: error = 68.2284546, gradient norm = 0.4515498 (50 iterations in 0.037s)
[t-SNE] Iteration 200: error = 66.0815048, gradient norm = 0.5092159 (50 iterations in 0.037s)
[t-SNE] Iteration 250: error = 67.8216476, gradient norm = 0.4860045 (50 iterations in 0.037s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 67.821648
[t-SNE] Iteration 300: error = 1.2100716, gradient norm = 0.0043398 (50 iterations in 0.036s)
[t-SNE] Iteration 350: error = 1.0764856, gradient norm = 0.0022791 (50 iterations in 0.036s)
[t-SNE] Iteration 400: error = 1.0079700, gradient norm = 0.0021187 (50 iterations in 0.036s)
[t-SNE] Iteration 450: error = 0.9761764, gradient norm = 0.0006765 (50 iterations in 0.036s)
[t-SNE] Iteration 500: error = 0.9688694, gradient norm = 0.0004359 (50 iterations in 0.035s)
[t-SNE] Iteration 550: error = 0.9664304, gradient norm = 0.0003716 (50 iterations in 0.035s)
[t-SNE] Iteration 600: error = 0.9666965, gradient norm = 0.0003465 (50 iterations in 0.035s)
[t-SNE] Iteration 650: error = 0.9615430, gradient norm = 0.0002237 (50 iterations in 0.036s)
[t-SNE] Iteration 700: error = 0.9615729, gradient norm = 0.0001056 (50 iterations in 0.036s)
[t-SNE] Iteration 750: error = 0.9614897, gradient norm = 0.0001258 (50 iterations in 0.035s)
[t-SNE] Iteration 800: error = 0.9614181, gradient norm = 0.0001081 (50 iterations in 0.035s)
[t-SNE] Iteration 850: error = 0.9615857, gradient norm = 0.0000791 (50 iterations in 0.035s)
[t-SNE] Iteration 900: error = 0.9615467, gradient norm = 0.0000471 (50 iterations in 0.035s)
[t-SNE] Iteration 950: error = 0.9615976, gradient norm = 0.0000977 (50 iterations in 0.035s)
[t-SNE] Iteration 1000: error = 0.9616305, gradient norm = 0.0001050 (50 iterations in 0.035s)
[t-SNE] KL divergence after 1000 iterations: 0.961630
[t-SNE] Computed conditional probabilities for sample 325 / 325
[t-SNE] Mean sigma: 0.368318
Beginning preprocessing + Leiden
2024-03-12 01:13:39.912124 MEMORY 13.634330624
Affmat transformed
2024-03-12 01:13:39.916664 MEMORY 13.634330624
sources, targets, weights extracted
2024-03-12 01:13:39.918991 MEMORY 13.634330624
About to launch parallel Leiden runs
2024-03-12 01:13:39.936230 MEMORY 13.634330624
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.2s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    3.5s finished
Parallel Leiden runs finished
2024-03-12 01:13:43.399056 MEMORY 13.634330624
Quality: 0.3584325845270472
Quality: 0.36075225221263096
Quality: 0.3617035354045876
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 272 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 324 out of 324 | elapsed:    0.1s finished
Got subclusters: Counter({0: 100, 1: 76, 2: 69, 3: 49, 4: 13, 5: 12, 6: 6})
On pattern 9
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 324 samples in 0.003s...
[t-SNE] Computed neighbors for 324 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 324 / 324
[t-SNE] Mean sigma: 0.352924
[t-SNE] Computed conditional probabilities in 0.023s
[t-SNE] Iteration 50: error = 62.7766151, gradient norm = 0.5310195 (50 iterations in 0.039s)
[t-SNE] Iteration 100: error = 62.7325974, gradient norm = 0.4960647 (50 iterations in 0.038s)
[t-SNE] Iteration 150: error = 64.4880295, gradient norm = 0.5145615 (50 iterations in 0.038s)
[t-SNE] Iteration 200: error = 65.2696457, gradient norm = 0.4995945 (50 iterations in 0.038s)
[t-SNE] Iteration 250: error = 64.1709976, gradient norm = 0.4873568 (50 iterations in 0.041s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 64.170998
[t-SNE] Iteration 300: error = 1.2035449, gradient norm = 0.0035170 (50 iterations in 0.036s)
[t-SNE] Iteration 350: error = 1.1281933, gradient norm = 0.0014749 (50 iterations in 0.035s)
[t-SNE] Iteration 400: error = 1.0910431, gradient norm = 0.0016098 (50 iterations in 0.037s)
[t-SNE] Iteration 450: error = 1.0663652, gradient norm = 0.0011989 (50 iterations in 0.035s)
[t-SNE] Iteration 500: error = 1.0503398, gradient norm = 0.0011897 (50 iterations in 0.035s)
[t-SNE] Iteration 550: error = 1.0412835, gradient norm = 0.0011972 (50 iterations in 0.035s)
[t-SNE] Iteration 600: error = 1.0373377, gradient norm = 0.0011138 (50 iterations in 0.035s)
[t-SNE] Iteration 650: error = 1.0362500, gradient norm = 0.0001033 (50 iterations in 0.035s)
[t-SNE] Iteration 700: error = 1.0362236, gradient norm = 0.0001033 (50 iterations in 0.035s)
[t-SNE] Iteration 750: error = 1.0347723, gradient norm = 0.0004310 (50 iterations in 0.035s)
[t-SNE] Iteration 800: error = 1.0306162, gradient norm = 0.0001353 (50 iterations in 0.035s)
[t-SNE] Iteration 850: error = 1.0305964, gradient norm = 0.0000697 (50 iterations in 0.035s)
[t-SNE] Iteration 900: error = 1.0305752, gradient norm = 0.0001297 (50 iterations in 0.035s)
[t-SNE] Iteration 950: error = 1.0305279, gradient norm = 0.0000662 (50 iterations in 0.035s)
[t-SNE] Iteration 1000: error = 1.0305403, gradient norm = 0.0000598 (50 iterations in 0.035s)
[t-SNE] KL divergence after 1000 iterations: 1.030540
[t-SNE] Computed conditional probabilities for sample 324 / 324
[t-SNE] Mean sigma: 0.352924
Beginning preprocessing + Leiden
2024-03-12 01:13:44.649312 MEMORY 13.634330624
Affmat transformed
2024-03-12 01:13:44.653726 MEMORY 13.634330624
sources, targets, weights extracted
2024-03-12 01:13:44.656051 MEMORY 13.634330624
About to launch parallel Leiden runs
2024-03-12 01:13:44.669808 MEMORY 13.634330624
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.1s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    3.5s finished
Parallel Leiden runs finished
2024-03-12 01:13:48.197077 MEMORY 13.634330624
Quality: 0.3485763489505344
Quality: 0.35032765544303407
Quality: 0.3539275252195191
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 304 out of 304 | elapsed:    0.1s finished
Got subclusters: Counter({0: 71, 1: 65, 2: 63, 3: 61, 4: 59, 5: 5})
On pattern 10
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 304 samples in 0.002s...
[t-SNE] Computed neighbors for 304 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 304 / 304
[t-SNE] Mean sigma: 0.401950
[t-SNE] Computed conditional probabilities in 0.021s
[t-SNE] Iteration 50: error = 62.4488068, gradient norm = 0.4784442 (50 iterations in 0.045s)
[t-SNE] Iteration 100: error = 63.3603172, gradient norm = 0.5085932 (50 iterations in 0.036s)
[t-SNE] Iteration 150: error = 65.6889954, gradient norm = 0.4896116 (50 iterations in 0.036s)
[t-SNE] Iteration 200: error = 64.5136795, gradient norm = 0.4858625 (50 iterations in 0.036s)
[t-SNE] Iteration 250: error = 62.0785484, gradient norm = 0.4806580 (50 iterations in 0.037s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 62.078548
[t-SNE] Iteration 300: error = 1.1611178, gradient norm = 0.0044095 (50 iterations in 0.035s)
[t-SNE] Iteration 350: error = 1.0409372, gradient norm = 0.0033805 (50 iterations in 0.034s)
[t-SNE] Iteration 400: error = 0.9948729, gradient norm = 0.0017639 (50 iterations in 0.034s)
[t-SNE] Iteration 450: error = 0.9710847, gradient norm = 0.0006295 (50 iterations in 0.034s)
[t-SNE] Iteration 500: error = 0.9547257, gradient norm = 0.0024198 (50 iterations in 0.034s)
[t-SNE] Iteration 550: error = 0.9425009, gradient norm = 0.0006232 (50 iterations in 0.034s)
[t-SNE] Iteration 600: error = 0.9336559, gradient norm = 0.0007909 (50 iterations in 0.034s)
[t-SNE] Iteration 650: error = 0.9150482, gradient norm = 0.0006063 (50 iterations in 0.034s)
[t-SNE] Iteration 700: error = 0.9111286, gradient norm = 0.0008522 (50 iterations in 0.034s)
[t-SNE] Iteration 750: error = 0.9044311, gradient norm = 0.0009569 (50 iterations in 0.034s)
[t-SNE] Iteration 800: error = 0.9033700, gradient norm = 0.0000761 (50 iterations in 0.034s)
[t-SNE] Iteration 850: error = 0.9032874, gradient norm = 0.0000898 (50 iterations in 0.034s)
[t-SNE] Iteration 900: error = 0.9032212, gradient norm = 0.0000428 (50 iterations in 0.034s)
[t-SNE] Iteration 950: error = 0.9031724, gradient norm = 0.0000386 (50 iterations in 0.034s)
[t-SNE] Iteration 1000: error = 0.9031001, gradient norm = 0.0000672 (50 iterations in 0.034s)
[t-SNE] KL divergence after 1000 iterations: 0.903100
[t-SNE] Computed conditional probabilities for sample 304 / 304
[t-SNE] Mean sigma: 0.401950
Beginning preprocessing + Leiden
2024-03-12 01:13:49.386871 MEMORY 13.634330624
Affmat transformed
2024-03-12 01:13:49.391028 MEMORY 13.634330624
sources, targets, weights extracted
2024-03-12 01:13:49.392904 MEMORY 13.634330624
About to launch parallel Leiden runs
2024-03-12 01:13:49.441189 MEMORY 13.634330624
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.1s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    3.2s finished
Parallel Leiden runs finished
2024-03-12 01:13:52.619436 MEMORY 13.634330624
Quality: 0.38059150377189416
Quality: 0.38196740369512894
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 297 out of 297 | elapsed:    0.1s finished
Got subclusters: Counter({0: 74, 1: 59, 2: 53, 3: 49, 4: 41, 5: 28})
On pattern 11
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 297 samples in 0.002s...
[t-SNE] Computed neighbors for 297 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 297 / 297
[t-SNE] Mean sigma: 0.396650
[t-SNE] Computed conditional probabilities in 0.023s
[t-SNE] Iteration 50: error = 59.8408699, gradient norm = 0.5386772 (50 iterations in 0.038s)
[t-SNE] Iteration 100: error = 60.1862526, gradient norm = 0.5126797 (50 iterations in 0.035s)
[t-SNE] Iteration 150: error = 61.3246918, gradient norm = 0.5137789 (50 iterations in 0.035s)
[t-SNE] Iteration 200: error = 62.2252998, gradient norm = 0.5082203 (50 iterations in 0.037s)
[t-SNE] Iteration 250: error = 61.1392479, gradient norm = 0.5108222 (50 iterations in 0.035s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 61.139248
[t-SNE] Iteration 300: error = 1.0248371, gradient norm = 0.0041658 (50 iterations in 0.034s)
[t-SNE] Iteration 350: error = 0.9665951, gradient norm = 0.0029533 (50 iterations in 0.034s)
[t-SNE] Iteration 400: error = 0.9452558, gradient norm = 0.0007535 (50 iterations in 0.034s)
[t-SNE] Iteration 450: error = 0.9338732, gradient norm = 0.0010857 (50 iterations in 0.034s)
[t-SNE] Iteration 500: error = 0.9198760, gradient norm = 0.0005781 (50 iterations in 0.034s)
[t-SNE] Iteration 550: error = 0.9175948, gradient norm = 0.0002791 (50 iterations in 0.034s)
[t-SNE] Iteration 600: error = 0.9153773, gradient norm = 0.0002136 (50 iterations in 0.034s)
[t-SNE] Iteration 650: error = 0.9152426, gradient norm = 0.0001068 (50 iterations in 0.034s)
[t-SNE] Iteration 700: error = 0.9151809, gradient norm = 0.0000996 (50 iterations in 0.034s)
[t-SNE] Iteration 750: error = 0.9152220, gradient norm = 0.0001041 (50 iterations in 0.034s)
[t-SNE] Iteration 800: error = 0.9152814, gradient norm = 0.0001200 (50 iterations in 0.034s)
[t-SNE] Iteration 850: error = 0.9152833, gradient norm = 0.0000918 (50 iterations in 0.034s)
[t-SNE] Iteration 900: error = 0.9151528, gradient norm = 0.0000774 (50 iterations in 0.034s)
[t-SNE] Iteration 950: error = 0.9152012, gradient norm = 0.0001190 (50 iterations in 0.034s)
[t-SNE] Iteration 1000: error = 0.9152167, gradient norm = 0.0000983 (50 iterations in 0.034s)
[t-SNE] KL divergence after 1000 iterations: 0.915217
[t-SNE] Computed conditional probabilities for sample 297 / 297
[t-SNE] Mean sigma: 0.396650
Beginning preprocessing + Leiden
2024-03-12 01:13:53.787337 MEMORY 13.634330624
Affmat transformed
2024-03-12 01:13:53.791495 MEMORY 13.634330624
sources, targets, weights extracted
2024-03-12 01:13:53.793366 MEMORY 13.634330624
About to launch parallel Leiden runs
2024-03-12 01:13:53.830489 MEMORY 13.634330624
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.2s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    3.3s finished
Parallel Leiden runs finished
2024-03-12 01:13:57.160159 MEMORY 13.634330624
Quality: 0.382098782187632
Quality: 0.3832230917110564
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 228 out of 275 | elapsed:    0.1s remaining:    0.0s
[Parallel(n_jobs=24)]: Done 275 out of 275 | elapsed:    0.1s finished
Got subclusters: Counter({0: 77, 1: 69, 2: 65, 3: 54, 4: 32})
On pattern 12
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 275 samples in 0.002s...
[t-SNE] Computed neighbors for 275 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 275 / 275
[t-SNE] Mean sigma: 0.367695
[t-SNE] Computed conditional probabilities in 0.019s
[t-SNE] Iteration 50: error = 64.3171692, gradient norm = 0.4895464 (50 iterations in 0.035s)
[t-SNE] Iteration 100: error = 65.7687378, gradient norm = 0.4820949 (50 iterations in 0.034s)
[t-SNE] Iteration 150: error = 65.3839874, gradient norm = 0.4912117 (50 iterations in 0.034s)
[t-SNE] Iteration 200: error = 66.0589371, gradient norm = 0.4778591 (50 iterations in 0.035s)
[t-SNE] Iteration 250: error = 65.4903259, gradient norm = 0.4476345 (50 iterations in 0.035s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 65.490326
[t-SNE] Iteration 300: error = 1.1087281, gradient norm = 0.0054164 (50 iterations in 0.033s)
[t-SNE] Iteration 350: error = 0.9556429, gradient norm = 0.0025534 (50 iterations in 0.033s)
[t-SNE] Iteration 400: error = 0.9409845, gradient norm = 0.0005541 (50 iterations in 0.033s)
[t-SNE] Iteration 450: error = 0.9396185, gradient norm = 0.0009770 (50 iterations in 0.032s)
[t-SNE] Iteration 500: error = 0.9104691, gradient norm = 0.0015558 (50 iterations in 0.032s)
[t-SNE] Iteration 550: error = 0.8986390, gradient norm = 0.0006065 (50 iterations in 0.032s)
[t-SNE] Iteration 600: error = 0.8880732, gradient norm = 0.0011427 (50 iterations in 0.032s)
[t-SNE] Iteration 650: error = 0.8866661, gradient norm = 0.0004018 (50 iterations in 0.032s)
[t-SNE] Iteration 700: error = 0.8761070, gradient norm = 0.0002709 (50 iterations in 0.032s)
[t-SNE] Iteration 750: error = 0.8761111, gradient norm = 0.0001076 (50 iterations in 0.032s)
[t-SNE] Iteration 800: error = 0.8761010, gradient norm = 0.0000804 (50 iterations in 0.032s)
[t-SNE] Iteration 850: error = 0.8761985, gradient norm = 0.0000960 (50 iterations in 0.032s)
[t-SNE] Iteration 900: error = 0.8760691, gradient norm = 0.0000637 (50 iterations in 0.032s)
[t-SNE] Iteration 950: error = 0.8760903, gradient norm = 0.0000711 (50 iterations in 0.032s)
[t-SNE] Iteration 1000: error = 0.8760669, gradient norm = 0.0000937 (50 iterations in 0.032s)
[t-SNE] KL divergence after 1000 iterations: 0.876067
[t-SNE] Computed conditional probabilities for sample 275 / 275
[t-SNE] Mean sigma: 0.367695
Beginning preprocessing + Leiden
2024-03-12 01:13:58.261008 MEMORY 13.634330624
Affmat transformed
2024-03-12 01:13:58.264643 MEMORY 13.634330624
sources, targets, weights extracted
2024-03-12 01:13:58.266452 MEMORY 13.634330624
About to launch parallel Leiden runs
2024-03-12 01:13:58.284153 MEMORY 13.634330624
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.1s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    3.2s finished
Parallel Leiden runs finished
2024-03-12 01:14:01.441128 MEMORY 13.634330624
Quality: 0.3266094162877847
Quality: 0.32676795648431484
Quality: 0.32722238230391487
Quality: 0.32725306211213456
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 246 out of 246 | elapsed:    0.1s finished
Got subclusters: Counter({0: 70, 1: 47, 2: 43, 3: 38, 4: 37, 5: 23, 6: 17})
On pattern 13
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 246 samples in 0.002s...
[t-SNE] Computed neighbors for 246 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 246 / 246
[t-SNE] Mean sigma: 0.399590
[t-SNE] Computed conditional probabilities in 0.017s
[t-SNE] Iteration 50: error = 59.2432899, gradient norm = 0.4648199 (50 iterations in 0.035s)
[t-SNE] Iteration 100: error = 58.4228096, gradient norm = 0.5181481 (50 iterations in 0.031s)
[t-SNE] Iteration 150: error = 58.2770615, gradient norm = 0.5296956 (50 iterations in 0.031s)
[t-SNE] Iteration 200: error = 59.5329208, gradient norm = 0.4869779 (50 iterations in 0.031s)
[t-SNE] Iteration 250: error = 58.6554832, gradient norm = 0.5273487 (50 iterations in 0.031s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 58.655483
[t-SNE] Iteration 300: error = 0.7086285, gradient norm = 0.0046603 (50 iterations in 0.031s)
[t-SNE] Iteration 350: error = 0.6529992, gradient norm = 0.0013673 (50 iterations in 0.031s)
[t-SNE] Iteration 400: error = 0.6378674, gradient norm = 0.0007700 (50 iterations in 0.031s)
[t-SNE] Iteration 450: error = 0.6269299, gradient norm = 0.0002568 (50 iterations in 0.031s)
[t-SNE] Iteration 500: error = 0.6269662, gradient norm = 0.0001661 (50 iterations in 0.030s)
[t-SNE] Iteration 550: error = 0.6269422, gradient norm = 0.0001285 (50 iterations in 0.030s)
[t-SNE] Iteration 600: error = 0.6266518, gradient norm = 0.0002000 (50 iterations in 0.030s)
[t-SNE] Iteration 650: error = 0.6266588, gradient norm = 0.0002870 (50 iterations in 0.033s)
[t-SNE] Iteration 700: error = 0.6266503, gradient norm = 0.0001142 (50 iterations in 0.030s)
[t-SNE] Iteration 750: error = 0.6265939, gradient norm = 0.0001399 (50 iterations in 0.030s)
[t-SNE] Iteration 800: error = 0.6267008, gradient norm = 0.0000656 (50 iterations in 0.031s)
[t-SNE] Iteration 850: error = 0.6266224, gradient norm = 0.0001513 (50 iterations in 0.030s)
[t-SNE] Iteration 900: error = 0.6266519, gradient norm = 0.0000809 (50 iterations in 0.030s)
[t-SNE] Iteration 950: error = 0.6267200, gradient norm = 0.0000524 (50 iterations in 0.030s)
[t-SNE] Iteration 1000: error = 0.6266909, gradient norm = 0.0000483 (50 iterations in 0.030s)
[t-SNE] KL divergence after 1000 iterations: 0.626691
[t-SNE] Computed conditional probabilities for sample 246 / 246
[t-SNE] Mean sigma: 0.399590
Beginning preprocessing + Leiden
2024-03-12 01:14:02.471303 MEMORY 13.634330624
Affmat transformed
2024-03-12 01:14:02.475280 MEMORY 13.634330624
sources, targets, weights extracted
2024-03-12 01:14:02.476844 MEMORY 13.634330624
About to launch parallel Leiden runs
2024-03-12 01:14:02.521422 MEMORY 13.634330624
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.0s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.7s finished
Parallel Leiden runs finished
2024-03-12 01:14:05.250868 MEMORY 13.634330624
Quality: 0.3999947865208917
Quality: 0.39999831240497596
Quality: 0.4002349997652471
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 221 out of 221 | elapsed:    0.1s finished
Got subclusters: Counter({0: 60, 1: 58, 2: 43, 3: 35, 4: 26, 5: 24})
On pattern 14
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 221 samples in 0.002s...
[t-SNE] Computed neighbors for 221 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 221 / 221
[t-SNE] Mean sigma: 0.397426
[t-SNE] Computed conditional probabilities in 0.017s
[t-SNE] Iteration 50: error = 59.2545700, gradient norm = 0.5461412 (50 iterations in 0.033s)
[t-SNE] Iteration 100: error = 60.2685471, gradient norm = 0.5196288 (50 iterations in 0.029s)
[t-SNE] Iteration 150: error = 63.1543732, gradient norm = 0.5024400 (50 iterations in 0.029s)
[t-SNE] Iteration 200: error = 61.1817207, gradient norm = 0.5022970 (50 iterations in 0.029s)
[t-SNE] Iteration 250: error = 61.1012421, gradient norm = 0.5114964 (50 iterations in 0.029s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 61.101242
[t-SNE] Iteration 300: error = 0.9444541, gradient norm = 0.0078052 (50 iterations in 0.028s)
[t-SNE] Iteration 350: error = 0.7267420, gradient norm = 0.0049848 (50 iterations in 0.029s)
[t-SNE] Iteration 400: error = 0.6426832, gradient norm = 0.0024754 (50 iterations in 0.029s)
[t-SNE] Iteration 450: error = 0.6126348, gradient norm = 0.0006108 (50 iterations in 0.028s)
[t-SNE] Iteration 500: error = 0.6055443, gradient norm = 0.0004102 (50 iterations in 0.029s)
[t-SNE] Iteration 550: error = 0.6054410, gradient norm = 0.0000636 (50 iterations in 0.032s)
[t-SNE] Iteration 600: error = 0.6054085, gradient norm = 0.0001019 (50 iterations in 0.029s)
[t-SNE] Iteration 650: error = 0.6053845, gradient norm = 0.0001357 (50 iterations in 0.029s)
[t-SNE] Iteration 700: error = 0.6053054, gradient norm = 0.0001014 (50 iterations in 0.029s)
[t-SNE] Iteration 750: error = 0.6054688, gradient norm = 0.0000799 (50 iterations in 0.029s)
[t-SNE] Iteration 800: error = 0.6053299, gradient norm = 0.0000489 (50 iterations in 0.029s)
[t-SNE] Iteration 850: error = 0.6054569, gradient norm = 0.0000805 (50 iterations in 0.029s)
[t-SNE] Iteration 900: error = 0.6054151, gradient norm = 0.0000893 (50 iterations in 0.029s)
[t-SNE] Iteration 950: error = 0.6053444, gradient norm = 0.0000944 (50 iterations in 0.029s)
[t-SNE] Iteration 1000: error = 0.6054243, gradient norm = 0.0000896 (50 iterations in 0.029s)
[t-SNE] KL divergence after 1000 iterations: 0.605424
[t-SNE] Computed conditional probabilities for sample 221 / 221
[t-SNE] Mean sigma: 0.397426
Beginning preprocessing + Leiden
2024-03-12 01:14:06.219876 MEMORY 13.634330624
Affmat transformed
2024-03-12 01:14:06.223285 MEMORY 13.634330624
sources, targets, weights extracted
2024-03-12 01:14:06.224603 MEMORY 13.634330624
About to launch parallel Leiden runs
2024-03-12 01:14:06.240825 MEMORY 13.634330624
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.9s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.7s finished
Parallel Leiden runs finished
2024-03-12 01:14:08.914470 MEMORY 13.634330624
Quality: 0.3506951210758891
Quality: 0.3515355700721657
Quality: 0.35183193284384734
Quality: 0.3519933707347682
Quality: 0.3521361748562782
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 201 out of 201 | elapsed:    0.1s finished
Got subclusters: Counter({0: 49, 1: 42, 2: 41, 3: 39, 4: 27, 5: 23})
On pattern 15
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 201 samples in 0.002s...
[t-SNE] Computed neighbors for 201 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 201 / 201
[t-SNE] Mean sigma: 0.375250
[t-SNE] Computed conditional probabilities in 0.014s
[t-SNE] Iteration 50: error = 60.8650017, gradient norm = 0.5126002 (50 iterations in 0.028s)
[t-SNE] Iteration 100: error = 60.4529381, gradient norm = 0.5026579 (50 iterations in 0.027s)
[t-SNE] Iteration 150: error = 62.6789017, gradient norm = 0.5170320 (50 iterations in 0.027s)
[t-SNE] Iteration 200: error = 63.2165298, gradient norm = 0.4866357 (50 iterations in 0.027s)
[t-SNE] Iteration 250: error = 61.5442467, gradient norm = 0.5217332 (50 iterations in 0.027s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 61.544247
[t-SNE] Iteration 300: error = 0.9079852, gradient norm = 0.0052286 (50 iterations in 0.027s)
[t-SNE] Iteration 350: error = 0.6928362, gradient norm = 0.0031900 (50 iterations in 0.027s)
[t-SNE] Iteration 400: error = 0.6488904, gradient norm = 0.0006788 (50 iterations in 0.027s)
[t-SNE] Iteration 450: error = 0.6374201, gradient norm = 0.0005967 (50 iterations in 0.026s)
[t-SNE] Iteration 500: error = 0.6281276, gradient norm = 0.0003587 (50 iterations in 0.026s)
[t-SNE] Iteration 550: error = 0.6273002, gradient norm = 0.0001204 (50 iterations in 0.026s)
[t-SNE] Iteration 600: error = 0.6271402, gradient norm = 0.0001596 (50 iterations in 0.026s)
[t-SNE] Iteration 650: error = 0.6273455, gradient norm = 0.0001812 (50 iterations in 0.026s)
[t-SNE] Iteration 700: error = 0.6273972, gradient norm = 0.0001637 (50 iterations in 0.026s)
[t-SNE] Iteration 750: error = 0.6273755, gradient norm = 0.0001300 (50 iterations in 0.027s)
[t-SNE] Iteration 800: error = 0.6274072, gradient norm = 0.0001175 (50 iterations in 0.026s)
[t-SNE] Iteration 850: error = 0.6272193, gradient norm = 0.0001853 (50 iterations in 0.027s)
[t-SNE] Iteration 900: error = 0.6273541, gradient norm = 0.0001258 (50 iterations in 0.026s)
[t-SNE] Iteration 950: error = 0.6273538, gradient norm = 0.0001922 (50 iterations in 0.026s)
[t-SNE] Iteration 950: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 950 iterations: 0.627354
[t-SNE] Computed conditional probabilities for sample 201 / 201
[t-SNE] Mean sigma: 0.375250
Beginning preprocessing + Leiden
2024-03-12 01:14:09.763580 MEMORY 13.634330624
Affmat transformed
2024-03-12 01:14:09.766347 MEMORY 13.634330624
sources, targets, weights extracted
2024-03-12 01:14:09.767458 MEMORY 13.634330624
About to launch parallel Leiden runs
2024-03-12 01:14:09.817093 MEMORY 13.634330624
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.9s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.7s finished
Parallel Leiden runs finished
2024-03-12 01:14:12.472716 MEMORY 13.634330624
Quality: 0.30759454323785107
Quality: 0.30759553388324595
Quality: 0.3076949966335567
Quality: 0.30771683809067985
Quality: 0.30932573247130907
Quality: 0.30934010577089777
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 130 out of 177 | elapsed:    0.1s remaining:    0.0s
[Parallel(n_jobs=24)]: Done 177 out of 177 | elapsed:    0.1s finished
Got subclusters: Counter({0: 49, 1: 48, 2: 47, 3: 31, 4: 26})
On pattern 16
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 177 samples in 0.002s...
[t-SNE] Computed neighbors for 177 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 177 / 177
[t-SNE] Mean sigma: 0.459757
[t-SNE] Computed conditional probabilities in 0.012s
[t-SNE] Iteration 50: error = 58.8148804, gradient norm = 0.5210744 (50 iterations in 0.026s)
[t-SNE] Iteration 100: error = 57.6303291, gradient norm = 0.4929463 (50 iterations in 0.027s)
[t-SNE] Iteration 150: error = 61.9410629, gradient norm = 0.5270383 (50 iterations in 0.027s)
[t-SNE] Iteration 200: error = 59.1884193, gradient norm = 0.5012620 (50 iterations in 0.027s)
[t-SNE] Iteration 250: error = 57.3874588, gradient norm = 0.5383599 (50 iterations in 0.026s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 57.387459
[t-SNE] Iteration 300: error = 0.8467258, gradient norm = 0.0067392 (50 iterations in 0.025s)
[t-SNE] Iteration 350: error = 0.6922558, gradient norm = 0.0025868 (50 iterations in 0.025s)
[t-SNE] Iteration 400: error = 0.6708834, gradient norm = 0.0013113 (50 iterations in 0.025s)
[t-SNE] Iteration 450: error = 0.6697767, gradient norm = 0.0002120 (50 iterations in 0.025s)
[t-SNE] Iteration 500: error = 0.6698628, gradient norm = 0.0001339 (50 iterations in 0.025s)
[t-SNE] Iteration 550: error = 0.6697426, gradient norm = 0.0001389 (50 iterations in 0.025s)
[t-SNE] Iteration 600: error = 0.6698998, gradient norm = 0.0001623 (50 iterations in 0.025s)
[t-SNE] Iteration 650: error = 0.6697654, gradient norm = 0.0001337 (50 iterations in 0.025s)
[t-SNE] Iteration 700: error = 0.6698285, gradient norm = 0.0001959 (50 iterations in 0.025s)
[t-SNE] Iteration 750: error = 0.6698013, gradient norm = 0.0001511 (50 iterations in 0.025s)
[t-SNE] Iteration 800: error = 0.6698637, gradient norm = 0.0001411 (50 iterations in 0.025s)
[t-SNE] Iteration 850: error = 0.6697832, gradient norm = 0.0001191 (50 iterations in 0.025s)
[t-SNE] Iteration 900: error = 0.6698974, gradient norm = 0.0001451 (50 iterations in 0.025s)
[t-SNE] Iteration 900: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 900 iterations: 0.669897
[t-SNE] Computed conditional probabilities for sample 177 / 177
[t-SNE] Mean sigma: 0.459757
Beginning preprocessing + Leiden
2024-03-12 01:14:13.231703 MEMORY 13.634330624
Affmat transformed
2024-03-12 01:14:13.234147 MEMORY 13.634330624
sources, targets, weights extracted
2024-03-12 01:14:13.235148 MEMORY 13.634330624
About to launch parallel Leiden runs
2024-03-12 01:14:13.275799 MEMORY 13.634330624
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.9s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.5s finished
Parallel Leiden runs finished
2024-03-12 01:14:15.748647 MEMORY 13.634330624
Quality: 0.2973140465368868
Quality: 0.2973335192669282
Quality: 0.2975770903652939
Quality: 0.2978370831929251
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 172 out of 172 | elapsed:    0.1s finished
Got subclusters: Counter({0: 57, 1: 34, 2: 33, 3: 27, 4: 24, 5: 2})
On pattern 17
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 172 samples in 0.002s...
[t-SNE] Computed neighbors for 172 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 172 / 172
[t-SNE] Mean sigma: 0.427162
[t-SNE] Computed conditional probabilities in 0.012s
[t-SNE] Iteration 50: error = 57.6537704, gradient norm = 0.5442575 (50 iterations in 0.060s)
[t-SNE] Iteration 100: error = 55.8264694, gradient norm = 0.5440938 (50 iterations in 0.025s)
[t-SNE] Iteration 150: error = 55.8875542, gradient norm = 0.5600496 (50 iterations in 0.027s)
[t-SNE] Iteration 200: error = 58.5641861, gradient norm = 0.5256767 (50 iterations in 0.026s)
[t-SNE] Iteration 250: error = 61.5250778, gradient norm = 0.4470067 (50 iterations in 0.025s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 61.525078
[t-SNE] Iteration 300: error = 0.8530071, gradient norm = 0.0075524 (50 iterations in 0.075s)
[t-SNE] Iteration 350: error = 0.6345049, gradient norm = 0.0063114 (50 iterations in 0.027s)
[t-SNE] Iteration 400: error = 0.5717732, gradient norm = 0.0010984 (50 iterations in 0.028s)
[t-SNE] Iteration 450: error = 0.5714515, gradient norm = 0.0001885 (50 iterations in 0.028s)
[t-SNE] Iteration 500: error = 0.5716277, gradient norm = 0.0001739 (50 iterations in 0.033s)
[t-SNE] Iteration 550: error = 0.5714998, gradient norm = 0.0001837 (50 iterations in 0.032s)
[t-SNE] Iteration 600: error = 0.5714933, gradient norm = 0.0001901 (50 iterations in 0.029s)
[t-SNE] Iteration 650: error = 0.5716327, gradient norm = 0.0002490 (50 iterations in 0.030s)
[t-SNE] Iteration 700: error = 0.5715515, gradient norm = 0.0001082 (50 iterations in 0.028s)
[t-SNE] Iteration 750: error = 0.5715975, gradient norm = 0.0002146 (50 iterations in 0.028s)
[t-SNE] Iteration 800: error = 0.5714826, gradient norm = 0.0001567 (50 iterations in 0.028s)
[t-SNE] Iteration 800: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 800 iterations: 0.571483
[t-SNE] Computed conditional probabilities for sample 172 / 172
[t-SNE] Mean sigma: 0.427162
Beginning preprocessing + Leiden
2024-03-12 01:14:16.598877 MEMORY 13.634330624
Affmat transformed
2024-03-12 01:14:16.605334 MEMORY 13.634330624
sources, targets, weights extracted
2024-03-12 01:14:16.606386 MEMORY 13.634330624
About to launch parallel Leiden runs
2024-03-12 01:14:16.633260 MEMORY 13.634330624
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.8s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.4s finished
Parallel Leiden runs finished
2024-03-12 01:14:19.027658 MEMORY 13.634330624
Quality: 0.32204551270795817
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 120 out of 167 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=24)]: Done 167 out of 167 | elapsed:    0.1s finished
Got subclusters: Counter({0: 44, 1: 33, 2: 28, 3: 27, 4: 23, 5: 17})
On pattern 18
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 167 samples in 0.002s...
[t-SNE] Computed neighbors for 167 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 167 / 167
[t-SNE] Mean sigma: 0.437558
[t-SNE] Computed conditional probabilities in 0.012s
[t-SNE] Iteration 50: error = 56.1542435, gradient norm = 0.5052469 (50 iterations in 0.029s)
[t-SNE] Iteration 100: error = 55.6244431, gradient norm = 0.5728771 (50 iterations in 0.026s)
[t-SNE] Iteration 150: error = 55.2426033, gradient norm = 0.5942397 (50 iterations in 0.026s)
[t-SNE] Iteration 200: error = 57.0525284, gradient norm = 0.5346063 (50 iterations in 0.026s)
[t-SNE] Iteration 250: error = 57.2383728, gradient norm = 0.5460972 (50 iterations in 0.026s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 57.238373
[t-SNE] Iteration 300: error = 0.7735249, gradient norm = 0.0090640 (50 iterations in 0.025s)
[t-SNE] Iteration 350: error = 0.5676445, gradient norm = 0.0032007 (50 iterations in 0.025s)
[t-SNE] Iteration 400: error = 0.5472792, gradient norm = 0.0013613 (50 iterations in 0.027s)
[t-SNE] Iteration 450: error = 0.5450485, gradient norm = 0.0003352 (50 iterations in 0.025s)
[t-SNE] Iteration 500: error = 0.5450610, gradient norm = 0.0002553 (50 iterations in 0.025s)
[t-SNE] Iteration 550: error = 0.5446290, gradient norm = 0.0002596 (50 iterations in 0.025s)
[t-SNE] Iteration 600: error = 0.5444419, gradient norm = 0.0003404 (50 iterations in 0.025s)
[t-SNE] Iteration 650: error = 0.5441301, gradient norm = 0.0002577 (50 iterations in 0.025s)
[t-SNE] Iteration 700: error = 0.5442148, gradient norm = 0.0002069 (50 iterations in 0.025s)
[t-SNE] Iteration 750: error = 0.5441639, gradient norm = 0.0002174 (50 iterations in 0.025s)
[t-SNE] Iteration 800: error = 0.5441864, gradient norm = 0.0001999 (50 iterations in 0.025s)
[t-SNE] Iteration 850: error = 0.5440510, gradient norm = 0.0002558 (50 iterations in 0.027s)
[t-SNE] Iteration 900: error = 0.5440621, gradient norm = 0.0002149 (50 iterations in 0.025s)
[t-SNE] Iteration 950: error = 0.5439803, gradient norm = 0.0002787 (50 iterations in 0.025s)
[t-SNE] Iteration 1000: error = 0.5440952, gradient norm = 0.0001903 (50 iterations in 0.025s)
[t-SNE] KL divergence after 1000 iterations: 0.544095
[t-SNE] Computed conditional probabilities for sample 167 / 167
[t-SNE] Mean sigma: 0.437558
Beginning preprocessing + Leiden
2024-03-12 01:14:19.814586 MEMORY 13.634330624
Affmat transformed
2024-03-12 01:14:19.817013 MEMORY 13.634330624
sources, targets, weights extracted
2024-03-12 01:14:19.817927 MEMORY 13.634330624
About to launch parallel Leiden runs
2024-03-12 01:14:19.878043 MEMORY 13.634330624
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.8s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.3s finished
Parallel Leiden runs finished
2024-03-12 01:14:22.227943 MEMORY 13.634330624
Quality: 0.3463636092062458
Quality: 0.34643413025214487
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 112 out of 159 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=24)]: Done 159 out of 159 | elapsed:    0.1s finished
Got subclusters: Counter({0: 52, 1: 34, 2: 33, 3: 23, 4: 15, 5: 10})
On pattern 19
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 159 samples in 0.001s...
[t-SNE] Computed neighbors for 159 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 159 / 159
[t-SNE] Mean sigma: 0.469905
[t-SNE] Computed conditional probabilities in 0.011s
[t-SNE] Iteration 50: error = 57.2409019, gradient norm = 0.4586523 (50 iterations in 0.028s)
[t-SNE] Iteration 100: error = 54.1692200, gradient norm = 0.4930344 (50 iterations in 0.025s)
[t-SNE] Iteration 150: error = 55.3070450, gradient norm = 0.5475547 (50 iterations in 0.025s)
[t-SNE] Iteration 200: error = 55.4595184, gradient norm = 0.4859279 (50 iterations in 0.025s)
[t-SNE] Iteration 250: error = 54.3860359, gradient norm = 0.5511987 (50 iterations in 0.025s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 54.386036
[t-SNE] Iteration 300: error = 0.7047756, gradient norm = 0.0075795 (50 iterations in 0.024s)
[t-SNE] Iteration 350: error = 0.4310364, gradient norm = 0.0039984 (50 iterations in 0.024s)
[t-SNE] Iteration 400: error = 0.4266753, gradient norm = 0.0005702 (50 iterations in 0.024s)
[t-SNE] Iteration 450: error = 0.4266543, gradient norm = 0.0001527 (50 iterations in 0.024s)
[t-SNE] Iteration 500: error = 0.4265691, gradient norm = 0.0001423 (50 iterations in 0.024s)
[t-SNE] Iteration 550: error = 0.4265881, gradient norm = 0.0001279 (50 iterations in 0.024s)
[t-SNE] Iteration 600: error = 0.4265693, gradient norm = 0.0001344 (50 iterations in 0.024s)
[t-SNE] Iteration 650: error = 0.4265730, gradient norm = 0.0001002 (50 iterations in 0.024s)
[t-SNE] Iteration 700: error = 0.4265758, gradient norm = 0.0001174 (50 iterations in 0.024s)
[t-SNE] Iteration 750: error = 0.4265344, gradient norm = 0.0001270 (50 iterations in 0.024s)
[t-SNE] Iteration 800: error = 0.4265655, gradient norm = 0.0001039 (50 iterations in 0.024s)
[t-SNE] Iteration 850: error = 0.4265736, gradient norm = 0.0001286 (50 iterations in 0.024s)
[t-SNE] Iteration 900: error = 0.4264685, gradient norm = 0.0001212 (50 iterations in 0.024s)
[t-SNE] Iteration 950: error = 0.4265112, gradient norm = 0.0001322 (50 iterations in 0.024s)
[t-SNE] Iteration 1000: error = 0.4265905, gradient norm = 0.0001394 (50 iterations in 0.024s)
[t-SNE] KL divergence after 1000 iterations: 0.426591
[t-SNE] Computed conditional probabilities for sample 159 / 159
[t-SNE] Mean sigma: 0.469905
Beginning preprocessing + Leiden
2024-03-12 01:14:22.981335 MEMORY 13.634330624
Affmat transformed
2024-03-12 01:14:22.983670 MEMORY 13.634330624
sources, targets, weights extracted
2024-03-12 01:14:22.984547 MEMORY 13.634330624
About to launch parallel Leiden runs
2024-03-12 01:14:23.011013 MEMORY 13.634330624
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.8s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.3s finished
Parallel Leiden runs finished
2024-03-12 01:14:25.271847 MEMORY 13.634330624
Quality: 0.36321685903341816
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  64 out of 111 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=24)]: Done 111 out of 111 | elapsed:    0.0s finished
Got subclusters: Counter({0: 49, 1: 47, 2: 31, 3: 26, 4: 6})
On pattern 20
[t-SNE] Computing 110 nearest neighbors...
[t-SNE] Indexed 111 samples in 0.001s...
[t-SNE] Computed neighbors for 111 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 111 / 111
[t-SNE] Mean sigma: 0.541287
[t-SNE] Computed conditional probabilities in 0.006s
[t-SNE] Iteration 50: error = 54.1105843, gradient norm = 0.5177581 (50 iterations in 0.021s)
[t-SNE] Iteration 100: error = 54.8283653, gradient norm = 0.5621229 (50 iterations in 0.020s)
[t-SNE] Iteration 150: error = 53.2912788, gradient norm = 0.5298533 (50 iterations in 0.020s)
[t-SNE] Iteration 200: error = 52.4636307, gradient norm = 0.4993859 (50 iterations in 0.020s)
[t-SNE] Iteration 250: error = 53.7622337, gradient norm = 0.5492227 (50 iterations in 0.020s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 53.762234
[t-SNE] Iteration 300: error = 0.8674603, gradient norm = 0.0089494 (50 iterations in 0.021s)
[t-SNE] Iteration 350: error = 0.3539594, gradient norm = 0.0097060 (50 iterations in 0.023s)
[t-SNE] Iteration 400: error = 0.3451811, gradient norm = 0.0007565 (50 iterations in 0.025s)
[t-SNE] Iteration 450: error = 0.3451631, gradient norm = 0.0005110 (50 iterations in 0.025s)
[t-SNE] Iteration 500: error = 0.3450229, gradient norm = 0.0006268 (50 iterations in 0.026s)
[t-SNE] Iteration 550: error = 0.3451955, gradient norm = 0.0014443 (50 iterations in 0.026s)
[t-SNE] Iteration 600: error = 0.3451281, gradient norm = 0.0004429 (50 iterations in 0.026s)
[t-SNE] Iteration 650: error = 0.3452370, gradient norm = 0.0005093 (50 iterations in 0.025s)
[t-SNE] Iteration 700: error = 0.3453384, gradient norm = 0.0006985 (50 iterations in 0.026s)
[t-SNE] Iteration 750: error = 0.3452588, gradient norm = 0.0005616 (50 iterations in 0.025s)
[t-SNE] Iteration 800: error = 0.3451104, gradient norm = 0.0005090 (50 iterations in 0.026s)
[t-SNE] Iteration 850: error = 0.3453548, gradient norm = 0.0007190 (50 iterations in 0.025s)
[t-SNE] Iteration 850: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 850 iterations: 0.345355
[t-SNE] Computed conditional probabilities for sample 111 / 111
[t-SNE] Mean sigma: 0.541287
Beginning preprocessing + Leiden
2024-03-12 01:14:25.835270 MEMORY 13.634330624
Affmat transformed
2024-03-12 01:14:25.836790 MEMORY 13.634330624
sources, targets, weights extracted
2024-03-12 01:14:25.837425 MEMORY 13.634330624
About to launch parallel Leiden runs
2024-03-12 01:14:25.853827 MEMORY 13.634330624
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.8s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.1s finished
Parallel Leiden runs finished
2024-03-12 01:14:27.943841 MEMORY 13.634330624
Quality: 0.2404193616291004
Quality: 0.24041936162910044
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 108 out of 108 | elapsed:    0.0s finished
Got subclusters: Counter({0: 31, 1: 28, 2: 18, 3: 17, 4: 17})
On pattern 21
[t-SNE] Computing 107 nearest neighbors...
[t-SNE] Indexed 108 samples in 0.001s...
[t-SNE] Computed neighbors for 108 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 108 / 108
[t-SNE] Mean sigma: 0.549109
[t-SNE] Computed conditional probabilities in 0.005s
[t-SNE] Iteration 50: error = 55.1028442, gradient norm = 0.5322835 (50 iterations in 0.020s)
[t-SNE] Iteration 100: error = 53.3084412, gradient norm = 0.5701396 (50 iterations in 0.020s)
[t-SNE] Iteration 150: error = 54.8733368, gradient norm = 0.5091522 (50 iterations in 0.020s)
[t-SNE] Iteration 200: error = 54.5174446, gradient norm = 0.5385206 (50 iterations in 0.020s)
[t-SNE] Iteration 250: error = 53.0551605, gradient norm = 0.5394974 (50 iterations in 0.020s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 53.055161
[t-SNE] Iteration 300: error = 0.8489338, gradient norm = 0.0071371 (50 iterations in 0.019s)
[t-SNE] Iteration 350: error = 0.3523102, gradient norm = 0.0109222 (50 iterations in 0.019s)
[t-SNE] Iteration 400: error = 0.3388571, gradient norm = 0.0008474 (50 iterations in 0.019s)
[t-SNE] Iteration 450: error = 0.3390406, gradient norm = 0.0003380 (50 iterations in 0.019s)
[t-SNE] Iteration 500: error = 0.3388511, gradient norm = 0.0005778 (50 iterations in 0.020s)
[t-SNE] Iteration 550: error = 0.3390723, gradient norm = 0.0002703 (50 iterations in 0.019s)
[t-SNE] Iteration 600: error = 0.3388841, gradient norm = 0.0004035 (50 iterations in 0.020s)
[t-SNE] Iteration 650: error = 0.3391587, gradient norm = 0.0003744 (50 iterations in 0.019s)
[t-SNE] Iteration 700: error = 0.3390128, gradient norm = 0.0003358 (50 iterations in 0.019s)
[t-SNE] Iteration 750: error = 0.3391706, gradient norm = 0.0004129 (50 iterations in 0.019s)
[t-SNE] Iteration 800: error = 0.3391513, gradient norm = 0.0002935 (50 iterations in 0.019s)
[t-SNE] Iteration 850: error = 0.3386721, gradient norm = 0.0004219 (50 iterations in 0.019s)
[t-SNE] Iteration 900: error = 0.3393650, gradient norm = 0.0003506 (50 iterations in 0.019s)
[t-SNE] Iteration 950: error = 0.3390307, gradient norm = 0.0003567 (50 iterations in 0.019s)
[t-SNE] Iteration 1000: error = 0.3389252, gradient norm = 0.0003135 (50 iterations in 0.019s)
[t-SNE] KL divergence after 1000 iterations: 0.338925
[t-SNE] Computed conditional probabilities for sample 108 / 108
[t-SNE] Mean sigma: 0.549109
Beginning preprocessing + Leiden
2024-03-12 01:14:28.487440 MEMORY 13.634330624
Affmat transformed
2024-03-12 01:14:28.488905 MEMORY 13.634330624
sources, targets, weights extracted
2024-03-12 01:14:28.489528 MEMORY 13.634330624
About to launch parallel Leiden runs
2024-03-12 01:14:28.516828 MEMORY 13.634330624
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.1s finished
Parallel Leiden runs finished
2024-03-12 01:14:30.582327 MEMORY 13.634330624
Quality: 0.2472169933537094
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  86 out of  86 | elapsed:    0.0s finished
Got subclusters: Counter({0: 41, 1: 25, 2: 23, 3: 19})
On pattern 22
[t-SNE] Computing 85 nearest neighbors...
[t-SNE] Indexed 86 samples in 0.001s...
[t-SNE] Computed neighbors for 86 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 86 / 86
[t-SNE] Mean sigma: 0.576437
[t-SNE] Computed conditional probabilities in 0.004s
[t-SNE] Iteration 50: error = 54.7876511, gradient norm = 0.4656471 (50 iterations in 0.018s)
[t-SNE] Iteration 100: error = 49.5499535, gradient norm = 0.5685415 (50 iterations in 0.017s)
[t-SNE] Iteration 150: error = 50.6333885, gradient norm = 0.3912086 (50 iterations in 0.017s)
[t-SNE] Iteration 200: error = 52.0123672, gradient norm = 0.5661188 (50 iterations in 0.017s)
[t-SNE] Iteration 250: error = 50.7015839, gradient norm = 0.5772643 (50 iterations in 0.017s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 50.701584
[t-SNE] Iteration 300: error = 0.7495663, gradient norm = 0.0104105 (50 iterations in 0.017s)
[t-SNE] Iteration 350: error = 0.2396524, gradient norm = 0.0224155 (50 iterations in 0.017s)
[t-SNE] Iteration 400: error = 0.1885014, gradient norm = 0.0036865 (50 iterations in 0.017s)
[t-SNE] Iteration 450: error = 0.1882019, gradient norm = 0.0006847 (50 iterations in 0.017s)
[t-SNE] Iteration 500: error = 0.1882152, gradient norm = 0.0004148 (50 iterations in 0.017s)
[t-SNE] Iteration 550: error = 0.1881165, gradient norm = 0.0005042 (50 iterations in 0.017s)
[t-SNE] Iteration 600: error = 0.1882693, gradient norm = 0.0003949 (50 iterations in 0.017s)
[t-SNE] Iteration 650: error = 0.1882037, gradient norm = 0.0003488 (50 iterations in 0.017s)
[t-SNE] Iteration 700: error = 0.1881671, gradient norm = 0.0004216 (50 iterations in 0.017s)
[t-SNE] Iteration 750: error = 0.1882210, gradient norm = 0.0004354 (50 iterations in 0.017s)
[t-SNE] Iteration 800: error = 0.1882790, gradient norm = 0.0003561 (50 iterations in 0.017s)
[t-SNE] Iteration 850: error = 0.1882825, gradient norm = 0.0004150 (50 iterations in 0.017s)
[t-SNE] Iteration 900: error = 0.1881824, gradient norm = 0.0003665 (50 iterations in 0.017s)
[t-SNE] Iteration 900: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 900 iterations: 0.188182
[t-SNE] Computed conditional probabilities for sample 86 / 86
[t-SNE] Mean sigma: 0.576437
Beginning preprocessing + Leiden
2024-03-12 01:14:31.005943 MEMORY 13.634330624
Affmat transformed
2024-03-12 01:14:31.007123 MEMORY 13.634330624
sources, targets, weights extracted
2024-03-12 01:14:31.007619 MEMORY 13.634330624
About to launch parallel Leiden runs
2024-03-12 01:14:31.048682 MEMORY 13.634330624
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.0s finished
Parallel Leiden runs finished
2024-03-12 01:14:33.062696 MEMORY 13.634330624
Quality: 0.22303420112051525
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  64 out of  64 | elapsed:    0.0s finished
Got subclusters: Counter({0: 29, 1: 26, 2: 13, 3: 11, 4: 7})
On pattern 23
[t-SNE] Computing 63 nearest neighbors...
[t-SNE] Indexed 64 samples in 0.001s...
[t-SNE] Computed neighbors for 64 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 64 / 64
[t-SNE] Mean sigma: 0.801586
[t-SNE] Computed conditional probabilities in 0.002s
[t-SNE] Iteration 50: error = 48.9020424, gradient norm = 0.4630981 (50 iterations in 0.015s)
[t-SNE] Iteration 100: error = 48.7291451, gradient norm = 0.5291673 (50 iterations in 0.015s)
[t-SNE] Iteration 150: error = 47.7123184, gradient norm = 0.4039872 (50 iterations in 0.015s)
[t-SNE] Iteration 200: error = 45.1986542, gradient norm = 0.6508796 (50 iterations in 0.015s)
[t-SNE] Iteration 250: error = 47.8490067, gradient norm = 0.4166803 (50 iterations in 0.015s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 47.849007
[t-SNE] Iteration 300: error = 0.8198790, gradient norm = 0.0016546 (50 iterations in 0.015s)
[t-SNE] Iteration 350: error = 0.7417248, gradient norm = 0.0010316 (50 iterations in 0.015s)
[t-SNE] Iteration 400: error = 0.6887918, gradient norm = 0.0006626 (50 iterations in 0.014s)
[t-SNE] Iteration 450: error = 0.6310957, gradient norm = 0.0006909 (50 iterations in 0.014s)
[t-SNE] Iteration 500: error = 0.5856853, gradient norm = 0.0009331 (50 iterations in 0.014s)
[t-SNE] Iteration 550: error = 0.5404855, gradient norm = 0.0004810 (50 iterations in 0.015s)
[t-SNE] Iteration 600: error = 0.5193608, gradient norm = 0.0002789 (50 iterations in 0.014s)
[t-SNE] Iteration 650: error = 0.5011817, gradient norm = 0.0004958 (50 iterations in 0.014s)
[t-SNE] Iteration 700: error = 0.4895953, gradient norm = 0.0001812 (50 iterations in 0.014s)
[t-SNE] Iteration 750: error = 0.4835912, gradient norm = 0.0002977 (50 iterations in 0.014s)
[t-SNE] Iteration 800: error = 0.4745921, gradient norm = 0.0002322 (50 iterations in 0.014s)
[t-SNE] Iteration 850: error = 0.4683717, gradient norm = 0.0004792 (50 iterations in 0.014s)
[t-SNE] Iteration 900: error = 0.4548644, gradient norm = 0.0005505 (50 iterations in 0.014s)
[t-SNE] Iteration 950: error = 0.4369187, gradient norm = 0.0009863 (50 iterations in 0.014s)
[t-SNE] Iteration 1000: error = 0.7255315, gradient norm = 0.0030285 (50 iterations in 0.015s)
[t-SNE] KL divergence after 1000 iterations: 0.725532
[t-SNE] Computed conditional probabilities for sample 64 / 64
[t-SNE] Mean sigma: 0.801586
Beginning preprocessing + Leiden
2024-03-12 01:14:33.432323 MEMORY 13.634330624
Affmat transformed
2024-03-12 01:14:33.433292 MEMORY 13.634330624
sources, targets, weights extracted
2024-03-12 01:14:33.433702 MEMORY 13.634330624
About to launch parallel Leiden runs
2024-03-12 01:14:33.458293 MEMORY 13.634330624
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.9s finished
Parallel Leiden runs finished
2024-03-12 01:14:35.380498 MEMORY 13.634330624
Quality: 0.15557906850539446
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done  46 out of  46 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=24)]: Done  46 out of  46 | elapsed:    0.0s finished
Got subclusters: Counter({0: 32, 1: 24, 2: 8})
On pattern 24
[t-SNE] Computing 45 nearest neighbors...
[t-SNE] Indexed 46 samples in 0.000s...
[t-SNE] Computed neighbors for 46 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 46 / 46
[t-SNE] Mean sigma: 11.454646
[t-SNE] Computed conditional probabilities in 0.001s
[t-SNE] Iteration 50: error = 44.4511185, gradient norm = 0.4720381 (50 iterations in 0.013s)
[t-SNE] Iteration 100: error = 43.6314507, gradient norm = 0.4705967 (50 iterations in 0.016s)
[t-SNE] Iteration 150: error = 40.7773247, gradient norm = 0.6029546 (50 iterations in 0.013s)
[t-SNE] Iteration 200: error = 47.8714485, gradient norm = 0.3227000 (50 iterations in 0.013s)
[t-SNE] Iteration 250: error = 42.8881912, gradient norm = 0.4611842 (50 iterations in 0.013s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 42.888191
[t-SNE] Iteration 300: error = 0.7811300, gradient norm = 0.0013623 (50 iterations in 0.013s)
[t-SNE] Iteration 350: error = 0.6205534, gradient norm = 0.0004107 (50 iterations in 0.013s)
[t-SNE] Iteration 400: error = 0.5977215, gradient norm = 0.0001116 (50 iterations in 0.013s)
[t-SNE] Iteration 450: error = 0.5971782, gradient norm = 0.0000417 (50 iterations in 0.013s)
[t-SNE] Iteration 500: error = 0.5969231, gradient norm = 0.0000354 (50 iterations in 0.013s)
[t-SNE] Iteration 550: error = 0.5970055, gradient norm = 0.0000401 (50 iterations in 0.013s)
[t-SNE] Iteration 600: error = 0.5961122, gradient norm = 0.0000417 (50 iterations in 0.013s)
[t-SNE] Iteration 650: error = 0.5961896, gradient norm = 0.0000213 (50 iterations in 0.013s)
[t-SNE] Iteration 700: error = 0.5958939, gradient norm = 0.0000169 (50 iterations in 0.013s)
[t-SNE] Iteration 750: error = 0.5959510, gradient norm = 0.0000144 (50 iterations in 0.013s)
[t-SNE] Iteration 800: error = 0.5962423, gradient norm = 0.0000122 (50 iterations in 0.013s)
[t-SNE] Iteration 850: error = 0.5961568, gradient norm = 0.0000122 (50 iterations in 0.013s)
[t-SNE] Iteration 900: error = 0.5960975, gradient norm = 0.0000129 (50 iterations in 0.013s)
[t-SNE] Iteration 950: error = 0.5960297, gradient norm = 0.0000300 (50 iterations in 0.013s)
[t-SNE] Iteration 1000: error = 0.5959782, gradient norm = 0.0000215 (50 iterations in 0.013s)
[t-SNE] KL divergence after 1000 iterations: 0.595978
[t-SNE] Computed conditional probabilities for sample 46 / 46
[t-SNE] Mean sigma: 1125899906842624.000000
Beginning preprocessing + Leiden
2024-03-12 01:14:35.699603 MEMORY 13.634330624
Affmat transformed
2024-03-12 01:14:35.700575 MEMORY 13.634330624
sources, targets, weights extracted
2024-03-12 01:14:35.700970 MEMORY 13.634330624
About to launch parallel Leiden runs
2024-03-12 01:14:35.719121 MEMORY 13.634330624
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.9s finished
Parallel Leiden runs finished
2024-03-12 01:14:37.615297 MEMORY 13.634330624
Quality: -5.4622972811555424e-14
Got subclusters: Counter({0: 46})
On metacluster 1
Metacluster size 60626 limited to 20000
Relevant tasks:  ('head', 'testis')
Relevant signs:  (-1, -1)
TfModiscoSeqletsToPatternsFactory: seed=1234
(Round 1) num seqlets: 20000
(Round 1) Computing coarse affmat
2024-03-12 01:14:40.617856 MEMORY 13.63406848
Beginning embedding computation
MEMORY 13.63406848
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 152 tasks      | elapsed:    2.4s
[Parallel(n_jobs=24)]: Done 402 tasks      | elapsed:    5.9s
[Parallel(n_jobs=24)]: Done 752 tasks      | elapsed:   10.6s
[Parallel(n_jobs=24)]: Done 1202 tasks      | elapsed:   16.6s
[Parallel(n_jobs=24)]: Done 1752 tasks      | elapsed:   23.9s
[Parallel(n_jobs=24)]: Done 2402 tasks      | elapsed:   32.6s
[Parallel(n_jobs=24)]: Done 3152 tasks      | elapsed:   42.5s
[Parallel(n_jobs=24)]: Done 4002 tasks      | elapsed:   54.0s
[Parallel(n_jobs=24)]: Done 4952 tasks      | elapsed:  1.1min
[Parallel(n_jobs=24)]: Done 6002 tasks      | elapsed:  1.3min
[Parallel(n_jobs=24)]: Done 7152 tasks      | elapsed:  1.6min
[Parallel(n_jobs=24)]: Done 8402 tasks      | elapsed:  1.9min
[Parallel(n_jobs=24)]: Done 9752 tasks      | elapsed:  2.2min
[Parallel(n_jobs=24)]: Done 11202 tasks      | elapsed:  2.5min
[Parallel(n_jobs=24)]: Done 12752 tasks      | elapsed:  2.8min
[Parallel(n_jobs=24)]: Done 14402 tasks      | elapsed:  3.2min
[Parallel(n_jobs=24)]: Done 16152 tasks      | elapsed:  3.6min
[Parallel(n_jobs=24)]: Done 18002 tasks      | elapsed:  4.0min
[Parallel(n_jobs=24)]: Done 19952 tasks      | elapsed:  4.5min
[Parallel(n_jobs=24)]: Done 20000 out of 20000 | elapsed:  4.5min finished
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.4s
[Parallel(n_jobs=24)]: Done 152 tasks      | elapsed:    2.4s
[Parallel(n_jobs=24)]: Done 402 tasks      | elapsed:    5.8s
[Parallel(n_jobs=24)]: Done 752 tasks      | elapsed:   10.4s
[Parallel(n_jobs=24)]: Done 1202 tasks      | elapsed:   16.5s
[Parallel(n_jobs=24)]: Done 1752 tasks      | elapsed:   24.0s
[Parallel(n_jobs=24)]: Done 2402 tasks      | elapsed:   33.0s
[Parallel(n_jobs=24)]: Done 3152 tasks      | elapsed:   43.4s
[Parallel(n_jobs=24)]: Done 4002 tasks      | elapsed:   55.2s
[Parallel(n_jobs=24)]: Done 4952 tasks      | elapsed:  1.1min
[Parallel(n_jobs=24)]: Done 6002 tasks      | elapsed:  1.4min
[Parallel(n_jobs=24)]: Done 7152 tasks      | elapsed:  1.6min
[Parallel(n_jobs=24)]: Done 8402 tasks      | elapsed:  1.9min
[Parallel(n_jobs=24)]: Done 9752 tasks      | elapsed:  2.2min
[Parallel(n_jobs=24)]: Done 11202 tasks      | elapsed:  2.6min
[Parallel(n_jobs=24)]: Done 12752 tasks      | elapsed:  2.9min
[Parallel(n_jobs=24)]: Done 14402 tasks      | elapsed:  3.3min
[Parallel(n_jobs=24)]: Done 16152 tasks      | elapsed:  3.7min
[Parallel(n_jobs=24)]: Done 18002 tasks      | elapsed:  4.1min
[Parallel(n_jobs=24)]: Done 19952 tasks      | elapsed:  4.6min
[Parallel(n_jobs=24)]: Done 20000 out of 20000 | elapsed:  4.6min finished
At the beginning of embedding call
2024-03-12 01:14:40.618184 MEMORY 13.63406848
before computing embeddings fwd
2024-03-12 01:14:40.628739 MEMORY 13.63406848
after computing embeddings fwd
2024-03-12 01:19:08.397074 MEMORY 13.777494016
after computing embeddings rev
2024-03-12 01:23:42.574437 MEMORY 14.540234752
before computing sparse embeddings fwd
2024-03-12 01:23:42.574648 MEMORY 14.540234752
Constructing csr matrix...
csr matrix made in 3.066472291946411 s
after computing sparse embeddings fwd
2024-03-12 01:23:46.592737 MEMORY 14.699331584
before computing sparse embeddings rev
2024-03-12 01:23:46.592884 MEMORY 14.699331584
Constructing csr matrix...
csr matrix made in 2.73056960105896 s
after computing sparse embeddings rev
2024-03-12 01:23:50.546000 MEMORY 14.819598336
Finished embedding computation in 552.21 s
MEMORY 14.113120256
Starting affinity matrix computations
MEMORY 14.112595968
Batching in slices of size 3355
  0%|          | 0/6 [00:00<?, ?it/s] 17%|â–ˆâ–‹        | 1/6 [00:10<00:54, 10.89s/it] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 2/6 [00:21<00:43, 10.84s/it] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 3/6 [00:32<00:32, 10.80s/it] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 4/6 [00:43<00:21, 10.77s/it] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 5/6 [00:53<00:10, 10.76s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [01:04<00:00, 10.70s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [01:04<00:00, 10.75s/it]
Finished affinity matrix computations in 64.65 s
MEMORY 14.112595968
(Round 1) Computed coarse affmat
2024-03-12 01:24:58.781265 MEMORY 13.872062464
(Round 1) Computing affinity matrix on nearest neighbors
2024-03-12 01:24:58.781464 MEMORY 13.872062464
Launching nearest neighbors affmat calculation job
MEMORY 14.158729216
Parallel runs completed
MEMORY 14.25025024
Job completed in: 78.46 s
MEMORY 14.25065984
Launching nearest neighbors affmat calculation job
MEMORY 14.248656896
Parallel runs completed
MEMORY 14.445146112
Job completed in: 80.04 s
MEMORY 14.44317184
(Round 1) Computed affinity matrix on nearest neighbors in 165.59 s
2024-03-12 01:27:44.378081 MEMORY 14.09396736
Filtered down to 18495 of 20000
(Round 1) Retained 18495 rows out of 20000 after filtering
2024-03-12 01:27:57.390024 MEMORY 14.09396736
(Round 1) Computing density adapted affmat
2024-03-12 01:28:02.891097 MEMORY 14.09396736
Symmetrizing nearest neighbors
Computing betas for density adaptation
Computing normalizing denominators
(Round 1) Computing clustering
2024-03-12 01:31:02.782334 MEMORY 15.096147968
Beginning preprocessing + Leiden
2024-03-12 01:31:02.813432 MEMORY 15.096205312
Affmat transformed
2024-03-12 01:31:02.813671 MEMORY 15.096205312
sources, targets, weights extracted
2024-03-12 01:31:03.495935 MEMORY 15.096283136
About to launch parallel Leiden runs
2024-03-12 01:31:03.677699 MEMORY 15.096348672
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:  2.1min
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:  7.8min finished
Parallel Leiden runs finished
2024-03-12 01:38:49.123153 MEMORY 15.096492032
Quality: 0.485093815727379
Quality: 0.4850956471126616
Quality: 0.48541882928008007
Quality: 0.48542612708035515
Quality: 0.48542903337367216
Got 5 clusters after round 1
Counts:
{0: 7603, 1: 4096, 3: 2772, 2: 3163, 4: 861}
2024-03-12 01:38:49.165906 MEMORY 15.096520704
(Round 1) Aggregating seqlets in each cluster
2024-03-12 01:38:49.166052 MEMORY 15.096520704
Aggregating for cluster 0 with 7603 seqlets
2024-03-12 01:38:49.173292 MEMORY 15.096537088
Skipped 22 due to duplicates
Trimming eliminated 0 seqlets out of 7581
Aggregating for cluster 1 with 4096 seqlets
2024-03-12 01:39:12.831482 MEMORY 15.096717312
Skipped 6 due to duplicates
Trimming eliminated 0 seqlets out of 4090
Aggregating for cluster 2 with 3163 seqlets
2024-03-12 01:39:24.529267 MEMORY 15.096721408
Removed 1 duplicate seqlets
Skipped 4 due to duplicates
Trimming eliminated 0 seqlets out of 3158
Aggregating for cluster 3 with 2772 seqlets
2024-03-12 01:39:33.905643 MEMORY 15.096721408
Trimming eliminated 0 seqlets out of 2772
Aggregating for cluster 4 with 861 seqlets
2024-03-12 01:39:43.792040 MEMORY 15.096721408
Trimming eliminated 0 seqlets out of 861
(Round 2) num seqlets: 18450
(Round 2) Computing coarse affmat
2024-03-12 01:39:47.573704 MEMORY 15.096721408
Beginning embedding computation
MEMORY 15.096721408
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 320 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done 2256 tasks      | elapsed:    3.0s
[Parallel(n_jobs=24)]: Done 5056 tasks      | elapsed:    6.1s
[Parallel(n_jobs=24)]: Done 8656 tasks      | elapsed:   10.0s
[Parallel(n_jobs=24)]: Done 13056 tasks      | elapsed:   15.0s
[Parallel(n_jobs=24)]: Done 18403 out of 18450 | elapsed:   20.7s remaining:    0.1s
[Parallel(n_jobs=24)]: Done 18450 out of 18450 | elapsed:   20.7s finished
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 256 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done 1224 tasks      | elapsed:    2.2s
[Parallel(n_jobs=24)]: Done 2624 tasks      | elapsed:    4.3s
[Parallel(n_jobs=24)]: Done 4424 tasks      | elapsed:    7.0s
[Parallel(n_jobs=24)]: Done 6624 tasks      | elapsed:   10.2s
[Parallel(n_jobs=24)]: Done 9224 tasks      | elapsed:   14.0s
[Parallel(n_jobs=24)]: Done 12224 tasks      | elapsed:   18.3s
[Parallel(n_jobs=24)]: Done 15624 tasks      | elapsed:   23.3s
[Parallel(n_jobs=24)]: Done 18450 out of 18450 | elapsed:   27.3s finished
At the beginning of embedding call
2024-03-12 01:39:47.574015 MEMORY 15.096721408
before computing embeddings fwd
2024-03-12 01:39:47.584465 MEMORY 15.096721408
after computing embeddings fwd
2024-03-12 01:40:08.306066 MEMORY 15.605100544
after computing embeddings rev
2024-03-12 01:40:35.632098 MEMORY 16.353435648
before computing sparse embeddings fwd
2024-03-12 01:40:35.632236 MEMORY 16.353435648
Constructing csr matrix...
csr matrix made in 2.393488645553589 s
after computing sparse embeddings fwd
2024-03-12 01:40:39.124821 MEMORY 16.353783808
before computing sparse embeddings rev
2024-03-12 01:40:39.124941 MEMORY 16.353783808
Constructing csr matrix...
csr matrix made in 2.3180267810821533 s
after computing sparse embeddings rev
2024-03-12 01:40:42.461750 MEMORY 16.42749952
Finished embedding computation in 57.44 s
MEMORY 15.762178048
Starting affinity matrix computations
MEMORY 15.761395712
Batching in slices of size 3637
  0%|          | 0/6 [00:00<?, ?it/s] 17%|â–ˆâ–‹        | 1/6 [00:12<01:03, 12.74s/it] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 2/6 [00:25<00:50, 12.66s/it] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 3/6 [00:38<00:38, 12.78s/it] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 4/6 [00:49<00:24, 12.32s/it] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 5/6 [01:01<00:12, 12.23s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [01:04<00:00,  8.88s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [01:04<00:00, 10.72s/it]
Finished affinity matrix computations in 64.4 s
MEMORY 15.761330176
(Round 2) Computed coarse affmat
2024-03-12 01:41:51.098135 MEMORY 15.686828032
(Round 2) Computing affinity matrix on nearest neighbors
2024-03-12 01:41:51.098358 MEMORY 15.686828032
Launching nearest neighbors affmat calculation job
MEMORY 15.686828032
Parallel runs completed
MEMORY 15.723528192
Job completed in: 40.48 s
MEMORY 15.723331584
Launching nearest neighbors affmat calculation job
MEMORY 15.723204608
Parallel runs completed
MEMORY 15.758610432
Job completed in: 44.15 s
MEMORY 15.756423168
(Round 2) Computed affinity matrix on nearest neighbors in 91.27 s
2024-03-12 01:43:22.372345 MEMORY 15.75622656
Not applying filtering for rounds above first round
2024-03-12 01:43:22.374387 MEMORY 15.75622656
(Round 2) Computing density adapted affmat
2024-03-12 01:43:28.098276 MEMORY 15.817216
Symmetrizing nearest neighbors
Computing betas for density adaptation
Computing normalizing denominators
(Round 2) Computing clustering
2024-03-12 01:46:26.634674 MEMORY 15.87703808
Beginning preprocessing + Leiden
2024-03-12 01:46:26.665813 MEMORY 15.87703808
Affmat transformed
2024-03-12 01:46:26.666044 MEMORY 15.87703808
sources, targets, weights extracted
2024-03-12 01:46:27.356030 MEMORY 15.87703808
About to launch parallel Leiden runs
2024-03-12 01:46:27.582638 MEMORY 15.877009408
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:  2.0min
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:  6.7min finished
Parallel Leiden runs finished
2024-03-12 01:53:11.478514 MEMORY 15.877009408
Quality: 0.5645133161615749
Quality: 0.5653941037650726
Quality: 0.5658632348670221
Got 6 clusters after round 2
Counts:
{1: 4103, 0: 5143, 4: 2525, 3: 2720, 2: 3266, 5: 693}
2024-03-12 01:53:11.527425 MEMORY 15.715446784
(Round 2) Aggregating seqlets in each cluster
2024-03-12 01:53:11.527579 MEMORY 15.715446784
Aggregating for cluster 0 with 5143 seqlets
2024-03-12 01:53:11.535750 MEMORY 15.715446784
Skipped 1 due to duplicates
Trimming eliminated 0 seqlets out of 5142
Aggregating for cluster 1 with 4103 seqlets
2024-03-12 01:53:23.242626 MEMORY 15.715528704
Skipped 7 due to duplicates
Trimming eliminated 0 seqlets out of 4096
Aggregating for cluster 2 with 3266 seqlets
2024-03-12 01:53:34.982681 MEMORY 15.715557376
Trimming eliminated 0 seqlets out of 3266
Aggregating for cluster 3 with 2720 seqlets
2024-03-12 01:53:42.302733 MEMORY 15.715557376
Skipped 1 due to duplicates
Trimming eliminated 0 seqlets out of 2719
Aggregating for cluster 4 with 2525 seqlets
2024-03-12 01:53:48.097700 MEMORY 15.715557376
Skipped 1 due to duplicates
Trimming eliminated 0 seqlets out of 2524
Aggregating for cluster 5 with 693 seqlets
2024-03-12 01:53:53.380135 MEMORY 15.715557376
Trimming eliminated 0 seqlets out of 693
Got 6 clusters
Splitting into subclusters...
2024-03-12 01:53:56.451410 MEMORY 15.715557376
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.6s
[Parallel(n_jobs=24)]: Done 2400 tasks      | elapsed:    2.8s
[Parallel(n_jobs=24)]: Done 5142 out of 5142 | elapsed:    5.7s finished
Inspecting pattern 0 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 5142
[t-SNE] Computed conditional probabilities for sample 2000 / 5142
[t-SNE] Computed conditional probabilities for sample 3000 / 5142
[t-SNE] Computed conditional probabilities for sample 4000 / 5142
[t-SNE] Computed conditional probabilities for sample 5000 / 5142
[t-SNE] Computed conditional probabilities for sample 5142 / 5142
[t-SNE] Mean sigma: 0.267836
Beginning preprocessing + Leiden
2024-03-12 01:54:07.936734 MEMORY 15.717486592
Affmat transformed
2024-03-12 01:54:08.010194 MEMORY 15.717502976
sources, targets, weights extracted
2024-03-12 01:54:08.055243 MEMORY 15.717502976
About to launch parallel Leiden runs
2024-03-12 01:54:08.103277 MEMORY 15.717502976
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:   20.9s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:  1.1min finished
Parallel Leiden runs finished
2024-03-12 01:55:14.485116 MEMORY 15.717502976
Quality: 0.58174211546985
Quality: 0.5818758203850555
Quality: 0.5819189866102015
Quality: 0.5821951496917928
Got subclusters: Counter({0: 1008, 1: 992, 2: 732, 3: 615, 4: 513, 5: 458, 6: 316, 7: 235, 8: 154, 9: 119})
On merging iteration 1
Numbers for each pattern pre-subsample: [1008, 992, 732, 615, 513, 458, 316, 235, 154, 119]
Numbers after subsampling: [300, 300, 300, 300, 300, 300, 300, 235, 154, 119]
Computing sims for pattern 0
Computed sims for pattern 0 in 3.7387890815734863 s
Computing sims for pattern 1
Computed sims for pattern 1 in 3.778614044189453 s
Computing sims for pattern 2
Computed sims for pattern 2 in 3.833235740661621 s
Computing sims for pattern 3
Computed sims for pattern 3 in 3.8741438388824463 s
Computing sims for pattern 4
Computed sims for pattern 4 in 3.9276299476623535 s
Computing sims for pattern 5
Computed sims for pattern 5 in 3.8832035064697266 s
Computing sims for pattern 6
Computed sims for pattern 6 in 3.7914624214172363 s
Computing sims for pattern 7
Computed sims for pattern 7 in 3.51359224319458 s
Computing sims for pattern 8
Computed sims for pattern 8 in 2.2046074867248535 s
Computing sims for pattern 9
Computed sims for pattern 9 in 1.9092390537261963 s
Cluster sizes
[1008  992  732  615  513  458  316  235  154  119]
Cross-contamination matrix:
[[1.   0.76 0.55 0.63 0.48 0.8  0.58 0.48 0.4  0.15]
 [0.74 1.   0.57 0.66 0.57 0.63 0.57 0.43 0.37 0.07]
 [0.66 0.71 1.   0.77 0.72 0.53 0.61 0.5  0.42 0.38]
 [0.65 0.69 0.67 1.   0.5  0.53 0.66 0.45 0.4  0.26]
 [0.73 0.84 0.86 0.73 1.   0.63 0.63 0.46 0.47 0.13]
 [0.85 0.68 0.45 0.53 0.4  1.   0.47 0.48 0.3  0.12]
 [0.64 0.66 0.55 0.72 0.42 0.5  1.   0.49 0.28 0.17]
 [0.78 0.73 0.68 0.72 0.47 0.76 0.74 1.   0.31 0.53]
 [0.72 0.69 0.62 0.71 0.49 0.56 0.51 0.31 1.   0.3 ]
 [0.3  0.13 0.52 0.45 0.11 0.26 0.32 0.55 0.29 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.93 0.9  0.93 0.87 0.95 0.91 0.92 0.79 0.61]
 [0.93 1.   0.89 0.92 0.9  0.91 0.91 0.9  0.81 0.61]
 [0.9  0.89 1.   0.91 0.91 0.86 0.86 0.87 0.84 0.69]
 [0.93 0.92 0.91 1.   0.85 0.88 0.89 0.84 0.89 0.69]
 [0.87 0.9  0.91 0.85 1.   0.84 0.85 0.85 0.72 0.56]
 [0.95 0.91 0.86 0.88 0.84 1.   0.87 0.86 0.75 0.55]
 [0.91 0.91 0.86 0.89 0.85 0.87 1.   0.85 0.75 0.6 ]
 [0.92 0.9  0.87 0.84 0.85 0.86 0.85 1.   0.66 0.77]
 [0.79 0.81 0.84 0.89 0.72 0.75 0.75 0.66 1.   0.72]
 [0.61 0.61 0.69 0.69 0.56 0.55 0.6  0.77 0.72 1.  ]]
Collapsing 0 & 5 with crosscontam 0.8012786103703706 and sim 0.9471048215333443
Collapsing 0 & 1 with crosscontam 0.7433267461728394 and sim 0.9343327471567797
Collapsing 0 & 3 with crosscontam 0.629588928888889 and sim 0.9324249904476477
Collapsing 1 & 3 with crosscontam 0.6554914982716049 and sim 0.9231448795971449
Collapsing 0 & 7 with crosscontam 0.48027720724980316 and sim 0.9230665883294583
Collapsing 2 & 4 with crosscontam 0.7235957733333334 and sim 0.9090560231054168
Collapsing 1 & 6 with crosscontam 0.5740906118518518 and sim 0.908887185899847
Collapsing 2 & 3 with crosscontam 0.6650330296296296 and sim 0.9087696494787978
Collapsing 0 & 6 with crosscontam 0.5771703032098765 and sim 0.9067670027298922
Collapsing 1 & 5 with crosscontam 0.6281964409876544 and sim 0.9054344350124174
Collapsing 1 & 7 with crosscontam 0.43247880914105585 and sim 0.9023353167503508
Collapsing 0 & 2 with crosscontam 0.5460222039506173 and sim 0.8998222826129769
Collapsing 1 & 4 with crosscontam 0.5660149313580247 and sim 0.8969008843895977
Collapsing 1 & 2 with crosscontam 0.5739135185185187 and sim 0.8932439399607351
Collapsing 3 & 6 with crosscontam 0.6629248775308643 and sim 0.8932422143935065
Collapsing 3 & 5 with crosscontam 0.5276239140740739 and sim 0.8779167250982267
Collapsing 2 & 7 with crosscontam 0.5023008088258472 and sim 0.8694085838464751
Collapsing 2 & 6 with crosscontam 0.5482322340740742 and sim 0.8646382091163757
Collapsing 3 & 4 with crosscontam 0.504098680493827 and sim 0.8535599476437448
Trimming eliminated 0 seqlets out of 1466
Trimming eliminated 0 seqlets out of 2458
Trimming eliminated 0 seqlets out of 3073
Trimming eliminated 0 seqlets out of 3308
Removed 1 duplicate seqlets
Trimming eliminated 0 seqlets out of 1244
Trimming eliminated 0 seqlets out of 3624
Trimming eliminated 0 seqlets out of 4868
Unmerged patterns remapping: OrderedDict([(8, 1), (9, 2)])
Time spent on merging iteration: 36.89316487312317
On merging iteration 2
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.5s
[Parallel(n_jobs=24)]: Done 3630 tasks      | elapsed:    3.2s
[Parallel(n_jobs=24)]: Done 4096 out of 4096 | elapsed:    3.6s finished
Numbers for each pattern pre-subsample: [4868, 154, 119]
Numbers after subsampling: [300, 154, 119]
Computing sims for pattern 0
Computed sims for pattern 0 in 0.7574501037597656 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.2610666751861572 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.2267167568206787 s
Cluster sizes
[4868  154  119]
Cross-contamination matrix:
[[1.   0.62 0.4 ]
 [0.65 1.   0.3 ]
 [0.37 0.29 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.83 0.63]
 [0.83 1.   0.72]
 [0.63 0.72 1.  ]]
Inspecting pattern 1 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 4096
[t-SNE] Computed conditional probabilities for sample 2000 / 4096
[t-SNE] Computed conditional probabilities for sample 3000 / 4096
[t-SNE] Computed conditional probabilities for sample 4000 / 4096
[t-SNE] Computed conditional probabilities for sample 4096 / 4096
[t-SNE] Mean sigma: 0.257717
Beginning preprocessing + Leiden
2024-03-12 01:56:34.920984 MEMORY 15.717916672
Affmat transformed
2024-03-12 01:56:34.975085 MEMORY 15.717916672
sources, targets, weights extracted
2024-03-12 01:56:35.012271 MEMORY 15.717916672
About to launch parallel Leiden runs
2024-03-12 01:56:35.052314 MEMORY 15.717892096
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:   15.4s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   49.1s finished
Parallel Leiden runs finished
2024-03-12 01:57:24.122993 MEMORY 15.717892096
Quality: 0.5828994228300911
Quality: 0.5830855755780068
Quality: 0.5837416310757064
Quality: 0.5837468170993138
Quality: 0.5837484097312985
Quality: 0.5838890712763264
Got subclusters: Counter({0: 853, 1: 747, 2: 567, 3: 360, 4: 358, 5: 311, 6: 288, 7: 194, 8: 191, 9: 124, 10: 103})
On merging iteration 1
Numbers for each pattern pre-subsample: [853, 747, 567, 360, 358, 311, 288, 194, 191, 124, 103]
Numbers after subsampling: [300, 300, 300, 300, 300, 300, 288, 194, 191, 124, 103]
Computing sims for pattern 0
Computed sims for pattern 0 in 4.1234307289123535 s
Computing sims for pattern 1
Computed sims for pattern 1 in 4.206077337265015 s
Computing sims for pattern 2
Computed sims for pattern 2 in 4.178203821182251 s
Computing sims for pattern 3
Computed sims for pattern 3 in 4.248312473297119 s
Computing sims for pattern 4
Computed sims for pattern 4 in 4.244976043701172 s
Computing sims for pattern 5
Computed sims for pattern 5 in 4.221146106719971 s
Computing sims for pattern 6
Computed sims for pattern 6 in 3.992885112762451 s
Computing sims for pattern 7
Computed sims for pattern 7 in 3.1628828048706055 s
Computing sims for pattern 8
Computed sims for pattern 8 in 3.11875057220459 s
Computing sims for pattern 9
Computed sims for pattern 9 in 2.1737139225006104 s
Computing sims for pattern 10
Computed sims for pattern 10 in 1.8244054317474365 s
Cluster sizes
[853 747 567 360 358 311 288 194 191 124 103]
Cross-contamination matrix:
[[1.   0.75 1.   0.72 0.72 0.96 0.43 0.79 0.87 0.59 0.83]
 [0.47 1.   1.   0.3  0.55 1.   0.36 0.81 0.86 0.52 0.68]
 [0.27 0.4  1.   0.18 0.2  0.66 0.27 0.47 0.52 0.38 0.37]
 [0.66 0.5  0.76 1.   0.47 0.63 0.24 0.58 0.72 0.47 0.51]
 [0.78 0.89 0.94 0.49 1.   0.96 0.39 0.8  0.87 0.47 0.81]
 [0.27 0.48 0.83 0.15 0.22 1.   0.2  0.46 0.54 0.26 0.4 ]
 [0.32 0.55 1.   0.19 0.26 0.76 1.   0.62 0.58 0.61 0.46]
 [0.31 0.55 0.88 0.22 0.27 0.73 0.26 1.   0.59 0.39 0.47]
 [0.43 0.63 0.94 0.37 0.39 0.82 0.29 0.62 1.   0.46 0.57]
 [0.32 0.52 0.95 0.28 0.21 0.67 0.42 0.59 0.61 1.   0.44]
 [0.3  0.42 0.63 0.16 0.2  0.58 0.16 0.43 0.49 0.26 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.82 0.89 0.92 0.89 0.86 0.62 0.8  0.92 0.76 0.86]
 [0.82 1.   0.92 0.77 0.88 0.94 0.78 0.87 0.92 0.84 0.86]
 [0.89 0.92 1.   0.83 0.81 0.94 0.88 0.89 0.94 0.92 0.86]
 [0.92 0.77 0.83 1.   0.8  0.8  0.6  0.78 0.85 0.73 0.8 ]
 [0.89 0.88 0.81 0.8  1.   0.84 0.58 0.78 0.89 0.69 0.83]
 [0.86 0.94 0.94 0.8  0.84 1.   0.78 0.86 0.92 0.82 0.85]
 [0.62 0.78 0.88 0.6  0.58 0.78 1.   0.76 0.76 0.89 0.7 ]
 [0.8  0.87 0.89 0.78 0.78 0.86 0.76 1.   0.86 0.82 0.81]
 [0.92 0.92 0.94 0.85 0.89 0.92 0.76 0.86 1.   0.82 0.88]
 [0.76 0.84 0.92 0.73 0.69 0.82 0.89 0.82 0.82 1.   0.77]
 [0.86 0.86 0.86 0.8  0.83 0.85 0.7  0.81 0.88 0.77 1.  ]]
Collapsing 2 & 5 with crosscontam 0.659769771851852 and sim 0.9404997843779843
Collapsing 2 & 8 with crosscontam 0.5185671630793096 and sim 0.9381236180279295
Collapsing 1 & 5 with crosscontam 0.47972007061728394 and sim 0.9369858946334646
Collapsing 5 & 8 with crosscontam 0.5378398029862324 and sim 0.9248014090560182
Collapsing 0 & 8 with crosscontam 0.43195614270126415 and sim 0.9199334173330015
Collapsing 1 & 8 with crosscontam 0.6347563954613968 and sim 0.9194688194614542
Collapsing 2 & 9 with crosscontam 0.37683534528076446 and sim 0.9190697661839655
Collapsing 1 & 2 with crosscontam 0.39977221333333346 and sim 0.9178053925496545
Collapsing 0 & 3 with crosscontam 0.6560885274074073 and sim 0.9161663094296147
Aborting collapse as 3 & 9 have cross-contam 0.3730609508781547 and sim 0.730073959902233
Collapsing 0 & 4 with crosscontam 0.7210724217283953 and sim 0.892012254251974
Aborting collapse as 4 & 9 have cross-contam 0.3383218884021645 and sim 0.6883318595839909
Collapsing 1 & 4 with crosscontam 0.5495939738271605 and sim 0.8788240885221146
Aborting collapse as 4 & 9 have cross-contam 0.3383218884021645 and sim 0.6883318595839909
Collapsing 1 & 7 with crosscontam 0.5511444734313384 and sim 0.86877806411015
Collapsing 7 & 8 with crosscontam 0.5925839073367274 and sim 0.8578079995211987
Trimming eliminated 0 seqlets out of 878
Trimming eliminated 0 seqlets out of 1069
Trimming eliminated 0 seqlets out of 1816
Trimming eliminated 0 seqlets out of 2669
Removed 1 duplicate seqlets
Trimming eliminated 0 seqlets out of 2792
Trimming eliminated 0 seqlets out of 2986
Unmerged patterns remapping: OrderedDict([(3, 1), (4, 2), (6, 3), (10, 4)])
Time spent on merging iteration: 22.160064220428467
On merging iteration 2
Numbers for each pattern pre-subsample: [2986, 360, 358, 288, 103]
Numbers after subsampling: [300, 300, 300, 288, 103]
Computing sims for pattern 0
Computed sims for pattern 0 in 1.747403860092163 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.4515113830566406 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.44317102432250977 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.43385744094848633 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.1895616054534912 s
Cluster sizes
[2986  360  358  288  103]
Cross-contamination matrix:
[[1.   0.59 0.74 0.6  0.96]
 [0.62 1.   0.47 0.24 0.51]
 [0.86 0.49 1.   0.39 0.81]
 [0.61 0.19 0.26 1.   0.46]
 [0.45 0.16 0.2  0.16 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.86 0.88 0.79 0.91]
 [0.86 1.   0.8  0.6  0.8 ]
 [0.88 0.8  1.   0.58 0.83]
 [0.79 0.6  0.58 1.   0.7 ]
 [0.91 0.8  0.83 0.7  1.  ]]
Collapsing 0 & 4 with crosscontam 0.4470244077431964 and sim 0.9134748299085764
Collapsing 0 & 2 with crosscontam 0.7441117935802468 and sim 0.8828628784188497
Collapsing 0 & 1 with crosscontam 0.5907943046913582 and sim 0.8564525997675407
Trimming eliminated 0 seqlets out of 3089
Trimming eliminated 0 seqlets out of 3447
Trimming eliminated 0 seqlets out of 3807
Unmerged patterns remapping: OrderedDict([(3, 1)])
Time spent on merging iteration: 16.514559745788574
On merging iteration 3
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.4s
[Parallel(n_jobs=24)]: Done 2955 tasks      | elapsed:    2.2s
[Parallel(n_jobs=24)]: Done 3266 out of 3266 | elapsed:    2.4s finished
Numbers for each pattern pre-subsample: [3807, 288]
Numbers after subsampling: [300, 288]
Computing sims for pattern 0
Computed sims for pattern 0 in 0.4344644546508789 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.4285602569580078 s
Cluster sizes
[3807  288]
Cross-contamination matrix:
[[1.   0.66]
 [0.56 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.79]
 [0.79 1.  ]]
Inspecting pattern 2 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 3266
[t-SNE] Computed conditional probabilities for sample 2000 / 3266
[t-SNE] Computed conditional probabilities for sample 3000 / 3266
[t-SNE] Computed conditional probabilities for sample 3266 / 3266
[t-SNE] Mean sigma: 0.302599
Beginning preprocessing + Leiden
2024-03-12 01:58:51.896186 MEMORY 15.717920768
Affmat transformed
2024-03-12 01:58:51.940840 MEMORY 15.717920768
sources, targets, weights extracted
2024-03-12 01:58:51.967911 MEMORY 15.717920768
About to launch parallel Leiden runs
2024-03-12 01:58:51.998742 MEMORY 15.717920768
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:   11.8s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   48.8s finished
Parallel Leiden runs finished
2024-03-12 01:59:40.830926 MEMORY 15.717920768
Quality: 0.5394882132015127
Quality: 0.5398040322115415
Quality: 0.5413155723045318
Got subclusters: Counter({0: 592, 1: 483, 2: 452, 3: 406, 4: 344, 5: 292, 6: 272, 7: 238, 8: 187})
On merging iteration 1
Numbers for each pattern pre-subsample: [592, 483, 452, 406, 344, 292, 272, 238, 187]
Numbers after subsampling: [300, 300, 300, 300, 300, 292, 272, 238, 187]
Computing sims for pattern 0
Computed sims for pattern 0 in 3.4340434074401855 s
Computing sims for pattern 1
Computed sims for pattern 1 in 3.5088114738464355 s
Computing sims for pattern 2
Computed sims for pattern 2 in 3.586806535720825 s
Computing sims for pattern 3
Computed sims for pattern 3 in 3.5646252632141113 s
Computing sims for pattern 4
Computed sims for pattern 4 in 3.5488102436065674 s
Computing sims for pattern 5
Computed sims for pattern 5 in 3.423647403717041 s
Computing sims for pattern 6
Computed sims for pattern 6 in 3.1230947971343994 s
Computing sims for pattern 7
Computed sims for pattern 7 in 3.2973287105560303 s
Computing sims for pattern 8
Computed sims for pattern 8 in 2.5463366508483887 s
Cluster sizes
[592 483 452 406 344 292 272 238 187]
Cross-contamination matrix:
[[1.   0.67 0.53 0.54 0.45 0.49 0.5  0.28 0.46]
 [0.85 1.   0.52 0.66 0.38 0.51 0.48 0.58 0.51]
 [0.8  0.59 1.   0.57 0.49 0.43 0.62 0.37 0.54]
 [0.66 0.59 0.45 1.   0.37 0.48 0.66 0.52 0.56]
 [0.97 0.69 0.75 0.74 1.   0.74 0.81 0.71 0.69]
 [0.83 0.65 0.51 0.69 0.56 1.   0.6  0.53 0.7 ]
 [0.69 0.49 0.56 0.74 0.48 0.47 1.   0.52 0.57]
 [0.51 0.68 0.4  0.69 0.47 0.49 0.62 1.   0.54]
 [0.52 0.4  0.38 0.52 0.29 0.44 0.46 0.35 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.9  0.93 0.77 0.89 0.81 0.84 0.65 0.78]
 [0.9  1.   0.8  0.81 0.77 0.74 0.78 0.77 0.75]
 [0.93 0.8  1.   0.78 0.91 0.78 0.88 0.67 0.81]
 [0.77 0.81 0.78 1.   0.76 0.72 0.87 0.77 0.76]
 [0.89 0.77 0.91 0.76 1.   0.82 0.91 0.75 0.74]
 [0.81 0.74 0.78 0.72 0.82 1.   0.76 0.67 0.76]
 [0.84 0.78 0.88 0.87 0.91 0.76 1.   0.77 0.83]
 [0.65 0.77 0.67 0.77 0.75 0.67 0.77 1.   0.71]
 [0.78 0.75 0.81 0.76 0.74 0.76 0.83 0.71 1.  ]]
Collapsing 0 & 2 with crosscontam 0.5313675762962964 and sim 0.93301337549201
Collapsing 2 & 4 with crosscontam 0.48501303703703713 and sim 0.9067033369552293
Collapsing 4 & 6 with crosscontam 0.48452242787523736 and sim 0.9065906230581973
Collapsing 0 & 1 with crosscontam 0.6713213358024692 and sim 0.897406759363979
Collapsing 2 & 6 with crosscontam 0.5566340470011535 and sim 0.876786921902823
Collapsing 3 & 6 with crosscontam 0.6576638360566449 and sim 0.8701701661747797
Trimming eliminated 0 seqlets out of 1044
Trimming eliminated 0 seqlets out of 1388
Trimming eliminated 0 seqlets out of 1660
Skipped 1 due to duplicates
Trimming eliminated 0 seqlets out of 2142
Trimming eliminated 0 seqlets out of 2548
Unmerged patterns remapping: OrderedDict([(5, 1), (7, 2), (8, 3)])
Time spent on merging iteration: 22.297593116760254
On merging iteration 2
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 2719 out of 2719 | elapsed:    1.7s finished
Numbers for each pattern pre-subsample: [2548, 292, 238, 187]
Numbers after subsampling: [300, 292, 238, 187]
Computing sims for pattern 0
Computed sims for pattern 0 in 1.2529520988464355 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.42101120948791504 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.40477538108825684 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.3080723285675049 s
Cluster sizes
[2548  292  238  187]
Cross-contamination matrix:
[[1.   0.86 0.74 0.87]
 [0.63 1.   0.53 0.7 ]
 [0.47 0.49 1.   0.54]
 [0.4  0.44 0.35 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.83 0.68 0.81]
 [0.83 1.   0.67 0.76]
 [0.68 0.67 1.   0.71]
 [0.81 0.76 0.71 1.  ]]
Inspecting pattern 3 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 2719
[t-SNE] Computed conditional probabilities for sample 2000 / 2719
[t-SNE] Computed conditional probabilities for sample 2719 / 2719
[t-SNE] Mean sigma: 0.314225
Beginning preprocessing + Leiden
2024-03-12 02:00:38.884129 MEMORY 15.717920768
Affmat transformed
2024-03-12 02:00:38.921641 MEMORY 15.717920768
sources, targets, weights extracted
2024-03-12 02:00:38.942813 MEMORY 15.717920768
About to launch parallel Leiden runs
2024-03-12 02:00:38.973043 MEMORY 15.717920768
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:   10.0s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   30.0s finished
Parallel Leiden runs finished
2024-03-12 02:01:09.021243 MEMORY 15.717920768
Quality: 0.5818978519926135
Quality: 0.5841025988609486
Quality: 0.5843426942456384
Got subclusters: Counter({0: 489, 1: 462, 2: 459, 3: 434, 4: 430, 5: 176, 6: 167, 7: 95, 8: 7})
On merging iteration 1
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 2280 tasks      | elapsed:    1.2s
[Parallel(n_jobs=24)]: Done 2524 out of 2524 | elapsed:    1.3s finished
Numbers for each pattern pre-subsample: [489, 462, 459, 434, 430, 176, 167, 95, 7]
Numbers after subsampling: [300, 300, 300, 300, 300, 176, 167, 95, 7]
Computing sims for pattern 0
Computed sims for pattern 0 in 3.176579713821411 s
Computing sims for pattern 1
Computed sims for pattern 1 in 3.270254611968994 s
Computing sims for pattern 2
Computed sims for pattern 2 in 3.262913703918457 s
Computing sims for pattern 3
Computed sims for pattern 3 in 3.2610373497009277 s
Computing sims for pattern 4
Computed sims for pattern 4 in 3.2580208778381348 s
Computing sims for pattern 5
Computed sims for pattern 5 in 2.1322882175445557 s
Computing sims for pattern 6
Computed sims for pattern 6 in 2.0138368606567383 s
Computing sims for pattern 7
Computed sims for pattern 7 in 1.491952657699585 s
Computing sims for pattern 8
Computed sims for pattern 8 in 0.4100637435913086 s
Cluster sizes
[489 462 459 434 430 176 167  95   7]
Cross-contamination matrix:
[[1.   0.36 0.53 0.33 0.64 0.72 0.36 0.53 0.19]
 [0.2  1.   0.18 0.61 0.58 0.61 0.58 0.47 0.22]
 [0.58 0.35 1.   0.5  0.55 0.74 0.3  0.55 0.1 ]
 [0.33 0.44 0.41 1.   0.49 0.72 0.58 0.59 0.09]
 [0.6  0.43 0.52 0.47 1.   0.48 0.71 0.53 0.17]
 [0.71 0.48 0.65 0.73 0.5  1.   0.47 0.6  0.17]
 [0.31 0.41 0.27 0.51 0.68 0.43 1.   0.46 0.1 ]
 [0.35 0.4  0.34 0.59 0.28 0.65 0.54 1.   0.11]
 [0.26 0.2  0.14 0.15 0.23 0.21 0.18 0.15 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.64 0.81 0.48 0.83 0.81 0.61 0.71 0.64]
 [0.64 1.   0.59 0.73 0.63 0.73 0.64 0.53 0.37]
 [0.81 0.59 1.   0.61 0.84 0.8  0.59 0.72 0.5 ]
 [0.48 0.73 0.61 1.   0.64 0.82 0.71 0.72 0.27]
 [0.83 0.63 0.84 0.64 1.   0.7  0.81 0.7  0.5 ]
 [0.81 0.73 0.8  0.82 0.7  1.   0.59 0.79 0.52]
 [0.61 0.64 0.59 0.71 0.81 0.59 1.   0.61 0.45]
 [0.71 0.53 0.72 0.72 0.7  0.79 0.61 1.   0.44]
 [0.64 0.37 0.5  0.27 0.5  0.52 0.45 0.44 1.  ]]
Inspecting pattern 4 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 2524
[t-SNE] Computed conditional probabilities for sample 2000 / 2524
[t-SNE] Computed conditional probabilities for sample 2524 / 2524
[t-SNE] Mean sigma: 0.266404
Beginning preprocessing + Leiden
2024-03-12 02:01:36.373623 MEMORY 15.717920768
Affmat transformed
2024-03-12 02:01:36.406113 MEMORY 15.717920768
sources, targets, weights extracted
2024-03-12 02:01:36.427400 MEMORY 15.717920768
About to launch parallel Leiden runs
2024-03-12 02:01:36.463467 MEMORY 15.717920768
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    9.3s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   31.3s finished
Parallel Leiden runs finished
2024-03-12 02:02:07.801328 MEMORY 15.717920768
Quality: 0.5472096694477416
Quality: 0.5475878981547299
Quality: 0.5480793912622847
Quality: 0.5481339925772828
Quality: 0.5481807361105993
Quality: 0.5482656553897293
Got subclusters: Counter({0: 607, 1: 462, 2: 416, 3: 288, 4: 276, 5: 198, 6: 159, 7: 74, 8: 35, 9: 9})
On merging iteration 1
Numbers for each pattern pre-subsample: [607, 462, 416, 288, 276, 198, 159, 74, 35, 9]
Numbers after subsampling: [300, 300, 300, 288, 276, 198, 159, 74, 35, 9]
Computing sims for pattern 0
Computed sims for pattern 0 in 3.3742034435272217 s
Computing sims for pattern 1
Computed sims for pattern 1 in 3.4162964820861816 s
Computing sims for pattern 2
Computed sims for pattern 2 in 3.522109031677246 s
Computing sims for pattern 3
Computed sims for pattern 3 in 3.3901188373565674 s
Computing sims for pattern 4
Computed sims for pattern 4 in 3.1693010330200195 s
Computing sims for pattern 5
Computed sims for pattern 5 in 2.671114683151245 s
Computing sims for pattern 6
Computed sims for pattern 6 in 2.0677592754364014 s
Computing sims for pattern 7
Computed sims for pattern 7 in 1.2903656959533691 s
Computing sims for pattern 8
Computed sims for pattern 8 in 0.7542243003845215 s
Computing sims for pattern 9
Computed sims for pattern 9 in 0.4449448585510254 s
Cluster sizes
[607 462 416 288 276 198 159  74  35   9]
Cross-contamination matrix:
[[1.   0.78 0.57 0.64 0.65 0.5  0.54 0.42 0.7  0.15]
 [0.66 1.   0.54 0.58 0.63 0.36 0.47 0.32 0.63 0.09]
 [0.75 0.85 1.   0.65 0.83 0.53 0.63 0.54 0.63 0.14]
 [0.63 0.69 0.48 1.   0.64 0.43 0.51 0.34 0.6  0.18]
 [0.55 0.65 0.52 0.55 1.   0.37 0.51 0.34 0.44 0.05]
 [0.84 0.79 0.68 0.75 0.79 1.   0.77 0.7  0.77 0.27]
 [0.59 0.64 0.48 0.55 0.69 0.46 1.   0.42 0.45 0.06]
 [0.59 0.59 0.55 0.49 0.61 0.55 0.58 1.   0.5  0.08]
 [0.45 0.51 0.26 0.38 0.31 0.26 0.22 0.17 1.   0.03]
 [0.44 0.44 0.33 0.54 0.31 0.4  0.31 0.29 0.37 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.93 0.92 0.87 0.93 0.93 0.91 0.87 0.9  0.56]
 [0.93 1.   0.93 0.88 0.93 0.91 0.92 0.86 0.9  0.67]
 [0.92 0.93 1.   0.85 0.93 0.9  0.89 0.86 0.86 0.52]
 [0.87 0.88 0.85 1.   0.88 0.85 0.86 0.81 0.84 0.69]
 [0.93 0.93 0.93 0.88 1.   0.88 0.89 0.85 0.88 0.51]
 [0.93 0.91 0.9  0.85 0.88 1.   0.88 0.88 0.84 0.63]
 [0.91 0.92 0.89 0.86 0.89 0.88 1.   0.85 0.87 0.6 ]
 [0.87 0.86 0.86 0.81 0.85 0.88 0.85 1.   0.83 0.57]
 [0.9  0.9  0.86 0.84 0.88 0.84 0.87 0.83 1.   0.6 ]
 [0.56 0.67 0.52 0.69 0.51 0.63 0.6  0.57 0.6  1.  ]]
Collapsing 2 & 4 with crosscontam 0.5245751587729204 and sim 0.9327896789306325
Collapsing 0 & 5 with crosscontam 0.5022182416760195 and sim 0.9327073865258829
Collapsing 1 & 4 with crosscontam 0.6285091400966183 and sim 0.9312386514482828
Collapsing 1 & 2 with crosscontam 0.5445782360493825 and sim 0.9287445782062241
Collapsing 0 & 1 with crosscontam 0.6620764745679013 and sim 0.9275936726632129
Collapsing 0 & 4 with crosscontam 0.5467513941779374 and sim 0.9263256983697867
Collapsing 0 & 2 with crosscontam 0.5665904691358026 and sim 0.9229718028612784
Collapsing 1 & 6 with crosscontam 0.46865268856277664 and sim 0.9172606517140134
Collapsing 1 & 5 with crosscontam 0.36410241526374865 and sim 0.913446906565419
Collapsing 0 & 6 with crosscontam 0.5408497069648266 and sim 0.9129611351331272
Collapsing 2 & 5 with crosscontam 0.527581466517022 and sim 0.9025558794961089
Collapsing 1 & 8 with crosscontam 0.5092095626822155 and sim 0.8971724351024946
Collapsing 4 & 6 with crosscontam 0.510531162802256 and sim 0.8932785418289937
Collapsing 5 & 7 with crosscontam 0.5492775463557056 and sim 0.8846685771965475
Collapsing 3 & 4 with crosscontam 0.5517282270837074 and sim 0.8789337944171762
Collapsing 1 & 3 with crosscontam 0.5804102901234569 and sim 0.8782477490823916
Collapsing 0 & 3 with crosscontam 0.6279710384695074 and sim 0.8706386502356467
Collapsing 2 & 7 with crosscontam 0.5428376616616617 and sim 0.8611961932136247
Collapsing 3 & 6 with crosscontam 0.5091759391701931 and sim 0.8567634415999169
Trimming eliminated 0 seqlets out of 692
Trimming eliminated 0 seqlets out of 805
Trimming eliminated 0 seqlets out of 1154
Trimming eliminated 0 seqlets out of 1959
Trimming eliminated 0 seqlets out of 2118
Trimming eliminated 0 seqlets out of 2153
Trimming eliminated 0 seqlets out of 2227
Trimming eliminated 0 seqlets out of 2515
Unmerged patterns remapping: OrderedDict([(9, 1)])
Time spent on merging iteration: 19.469667434692383
On merging iteration 2
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 693 out of 693 | elapsed:    0.4s finished
Numbers for each pattern pre-subsample: [2515, 9]
Numbers after subsampling: [300, 9]
Computing sims for pattern 0
Computed sims for pattern 0 in 0.3054385185241699 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.06616425514221191 s
Cluster sizes
[2515    9]
Cross-contamination matrix:
[[1.   0.26]
 [0.4  1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.62]
 [0.62 1.  ]]
Inspecting pattern 5 for spurious merging
[t-SNE] Computed conditional probabilities for sample 693 / 693
[t-SNE] Mean sigma: 0.266247
Beginning preprocessing + Leiden
2024-03-12 02:02:53.352220 MEMORY 15.717920768
Affmat transformed
2024-03-12 02:02:53.362534 MEMORY 15.717920768
sources, targets, weights extracted
2024-03-12 02:02:53.369692 MEMORY 15.717920768
About to launch parallel Leiden runs
2024-03-12 02:02:53.387258 MEMORY 15.717920768
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    2.3s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    6.5s finished
Parallel Leiden runs finished
2024-03-12 02:02:59.920052 MEMORY 15.717920768
Quality: 0.4669269775516463
Got subclusters: Counter({0: 141, 1: 137, 2: 107, 3: 103, 4: 93, 5: 70, 6: 36, 7: 6})
On merging iteration 1
Numbers for each pattern pre-subsample: [141, 137, 107, 103, 93, 70, 36, 6]
Numbers after subsampling: [141, 137, 107, 103, 93, 70, 36, 6]
Computing sims for pattern 0
Computed sims for pattern 0 in 1.2512826919555664 s
Computing sims for pattern 1
Computed sims for pattern 1 in 1.2677829265594482 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.9290063381195068 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.9006197452545166 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.9620893001556396 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.7478039264678955 s
Computing sims for pattern 6
Computed sims for pattern 6 in 0.436173677444458 s
Computing sims for pattern 7
Computed sims for pattern 7 in 0.18447136878967285 s
Cluster sizes
[141 137 107 103  93  70  36   6]
Cross-contamination matrix:
[[1.   0.85 0.27 0.29 0.45 0.27 0.27 0.11]
 [0.72 1.   0.22 0.22 0.35 0.24 0.35 0.08]
 [0.96 1.   1.   0.68 0.92 0.67 0.62 0.59]
 [0.88 0.89 0.49 1.   0.9  0.55 0.5  0.46]
 [1.   1.   0.51 0.62 1.   0.56 0.53 0.31]
 [0.9  0.98 0.52 0.7  0.96 1.   0.68 0.51]
 [0.98 1.   0.64 0.71 0.93 0.85 1.   0.6 ]
 [0.02 0.03 0.02 0.05 0.03 0.03 0.02 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.98 0.84 0.86 0.94 0.85 0.82 0.6 ]
 [0.98 1.   0.81 0.82 0.9  0.85 0.83 0.62]
 [0.84 0.81 1.   0.76 0.86 0.77 0.71 0.59]
 [0.86 0.82 0.76 1.   0.89 0.8  0.72 0.58]
 [0.94 0.9  0.86 0.89 1.   0.89 0.81 0.61]
 [0.85 0.85 0.77 0.8  0.89 1.   0.85 0.61]
 [0.82 0.83 0.71 0.72 0.81 0.85 1.   0.68]
 [0.6  0.62 0.59 0.58 0.61 0.61 0.68 1.  ]]
Collapsing 0 & 1 with crosscontam 0.7198773155748981 and sim 0.9781394258279518
Collapsing 0 & 4 with crosscontam 0.4463277771711407 and sim 0.9396926836246912
Collapsing 1 & 4 with crosscontam 0.3540618917460503 and sim 0.9037649176459079
Collapsing 4 & 5 with crosscontam 0.5638049487265693 and sim 0.8928170618175723
Collapsing 3 & 4 with crosscontam 0.622264873428237 and sim 0.887410626677366
Collapsing 2 & 4 with crosscontam 0.5054756048887439 and sim 0.8640610658619357
Trimming eliminated 0 seqlets out of 278
Trimming eliminated 0 seqlets out of 371
Trimming eliminated 0 seqlets out of 441
Trimming eliminated 0 seqlets out of 544
Trimming eliminated 0 seqlets out of 651
Unmerged patterns remapping: OrderedDict([(6, 1), (7, 2)])
Time spent on merging iteration: 4.059236526489258
On merging iteration 2
Numbers for each pattern pre-subsample: [651, 36, 6]
Numbers after subsampling: [300, 36, 6]
Computing sims for pattern 0
Computed sims for pattern 0 in 0.6171998977661133 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.11044883728027344 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.06525397300720215 s
Cluster sizes
[651  36   6]
Cross-contamination matrix:
[[1.   0.78 0.58]
 [0.86 1.   0.6 ]
 [0.02 0.02 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.87 0.66]
 [0.87 1.   0.68]
 [0.66 0.68 1.  ]]
Collapsing 0 & 1 with crosscontam 0.7781149465020576 and sim 0.8662171801831098
Trimming eliminated 0 seqlets out of 687
Unmerged patterns remapping: OrderedDict([(2, 1)])
Time spent on merging iteration: 1.0908334255218506
On merging iteration 3
Numbers for each pattern pre-subsample: [687, 6]
Numbers after subsampling: [300, 6]
Computing sims for pattern 0
Computed sims for pattern 0 in 0.30301356315612793 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.06870317459106445 s
Cluster sizes
[687   6]
Cross-contamination matrix:
[[1.   0.57]
 [0.02 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.66]
 [0.66 1.  ]]
Merging on 22 clusters
2024-03-12 02:03:12.924243 MEMORY 15.717920768
On merging iteration 1
Numbers for each pattern pre-subsample: [4868, 154, 119, 3807, 288, 2548, 292, 238, 187, 489, 462, 459, 434, 430, 176, 167, 95, 7, 2515, 9, 687, 6]
Numbers after subsampling: [300, 154, 119, 300, 288, 300, 292, 238, 187, 300, 300, 300, 300, 300, 176, 167, 95, 7, 300, 9, 300, 6]
Computing sims for pattern 0
Computed sims for pattern 0 in 8.649402856826782 s
Computing sims for pattern 1
Computed sims for pattern 1 in 5.1627724170684814 s
Computing sims for pattern 2
Computed sims for pattern 2 in 4.195850610733032 s
Computing sims for pattern 3
Computed sims for pattern 3 in 8.7800612449646 s
Computing sims for pattern 4
Computed sims for pattern 4 in 10.947047233581543 s
Computing sims for pattern 5
Computed sims for pattern 5 in 8.970394134521484 s
Computing sims for pattern 6
Computed sims for pattern 6 in 8.571550130844116 s
Computing sims for pattern 7
Computed sims for pattern 7 in 8.245251417160034 s
Computing sims for pattern 8
Computed sims for pattern 8 in 6.0590996742248535 s
Computing sims for pattern 9
Computed sims for pattern 9 in 8.530033349990845 s
Computing sims for pattern 10
Computed sims for pattern 10 in 8.54254674911499 s
Computing sims for pattern 11
Computed sims for pattern 11 in 8.635233402252197 s
Computing sims for pattern 12
Computed sims for pattern 12 in 8.566778659820557 s
Computing sims for pattern 13
Computed sims for pattern 13 in 8.57663106918335 s
Computing sims for pattern 14
Computed sims for pattern 14 in 5.5726258754730225 s
Computing sims for pattern 15
Computed sims for pattern 15 in 7.980661630630493 s
Computing sims for pattern 16
Computed sims for pattern 16 in 3.7807555198669434 s
Computing sims for pattern 17
Computed sims for pattern 17 in 0.9858970642089844 s
Computing sims for pattern 18
Computed sims for pattern 18 in 8.599706888198853 s
Computing sims for pattern 19
Computed sims for pattern 19 in 1.1369118690490723 s
Computing sims for pattern 20
Computed sims for pattern 20 in 8.51613450050354 s
Computing sims for pattern 21
Computed sims for pattern 21 in 0.9983334541320801 s
Cluster sizes
[4868  154  119 3807  288 2548  292  238  187  489  462  459  434  430
  176  167   95    7 2515    9  687    6]
Cross-contamination matrix:
[[1.   0.62 0.4  0.68 0.93 0.05 0.27 0.07 0.3  0.04 0.43 0.06 0.12 0.05
  0.07 0.12 0.01 0.11 0.95 0.21 0.09 0.09]
 [0.65 1.   0.3  0.38 0.57 0.02 0.09 0.01 0.17 0.01 0.31 0.03 0.09 0.03
  0.03 0.04 0.01 0.06 0.53 0.42 0.03 0.04]
 [0.37 0.29 1.   0.17 0.27 0.09 0.14 0.07 0.06 0.05 0.06 0.08 0.03 0.07
  0.01 0.15 0.02 0.23 0.2  0.13 0.14 0.08]
 [0.53 0.28 0.14 1.   0.66 0.04 0.21 0.09 0.33 0.04 0.23 0.01 0.08 0.08
  0.01 0.06 0.01 0.02 0.6  0.15 0.04 0.1 ]
 [0.65 0.29 0.12 0.56 1.   0.01 0.09 0.01 0.1  0.   0.25 0.01 0.03 0.02
  0.02 0.02 0.02 0.01 0.69 0.05 0.01 0.  ]
 [0.14 0.12 0.31 0.27 0.11 1.   0.86 0.74 0.87 0.71 0.23 0.51 0.33 0.55
  0.34 0.58 0.45 0.3  0.14 0.06 0.65 0.52]
 [0.36 0.15 0.26 0.33 0.29 0.63 1.   0.53 0.7  0.35 0.34 0.26 0.28 0.47
  0.18 0.51 0.18 0.25 0.3  0.13 0.12 0.19]
 [0.09 0.03 0.12 0.17 0.06 0.47 0.49 1.   0.54 0.42 0.23 0.28 0.29 0.36
  0.16 0.3  0.37 0.06 0.12 0.03 0.26 0.08]
 [0.14 0.13 0.06 0.26 0.1  0.4  0.44 0.35 1.   0.18 0.09 0.1  0.15 0.31
  0.08 0.2  0.09 0.02 0.13 0.04 0.11 0.23]
 [0.03 0.01 0.06 0.05 0.02 0.35 0.27 0.33 0.25 1.   0.36 0.53 0.33 0.64
  0.72 0.36 0.53 0.19 0.02 0.02 0.25 0.3 ]
 [0.57 0.44 0.12 0.43 0.6  0.1  0.37 0.08 0.07 0.2  1.   0.18 0.61 0.58
  0.61 0.58 0.47 0.22 0.53 0.12 0.17 0.22]
 [0.05 0.06 0.1  0.02 0.07 0.27 0.21 0.28 0.13 0.58 0.35 1.   0.5  0.55
  0.74 0.3  0.55 0.1  0.04 0.08 0.29 0.4 ]
 [0.11 0.12 0.04 0.09 0.11 0.13 0.22 0.23 0.21 0.33 0.44 0.41 1.   0.49
  0.72 0.58 0.59 0.09 0.15 0.07 0.22 0.37]
 [0.05 0.05 0.09 0.1  0.06 0.26 0.34 0.27 0.4  0.6  0.43 0.52 0.47 1.
  0.48 0.71 0.53 0.17 0.08 0.03 0.42 0.46]
 [0.07 0.05 0.03 0.03 0.08 0.15 0.13 0.18 0.14 0.71 0.48 0.65 0.73 0.5
  1.   0.47 0.6  0.17 0.05 0.06 0.17 0.31]
 [0.1  0.07 0.16 0.08 0.06 0.25 0.34 0.2  0.25 0.31 0.41 0.27 0.51 0.68
  0.43 1.   0.46 0.1  0.13 0.04 0.66 0.65]
 [0.01 0.02 0.05 0.01 0.08 0.18 0.16 0.35 0.15 0.35 0.4  0.34 0.59 0.28
  0.65 0.54 1.   0.11 0.01 0.02 0.28 0.61]
 [0.19 0.19 0.31 0.04 0.14 0.17 0.26 0.1  0.08 0.26 0.2  0.14 0.15 0.23
  0.21 0.18 0.15 1.   0.08 0.23 0.22 0.35]
 [0.75 0.35 0.13 0.57 0.75 0.02 0.14 0.05 0.18 0.01 0.26 0.02 0.04 0.04
  0.02 0.07 0.   0.02 1.   0.26 0.02 0.  ]
 [0.21 0.4  0.14 0.21 0.18 0.01 0.1  0.03 0.05 0.01 0.1  0.04 0.08 0.04
  0.03 0.05 0.02 0.12 0.4  1.   0.03 0.  ]
 [0.06 0.04 0.13 0.04 0.04 0.21 0.12 0.14 0.11 0.17 0.12 0.19 0.19 0.29
  0.1  0.42 0.13 0.11 0.04 0.03 1.   0.57]
 [0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.
  0.   0.01 0.   0.   0.   0.   0.02 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.83 0.63 0.79 0.96 0.3  0.54 0.35 0.44 0.26 0.75 0.21 0.39 0.21
  0.25 0.3  0.15 0.43 0.95 0.53 0.26 0.18]
 [0.83 1.   0.72 0.59 0.84 0.15 0.42 0.17 0.32 0.15 0.72 0.22 0.5  0.17
  0.28 0.33 0.26 0.34 0.78 0.67 0.11 0.17]
 [0.63 0.72 1.   0.53 0.57 0.46 0.62 0.34 0.35 0.32 0.43 0.29 0.28 0.31
  0.27 0.4  0.27 0.58 0.58 0.56 0.4  0.32]
 [0.79 0.59 0.53 1.   0.79 0.34 0.49 0.5  0.64 0.27 0.6  0.19 0.31 0.29
  0.17 0.26 0.15 0.37 0.8  0.44 0.22 0.23]
 [0.96 0.84 0.57 0.79 1.   0.23 0.47 0.28 0.36 0.21 0.79 0.24 0.45 0.21
  0.29 0.29 0.13 0.37 0.93 0.52 0.18 0.14]
 [0.3  0.15 0.46 0.34 0.23 1.   0.83 0.68 0.81 0.72 0.37 0.63 0.26 0.63
  0.51 0.57 0.54 0.57 0.3  0.01 0.56 0.46]
 [0.54 0.42 0.62 0.49 0.47 0.83 1.   0.67 0.76 0.64 0.45 0.62 0.43 0.51
  0.46 0.62 0.5  0.41 0.5  0.38 0.32 0.3 ]
 [0.35 0.17 0.34 0.5  0.28 0.68 0.67 1.   0.71 0.59 0.37 0.51 0.42 0.66
  0.42 0.47 0.44 0.49 0.41 0.16 0.37 0.34]
 [0.44 0.32 0.35 0.64 0.36 0.81 0.76 0.71 1.   0.56 0.3  0.44 0.33 0.57
  0.39 0.44 0.33 0.38 0.46 0.16 0.36 0.42]
 [0.26 0.15 0.32 0.27 0.21 0.72 0.64 0.59 0.56 1.   0.64 0.81 0.48 0.83
  0.81 0.61 0.71 0.64 0.26 0.08 0.49 0.49]
 [0.75 0.72 0.43 0.6  0.79 0.37 0.45 0.37 0.3  0.64 1.   0.59 0.73 0.63
  0.73 0.64 0.53 0.37 0.72 0.46 0.33 0.26]
 [0.21 0.22 0.29 0.19 0.24 0.63 0.62 0.51 0.44 0.81 0.59 1.   0.61 0.84
  0.8  0.59 0.72 0.5  0.21 0.2  0.44 0.46]
 [0.39 0.5  0.28 0.31 0.45 0.26 0.43 0.42 0.33 0.48 0.73 0.61 1.   0.64
  0.82 0.71 0.72 0.27 0.35 0.37 0.45 0.48]
 [0.21 0.17 0.31 0.29 0.21 0.63 0.51 0.66 0.57 0.83 0.63 0.84 0.64 1.
  0.7  0.81 0.7  0.5  0.29 0.18 0.57 0.53]
 [0.25 0.28 0.27 0.17 0.29 0.51 0.46 0.42 0.39 0.81 0.73 0.8  0.82 0.7
  1.   0.59 0.79 0.52 0.21 0.22 0.41 0.49]
 [0.3  0.33 0.4  0.26 0.29 0.57 0.62 0.47 0.44 0.61 0.64 0.59 0.71 0.81
  0.59 1.   0.61 0.45 0.34 0.31 0.7  0.58]
 [0.15 0.26 0.27 0.15 0.13 0.54 0.5  0.44 0.33 0.71 0.53 0.72 0.72 0.7
  0.79 0.61 1.   0.44 0.17 0.16 0.47 0.55]
 [0.43 0.34 0.58 0.37 0.37 0.57 0.41 0.49 0.38 0.64 0.37 0.5  0.27 0.5
  0.52 0.45 0.44 1.   0.33 0.4  0.46 0.52]
 [0.95 0.78 0.58 0.8  0.93 0.3  0.5  0.41 0.46 0.26 0.72 0.21 0.35 0.29
  0.21 0.34 0.17 0.33 1.   0.62 0.21 0.17]
 [0.53 0.67 0.56 0.44 0.52 0.01 0.38 0.16 0.16 0.08 0.46 0.2  0.37 0.18
  0.22 0.31 0.16 0.4  0.62 1.   0.01 0.07]
 [0.26 0.11 0.4  0.22 0.18 0.56 0.32 0.37 0.36 0.49 0.33 0.44 0.45 0.57
  0.41 0.7  0.47 0.46 0.21 0.01 1.   0.66]
 [0.18 0.17 0.32 0.23 0.14 0.46 0.3  0.34 0.42 0.49 0.26 0.46 0.48 0.53
  0.49 0.58 0.55 0.52 0.17 0.07 0.66 1.  ]]
Collapsing 0 & 4 with crosscontam 0.6543811889146092 and sim 0.9579513517325263
Collapsing 0 & 18 with crosscontam 0.7461997259259259 and sim 0.9532742488753735
Collapsing 4 & 18 with crosscontam 0.6868875162537149 and sim 0.9310143638989706
Trimming eliminated 0 seqlets out of 5156
Skipped 2 due to duplicates
Trimming eliminated 0 seqlets out of 7669
Unmerged patterns remapping: OrderedDict([(1, 14), (2, 15), (3, 1), (5, 2), (6, 9), (7, 10), (8, 11), (9, 4), (10, 5), (11, 6), (12, 7), (13, 8), (14, 12), (15, 13), (16, 16), (17, 18), (19, 17), (20, 3), (21, 19)])
Time spent on merging iteration: 27.28862452507019
On merging iteration 2
Numbers for each pattern pre-subsample: [7669, 3807, 2548, 687, 489, 462, 459, 434, 430, 292, 238, 187, 176, 167, 154, 119, 95, 9, 7, 6]
Numbers after subsampling: [300, 300, 300, 300, 300, 300, 300, 300, 300, 292, 238, 187, 176, 167, 154, 119, 95, 9, 7, 6]
Computing sims for pattern 0
Computed sims for pattern 0 in 7.603275299072266 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.44713544845581055 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.4592580795288086 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.46723318099975586 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.4484860897064209 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.4491691589355469 s
Computing sims for pattern 6
Computed sims for pattern 6 in 0.44696807861328125 s
Computing sims for pattern 7
Computed sims for pattern 7 in 0.4444310665130615 s
Computing sims for pattern 8
Computed sims for pattern 8 in 0.4498896598815918 s
Computing sims for pattern 9
Computed sims for pattern 9 in 0.4262709617614746 s
Computing sims for pattern 10
Computed sims for pattern 10 in 0.40168023109436035 s
Computing sims for pattern 11
Computed sims for pattern 11 in 0.31105947494506836 s
Computing sims for pattern 12
Computed sims for pattern 12 in 0.30782079696655273 s
Computing sims for pattern 13
Computed sims for pattern 13 in 0.27230119705200195 s
Computing sims for pattern 14
Computed sims for pattern 14 in 0.24935650825500488 s
Computing sims for pattern 15
Computed sims for pattern 15 in 0.21393990516662598 s
Computing sims for pattern 16
Computed sims for pattern 16 in 0.2050473690032959 s
Computing sims for pattern 17
Computed sims for pattern 17 in 0.06774568557739258 s
Computing sims for pattern 18
Computed sims for pattern 18 in 0.06202816963195801 s
Computing sims for pattern 19
Computed sims for pattern 19 in 0.059900760650634766 s
Cluster sizes
[7669 3807 2548  687  489  462  459  434  430  292  238  187  176  167
  154  119   95    9    7    6]
Cross-contamination matrix:
[[1.   0.73 0.05 0.08 0.04 0.44 0.06 0.11 0.07 0.27 0.08 0.31 0.07 0.13
  0.6  0.38 0.02 0.27 0.09 0.02]
 [0.55 1.   0.04 0.04 0.04 0.23 0.01 0.08 0.08 0.21 0.09 0.33 0.01 0.06
  0.28 0.14 0.01 0.15 0.02 0.1 ]
 [0.14 0.27 1.   0.65 0.71 0.23 0.51 0.33 0.55 0.86 0.74 0.87 0.34 0.58
  0.12 0.31 0.45 0.06 0.3  0.52]
 [0.05 0.04 0.21 1.   0.17 0.12 0.19 0.19 0.29 0.12 0.14 0.11 0.1  0.42
  0.04 0.13 0.13 0.03 0.11 0.57]
 [0.03 0.05 0.35 0.25 1.   0.36 0.53 0.33 0.64 0.27 0.33 0.25 0.72 0.36
  0.01 0.06 0.53 0.02 0.19 0.3 ]
 [0.56 0.43 0.1  0.17 0.2  1.   0.18 0.61 0.58 0.37 0.08 0.07 0.61 0.58
  0.44 0.12 0.47 0.12 0.22 0.22]
 [0.05 0.02 0.27 0.29 0.58 0.35 1.   0.5  0.55 0.21 0.28 0.13 0.74 0.3
  0.06 0.1  0.55 0.08 0.1  0.4 ]
 [0.1  0.09 0.13 0.22 0.33 0.44 0.41 1.   0.49 0.22 0.23 0.21 0.72 0.58
  0.12 0.04 0.59 0.07 0.09 0.37]
 [0.06 0.1  0.26 0.42 0.6  0.43 0.52 0.47 1.   0.34 0.27 0.4  0.48 0.71
  0.05 0.09 0.53 0.03 0.17 0.46]
 [0.35 0.33 0.63 0.12 0.35 0.34 0.26 0.28 0.47 1.   0.53 0.7  0.18 0.51
  0.15 0.26 0.18 0.13 0.25 0.19]
 [0.1  0.17 0.47 0.26 0.42 0.23 0.28 0.29 0.36 0.49 1.   0.54 0.16 0.3
  0.03 0.12 0.37 0.03 0.06 0.08]
 [0.14 0.26 0.4  0.11 0.18 0.09 0.1  0.15 0.31 0.44 0.35 1.   0.08 0.2
  0.13 0.06 0.09 0.04 0.02 0.23]
 [0.07 0.03 0.15 0.17 0.71 0.48 0.65 0.73 0.5  0.13 0.18 0.14 1.   0.47
  0.05 0.03 0.6  0.06 0.17 0.31]
 [0.11 0.08 0.25 0.66 0.31 0.41 0.27 0.51 0.68 0.34 0.2  0.25 0.43 1.
  0.07 0.16 0.46 0.04 0.1  0.65]
 [0.58 0.38 0.02 0.03 0.01 0.31 0.03 0.09 0.03 0.09 0.01 0.17 0.03 0.04
  1.   0.3  0.01 0.42 0.06 0.04]
 [0.33 0.17 0.09 0.14 0.05 0.06 0.08 0.03 0.07 0.14 0.07 0.06 0.01 0.15
  0.29 1.   0.02 0.13 0.23 0.08]
 [0.01 0.01 0.18 0.28 0.35 0.4  0.34 0.59 0.28 0.16 0.35 0.15 0.65 0.54
  0.02 0.05 1.   0.02 0.11 0.61]
 [0.26 0.21 0.01 0.03 0.01 0.1  0.04 0.08 0.04 0.1  0.03 0.05 0.03 0.05
  0.4  0.14 0.02 1.   0.12 0.  ]
 [0.16 0.04 0.17 0.22 0.26 0.2  0.14 0.15 0.23 0.26 0.1  0.08 0.21 0.18
  0.19 0.31 0.15 0.23 1.   0.35]
 [0.   0.   0.   0.02 0.   0.   0.   0.   0.   0.   0.   0.   0.   0.01
  0.   0.   0.   0.   0.   1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.8  0.3  0.24 0.26 0.75 0.21 0.38 0.23 0.53 0.37 0.45 0.24 0.31
  0.83 0.61 0.15 0.56 0.39 0.17]
 [0.8  1.   0.34 0.22 0.27 0.6  0.19 0.31 0.29 0.49 0.5  0.64 0.17 0.26
  0.59 0.53 0.15 0.44 0.37 0.23]
 [0.3  0.34 1.   0.56 0.72 0.37 0.63 0.26 0.63 0.83 0.68 0.81 0.51 0.57
  0.15 0.46 0.54 0.01 0.57 0.46]
 [0.24 0.22 0.56 1.   0.49 0.33 0.44 0.45 0.57 0.32 0.37 0.36 0.41 0.7
  0.11 0.4  0.47 0.01 0.46 0.66]
 [0.26 0.27 0.72 0.49 1.   0.64 0.81 0.48 0.83 0.64 0.59 0.56 0.81 0.61
  0.15 0.32 0.71 0.08 0.64 0.49]
 [0.75 0.6  0.37 0.33 0.64 1.   0.59 0.73 0.63 0.45 0.37 0.3  0.73 0.64
  0.72 0.43 0.53 0.46 0.37 0.26]
 [0.21 0.19 0.63 0.44 0.81 0.59 1.   0.61 0.84 0.62 0.51 0.44 0.8  0.59
  0.22 0.29 0.72 0.2  0.5  0.46]
 [0.38 0.31 0.26 0.45 0.48 0.73 0.61 1.   0.64 0.43 0.42 0.33 0.82 0.71
  0.5  0.28 0.72 0.37 0.27 0.48]
 [0.23 0.29 0.63 0.57 0.83 0.63 0.84 0.64 1.   0.51 0.66 0.57 0.7  0.81
  0.17 0.31 0.7  0.18 0.5  0.53]
 [0.53 0.49 0.83 0.32 0.64 0.45 0.62 0.43 0.51 1.   0.67 0.76 0.46 0.62
  0.42 0.62 0.5  0.38 0.41 0.3 ]
 [0.37 0.5  0.68 0.37 0.59 0.37 0.51 0.42 0.66 0.67 1.   0.71 0.42 0.47
  0.17 0.34 0.44 0.16 0.49 0.34]
 [0.45 0.64 0.81 0.36 0.56 0.3  0.44 0.33 0.57 0.76 0.71 1.   0.39 0.44
  0.32 0.35 0.33 0.16 0.38 0.42]
 [0.24 0.17 0.51 0.41 0.81 0.73 0.8  0.82 0.7  0.46 0.42 0.39 1.   0.59
  0.28 0.27 0.79 0.22 0.52 0.49]
 [0.31 0.26 0.57 0.7  0.61 0.64 0.59 0.71 0.81 0.62 0.47 0.44 0.59 1.
  0.33 0.4  0.61 0.31 0.45 0.58]
 [0.83 0.59 0.15 0.11 0.15 0.72 0.22 0.5  0.17 0.42 0.17 0.32 0.28 0.33
  1.   0.72 0.26 0.67 0.34 0.17]
 [0.61 0.53 0.46 0.4  0.32 0.43 0.29 0.28 0.31 0.62 0.34 0.35 0.27 0.4
  0.72 1.   0.27 0.56 0.58 0.32]
 [0.15 0.15 0.54 0.47 0.71 0.53 0.72 0.72 0.7  0.5  0.44 0.33 0.79 0.61
  0.26 0.27 1.   0.16 0.44 0.55]
 [0.56 0.44 0.01 0.01 0.08 0.46 0.2  0.37 0.18 0.38 0.16 0.16 0.22 0.31
  0.67 0.56 0.16 1.   0.4  0.07]
 [0.39 0.37 0.57 0.46 0.64 0.37 0.5  0.27 0.5  0.41 0.49 0.38 0.52 0.45
  0.34 0.58 0.44 0.4  1.   0.52]
 [0.17 0.23 0.46 0.66 0.49 0.26 0.46 0.48 0.53 0.3  0.34 0.42 0.49 0.58
  0.17 0.32 0.55 0.07 0.52 1.  ]]
Got 20 patterns after merging
2024-03-12 02:06:26.285518 MEMORY 15.717920768
Performing filtering
2024-03-12 02:06:26.285918 MEMORY 15.717920768
Got 17 patterns after filtering
2024-03-12 02:06:29.359907 MEMORY 15.717920768
Total time taken is 3110.33s
2024-03-12 02:06:29.360116 MEMORY 15.717920768
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 368 tasks      | elapsed:    0.8s
[Parallel(n_jobs=24)]: Done 1368 tasks      | elapsed:    2.5s
[Parallel(n_jobs=24)]: Done 2768 tasks      | elapsed:    4.9s
[Parallel(n_jobs=24)]: Done 4568 tasks      | elapsed:    7.9s
[Parallel(n_jobs=24)]: Done 6768 tasks      | elapsed:   11.7s
[Parallel(n_jobs=24)]: Done 7669 out of 7669 | elapsed:   13.2s finished
/ru-auth/local/home/lzhao/anaconda3/envs/jupyter-ml-clone/lib/python3.9/site-packages/sklearn/manifold/_t_sne.py:691: FutureWarning: 'square_distances' has been introduced in 0.24 to help phase out legacy squaring behavior. The 'legacy' setting will be removed in 1.1 (renaming of 0.26), and the default setting will be changed to True. In 1.3, 'square_distances' will be removed altogether, and distances will be squared by default. Set 'square_distances'=True to silence this warning.
  warnings.warn(
/ru-auth/local/home/lzhao/anaconda3/envs/jupyter-ml-clone/lib/python3.9/site-packages/sklearn/neighbors/_base.py:175: EfficiencyWarning: Precomputed sparse input was not sorted by data.
  warnings.warn('Precomputed sparse input was not sorted by data.',
Applying subclustering to the final motifs
On pattern 0
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 7669 samples in 0.054s...
[t-SNE] Computed neighbors for 7669 samples in 0.006s...
[t-SNE] Computed conditional probabilities for sample 1000 / 7669
[t-SNE] Computed conditional probabilities for sample 2000 / 7669
[t-SNE] Computed conditional probabilities for sample 3000 / 7669
[t-SNE] Computed conditional probabilities for sample 4000 / 7669
[t-SNE] Computed conditional probabilities for sample 5000 / 7669
[t-SNE] Computed conditional probabilities for sample 6000 / 7669
[t-SNE] Computed conditional probabilities for sample 7000 / 7669
[t-SNE] Computed conditional probabilities for sample 7669 / 7669
[t-SNE] Mean sigma: 0.260105
[t-SNE] Computed conditional probabilities in 0.591s
[t-SNE] Iteration 50: error = 86.3675003, gradient norm = 0.0000000 (50 iterations in 0.740s)
[t-SNE] Iteration 50: gradient norm 0.000000. Finished.
[t-SNE] KL divergence after 50 iterations with early exaggeration: 86.367500
[t-SNE] Iteration 100: error = 3.5017915, gradient norm = 0.0030566 (50 iterations in 0.675s)
[t-SNE] Iteration 150: error = 2.9515135, gradient norm = 0.0006244 (50 iterations in 0.645s)
[t-SNE] Iteration 200: error = 2.8093600, gradient norm = 0.0003275 (50 iterations in 0.640s)
[t-SNE] Iteration 250: error = 2.7343953, gradient norm = 0.0002058 (50 iterations in 0.644s)
[t-SNE] Iteration 300: error = 2.6853831, gradient norm = 0.0001434 (50 iterations in 0.639s)
[t-SNE] Iteration 350: error = 2.6505976, gradient norm = 0.0001129 (50 iterations in 0.647s)
[t-SNE] Iteration 400: error = 2.6258340, gradient norm = 0.0000929 (50 iterations in 0.648s)
[t-SNE] Iteration 450: error = 2.6063595, gradient norm = 0.0000803 (50 iterations in 0.671s)
[t-SNE] Iteration 500: error = 2.5923584, gradient norm = 0.0000722 (50 iterations in 0.679s)
[t-SNE] Iteration 550: error = 2.5809932, gradient norm = 0.0000603 (50 iterations in 0.637s)
[t-SNE] Iteration 600: error = 2.5717072, gradient norm = 0.0000546 (50 iterations in 0.643s)
[t-SNE] Iteration 650: error = 2.5642743, gradient norm = 0.0000501 (50 iterations in 0.639s)
[t-SNE] Iteration 700: error = 2.5582168, gradient norm = 0.0000495 (50 iterations in 0.640s)
[t-SNE] Iteration 750: error = 2.5539980, gradient norm = 0.0000460 (50 iterations in 0.646s)
[t-SNE] Iteration 800: error = 2.5506003, gradient norm = 0.0000445 (50 iterations in 0.643s)
[t-SNE] Iteration 850: error = 2.5477958, gradient norm = 0.0000427 (50 iterations in 0.641s)
[t-SNE] Iteration 900: error = 2.5453842, gradient norm = 0.0000390 (50 iterations in 0.642s)
[t-SNE] Iteration 950: error = 2.5429602, gradient norm = 0.0000348 (50 iterations in 0.638s)
[t-SNE] Iteration 1000: error = 2.5405245, gradient norm = 0.0000329 (50 iterations in 0.643s)
[t-SNE] KL divergence after 1000 iterations: 2.540524
[t-SNE] Computed conditional probabilities for sample 1000 / 7669
[t-SNE] Computed conditional probabilities for sample 2000 / 7669
[t-SNE] Computed conditional probabilities for sample 3000 / 7669
[t-SNE] Computed conditional probabilities for sample 4000 / 7669
[t-SNE] Computed conditional probabilities for sample 5000 / 7669
[t-SNE] Computed conditional probabilities for sample 6000 / 7669
[t-SNE] Computed conditional probabilities for sample 7000 / 7669
[t-SNE] Computed conditional probabilities for sample 7669 / 7669
[t-SNE] Mean sigma: 0.260105
Beginning preprocessing + Leiden
2024-03-12 02:07:05.020359 MEMORY 15.721545728
Affmat transformed
2024-03-12 02:07:05.139076 MEMORY 15.721545728
sources, targets, weights extracted
2024-03-12 02:07:05.206938 MEMORY 15.721545728
About to launch parallel Leiden runs
2024-03-12 02:07:05.275333 MEMORY 15.721545728
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:   33.0s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:  2.0min finished
Parallel Leiden runs finished
2024-03-12 02:09:07.248250 MEMORY 15.721545728
Quality: 0.5986678385509011
Quality: 0.6001607450535134
Quality: 0.6003269048790342
Quality: 0.6005270222343293
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.5s
[Parallel(n_jobs=24)]: Done 2400 tasks      | elapsed:    2.3s
[Parallel(n_jobs=24)]: Done 3807 out of 3807 | elapsed:    3.4s finished
Got subclusters: Counter({0: 1401, 1: 1066, 2: 1054, 3: 802, 4: 757, 5: 637, 6: 581, 7: 499, 8: 413, 9: 392, 10: 54, 11: 13})
On pattern 1
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 3807 samples in 0.026s...
[t-SNE] Computed neighbors for 3807 samples in 0.002s...
[t-SNE] Computed conditional probabilities for sample 1000 / 3807
[t-SNE] Computed conditional probabilities for sample 2000 / 3807
[t-SNE] Computed conditional probabilities for sample 3000 / 3807
[t-SNE] Computed conditional probabilities for sample 3807 / 3807
[t-SNE] Mean sigma: 0.256374
[t-SNE] Computed conditional probabilities in 0.282s
[t-SNE] Iteration 50: error = 77.7711868, gradient norm = 0.0021990 (50 iterations in 0.712s)
[t-SNE] Iteration 100: error = 77.7711334, gradient norm = 0.0002072 (50 iterations in 0.733s)
[t-SNE] Iteration 150: error = 77.7711639, gradient norm = 0.0019134 (50 iterations in 0.550s)
[t-SNE] Iteration 200: error = 77.7711334, gradient norm = 0.0001704 (50 iterations in 0.432s)
[t-SNE] Iteration 250: error = 77.7711639, gradient norm = 0.0015316 (50 iterations in 0.370s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 77.771164
[t-SNE] Iteration 300: error = 2.4813321, gradient norm = 0.0016578 (50 iterations in 0.364s)
[t-SNE] Iteration 350: error = 2.2701206, gradient norm = 0.0005495 (50 iterations in 0.297s)
[t-SNE] Iteration 400: error = 2.1838901, gradient norm = 0.0002712 (50 iterations in 0.303s)
[t-SNE] Iteration 450: error = 2.1378534, gradient norm = 0.0001620 (50 iterations in 0.298s)
[t-SNE] Iteration 500: error = 2.1100907, gradient norm = 0.0001150 (50 iterations in 0.298s)
[t-SNE] Iteration 550: error = 2.0925899, gradient norm = 0.0000908 (50 iterations in 0.299s)
[t-SNE] Iteration 600: error = 2.0805659, gradient norm = 0.0000764 (50 iterations in 0.298s)
[t-SNE] Iteration 650: error = 2.0724149, gradient norm = 0.0000640 (50 iterations in 0.297s)
[t-SNE] Iteration 700: error = 2.0668085, gradient norm = 0.0000745 (50 iterations in 0.299s)
[t-SNE] Iteration 750: error = 2.0634398, gradient norm = 0.0000593 (50 iterations in 0.299s)
[t-SNE] Iteration 800: error = 2.0603004, gradient norm = 0.0000695 (50 iterations in 0.300s)
[t-SNE] Iteration 850: error = 2.0584359, gradient norm = 0.0000506 (50 iterations in 0.299s)
[t-SNE] Iteration 900: error = 2.0567000, gradient norm = 0.0000454 (50 iterations in 0.301s)
[t-SNE] Iteration 950: error = 2.0548160, gradient norm = 0.0000423 (50 iterations in 0.299s)
[t-SNE] Iteration 1000: error = 2.0530055, gradient norm = 0.0000421 (50 iterations in 0.297s)
[t-SNE] KL divergence after 1000 iterations: 2.053005
[t-SNE] Computed conditional probabilities for sample 1000 / 3807
[t-SNE] Computed conditional probabilities for sample 2000 / 3807
[t-SNE] Computed conditional probabilities for sample 3000 / 3807
[t-SNE] Computed conditional probabilities for sample 3807 / 3807
[t-SNE] Mean sigma: 0.256374
Beginning preprocessing + Leiden
2024-03-12 02:09:23.533723 MEMORY 15.721545728
Affmat transformed
2024-03-12 02:09:23.584786 MEMORY 15.721545728
sources, targets, weights extracted
2024-03-12 02:09:23.618044 MEMORY 15.721545728
About to launch parallel Leiden runs
2024-03-12 02:09:23.647948 MEMORY 15.721545728
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:   13.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   48.2s finished
Parallel Leiden runs finished
2024-03-12 02:10:11.891354 MEMORY 15.721545728
Quality: 0.5705311308348714
Quality: 0.570715067221029
Quality: 0.5708225990352355
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 2295 tasks      | elapsed:    1.3s
[Parallel(n_jobs=24)]: Done 2548 out of 2548 | elapsed:    1.5s finished
Got subclusters: Counter({0: 765, 1: 740, 2: 560, 3: 477, 4: 341, 5: 320, 6: 224, 7: 139, 8: 128, 9: 113})
On pattern 2
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 2548 samples in 0.019s...
[t-SNE] Computed neighbors for 2548 samples in 0.002s...
[t-SNE] Computed conditional probabilities for sample 1000 / 2548
[t-SNE] Computed conditional probabilities for sample 2000 / 2548
[t-SNE] Computed conditional probabilities for sample 2548 / 2548
[t-SNE] Mean sigma: 0.305151
[t-SNE] Computed conditional probabilities in 0.179s
[t-SNE] Iteration 50: error = 73.4785919, gradient norm = 0.0174656 (50 iterations in 0.264s)
[t-SNE] Iteration 100: error = 73.4801483, gradient norm = 0.0223225 (50 iterations in 0.260s)
[t-SNE] Iteration 150: error = 73.4776382, gradient norm = 0.0134042 (50 iterations in 0.272s)
[t-SNE] Iteration 200: error = 73.4804535, gradient norm = 0.0236143 (50 iterations in 0.262s)
[t-SNE] Iteration 250: error = 73.4798737, gradient norm = 0.0225074 (50 iterations in 0.253s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 73.479874
[t-SNE] Iteration 300: error = 2.2762232, gradient norm = 0.0013008 (50 iterations in 0.217s)
[t-SNE] Iteration 350: error = 2.1236186, gradient norm = 0.0005006 (50 iterations in 0.201s)
[t-SNE] Iteration 400: error = 2.0611098, gradient norm = 0.0002363 (50 iterations in 0.202s)
[t-SNE] Iteration 450: error = 2.0292227, gradient norm = 0.0001534 (50 iterations in 0.201s)
[t-SNE] Iteration 500: error = 2.0120606, gradient norm = 0.0001355 (50 iterations in 0.201s)
[t-SNE] Iteration 550: error = 2.0017030, gradient norm = 0.0001049 (50 iterations in 0.201s)
[t-SNE] Iteration 600: error = 1.9956168, gradient norm = 0.0000844 (50 iterations in 0.203s)
[t-SNE] Iteration 650: error = 1.9912952, gradient norm = 0.0000864 (50 iterations in 0.202s)
[t-SNE] Iteration 700: error = 1.9880729, gradient norm = 0.0000694 (50 iterations in 0.201s)
[t-SNE] Iteration 750: error = 1.9859667, gradient norm = 0.0000813 (50 iterations in 0.200s)
[t-SNE] Iteration 800: error = 1.9842020, gradient norm = 0.0000634 (50 iterations in 0.204s)
[t-SNE] Iteration 850: error = 1.9823906, gradient norm = 0.0001023 (50 iterations in 0.202s)
[t-SNE] Iteration 900: error = 1.9807884, gradient norm = 0.0000707 (50 iterations in 0.201s)
[t-SNE] Iteration 950: error = 1.9794980, gradient norm = 0.0000563 (50 iterations in 0.202s)
[t-SNE] Iteration 1000: error = 1.9781785, gradient norm = 0.0000661 (50 iterations in 0.202s)
[t-SNE] KL divergence after 1000 iterations: 1.978179
[t-SNE] Computed conditional probabilities for sample 1000 / 2548
[t-SNE] Computed conditional probabilities for sample 2000 / 2548
[t-SNE] Computed conditional probabilities for sample 2548 / 2548
[t-SNE] Mean sigma: 0.305151
Beginning preprocessing + Leiden
2024-03-12 02:10:21.249050 MEMORY 15.721549824
Affmat transformed
2024-03-12 02:10:21.280369 MEMORY 15.721549824
sources, targets, weights extracted
2024-03-12 02:10:21.303528 MEMORY 15.721549824
About to launch parallel Leiden runs
2024-03-12 02:10:21.314999 MEMORY 15.721549824
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    8.4s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   31.4s finished
Parallel Leiden runs finished
2024-03-12 02:10:52.706349 MEMORY 15.721549824
Quality: 0.5423980892556027
Quality: 0.5433158095461178
Quality: 0.5443253458770488
Quality: 0.5448170982612427
Quality: 0.5450973276990404
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 687 out of 687 | elapsed:    0.4s finished
Got subclusters: Counter({0: 466, 1: 449, 2: 405, 3: 349, 4: 342, 5: 318, 6: 142, 7: 77})
On pattern 3
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 687 samples in 0.006s...
[t-SNE] Computed neighbors for 687 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 687 / 687
[t-SNE] Mean sigma: 0.268760
[t-SNE] Computed conditional probabilities in 0.051s
[t-SNE] Iteration 50: error = 66.1251450, gradient norm = 0.4003995 (50 iterations in 0.074s)
[t-SNE] Iteration 100: error = 66.8113327, gradient norm = 0.3907599 (50 iterations in 0.074s)
[t-SNE] Iteration 150: error = 66.6467133, gradient norm = 0.3974983 (50 iterations in 0.076s)
[t-SNE] Iteration 200: error = 67.0717545, gradient norm = 0.4172257 (50 iterations in 0.075s)
[t-SNE] Iteration 250: error = 68.2290115, gradient norm = 0.3882622 (50 iterations in 0.074s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 68.229012
[t-SNE] Iteration 300: error = 1.0810972, gradient norm = 0.0024745 (50 iterations in 0.070s)
[t-SNE] Iteration 350: error = 1.0351781, gradient norm = 0.0007601 (50 iterations in 0.069s)
[t-SNE] Iteration 400: error = 1.0205226, gradient norm = 0.0007494 (50 iterations in 0.069s)
[t-SNE] Iteration 450: error = 1.0155364, gradient norm = 0.0001558 (50 iterations in 0.068s)
[t-SNE] Iteration 500: error = 1.0037427, gradient norm = 0.0003397 (50 iterations in 0.068s)
[t-SNE] Iteration 550: error = 1.0030533, gradient norm = 0.0001478 (50 iterations in 0.068s)
[t-SNE] Iteration 600: error = 1.0027224, gradient norm = 0.0000688 (50 iterations in 0.068s)
[t-SNE] Iteration 650: error = 1.0023546, gradient norm = 0.0000639 (50 iterations in 0.068s)
[t-SNE] Iteration 700: error = 1.0020958, gradient norm = 0.0000645 (50 iterations in 0.068s)
[t-SNE] Iteration 750: error = 1.0017552, gradient norm = 0.0000491 (50 iterations in 0.068s)
[t-SNE] Iteration 800: error = 1.0016003, gradient norm = 0.0000869 (50 iterations in 0.067s)
[t-SNE] Iteration 850: error = 1.0012764, gradient norm = 0.0000549 (50 iterations in 0.068s)
[t-SNE] Iteration 900: error = 1.0011863, gradient norm = 0.0000368 (50 iterations in 0.068s)
[t-SNE] Iteration 950: error = 1.0010883, gradient norm = 0.0000410 (50 iterations in 0.068s)
[t-SNE] Iteration 1000: error = 1.0010333, gradient norm = 0.0000539 (50 iterations in 0.068s)
[t-SNE] KL divergence after 1000 iterations: 1.001033
[t-SNE] Computed conditional probabilities for sample 687 / 687
[t-SNE] Mean sigma: 0.268760
Beginning preprocessing + Leiden
2024-03-12 02:10:55.740652 MEMORY 15.72155392
Affmat transformed
2024-03-12 02:10:55.749906 MEMORY 15.72155392
sources, targets, weights extracted
2024-03-12 02:10:55.756834 MEMORY 15.72155392
About to launch parallel Leiden runs
2024-03-12 02:10:55.763490 MEMORY 15.72155392
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.9s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    6.6s finished
Parallel Leiden runs finished
2024-03-12 02:11:02.399724 MEMORY 15.72155392
Quality: 0.5057526603735569
Quality: 0.5070436021791795
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 344 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 489 out of 489 | elapsed:    0.3s finished
Got subclusters: Counter({0: 154, 1: 147, 2: 104, 3: 74, 4: 71, 5: 61, 6: 55, 7: 21})
On pattern 4
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 489 samples in 0.005s...
[t-SNE] Computed neighbors for 489 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 489 / 489
[t-SNE] Mean sigma: 0.325819
[t-SNE] Computed conditional probabilities in 0.039s
[t-SNE] Iteration 50: error = 65.9006348, gradient norm = 0.4911426 (50 iterations in 0.054s)
[t-SNE] Iteration 100: error = 71.2336197, gradient norm = 0.4295752 (50 iterations in 0.057s)
[t-SNE] Iteration 150: error = 73.0886383, gradient norm = 0.4067070 (50 iterations in 0.055s)
[t-SNE] Iteration 200: error = 71.3283539, gradient norm = 0.4235798 (50 iterations in 0.058s)
[t-SNE] Iteration 250: error = 71.2539902, gradient norm = 0.4307951 (50 iterations in 0.056s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 71.253990
[t-SNE] Iteration 300: error = 1.3914894, gradient norm = 0.0045787 (50 iterations in 0.053s)
[t-SNE] Iteration 350: error = 1.3392184, gradient norm = 0.0010742 (50 iterations in 0.052s)
[t-SNE] Iteration 400: error = 1.2933939, gradient norm = 0.0007981 (50 iterations in 0.055s)
[t-SNE] Iteration 450: error = 1.2744265, gradient norm = 0.0006680 (50 iterations in 0.052s)
[t-SNE] Iteration 500: error = 1.2500563, gradient norm = 0.0013256 (50 iterations in 0.052s)
[t-SNE] Iteration 550: error = 1.2165062, gradient norm = 0.0013510 (50 iterations in 0.052s)
[t-SNE] Iteration 600: error = 1.2018049, gradient norm = 0.0005036 (50 iterations in 0.054s)
[t-SNE] Iteration 650: error = 1.1968292, gradient norm = 0.0002651 (50 iterations in 0.052s)
[t-SNE] Iteration 700: error = 1.1907967, gradient norm = 0.0003608 (50 iterations in 0.052s)
[t-SNE] Iteration 750: error = 1.1897408, gradient norm = 0.0001309 (50 iterations in 0.052s)
[t-SNE] Iteration 800: error = 1.1887034, gradient norm = 0.0002149 (50 iterations in 0.052s)
[t-SNE] Iteration 850: error = 1.1883587, gradient norm = 0.0000839 (50 iterations in 0.052s)
[t-SNE] Iteration 900: error = 1.1877393, gradient norm = 0.0003537 (50 iterations in 0.051s)
[t-SNE] Iteration 950: error = 1.1854833, gradient norm = 0.0004486 (50 iterations in 0.052s)
[t-SNE] Iteration 1000: error = 1.1746213, gradient norm = 0.0005009 (50 iterations in 0.052s)
[t-SNE] KL divergence after 1000 iterations: 1.174621
[t-SNE] Computed conditional probabilities for sample 489 / 489
[t-SNE] Mean sigma: 0.325819
Beginning preprocessing + Leiden
2024-03-12 02:11:04.391460 MEMORY 15.72155392
Affmat transformed
2024-03-12 02:11:04.399241 MEMORY 15.72155392
sources, targets, weights extracted
2024-03-12 02:11:04.403012 MEMORY 15.72155392
About to launch parallel Leiden runs
2024-03-12 02:11:04.408438 MEMORY 15.72155392
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.6s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    4.7s finished
Parallel Leiden runs finished
2024-03-12 02:11:09.113604 MEMORY 15.72155392
Quality: 0.39681776536288416
Quality: 0.4027972009893865
Quality: 0.4032550055083813
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 344 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 462 out of 462 | elapsed:    0.2s finished
Got subclusters: Counter({0: 139, 1: 115, 2: 88, 3: 63, 4: 62, 5: 8, 6: 7, 7: 7})
On pattern 5
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 462 samples in 0.004s...
[t-SNE] Computed neighbors for 462 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 462 / 462
[t-SNE] Mean sigma: 0.346531
[t-SNE] Computed conditional probabilities in 0.036s
[t-SNE] Iteration 50: error = 67.9446793, gradient norm = 0.4680251 (50 iterations in 0.051s)
[t-SNE] Iteration 100: error = 69.1551971, gradient norm = 0.4559501 (50 iterations in 0.051s)
[t-SNE] Iteration 150: error = 69.6557999, gradient norm = 0.4512303 (50 iterations in 0.051s)
[t-SNE] Iteration 200: error = 70.0772247, gradient norm = 0.4380478 (50 iterations in 0.051s)
[t-SNE] Iteration 250: error = 69.4586334, gradient norm = 0.4422590 (50 iterations in 0.052s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 69.458633
[t-SNE] Iteration 300: error = 1.2594490, gradient norm = 0.0034303 (50 iterations in 0.050s)
[t-SNE] Iteration 350: error = 1.2039707, gradient norm = 0.0008070 (50 iterations in 0.051s)
[t-SNE] Iteration 400: error = 1.1430565, gradient norm = 0.0018139 (50 iterations in 0.049s)
[t-SNE] Iteration 450: error = 1.1220155, gradient norm = 0.0004897 (50 iterations in 0.049s)
[t-SNE] Iteration 500: error = 1.1165429, gradient norm = 0.0002093 (50 iterations in 0.064s)
[t-SNE] Iteration 550: error = 1.1145111, gradient norm = 0.0002318 (50 iterations in 0.052s)
[t-SNE] Iteration 600: error = 1.1126847, gradient norm = 0.0002469 (50 iterations in 0.051s)
[t-SNE] Iteration 650: error = 1.1085176, gradient norm = 0.0003434 (50 iterations in 0.049s)
[t-SNE] Iteration 700: error = 1.1028694, gradient norm = 0.0002903 (50 iterations in 0.049s)
[t-SNE] Iteration 750: error = 1.1024486, gradient norm = 0.0000707 (50 iterations in 0.050s)
[t-SNE] Iteration 800: error = 1.1016331, gradient norm = 0.0002361 (50 iterations in 0.049s)
[t-SNE] Iteration 850: error = 1.0999882, gradient norm = 0.0001036 (50 iterations in 0.051s)
[t-SNE] Iteration 900: error = 1.0943803, gradient norm = 0.0002495 (50 iterations in 0.049s)
[t-SNE] Iteration 950: error = 1.0942202, gradient norm = 0.0000634 (50 iterations in 0.049s)
[t-SNE] Iteration 1000: error = 1.0942503, gradient norm = 0.0000715 (50 iterations in 0.049s)
[t-SNE] KL divergence after 1000 iterations: 1.094250
[t-SNE] Computed conditional probabilities for sample 462 / 462
[t-SNE] Mean sigma: 0.346531
Beginning preprocessing + Leiden
2024-03-12 02:11:10.970686 MEMORY 15.72155392
Affmat transformed
2024-03-12 02:11:10.977617 MEMORY 15.72155392
sources, targets, weights extracted
2024-03-12 02:11:10.980846 MEMORY 15.72155392
About to launch parallel Leiden runs
2024-03-12 02:11:10.986200 MEMORY 15.72155392
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.3s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    4.1s finished
Parallel Leiden runs finished
2024-03-12 02:11:15.100257 MEMORY 15.72155392
Quality: 0.43767124122782236
Quality: 0.4381267741195954
Quality: 0.4382183639046594
Quality: 0.43824856489177677
Quality: 0.4382485648917768
Quality: 0.43838890680425335
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 344 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 459 out of 459 | elapsed:    0.2s finished
Got subclusters: Counter({0: 120, 1: 102, 2: 99, 3: 56, 4: 55, 5: 30})
On pattern 6
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 459 samples in 0.004s...
[t-SNE] Computed neighbors for 459 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 459 / 459
[t-SNE] Mean sigma: 0.336258
[t-SNE] Computed conditional probabilities in 0.035s
[t-SNE] Iteration 50: error = 68.4599686, gradient norm = 0.4594133 (50 iterations in 0.055s)
[t-SNE] Iteration 100: error = 71.2269516, gradient norm = 0.4320112 (50 iterations in 0.052s)
[t-SNE] Iteration 150: error = 70.8258743, gradient norm = 0.4405038 (50 iterations in 0.053s)
[t-SNE] Iteration 200: error = 72.1359482, gradient norm = 0.4275163 (50 iterations in 0.053s)
[t-SNE] Iteration 250: error = 73.0071716, gradient norm = 0.4205430 (50 iterations in 0.055s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 73.007172
[t-SNE] Iteration 300: error = 1.3925812, gradient norm = 0.0035977 (50 iterations in 0.051s)
[t-SNE] Iteration 350: error = 1.2439356, gradient norm = 0.0026702 (50 iterations in 0.050s)
[t-SNE] Iteration 400: error = 1.1607596, gradient norm = 0.0010557 (50 iterations in 0.050s)
[t-SNE] Iteration 450: error = 1.1031188, gradient norm = 0.0017014 (50 iterations in 0.050s)
[t-SNE] Iteration 500: error = 1.0837680, gradient norm = 0.0003421 (50 iterations in 0.050s)
[t-SNE] Iteration 550: error = 1.0811803, gradient norm = 0.0001651 (50 iterations in 0.050s)
[t-SNE] Iteration 600: error = 1.0800327, gradient norm = 0.0000952 (50 iterations in 0.050s)
[t-SNE] Iteration 650: error = 1.0797895, gradient norm = 0.0000443 (50 iterations in 0.050s)
[t-SNE] Iteration 700: error = 1.0798110, gradient norm = 0.0000922 (50 iterations in 0.050s)
[t-SNE] Iteration 750: error = 1.0798134, gradient norm = 0.0000562 (50 iterations in 0.050s)
[t-SNE] Iteration 800: error = 1.0798470, gradient norm = 0.0000361 (50 iterations in 0.050s)
[t-SNE] Iteration 850: error = 1.0798292, gradient norm = 0.0000423 (50 iterations in 0.050s)
[t-SNE] Iteration 900: error = 1.0798271, gradient norm = 0.0000414 (50 iterations in 0.050s)
[t-SNE] Iteration 950: error = 1.0798163, gradient norm = 0.0000261 (50 iterations in 0.050s)
[t-SNE] Iteration 1000: error = 1.0797654, gradient norm = 0.0000605 (50 iterations in 0.050s)
[t-SNE] KL divergence after 1000 iterations: 1.079765
[t-SNE] Computed conditional probabilities for sample 459 / 459
[t-SNE] Mean sigma: 0.336258
Beginning preprocessing + Leiden
2024-03-12 02:11:17.033991 MEMORY 15.72155392
Affmat transformed
2024-03-12 02:11:17.039942 MEMORY 15.72155392
sources, targets, weights extracted
2024-03-12 02:11:17.043472 MEMORY 15.72155392
About to launch parallel Leiden runs
2024-03-12 02:11:17.050040 MEMORY 15.72155392
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.3s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    4.2s finished
Parallel Leiden runs finished
2024-03-12 02:11:21.258831 MEMORY 15.72155392
Quality: 0.4158590052971858
Quality: 0.41594545829114427
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 344 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 434 out of 434 | elapsed:    0.2s finished
Got subclusters: Counter({0: 85, 1: 84, 2: 57, 3: 56, 4: 51, 5: 48, 6: 43, 7: 35})
On pattern 7
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 434 samples in 0.004s...
[t-SNE] Computed neighbors for 434 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 434 / 434
[t-SNE] Mean sigma: 0.338348
[t-SNE] Computed conditional probabilities in 0.034s
[t-SNE] Iteration 50: error = 68.8837280, gradient norm = 0.4544673 (50 iterations in 0.049s)
[t-SNE] Iteration 100: error = 70.1107483, gradient norm = 0.4684586 (50 iterations in 0.049s)
[t-SNE] Iteration 150: error = 68.4154510, gradient norm = 0.4600463 (50 iterations in 0.050s)
[t-SNE] Iteration 200: error = 70.4489136, gradient norm = 0.4474585 (50 iterations in 0.049s)
[t-SNE] Iteration 250: error = 71.0512543, gradient norm = 0.4329679 (50 iterations in 0.049s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 71.051254
[t-SNE] Iteration 300: error = 1.1011758, gradient norm = 0.0033194 (50 iterations in 0.047s)
[t-SNE] Iteration 350: error = 1.0378121, gradient norm = 0.0013616 (50 iterations in 0.046s)
[t-SNE] Iteration 400: error = 1.0177373, gradient norm = 0.0006776 (50 iterations in 0.050s)
[t-SNE] Iteration 450: error = 1.0090950, gradient norm = 0.0006473 (50 iterations in 0.046s)
[t-SNE] Iteration 500: error = 1.0001278, gradient norm = 0.0009536 (50 iterations in 0.046s)
[t-SNE] Iteration 550: error = 0.9910722, gradient norm = 0.0010579 (50 iterations in 0.046s)
[t-SNE] Iteration 600: error = 0.9802855, gradient norm = 0.0005976 (50 iterations in 0.048s)
[t-SNE] Iteration 650: error = 0.9744482, gradient norm = 0.0006226 (50 iterations in 0.045s)
[t-SNE] Iteration 700: error = 0.9716783, gradient norm = 0.0001013 (50 iterations in 0.046s)
[t-SNE] Iteration 750: error = 0.9715436, gradient norm = 0.0000822 (50 iterations in 0.046s)
[t-SNE] Iteration 800: error = 0.9717116, gradient norm = 0.0000727 (50 iterations in 0.046s)
[t-SNE] Iteration 850: error = 0.9716095, gradient norm = 0.0000499 (50 iterations in 0.045s)
[t-SNE] Iteration 900: error = 0.9715354, gradient norm = 0.0000727 (50 iterations in 0.045s)
[t-SNE] Iteration 950: error = 0.9716414, gradient norm = 0.0000662 (50 iterations in 0.045s)
[t-SNE] Iteration 1000: error = 0.9716818, gradient norm = 0.0000671 (50 iterations in 0.045s)
[t-SNE] KL divergence after 1000 iterations: 0.971682
[t-SNE] Computed conditional probabilities for sample 434 / 434
[t-SNE] Mean sigma: 0.338348
Beginning preprocessing + Leiden
2024-03-12 02:11:22.976496 MEMORY 15.72155392
Affmat transformed
2024-03-12 02:11:22.982669 MEMORY 15.72155392
sources, targets, weights extracted
2024-03-12 02:11:22.986198 MEMORY 15.72155392
About to launch parallel Leiden runs
2024-03-12 02:11:23.001701 MEMORY 15.72155392
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.3s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    3.9s finished
Parallel Leiden runs finished
2024-03-12 02:11:26.873612 MEMORY 15.72155392
Quality: 0.4133552228687403
Quality: 0.4156667879568065
Quality: 0.41582868295627506
Quality: 0.4160683413921706
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 344 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 430 out of 430 | elapsed:    0.2s finished
Got subclusters: Counter({0: 83, 1: 68, 2: 66, 3: 65, 4: 54, 5: 52, 6: 36, 7: 10})
On pattern 8
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 430 samples in 0.004s...
[t-SNE] Computed neighbors for 430 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 430 / 430
[t-SNE] Mean sigma: 0.333997
[t-SNE] Computed conditional probabilities in 0.032s
[t-SNE] Iteration 50: error = 68.6654816, gradient norm = 0.4755236 (50 iterations in 0.049s)
[t-SNE] Iteration 100: error = 69.3636627, gradient norm = 0.4645692 (50 iterations in 0.049s)
[t-SNE] Iteration 150: error = 69.9621048, gradient norm = 0.4726211 (50 iterations in 0.049s)
[t-SNE] Iteration 200: error = 71.6535110, gradient norm = 0.4415167 (50 iterations in 0.050s)
[t-SNE] Iteration 250: error = 71.2199326, gradient norm = 0.4498253 (50 iterations in 0.049s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 71.219933
[t-SNE] Iteration 300: error = 1.2419839, gradient norm = 0.0037276 (50 iterations in 0.048s)
[t-SNE] Iteration 350: error = 1.1620343, gradient norm = 0.0012045 (50 iterations in 0.047s)
[t-SNE] Iteration 400: error = 1.1201530, gradient norm = 0.0015294 (50 iterations in 0.047s)
[t-SNE] Iteration 450: error = 1.0833305, gradient norm = 0.0010257 (50 iterations in 0.046s)
[t-SNE] Iteration 500: error = 1.0677278, gradient norm = 0.0005477 (50 iterations in 0.046s)
[t-SNE] Iteration 550: error = 1.0585407, gradient norm = 0.0006397 (50 iterations in 0.046s)
[t-SNE] Iteration 600: error = 1.0452240, gradient norm = 0.0005124 (50 iterations in 0.046s)
[t-SNE] Iteration 650: error = 1.0348505, gradient norm = 0.0007564 (50 iterations in 0.046s)
[t-SNE] Iteration 700: error = 1.0310173, gradient norm = 0.0003273 (50 iterations in 0.046s)
[t-SNE] Iteration 750: error = 1.0307926, gradient norm = 0.0001272 (50 iterations in 0.046s)
[t-SNE] Iteration 800: error = 1.0308657, gradient norm = 0.0000873 (50 iterations in 0.046s)
[t-SNE] Iteration 850: error = 1.0304105, gradient norm = 0.0001950 (50 iterations in 0.046s)
[t-SNE] Iteration 900: error = 1.0302936, gradient norm = 0.0001103 (50 iterations in 0.046s)
[t-SNE] Iteration 950: error = 1.0291729, gradient norm = 0.0004457 (50 iterations in 0.046s)
[t-SNE] Iteration 1000: error = 1.0279423, gradient norm = 0.0002472 (50 iterations in 0.046s)
[t-SNE] KL divergence after 1000 iterations: 1.027942
[t-SNE] Computed conditional probabilities for sample 430 / 430
[t-SNE] Mean sigma: 0.333998
Beginning preprocessing + Leiden
2024-03-12 02:11:28.660555 MEMORY 15.72155392
Affmat transformed
2024-03-12 02:11:28.666137 MEMORY 15.72155392
sources, targets, weights extracted
2024-03-12 02:11:28.669599 MEMORY 15.72155392
About to launch parallel Leiden runs
2024-03-12 02:11:28.675177 MEMORY 15.72155392
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.2s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    3.8s finished
Parallel Leiden runs finished
2024-03-12 02:11:32.504495 MEMORY 15.72155392
Quality: 0.41960008485246697
Quality: 0.42051002707540736
Quality: 0.4206431724555857
Quality: 0.4207014710870934
Quality: 0.4209473214258911
Quality: 0.4211265307519111
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 292 out of 292 | elapsed:    0.1s finished
Got subclusters: Counter({0: 80, 1: 78, 2: 77, 3: 68, 4: 53, 5: 52, 6: 15, 7: 7})
On pattern 9
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 292 samples in 0.003s...
[t-SNE] Computed neighbors for 292 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 292 / 292
[t-SNE] Mean sigma: 0.368254
[t-SNE] Computed conditional probabilities in 0.022s
[t-SNE] Iteration 50: error = 62.9278030, gradient norm = 0.4973919 (50 iterations in 0.039s)
[t-SNE] Iteration 100: error = 63.7466354, gradient norm = 0.5156272 (50 iterations in 0.038s)
[t-SNE] Iteration 150: error = 65.6422195, gradient norm = 0.4987208 (50 iterations in 0.038s)
[t-SNE] Iteration 200: error = 63.0579796, gradient norm = 0.4774383 (50 iterations in 0.038s)
[t-SNE] Iteration 250: error = 66.3932571, gradient norm = 0.4625660 (50 iterations in 0.041s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 66.393257
[t-SNE] Iteration 300: error = 1.2531663, gradient norm = 0.0062779 (50 iterations in 0.037s)
[t-SNE] Iteration 350: error = 1.0235258, gradient norm = 0.0035692 (50 iterations in 0.036s)
[t-SNE] Iteration 400: error = 0.9391143, gradient norm = 0.0021030 (50 iterations in 0.036s)
[t-SNE] Iteration 450: error = 0.9228497, gradient norm = 0.0008253 (50 iterations in 0.037s)
[t-SNE] Iteration 500: error = 0.9167771, gradient norm = 0.0003294 (50 iterations in 0.037s)
[t-SNE] Iteration 550: error = 0.9163058, gradient norm = 0.0000759 (50 iterations in 0.037s)
[t-SNE] Iteration 600: error = 0.9158784, gradient norm = 0.0003554 (50 iterations in 0.037s)
[t-SNE] Iteration 650: error = 0.9159882, gradient norm = 0.0000801 (50 iterations in 0.037s)
[t-SNE] Iteration 700: error = 0.9159580, gradient norm = 0.0001111 (50 iterations in 0.037s)
[t-SNE] Iteration 750: error = 0.9159164, gradient norm = 0.0000938 (50 iterations in 0.037s)
[t-SNE] Iteration 800: error = 0.9160289, gradient norm = 0.0000911 (50 iterations in 0.037s)
[t-SNE] Iteration 850: error = 0.9159145, gradient norm = 0.0001010 (50 iterations in 0.037s)
[t-SNE] Iteration 900: error = 0.9159355, gradient norm = 0.0000909 (50 iterations in 0.037s)
[t-SNE] Iteration 950: error = 0.9159968, gradient norm = 0.0000492 (50 iterations in 0.036s)
[t-SNE] Iteration 950: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 950 iterations: 0.915997
[t-SNE] Computed conditional probabilities for sample 292 / 292
[t-SNE] Mean sigma: 0.368254
Beginning preprocessing + Leiden
2024-03-12 02:11:33.735496 MEMORY 15.721558016
Affmat transformed
2024-03-12 02:11:33.739576 MEMORY 15.721558016
sources, targets, weights extracted
2024-03-12 02:11:33.741780 MEMORY 15.721558016
About to launch parallel Leiden runs
2024-03-12 02:11:33.746492 MEMORY 15.721558016
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.0s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    3.0s finished
Parallel Leiden runs finished
2024-03-12 02:11:36.797438 MEMORY 15.721558016
Quality: 0.38797803817164345
Quality: 0.38902942296004633
Quality: 0.389095520060637
Quality: 0.38927144929278223
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 238 out of 238 | elapsed:    0.1s finished
Got subclusters: Counter({0: 83, 1: 63, 2: 56, 3: 28, 4: 25, 5: 22, 6: 15})
On pattern 10
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 238 samples in 0.002s...
[t-SNE] Computed neighbors for 238 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 238 / 238
[t-SNE] Mean sigma: 0.381521
[t-SNE] Computed conditional probabilities in 0.017s
[t-SNE] Iteration 50: error = 59.8773956, gradient norm = 0.5195729 (50 iterations in 0.034s)
[t-SNE] Iteration 100: error = 57.4760208, gradient norm = 0.5508380 (50 iterations in 0.034s)
[t-SNE] Iteration 150: error = 58.0128365, gradient norm = 0.5016836 (50 iterations in 0.034s)
[t-SNE] Iteration 200: error = 59.6883812, gradient norm = 0.5131901 (50 iterations in 0.034s)
[t-SNE] Iteration 250: error = 61.4105606, gradient norm = 0.4675516 (50 iterations in 0.034s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 61.410561
[t-SNE] Iteration 300: error = 0.8669932, gradient norm = 0.0047726 (50 iterations in 0.033s)
[t-SNE] Iteration 350: error = 0.7436959, gradient norm = 0.0034323 (50 iterations in 0.033s)
[t-SNE] Iteration 400: error = 0.7094168, gradient norm = 0.0023708 (50 iterations in 0.033s)
[t-SNE] Iteration 450: error = 0.7046566, gradient norm = 0.0001640 (50 iterations in 0.033s)
[t-SNE] Iteration 500: error = 0.7046961, gradient norm = 0.0001326 (50 iterations in 0.032s)
[t-SNE] Iteration 550: error = 0.7047470, gradient norm = 0.0001172 (50 iterations in 0.033s)
[t-SNE] Iteration 600: error = 0.7047338, gradient norm = 0.0000783 (50 iterations in 0.033s)
[t-SNE] Iteration 650: error = 0.7046703, gradient norm = 0.0000575 (50 iterations in 0.033s)
[t-SNE] Iteration 700: error = 0.7046625, gradient norm = 0.0000974 (50 iterations in 0.033s)
[t-SNE] Iteration 750: error = 0.7047013, gradient norm = 0.0001107 (50 iterations in 0.033s)
[t-SNE] Iteration 800: error = 0.7046465, gradient norm = 0.0000652 (50 iterations in 0.033s)
[t-SNE] Iteration 850: error = 0.7047393, gradient norm = 0.0000950 (50 iterations in 0.033s)
[t-SNE] Iteration 900: error = 0.7045955, gradient norm = 0.0001257 (50 iterations in 0.033s)
[t-SNE] Iteration 950: error = 0.7047472, gradient norm = 0.0001534 (50 iterations in 0.033s)
[t-SNE] Iteration 1000: error = 0.7046343, gradient norm = 0.0001037 (50 iterations in 0.033s)
[t-SNE] KL divergence after 1000 iterations: 0.704634
[t-SNE] Computed conditional probabilities for sample 238 / 238
[t-SNE] Mean sigma: 0.381521
Beginning preprocessing + Leiden
2024-03-12 02:11:37.908484 MEMORY 15.721558016
Affmat transformed
2024-03-12 02:11:37.911705 MEMORY 15.721558016
sources, targets, weights extracted
2024-03-12 02:11:37.913151 MEMORY 15.721558016
About to launch parallel Leiden runs
2024-03-12 02:11:37.928334 MEMORY 15.721558016
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.9s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.8s finished
Parallel Leiden runs finished
2024-03-12 02:11:40.685965 MEMORY 15.721558016
Quality: 0.35583220017415745
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 140 out of 187 | elapsed:    0.1s remaining:    0.0s
[Parallel(n_jobs=24)]: Done 187 out of 187 | elapsed:    0.1s finished
Got subclusters: Counter({0: 79, 1: 45, 2: 41, 3: 39, 4: 34})
On pattern 11
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 187 samples in 0.002s...
[t-SNE] Computed neighbors for 187 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 187 / 187
[t-SNE] Mean sigma: 0.367158
[t-SNE] Computed conditional probabilities in 0.015s
[t-SNE] Iteration 50: error = 60.1816216, gradient norm = 0.4942143 (50 iterations in 0.031s)
[t-SNE] Iteration 100: error = 61.3736877, gradient norm = 0.5018429 (50 iterations in 0.030s)
[t-SNE] Iteration 150: error = 64.0729218, gradient norm = 0.4970910 (50 iterations in 0.030s)
[t-SNE] Iteration 200: error = 62.0265923, gradient norm = 0.5043508 (50 iterations in 0.030s)
[t-SNE] Iteration 250: error = 62.6822624, gradient norm = 0.4990802 (50 iterations in 0.030s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 62.682262
[t-SNE] Iteration 300: error = 0.9626703, gradient norm = 0.0090895 (50 iterations in 0.029s)
[t-SNE] Iteration 350: error = 0.7438581, gradient norm = 0.0052419 (50 iterations in 0.028s)
[t-SNE] Iteration 400: error = 0.6824178, gradient norm = 0.0039878 (50 iterations in 0.028s)
[t-SNE] Iteration 450: error = 0.6701763, gradient norm = 0.0003085 (50 iterations in 0.028s)
[t-SNE] Iteration 500: error = 0.6700997, gradient norm = 0.0003151 (50 iterations in 0.028s)
[t-SNE] Iteration 550: error = 0.6702851, gradient norm = 0.0002660 (50 iterations in 0.028s)
[t-SNE] Iteration 600: error = 0.6702965, gradient norm = 0.0001806 (50 iterations in 0.028s)
[t-SNE] Iteration 650: error = 0.6701326, gradient norm = 0.0002319 (50 iterations in 0.028s)
[t-SNE] Iteration 700: error = 0.6702406, gradient norm = 0.0001577 (50 iterations in 0.028s)
[t-SNE] Iteration 750: error = 0.6702419, gradient norm = 0.0001613 (50 iterations in 0.028s)
[t-SNE] Iteration 800: error = 0.6702898, gradient norm = 0.0001918 (50 iterations in 0.028s)
[t-SNE] Iteration 850: error = 0.6702265, gradient norm = 0.0002497 (50 iterations in 0.028s)
[t-SNE] Iteration 850: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 850 iterations: 0.670226
[t-SNE] Computed conditional probabilities for sample 187 / 187
[t-SNE] Mean sigma: 0.367158
Beginning preprocessing + Leiden
2024-03-12 02:11:41.527858 MEMORY 15.721558016
Affmat transformed
2024-03-12 02:11:41.530589 MEMORY 15.721558016
sources, targets, weights extracted
2024-03-12 02:11:41.531722 MEMORY 15.721558016
About to launch parallel Leiden runs
2024-03-12 02:11:41.555019 MEMORY 15.721558016
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.8s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.5s finished
Parallel Leiden runs finished
2024-03-12 02:11:44.068503 MEMORY 15.721558016
Quality: 0.29705783825493326
Quality: 0.29716280206088075
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 176 out of 176 | elapsed:    0.1s finished
Got subclusters: Counter({0: 53, 1: 37, 2: 35, 3: 33, 4: 23, 5: 6})
On pattern 12
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 176 samples in 0.002s...
[t-SNE] Computed neighbors for 176 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 176 / 176
[t-SNE] Mean sigma: 0.386006
[t-SNE] Computed conditional probabilities in 0.013s
[t-SNE] Iteration 50: error = 60.5616913, gradient norm = 0.5214808 (50 iterations in 0.029s)
[t-SNE] Iteration 100: error = 61.1321182, gradient norm = 0.4530724 (50 iterations in 0.029s)
[t-SNE] Iteration 150: error = 61.5313187, gradient norm = 0.4837918 (50 iterations in 0.029s)
[t-SNE] Iteration 200: error = 59.0411949, gradient norm = 0.5502313 (50 iterations in 0.029s)
[t-SNE] Iteration 250: error = 61.9195786, gradient norm = 0.4868087 (50 iterations in 0.029s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 61.919579
[t-SNE] Iteration 300: error = 0.8593845, gradient norm = 0.0077937 (50 iterations in 0.028s)
[t-SNE] Iteration 350: error = 0.5084504, gradient norm = 0.0028521 (50 iterations in 0.028s)
[t-SNE] Iteration 400: error = 0.4980488, gradient norm = 0.0003670 (50 iterations in 0.028s)
[t-SNE] Iteration 450: error = 0.4971987, gradient norm = 0.0002803 (50 iterations in 0.028s)
[t-SNE] Iteration 500: error = 0.4973449, gradient norm = 0.0001837 (50 iterations in 0.028s)
[t-SNE] Iteration 550: error = 0.4973106, gradient norm = 0.0001089 (50 iterations in 0.028s)
[t-SNE] Iteration 600: error = 0.4973048, gradient norm = 0.0002059 (50 iterations in 0.028s)
[t-SNE] Iteration 650: error = 0.4972654, gradient norm = 0.0001454 (50 iterations in 0.028s)
[t-SNE] Iteration 700: error = 0.4973035, gradient norm = 0.0002069 (50 iterations in 0.031s)
[t-SNE] Iteration 750: error = 0.4971954, gradient norm = 0.0001397 (50 iterations in 0.028s)
[t-SNE] Iteration 800: error = 0.4973164, gradient norm = 0.0001767 (50 iterations in 0.028s)
[t-SNE] Iteration 850: error = 0.4972449, gradient norm = 0.0001426 (50 iterations in 0.028s)
[t-SNE] Iteration 900: error = 0.4972979, gradient norm = 0.0001308 (50 iterations in 0.028s)
[t-SNE] Iteration 950: error = 0.4972048, gradient norm = 0.0001203 (50 iterations in 0.028s)
[t-SNE] Iteration 1000: error = 0.4972610, gradient norm = 0.0001424 (50 iterations in 0.028s)
[t-SNE] KL divergence after 1000 iterations: 0.497261
[t-SNE] Computed conditional probabilities for sample 176 / 176
[t-SNE] Mean sigma: 0.386006
Beginning preprocessing + Leiden
2024-03-12 02:11:44.947209 MEMORY 15.721558016
Affmat transformed
2024-03-12 02:11:44.950060 MEMORY 15.721558016
sources, targets, weights extracted
2024-03-12 02:11:44.951169 MEMORY 15.721558016
About to launch parallel Leiden runs
2024-03-12 02:11:44.968871 MEMORY 15.721558016
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.8s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.4s finished
Parallel Leiden runs finished
2024-03-12 02:11:47.327659 MEMORY 15.721558016
Quality: 0.3116242217908648
Quality: 0.3121065259389119
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 120 out of 167 | elapsed:    0.1s remaining:    0.0s
[Parallel(n_jobs=24)]: Done 167 out of 167 | elapsed:    0.1s finished
Got subclusters: Counter({0: 38, 1: 37, 2: 35, 4: 31, 3: 31, 5: 4})
On pattern 13
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 167 samples in 0.002s...
[t-SNE] Computed neighbors for 167 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 167 / 167
[t-SNE] Mean sigma: 0.407149
[t-SNE] Computed conditional probabilities in 0.013s
[t-SNE] Iteration 50: error = 55.1554146, gradient norm = 0.5464067 (50 iterations in 0.030s)
[t-SNE] Iteration 100: error = 57.2033806, gradient norm = 0.5029894 (50 iterations in 0.028s)
[t-SNE] Iteration 150: error = 56.3671455, gradient norm = 0.5304409 (50 iterations in 0.028s)
[t-SNE] Iteration 200: error = 59.8514214, gradient norm = 0.5036054 (50 iterations in 0.028s)
[t-SNE] Iteration 250: error = 58.4464760, gradient norm = 0.5534180 (50 iterations in 0.028s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 58.446476
[t-SNE] Iteration 300: error = 0.8809851, gradient norm = 0.0063642 (50 iterations in 0.028s)
[t-SNE] Iteration 350: error = 0.5479584, gradient norm = 0.0093940 (50 iterations in 0.031s)
[t-SNE] Iteration 400: error = 0.5028429, gradient norm = 0.0010861 (50 iterations in 0.027s)
[t-SNE] Iteration 450: error = 0.4927053, gradient norm = 0.0002901 (50 iterations in 0.027s)
[t-SNE] Iteration 500: error = 0.4930565, gradient norm = 0.0002665 (50 iterations in 0.027s)
[t-SNE] Iteration 550: error = 0.4928174, gradient norm = 0.0001762 (50 iterations in 0.027s)
[t-SNE] Iteration 600: error = 0.4926262, gradient norm = 0.0003552 (50 iterations in 0.032s)
[t-SNE] Iteration 650: error = 0.4924462, gradient norm = 0.0004239 (50 iterations in 0.027s)
[t-SNE] Iteration 700: error = 0.4922302, gradient norm = 0.0003317 (50 iterations in 0.027s)
[t-SNE] Iteration 750: error = 0.4926026, gradient norm = 0.0003435 (50 iterations in 0.027s)
[t-SNE] Iteration 800: error = 0.4922820, gradient norm = 0.0002886 (50 iterations in 0.027s)
[t-SNE] Iteration 850: error = 0.4924607, gradient norm = 0.0004283 (50 iterations in 0.027s)
[t-SNE] Iteration 900: error = 0.4924159, gradient norm = 0.0004183 (50 iterations in 0.027s)
[t-SNE] Iteration 950: error = 0.4924627, gradient norm = 0.0003651 (50 iterations in 0.027s)
[t-SNE] Iteration 1000: error = 0.4925004, gradient norm = 0.0002501 (50 iterations in 0.027s)
[t-SNE] KL divergence after 1000 iterations: 0.492500
[t-SNE] Computed conditional probabilities for sample 167 / 167
[t-SNE] Mean sigma: 0.407149
Beginning preprocessing + Leiden
2024-03-12 02:11:48.191490 MEMORY 15.721558016
Affmat transformed
2024-03-12 02:11:48.194116 MEMORY 15.721558016
sources, targets, weights extracted
2024-03-12 02:11:48.195173 MEMORY 15.721558016
About to launch parallel Leiden runs
2024-03-12 02:11:48.210901 MEMORY 15.721558016
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.8s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.3s finished
Parallel Leiden runs finished
2024-03-12 02:11:50.513781 MEMORY 15.721558016
Quality: 0.3344446677015499
Quality: 0.33719238610248203
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 154 out of 154 | elapsed:    0.1s finished
Got subclusters: Counter({0: 61, 1: 40, 2: 32, 3: 17, 4: 14, 5: 3})
On pattern 14
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 154 samples in 0.002s...
[t-SNE] Computed neighbors for 154 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 154 / 154
[t-SNE] Mean sigma: 0.406855
[t-SNE] Computed conditional probabilities in 0.012s
[t-SNE] Iteration 50: error = 57.6455460, gradient norm = 0.4850428 (50 iterations in 0.031s)
[t-SNE] Iteration 100: error = 60.0626755, gradient norm = 0.4502839 (50 iterations in 0.027s)
[t-SNE] Iteration 150: error = 57.5488968, gradient norm = 0.4946331 (50 iterations in 0.027s)
[t-SNE] Iteration 200: error = 56.3278847, gradient norm = 0.5502083 (50 iterations in 0.027s)
[t-SNE] Iteration 250: error = 54.4202919, gradient norm = 0.5663313 (50 iterations in 0.028s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 54.420292
[t-SNE] Iteration 300: error = 0.6615626, gradient norm = 0.0098558 (50 iterations in 0.028s)
[t-SNE] Iteration 350: error = 0.4719765, gradient norm = 0.0036074 (50 iterations in 0.028s)
[t-SNE] Iteration 400: error = 0.4660730, gradient norm = 0.0003531 (50 iterations in 0.028s)
[t-SNE] Iteration 450: error = 0.4661757, gradient norm = 0.0002224 (50 iterations in 0.028s)
[t-SNE] Iteration 500: error = 0.4662914, gradient norm = 0.0002295 (50 iterations in 0.028s)
[t-SNE] Iteration 550: error = 0.4664614, gradient norm = 0.0001483 (50 iterations in 0.030s)
[t-SNE] Iteration 600: error = 0.4664719, gradient norm = 0.0002155 (50 iterations in 0.028s)
[t-SNE] Iteration 650: error = 0.4665079, gradient norm = 0.0002871 (50 iterations in 0.028s)
[t-SNE] Iteration 700: error = 0.4663388, gradient norm = 0.0004631 (50 iterations in 0.028s)
[t-SNE] Iteration 750: error = 0.4663371, gradient norm = 0.0002165 (50 iterations in 0.028s)
[t-SNE] Iteration 750: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 750 iterations: 0.466337
[t-SNE] Computed conditional probabilities for sample 154 / 154
[t-SNE] Mean sigma: 0.406855
Beginning preprocessing + Leiden
2024-03-12 02:11:51.210580 MEMORY 15.721558016
Affmat transformed
2024-03-12 02:11:51.212970 MEMORY 15.721558016
sources, targets, weights extracted
2024-03-12 02:11:51.213950 MEMORY 15.721558016
About to launch parallel Leiden runs
2024-03-12 02:11:51.219094 MEMORY 15.721558016
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.8s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.2s finished
Parallel Leiden runs finished
2024-03-12 02:11:53.428497 MEMORY 15.721558016
Quality: 0.3354221848632676
Quality: 0.33630470293437464
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  72 out of 119 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=24)]: Done 119 out of 119 | elapsed:    0.1s finished
Got subclusters: Counter({0: 40, 1: 39, 2: 39, 3: 34, 4: 2})
On pattern 15
[t-SNE] Computing 118 nearest neighbors...
[t-SNE] Indexed 119 samples in 0.001s...
[t-SNE] Computed neighbors for 119 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 119 / 119
[t-SNE] Mean sigma: 0.427349
[t-SNE] Computed conditional probabilities in 0.007s
[t-SNE] Iteration 50: error = 55.1671219, gradient norm = 0.4652259 (50 iterations in 0.024s)
[t-SNE] Iteration 100: error = 54.5943031, gradient norm = 0.4995767 (50 iterations in 0.026s)
[t-SNE] Iteration 150: error = 53.4907990, gradient norm = 0.4866917 (50 iterations in 0.024s)
[t-SNE] Iteration 200: error = 53.8388176, gradient norm = 0.5252150 (50 iterations in 0.024s)
[t-SNE] Iteration 250: error = 54.7982712, gradient norm = 0.5545796 (50 iterations in 0.024s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 54.798271
[t-SNE] Iteration 300: error = 0.7980553, gradient norm = 0.0103179 (50 iterations in 0.024s)
[t-SNE] Iteration 350: error = 0.3452952, gradient norm = 0.0065189 (50 iterations in 0.024s)
[t-SNE] Iteration 400: error = 0.3389396, gradient norm = 0.0006158 (50 iterations in 0.025s)
[t-SNE] Iteration 450: error = 0.3391059, gradient norm = 0.0004008 (50 iterations in 0.028s)
[t-SNE] Iteration 500: error = 0.3393528, gradient norm = 0.0005058 (50 iterations in 0.025s)
[t-SNE] Iteration 550: error = 0.3393677, gradient norm = 0.0004020 (50 iterations in 0.025s)
[t-SNE] Iteration 600: error = 0.3393103, gradient norm = 0.0004156 (50 iterations in 0.025s)
[t-SNE] Iteration 650: error = 0.3392623, gradient norm = 0.0005504 (50 iterations in 0.025s)
[t-SNE] Iteration 700: error = 0.3392614, gradient norm = 0.0004183 (50 iterations in 0.025s)
[t-SNE] Iteration 750: error = 0.3393132, gradient norm = 0.0003641 (50 iterations in 0.025s)
[t-SNE] Iteration 750: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 750 iterations: 0.339313
[t-SNE] Computed conditional probabilities for sample 119 / 119
[t-SNE] Mean sigma: 0.427349
Beginning preprocessing + Leiden
2024-03-12 02:11:54.024433 MEMORY 15.721558016
Affmat transformed
2024-03-12 02:11:54.026216 MEMORY 15.721558016
sources, targets, weights extracted
2024-03-12 02:11:54.027009 MEMORY 15.721558016
About to launch parallel Leiden runs
2024-03-12 02:11:54.048272 MEMORY 15.721558016
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.1s finished
Parallel Leiden runs finished
2024-03-12 02:11:56.107941 MEMORY 15.721558016
Quality: 0.27189708298136733
Quality: 0.2719292755827118
Quality: 0.2722441756012442
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  95 out of  95 | elapsed:    0.0s finished
Got subclusters: Counter({0: 47, 1: 37, 2: 35})
On pattern 16
[t-SNE] Computing 94 nearest neighbors...
[t-SNE] Indexed 95 samples in 0.001s...
[t-SNE] Computed neighbors for 95 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 95 / 95
[t-SNE] Mean sigma: 0.510116
[t-SNE] Computed conditional probabilities in 0.004s
[t-SNE] Iteration 50: error = 51.0549469, gradient norm = 0.5710000 (50 iterations in 0.023s)
[t-SNE] Iteration 100: error = 50.0785828, gradient norm = 0.5454538 (50 iterations in 0.020s)
[t-SNE] Iteration 150: error = 53.3428955, gradient norm = 0.4965875 (50 iterations in 0.020s)
[t-SNE] Iteration 200: error = 51.0197983, gradient norm = 0.5115564 (50 iterations in 0.020s)
[t-SNE] Iteration 250: error = 53.9422989, gradient norm = 0.5555227 (50 iterations in 0.020s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 53.942299
[t-SNE] Iteration 300: error = 0.9593546, gradient norm = 0.0045999 (50 iterations in 0.020s)
[t-SNE] Iteration 350: error = 0.6927067, gradient norm = 0.0051451 (50 iterations in 0.020s)
[t-SNE] Iteration 400: error = 0.5310994, gradient norm = 0.0050702 (50 iterations in 0.020s)
[t-SNE] Iteration 450: error = 0.4630883, gradient norm = 0.0036759 (50 iterations in 0.020s)
[t-SNE] Iteration 500: error = 0.2709772, gradient norm = 0.0169506 (50 iterations in 0.020s)
[t-SNE] Iteration 550: error = 0.2567689, gradient norm = 0.0153747 (50 iterations in 0.020s)
[t-SNE] Iteration 600: error = 0.2561628, gradient norm = 0.0129869 (50 iterations in 0.020s)
[t-SNE] Iteration 650: error = 0.2474432, gradient norm = 0.0031563 (50 iterations in 0.020s)
[t-SNE] Iteration 700: error = 0.2472864, gradient norm = 0.0008300 (50 iterations in 0.020s)
[t-SNE] Iteration 750: error = 0.2472935, gradient norm = 0.0009661 (50 iterations in 0.020s)
[t-SNE] Iteration 800: error = 0.2472835, gradient norm = 0.0005093 (50 iterations in 0.020s)
[t-SNE] Iteration 850: error = 0.2473319, gradient norm = 0.0010601 (50 iterations in 0.020s)
[t-SNE] Iteration 900: error = 0.2474677, gradient norm = 0.0007003 (50 iterations in 0.020s)
[t-SNE] Iteration 950: error = 0.2474495, gradient norm = 0.0006380 (50 iterations in 0.020s)
[t-SNE] Iteration 1000: error = 0.2472010, gradient norm = 0.0007891 (50 iterations in 0.020s)
[t-SNE] KL divergence after 1000 iterations: 0.247201
[t-SNE] Computed conditional probabilities for sample 95 / 95
[t-SNE] Mean sigma: 0.510116
Beginning preprocessing + Leiden
2024-03-12 02:11:56.655936 MEMORY 15.721558016
Affmat transformed
2024-03-12 02:11:56.657313 MEMORY 15.721558016
sources, targets, weights extracted
2024-03-12 02:11:56.657932 MEMORY 15.721558016
About to launch parallel Leiden runs
2024-03-12 02:11:56.713087 MEMORY 15.721558016
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.0s finished
Parallel Leiden runs finished
2024-03-12 02:11:58.702542 MEMORY 15.721558016
Quality: 0.24571185856383046
Quality: 0.2501284435597118
Got subclusters: Counter({0: 30, 1: 24, 2: 23, 3: 18})
On metacluster 0
Metacluster size 91456 limited to 20000
Relevant tasks:  ('head', 'testis')
Relevant signs:  (1, 1)
TfModiscoSeqletsToPatternsFactory: seed=1234
(Round 1) num seqlets: 20000
(Round 1) Computing coarse affmat
2024-03-12 02:12:01.950674 MEMORY 15.720513536
Beginning embedding computation
MEMORY 15.720513536
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 152 tasks      | elapsed:    2.3s
[Parallel(n_jobs=24)]: Done 402 tasks      | elapsed:    5.7s
[Parallel(n_jobs=24)]: Done 752 tasks      | elapsed:   10.4s
[Parallel(n_jobs=24)]: Done 1202 tasks      | elapsed:   16.6s
[Parallel(n_jobs=24)]: Done 1752 tasks      | elapsed:   24.0s
[Parallel(n_jobs=24)]: Done 2402 tasks      | elapsed:   32.8s
[Parallel(n_jobs=24)]: Done 3152 tasks      | elapsed:   42.8s
[Parallel(n_jobs=24)]: Done 4002 tasks      | elapsed:   54.1s
[Parallel(n_jobs=24)]: Done 4952 tasks      | elapsed:  1.1min
[Parallel(n_jobs=24)]: Done 6002 tasks      | elapsed:  1.4min
[Parallel(n_jobs=24)]: Done 7152 tasks      | elapsed:  1.6min
[Parallel(n_jobs=24)]: Done 8402 tasks      | elapsed:  1.9min
[Parallel(n_jobs=24)]: Done 9752 tasks      | elapsed:  2.2min
[Parallel(n_jobs=24)]: Done 11202 tasks      | elapsed:  2.5min
[Parallel(n_jobs=24)]: Done 12752 tasks      | elapsed:  2.9min
[Parallel(n_jobs=24)]: Done 14402 tasks      | elapsed:  3.2min
[Parallel(n_jobs=24)]: Done 16152 tasks      | elapsed:  3.6min
[Parallel(n_jobs=24)]: Done 18002 tasks      | elapsed:  4.0min
[Parallel(n_jobs=24)]: Done 19952 tasks      | elapsed:  4.5min
[Parallel(n_jobs=24)]: Done 20000 out of 20000 | elapsed:  4.5min finished
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 152 tasks      | elapsed:    2.3s
[Parallel(n_jobs=24)]: Done 402 tasks      | elapsed:    5.7s
[Parallel(n_jobs=24)]: Done 752 tasks      | elapsed:   10.4s
[Parallel(n_jobs=24)]: Done 1202 tasks      | elapsed:   16.6s
[Parallel(n_jobs=24)]: Done 1752 tasks      | elapsed:   24.1s
[Parallel(n_jobs=24)]: Done 2402 tasks      | elapsed:   32.9s
[Parallel(n_jobs=24)]: Done 3152 tasks      | elapsed:   42.9s
[Parallel(n_jobs=24)]: Done 4002 tasks      | elapsed:   54.5s
[Parallel(n_jobs=24)]: Done 4952 tasks      | elapsed:  1.1min
[Parallel(n_jobs=24)]: Done 6002 tasks      | elapsed:  1.4min
[Parallel(n_jobs=24)]: Done 7152 tasks      | elapsed:  1.6min
[Parallel(n_jobs=24)]: Done 8402 tasks      | elapsed:  1.9min
[Parallel(n_jobs=24)]: Done 9752 tasks      | elapsed:  2.2min
[Parallel(n_jobs=24)]: Done 11202 tasks      | elapsed:  2.5min
[Parallel(n_jobs=24)]: Done 12752 tasks      | elapsed:  2.9min
[Parallel(n_jobs=24)]: Done 14402 tasks      | elapsed:  3.2min
[Parallel(n_jobs=24)]: Done 16152 tasks      | elapsed:  3.6min
[Parallel(n_jobs=24)]: Done 18002 tasks      | elapsed:  4.0min
[Parallel(n_jobs=24)]: Done 19952 tasks      | elapsed:  4.5min
[Parallel(n_jobs=24)]: Done 20000 out of 20000 | elapsed:  4.5min finished
At the beginning of embedding call
2024-03-12 02:12:01.950966 MEMORY 15.720513536
before computing embeddings fwd
2024-03-12 02:12:01.961345 MEMORY 15.720513536
after computing embeddings fwd
2024-03-12 02:16:31.067958 MEMORY 15.720513536
after computing embeddings rev
2024-03-12 02:20:59.443939 MEMORY 16.234156032
before computing sparse embeddings fwd
2024-03-12 02:20:59.444161 MEMORY 16.234156032
Constructing csr matrix...
csr matrix made in 2.9687564373016357 s
after computing sparse embeddings fwd
2024-03-12 02:21:03.451192 MEMORY 16.314273792
before computing sparse embeddings rev
2024-03-12 02:21:03.451348 MEMORY 16.314273792
Constructing csr matrix...
csr matrix made in 3.0630321502685547 s
after computing sparse embeddings rev
2024-03-12 02:21:07.505994 MEMORY 16.434540544
Finished embedding computation in 548.22 s
MEMORY 15.922311168
Starting affinity matrix computations
MEMORY 15.92178688
Batching in slices of size 3355
  0%|          | 0/6 [00:00<?, ?it/s] 17%|â–ˆâ–‹        | 1/6 [00:08<00:44,  8.82s/it] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 2/6 [00:17<00:35,  8.98s/it] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 3/6 [00:26<00:26,  8.98s/it] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 4/6 [00:35<00:17,  8.92s/it] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 5/6 [00:44<00:08,  8.90s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:53<00:00,  8.75s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:53<00:00,  8.84s/it]
Finished affinity matrix computations in 53.23 s
MEMORY 15.92178688
(Round 1) Computed coarse affmat
2024-03-12 02:22:05.088112 MEMORY 15.721254912
(Round 1) Computing affinity matrix on nearest neighbors
2024-03-12 02:22:05.088320 MEMORY 15.721254912
Launching nearest neighbors affmat calculation job
MEMORY 15.803019264
Parallel runs completed
MEMORY 15.881252864
Job completed in: 79.15 s
MEMORY 15.881056256
Launching nearest neighbors affmat calculation job
MEMORY 15.880851456
Parallel runs completed
MEMORY 15.979237376
Job completed in: 80.09 s
MEMORY 15.977254912
(Round 1) Computed affinity matrix on nearest neighbors in 167.08 s
2024-03-12 02:24:52.173844 MEMORY 15.89518336
Filtered down to 18709 of 20000
(Round 1) Retained 18709 rows out of 20000 after filtering
2024-03-12 02:25:05.068571 MEMORY 15.895384064
(Round 1) Computing density adapted affmat
2024-03-12 02:25:10.951615 MEMORY 15.895384064
Symmetrizing nearest neighbors
Computing betas for density adaptation
Computing normalizing denominators
(Round 1) Computing clustering
2024-03-12 02:28:16.119290 MEMORY 15.949729792
Beginning preprocessing + Leiden
2024-03-12 02:28:16.149363 MEMORY 15.949795328
Affmat transformed
2024-03-12 02:28:16.149624 MEMORY 15.949795328
sources, targets, weights extracted
2024-03-12 02:28:16.807283 MEMORY 15.949848576
About to launch parallel Leiden runs
2024-03-12 02:28:16.993740 MEMORY 15.94990592
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:  2.3min
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:  9.1min finished
Parallel Leiden runs finished
2024-03-12 02:37:24.222961 MEMORY 15.950065664
Quality: 0.4313386260215354
Quality: 0.4313394408674708
Got 8 clusters after round 1
Counts:
{2: 2548, 4: 2208, 3: 2483, 5: 2208, 1: 2849, 6: 1844, 0: 3995, 7: 574}
2024-03-12 02:37:24.272312 MEMORY 15.795298304
(Round 1) Aggregating seqlets in each cluster
2024-03-12 02:37:24.272464 MEMORY 15.795298304
Aggregating for cluster 0 with 3995 seqlets
2024-03-12 02:37:24.283793 MEMORY 15.795318784
Skipped 10 due to duplicates
Trimming eliminated 0 seqlets out of 3985
Aggregating for cluster 1 with 2849 seqlets
2024-03-12 02:37:36.685500 MEMORY 15.79538432
Skipped 13 due to duplicates
Trimming eliminated 0 seqlets out of 2836
Aggregating for cluster 2 with 2548 seqlets
2024-03-12 02:37:46.894055 MEMORY 15.79538432
Skipped 37 due to duplicates
Trimming eliminated 0 seqlets out of 2511
Aggregating for cluster 3 with 2483 seqlets
2024-03-12 02:37:56.469759 MEMORY 15.795503104
Removed 2 duplicate seqlets
Skipped 25 due to duplicates
Trimming eliminated 0 seqlets out of 2456
Aggregating for cluster 4 with 2208 seqlets
2024-03-12 02:38:03.821678 MEMORY 15.795503104
Skipped 16 due to duplicates
Trimming eliminated 0 seqlets out of 2192
Aggregating for cluster 5 with 2208 seqlets
2024-03-12 02:38:10.994879 MEMORY 15.795503104
Removed 1 duplicate seqlets
Skipped 18 due to duplicates
Trimming eliminated 0 seqlets out of 2189
Removed 1 duplicate seqlets
Aggregating for cluster 6 with 1844 seqlets
2024-03-12 02:38:18.695828 MEMORY 15.795503104
Removed 1 duplicate seqlets
Skipped 9 due to duplicates
Trimming eliminated 0 seqlets out of 1834
Aggregating for cluster 7 with 574 seqlets
2024-03-12 02:38:24.359224 MEMORY 15.795503104
Removed 1 duplicate seqlets
Skipped 8 due to duplicates
Trimming eliminated 0 seqlets out of 565
Dropping cluster 7 with 565 seqlets due to sign disagreement
(Round 2) num seqlets: 17992
(Round 2) Computing coarse affmat
2024-03-12 02:38:28.150841 MEMORY 15.795503104
Beginning embedding computation
MEMORY 15.795503104
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 272 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done 1272 tasks      | elapsed:    2.3s
[Parallel(n_jobs=24)]: Done 2672 tasks      | elapsed:    4.5s
[Parallel(n_jobs=24)]: Done 4472 tasks      | elapsed:    7.2s
[Parallel(n_jobs=24)]: Done 6672 tasks      | elapsed:   10.6s
[Parallel(n_jobs=24)]: Done 9272 tasks      | elapsed:   14.9s
[Parallel(n_jobs=24)]: Done 12272 tasks      | elapsed:   19.5s
[Parallel(n_jobs=24)]: Done 15672 tasks      | elapsed:   24.5s
[Parallel(n_jobs=24)]: Done 17992 out of 17992 | elapsed:   28.0s finished
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 256 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done 1248 tasks      | elapsed:    2.3s
[Parallel(n_jobs=24)]: Done 4048 tasks      | elapsed:    5.3s
[Parallel(n_jobs=24)]: Done 7648 tasks      | elapsed:    9.3s
[Parallel(n_jobs=24)]: Done 12048 tasks      | elapsed:   14.0s
[Parallel(n_jobs=24)]: Done 17248 tasks      | elapsed:   19.8s
[Parallel(n_jobs=24)]: Done 17992 out of 17992 | elapsed:   20.9s finished
At the beginning of embedding call
2024-03-12 02:38:28.151144 MEMORY 15.795503104
before computing embeddings fwd
2024-03-12 02:38:28.161820 MEMORY 15.7955072
after computing embeddings fwd
2024-03-12 02:38:56.213864 MEMORY 16.0656384
after computing embeddings rev
2024-03-12 02:39:17.110143 MEMORY 16.657739776
before computing sparse embeddings fwd
2024-03-12 02:39:17.110294 MEMORY 16.657739776
Constructing csr matrix...
csr matrix made in 2.4605789184570312 s
after computing sparse embeddings fwd
2024-03-12 02:39:20.492584 MEMORY 16.766017536
before computing sparse embeddings rev
2024-03-12 02:39:20.493330 MEMORY 16.766017536
Constructing csr matrix...
csr matrix made in 2.376204013824463 s
after computing sparse embeddings rev
2024-03-12 02:39:23.829079 MEMORY 16.87422976
Finished embedding computation in 60.6 s
MEMORY 16.281526272
Starting affinity matrix computations
MEMORY 16.281001984
Batching in slices of size 3729
  0%|          | 0/5 [00:00<?, ?it/s] 20%|â–ˆâ–ˆ        | 1/5 [00:10<00:42, 10.53s/it] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [00:20<00:31, 10.45s/it] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [00:32<00:21, 10.81s/it] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [00:43<00:10, 10.87s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [00:50<00:00,  9.78s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [00:50<00:00, 10.19s/it]
Finished affinity matrix computations in 51.08 s
MEMORY 16.281194496
(Round 2) Computed coarse affmat
2024-03-12 02:40:22.321564 MEMORY 16.065024
(Round 2) Computing affinity matrix on nearest neighbors
2024-03-12 02:40:22.321767 MEMORY 16.065024
Launching nearest neighbors affmat calculation job
MEMORY 16.065024
Parallel runs completed
MEMORY 16.112406528
Job completed in: 40.7 s
MEMORY 16.110112768
Launching nearest neighbors affmat calculation job
MEMORY 16.109965312
Parallel runs completed
MEMORY 16.114454528
Job completed in: 42.23 s
MEMORY 16.112111616
(Round 2) Computed affinity matrix on nearest neighbors in 89.97 s
2024-03-12 02:41:52.300616 MEMORY 16.109965312
Not applying filtering for rounds above first round
2024-03-12 02:41:52.303095 MEMORY 16.109965312
(Round 2) Computing density adapted affmat
2024-03-12 02:41:58.143346 MEMORY 16.109981696
Symmetrizing nearest neighbors
Computing betas for density adaptation
Computing normalizing denominators
(Round 2) Computing clustering
2024-03-12 02:44:44.907076 MEMORY 16.268812288
Beginning preprocessing + Leiden
2024-03-12 02:44:44.936998 MEMORY 16.268812288
Affmat transformed
2024-03-12 02:44:44.937245 MEMORY 16.268812288
sources, targets, weights extracted
2024-03-12 02:44:45.645421 MEMORY 16.424071168
About to launch parallel Leiden runs
2024-03-12 02:44:45.825239 MEMORY 16.268804096
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:  1.6min
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:  4.9min finished
Parallel Leiden runs finished
2024-03-12 02:49:38.898942 MEMORY 16.268804096
Quality: 0.5534352132019976
Quality: 0.5534355338323554
Quality: 0.5534373041998901
Quality: 0.5534373642008835
Got 7 clusters after round 2
Counts:
{2: 2547, 0: 3870, 6: 1961, 1: 2619, 3: 2370, 5: 2266, 4: 2359}
2024-03-12 02:49:38.941042 MEMORY 16.113545216
(Round 2) Aggregating seqlets in each cluster
2024-03-12 02:49:38.941205 MEMORY 16.113545216
Aggregating for cluster 0 with 3870 seqlets
2024-03-12 02:49:38.948773 MEMORY 16.113545216
Skipped 9 due to duplicates
Trimming eliminated 0 seqlets out of 3861
Aggregating for cluster 1 with 2619 seqlets
2024-03-12 02:49:47.381850 MEMORY 16.113573888
Skipped 26 due to duplicates
Trimming eliminated 0 seqlets out of 2593
Aggregating for cluster 2 with 2547 seqlets
2024-03-12 02:49:53.272748 MEMORY 16.113573888
Removed 1 duplicate seqlets
Skipped 32 due to duplicates
Trimming eliminated 0 seqlets out of 2514
Removed 1 duplicate seqlets
Aggregating for cluster 3 with 2370 seqlets
2024-03-12 02:49:59.314344 MEMORY 16.113573888
Removed 1 duplicate seqlets
Skipped 8 due to duplicates
Trimming eliminated 0 seqlets out of 2361
Aggregating for cluster 4 with 2359 seqlets
2024-03-12 02:50:04.741719 MEMORY 16.113573888
Skipped 5 due to duplicates
Trimming eliminated 0 seqlets out of 2354
Aggregating for cluster 5 with 2266 seqlets
2024-03-12 02:50:11.888518 MEMORY 16.11358208
Skipped 14 due to duplicates
Trimming eliminated 0 seqlets out of 2252
Aggregating for cluster 6 with 1961 seqlets
2024-03-12 02:50:17.020359 MEMORY 16.11358208
Skipped 5 due to duplicates
Trimming eliminated 0 seqlets out of 1956
Got 7 clusters
Splitting into subclusters...
2024-03-12 02:50:21.405471 MEMORY 16.11358208
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.5s
[Parallel(n_jobs=24)]: Done 3645 tasks      | elapsed:    3.1s
[Parallel(n_jobs=24)]: Done 3861 out of 3861 | elapsed:    3.2s finished
Inspecting pattern 0 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 3861
[t-SNE] Computed conditional probabilities for sample 2000 / 3861
[t-SNE] Computed conditional probabilities for sample 3000 / 3861
[t-SNE] Computed conditional probabilities for sample 3861 / 3861
[t-SNE] Mean sigma: 0.282880
Beginning preprocessing + Leiden
2024-03-12 02:50:28.971118 MEMORY 16.122810368
Affmat transformed
2024-03-12 02:50:29.026286 MEMORY 16.13047808
sources, targets, weights extracted
2024-03-12 02:50:29.065295 MEMORY 16.13047808
About to launch parallel Leiden runs
2024-03-12 02:50:29.092778 MEMORY 16.130490368
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:   15.0s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   52.4s finished
Parallel Leiden runs finished
2024-03-12 02:51:21.486974 MEMORY 16.130490368
Quality: 0.5142295816727072
Quality: 0.5145363568093411
Quality: 0.5147057572050853
Quality: 0.514868886007729
Quality: 0.5149229229478112
Quality: 0.5149533657205262
Got subclusters: Counter({0: 633, 1: 533, 2: 515, 3: 464, 4: 444, 5: 413, 6: 397, 7: 363, 8: 55, 9: 35, 10: 9})
On merging iteration 1
Numbers for each pattern pre-subsample: [633, 533, 515, 464, 444, 413, 397, 363, 55, 35, 9]
Numbers after subsampling: [300, 300, 300, 300, 300, 300, 300, 300, 55, 35, 9]
Computing sims for pattern 0
Computed sims for pattern 0 in 4.043471574783325 s
Computing sims for pattern 1
Computed sims for pattern 1 in 4.244994163513184 s
Computing sims for pattern 2
Computed sims for pattern 2 in 4.573787450790405 s
Computing sims for pattern 3
Computed sims for pattern 3 in 4.241664171218872 s
Computing sims for pattern 4
Computed sims for pattern 4 in 4.248422861099243 s
Computing sims for pattern 5
Computed sims for pattern 5 in 4.454563140869141 s
Computing sims for pattern 6
Computed sims for pattern 6 in 4.213418006896973 s
Computing sims for pattern 7
Computed sims for pattern 7 in 4.155960321426392 s
Computing sims for pattern 8
Computed sims for pattern 8 in 1.243236780166626 s
Computing sims for pattern 9
Computed sims for pattern 9 in 0.9361052513122559 s
Computing sims for pattern 10
Computed sims for pattern 10 in 0.5519828796386719 s
Cluster sizes
[633 533 515 464 444 413 397 363  55  35   9]
Cross-contamination matrix:
[[1.   0.59 0.83 0.62 0.76 0.57 0.72 0.83 0.66 0.57 0.05]
 [0.82 1.   0.72 0.45 0.81 0.75 0.45 0.87 0.71 0.62 0.09]
 [0.68 0.38 1.   0.41 0.76 0.37 0.7  0.83 0.54 0.43 0.04]
 [0.88 0.64 0.75 1.   0.72 0.73 0.82 0.75 0.73 0.56 0.1 ]
 [0.69 0.52 0.85 0.45 1.   0.47 0.65 0.9  0.55 0.48 0.05]
 [0.8  0.74 0.71 0.7  0.73 1.   0.52 0.8  0.7  0.7  0.08]
 [0.77 0.38 0.92 0.63 0.76 0.4  1.   0.74 0.55 0.43 0.08]
 [0.59 0.42 0.65 0.23 0.71 0.38 0.29 1.   0.37 0.48 0.01]
 [0.5  0.35 0.48 0.34 0.44 0.34 0.35 0.56 1.   0.3  0.03]
 [0.58 0.46 0.57 0.41 0.55 0.52 0.35 0.7  0.35 1.   0.11]
 [0.18 0.13 0.17 0.14 0.14 0.16 0.14 0.14 0.15 0.14 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.79 0.82 0.82 0.8  0.79 0.8  0.78 0.71 0.8  0.47]
 [0.79 1.   0.68 0.78 0.73 0.8  0.61 0.72 0.7  0.75 0.31]
 [0.82 0.68 1.   0.7  0.87 0.69 0.91 0.86 0.79 0.72 0.43]
 [0.82 0.78 0.7  1.   0.65 0.85 0.79 0.63 0.78 0.65 0.38]
 [0.8  0.73 0.87 0.65 1.   0.69 0.78 0.85 0.68 0.73 0.36]
 [0.79 0.8  0.69 0.85 0.69 1.   0.66 0.66 0.73 0.75 0.36]
 [0.8  0.61 0.91 0.79 0.78 0.66 1.   0.75 0.76 0.66 0.44]
 [0.78 0.72 0.86 0.63 0.85 0.66 0.75 1.   0.71 0.79 0.33]
 [0.71 0.7  0.79 0.78 0.68 0.73 0.76 0.71 1.   0.62 0.37]
 [0.8  0.75 0.72 0.65 0.73 0.75 0.66 0.79 0.62 1.   0.35]
 [0.47 0.31 0.43 0.38 0.36 0.36 0.44 0.33 0.37 0.35 1.  ]]
Collapsing 2 & 6 with crosscontam 0.7038113649382716 and sim 0.9130809801537605
Collapsing 2 & 4 with crosscontam 0.7600842350617283 and sim 0.8717675343025371
Collapsing 2 & 7 with crosscontam 0.6542699538271606 and sim 0.8644297717294616
Collapsing 4 & 7 with crosscontam 0.7127081170370371 and sim 0.8542022211188013
Trimming eliminated 0 seqlets out of 912
Trimming eliminated 0 seqlets out of 1356
Skipped 8 due to duplicates
Trimming eliminated 0 seqlets out of 1711
Unmerged patterns remapping: OrderedDict([(0, 1), (1, 2), (3, 3), (5, 4), (8, 5), (9, 6), (10, 7)])
Time spent on merging iteration: 10.384114742279053
On merging iteration 2
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 2370 tasks      | elapsed:    1.3s
[Parallel(n_jobs=24)]: Done 2593 out of 2593 | elapsed:    1.4s finished
Numbers for each pattern pre-subsample: [1711, 633, 533, 464, 413, 55, 35, 9]
Numbers after subsampling: [300, 300, 300, 300, 300, 55, 35, 9]
Computing sims for pattern 0
Computed sims for pattern 0 in 2.8024842739105225 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.4575212001800537 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.4656848907470703 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.46546268463134766 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.46025705337524414 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.14369893074035645 s
Computing sims for pattern 6
Computed sims for pattern 6 in 0.10293221473693848 s
Computing sims for pattern 7
Computed sims for pattern 7 in 0.06668853759765625 s
Cluster sizes
[1711  633  533  464  413   55   35    9]
Cross-contamination matrix:
[[1.   0.91 0.64 0.71 0.65 0.81 0.68 0.17]
 [0.69 1.   0.59 0.62 0.57 0.66 0.57 0.05]
 [0.58 0.82 1.   0.45 0.75 0.71 0.62 0.09]
 [0.68 0.88 0.64 1.   0.73 0.73 0.56 0.1 ]
 [0.57 0.8  0.74 0.7  1.   0.7  0.7  0.08]
 [0.42 0.5  0.35 0.34 0.34 1.   0.3  0.03]
 [0.5  0.58 0.46 0.41 0.52 0.35 1.   0.11]
 [0.15 0.18 0.13 0.14 0.16 0.15 0.14 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.82 0.68 0.75 0.7  0.81 0.71 0.44]
 [0.82 1.   0.79 0.82 0.79 0.71 0.8  0.47]
 [0.68 0.79 1.   0.78 0.8  0.7  0.75 0.31]
 [0.75 0.82 0.78 1.   0.85 0.78 0.65 0.38]
 [0.7  0.79 0.8  0.85 1.   0.73 0.75 0.36]
 [0.81 0.71 0.7  0.78 0.73 1.   0.62 0.37]
 [0.71 0.8  0.75 0.65 0.75 0.62 1.   0.35]
 [0.44 0.47 0.31 0.38 0.36 0.37 0.35 1.  ]]
Inspecting pattern 1 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 2593
[t-SNE] Computed conditional probabilities for sample 2000 / 2593
[t-SNE] Computed conditional probabilities for sample 2593 / 2593
[t-SNE] Mean sigma: 0.302396
Beginning preprocessing + Leiden
2024-03-12 02:52:19.155866 MEMORY 16.130899968
Affmat transformed
2024-03-12 02:52:19.189640 MEMORY 16.130899968
sources, targets, weights extracted
2024-03-12 02:52:19.214240 MEMORY 16.130899968
About to launch parallel Leiden runs
2024-03-12 02:52:19.226954 MEMORY 16.130899968
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    7.8s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   25.5s finished
Parallel Leiden runs finished
2024-03-12 02:52:44.684482 MEMORY 16.130899968
Quality: 0.534359355136004
Quality: 0.5347655382377849
Quality: 0.5347821910705693
Quality: 0.5348603147954903
Quality: 0.5348606895259548
Quality: 0.534932433459272
Quality: 0.5352929800536521
Got subclusters: Counter({0: 443, 1: 391, 2: 359, 3: 335, 4: 326, 5: 303, 6: 251, 7: 119, 8: 66})
On merging iteration 1
Numbers for each pattern pre-subsample: [443, 391, 359, 335, 326, 303, 251, 119, 66]
Numbers after subsampling: [300, 300, 300, 300, 300, 300, 251, 119, 66]
Computing sims for pattern 0
Computed sims for pattern 0 in 3.2573747634887695 s
Computing sims for pattern 1
Computed sims for pattern 1 in 3.330413818359375 s
Computing sims for pattern 2
Computed sims for pattern 2 in 3.341550827026367 s
Computing sims for pattern 3
Computed sims for pattern 3 in 3.3679373264312744 s
Computing sims for pattern 4
Computed sims for pattern 4 in 3.369152545928955 s
Computing sims for pattern 5
Computed sims for pattern 5 in 3.3772318363189697 s
Computing sims for pattern 6
Computed sims for pattern 6 in 2.630286455154419 s
Computing sims for pattern 7
Computed sims for pattern 7 in 1.691070318222046 s
Computing sims for pattern 8
Computed sims for pattern 8 in 1.2140376567840576 s
Cluster sizes
[443 391 359 335 326 303 251 119  66]
Cross-contamination matrix:
[[1.   0.9  0.58 0.54 0.77 0.73 0.66 0.51 0.18]
 [0.47 1.   0.4  0.44 0.65 0.56 0.3  0.28 0.11]
 [0.72 0.94 1.   0.55 0.72 0.68 0.62 0.58 0.21]
 [0.66 0.97 0.53 1.   0.71 0.79 0.22 0.45 0.28]
 [0.65 0.99 0.49 0.5  1.   0.75 0.38 0.42 0.16]
 [0.62 0.89 0.46 0.56 0.76 1.   0.3  0.36 0.18]
 [0.7  0.66 0.49 0.16 0.46 0.36 1.   0.35 0.11]
 [0.68 0.77 0.57 0.47 0.66 0.58 0.44 1.   0.11]
 [0.72 0.9  0.64 0.77 0.75 0.8  0.48 0.47 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.82 0.84 0.76 0.87 0.86 0.82 0.85 0.69]
 [0.82 1.   0.83 0.84 0.91 0.88 0.68 0.71 0.71]
 [0.84 0.83 1.   0.69 0.79 0.77 0.77 0.68 0.67]
 [0.76 0.84 0.69 1.   0.75 0.87 0.59 0.75 0.72]
 [0.87 0.91 0.79 0.75 1.   0.9  0.72 0.75 0.69]
 [0.86 0.88 0.77 0.87 0.9  1.   0.61 0.78 0.8 ]
 [0.82 0.68 0.77 0.59 0.72 0.61 1.   0.67 0.49]
 [0.85 0.71 0.68 0.75 0.75 0.78 0.67 1.   0.54]
 [0.69 0.71 0.67 0.72 0.69 0.8  0.49 0.54 1.  ]]
Collapsing 1 & 4 with crosscontam 0.6531366414814812 and sim 0.9117633165849299
Collapsing 4 & 5 with crosscontam 0.7512994429629629 and sim 0.9021104855563893
Collapsing 1 & 5 with crosscontam 0.5570902108641973 and sim 0.876303772526052
Collapsing 0 & 4 with crosscontam 0.6544979496296297 and sim 0.8721156526890175
Collapsing 3 & 5 with crosscontam 0.5638461120987655 and sim 0.8676421938406101
Collapsing 0 & 5 with crosscontam 0.6217227293827161 and sim 0.860426594851521
Collapsing 0 & 7 with crosscontam 0.5122302172424527 and sim 0.854341198071003
Skipped 3 due to duplicates
Trimming eliminated 0 seqlets out of 714
Trimming eliminated 0 seqlets out of 1017
Removed 1 duplicate seqlets
Trimming eliminated 0 seqlets out of 1459
Trimming eliminated 0 seqlets out of 1794
Trimming eliminated 0 seqlets out of 1913
Unmerged patterns remapping: OrderedDict([(2, 1), (6, 2), (8, 3)])
Time spent on merging iteration: 15.969102621078491
On merging iteration 2
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 2310 tasks      | elapsed:    1.2s
[Parallel(n_jobs=24)]: Done 2513 out of 2513 | elapsed:    1.3s finished
Numbers for each pattern pre-subsample: [1913, 359, 251, 66]
Numbers after subsampling: [300, 300, 251, 66]
Computing sims for pattern 0
Computed sims for pattern 0 in 1.2170085906982422 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.44765782356262207 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.3476386070251465 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.15915656089782715 s
Cluster sizes
[1913  359  251   66]
Cross-contamination matrix:
[[1.   0.74 0.62 0.32]
 [0.74 1.   0.62 0.21]
 [0.47 0.49 1.   0.11]
 [0.78 0.64 0.48 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.84 0.68 0.76]
 [0.84 1.   0.77 0.67]
 [0.68 0.77 1.   0.49]
 [0.76 0.67 0.49 1.  ]]
Inspecting pattern 2 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 2513
[t-SNE] Computed conditional probabilities for sample 2000 / 2513
[t-SNE] Computed conditional probabilities for sample 2513 / 2513
[t-SNE] Mean sigma: 0.295092
Beginning preprocessing + Leiden
2024-03-12 02:53:32.397724 MEMORY 16.130899968
Affmat transformed
2024-03-12 02:53:32.431821 MEMORY 16.130899968
sources, targets, weights extracted
2024-03-12 02:53:32.455663 MEMORY 16.130899968
About to launch parallel Leiden runs
2024-03-12 02:53:32.468498 MEMORY 16.130879488
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:   10.4s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   37.2s finished
Parallel Leiden runs finished
2024-03-12 02:54:09.659474 MEMORY 16.130879488
Quality: 0.45540227653249743
Got subclusters: Counter({0: 340, 1: 312, 2: 301, 3: 298, 4: 288, 5: 246, 6: 233, 7: 209, 8: 203, 9: 44, 10: 39})
On merging iteration 1
Numbers for each pattern pre-subsample: [340, 312, 301, 298, 288, 246, 233, 209, 203, 44, 39]
Numbers after subsampling: [300, 300, 300, 298, 288, 246, 233, 209, 203, 44, 39]
Computing sims for pattern 0
Computed sims for pattern 0 in 4.00270938873291 s
Computing sims for pattern 1
Computed sims for pattern 1 in 4.087778329849243 s
Computing sims for pattern 2
Computed sims for pattern 2 in 4.1196677684783936 s
Computing sims for pattern 3
Computed sims for pattern 3 in 4.07578444480896 s
Computing sims for pattern 4
Computed sims for pattern 4 in 3.896285057067871 s
Computing sims for pattern 5
Computed sims for pattern 5 in 3.1346194744110107 s
Computing sims for pattern 6
Computed sims for pattern 6 in 3.7659683227539062 s
Computing sims for pattern 7
Computed sims for pattern 7 in 3.302339792251587 s
Computing sims for pattern 8
Computed sims for pattern 8 in 5.403089284896851 s
Computing sims for pattern 9
Computed sims for pattern 9 in 1.0388503074645996 s
Computing sims for pattern 10
Computed sims for pattern 10 in 0.9664411544799805 s
Cluster sizes
[340 312 301 298 288 246 233 209 203  44  39]
Cross-contamination matrix:
[[1.   0.36 0.68 0.45 0.47 0.54 0.4  0.44 0.56 0.1  0.46]
 [0.97 1.   0.98 0.76 0.82 0.79 0.71 0.67 0.81 0.5  0.64]
 [0.85 0.44 1.   0.52 0.5  0.6  0.52 0.42 0.63 0.17 0.44]
 [0.9  0.59 0.86 1.   0.69 0.87 0.62 0.69 0.75 0.4  0.51]
 [0.97 0.65 0.87 0.7  1.   0.78 0.61 0.61 0.66 0.38 0.71]
 [0.91 0.53 0.85 0.78 0.67 1.   0.59 0.62 0.62 0.32 0.52]
 [0.94 0.61 0.99 0.7  0.68 0.75 1.   0.55 0.76 0.39 0.47]
 [0.98 0.56 0.8  0.75 0.64 0.77 0.53 1.   0.78 0.35 0.5 ]
 [0.98 0.59 0.92 0.7  0.59 0.65 0.63 0.68 1.   0.23 0.51]
 [0.44 0.49 0.58 0.56 0.5  0.53 0.47 0.43 0.36 1.   0.42]
 [0.55 0.25 0.42 0.26 0.37 0.32 0.21 0.23 0.29 0.15 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.81 0.93 0.84 0.85 0.86 0.85 0.85 0.92 0.72 0.71]
 [0.81 1.   0.86 0.84 0.88 0.79 0.82 0.79 0.85 0.82 0.71]
 [0.93 0.86 1.   0.89 0.88 0.9  0.92 0.87 0.92 0.86 0.78]
 [0.84 0.84 0.89 1.   0.86 0.9  0.84 0.84 0.88 0.83 0.68]
 [0.85 0.88 0.88 0.86 1.   0.86 0.81 0.84 0.84 0.82 0.74]
 [0.86 0.79 0.9  0.9  0.86 1.   0.82 0.84 0.84 0.79 0.67]
 [0.85 0.82 0.92 0.84 0.81 0.82 1.   0.78 0.85 0.8  0.69]
 [0.85 0.79 0.87 0.84 0.84 0.84 0.78 1.   0.87 0.79 0.66]
 [0.92 0.85 0.92 0.88 0.84 0.84 0.85 0.87 1.   0.76 0.67]
 [0.72 0.82 0.86 0.83 0.82 0.79 0.8  0.79 0.76 1.   0.71]
 [0.71 0.71 0.78 0.68 0.74 0.67 0.69 0.66 0.67 0.71 1.  ]]
Collapsing 0 & 2 with crosscontam 0.6762356790123456 and sim 0.9329989589894694
Collapsing 2 & 8 with crosscontam 0.629164140120416 and sim 0.9224873231689072
Collapsing 0 & 8 with crosscontam 0.5649690822842546 and sim 0.9188275795349559
Collapsing 2 & 6 with crosscontam 0.5220717157844539 and sim 0.9153761506040007
Collapsing 3 & 5 with crosscontam 0.7765017497454811 and sim 0.9038819901762875
Collapsing 2 & 5 with crosscontam 0.5988151068955132 and sim 0.8976256810339078
Collapsing 2 & 3 with crosscontam 0.5196466418095946 and sim 0.8921905033212625
Collapsing 3 & 8 with crosscontam 0.6961671937279681 and sim 0.8812310679864211
Collapsing 1 & 4 with crosscontam 0.6483571222529434 and sim 0.8805942968208715
Collapsing 2 & 4 with crosscontam 0.500205514403292 and sim 0.880275932701713
Collapsing 7 & 8 with crosscontam 0.6762647212024844 and sim 0.8733644763999615
Collapsing 4 & 5 with crosscontam 0.6749166246984752 and sim 0.861938417526475
Collapsing 3 & 4 with crosscontam 0.68914331590612 and sim 0.8591431545564441
Collapsing 0 & 5 with crosscontam 0.540939049081602 and sim 0.8586486526873713
Collapsing 6 & 8 with crosscontam 0.629697029474866 and sim 0.8534917388302128
Collapsing 1 & 8 with crosscontam 0.5873703390554164 and sim 0.8522602277575086
Trimming eliminated 0 seqlets out of 641
Trimming eliminated 0 seqlets out of 844
Trimming eliminated 0 seqlets out of 1077
Skipped 1 due to duplicates
Trimming eliminated 0 seqlets out of 543
Trimming eliminated 0 seqlets out of 1620
Skipped 1 due to duplicates
Trimming eliminated 0 seqlets out of 599
Skipped 2 due to duplicates
Trimming eliminated 0 seqlets out of 2217
Trimming eliminated 0 seqlets out of 2426
Unmerged patterns remapping: OrderedDict([(9, 1), (10, 2)])
Time spent on merging iteration: 19.228306770324707
On merging iteration 2
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 2361 out of 2361 | elapsed:    1.2s finished
Numbers for each pattern pre-subsample: [2426, 44, 39]
Numbers after subsampling: [300, 44, 39]
Computing sims for pattern 0
Computed sims for pattern 0 in 0.6553225517272949 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.12050414085388184 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.11068534851074219 s
Cluster sizes
[2426   44   39]
Cross-contamination matrix:
[[1.   0.51 0.82]
 [0.49 1.   0.42]
 [0.34 0.15 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.84 0.75]
 [0.84 1.   0.71]
 [0.75 0.71 1.  ]]
Inspecting pattern 3 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 2361
[t-SNE] Computed conditional probabilities for sample 2000 / 2361
[t-SNE] Computed conditional probabilities for sample 2361 / 2361
[t-SNE] Mean sigma: 0.325265
Beginning preprocessing + Leiden
2024-03-12 02:55:11.295923 MEMORY 16.130891776
Affmat transformed
2024-03-12 02:55:11.327638 MEMORY 16.130891776
sources, targets, weights extracted
2024-03-12 02:55:11.346874 MEMORY 16.130891776
About to launch parallel Leiden runs
2024-03-12 02:55:11.359008 MEMORY 16.130875392
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    7.9s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   25.7s finished
Parallel Leiden runs finished
2024-03-12 02:55:37.065362 MEMORY 16.130875392
Quality: 0.5268601689879406
Quality: 0.5275258957768513
Quality: 0.5287475581108785
Got subclusters: Counter({0: 428, 1: 420, 2: 357, 3: 351, 4: 315, 5: 236, 6: 118, 7: 92, 8: 44})
On merging iteration 1
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 2354 out of 2354 | elapsed:    1.3s finished
Numbers for each pattern pre-subsample: [428, 420, 357, 351, 315, 236, 118, 92, 44]
Numbers after subsampling: [300, 300, 300, 300, 300, 236, 118, 92, 44]
Computing sims for pattern 0
Computed sims for pattern 0 in 3.163628101348877 s
Computing sims for pattern 1
Computed sims for pattern 1 in 3.245598077774048 s
Computing sims for pattern 2
Computed sims for pattern 2 in 3.2815639972686768 s
Computing sims for pattern 3
Computed sims for pattern 3 in 3.302647829055786 s
Computing sims for pattern 4
Computed sims for pattern 4 in 3.295076608657837 s
Computing sims for pattern 5
Computed sims for pattern 5 in 3.0509936809539795 s
Computing sims for pattern 6
Computed sims for pattern 6 in 1.6093623638153076 s
Computing sims for pattern 7
Computed sims for pattern 7 in 1.4544544219970703 s
Computing sims for pattern 8
Computed sims for pattern 8 in 0.8307633399963379 s
Cluster sizes
[428 420 357 351 315 236 118  92  44]
Cross-contamination matrix:
[[1.   0.7  0.55 0.55 0.64 0.7  0.61 0.5  0.56]
 [0.59 1.   0.36 0.82 0.53 0.74 0.31 0.42 0.4 ]
 [0.64 0.42 1.   0.94 0.81 0.66 0.76 0.69 0.75]
 [0.18 0.39 0.36 1.   0.5  0.48 0.24 0.39 0.37]
 [0.45 0.45 0.53 0.85 1.   0.54 0.66 0.5  0.46]
 [0.49 0.66 0.38 0.86 0.52 1.   0.34 0.49 0.47]
 [0.58 0.39 0.76 0.74 0.72 0.5  1.   0.51 0.68]
 [0.33 0.36 0.42 0.73 0.54 0.52 0.33 1.   0.2 ]
 [0.48 0.43 0.57 0.75 0.66 0.59 0.47 0.27 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.68 0.68 0.49 0.63 0.73 0.6  0.58 0.58]
 [0.68 1.   0.55 0.81 0.6  0.82 0.59 0.59 0.49]
 [0.68 0.55 1.   0.72 0.74 0.66 0.8  0.67 0.69]
 [0.49 0.81 0.72 1.   0.69 0.75 0.61 0.66 0.57]
 [0.63 0.6  0.74 0.69 1.   0.61 0.69 0.75 0.59]
 [0.73 0.82 0.66 0.75 0.61 1.   0.57 0.61 0.56]
 [0.6  0.59 0.8  0.61 0.69 0.57 1.   0.48 0.66]
 [0.58 0.59 0.67 0.66 0.75 0.61 0.48 1.   0.56]
 [0.58 0.49 0.69 0.57 0.59 0.56 0.66 0.56 1.  ]]
Inspecting pattern 4 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 2354
[t-SNE] Computed conditional probabilities for sample 2000 / 2354
[t-SNE] Computed conditional probabilities for sample 2354 / 2354
[t-SNE] Mean sigma: 0.341621
Beginning preprocessing + Leiden
2024-03-12 02:56:05.048415 MEMORY 16.130875392
Affmat transformed
2024-03-12 02:56:05.080098 MEMORY 16.130875392
sources, targets, weights extracted
2024-03-12 02:56:05.096953 MEMORY 16.130875392
About to launch parallel Leiden runs
2024-03-12 02:56:05.107466 MEMORY 16.130875392
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    8.3s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   29.0s finished
Parallel Leiden runs finished
2024-03-12 02:56:34.153973 MEMORY 16.130875392
Quality: 0.5072191568606205
Quality: 0.507448471476566
Got subclusters: Counter({0: 454, 1: 413, 2: 402, 3: 364, 4: 338, 5: 241, 6: 121, 7: 21})
On merging iteration 1
Numbers for each pattern pre-subsample: [454, 413, 402, 364, 338, 241, 121, 21]
Numbers after subsampling: [300, 300, 300, 300, 300, 241, 121, 21]
Computing sims for pattern 0
Computed sims for pattern 0 in 2.888366222381592 s
Computing sims for pattern 1
Computed sims for pattern 1 in 2.9433810710906982 s
Computing sims for pattern 2
Computed sims for pattern 2 in 2.9640913009643555 s
Computing sims for pattern 3
Computed sims for pattern 3 in 2.9144413471221924 s
Computing sims for pattern 4
Computed sims for pattern 4 in 2.920220136642456 s
Computing sims for pattern 5
Computed sims for pattern 5 in 2.2906904220581055 s
Computing sims for pattern 6
Computed sims for pattern 6 in 1.5456383228302002 s
Computing sims for pattern 7
Computed sims for pattern 7 in 0.5581178665161133 s
Cluster sizes
[454 413 402 364 338 241 121  21]
Cross-contamination matrix:
[[1.   0.71 0.73 0.82 0.74 0.59 0.43 0.35]
 [0.73 1.   0.59 0.57 0.58 0.32 0.33 0.24]
 [0.41 0.44 1.   0.61 0.55 0.71 0.24 0.22]
 [0.59 0.46 0.67 1.   0.53 0.5  0.2  0.24]
 [0.71 0.63 0.77 0.66 1.   0.52 0.26 0.32]
 [0.41 0.31 0.87 0.58 0.46 1.   0.35 0.31]
 [0.75 0.82 0.84 0.74 0.79 0.84 1.   1.  ]
 [0.03 0.05 0.13 0.09 0.11 0.11 0.3  1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.79 0.77 0.83 0.85 0.77 0.74 0.39]
 [0.79 1.   0.66 0.83 0.71 0.63 0.74 0.45]
 [0.77 0.66 1.   0.73 0.76 0.88 0.68 0.53]
 [0.83 0.83 0.73 1.   0.7  0.68 0.59 0.44]
 [0.85 0.71 0.76 0.7  1.   0.79 0.7  0.43]
 [0.77 0.63 0.88 0.68 0.79 1.   0.67 0.47]
 [0.74 0.74 0.68 0.59 0.7  0.67 1.   0.66]
 [0.39 0.45 0.53 0.44 0.43 0.47 0.66 1.  ]]
Collapsing 2 & 5 with crosscontam 0.7130843848163515 and sim 0.8813825856649236
Removed 1 duplicate seqlets
Trimming eliminated 0 seqlets out of 642
Unmerged patterns remapping: OrderedDict([(0, 1), (1, 2), (3, 3), (4, 4), (6, 5), (7, 6)])
Time spent on merging iteration: 1.7152392864227295
On merging iteration 2
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 1995 tasks      | elapsed:    1.1s
[Parallel(n_jobs=24)]: Done 2252 out of 2252 | elapsed:    1.2s finished
Numbers for each pattern pre-subsample: [642, 454, 413, 364, 338, 121, 21]
Numbers after subsampling: [300, 300, 300, 300, 300, 121, 21]
Computing sims for pattern 0
Computed sims for pattern 0 in 2.494802713394165 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.4412517547607422 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.443500280380249 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.46710848808288574 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.456531286239624 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.22539210319519043 s
Computing sims for pattern 6
Computed sims for pattern 6 in 0.08524751663208008 s
Cluster sizes
[642 454 413 364 338 121  21]
Cross-contamination matrix:
[[1.   0.47 0.46 0.65 0.65 0.32 0.36]
 [0.68 1.   0.71 0.82 0.74 0.43 0.35]
 [0.48 0.73 1.   0.57 0.58 0.33 0.24]
 [0.58 0.59 0.46 1.   0.53 0.2  0.24]
 [0.72 0.71 0.63 0.66 1.   0.26 0.32]
 [0.82 0.75 0.82 0.74 0.79 1.   1.  ]
 [0.15 0.03 0.05 0.09 0.11 0.3  1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.77 0.66 0.71 0.77 0.68 0.53]
 [0.77 1.   0.79 0.83 0.85 0.74 0.39]
 [0.66 0.79 1.   0.83 0.71 0.74 0.45]
 [0.71 0.83 0.83 1.   0.7  0.59 0.44]
 [0.77 0.85 0.71 0.7  1.   0.7  0.43]
 [0.68 0.74 0.74 0.59 0.7  1.   0.66]
 [0.53 0.39 0.45 0.44 0.43 0.66 1.  ]]
Inspecting pattern 5 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 2252
[t-SNE] Computed conditional probabilities for sample 2000 / 2252
[t-SNE] Computed conditional probabilities for sample 2252 / 2252
[t-SNE] Mean sigma: 0.311438
Beginning preprocessing + Leiden
2024-03-12 02:57:03.796268 MEMORY 16.130875392
Affmat transformed
2024-03-12 02:57:03.826943 MEMORY 16.130875392
sources, targets, weights extracted
2024-03-12 02:57:03.846836 MEMORY 16.130875392
About to launch parallel Leiden runs
2024-03-12 02:57:03.858443 MEMORY 16.130875392
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    8.9s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   31.1s finished
Parallel Leiden runs finished
2024-03-12 02:57:34.964045 MEMORY 16.130875392
Quality: 0.47124540406571713
Quality: 0.4754939264508888
Quality: 0.47614937764536386
Quality: 0.4782499940948324
Quality: 0.47901836043581586
Quality: 0.47973329945561877
Got subclusters: Counter({0: 450, 1: 387, 2: 349, 3: 321, 4: 299, 5: 183, 6: 170, 7: 85, 8: 8})
On merging iteration 1
Numbers for each pattern pre-subsample: [450, 387, 349, 321, 299, 183, 170, 85, 8]
Numbers after subsampling: [300, 300, 300, 300, 299, 183, 170, 85, 8]
Computing sims for pattern 0
Computed sims for pattern 0 in 3.0888595581054688 s
Computing sims for pattern 1
Computed sims for pattern 1 in 3.1922197341918945 s
Computing sims for pattern 2
Computed sims for pattern 2 in 3.296696424484253 s
Computing sims for pattern 3
Computed sims for pattern 3 in 3.327063798904419 s
Computing sims for pattern 4
Computed sims for pattern 4 in 3.307074546813965 s
Computing sims for pattern 5
Computed sims for pattern 5 in 2.2837769985198975 s
Computing sims for pattern 6
Computed sims for pattern 6 in 2.0543313026428223 s
Computing sims for pattern 7
Computed sims for pattern 7 in 1.3748066425323486 s
Computing sims for pattern 8
Computed sims for pattern 8 in 0.5030086040496826 s
Cluster sizes
[450 387 349 321 299 183 170  85   8]
Cross-contamination matrix:
[[1.   0.59 0.77 0.75 0.46 0.63 0.48 0.41 0.12]
 [0.81 1.   0.78 0.84 0.76 0.58 0.47 0.55 0.26]
 [0.68 0.51 1.   0.74 0.65 0.65 0.48 0.53 0.12]
 [0.59 0.49 0.68 1.   0.62 0.58 0.45 0.56 0.09]
 [0.46 0.6  0.75 0.78 1.   0.52 0.32 0.69 0.11]
 [0.82 0.58 0.94 0.94 0.67 1.   0.58 0.67 0.2 ]
 [0.68 0.48 0.77 0.82 0.45 0.44 1.   0.45 0.23]
 [0.48 0.45 0.67 0.76 0.72 0.56 0.37 1.   0.19]
 [0.19 0.2  0.19 0.16 0.13 0.17 0.17 0.19 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.8  0.84 0.77 0.61 0.8  0.69 0.57 0.5 ]
 [0.8  1.   0.73 0.74 0.73 0.64 0.59 0.64 0.52]
 [0.84 0.73 1.   0.8  0.76 0.91 0.72 0.75 0.47]
 [0.77 0.74 0.8  1.   0.76 0.78 0.76 0.79 0.52]
 [0.61 0.73 0.76 0.76 1.   0.71 0.55 0.84 0.41]
 [0.8  0.64 0.91 0.78 0.71 1.   0.72 0.72 0.5 ]
 [0.69 0.59 0.72 0.76 0.55 0.72 1.   0.58 0.54]
 [0.57 0.64 0.75 0.79 0.84 0.72 0.58 1.   0.56]
 [0.5  0.52 0.47 0.52 0.41 0.5  0.54 0.56 1.  ]]
Collapsing 2 & 5 with crosscontam 0.6453136061526006 and sim 0.913395336469405
Trimming eliminated 0 seqlets out of 532
Unmerged patterns remapping: OrderedDict([(0, 1), (1, 2), (3, 3), (4, 4), (6, 5), (7, 6), (8, 7)])
Time spent on merging iteration: 3.9092416763305664
On merging iteration 2
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 1956 out of 1956 | elapsed:    0.9s finished
Numbers for each pattern pre-subsample: [532, 450, 387, 321, 299, 170, 85, 8]
Numbers after subsampling: [300, 300, 300, 300, 299, 170, 85, 8]
Computing sims for pattern 0
Computed sims for pattern 0 in 2.9122300148010254 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.4516563415527344 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.45630455017089844 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.4436485767364502 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.4499058723449707 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.29199719429016113 s
Computing sims for pattern 6
Computed sims for pattern 6 in 0.19363808631896973 s
Computing sims for pattern 7
Computed sims for pattern 7 in 0.06761431694030762 s
Cluster sizes
[532 450 387 321 299 170  85   8]
Cross-contamination matrix:
[[1.   0.83 0.63 0.92 0.77 0.6  0.71 0.22]
 [0.72 1.   0.59 0.75 0.46 0.48 0.41 0.12]
 [0.71 0.81 1.   0.84 0.76 0.47 0.55 0.26]
 [0.64 0.59 0.49 1.   0.62 0.45 0.56 0.09]
 [0.66 0.46 0.6  0.78 1.   0.32 0.69 0.11]
 [0.7  0.68 0.48 0.82 0.45 1.   0.45 0.23]
 [0.63 0.48 0.45 0.76 0.72 0.37 1.   0.19]
 [0.18 0.19 0.2  0.16 0.13 0.17 0.19 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.84 0.71 0.8  0.73 0.73 0.75 0.47]
 [0.84 1.   0.8  0.77 0.61 0.69 0.57 0.5 ]
 [0.71 0.8  1.   0.74 0.73 0.59 0.64 0.52]
 [0.8  0.77 0.74 1.   0.76 0.76 0.79 0.52]
 [0.73 0.61 0.73 0.76 1.   0.55 0.84 0.41]
 [0.73 0.69 0.59 0.76 0.55 1.   0.58 0.54]
 [0.75 0.57 0.64 0.79 0.84 0.58 1.   0.56]
 [0.47 0.5  0.52 0.52 0.41 0.54 0.56 1.  ]]
Inspecting pattern 6 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 1956
[t-SNE] Computed conditional probabilities for sample 1956 / 1956
[t-SNE] Mean sigma: 0.341191
Beginning preprocessing + Leiden
2024-03-12 02:58:10.165671 MEMORY 16.130891776
Affmat transformed
2024-03-12 02:58:10.192441 MEMORY 16.130891776
sources, targets, weights extracted
2024-03-12 02:58:10.206695 MEMORY 16.130891776
About to launch parallel Leiden runs
2024-03-12 02:58:10.216504 MEMORY 16.130891776
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    5.9s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   22.2s finished
Parallel Leiden runs finished
2024-03-12 02:58:32.388923 MEMORY 16.130891776
Quality: 0.5242965104380494
Quality: 0.5250303844414466
Quality: 0.5276487045478918
Quality: 0.5277857973033372
Quality: 0.5278380226787427
Got subclusters: Counter({0: 539, 1: 324, 2: 278, 3: 263, 4: 256, 5: 166, 6: 115, 7: 11, 8: 2, 9: 2})
On merging iteration 1
Numbers for each pattern pre-subsample: [539, 324, 278, 263, 256, 166, 115, 11, 2, 2]
Numbers after subsampling: [300, 300, 278, 263, 256, 166, 115, 11, 2, 2]
Computing sims for pattern 0
Computed sims for pattern 0 in 3.338507890701294 s
Computing sims for pattern 1
Computed sims for pattern 1 in 3.6731152534484863 s
Computing sims for pattern 2
Computed sims for pattern 2 in 3.114596366882324 s
Computing sims for pattern 3
Computed sims for pattern 3 in 2.8535566329956055 s
Computing sims for pattern 4
Computed sims for pattern 4 in 2.7713372707366943 s
Computing sims for pattern 5
Computed sims for pattern 5 in 2.129387378692627 s
Computing sims for pattern 6
Computed sims for pattern 6 in 1.6841087341308594 s
Computing sims for pattern 7
Computed sims for pattern 7 in 0.5372328758239746 s
Computing sims for pattern 8
Computed sims for pattern 8 in 0.34436964988708496 s
Computing sims for pattern 9
Computed sims for pattern 9 in 0.32602453231811523 s
Cluster sizes
[539 324 278 263 256 166 115  11   2   2]
Cross-contamination matrix:
[[1.   0.18 0.29 0.22 0.28 0.44 0.3  0.24 0.09 0.24]
 [0.34 1.   0.82 0.74 0.7  0.64 0.63 0.21 0.14 0.25]
 [0.44 0.73 1.   0.68 0.63 0.6  0.56 0.2  0.16 0.17]
 [0.35 0.64 0.66 1.   0.67 0.56 0.41 0.3  0.31 0.11]
 [0.5  0.7  0.71 0.78 1.   0.68 0.54 0.3  0.33 0.17]
 [0.59 0.55 0.58 0.56 0.58 1.   0.53 0.17 0.15 0.1 ]
 [0.46 0.58 0.58 0.42 0.45 0.51 1.   0.21 0.36 0.16]
 [0.08 0.01 0.02 0.04 0.03 0.01 0.02 1.   0.   0.01]
 [0.   0.   0.   0.   0.   0.   0.   0.   1.   0.  ]
 [0.   0.   0.   0.   0.   0.   0.   0.   0.   1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.56 0.67 0.56 0.64 0.7  0.49 0.62 0.27 0.47]
 [0.56 1.   0.86 0.8  0.78 0.63 0.76 0.46 0.32 0.31]
 [0.67 0.86 1.   0.78 0.78 0.65 0.68 0.58 0.32 0.34]
 [0.56 0.8  0.78 1.   0.8  0.65 0.59 0.47 0.38 0.3 ]
 [0.64 0.78 0.78 0.8  1.   0.73 0.61 0.49 0.27 0.35]
 [0.7  0.63 0.65 0.65 0.73 1.   0.57 0.48 0.22 0.42]
 [0.49 0.76 0.68 0.59 0.61 0.57 1.   0.37 0.56 0.26]
 [0.62 0.46 0.58 0.47 0.49 0.48 0.37 1.   0.27 0.33]
 [0.27 0.32 0.32 0.38 0.27 0.22 0.56 0.27 1.   0.47]
 [0.47 0.31 0.34 0.3  0.35 0.42 0.26 0.33 0.47 1.  ]]
Collapsing 1 & 2 with crosscontam 0.732356217194869 and sim 0.8642269808497327
Trimming eliminated 0 seqlets out of 602
Unmerged patterns remapping: OrderedDict([(0, 1), (3, 2), (4, 3), (5, 4), (6, 5), (7, 6), (8, 7), (9, 8)])
Time spent on merging iteration: 1.460827350616455
On merging iteration 2
Numbers for each pattern pre-subsample: [602, 539, 263, 256, 166, 115, 11, 2, 2]
Numbers after subsampling: [300, 300, 263, 256, 166, 115, 11, 2, 2]
Computing sims for pattern 0
Computed sims for pattern 0 in 2.927762269973755 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.43952512741088867 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.36479902267456055 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.3579859733581543 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.2733650207519531 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.21061468124389648 s
Computing sims for pattern 6
Computed sims for pattern 6 in 0.07358622550964355 s
Computing sims for pattern 7
Computed sims for pattern 7 in 0.06209278106689453 s
Computing sims for pattern 8
Computed sims for pattern 8 in 0.0537111759185791 s
Cluster sizes
[602 539 263 256 166 115  11   2   2]
Cross-contamination matrix:
[[1.   0.47 0.85 0.79 0.73 0.71 0.28 0.25 0.27]
 [0.22 1.   0.22 0.28 0.44 0.3  0.24 0.09 0.24]
 [0.66 0.35 1.   0.67 0.56 0.41 0.3  0.31 0.11]
 [0.71 0.5  0.78 1.   0.68 0.54 0.3  0.33 0.17]
 [0.55 0.59 0.56 0.58 1.   0.53 0.17 0.15 0.1 ]
 [0.57 0.46 0.42 0.45 0.51 1.   0.21 0.36 0.16]
 [0.02 0.08 0.04 0.03 0.01 0.02 1.   0.   0.01]
 [0.   0.   0.   0.   0.   0.   0.   1.   0.  ]
 [0.   0.   0.   0.   0.   0.   0.   0.   1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.61 0.82 0.79 0.64 0.76 0.51 0.34 0.32]
 [0.61 1.   0.56 0.64 0.7  0.49 0.62 0.27 0.47]
 [0.82 0.56 1.   0.8  0.65 0.59 0.47 0.38 0.3 ]
 [0.79 0.64 0.8  1.   0.73 0.61 0.49 0.27 0.35]
 [0.64 0.7  0.65 0.73 1.   0.57 0.48 0.22 0.42]
 [0.76 0.49 0.59 0.61 0.57 1.   0.37 0.56 0.26]
 [0.51 0.62 0.47 0.49 0.48 0.37 1.   0.27 0.33]
 [0.34 0.27 0.38 0.27 0.22 0.56 0.27 1.   0.47]
 [0.32 0.47 0.3  0.35 0.42 0.26 0.33 0.47 1.  ]]
Merging on 48 clusters
2024-03-12 02:58:59.721592 MEMORY 16.130891776
On merging iteration 1
Numbers for each pattern pre-subsample: [1711, 633, 533, 464, 413, 55, 35, 9, 1913, 359, 251, 66, 2426, 44, 39, 428, 420, 357, 351, 315, 236, 118, 92, 44, 642, 454, 413, 364, 338, 121, 21, 532, 450, 387, 321, 299, 170, 85, 8, 602, 539, 263, 256, 166, 115, 11, 2, 2]
Numbers after subsampling: [300, 300, 300, 300, 300, 55, 35, 9, 300, 300, 251, 66, 300, 44, 39, 300, 300, 300, 300, 300, 236, 118, 92, 44, 300, 300, 300, 300, 300, 121, 21, 300, 300, 300, 300, 299, 170, 85, 8, 300, 300, 263, 256, 166, 115, 11, 2, 2]
Computing sims for pattern 0
Computed sims for pattern 0 in 19.101565837860107 s
Computing sims for pattern 1
Computed sims for pattern 1 in 19.316806316375732 s
Computing sims for pattern 2
Computed sims for pattern 2 in 19.33481240272522 s
Computing sims for pattern 3
Computed sims for pattern 3 in 23.169696807861328 s
Computing sims for pattern 4
Computed sims for pattern 4 in 18.832969903945923 s
Computing sims for pattern 5
Computed sims for pattern 5 in 5.484829425811768 s
Computing sims for pattern 6
Computed sims for pattern 6 in 3.9877758026123047 s
Computing sims for pattern 7
Computed sims for pattern 7 in 2.2783710956573486 s
Computing sims for pattern 8
Computed sims for pattern 8 in 18.714433908462524 s
Computing sims for pattern 9
Computed sims for pattern 9 in 18.875500917434692 s
Computing sims for pattern 10
Computed sims for pattern 10 in 16.95163130760193 s
Computing sims for pattern 11
Computed sims for pattern 11 in 6.009264945983887 s
Computing sims for pattern 12
Computed sims for pattern 12 in 18.772019624710083 s
Computing sims for pattern 13
Computed sims for pattern 13 in 4.5335612297058105 s
Computing sims for pattern 14
Computed sims for pattern 14 in 4.272992849349976 s
Computing sims for pattern 15
Computed sims for pattern 15 in 18.751693725585938 s
Computing sims for pattern 16
Computed sims for pattern 16 in 18.76005458831787 s
Computing sims for pattern 17
Computed sims for pattern 17 in 18.803075551986694 s
Computing sims for pattern 18
Computed sims for pattern 18 in 21.202757358551025 s
Computing sims for pattern 19
Computed sims for pattern 19 in 18.870882511138916 s
Computing sims for pattern 20
Computed sims for pattern 20 in 17.444664239883423 s
Computing sims for pattern 21
Computed sims for pattern 21 in 8.952021360397339 s
Computing sims for pattern 22
Computed sims for pattern 22 in 8.106886148452759 s
Computing sims for pattern 23
Computed sims for pattern 23 in 4.470710039138794 s
Computing sims for pattern 24
Computed sims for pattern 24 in 18.675596237182617 s
Computing sims for pattern 25
Computed sims for pattern 25 in 22.174380779266357 s
Computing sims for pattern 26
Computed sims for pattern 26 in 18.93801498413086 s
Computing sims for pattern 27
Computed sims for pattern 27 in 19.013397216796875 s
Computing sims for pattern 28
Computed sims for pattern 28 in 18.96174430847168 s
Computing sims for pattern 29
Computed sims for pattern 29 in 9.085536479949951 s
Computing sims for pattern 30
Computed sims for pattern 30 in 3.0386199951171875 s
Computing sims for pattern 31
Computed sims for pattern 31 in 18.66442346572876 s
Computing sims for pattern 32
Computed sims for pattern 32 in 21.350071668624878 s
Computing sims for pattern 33
Computed sims for pattern 33 in 19.21271061897278 s
Computing sims for pattern 34
Computed sims for pattern 34 in 19.471201181411743 s
Computing sims for pattern 35
Computed sims for pattern 35 in 18.97519040107727 s
Computing sims for pattern 36
Computed sims for pattern 36 in 12.106561422348022 s
Computing sims for pattern 37
Computed sims for pattern 37 in 7.584735155105591 s
Computing sims for pattern 38
Computed sims for pattern 38 in 2.1753809452056885 s
Computing sims for pattern 39
Computed sims for pattern 39 in 22.296911001205444 s
Computing sims for pattern 40
Computed sims for pattern 40 in 18.782470226287842 s
Computing sims for pattern 41
Computed sims for pattern 41 in 15.822570562362671 s
Computing sims for pattern 42
Computed sims for pattern 42 in 15.056405782699585 s
Computing sims for pattern 43
Computed sims for pattern 43 in 11.516365051269531 s
Computing sims for pattern 44
Computed sims for pattern 44 in 8.74635648727417 s
Computing sims for pattern 45
Computed sims for pattern 45 in 2.370046854019165 s
Computing sims for pattern 46
Computed sims for pattern 46 in 1.745276689529419 s
Computing sims for pattern 47
Computed sims for pattern 47 in 1.7519052028656006 s
Cluster sizes
[1711  633  533  464  413   55   35    9 1913  359  251   66 2426   44
   39  428  420  357  351  315  236  118   92   44  642  454  413  364
  338  121   21  532  450  387  321  299  170   85    8  602  539  263
  256  166  115   11    2    2]
Cross-contamination matrix:
[[1.   0.91 0.64 ... 0.06 0.24 0.12]
 [0.69 1.   0.59 ... 0.01 0.09 0.04]
 [0.58 0.82 1.   ... 0.01 0.18 0.01]
 ...
 [0.   0.   0.   ... 1.   0.   0.01]
 [0.   0.   0.   ... 0.   1.   0.  ]
 [0.   0.   0.   ... 0.   0.   1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.82 0.68 ... 0.16 0.35 0.3 ]
 [0.82 1.   0.79 ... 0.21 0.33 0.29]
 [0.68 0.79 1.   ... 0.07 0.43 0.13]
 ...
 [0.16 0.21 0.07 ... 1.   0.27 0.33]
 [0.35 0.33 0.43 ... 0.27 1.   0.47]
 [0.3  0.29 0.13 ... 0.33 0.47 1.  ]]
Collapsing 15 & 37 with crosscontam 0.7211983879503359 and sim 0.9394060322073345
Collapsing 13 & 25 with crosscontam 0.5267724768344606 and sim 0.8779902276387506
Collapsing 9 & 42 with crosscontam 0.6935142554976852 and sim 0.8689603143626154
Collapsing 13 & 22 with crosscontam 0.691412174884374 and sim 0.8675715385390721
Trimming eliminated 0 seqlets out of 513
Trimming eliminated 0 seqlets out of 498
Skipped 3 due to duplicates
Trimming eliminated 0 seqlets out of 612
Trimming eliminated 0 seqlets out of 590
Unmerged patterns remapping: OrderedDict([(0, 2), (1, 4), (2, 9), (3, 12), (4, 15), (5, 34), (6, 37), (7, 40), (8, 1), (10, 26), (11, 33), (12, 0), (14, 36), (16, 14), (17, 19), (18, 20), (19, 23), (20, 27), (21, 31), (23, 35), (24, 3), (26, 16), (27, 18), (28, 21), (29, 30), (30, 38), (31, 10), (32, 13), (33, 17), (34, 22), (35, 24), (36, 28), (38, 41), (39, 6), (40, 8), (41, 25), (43, 29), (44, 32), (45, 39), (46, 42), (47, 43)])
Time spent on merging iteration: 7.6577136516571045
On merging iteration 2
Numbers for each pattern pre-subsample: [2426, 1913, 1711, 642, 633, 612, 602, 590, 539, 533, 532, 513, 464, 450, 420, 413, 413, 387, 364, 357, 351, 338, 321, 315, 299, 263, 251, 236, 170, 166, 121, 118, 115, 66, 55, 44, 39, 35, 21, 11, 9, 8, 2, 2]
Numbers after subsampling: [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 299, 263, 251, 236, 170, 166, 121, 118, 115, 66, 55, 44, 39, 35, 21, 11, 9, 8, 2, 2]
Computing sims for pattern 0
Computed sims for pattern 0 in 1.2962982654571533 s
Computing sims for pattern 1
Computed sims for pattern 1 in 1.302889108657837 s
Computing sims for pattern 2
Computed sims for pattern 2 in 1.3625879287719727 s
Computing sims for pattern 3
Computed sims for pattern 3 in 1.3606321811676025 s
Computing sims for pattern 4
Computed sims for pattern 4 in 1.3434162139892578 s
Computing sims for pattern 5
Computed sims for pattern 5 in 17.292808532714844 s
Computing sims for pattern 6
Computed sims for pattern 6 in 1.3239188194274902 s
Computing sims for pattern 7
Computed sims for pattern 7 in 17.489585399627686 s
Computing sims for pattern 8
Computed sims for pattern 8 in 1.3782224655151367 s
Computing sims for pattern 9
Computed sims for pattern 9 in 1.3481109142303467 s
Computing sims for pattern 10
Computed sims for pattern 10 in 1.326817512512207 s
Computing sims for pattern 11
Computed sims for pattern 11 in 17.376532554626465 s
Computing sims for pattern 12
Computed sims for pattern 12 in 1.3532848358154297 s
Computing sims for pattern 13
Computed sims for pattern 13 in 1.3246726989746094 s
Computing sims for pattern 14
Computed sims for pattern 14 in 1.3302052021026611 s
Computing sims for pattern 15
Computed sims for pattern 15 in 1.337721347808838 s
Computing sims for pattern 16
Computed sims for pattern 16 in 1.3805248737335205 s
Computing sims for pattern 17
Computed sims for pattern 17 in 1.3149065971374512 s
Computing sims for pattern 18
Computed sims for pattern 18 in 1.3463315963745117 s
Computing sims for pattern 19
Computed sims for pattern 19 in 1.3533899784088135 s
Computing sims for pattern 20
Computed sims for pattern 20 in 1.3400166034698486 s
Computing sims for pattern 21
Computed sims for pattern 21 in 1.3527042865753174 s
Computing sims for pattern 22
Computed sims for pattern 22 in 1.3462424278259277 s
Computing sims for pattern 23
Computed sims for pattern 23 in 1.3635177612304688 s
Computing sims for pattern 24
Computed sims for pattern 24 in 1.342118740081787 s
Computing sims for pattern 25
Computed sims for pattern 25 in 1.1278436183929443 s
Computing sims for pattern 26
Computed sims for pattern 26 in 1.0626945495605469 s
Computing sims for pattern 27
Computed sims for pattern 27 in 1.2293288707733154 s
Computing sims for pattern 28
Computed sims for pattern 28 in 0.8573393821716309 s
Computing sims for pattern 29
Computed sims for pattern 29 in 3.2439727783203125 s
Computing sims for pattern 30
Computed sims for pattern 30 in 0.6586050987243652 s
Computing sims for pattern 31
Computed sims for pattern 31 in 0.6473238468170166 s
Computing sims for pattern 32
Computed sims for pattern 32 in 0.6288721561431885 s
Computing sims for pattern 33
Computed sims for pattern 33 in 0.4518241882324219 s
Computing sims for pattern 34
Computed sims for pattern 34 in 0.4069950580596924 s
Computing sims for pattern 35
Computed sims for pattern 35 in 0.34540653228759766 s
Computing sims for pattern 36
Computed sims for pattern 36 in 0.32398295402526855 s
Computing sims for pattern 37
Computed sims for pattern 37 in 0.32190847396850586 s
Computing sims for pattern 38
Computed sims for pattern 38 in 0.2599983215332031 s
Computing sims for pattern 39
Computed sims for pattern 39 in 0.20787429809570312 s
Computing sims for pattern 40
Computed sims for pattern 40 in 0.192962646484375 s
Computing sims for pattern 41
Computed sims for pattern 41 in 0.19567394256591797 s
Computing sims for pattern 42
Computed sims for pattern 42 in 0.1621091365814209 s
Computing sims for pattern 43
Computed sims for pattern 43 in 0.16212224960327148 s
Cluster sizes
[2426 1913 1711  642  633  612  602  590  539  533  532  513  464  450
  420  413  413  387  364  357  351  338  321  315  299  263  251  236
  170  166  121  118  115   66   55   44   39   35   21   11    9    8
    2    2]
Cross-contamination matrix:
[[1.   0.11 0.25 ... 0.11 1.   0.27]
 [0.08 1.   0.11 ... 0.26 0.15 0.05]
 [0.22 0.14 1.   ... 0.14 0.24 0.12]
 ...
 [0.08 0.19 0.1  ... 1.   0.12 0.06]
 [0.02 0.   0.   ... 0.   1.   0.  ]
 [0.   0.   0.   ... 0.   0.   1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.3  0.4  ... 0.36 0.94 0.36]
 [0.3  1.   0.26 ... 0.42 0.25 0.17]
 [0.4  0.26 1.   ... 0.47 0.35 0.3 ]
 ...
 [0.36 0.42 0.47 ... 1.   0.37 0.15]
 [0.94 0.25 0.35 ... 0.37 1.   0.47]
 [0.36 0.17 0.3  ... 0.15 0.47 1.  ]]
Collapsing 7 & 21 with crosscontam 0.6924644997530867 and sim 0.8940360056338719
Trimming eliminated 0 seqlets out of 928
Unmerged patterns remapping: OrderedDict([(0, 0), (1, 1), (2, 2), (3, 4), (4, 5), (5, 6), (6, 7), (8, 8), (9, 9), (10, 10), (11, 11), (12, 12), (13, 13), (14, 14), (15, 15), (16, 16), (17, 17), (18, 18), (19, 19), (20, 20), (22, 21), (23, 22), (24, 23), (25, 24), (26, 25), (27, 26), (28, 27), (29, 28), (30, 29), (31, 30), (32, 31), (33, 32), (34, 33), (35, 34), (36, 35), (37, 36), (38, 37), (39, 38), (40, 39), (41, 40), (42, 41), (43, 42)])
Time spent on merging iteration: 2.1745643615722656
On merging iteration 3
Numbers for each pattern pre-subsample: [2426, 1913, 1711, 928, 642, 633, 612, 602, 539, 533, 532, 513, 464, 450, 420, 413, 413, 387, 364, 357, 351, 321, 315, 299, 263, 251, 236, 170, 166, 121, 118, 115, 66, 55, 44, 39, 35, 21, 11, 9, 8, 2, 2]
Numbers after subsampling: [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 299, 263, 251, 236, 170, 166, 121, 118, 115, 66, 55, 44, 39, 35, 21, 11, 9, 8, 2, 2]
Computing sims for pattern 0
Computed sims for pattern 0 in 0.4269077777862549 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.427631139755249 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.4332461357116699 s
Computing sims for pattern 3
Computed sims for pattern 3 in 17.08331847190857 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.46194005012512207 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.45344972610473633 s
Computing sims for pattern 6
Computed sims for pattern 6 in 0.4546165466308594 s
Computing sims for pattern 7
Computed sims for pattern 7 in 0.45465636253356934 s
Computing sims for pattern 8
Computed sims for pattern 8 in 0.45452189445495605 s
Computing sims for pattern 9
Computed sims for pattern 9 in 0.46463727951049805 s
Computing sims for pattern 10
Computed sims for pattern 10 in 0.4680359363555908 s
Computing sims for pattern 11
Computed sims for pattern 11 in 0.4546680450439453 s
Computing sims for pattern 12
Computed sims for pattern 12 in 0.45084643363952637 s
Computing sims for pattern 13
Computed sims for pattern 13 in 0.46134400367736816 s
Computing sims for pattern 14
Computed sims for pattern 14 in 0.45575833320617676 s
Computing sims for pattern 15
Computed sims for pattern 15 in 0.4491283893585205 s
Computing sims for pattern 16
Computed sims for pattern 16 in 0.4542245864868164 s
Computing sims for pattern 17
Computed sims for pattern 17 in 0.4462287425994873 s
Computing sims for pattern 18
Computed sims for pattern 18 in 0.47471117973327637 s
Computing sims for pattern 19
Computed sims for pattern 19 in 0.4480092525482178 s
Computing sims for pattern 20
Computed sims for pattern 20 in 0.45111560821533203 s
Computing sims for pattern 21
Computed sims for pattern 21 in 0.44113945960998535 s
Computing sims for pattern 22
Computed sims for pattern 22 in 0.45206737518310547 s
Computing sims for pattern 23
Computed sims for pattern 23 in 0.4491569995880127 s
Computing sims for pattern 24
Computed sims for pattern 24 in 0.3776888847351074 s
Computing sims for pattern 25
Computed sims for pattern 25 in 0.3518965244293213 s
Computing sims for pattern 26
Computed sims for pattern 26 in 0.40785717964172363 s
Computing sims for pattern 27
Computed sims for pattern 27 in 0.28371500968933105 s
Computing sims for pattern 28
Computed sims for pattern 28 in 0.2785055637359619 s
Computing sims for pattern 29
Computed sims for pattern 29 in 0.22805547714233398 s
Computing sims for pattern 30
Computed sims for pattern 30 in 0.21785664558410645 s
Computing sims for pattern 31
Computed sims for pattern 31 in 0.20989060401916504 s
Computing sims for pattern 32
Computed sims for pattern 32 in 0.15655946731567383 s
Computing sims for pattern 33
Computed sims for pattern 33 in 0.1407759189605713 s
Computing sims for pattern 34
Computed sims for pattern 34 in 0.1160430908203125 s
Computing sims for pattern 35
Computed sims for pattern 35 in 0.11058688163757324 s
Computing sims for pattern 36
Computed sims for pattern 36 in 0.10598540306091309 s
Computing sims for pattern 37
Computed sims for pattern 37 in 0.08453917503356934 s
Computing sims for pattern 38
Computed sims for pattern 38 in 0.06743526458740234 s
Computing sims for pattern 39
Computed sims for pattern 39 in 0.06424331665039062 s
Computing sims for pattern 40
Computed sims for pattern 40 in 0.06268954277038574 s
Computing sims for pattern 41
Computed sims for pattern 41 in 0.05406928062438965 s
Computing sims for pattern 42
Computed sims for pattern 42 in 0.053899526596069336 s
Cluster sizes
[2426 1913 1711  928  642  633  612  602  539  533  532  513  464  450
  420  413  413  387  364  357  351  321  315  299  263  251  236  170
  166  121  118  115   66   55   44   39   35   21   11    9    8    2
    2]
Cross-contamination matrix:
[[1.   0.11 0.25 ... 0.11 1.   0.27]
 [0.08 1.   0.11 ... 0.26 0.15 0.05]
 [0.22 0.14 1.   ... 0.14 0.24 0.12]
 ...
 [0.08 0.19 0.1  ... 1.   0.12 0.06]
 [0.02 0.   0.   ... 0.   1.   0.  ]
 [0.   0.   0.   ... 0.   0.   1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.3  0.4  ... 0.36 0.94 0.36]
 [0.3  1.   0.26 ... 0.42 0.25 0.17]
 [0.4  0.26 1.   ... 0.47 0.35 0.3 ]
 ...
 [0.36 0.42 0.47 ... 1.   0.37 0.15]
 [0.94 0.25 0.35 ... 0.37 1.   0.47]
 [0.36 0.17 0.3  ... 0.15 0.47 1.  ]]
Got 43 patterns after merging
2024-03-12 03:12:20.661934 MEMORY 16.130891776
Performing filtering
2024-03-12 03:12:20.662226 MEMORY 16.130891776
Got 37 patterns after filtering
2024-03-12 03:12:23.752948 MEMORY 16.130891776
Total time taken is 3623.52s
2024-03-12 03:12:23.753165 MEMORY 16.130891776
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 2370 tasks      | elapsed:    1.3s
[Parallel(n_jobs=24)]: Done 2426 out of 2426 | elapsed:    1.4s finished
/ru-auth/local/home/lzhao/anaconda3/envs/jupyter-ml-clone/lib/python3.9/site-packages/sklearn/manifold/_t_sne.py:691: FutureWarning: 'square_distances' has been introduced in 0.24 to help phase out legacy squaring behavior. The 'legacy' setting will be removed in 1.1 (renaming of 0.26), and the default setting will be changed to True. In 1.3, 'square_distances' will be removed altogether, and distances will be squared by default. Set 'square_distances'=True to silence this warning.
  warnings.warn(
/ru-auth/local/home/lzhao/anaconda3/envs/jupyter-ml-clone/lib/python3.9/site-packages/sklearn/neighbors/_base.py:175: EfficiencyWarning: Precomputed sparse input was not sorted by data.
  warnings.warn('Precomputed sparse input was not sorted by data.',
Applying subclustering to the final motifs
On pattern 0
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 2426 samples in 0.016s...
[t-SNE] Computed neighbors for 2426 samples in 0.002s...
[t-SNE] Computed conditional probabilities for sample 1000 / 2426
[t-SNE] Computed conditional probabilities for sample 2000 / 2426
[t-SNE] Computed conditional probabilities for sample 2426 / 2426
[t-SNE] Mean sigma: 0.294560
[t-SNE] Computed conditional probabilities in 0.174s
[t-SNE] Iteration 50: error = 71.7252808, gradient norm = 0.0511225 (50 iterations in 0.256s)
[t-SNE] Iteration 100: error = 71.7183533, gradient norm = 0.0442690 (50 iterations in 0.257s)
[t-SNE] Iteration 150: error = 71.7138596, gradient norm = 0.0368258 (50 iterations in 0.261s)
[t-SNE] Iteration 200: error = 71.7132721, gradient norm = 0.0358144 (50 iterations in 0.259s)
[t-SNE] Iteration 250: error = 71.7136993, gradient norm = 0.0362621 (50 iterations in 0.271s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 71.713699
[t-SNE] Iteration 300: error = 2.4417298, gradient norm = 0.0012507 (50 iterations in 0.222s)
[t-SNE] Iteration 350: error = 2.3203893, gradient norm = 0.0005000 (50 iterations in 0.210s)
[t-SNE] Iteration 400: error = 2.2646587, gradient norm = 0.0002793 (50 iterations in 0.209s)
[t-SNE] Iteration 450: error = 2.2380345, gradient norm = 0.0001612 (50 iterations in 0.209s)
[t-SNE] Iteration 500: error = 2.2218020, gradient norm = 0.0001293 (50 iterations in 0.209s)
[t-SNE] Iteration 550: error = 2.2142005, gradient norm = 0.0001198 (50 iterations in 0.209s)
[t-SNE] Iteration 600: error = 2.2076957, gradient norm = 0.0000679 (50 iterations in 0.211s)
[t-SNE] Iteration 650: error = 2.2030354, gradient norm = 0.0000593 (50 iterations in 0.210s)
[t-SNE] Iteration 700: error = 2.1999881, gradient norm = 0.0000520 (50 iterations in 0.210s)
[t-SNE] Iteration 750: error = 2.1977141, gradient norm = 0.0000532 (50 iterations in 0.214s)
[t-SNE] Iteration 800: error = 2.1958361, gradient norm = 0.0000519 (50 iterations in 0.209s)
[t-SNE] Iteration 850: error = 2.1946154, gradient norm = 0.0000472 (50 iterations in 0.212s)
[t-SNE] Iteration 900: error = 2.1934557, gradient norm = 0.0000470 (50 iterations in 0.210s)
[t-SNE] Iteration 950: error = 2.1925368, gradient norm = 0.0000397 (50 iterations in 0.226s)
[t-SNE] Iteration 1000: error = 2.1917982, gradient norm = 0.0000315 (50 iterations in 0.214s)
[t-SNE] KL divergence after 1000 iterations: 2.191798
[t-SNE] Computed conditional probabilities for sample 1000 / 2426
[t-SNE] Computed conditional probabilities for sample 2000 / 2426
[t-SNE] Computed conditional probabilities for sample 2426 / 2426
[t-SNE] Mean sigma: 0.294560
Beginning preprocessing + Leiden
2024-03-12 03:12:32.727861 MEMORY 16.131231744
Affmat transformed
2024-03-12 03:12:32.763189 MEMORY 16.131231744
sources, targets, weights extracted
2024-03-12 03:12:32.786536 MEMORY 16.131231744
About to launch parallel Leiden runs
2024-03-12 03:12:32.799557 MEMORY 16.13121536
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:   11.4s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   37.2s finished
Parallel Leiden runs finished
2024-03-12 03:13:09.991749 MEMORY 16.13121536
Quality: 0.45406313474246757
Quality: 0.4560372861234238
Quality: 0.4579129368592353
Quality: 0.458475783507445
Quality: 0.4585538637852708
Quality: 0.4589904914062672
Quality: 0.45948949981315046
Quality: 0.459717328106415
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 1913 out of 1913 | elapsed:    0.9s finished
Got subclusters: Counter({0: 372, 1: 371, 2: 336, 3: 316, 4: 235, 5: 216, 6: 205, 7: 164, 8: 135, 9: 38, 10: 38})
On pattern 1
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 1913 samples in 0.012s...
[t-SNE] Computed neighbors for 1913 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 1000 / 1913
[t-SNE] Computed conditional probabilities for sample 1913 / 1913
[t-SNE] Mean sigma: 0.297284
[t-SNE] Computed conditional probabilities in 0.135s
[t-SNE] Iteration 50: error = 69.7984314, gradient norm = 0.1202980 (50 iterations in 0.210s)
[t-SNE] Iteration 100: error = 69.7828522, gradient norm = 0.1227979 (50 iterations in 0.225s)
[t-SNE] Iteration 150: error = 69.2312546, gradient norm = 0.1350113 (50 iterations in 0.216s)
[t-SNE] Iteration 200: error = 69.3005295, gradient norm = 0.1382938 (50 iterations in 0.230s)
[t-SNE] Iteration 250: error = 69.4010391, gradient norm = 0.1336188 (50 iterations in 0.221s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 69.401039
[t-SNE] Iteration 300: error = 2.0781016, gradient norm = 0.0012477 (50 iterations in 0.186s)
[t-SNE] Iteration 350: error = 1.9719272, gradient norm = 0.0003793 (50 iterations in 0.176s)
[t-SNE] Iteration 400: error = 1.9331805, gradient norm = 0.0002131 (50 iterations in 0.177s)
[t-SNE] Iteration 450: error = 1.9173748, gradient norm = 0.0001476 (50 iterations in 0.176s)
[t-SNE] Iteration 500: error = 1.9093271, gradient norm = 0.0001097 (50 iterations in 0.176s)
[t-SNE] Iteration 550: error = 1.9038144, gradient norm = 0.0001097 (50 iterations in 0.177s)
[t-SNE] Iteration 600: error = 1.9010319, gradient norm = 0.0000880 (50 iterations in 0.177s)
[t-SNE] Iteration 650: error = 1.8984191, gradient norm = 0.0000865 (50 iterations in 0.176s)
[t-SNE] Iteration 700: error = 1.8963268, gradient norm = 0.0000774 (50 iterations in 0.175s)
[t-SNE] Iteration 750: error = 1.8946601, gradient norm = 0.0000633 (50 iterations in 0.176s)
[t-SNE] Iteration 800: error = 1.8936021, gradient norm = 0.0000504 (50 iterations in 0.177s)
[t-SNE] Iteration 850: error = 1.8926307, gradient norm = 0.0000455 (50 iterations in 0.176s)
[t-SNE] Iteration 900: error = 1.8911961, gradient norm = 0.0000806 (50 iterations in 0.176s)
[t-SNE] Iteration 950: error = 1.8904836, gradient norm = 0.0000472 (50 iterations in 0.177s)
[t-SNE] Iteration 1000: error = 1.8900172, gradient norm = 0.0000439 (50 iterations in 0.175s)
[t-SNE] KL divergence after 1000 iterations: 1.890017
[t-SNE] Computed conditional probabilities for sample 1000 / 1913
[t-SNE] Computed conditional probabilities for sample 1913 / 1913
[t-SNE] Mean sigma: 0.297284
Beginning preprocessing + Leiden
2024-03-12 03:13:17.322810 MEMORY 16.131231744
Affmat transformed
2024-03-12 03:13:17.350376 MEMORY 16.131231744
sources, targets, weights extracted
2024-03-12 03:13:17.368966 MEMORY 16.131231744
About to launch parallel Leiden runs
2024-03-12 03:13:17.379979 MEMORY 16.131223552
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    6.1s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   20.3s finished
Parallel Leiden runs finished
2024-03-12 03:13:37.712696 MEMORY 16.131223552
Quality: 0.4939847662573159
Quality: 0.4977458619565568
Quality: 0.49780504720338986
Quality: 0.4978307449280682
Quality: 0.49789784081782135
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 1650 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done 1711 out of 1711 | elapsed:    0.7s finished
Got subclusters: Counter({0: 352, 1: 312, 2: 308, 3: 298, 4: 268, 5: 144, 6: 139, 7: 92})
On pattern 2
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 1711 samples in 0.011s...
[t-SNE] Computed neighbors for 1711 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 1000 / 1711
[t-SNE] Computed conditional probabilities for sample 1711 / 1711
[t-SNE] Mean sigma: 0.283851
[t-SNE] Computed conditional probabilities in 0.120s
[t-SNE] Iteration 50: error = 68.5783844, gradient norm = 0.1651677 (50 iterations in 0.181s)
[t-SNE] Iteration 100: error = 68.8108139, gradient norm = 0.1486704 (50 iterations in 0.177s)
[t-SNE] Iteration 150: error = 68.8163071, gradient norm = 0.1498338 (50 iterations in 0.176s)
[t-SNE] Iteration 200: error = 68.4810028, gradient norm = 0.1613514 (50 iterations in 0.182s)
[t-SNE] Iteration 250: error = 68.3364105, gradient norm = 0.1710796 (50 iterations in 0.220s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 68.336411
[t-SNE] Iteration 300: error = 1.9515576, gradient norm = 0.0012972 (50 iterations in 0.154s)
[t-SNE] Iteration 350: error = 1.8556159, gradient norm = 0.0004764 (50 iterations in 0.153s)
[t-SNE] Iteration 400: error = 1.8202261, gradient norm = 0.0002286 (50 iterations in 0.154s)
[t-SNE] Iteration 450: error = 1.8064395, gradient norm = 0.0001451 (50 iterations in 0.153s)
[t-SNE] Iteration 500: error = 1.7966944, gradient norm = 0.0001771 (50 iterations in 0.153s)
[t-SNE] Iteration 550: error = 1.7927819, gradient norm = 0.0000872 (50 iterations in 0.157s)
[t-SNE] Iteration 600: error = 1.7899698, gradient norm = 0.0000986 (50 iterations in 0.155s)
[t-SNE] Iteration 650: error = 1.7874982, gradient norm = 0.0000971 (50 iterations in 0.154s)
[t-SNE] Iteration 700: error = 1.7860236, gradient norm = 0.0000756 (50 iterations in 0.151s)
[t-SNE] Iteration 750: error = 1.7845142, gradient norm = 0.0001236 (50 iterations in 0.150s)
[t-SNE] Iteration 800: error = 1.7833433, gradient norm = 0.0000659 (50 iterations in 0.151s)
[t-SNE] Iteration 850: error = 1.7826736, gradient norm = 0.0000642 (50 iterations in 0.152s)
[t-SNE] Iteration 900: error = 1.7811776, gradient norm = 0.0000805 (50 iterations in 0.155s)
[t-SNE] Iteration 950: error = 1.7802992, gradient norm = 0.0000566 (50 iterations in 0.150s)
[t-SNE] Iteration 1000: error = 1.7796826, gradient norm = 0.0000753 (50 iterations in 0.150s)
[t-SNE] KL divergence after 1000 iterations: 1.779683
[t-SNE] Computed conditional probabilities for sample 1000 / 1711
[t-SNE] Computed conditional probabilities for sample 1711 / 1711
[t-SNE] Mean sigma: 0.283851
Beginning preprocessing + Leiden
2024-03-12 03:13:44.003473 MEMORY 16.13123584
Affmat transformed
2024-03-12 03:13:44.031272 MEMORY 16.13123584
sources, targets, weights extracted
2024-03-12 03:13:44.048508 MEMORY 16.13123584
About to launch parallel Leiden runs
2024-03-12 03:13:44.058102 MEMORY 16.13123584
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    5.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   19.8s finished
Parallel Leiden runs finished
2024-03-12 03:14:03.828393 MEMORY 16.13123584
Quality: 0.484012783770817
Quality: 0.4840857403005662
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 928 out of 928 | elapsed:    0.3s finished
Got subclusters: Counter({0: 281, 1: 258, 2: 237, 3: 216, 4: 211, 5: 191, 6: 190, 7: 127})
On pattern 3
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 928 samples in 0.006s...
[t-SNE] Computed neighbors for 928 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 928 / 928
[t-SNE] Mean sigma: 0.364647
[t-SNE] Computed conditional probabilities in 0.064s
[t-SNE] Iteration 50: error = 66.7382507, gradient norm = 0.3095534 (50 iterations in 0.102s)
[t-SNE] Iteration 100: error = 68.6149445, gradient norm = 0.2941487 (50 iterations in 0.095s)
[t-SNE] Iteration 150: error = 68.0763550, gradient norm = 0.2832282 (50 iterations in 0.096s)
[t-SNE] Iteration 200: error = 67.6722412, gradient norm = 0.3029305 (50 iterations in 0.101s)
[t-SNE] Iteration 250: error = 67.9198914, gradient norm = 0.3079082 (50 iterations in 0.095s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 67.919891
[t-SNE] Iteration 300: error = 1.7709106, gradient norm = 0.0023500 (50 iterations in 0.091s)
[t-SNE] Iteration 350: error = 1.7230377, gradient norm = 0.0005510 (50 iterations in 0.086s)
[t-SNE] Iteration 400: error = 1.6991050, gradient norm = 0.0003712 (50 iterations in 0.086s)
[t-SNE] Iteration 450: error = 1.6814321, gradient norm = 0.0002743 (50 iterations in 0.087s)
[t-SNE] Iteration 500: error = 1.6770140, gradient norm = 0.0001753 (50 iterations in 0.087s)
[t-SNE] Iteration 550: error = 1.6732055, gradient norm = 0.0002898 (50 iterations in 0.099s)
[t-SNE] Iteration 600: error = 1.6710988, gradient norm = 0.0001485 (50 iterations in 0.090s)
[t-SNE] Iteration 650: error = 1.6701281, gradient norm = 0.0001210 (50 iterations in 0.088s)
[t-SNE] Iteration 700: error = 1.6693082, gradient norm = 0.0000636 (50 iterations in 0.086s)
[t-SNE] Iteration 750: error = 1.6677368, gradient norm = 0.0002309 (50 iterations in 0.086s)
[t-SNE] Iteration 800: error = 1.6665248, gradient norm = 0.0001193 (50 iterations in 0.087s)
[t-SNE] Iteration 850: error = 1.6653284, gradient norm = 0.0001104 (50 iterations in 0.088s)
[t-SNE] Iteration 900: error = 1.6638151, gradient norm = 0.0001131 (50 iterations in 0.087s)
[t-SNE] Iteration 950: error = 1.6630834, gradient norm = 0.0001037 (50 iterations in 0.086s)
[t-SNE] Iteration 1000: error = 1.6625738, gradient norm = 0.0001223 (50 iterations in 0.086s)
[t-SNE] KL divergence after 1000 iterations: 1.662574
[t-SNE] Computed conditional probabilities for sample 928 / 928
[t-SNE] Mean sigma: 0.364647
Beginning preprocessing + Leiden
2024-03-12 03:14:07.409825 MEMORY 16.13123584
Affmat transformed
2024-03-12 03:14:07.422534 MEMORY 16.13123584
sources, targets, weights extracted
2024-03-12 03:14:07.428944 MEMORY 16.13123584
About to launch parallel Leiden runs
2024-03-12 03:14:07.436001 MEMORY 16.131207168
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    2.4s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    7.8s finished
Parallel Leiden runs finished
2024-03-12 03:14:15.243890 MEMORY 16.131207168
Quality: 0.45767042053672685
Quality: 0.4577758685954396
Quality: 0.4579236747178628
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 642 out of 642 | elapsed:    0.3s finished
Got subclusters: Counter({0: 181, 1: 175, 2: 174, 3: 152, 4: 97, 5: 90, 6: 57, 7: 2})
On pattern 4
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 642 samples in 0.005s...
[t-SNE] Computed neighbors for 642 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 642 / 642
[t-SNE] Mean sigma: 0.350628
[t-SNE] Computed conditional probabilities in 0.049s
[t-SNE] Iteration 50: error = 67.9527740, gradient norm = 0.4186413 (50 iterations in 0.071s)
[t-SNE] Iteration 100: error = 69.8641052, gradient norm = 0.3976195 (50 iterations in 0.070s)
[t-SNE] Iteration 150: error = 69.6152496, gradient norm = 0.3844275 (50 iterations in 0.071s)
[t-SNE] Iteration 200: error = 70.2283859, gradient norm = 0.3931210 (50 iterations in 0.070s)
[t-SNE] Iteration 250: error = 69.0006027, gradient norm = 0.4128247 (50 iterations in 0.070s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 69.000603
[t-SNE] Iteration 300: error = 1.6472812, gradient norm = 0.0030529 (50 iterations in 0.066s)
[t-SNE] Iteration 350: error = 1.6034383, gradient norm = 0.0007186 (50 iterations in 0.064s)
[t-SNE] Iteration 400: error = 1.5920142, gradient norm = 0.0002216 (50 iterations in 0.064s)
[t-SNE] Iteration 450: error = 1.5865246, gradient norm = 0.0002276 (50 iterations in 0.064s)
[t-SNE] Iteration 500: error = 1.5838597, gradient norm = 0.0001267 (50 iterations in 0.064s)
[t-SNE] Iteration 550: error = 1.5823464, gradient norm = 0.0001493 (50 iterations in 0.064s)
[t-SNE] Iteration 600: error = 1.5791398, gradient norm = 0.0002961 (50 iterations in 0.064s)
[t-SNE] Iteration 650: error = 1.5778631, gradient norm = 0.0001404 (50 iterations in 0.064s)
[t-SNE] Iteration 700: error = 1.5774457, gradient norm = 0.0001375 (50 iterations in 0.064s)
[t-SNE] Iteration 750: error = 1.5770551, gradient norm = 0.0000644 (50 iterations in 0.064s)
[t-SNE] Iteration 800: error = 1.5770545, gradient norm = 0.0000843 (50 iterations in 0.064s)
[t-SNE] Iteration 850: error = 1.5765910, gradient norm = 0.0001437 (50 iterations in 0.064s)
[t-SNE] Iteration 900: error = 1.5761014, gradient norm = 0.0001175 (50 iterations in 0.064s)
[t-SNE] Iteration 950: error = 1.5759611, gradient norm = 0.0001268 (50 iterations in 0.064s)
[t-SNE] Iteration 1000: error = 1.5760837, gradient norm = 0.0001109 (50 iterations in 0.064s)
[t-SNE] KL divergence after 1000 iterations: 1.576084
[t-SNE] Computed conditional probabilities for sample 642 / 642
[t-SNE] Mean sigma: 0.350628
Beginning preprocessing + Leiden
2024-03-12 03:14:17.946251 MEMORY 16.131207168
Affmat transformed
2024-03-12 03:14:17.955015 MEMORY 16.131207168
sources, targets, weights extracted
2024-03-12 03:14:17.959707 MEMORY 16.131207168
About to launch parallel Leiden runs
2024-03-12 03:14:17.966355 MEMORY 16.131207168
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    5.3s finished
Parallel Leiden runs finished
2024-03-12 03:14:23.274061 MEMORY 16.131207168
Quality: 0.40430566894758335
Quality: 0.40506817543944057
Quality: 0.4053090893950761
Quality: 0.40545003459467727
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 633 out of 633 | elapsed:    0.3s finished
Got subclusters: Counter({0: 138, 1: 129, 2: 106, 3: 94, 4: 91, 5: 38, 6: 27, 7: 19})
On pattern 5
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 633 samples in 0.005s...
[t-SNE] Computed neighbors for 633 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 633 / 633
[t-SNE] Mean sigma: 0.304078
[t-SNE] Computed conditional probabilities in 0.047s
[t-SNE] Iteration 50: error = 68.1907806, gradient norm = 0.4281749 (50 iterations in 0.072s)
[t-SNE] Iteration 100: error = 71.9296188, gradient norm = 0.3917620 (50 iterations in 0.070s)
[t-SNE] Iteration 150: error = 71.4274368, gradient norm = 0.4093807 (50 iterations in 0.070s)
[t-SNE] Iteration 200: error = 71.4029846, gradient norm = 0.4080563 (50 iterations in 0.070s)
[t-SNE] Iteration 250: error = 70.2714767, gradient norm = 0.4060463 (50 iterations in 0.071s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 70.271477
[t-SNE] Iteration 300: error = 1.5421101, gradient norm = 0.0027165 (50 iterations in 0.071s)
[t-SNE] Iteration 350: error = 1.4474901, gradient norm = 0.0013141 (50 iterations in 0.066s)
[t-SNE] Iteration 400: error = 1.4297169, gradient norm = 0.0006481 (50 iterations in 0.065s)
[t-SNE] Iteration 450: error = 1.4190950, gradient norm = 0.0008269 (50 iterations in 0.065s)
[t-SNE] Iteration 500: error = 1.3965898, gradient norm = 0.0012840 (50 iterations in 0.065s)
[t-SNE] Iteration 550: error = 1.3880956, gradient norm = 0.0003757 (50 iterations in 0.065s)
[t-SNE] Iteration 600: error = 1.3805403, gradient norm = 0.0003188 (50 iterations in 0.065s)
[t-SNE] Iteration 650: error = 1.3774869, gradient norm = 0.0001568 (50 iterations in 0.065s)
[t-SNE] Iteration 700: error = 1.3735366, gradient norm = 0.0003694 (50 iterations in 0.065s)
[t-SNE] Iteration 750: error = 1.3657818, gradient norm = 0.0004237 (50 iterations in 0.065s)
[t-SNE] Iteration 800: error = 1.3629714, gradient norm = 0.0001942 (50 iterations in 0.065s)
[t-SNE] Iteration 850: error = 1.3607306, gradient norm = 0.0002096 (50 iterations in 0.065s)
[t-SNE] Iteration 900: error = 1.3596872, gradient norm = 0.0001537 (50 iterations in 0.065s)
[t-SNE] Iteration 950: error = 1.3583220, gradient norm = 0.0001417 (50 iterations in 0.065s)
[t-SNE] Iteration 1000: error = 1.3576999, gradient norm = 0.0001346 (50 iterations in 0.065s)
[t-SNE] KL divergence after 1000 iterations: 1.357700
[t-SNE] Computed conditional probabilities for sample 633 / 633
[t-SNE] Mean sigma: 0.304078
Beginning preprocessing + Leiden
2024-03-12 03:14:25.757091 MEMORY 16.131207168
Affmat transformed
2024-03-12 03:14:25.764756 MEMORY 16.131207168
sources, targets, weights extracted
2024-03-12 03:14:25.770307 MEMORY 16.131207168
About to launch parallel Leiden runs
2024-03-12 03:14:25.779523 MEMORY 16.131207168
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.9s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    6.0s finished
Parallel Leiden runs finished
2024-03-12 03:14:31.745529 MEMORY 16.131207168
Quality: 0.3962449325991344
Quality: 0.3970022246424818
Quality: 0.3980927759941721
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 612 out of 612 | elapsed:    0.3s finished
Got subclusters: Counter({0: 150, 1: 144, 2: 114, 3: 98, 4: 70, 5: 39, 6: 18})
On pattern 6
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 612 samples in 0.005s...
[t-SNE] Computed neighbors for 612 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 612 / 612
[t-SNE] Mean sigma: 0.351187
[t-SNE] Computed conditional probabilities in 0.046s
[t-SNE] Iteration 50: error = 67.6872864, gradient norm = 0.4367794 (50 iterations in 0.066s)
[t-SNE] Iteration 100: error = 69.3310852, gradient norm = 0.4004630 (50 iterations in 0.066s)
[t-SNE] Iteration 150: error = 69.5841522, gradient norm = 0.4049121 (50 iterations in 0.067s)
[t-SNE] Iteration 200: error = 70.2415695, gradient norm = 0.3975351 (50 iterations in 0.067s)
[t-SNE] Iteration 250: error = 70.2608337, gradient norm = 0.3840220 (50 iterations in 0.067s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 70.260834
[t-SNE] Iteration 300: error = 1.5476673, gradient norm = 0.0029013 (50 iterations in 0.064s)
[t-SNE] Iteration 350: error = 1.4798933, gradient norm = 0.0011221 (50 iterations in 0.063s)
[t-SNE] Iteration 400: error = 1.4451655, gradient norm = 0.0009021 (50 iterations in 0.063s)
[t-SNE] Iteration 450: error = 1.4311168, gradient norm = 0.0004905 (50 iterations in 0.063s)
[t-SNE] Iteration 500: error = 1.4260504, gradient norm = 0.0003228 (50 iterations in 0.063s)
[t-SNE] Iteration 550: error = 1.4171286, gradient norm = 0.0005241 (50 iterations in 0.064s)
[t-SNE] Iteration 600: error = 1.4103851, gradient norm = 0.0002528 (50 iterations in 0.064s)
[t-SNE] Iteration 650: error = 1.4077970, gradient norm = 0.0002074 (50 iterations in 0.064s)
[t-SNE] Iteration 700: error = 1.4048543, gradient norm = 0.0001013 (50 iterations in 0.063s)
[t-SNE] Iteration 750: error = 1.4044330, gradient norm = 0.0000765 (50 iterations in 0.063s)
[t-SNE] Iteration 800: error = 1.4042354, gradient norm = 0.0000670 (50 iterations in 0.063s)
[t-SNE] Iteration 850: error = 1.4035158, gradient norm = 0.0001217 (50 iterations in 0.063s)
[t-SNE] Iteration 900: error = 1.4026370, gradient norm = 0.0001348 (50 iterations in 0.063s)
[t-SNE] Iteration 950: error = 1.4016137, gradient norm = 0.0001826 (50 iterations in 0.064s)
[t-SNE] Iteration 1000: error = 1.4002185, gradient norm = 0.0001612 (50 iterations in 0.063s)
[t-SNE] KL divergence after 1000 iterations: 1.400218
[t-SNE] Computed conditional probabilities for sample 612 / 612
[t-SNE] Mean sigma: 0.351187
Beginning preprocessing + Leiden
2024-03-12 03:14:34.164489 MEMORY 16.131207168
Affmat transformed
2024-03-12 03:14:34.172734 MEMORY 16.131207168
sources, targets, weights extracted
2024-03-12 03:14:34.178281 MEMORY 16.131207168
About to launch parallel Leiden runs
2024-03-12 03:14:34.184560 MEMORY 16.131182592
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    5.5s finished
Parallel Leiden runs finished
2024-03-12 03:14:39.700849 MEMORY 16.131182592
Quality: 0.41568146622933017
Quality: 0.4173391353120009
Quality: 0.4174306685589987
Quality: 0.41770204699171587
Quality: 0.41774013538883653
Quality: 0.4180761989104753
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 602 out of 602 | elapsed:    0.3s finished
Got subclusters: Counter({0: 121, 1: 118, 2: 85, 3: 71, 4: 61, 5: 59, 6: 53, 7: 44})
On pattern 7
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 602 samples in 0.005s...
[t-SNE] Computed neighbors for 602 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 602 / 602
[t-SNE] Mean sigma: 0.360997
[t-SNE] Computed conditional probabilities in 0.044s
[t-SNE] Iteration 50: error = 66.7092056, gradient norm = 0.4387103 (50 iterations in 0.073s)
[t-SNE] Iteration 100: error = 68.8272476, gradient norm = 0.4153635 (50 iterations in 0.068s)
[t-SNE] Iteration 150: error = 69.0959854, gradient norm = 0.4225150 (50 iterations in 0.067s)
[t-SNE] Iteration 200: error = 68.8435745, gradient norm = 0.4292618 (50 iterations in 0.068s)
[t-SNE] Iteration 250: error = 69.5812225, gradient norm = 0.4112953 (50 iterations in 0.068s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 69.581223
[t-SNE] Iteration 300: error = 1.6152061, gradient norm = 0.0038102 (50 iterations in 0.065s)
[t-SNE] Iteration 350: error = 1.5620559, gradient norm = 0.0010725 (50 iterations in 0.065s)
[t-SNE] Iteration 400: error = 1.5344813, gradient norm = 0.0005821 (50 iterations in 0.063s)
[t-SNE] Iteration 450: error = 1.5269798, gradient norm = 0.0003346 (50 iterations in 0.063s)
[t-SNE] Iteration 500: error = 1.5131704, gradient norm = 0.0009865 (50 iterations in 0.062s)
[t-SNE] Iteration 550: error = 1.4881505, gradient norm = 0.0006817 (50 iterations in 0.062s)
[t-SNE] Iteration 600: error = 1.4760096, gradient norm = 0.0005389 (50 iterations in 0.062s)
[t-SNE] Iteration 650: error = 1.4691881, gradient norm = 0.0004510 (50 iterations in 0.063s)
[t-SNE] Iteration 700: error = 1.4655588, gradient norm = 0.0002341 (50 iterations in 0.063s)
[t-SNE] Iteration 750: error = 1.4628595, gradient norm = 0.0001573 (50 iterations in 0.063s)
[t-SNE] Iteration 800: error = 1.4556513, gradient norm = 0.0002700 (50 iterations in 0.065s)
[t-SNE] Iteration 850: error = 1.4516356, gradient norm = 0.0002000 (50 iterations in 0.063s)
[t-SNE] Iteration 900: error = 1.4488955, gradient norm = 0.0002073 (50 iterations in 0.063s)
[t-SNE] Iteration 950: error = 1.4482545, gradient norm = 0.0001336 (50 iterations in 0.063s)
[t-SNE] Iteration 1000: error = 1.4472988, gradient norm = 0.0001547 (50 iterations in 0.062s)
[t-SNE] KL divergence after 1000 iterations: 1.447299
[t-SNE] Computed conditional probabilities for sample 602 / 602
[t-SNE] Mean sigma: 0.360997
Beginning preprocessing + Leiden
2024-03-12 03:14:42.054443 MEMORY 16.131182592
Affmat transformed
2024-03-12 03:14:42.063225 MEMORY 16.131182592
sources, targets, weights extracted
2024-03-12 03:14:42.068046 MEMORY 16.131182592
About to launch parallel Leiden runs
2024-03-12 03:14:42.075331 MEMORY 16.131182592
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.8s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    5.6s finished
Parallel Leiden runs finished
2024-03-12 03:14:47.722297 MEMORY 16.131182592
Quality: 0.4001890077410701
Quality: 0.40023209943760407
Quality: 0.4004806944712359
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 492 out of 539 | elapsed:    0.2s remaining:    0.0s
[Parallel(n_jobs=24)]: Done 539 out of 539 | elapsed:    0.2s finished
Got subclusters: Counter({0: 132, 1: 129, 2: 106, 3: 84, 4: 59, 5: 54, 6: 38})
On pattern 8
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 539 samples in 0.005s...
[t-SNE] Computed neighbors for 539 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 539 / 539
[t-SNE] Mean sigma: 0.343183
[t-SNE] Computed conditional probabilities in 0.042s
[t-SNE] Iteration 50: error = 68.5802383, gradient norm = 0.4429678 (50 iterations in 0.063s)
[t-SNE] Iteration 100: error = 71.1705322, gradient norm = 0.4017601 (50 iterations in 0.061s)
[t-SNE] Iteration 150: error = 71.9940338, gradient norm = 0.4221924 (50 iterations in 0.064s)
[t-SNE] Iteration 200: error = 71.8929596, gradient norm = 0.4123789 (50 iterations in 0.061s)
[t-SNE] Iteration 250: error = 73.4478302, gradient norm = 0.3948725 (50 iterations in 0.065s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 73.447830
[t-SNE] Iteration 300: error = 1.4334568, gradient norm = 0.0041359 (50 iterations in 0.063s)
[t-SNE] Iteration 350: error = 1.3436294, gradient norm = 0.0015389 (50 iterations in 0.058s)
[t-SNE] Iteration 400: error = 1.3103907, gradient norm = 0.0008051 (50 iterations in 0.058s)
[t-SNE] Iteration 450: error = 1.2991017, gradient norm = 0.0003118 (50 iterations in 0.057s)
[t-SNE] Iteration 500: error = 1.2775147, gradient norm = 0.0011105 (50 iterations in 0.057s)
[t-SNE] Iteration 550: error = 1.2600992, gradient norm = 0.0009060 (50 iterations in 0.057s)
[t-SNE] Iteration 600: error = 1.2482029, gradient norm = 0.0006109 (50 iterations in 0.057s)
[t-SNE] Iteration 650: error = 1.2455289, gradient norm = 0.0001905 (50 iterations in 0.057s)
[t-SNE] Iteration 700: error = 1.2393585, gradient norm = 0.0005573 (50 iterations in 0.057s)
[t-SNE] Iteration 750: error = 1.2364821, gradient norm = 0.0001869 (50 iterations in 0.057s)
[t-SNE] Iteration 800: error = 1.2251219, gradient norm = 0.0007933 (50 iterations in 0.057s)
[t-SNE] Iteration 850: error = 1.2203842, gradient norm = 0.0002969 (50 iterations in 0.058s)
[t-SNE] Iteration 900: error = 1.2179382, gradient norm = 0.0002611 (50 iterations in 0.057s)
[t-SNE] Iteration 950: error = 1.2150788, gradient norm = 0.0004643 (50 iterations in 0.057s)
[t-SNE] Iteration 1000: error = 1.2123104, gradient norm = 0.0001191 (50 iterations in 0.057s)
[t-SNE] KL divergence after 1000 iterations: 1.212310
[t-SNE] Computed conditional probabilities for sample 539 / 539
[t-SNE] Mean sigma: 0.343183
Beginning preprocessing + Leiden
2024-03-12 03:14:49.818370 MEMORY 16.131182592
Affmat transformed
2024-03-12 03:14:49.825977 MEMORY 16.131182592
sources, targets, weights extracted
2024-03-12 03:14:49.830506 MEMORY 16.131182592
About to launch parallel Leiden runs
2024-03-12 03:14:49.836855 MEMORY 16.131182592
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.6s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    4.9s finished
Parallel Leiden runs finished
2024-03-12 03:14:54.706571 MEMORY 16.131182592
Quality: 0.41763703995357326
Quality: 0.4202376500150939
Quality: 0.4205693928641526
Quality: 0.42178109877833414
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 533 out of 533 | elapsed:    0.2s finished
Got subclusters: Counter({0: 120, 1: 118, 2: 84, 3: 82, 4: 74, 5: 61})
On pattern 9
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 533 samples in 0.004s...
[t-SNE] Computed neighbors for 533 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 533 / 533
[t-SNE] Mean sigma: 0.333972
[t-SNE] Computed conditional probabilities in 0.038s
[t-SNE] Iteration 50: error = 71.5042496, gradient norm = 0.4223554 (50 iterations in 0.061s)
[t-SNE] Iteration 100: error = 74.2324905, gradient norm = 0.4030892 (50 iterations in 0.061s)
[t-SNE] Iteration 150: error = 76.8941879, gradient norm = 0.3870595 (50 iterations in 0.064s)
[t-SNE] Iteration 200: error = 76.9115677, gradient norm = 0.3887448 (50 iterations in 0.062s)
[t-SNE] Iteration 250: error = 76.7874832, gradient norm = 0.3760737 (50 iterations in 0.064s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 76.787483
[t-SNE] Iteration 300: error = 1.6348512, gradient norm = 0.0044998 (50 iterations in 0.061s)
[t-SNE] Iteration 350: error = 1.4909054, gradient norm = 0.0015129 (50 iterations in 0.057s)
[t-SNE] Iteration 400: error = 1.4347020, gradient norm = 0.0014377 (50 iterations in 0.057s)
[t-SNE] Iteration 450: error = 1.3976058, gradient norm = 0.0012863 (50 iterations in 0.057s)
[t-SNE] Iteration 500: error = 1.3860383, gradient norm = 0.0004518 (50 iterations in 0.057s)
[t-SNE] Iteration 550: error = 1.3670864, gradient norm = 0.0013042 (50 iterations in 0.057s)
[t-SNE] Iteration 600: error = 1.3551357, gradient norm = 0.0003785 (50 iterations in 0.057s)
[t-SNE] Iteration 650: error = 1.3420333, gradient norm = 0.0004608 (50 iterations in 0.057s)
[t-SNE] Iteration 700: error = 1.3367189, gradient norm = 0.0003250 (50 iterations in 0.057s)
[t-SNE] Iteration 750: error = 1.3350006, gradient norm = 0.0001360 (50 iterations in 0.056s)
[t-SNE] Iteration 800: error = 1.3335931, gradient norm = 0.0001730 (50 iterations in 0.057s)
[t-SNE] Iteration 850: error = 1.3300539, gradient norm = 0.0003361 (50 iterations in 0.057s)
[t-SNE] Iteration 900: error = 1.3294178, gradient norm = 0.0000778 (50 iterations in 0.059s)
[t-SNE] Iteration 950: error = 1.3293208, gradient norm = 0.0000731 (50 iterations in 0.057s)
[t-SNE] Iteration 1000: error = 1.3291543, gradient norm = 0.0000619 (50 iterations in 0.059s)
[t-SNE] KL divergence after 1000 iterations: 1.329154
[t-SNE] Computed conditional probabilities for sample 533 / 533
[t-SNE] Mean sigma: 0.333972
Beginning preprocessing + Leiden
2024-03-12 03:14:56.772401 MEMORY 16.131182592
Affmat transformed
2024-03-12 03:14:56.780318 MEMORY 16.131182592
sources, targets, weights extracted
2024-03-12 03:14:56.785606 MEMORY 16.131182592
About to launch parallel Leiden runs
2024-03-12 03:14:56.792050 MEMORY 16.131182592
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.6s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    4.9s finished
Parallel Leiden runs finished
2024-03-12 03:15:01.739824 MEMORY 16.131182592
Quality: 0.35691910442676844
Quality: 0.3584998279352279
Quality: 0.35902608068002884
Quality: 0.35923852715478405
Quality: 0.35925538590256023
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 532 out of 532 | elapsed:    0.2s finished
Got subclusters: Counter({0: 91, 1: 73, 2: 72, 3: 69, 4: 66, 5: 53, 6: 41, 7: 35, 8: 33})
On pattern 10
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 532 samples in 0.004s...
[t-SNE] Computed neighbors for 532 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 532 / 532
[t-SNE] Mean sigma: 0.332261
[t-SNE] Computed conditional probabilities in 0.041s
[t-SNE] Iteration 50: error = 69.3626633, gradient norm = 0.4337293 (50 iterations in 0.067s)
[t-SNE] Iteration 100: error = 70.4617081, gradient norm = 0.4205838 (50 iterations in 0.062s)
[t-SNE] Iteration 150: error = 69.7348480, gradient norm = 0.4410207 (50 iterations in 0.063s)
[t-SNE] Iteration 200: error = 73.1586533, gradient norm = 0.3852831 (50 iterations in 0.063s)
[t-SNE] Iteration 250: error = 71.0239487, gradient norm = 0.4332488 (50 iterations in 0.063s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 71.023949
[t-SNE] Iteration 300: error = 1.5244439, gradient norm = 0.0041571 (50 iterations in 0.060s)
[t-SNE] Iteration 350: error = 1.4223499, gradient norm = 0.0014544 (50 iterations in 0.059s)
[t-SNE] Iteration 400: error = 1.3739967, gradient norm = 0.0012176 (50 iterations in 0.059s)
[t-SNE] Iteration 450: error = 1.3525079, gradient norm = 0.0011159 (50 iterations in 0.059s)
[t-SNE] Iteration 500: error = 1.3355560, gradient norm = 0.0004067 (50 iterations in 0.059s)
[t-SNE] Iteration 550: error = 1.3269167, gradient norm = 0.0007550 (50 iterations in 0.059s)
[t-SNE] Iteration 600: error = 1.3240830, gradient norm = 0.0002431 (50 iterations in 0.059s)
[t-SNE] Iteration 650: error = 1.3215902, gradient norm = 0.0004157 (50 iterations in 0.059s)
[t-SNE] Iteration 700: error = 1.3188035, gradient norm = 0.0003119 (50 iterations in 0.059s)
[t-SNE] Iteration 750: error = 1.3163177, gradient norm = 0.0001484 (50 iterations in 0.060s)
[t-SNE] Iteration 800: error = 1.3161559, gradient norm = 0.0000653 (50 iterations in 0.060s)
[t-SNE] Iteration 850: error = 1.3156419, gradient norm = 0.0001025 (50 iterations in 0.060s)
[t-SNE] Iteration 900: error = 1.3153825, gradient norm = 0.0000831 (50 iterations in 0.059s)
[t-SNE] Iteration 950: error = 1.3153250, gradient norm = 0.0000498 (50 iterations in 0.060s)
[t-SNE] Iteration 1000: error = 1.3151901, gradient norm = 0.0000330 (50 iterations in 0.059s)
[t-SNE] KL divergence after 1000 iterations: 1.315190
[t-SNE] Computed conditional probabilities for sample 532 / 532
[t-SNE] Mean sigma: 0.332261
Beginning preprocessing + Leiden
2024-03-12 03:15:03.974417 MEMORY 16.131182592
Affmat transformed
2024-03-12 03:15:03.981445 MEMORY 16.131182592
sources, targets, weights extracted
2024-03-12 03:15:03.985938 MEMORY 16.131182592
About to launch parallel Leiden runs
2024-03-12 03:15:03.992375 MEMORY 16.131182592
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.6s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    5.4s finished
Parallel Leiden runs finished
2024-03-12 03:15:09.433559 MEMORY 16.131182592
Quality: 0.36918140821430867
Quality: 0.3698684774131223
Quality: 0.37104660747467355
Quality: 0.37156321006489096
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 344 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 513 out of 513 | elapsed:    0.3s finished
Got subclusters: Counter({0: 116, 1: 107, 2: 93, 3: 90, 4: 56, 5: 53, 6: 17})
On pattern 11
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 513 samples in 0.004s...
[t-SNE] Computed neighbors for 513 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 513 / 513
[t-SNE] Mean sigma: 0.355525
[t-SNE] Computed conditional probabilities in 0.039s
[t-SNE] Iteration 50: error = 68.0936508, gradient norm = 0.4584101 (50 iterations in 0.071s)
[t-SNE] Iteration 100: error = 68.8843079, gradient norm = 0.4831919 (50 iterations in 0.070s)
[t-SNE] Iteration 150: error = 72.2306900, gradient norm = 0.4260006 (50 iterations in 0.060s)
[t-SNE] Iteration 200: error = 71.1491318, gradient norm = 0.4441468 (50 iterations in 0.063s)
[t-SNE] Iteration 250: error = 69.5186386, gradient norm = 0.4417398 (50 iterations in 0.063s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 69.518639
[t-SNE] Iteration 300: error = 1.4737929, gradient norm = 0.0029565 (50 iterations in 0.058s)
[t-SNE] Iteration 350: error = 1.3940173, gradient norm = 0.0015892 (50 iterations in 0.055s)
[t-SNE] Iteration 400: error = 1.3467671, gradient norm = 0.0011987 (50 iterations in 0.055s)
[t-SNE] Iteration 450: error = 1.3281717, gradient norm = 0.0004930 (50 iterations in 0.055s)
[t-SNE] Iteration 500: error = 1.3047061, gradient norm = 0.0010492 (50 iterations in 0.055s)
[t-SNE] Iteration 550: error = 1.2986567, gradient norm = 0.0003423 (50 iterations in 0.055s)
[t-SNE] Iteration 600: error = 1.2968686, gradient norm = 0.0001043 (50 iterations in 0.055s)
[t-SNE] Iteration 650: error = 1.2943324, gradient norm = 0.0002774 (50 iterations in 0.055s)
[t-SNE] Iteration 700: error = 1.2937843, gradient norm = 0.0000543 (50 iterations in 0.055s)
[t-SNE] Iteration 750: error = 1.2932409, gradient norm = 0.0000899 (50 iterations in 0.055s)
[t-SNE] Iteration 800: error = 1.2924825, gradient norm = 0.0000815 (50 iterations in 0.054s)
[t-SNE] Iteration 850: error = 1.2921669, gradient norm = 0.0000860 (50 iterations in 0.055s)
[t-SNE] Iteration 900: error = 1.2904217, gradient norm = 0.0002207 (50 iterations in 0.055s)
[t-SNE] Iteration 950: error = 1.2903180, gradient norm = 0.0000390 (50 iterations in 0.055s)
[t-SNE] Iteration 1000: error = 1.2902664, gradient norm = 0.0000372 (50 iterations in 0.054s)
[t-SNE] KL divergence after 1000 iterations: 1.290266
[t-SNE] Computed conditional probabilities for sample 513 / 513
[t-SNE] Mean sigma: 0.355525
Beginning preprocessing + Leiden
2024-03-12 03:15:11.549221 MEMORY 16.131182592
Affmat transformed
2024-03-12 03:15:11.556490 MEMORY 16.131182592
sources, targets, weights extracted
2024-03-12 03:15:11.560377 MEMORY 16.131182592
About to launch parallel Leiden runs
2024-03-12 03:15:11.566758 MEMORY 16.131182592
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    4.9s finished
Parallel Leiden runs finished
2024-03-12 03:15:16.515092 MEMORY 16.131182592
Quality: 0.3771099429590475
Quality: 0.3786669583309298
Quality: 0.3803449844672638
Quality: 0.38063353629499835
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 344 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 464 out of 464 | elapsed:    0.2s finished
Got subclusters: Counter({0: 122, 1: 92, 2: 90, 3: 80, 4: 53, 5: 50, 6: 26})
On pattern 12
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 464 samples in 0.004s...
[t-SNE] Computed neighbors for 464 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 464 / 464
[t-SNE] Mean sigma: 0.345677
[t-SNE] Computed conditional probabilities in 0.036s
[t-SNE] Iteration 50: error = 69.1272736, gradient norm = 0.4577778 (50 iterations in 0.053s)
[t-SNE] Iteration 100: error = 71.1265411, gradient norm = 0.4397596 (50 iterations in 0.053s)
[t-SNE] Iteration 150: error = 72.8928223, gradient norm = 0.4297904 (50 iterations in 0.053s)
[t-SNE] Iteration 200: error = 72.5579147, gradient norm = 0.4136952 (50 iterations in 0.053s)
[t-SNE] Iteration 250: error = 70.1289444, gradient norm = 0.4404509 (50 iterations in 0.053s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 70.128944
[t-SNE] Iteration 300: error = 1.3416716, gradient norm = 0.0033569 (50 iterations in 0.051s)
[t-SNE] Iteration 350: error = 1.2529424, gradient norm = 0.0021863 (50 iterations in 0.051s)
[t-SNE] Iteration 400: error = 1.2108163, gradient norm = 0.0006747 (50 iterations in 0.051s)
[t-SNE] Iteration 450: error = 1.1759243, gradient norm = 0.0011135 (50 iterations in 0.051s)
[t-SNE] Iteration 500: error = 1.1614156, gradient norm = 0.0005175 (50 iterations in 0.050s)
[t-SNE] Iteration 550: error = 1.1466666, gradient norm = 0.0004712 (50 iterations in 0.050s)
[t-SNE] Iteration 600: error = 1.1402271, gradient norm = 0.0004771 (50 iterations in 0.051s)
[t-SNE] Iteration 650: error = 1.1362818, gradient norm = 0.0002908 (50 iterations in 0.050s)
[t-SNE] Iteration 700: error = 1.1214800, gradient norm = 0.0005329 (50 iterations in 0.050s)
[t-SNE] Iteration 750: error = 1.1203401, gradient norm = 0.0001184 (50 iterations in 0.050s)
[t-SNE] Iteration 800: error = 1.1194859, gradient norm = 0.0000979 (50 iterations in 0.050s)
[t-SNE] Iteration 850: error = 1.1192186, gradient norm = 0.0001208 (50 iterations in 0.050s)
[t-SNE] Iteration 900: error = 1.1188459, gradient norm = 0.0001388 (50 iterations in 0.050s)
[t-SNE] Iteration 950: error = 1.1185658, gradient norm = 0.0001418 (50 iterations in 0.050s)
[t-SNE] Iteration 1000: error = 1.1123127, gradient norm = 0.0005746 (50 iterations in 0.050s)
[t-SNE] KL divergence after 1000 iterations: 1.112313
[t-SNE] Computed conditional probabilities for sample 464 / 464
[t-SNE] Mean sigma: 0.345677
Beginning preprocessing + Leiden
2024-03-12 03:15:18.423867 MEMORY 16.131182592
Affmat transformed
2024-03-12 03:15:18.430218 MEMORY 16.131182592
sources, targets, weights extracted
2024-03-12 03:15:18.434280 MEMORY 16.131182592
About to launch parallel Leiden runs
2024-03-12 03:15:18.439883 MEMORY 16.131182592
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.4s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    4.3s finished
Parallel Leiden runs finished
2024-03-12 03:15:22.757873 MEMORY 16.131182592
Quality: 0.40833573496389425
Quality: 0.41037907984345207
Quality: 0.41060873912427903
Quality: 0.4107237790721931
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 344 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 450 out of 450 | elapsed:    0.2s finished
Got subclusters: Counter({0: 134, 1: 100, 2: 99, 3: 58, 4: 41, 5: 25, 6: 7})
On pattern 13
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 450 samples in 0.004s...
[t-SNE] Computed neighbors for 450 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 450 / 450
[t-SNE] Mean sigma: 0.337158
[t-SNE] Computed conditional probabilities in 0.035s
[t-SNE] Iteration 50: error = 68.1379395, gradient norm = 0.4700500 (50 iterations in 0.053s)
[t-SNE] Iteration 100: error = 70.2278214, gradient norm = 0.4565297 (50 iterations in 0.053s)
[t-SNE] Iteration 150: error = 70.9839478, gradient norm = 0.4495472 (50 iterations in 0.053s)
[t-SNE] Iteration 200: error = 70.6348419, gradient norm = 0.4587700 (50 iterations in 0.053s)
[t-SNE] Iteration 250: error = 68.9777679, gradient norm = 0.4608813 (50 iterations in 0.053s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 68.977768
[t-SNE] Iteration 300: error = 1.3784318, gradient norm = 0.0046244 (50 iterations in 0.052s)
[t-SNE] Iteration 350: error = 1.3021060, gradient norm = 0.0013869 (50 iterations in 0.052s)
[t-SNE] Iteration 400: error = 1.2891787, gradient norm = 0.0004636 (50 iterations in 0.052s)
[t-SNE] Iteration 450: error = 1.2735846, gradient norm = 0.0014221 (50 iterations in 0.052s)
[t-SNE] Iteration 500: error = 1.2506596, gradient norm = 0.0006215 (50 iterations in 0.052s)
[t-SNE] Iteration 550: error = 1.2364025, gradient norm = 0.0005699 (50 iterations in 0.052s)
[t-SNE] Iteration 600: error = 1.2298396, gradient norm = 0.0002550 (50 iterations in 0.052s)
[t-SNE] Iteration 650: error = 1.2283829, gradient norm = 0.0002245 (50 iterations in 0.051s)
[t-SNE] Iteration 700: error = 1.2268406, gradient norm = 0.0002638 (50 iterations in 0.051s)
[t-SNE] Iteration 750: error = 1.2242246, gradient norm = 0.0002293 (50 iterations in 0.051s)
[t-SNE] Iteration 800: error = 1.2209450, gradient norm = 0.0003109 (50 iterations in 0.052s)
[t-SNE] Iteration 850: error = 1.2181634, gradient norm = 0.0002525 (50 iterations in 0.052s)
[t-SNE] Iteration 900: error = 1.2163998, gradient norm = 0.0002028 (50 iterations in 0.051s)
[t-SNE] Iteration 950: error = 1.2160167, gradient norm = 0.0000891 (50 iterations in 0.052s)
[t-SNE] Iteration 1000: error = 1.2154710, gradient norm = 0.0000905 (50 iterations in 0.051s)
[t-SNE] KL divergence after 1000 iterations: 1.215471
[t-SNE] Computed conditional probabilities for sample 450 / 450
[t-SNE] Mean sigma: 0.337158
Beginning preprocessing + Leiden
2024-03-12 03:15:24.653640 MEMORY 16.131182592
Affmat transformed
2024-03-12 03:15:24.659972 MEMORY 16.131182592
sources, targets, weights extracted
2024-03-12 03:15:24.664798 MEMORY 16.131182592
About to launch parallel Leiden runs
2024-03-12 03:15:24.670470 MEMORY 16.131182592
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.4s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    4.2s finished
Parallel Leiden runs finished
2024-03-12 03:15:28.840344 MEMORY 16.131182592
Quality: 0.37439208369034055
Quality: 0.37493712286095404
Quality: 0.37892404751802194
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 344 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 420 out of 420 | elapsed:    0.2s finished
Got subclusters: Counter({0: 99, 1: 94, 2: 91, 3: 72, 4: 56, 5: 38})
On pattern 14
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 420 samples in 0.004s...
[t-SNE] Computed neighbors for 420 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 420 / 420
[t-SNE] Mean sigma: 0.362476
[t-SNE] Computed conditional probabilities in 0.031s
[t-SNE] Iteration 50: error = 67.7603760, gradient norm = 0.4684389 (50 iterations in 0.069s)
[t-SNE] Iteration 100: error = 68.7115784, gradient norm = 0.4706094 (50 iterations in 0.048s)
[t-SNE] Iteration 150: error = 69.0877075, gradient norm = 0.4533134 (50 iterations in 0.051s)
[t-SNE] Iteration 200: error = 71.3224106, gradient norm = 0.4501309 (50 iterations in 0.049s)
[t-SNE] Iteration 250: error = 69.1446686, gradient norm = 0.4681033 (50 iterations in 0.049s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 69.144669
[t-SNE] Iteration 300: error = 1.3552294, gradient norm = 0.0042687 (50 iterations in 0.047s)
[t-SNE] Iteration 350: error = 1.2649639, gradient norm = 0.0020133 (50 iterations in 0.046s)
[t-SNE] Iteration 400: error = 1.2374408, gradient norm = 0.0010570 (50 iterations in 0.046s)
[t-SNE] Iteration 450: error = 1.2273531, gradient norm = 0.0004067 (50 iterations in 0.046s)
[t-SNE] Iteration 500: error = 1.2089103, gradient norm = 0.0009640 (50 iterations in 0.046s)
[t-SNE] Iteration 550: error = 1.2030182, gradient norm = 0.0003858 (50 iterations in 0.046s)
[t-SNE] Iteration 600: error = 1.1952869, gradient norm = 0.0008939 (50 iterations in 0.046s)
[t-SNE] Iteration 650: error = 1.1944798, gradient norm = 0.0000874 (50 iterations in 0.046s)
[t-SNE] Iteration 700: error = 1.1927687, gradient norm = 0.0009404 (50 iterations in 0.046s)
[t-SNE] Iteration 750: error = 1.1910639, gradient norm = 0.0001118 (50 iterations in 0.046s)
[t-SNE] Iteration 800: error = 1.1910690, gradient norm = 0.0000646 (50 iterations in 0.046s)
[t-SNE] Iteration 850: error = 1.1909865, gradient norm = 0.0000566 (50 iterations in 0.046s)
[t-SNE] Iteration 900: error = 1.1907679, gradient norm = 0.0001099 (50 iterations in 0.077s)
[t-SNE] Iteration 950: error = 1.1908710, gradient norm = 0.0000683 (50 iterations in 0.045s)
[t-SNE] Iteration 1000: error = 1.1907758, gradient norm = 0.0000614 (50 iterations in 0.045s)
[t-SNE] KL divergence after 1000 iterations: 1.190776
[t-SNE] Computed conditional probabilities for sample 420 / 420
[t-SNE] Mean sigma: 0.362476
Beginning preprocessing + Leiden
2024-03-12 03:15:30.610582 MEMORY 16.131182592
Affmat transformed
2024-03-12 03:15:30.617332 MEMORY 16.131182592
sources, targets, weights extracted
2024-03-12 03:15:30.620837 MEMORY 16.131182592
About to launch parallel Leiden runs
2024-03-12 03:15:30.627225 MEMORY 16.131182592
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.3s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    4.1s finished
Parallel Leiden runs finished
2024-03-12 03:15:34.767240 MEMORY 16.131182592
Quality: 0.3757739684243435
Quality: 0.37862702328968906
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 344 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 413 out of 413 | elapsed:    0.2s finished
Got subclusters: Counter({0: 103, 1: 90, 2: 81, 3: 60, 4: 49, 5: 30, 6: 7})
On pattern 15
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 413 samples in 0.004s...
[t-SNE] Computed neighbors for 413 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 413 / 413
[t-SNE] Mean sigma: 0.347500
[t-SNE] Computed conditional probabilities in 0.031s
[t-SNE] Iteration 50: error = 69.7422409, gradient norm = 0.4646808 (50 iterations in 0.051s)
[t-SNE] Iteration 100: error = 73.5047989, gradient norm = 0.4201125 (50 iterations in 0.049s)
[t-SNE] Iteration 150: error = 70.2950592, gradient norm = 0.4498800 (50 iterations in 0.049s)
[t-SNE] Iteration 200: error = 72.1930542, gradient norm = 0.4585321 (50 iterations in 0.050s)
[t-SNE] Iteration 250: error = 72.6775513, gradient norm = 0.4416740 (50 iterations in 0.048s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 72.677551
[t-SNE] Iteration 300: error = 1.3320968, gradient norm = 0.0043084 (50 iterations in 0.047s)
[t-SNE] Iteration 350: error = 1.2640098, gradient norm = 0.0011932 (50 iterations in 0.046s)
[t-SNE] Iteration 400: error = 1.2213082, gradient norm = 0.0010726 (50 iterations in 0.046s)
[t-SNE] Iteration 450: error = 1.2049797, gradient norm = 0.0006182 (50 iterations in 0.046s)
[t-SNE] Iteration 500: error = 1.1886630, gradient norm = 0.0011950 (50 iterations in 0.045s)
[t-SNE] Iteration 550: error = 1.1707978, gradient norm = 0.0008662 (50 iterations in 0.049s)
[t-SNE] Iteration 600: error = 1.1679639, gradient norm = 0.0002530 (50 iterations in 0.045s)
[t-SNE] Iteration 650: error = 1.1627755, gradient norm = 0.0009102 (50 iterations in 0.048s)
[t-SNE] Iteration 700: error = 1.1606405, gradient norm = 0.0001059 (50 iterations in 0.045s)
[t-SNE] Iteration 750: error = 1.1594956, gradient norm = 0.0002561 (50 iterations in 0.045s)
[t-SNE] Iteration 800: error = 1.1559585, gradient norm = 0.0003651 (50 iterations in 0.048s)
[t-SNE] Iteration 850: error = 1.1557933, gradient norm = 0.0000961 (50 iterations in 0.045s)
[t-SNE] Iteration 900: error = 1.1558578, gradient norm = 0.0001255 (50 iterations in 0.045s)
[t-SNE] Iteration 950: error = 1.1558312, gradient norm = 0.0000855 (50 iterations in 0.048s)
[t-SNE] Iteration 1000: error = 1.1558316, gradient norm = 0.0000919 (50 iterations in 0.046s)
[t-SNE] KL divergence after 1000 iterations: 1.155832
[t-SNE] Computed conditional probabilities for sample 413 / 413
[t-SNE] Mean sigma: 0.347500
Beginning preprocessing + Leiden
2024-03-12 03:15:36.443141 MEMORY 16.131182592
Affmat transformed
2024-03-12 03:15:36.449335 MEMORY 16.131182592
sources, targets, weights extracted
2024-03-12 03:15:36.452442 MEMORY 16.131182592
About to launch parallel Leiden runs
2024-03-12 03:15:36.458262 MEMORY 16.131182592
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.3s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    4.0s finished
Parallel Leiden runs finished
2024-03-12 03:15:40.426385 MEMORY 16.131182592
Quality: 0.3794295182393041
Quality: 0.3799541330740561
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 344 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 413 out of 413 | elapsed:    0.2s finished
Got subclusters: Counter({0: 88, 1: 80, 2: 79, 3: 68, 4: 62, 5: 36})
On pattern 16
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 413 samples in 0.004s...
[t-SNE] Computed neighbors for 413 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 413 / 413
[t-SNE] Mean sigma: 0.373693
[t-SNE] Computed conditional probabilities in 0.032s
[t-SNE] Iteration 50: error = 65.5107346, gradient norm = 0.4832474 (50 iterations in 0.049s)
[t-SNE] Iteration 100: error = 70.0749893, gradient norm = 0.4542845 (50 iterations in 0.048s)
[t-SNE] Iteration 150: error = 72.6946030, gradient norm = 0.4343986 (50 iterations in 0.048s)
[t-SNE] Iteration 200: error = 71.1457443, gradient norm = 0.4616930 (50 iterations in 0.048s)
[t-SNE] Iteration 250: error = 72.8752975, gradient norm = 0.4451065 (50 iterations in 0.048s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 72.875298
[t-SNE] Iteration 300: error = 1.3868552, gradient norm = 0.0050984 (50 iterations in 0.046s)
[t-SNE] Iteration 350: error = 1.2578113, gradient norm = 0.0019961 (50 iterations in 0.045s)
[t-SNE] Iteration 400: error = 1.2142050, gradient norm = 0.0010742 (50 iterations in 0.045s)
[t-SNE] Iteration 450: error = 1.2038043, gradient norm = 0.0008630 (50 iterations in 0.047s)
[t-SNE] Iteration 500: error = 1.1916099, gradient norm = 0.0006713 (50 iterations in 0.044s)
[t-SNE] Iteration 550: error = 1.1875447, gradient norm = 0.0001744 (50 iterations in 0.044s)
[t-SNE] Iteration 600: error = 1.1844947, gradient norm = 0.0009395 (50 iterations in 0.045s)
[t-SNE] Iteration 650: error = 1.1829003, gradient norm = 0.0001764 (50 iterations in 0.045s)
[t-SNE] Iteration 700: error = 1.1825180, gradient norm = 0.0001132 (50 iterations in 0.046s)
[t-SNE] Iteration 750: error = 1.1822821, gradient norm = 0.0001344 (50 iterations in 0.044s)
[t-SNE] Iteration 800: error = 1.1822219, gradient norm = 0.0000598 (50 iterations in 0.044s)
[t-SNE] Iteration 850: error = 1.1823044, gradient norm = 0.0000501 (50 iterations in 0.045s)
[t-SNE] Iteration 900: error = 1.1822920, gradient norm = 0.0000317 (50 iterations in 0.045s)
[t-SNE] Iteration 950: error = 1.1822357, gradient norm = 0.0000509 (50 iterations in 0.044s)
[t-SNE] Iteration 1000: error = 1.1823032, gradient norm = 0.0000483 (50 iterations in 0.044s)
[t-SNE] KL divergence after 1000 iterations: 1.182303
[t-SNE] Computed conditional probabilities for sample 413 / 413
[t-SNE] Mean sigma: 0.373693
Beginning preprocessing + Leiden
2024-03-12 03:15:42.068495 MEMORY 16.131182592
Affmat transformed
2024-03-12 03:15:42.074410 MEMORY 16.131182592
sources, targets, weights extracted
2024-03-12 03:15:42.077217 MEMORY 16.131182592
About to launch parallel Leiden runs
2024-03-12 03:15:42.083134 MEMORY 16.131182592
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.3s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    3.8s finished
Parallel Leiden runs finished
2024-03-12 03:15:45.884902 MEMORY 16.131182592
Quality: 0.3831904611066091
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 387 out of 387 | elapsed:    0.2s finished
Got subclusters: Counter({0: 104, 1: 79, 2: 75, 3: 64, 4: 53, 5: 38})
On pattern 17
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 387 samples in 0.003s...
[t-SNE] Computed neighbors for 387 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 387 / 387
[t-SNE] Mean sigma: 0.374852
[t-SNE] Computed conditional probabilities in 0.029s
[t-SNE] Iteration 50: error = 66.3856125, gradient norm = 0.4821050 (50 iterations in 0.049s)
[t-SNE] Iteration 100: error = 67.7761917, gradient norm = 0.4812936 (50 iterations in 0.046s)
[t-SNE] Iteration 150: error = 68.9666061, gradient norm = 0.4840235 (50 iterations in 0.046s)
[t-SNE] Iteration 200: error = 69.1924973, gradient norm = 0.4674486 (50 iterations in 0.046s)
[t-SNE] Iteration 250: error = 68.6607361, gradient norm = 0.4686837 (50 iterations in 0.046s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 68.660736
[t-SNE] Iteration 300: error = 1.2583380, gradient norm = 0.0041764 (50 iterations in 0.045s)
[t-SNE] Iteration 350: error = 1.1877000, gradient norm = 0.0018050 (50 iterations in 0.043s)
[t-SNE] Iteration 400: error = 1.1420338, gradient norm = 0.0010886 (50 iterations in 0.044s)
[t-SNE] Iteration 450: error = 1.1332059, gradient norm = 0.0002790 (50 iterations in 0.044s)
[t-SNE] Iteration 500: error = 1.1270136, gradient norm = 0.0002794 (50 iterations in 0.043s)
[t-SNE] Iteration 550: error = 1.1264836, gradient norm = 0.0000738 (50 iterations in 0.044s)
[t-SNE] Iteration 600: error = 1.1259789, gradient norm = 0.0000905 (50 iterations in 0.043s)
[t-SNE] Iteration 650: error = 1.1260387, gradient norm = 0.0000722 (50 iterations in 0.044s)
[t-SNE] Iteration 700: error = 1.1257226, gradient norm = 0.0001231 (50 iterations in 0.043s)
[t-SNE] Iteration 750: error = 1.1254913, gradient norm = 0.0000563 (50 iterations in 0.044s)
[t-SNE] Iteration 800: error = 1.1255499, gradient norm = 0.0000550 (50 iterations in 0.043s)
[t-SNE] Iteration 850: error = 1.1252643, gradient norm = 0.0001056 (50 iterations in 0.043s)
[t-SNE] Iteration 900: error = 1.1251807, gradient norm = 0.0000783 (50 iterations in 0.043s)
[t-SNE] Iteration 950: error = 1.1251323, gradient norm = 0.0000713 (50 iterations in 0.043s)
[t-SNE] Iteration 1000: error = 1.1250830, gradient norm = 0.0001041 (50 iterations in 0.043s)
[t-SNE] KL divergence after 1000 iterations: 1.125083
[t-SNE] Computed conditional probabilities for sample 387 / 387
[t-SNE] Mean sigma: 0.374852
Beginning preprocessing + Leiden
2024-03-12 03:15:47.444101 MEMORY 16.131182592
Affmat transformed
2024-03-12 03:15:47.449168 MEMORY 16.131182592
sources, targets, weights extracted
2024-03-12 03:15:47.451923 MEMORY 16.131182592
About to launch parallel Leiden runs
2024-03-12 03:15:47.457529 MEMORY 16.131182592
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.2s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    3.6s finished
Parallel Leiden runs finished
2024-03-12 03:15:51.037992 MEMORY 16.131182592
Quality: 0.41497534676464176
Quality: 0.4150151048316581
Quality: 0.415035192260139
Quality: 0.4151765405182517
Quality: 0.415282568988753
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 364 out of 364 | elapsed:    0.1s finished
Got subclusters: Counter({0: 87, 1: 82, 2: 72, 3: 65, 4: 43, 5: 38})
On pattern 18
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 364 samples in 0.004s...
[t-SNE] Computed neighbors for 364 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 364 / 364
[t-SNE] Mean sigma: 0.369169
[t-SNE] Computed conditional probabilities in 0.028s
[t-SNE] Iteration 50: error = 68.2184372, gradient norm = 0.4601249 (50 iterations in 0.044s)
[t-SNE] Iteration 100: error = 70.2326508, gradient norm = 0.4567646 (50 iterations in 0.046s)
[t-SNE] Iteration 150: error = 69.3012695, gradient norm = 0.4814437 (50 iterations in 0.044s)
[t-SNE] Iteration 200: error = 72.7593384, gradient norm = 0.4308740 (50 iterations in 0.044s)
[t-SNE] Iteration 250: error = 70.6563187, gradient norm = 0.4724992 (50 iterations in 0.045s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 70.656319
[t-SNE] Iteration 300: error = 1.2927392, gradient norm = 0.0044462 (50 iterations in 0.043s)
[t-SNE] Iteration 350: error = 1.2152405, gradient norm = 0.0018134 (50 iterations in 0.042s)
[t-SNE] Iteration 400: error = 1.1695734, gradient norm = 0.0021645 (50 iterations in 0.042s)
[t-SNE] Iteration 450: error = 1.1438583, gradient norm = 0.0005852 (50 iterations in 0.042s)
[t-SNE] Iteration 500: error = 1.1404871, gradient norm = 0.0004091 (50 iterations in 0.042s)
[t-SNE] Iteration 550: error = 1.1276617, gradient norm = 0.0008670 (50 iterations in 0.042s)
[t-SNE] Iteration 600: error = 1.1058594, gradient norm = 0.0010220 (50 iterations in 0.042s)
[t-SNE] Iteration 650: error = 1.1017504, gradient norm = 0.0002798 (50 iterations in 0.042s)
[t-SNE] Iteration 700: error = 1.0962214, gradient norm = 0.0004348 (50 iterations in 0.042s)
[t-SNE] Iteration 750: error = 1.0959536, gradient norm = 0.0000777 (50 iterations in 0.042s)
[t-SNE] Iteration 800: error = 1.0957905, gradient norm = 0.0001032 (50 iterations in 0.045s)
[t-SNE] Iteration 850: error = 1.0956001, gradient norm = 0.0000720 (50 iterations in 0.042s)
[t-SNE] Iteration 900: error = 1.0955877, gradient norm = 0.0000486 (50 iterations in 0.042s)
[t-SNE] Iteration 950: error = 1.0956247, gradient norm = 0.0000665 (50 iterations in 0.042s)
[t-SNE] Iteration 1000: error = 1.0956683, gradient norm = 0.0000582 (50 iterations in 0.042s)
[t-SNE] KL divergence after 1000 iterations: 1.095668
[t-SNE] Computed conditional probabilities for sample 364 / 364
[t-SNE] Mean sigma: 0.369169
Beginning preprocessing + Leiden
2024-03-12 03:15:52.556850 MEMORY 16.131182592
Affmat transformed
2024-03-12 03:15:52.562323 MEMORY 16.131182592
sources, targets, weights extracted
2024-03-12 03:15:52.565192 MEMORY 16.131182592
About to launch parallel Leiden runs
2024-03-12 03:15:52.570997 MEMORY 16.131182592
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.1s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    3.5s finished
Parallel Leiden runs finished
2024-03-12 03:15:56.110605 MEMORY 16.131182592
Quality: 0.3406716865378679
Quality: 0.34247751781730845
Quality: 0.3424849492617336
Quality: 0.34289752167445015
Quality: 0.343104824258336
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 357 out of 357 | elapsed:    0.1s finished
Got subclusters: Counter({0: 68, 1: 62, 2: 60, 3: 57, 4: 49, 5: 27, 6: 26, 7: 13, 8: 2})
On pattern 19
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 357 samples in 0.003s...
[t-SNE] Computed neighbors for 357 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 357 / 357
[t-SNE] Mean sigma: 0.386703
[t-SNE] Computed conditional probabilities in 0.028s
[t-SNE] Iteration 50: error = 64.6559830, gradient norm = 0.4931526 (50 iterations in 0.044s)
[t-SNE] Iteration 100: error = 65.2623749, gradient norm = 0.5097631 (50 iterations in 0.048s)
[t-SNE] Iteration 150: error = 65.2744751, gradient norm = 0.4960052 (50 iterations in 0.044s)
[t-SNE] Iteration 200: error = 66.5621719, gradient norm = 0.4823037 (50 iterations in 0.045s)
[t-SNE] Iteration 250: error = 66.7201157, gradient norm = 0.4925786 (50 iterations in 0.044s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 66.720116
[t-SNE] Iteration 300: error = 1.2500545, gradient norm = 0.0044210 (50 iterations in 0.042s)
[t-SNE] Iteration 350: error = 1.1844594, gradient norm = 0.0010338 (50 iterations in 0.042s)
[t-SNE] Iteration 400: error = 1.1666460, gradient norm = 0.0007077 (50 iterations in 0.042s)
[t-SNE] Iteration 450: error = 1.1491604, gradient norm = 0.0004489 (50 iterations in 0.042s)
[t-SNE] Iteration 500: error = 1.1314710, gradient norm = 0.0008702 (50 iterations in 0.042s)
[t-SNE] Iteration 550: error = 1.1089443, gradient norm = 0.0011639 (50 iterations in 0.042s)
[t-SNE] Iteration 600: error = 1.1004584, gradient norm = 0.0008182 (50 iterations in 0.042s)
[t-SNE] Iteration 650: error = 1.0924958, gradient norm = 0.0003692 (50 iterations in 0.042s)
[t-SNE] Iteration 700: error = 1.0839493, gradient norm = 0.0006539 (50 iterations in 0.042s)
[t-SNE] Iteration 750: error = 1.0838119, gradient norm = 0.0001175 (50 iterations in 0.042s)
[t-SNE] Iteration 800: error = 1.0837336, gradient norm = 0.0003772 (50 iterations in 0.042s)
[t-SNE] Iteration 850: error = 1.0825324, gradient norm = 0.0002258 (50 iterations in 0.042s)
[t-SNE] Iteration 900: error = 1.0808439, gradient norm = 0.0002822 (50 iterations in 0.042s)
[t-SNE] Iteration 950: error = 1.0785983, gradient norm = 0.0016780 (50 iterations in 0.042s)
[t-SNE] Iteration 1000: error = 1.0752323, gradient norm = 0.0001279 (50 iterations in 0.042s)
[t-SNE] KL divergence after 1000 iterations: 1.075232
[t-SNE] Computed conditional probabilities for sample 357 / 357
[t-SNE] Mean sigma: 0.386703
Beginning preprocessing + Leiden
2024-03-12 03:15:57.596096 MEMORY 16.131182592
Affmat transformed
2024-03-12 03:15:57.601185 MEMORY 16.131182592
sources, targets, weights extracted
2024-03-12 03:15:57.603755 MEMORY 16.131182592
About to launch parallel Leiden runs
2024-03-12 03:15:57.609605 MEMORY 16.131182592
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.2s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    3.7s finished
Parallel Leiden runs finished
2024-03-12 03:16:01.291348 MEMORY 16.131182592
Quality: 0.39177097749796463
Quality: 0.39218762669162965
Quality: 0.3922064514747587
Quality: 0.3922795415766377
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 304 out of 351 | elapsed:    0.1s remaining:    0.0s
[Parallel(n_jobs=24)]: Done 351 out of 351 | elapsed:    0.1s finished
Got subclusters: Counter({0: 70, 1: 60, 2: 54, 3: 53, 4: 50, 5: 39, 6: 31})
On pattern 20
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 351 samples in 0.003s...
[t-SNE] Computed neighbors for 351 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 351 / 351
[t-SNE] Mean sigma: 0.310905
[t-SNE] Computed conditional probabilities in 0.028s
[t-SNE] Iteration 50: error = 66.6527863, gradient norm = 0.4773951 (50 iterations in 0.044s)
[t-SNE] Iteration 100: error = 66.4802094, gradient norm = 0.4660112 (50 iterations in 0.044s)
[t-SNE] Iteration 150: error = 66.2417145, gradient norm = 0.5009276 (50 iterations in 0.044s)
[t-SNE] Iteration 200: error = 68.1808319, gradient norm = 0.4688713 (50 iterations in 0.044s)
[t-SNE] Iteration 250: error = 69.2245178, gradient norm = 0.4506521 (50 iterations in 0.044s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 69.224518
[t-SNE] Iteration 300: error = 1.1256993, gradient norm = 0.0041117 (50 iterations in 0.042s)
[t-SNE] Iteration 350: error = 0.9809544, gradient norm = 0.0031545 (50 iterations in 0.042s)
[t-SNE] Iteration 400: error = 0.9358163, gradient norm = 0.0010850 (50 iterations in 0.042s)
[t-SNE] Iteration 450: error = 0.9309700, gradient norm = 0.0006460 (50 iterations in 0.042s)
[t-SNE] Iteration 500: error = 0.9295767, gradient norm = 0.0002054 (50 iterations in 0.042s)
[t-SNE] Iteration 550: error = 0.9243704, gradient norm = 0.0001927 (50 iterations in 0.043s)
[t-SNE] Iteration 600: error = 0.9237528, gradient norm = 0.0005158 (50 iterations in 0.042s)
[t-SNE] Iteration 650: error = 0.9215049, gradient norm = 0.0002441 (50 iterations in 0.043s)
[t-SNE] Iteration 700: error = 0.9209143, gradient norm = 0.0003109 (50 iterations in 0.042s)
[t-SNE] Iteration 750: error = 0.9201437, gradient norm = 0.0001009 (50 iterations in 0.042s)
[t-SNE] Iteration 800: error = 0.9200978, gradient norm = 0.0001184 (50 iterations in 0.042s)
[t-SNE] Iteration 850: error = 0.9200708, gradient norm = 0.0000600 (50 iterations in 0.041s)
[t-SNE] Iteration 900: error = 0.9200681, gradient norm = 0.0001007 (50 iterations in 0.041s)
[t-SNE] Iteration 950: error = 0.9201290, gradient norm = 0.0000814 (50 iterations in 0.041s)
[t-SNE] Iteration 1000: error = 0.9200794, gradient norm = 0.0000865 (50 iterations in 0.041s)
[t-SNE] KL divergence after 1000 iterations: 0.920079
[t-SNE] Computed conditional probabilities for sample 351 / 351
[t-SNE] Mean sigma: 0.310905
Beginning preprocessing + Leiden
2024-03-12 03:16:02.754460 MEMORY 16.131182592
Affmat transformed
2024-03-12 03:16:02.759644 MEMORY 16.131182592
sources, targets, weights extracted
2024-03-12 03:16:02.762971 MEMORY 16.131182592
About to launch parallel Leiden runs
2024-03-12 03:16:02.768233 MEMORY 16.131182592
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.2s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    3.6s finished
Parallel Leiden runs finished
2024-03-12 03:16:06.400499 MEMORY 16.131182592
Quality: 0.3595895245370358
Quality: 0.3599632095981299
Quality: 0.36014708181732963
Quality: 0.360780703828627
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 272 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 321 out of 321 | elapsed:    0.1s finished
Got subclusters: Counter({0: 91, 1: 65, 2: 63, 3: 61, 4: 45, 5: 26})
On pattern 21
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 321 samples in 0.003s...
[t-SNE] Computed neighbors for 321 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 321 / 321
[t-SNE] Mean sigma: 0.336081
[t-SNE] Computed conditional probabilities in 0.025s
[t-SNE] Iteration 50: error = 65.8335876, gradient norm = 0.4966027 (50 iterations in 0.040s)
[t-SNE] Iteration 100: error = 70.4247284, gradient norm = 0.4367152 (50 iterations in 0.041s)
[t-SNE] Iteration 150: error = 67.2774200, gradient norm = 0.4767087 (50 iterations in 0.041s)
[t-SNE] Iteration 200: error = 69.1023865, gradient norm = 0.4815567 (50 iterations in 0.041s)
[t-SNE] Iteration 250: error = 73.2411652, gradient norm = 0.4145636 (50 iterations in 0.041s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 73.241165
[t-SNE] Iteration 300: error = 1.2533997, gradient norm = 0.0047325 (50 iterations in 0.039s)
[t-SNE] Iteration 350: error = 1.1261705, gradient norm = 0.0018621 (50 iterations in 0.039s)
[t-SNE] Iteration 400: error = 1.0480753, gradient norm = 0.0020485 (50 iterations in 0.039s)
[t-SNE] Iteration 450: error = 1.0227977, gradient norm = 0.0012675 (50 iterations in 0.039s)
[t-SNE] Iteration 500: error = 1.0045552, gradient norm = 0.0005266 (50 iterations in 0.039s)
[t-SNE] Iteration 550: error = 1.0029397, gradient norm = 0.0002119 (50 iterations in 0.039s)
[t-SNE] Iteration 600: error = 0.9999062, gradient norm = 0.0003132 (50 iterations in 0.039s)
[t-SNE] Iteration 650: error = 0.9953091, gradient norm = 0.0002922 (50 iterations in 0.039s)
[t-SNE] Iteration 700: error = 0.9952896, gradient norm = 0.0000872 (50 iterations in 0.039s)
[t-SNE] Iteration 750: error = 0.9952419, gradient norm = 0.0001188 (50 iterations in 0.039s)
[t-SNE] Iteration 800: error = 0.9914224, gradient norm = 0.0007954 (50 iterations in 0.039s)
[t-SNE] Iteration 850: error = 0.9885395, gradient norm = 0.0002813 (50 iterations in 0.039s)
[t-SNE] Iteration 900: error = 0.9882246, gradient norm = 0.0001397 (50 iterations in 0.039s)
[t-SNE] Iteration 950: error = 0.9879133, gradient norm = 0.0001651 (50 iterations in 0.039s)
[t-SNE] Iteration 1000: error = 0.9872156, gradient norm = 0.0001449 (50 iterations in 0.039s)
[t-SNE] KL divergence after 1000 iterations: 0.987216
[t-SNE] Computed conditional probabilities for sample 321 / 321
[t-SNE] Mean sigma: 0.336081
Beginning preprocessing + Leiden
2024-03-12 03:16:07.792919 MEMORY 16.131182592
Affmat transformed
2024-03-12 03:16:07.797604 MEMORY 16.131182592
sources, targets, weights extracted
2024-03-12 03:16:07.800507 MEMORY 16.131182592
About to launch parallel Leiden runs
2024-03-12 03:16:07.805430 MEMORY 16.131182592
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.1s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    3.4s finished
Parallel Leiden runs finished
2024-03-12 03:16:11.180070 MEMORY 16.131182592
Quality: 0.32748118469450893
Quality: 0.32928121942649974
Quality: 0.32948160847745345
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 315 out of 315 | elapsed:    0.1s finished
Got subclusters: Counter({0: 65, 1: 63, 2: 51, 3: 49, 4: 27, 5: 24, 6: 23, 7: 19})
On pattern 22
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 315 samples in 0.003s...
[t-SNE] Computed neighbors for 315 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 315 / 315
[t-SNE] Mean sigma: 0.362873
[t-SNE] Computed conditional probabilities in 0.024s
[t-SNE] Iteration 50: error = 62.2331390, gradient norm = 0.5144883 (50 iterations in 0.041s)
[t-SNE] Iteration 100: error = 64.8748932, gradient norm = 0.4917774 (50 iterations in 0.041s)
[t-SNE] Iteration 150: error = 68.2411270, gradient norm = 0.4638108 (50 iterations in 0.041s)
[t-SNE] Iteration 200: error = 66.3241653, gradient norm = 0.4662258 (50 iterations in 0.041s)
[t-SNE] Iteration 250: error = 66.2283707, gradient norm = 0.4698721 (50 iterations in 0.041s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 66.228371
[t-SNE] Iteration 300: error = 1.1525501, gradient norm = 0.0037156 (50 iterations in 0.040s)
[t-SNE] Iteration 350: error = 0.9745386, gradient norm = 0.0044298 (50 iterations in 0.039s)
[t-SNE] Iteration 400: error = 0.9106110, gradient norm = 0.0007675 (50 iterations in 0.039s)
[t-SNE] Iteration 450: error = 0.9037113, gradient norm = 0.0002978 (50 iterations in 0.039s)
[t-SNE] Iteration 500: error = 0.8882299, gradient norm = 0.0011325 (50 iterations in 0.039s)
[t-SNE] Iteration 550: error = 0.8780549, gradient norm = 0.0006290 (50 iterations in 0.039s)
[t-SNE] Iteration 600: error = 0.8733803, gradient norm = 0.0003332 (50 iterations in 0.039s)
[t-SNE] Iteration 650: error = 0.8727525, gradient norm = 0.0003068 (50 iterations in 0.039s)
[t-SNE] Iteration 700: error = 0.8723438, gradient norm = 0.0000838 (50 iterations in 0.042s)
[t-SNE] Iteration 750: error = 0.8725522, gradient norm = 0.0000633 (50 iterations in 0.039s)
[t-SNE] Iteration 800: error = 0.8725600, gradient norm = 0.0000820 (50 iterations in 0.040s)
[t-SNE] Iteration 850: error = 0.8724797, gradient norm = 0.0000350 (50 iterations in 0.039s)
[t-SNE] Iteration 900: error = 0.8724248, gradient norm = 0.0000871 (50 iterations in 0.039s)
[t-SNE] Iteration 950: error = 0.8723531, gradient norm = 0.0000654 (50 iterations in 0.039s)
[t-SNE] Iteration 1000: error = 0.8723618, gradient norm = 0.0000580 (50 iterations in 0.039s)
[t-SNE] KL divergence after 1000 iterations: 0.872362
[t-SNE] Computed conditional probabilities for sample 315 / 315
[t-SNE] Mean sigma: 0.362873
Beginning preprocessing + Leiden
2024-03-12 03:16:12.545837 MEMORY 16.131182592
Affmat transformed
2024-03-12 03:16:12.550290 MEMORY 16.131182592
sources, targets, weights extracted
2024-03-12 03:16:12.552612 MEMORY 16.131182592
About to launch parallel Leiden runs
2024-03-12 03:16:12.557661 MEMORY 16.131182592
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.1s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    3.2s finished
Parallel Leiden runs finished
2024-03-12 03:16:15.717350 MEMORY 16.131182592
Quality: 0.3771132251488198
Quality: 0.37877225313385715
Quality: 0.3787836001659146
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 299 out of 299 | elapsed:    0.1s finished
Got subclusters: Counter({0: 92, 1: 72, 2: 65, 3: 49, 4: 37})
On pattern 23
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 299 samples in 0.003s...
[t-SNE] Computed neighbors for 299 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 299 / 299
[t-SNE] Mean sigma: 0.358392
[t-SNE] Computed conditional probabilities in 0.022s
[t-SNE] Iteration 50: error = 67.2522812, gradient norm = 0.4427639 (50 iterations in 0.046s)
[t-SNE] Iteration 100: error = 69.6369476, gradient norm = 0.4735872 (50 iterations in 0.043s)
[t-SNE] Iteration 150: error = 71.2395630, gradient norm = 0.4449123 (50 iterations in 0.043s)
[t-SNE] Iteration 200: error = 73.7045441, gradient norm = 0.4288805 (50 iterations in 0.043s)
[t-SNE] Iteration 250: error = 69.9567795, gradient norm = 0.4754744 (50 iterations in 0.043s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 69.956779
[t-SNE] Iteration 300: error = 1.0927808, gradient norm = 0.0052872 (50 iterations in 0.042s)
[t-SNE] Iteration 350: error = 0.9499848, gradient norm = 0.0035090 (50 iterations in 0.040s)
[t-SNE] Iteration 400: error = 0.8510100, gradient norm = 0.0039700 (50 iterations in 0.040s)
[t-SNE] Iteration 450: error = 0.8268099, gradient norm = 0.0010997 (50 iterations in 0.043s)
[t-SNE] Iteration 500: error = 0.8200388, gradient norm = 0.0005448 (50 iterations in 0.040s)
[t-SNE] Iteration 550: error = 0.8165179, gradient norm = 0.0009153 (50 iterations in 0.040s)
[t-SNE] Iteration 600: error = 0.8123445, gradient norm = 0.0002418 (50 iterations in 0.040s)
[t-SNE] Iteration 650: error = 0.8121462, gradient norm = 0.0000569 (50 iterations in 0.041s)
[t-SNE] Iteration 700: error = 0.8120936, gradient norm = 0.0000627 (50 iterations in 0.041s)
[t-SNE] Iteration 750: error = 0.8120026, gradient norm = 0.0000855 (50 iterations in 0.041s)
[t-SNE] Iteration 800: error = 0.8120090, gradient norm = 0.0000408 (50 iterations in 0.042s)
[t-SNE] Iteration 850: error = 0.8120282, gradient norm = 0.0000435 (50 iterations in 0.041s)
[t-SNE] Iteration 900: error = 0.8120489, gradient norm = 0.0000537 (50 iterations in 0.041s)
[t-SNE] Iteration 950: error = 0.8119369, gradient norm = 0.0001210 (50 iterations in 0.041s)
[t-SNE] Iteration 1000: error = 0.8120434, gradient norm = 0.0000540 (50 iterations in 0.041s)
[t-SNE] KL divergence after 1000 iterations: 0.812043
[t-SNE] Computed conditional probabilities for sample 299 / 299
[t-SNE] Mean sigma: 0.358392
Beginning preprocessing + Leiden
2024-03-12 03:16:17.078709 MEMORY 16.131182592
Affmat transformed
2024-03-12 03:16:17.083009 MEMORY 16.131182592
sources, targets, weights extracted
2024-03-12 03:16:17.085302 MEMORY 16.131182592
About to launch parallel Leiden runs
2024-03-12 03:16:17.090301 MEMORY 16.131182592
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.0s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    3.1s finished
Parallel Leiden runs finished
2024-03-12 03:16:20.164961 MEMORY 16.131182592
Quality: 0.3432558645193629
Quality: 0.3435468827193633
Quality: 0.3442674665821767
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 216 out of 263 | elapsed:    0.1s remaining:    0.0s
[Parallel(n_jobs=24)]: Done 263 out of 263 | elapsed:    0.1s finished
Got subclusters: Counter({0: 81, 1: 77, 2: 75, 3: 45, 4: 16, 5: 5})
On pattern 24
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 263 samples in 0.002s...
[t-SNE] Computed neighbors for 263 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 263 / 263
[t-SNE] Mean sigma: 0.392562
[t-SNE] Computed conditional probabilities in 0.020s
[t-SNE] Iteration 50: error = 59.1740417, gradient norm = 0.5051937 (50 iterations in 0.043s)
[t-SNE] Iteration 100: error = 60.2690697, gradient norm = 0.4676113 (50 iterations in 0.039s)
[t-SNE] Iteration 150: error = 60.1038017, gradient norm = 0.5065866 (50 iterations in 0.040s)
[t-SNE] Iteration 200: error = 62.6088409, gradient norm = 0.5042302 (50 iterations in 0.039s)
[t-SNE] Iteration 250: error = 62.1632576, gradient norm = 0.4840410 (50 iterations in 0.042s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 62.163258
[t-SNE] Iteration 300: error = 0.9596761, gradient norm = 0.0049532 (50 iterations in 0.037s)
[t-SNE] Iteration 350: error = 0.8413594, gradient norm = 0.0027810 (50 iterations in 0.037s)
[t-SNE] Iteration 400: error = 0.8207086, gradient norm = 0.0005681 (50 iterations in 0.037s)
[t-SNE] Iteration 450: error = 0.8184011, gradient norm = 0.0002906 (50 iterations in 0.037s)
[t-SNE] Iteration 500: error = 0.8185361, gradient norm = 0.0001621 (50 iterations in 0.037s)
[t-SNE] Iteration 550: error = 0.8181878, gradient norm = 0.0001702 (50 iterations in 0.037s)
[t-SNE] Iteration 600: error = 0.8180633, gradient norm = 0.0001051 (50 iterations in 0.037s)
[t-SNE] Iteration 650: error = 0.8180450, gradient norm = 0.0000433 (50 iterations in 0.037s)
[t-SNE] Iteration 700: error = 0.8180676, gradient norm = 0.0000908 (50 iterations in 0.037s)
[t-SNE] Iteration 750: error = 0.8180185, gradient norm = 0.0000663 (50 iterations in 0.037s)
[t-SNE] Iteration 800: error = 0.8180510, gradient norm = 0.0000816 (50 iterations in 0.037s)
[t-SNE] Iteration 850: error = 0.8180761, gradient norm = 0.0001137 (50 iterations in 0.037s)
[t-SNE] Iteration 900: error = 0.8179922, gradient norm = 0.0000600 (50 iterations in 0.037s)
[t-SNE] Iteration 950: error = 0.8179864, gradient norm = 0.0000578 (50 iterations in 0.037s)
[t-SNE] Iteration 1000: error = 0.8180018, gradient norm = 0.0000492 (50 iterations in 0.037s)
[t-SNE] KL divergence after 1000 iterations: 0.818002
[t-SNE] Computed conditional probabilities for sample 263 / 263
[t-SNE] Mean sigma: 0.392562
Beginning preprocessing + Leiden
2024-03-12 03:16:21.377142 MEMORY 16.131182592
Affmat transformed
2024-03-12 03:16:21.380753 MEMORY 16.131182592
sources, targets, weights extracted
2024-03-12 03:16:21.382506 MEMORY 16.131182592
About to launch parallel Leiden runs
2024-03-12 03:16:21.387825 MEMORY 16.131182592
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.9s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.8s finished
Parallel Leiden runs finished
2024-03-12 03:16:24.150000 MEMORY 16.131182592
Quality: 0.36555783880752807
Quality: 0.366132419983729
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 204 out of 251 | elapsed:    0.1s remaining:    0.0s
[Parallel(n_jobs=24)]: Done 251 out of 251 | elapsed:    0.1s finished
Got subclusters: Counter({0: 63, 1: 58, 2: 56, 3: 35, 4: 31, 5: 12, 6: 8})
On pattern 25
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 251 samples in 0.002s...
[t-SNE] Computed neighbors for 251 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 251 / 251
[t-SNE] Mean sigma: 0.380776
[t-SNE] Computed conditional probabilities in 0.020s
[t-SNE] Iteration 50: error = 61.5633316, gradient norm = 0.5431237 (50 iterations in 0.039s)
[t-SNE] Iteration 100: error = 62.8276176, gradient norm = 0.5187001 (50 iterations in 0.037s)
[t-SNE] Iteration 150: error = 62.7603149, gradient norm = 0.4729653 (50 iterations in 0.037s)
[t-SNE] Iteration 200: error = 63.3091698, gradient norm = 0.5175890 (50 iterations in 0.037s)
[t-SNE] Iteration 250: error = 64.0388565, gradient norm = 0.4717215 (50 iterations in 0.037s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 64.038857
[t-SNE] Iteration 300: error = 1.0790253, gradient norm = 0.0054277 (50 iterations in 0.035s)
[t-SNE] Iteration 350: error = 0.9168270, gradient norm = 0.0029331 (50 iterations in 0.039s)
[t-SNE] Iteration 400: error = 0.8873221, gradient norm = 0.0009150 (50 iterations in 0.036s)
[t-SNE] Iteration 450: error = 0.8528732, gradient norm = 0.0023100 (50 iterations in 0.036s)
[t-SNE] Iteration 500: error = 0.8420019, gradient norm = 0.0008415 (50 iterations in 0.036s)
[t-SNE] Iteration 550: error = 0.8326818, gradient norm = 0.0004050 (50 iterations in 0.036s)
[t-SNE] Iteration 600: error = 0.8299497, gradient norm = 0.0002396 (50 iterations in 0.036s)
[t-SNE] Iteration 650: error = 0.8292063, gradient norm = 0.0001089 (50 iterations in 0.036s)
[t-SNE] Iteration 700: error = 0.8289725, gradient norm = 0.0001317 (50 iterations in 0.038s)
[t-SNE] Iteration 750: error = 0.8291125, gradient norm = 0.0000715 (50 iterations in 0.036s)
[t-SNE] Iteration 800: error = 0.8292559, gradient norm = 0.0000718 (50 iterations in 0.036s)
[t-SNE] Iteration 850: error = 0.8291360, gradient norm = 0.0001171 (50 iterations in 0.036s)
[t-SNE] Iteration 900: error = 0.8293437, gradient norm = 0.0000954 (50 iterations in 0.036s)
[t-SNE] Iteration 950: error = 0.8293710, gradient norm = 0.0000863 (50 iterations in 0.036s)
[t-SNE] Iteration 1000: error = 0.8293797, gradient norm = 0.0000642 (50 iterations in 0.036s)
[t-SNE] KL divergence after 1000 iterations: 0.829380
[t-SNE] Computed conditional probabilities for sample 251 / 251
[t-SNE] Mean sigma: 0.380776
Beginning preprocessing + Leiden
2024-03-12 03:16:25.304049 MEMORY 16.131182592
Affmat transformed
2024-03-12 03:16:25.307562 MEMORY 16.131182592
sources, targets, weights extracted
2024-03-12 03:16:25.309181 MEMORY 16.131182592
About to launch parallel Leiden runs
2024-03-12 03:16:25.314312 MEMORY 16.131182592
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.9s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.8s finished
Parallel Leiden runs finished
2024-03-12 03:16:28.076278 MEMORY 16.131182592
Quality: 0.358053800392491
Quality: 0.36386950249052874
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 236 out of 236 | elapsed:    0.1s finished
Got subclusters: Counter({0: 56, 1: 53, 2: 42, 3: 37, 4: 36, 5: 15, 6: 12})
On pattern 26
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 236 samples in 0.002s...
[t-SNE] Computed neighbors for 236 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 236 / 236
[t-SNE] Mean sigma: 0.385302
[t-SNE] Computed conditional probabilities in 0.020s
[t-SNE] Iteration 50: error = 65.5304260, gradient norm = 0.4467071 (50 iterations in 0.037s)
[t-SNE] Iteration 100: error = 62.2116432, gradient norm = 0.5078799 (50 iterations in 0.037s)
[t-SNE] Iteration 150: error = 59.8810158, gradient norm = 0.5009525 (50 iterations in 0.037s)
[t-SNE] Iteration 200: error = 61.6559372, gradient norm = 0.5403016 (50 iterations in 0.037s)
[t-SNE] Iteration 250: error = 64.5226898, gradient norm = 0.4516518 (50 iterations in 0.037s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 64.522690
[t-SNE] Iteration 300: error = 1.0133491, gradient norm = 0.0075047 (50 iterations in 0.034s)
[t-SNE] Iteration 350: error = 0.8098035, gradient norm = 0.0026337 (50 iterations in 0.035s)
[t-SNE] Iteration 400: error = 0.7570279, gradient norm = 0.0014960 (50 iterations in 0.035s)
[t-SNE] Iteration 450: error = 0.7462438, gradient norm = 0.0013697 (50 iterations in 0.035s)
[t-SNE] Iteration 500: error = 0.7440616, gradient norm = 0.0004932 (50 iterations in 0.035s)
[t-SNE] Iteration 550: error = 0.7391034, gradient norm = 0.0008760 (50 iterations in 0.035s)
[t-SNE] Iteration 600: error = 0.7381635, gradient norm = 0.0001516 (50 iterations in 0.036s)
[t-SNE] Iteration 650: error = 0.7382249, gradient norm = 0.0000876 (50 iterations in 0.036s)
[t-SNE] Iteration 700: error = 0.7381126, gradient norm = 0.0001032 (50 iterations in 0.035s)
[t-SNE] Iteration 750: error = 0.7381666, gradient norm = 0.0000938 (50 iterations in 0.036s)
[t-SNE] Iteration 800: error = 0.7381647, gradient norm = 0.0001055 (50 iterations in 0.036s)
[t-SNE] Iteration 850: error = 0.7381492, gradient norm = 0.0000766 (50 iterations in 0.036s)
[t-SNE] Iteration 900: error = 0.7381781, gradient norm = 0.0000620 (50 iterations in 0.036s)
[t-SNE] Iteration 950: error = 0.7380413, gradient norm = 0.0001079 (50 iterations in 0.035s)
[t-SNE] Iteration 1000: error = 0.7381402, gradient norm = 0.0000776 (50 iterations in 0.036s)
[t-SNE] KL divergence after 1000 iterations: 0.738140
[t-SNE] Computed conditional probabilities for sample 236 / 236
[t-SNE] Mean sigma: 0.385303
Beginning preprocessing + Leiden
2024-03-12 03:16:29.242713 MEMORY 16.131182592
Affmat transformed
2024-03-12 03:16:29.246053 MEMORY 16.131182592
sources, targets, weights extracted
2024-03-12 03:16:29.247605 MEMORY 16.131182592
About to launch parallel Leiden runs
2024-03-12 03:16:29.253095 MEMORY 16.131182592
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.9s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.7s finished
Parallel Leiden runs finished
2024-03-12 03:16:31.913117 MEMORY 16.131182592
Quality: 0.3451977125225285
Quality: 0.3478538763493217
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 170 out of 170 | elapsed:    0.1s finished
Got subclusters: Counter({0: 60, 1: 59, 2: 50, 3: 26, 4: 25, 5: 9, 6: 7})
On pattern 27
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 170 samples in 0.002s...
[t-SNE] Computed neighbors for 170 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 170 / 170
[t-SNE] Mean sigma: 0.437386
[t-SNE] Computed conditional probabilities in 0.013s
[t-SNE] Iteration 50: error = 58.7604828, gradient norm = 0.5073682 (50 iterations in 0.032s)
[t-SNE] Iteration 100: error = 58.9125557, gradient norm = 0.5449548 (50 iterations in 0.029s)
[t-SNE] Iteration 150: error = 58.6906052, gradient norm = 0.4867248 (50 iterations in 0.029s)
[t-SNE] Iteration 200: error = 56.4258957, gradient norm = 0.5476374 (50 iterations in 0.029s)
[t-SNE] Iteration 250: error = 58.0893745, gradient norm = 0.5138264 (50 iterations in 0.029s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 58.089375
[t-SNE] Iteration 300: error = 0.7719299, gradient norm = 0.0090312 (50 iterations in 0.028s)
[t-SNE] Iteration 350: error = 0.6074230, gradient norm = 0.0032497 (50 iterations in 0.028s)
[t-SNE] Iteration 400: error = 0.6013948, gradient norm = 0.0004024 (50 iterations in 0.028s)
[t-SNE] Iteration 450: error = 0.5945131, gradient norm = 0.0003819 (50 iterations in 0.028s)
[t-SNE] Iteration 500: error = 0.5917367, gradient norm = 0.0002063 (50 iterations in 0.029s)
[t-SNE] Iteration 550: error = 0.5915738, gradient norm = 0.0002186 (50 iterations in 0.029s)
[t-SNE] Iteration 600: error = 0.5914121, gradient norm = 0.0002877 (50 iterations in 0.029s)
[t-SNE] Iteration 650: error = 0.5913737, gradient norm = 0.0002527 (50 iterations in 0.028s)
[t-SNE] Iteration 700: error = 0.5913092, gradient norm = 0.0002589 (50 iterations in 0.028s)
[t-SNE] Iteration 750: error = 0.5913148, gradient norm = 0.0002935 (50 iterations in 0.028s)
[t-SNE] Iteration 800: error = 0.5912032, gradient norm = 0.0002548 (50 iterations in 0.028s)
[t-SNE] Iteration 850: error = 0.5916865, gradient norm = 0.0003662 (50 iterations in 0.028s)
[t-SNE] Iteration 900: error = 0.5913151, gradient norm = 0.0002260 (50 iterations in 0.028s)
[t-SNE] Iteration 950: error = 0.5915533, gradient norm = 0.0003288 (50 iterations in 0.028s)
[t-SNE] Iteration 1000: error = 0.5913032, gradient norm = 0.0002456 (50 iterations in 0.028s)
[t-SNE] KL divergence after 1000 iterations: 0.591303
[t-SNE] Computed conditional probabilities for sample 170 / 170
[t-SNE] Mean sigma: 0.437386
Beginning preprocessing + Leiden
2024-03-12 03:16:32.803576 MEMORY 16.131182592
Affmat transformed
2024-03-12 03:16:32.806050 MEMORY 16.131182592
sources, targets, weights extracted
2024-03-12 03:16:32.807044 MEMORY 16.131182592
About to launch parallel Leiden runs
2024-03-12 03:16:32.811758 MEMORY 16.131182592
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.8s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.3s finished
Parallel Leiden runs finished
2024-03-12 03:16:35.127899 MEMORY 16.131182592
Quality: 0.334520975131399
Quality: 0.33452097513139906
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 166 out of 166 | elapsed:    0.1s finished
Got subclusters: Counter({0: 52, 1: 42, 3: 28, 2: 28, 4: 20})
On pattern 28
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 166 samples in 0.002s...
[t-SNE] Computed neighbors for 166 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 166 / 166
[t-SNE] Mean sigma: 0.430613
[t-SNE] Computed conditional probabilities in 0.013s
[t-SNE] Iteration 50: error = 61.0163612, gradient norm = 0.4456117 (50 iterations in 0.030s)
[t-SNE] Iteration 100: error = 60.2881584, gradient norm = 0.4683625 (50 iterations in 0.030s)
[t-SNE] Iteration 150: error = 60.2520485, gradient norm = 0.4560753 (50 iterations in 0.030s)
[t-SNE] Iteration 200: error = 61.2511330, gradient norm = 0.4602053 (50 iterations in 0.030s)
[t-SNE] Iteration 250: error = 58.3224602, gradient norm = 0.5247300 (50 iterations in 0.033s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 58.322460
[t-SNE] Iteration 300: error = 0.8307828, gradient norm = 0.0099049 (50 iterations in 0.029s)
[t-SNE] Iteration 350: error = 0.6325890, gradient norm = 0.0032105 (50 iterations in 0.029s)
[t-SNE] Iteration 400: error = 0.6207023, gradient norm = 0.0009961 (50 iterations in 0.029s)
[t-SNE] Iteration 450: error = 0.6204515, gradient norm = 0.0001502 (50 iterations in 0.029s)
[t-SNE] Iteration 500: error = 0.6205705, gradient norm = 0.0002317 (50 iterations in 0.029s)
[t-SNE] Iteration 550: error = 0.6205031, gradient norm = 0.0001927 (50 iterations in 0.031s)
[t-SNE] Iteration 600: error = 0.6204866, gradient norm = 0.0001231 (50 iterations in 0.029s)
[t-SNE] Iteration 650: error = 0.6205558, gradient norm = 0.0001484 (50 iterations in 0.029s)
[t-SNE] Iteration 700: error = 0.6204724, gradient norm = 0.0001637 (50 iterations in 0.029s)
[t-SNE] Iteration 750: error = 0.6206082, gradient norm = 0.0001729 (50 iterations in 0.029s)
[t-SNE] Iteration 800: error = 0.6205960, gradient norm = 0.0001539 (50 iterations in 0.029s)
[t-SNE] Iteration 800: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 800 iterations: 0.620596
[t-SNE] Computed conditional probabilities for sample 166 / 166
[t-SNE] Mean sigma: 0.430613
Beginning preprocessing + Leiden
2024-03-12 03:16:35.895312 MEMORY 16.131182592
Affmat transformed
2024-03-12 03:16:35.898003 MEMORY 16.131182592
sources, targets, weights extracted
2024-03-12 03:16:35.899037 MEMORY 16.131182592
About to launch parallel Leiden runs
2024-03-12 03:16:35.904387 MEMORY 16.131182592
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.8s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.3s finished
Parallel Leiden runs finished
2024-03-12 03:16:38.209022 MEMORY 16.131182592
Quality: 0.28458092069000135
Quality: 0.2855131078459705
Quality: 0.2857310855795574
Quality: 0.28588781255058393
Quality: 0.2859239864697792
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  74 out of 121 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=24)]: Done 121 out of 121 | elapsed:    0.1s finished
Got subclusters: Counter({0: 39, 1: 34, 2: 32, 3: 22, 4: 22, 5: 17})
On pattern 29
[t-SNE] Computing 120 nearest neighbors...
[t-SNE] Indexed 121 samples in 0.001s...
[t-SNE] Computed neighbors for 121 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 121 / 121
[t-SNE] Mean sigma: 0.629611
[t-SNE] Computed conditional probabilities in 0.007s
[t-SNE] Iteration 50: error = 53.2596169, gradient norm = 0.5069087 (50 iterations in 0.027s)
[t-SNE] Iteration 100: error = 50.1769981, gradient norm = 0.5061784 (50 iterations in 0.027s)
[t-SNE] Iteration 150: error = 52.2024803, gradient norm = 0.4551688 (50 iterations in 0.029s)
[t-SNE] Iteration 200: error = 51.5880394, gradient norm = 0.5229007 (50 iterations in 0.026s)
[t-SNE] Iteration 250: error = 49.8716850, gradient norm = 0.5872195 (50 iterations in 0.026s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 49.871685
[t-SNE] Iteration 300: error = 0.4268512, gradient norm = 0.0130372 (50 iterations in 0.025s)
[t-SNE] Iteration 350: error = 0.2743222, gradient norm = 0.0012457 (50 iterations in 0.025s)
[t-SNE] Iteration 400: error = 0.2744203, gradient norm = 0.0003187 (50 iterations in 0.025s)
[t-SNE] Iteration 450: error = 0.2744808, gradient norm = 0.0005110 (50 iterations in 0.025s)
[t-SNE] Iteration 500: error = 0.2742858, gradient norm = 0.0005223 (50 iterations in 0.025s)
[t-SNE] Iteration 550: error = 0.2744086, gradient norm = 0.0003077 (50 iterations in 0.025s)
[t-SNE] Iteration 600: error = 0.2743309, gradient norm = 0.0005062 (50 iterations in 0.025s)
[t-SNE] Iteration 650: error = 0.2742894, gradient norm = 0.0003796 (50 iterations in 0.028s)
[t-SNE] Iteration 700: error = 0.2743290, gradient norm = 0.0003320 (50 iterations in 0.025s)
[t-SNE] Iteration 750: error = 0.2744432, gradient norm = 0.0004097 (50 iterations in 0.025s)
[t-SNE] Iteration 800: error = 0.2742999, gradient norm = 0.0003290 (50 iterations in 0.025s)
[t-SNE] Iteration 850: error = 0.2743586, gradient norm = 0.0004135 (50 iterations in 0.025s)
[t-SNE] Iteration 850: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 850 iterations: 0.274359
[t-SNE] Computed conditional probabilities for sample 121 / 121
[t-SNE] Mean sigma: 0.629611
Beginning preprocessing + Leiden
2024-03-12 03:16:38.853976 MEMORY 16.131182592
Affmat transformed
2024-03-12 03:16:38.855818 MEMORY 16.131182592
sources, targets, weights extracted
2024-03-12 03:16:38.856690 MEMORY 16.131182592
About to launch parallel Leiden runs
2024-03-12 03:16:38.861486 MEMORY 16.131182592
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.1s finished
Parallel Leiden runs finished
2024-03-12 03:16:40.928948 MEMORY 16.131182592
Quality: 0.3472182261095028
Quality: 0.347378110595563
Quality: 0.3474320924431739
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 118 out of 118 | elapsed:    0.0s finished
Got subclusters: Counter({0: 34, 1: 31, 2: 28, 3: 21, 4: 7})
On pattern 30
[t-SNE] Computing 117 nearest neighbors...
[t-SNE] Indexed 118 samples in 0.001s...
[t-SNE] Computed neighbors for 118 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 118 / 118
[t-SNE] Mean sigma: 0.497504
[t-SNE] Computed conditional probabilities in 0.007s
[t-SNE] Iteration 50: error = 53.8280983, gradient norm = 0.5266641 (50 iterations in 0.027s)
[t-SNE] Iteration 100: error = 51.5239677, gradient norm = 0.5181246 (50 iterations in 0.026s)
[t-SNE] Iteration 150: error = 53.6257668, gradient norm = 0.6021210 (50 iterations in 0.026s)
[t-SNE] Iteration 200: error = 55.6925926, gradient norm = 0.5144166 (50 iterations in 0.026s)
[t-SNE] Iteration 250: error = 55.3223648, gradient norm = 0.5031088 (50 iterations in 0.026s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 55.322365
[t-SNE] Iteration 300: error = 0.7016762, gradient norm = 0.0141241 (50 iterations in 0.023s)
[t-SNE] Iteration 350: error = 0.4017445, gradient norm = 0.0030411 (50 iterations in 0.025s)
[t-SNE] Iteration 400: error = 0.3937060, gradient norm = 0.0020674 (50 iterations in 0.025s)
[t-SNE] Iteration 450: error = 0.3940904, gradient norm = 0.0003135 (50 iterations in 0.025s)
[t-SNE] Iteration 500: error = 0.3943194, gradient norm = 0.0005310 (50 iterations in 0.025s)
[t-SNE] Iteration 550: error = 0.3940956, gradient norm = 0.0004670 (50 iterations in 0.025s)
[t-SNE] Iteration 600: error = 0.3942086, gradient norm = 0.0003458 (50 iterations in 0.025s)
[t-SNE] Iteration 650: error = 0.3940965, gradient norm = 0.0004984 (50 iterations in 0.025s)
[t-SNE] Iteration 700: error = 0.3940827, gradient norm = 0.0003694 (50 iterations in 0.025s)
[t-SNE] Iteration 750: error = 0.3941448, gradient norm = 0.0003170 (50 iterations in 0.025s)
[t-SNE] Iteration 750: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 750 iterations: 0.394145
[t-SNE] Computed conditional probabilities for sample 118 / 118
[t-SNE] Mean sigma: 0.497505
Beginning preprocessing + Leiden
2024-03-12 03:16:41.490462 MEMORY 16.131182592
Affmat transformed
2024-03-12 03:16:41.492200 MEMORY 16.131182592
sources, targets, weights extracted
2024-03-12 03:16:41.493023 MEMORY 16.131182592
About to launch parallel Leiden runs
2024-03-12 03:16:41.497646 MEMORY 16.131182592
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.0s finished
Parallel Leiden runs finished
2024-03-12 03:16:43.527151 MEMORY 16.131182592
Quality: 0.2491745364056819
Quality: 0.25105192045098423
Quality: 0.2511125930934443
Quality: 0.25142576293311186
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  68 out of 115 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=24)]: Done 115 out of 115 | elapsed:    0.1s finished
Got subclusters: Counter({0: 31, 1: 28, 2: 21, 3: 21, 4: 15, 5: 2})
On pattern 31
[t-SNE] Computing 114 nearest neighbors...
[t-SNE] Indexed 115 samples in 0.001s...
[t-SNE] Computed neighbors for 115 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 115 / 115
[t-SNE] Mean sigma: 0.489315
[t-SNE] Computed conditional probabilities in 0.006s
[t-SNE] Iteration 50: error = 60.9557266, gradient norm = 0.4031975 (50 iterations in 0.023s)
[t-SNE] Iteration 100: error = 52.2688675, gradient norm = 0.5741877 (50 iterations in 0.022s)
[t-SNE] Iteration 150: error = 54.2835617, gradient norm = 0.4990296 (50 iterations in 0.022s)
[t-SNE] Iteration 200: error = 53.7251434, gradient norm = 0.4857547 (50 iterations in 0.021s)
[t-SNE] Iteration 250: error = 56.2602997, gradient norm = 0.5025283 (50 iterations in 0.022s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 56.260300
[t-SNE] Iteration 300: error = 0.9474859, gradient norm = 0.0079771 (50 iterations in 0.020s)
[t-SNE] Iteration 350: error = 0.6410483, gradient norm = 0.0077419 (50 iterations in 0.020s)
[t-SNE] Iteration 400: error = 0.4091643, gradient norm = 0.0036289 (50 iterations in 0.022s)
[t-SNE] Iteration 450: error = 0.4081119, gradient norm = 0.0005084 (50 iterations in 0.022s)
[t-SNE] Iteration 500: error = 0.4080932, gradient norm = 0.0004514 (50 iterations in 0.023s)
[t-SNE] Iteration 550: error = 0.4077853, gradient norm = 0.0003900 (50 iterations in 0.023s)
[t-SNE] Iteration 600: error = 0.4082111, gradient norm = 0.0004044 (50 iterations in 0.023s)
[t-SNE] Iteration 650: error = 0.4079269, gradient norm = 0.0003576 (50 iterations in 0.023s)
[t-SNE] Iteration 700: error = 0.4073209, gradient norm = 0.0005129 (50 iterations in 0.023s)
[t-SNE] Iteration 750: error = 0.4080232, gradient norm = 0.0005255 (50 iterations in 0.023s)
[t-SNE] Iteration 800: error = 0.4077280, gradient norm = 0.0003453 (50 iterations in 0.023s)
[t-SNE] Iteration 850: error = 0.4085194, gradient norm = 0.0004693 (50 iterations in 0.023s)
[t-SNE] Iteration 900: error = 0.4080953, gradient norm = 0.0005569 (50 iterations in 0.023s)
[t-SNE] Iteration 950: error = 0.4077775, gradient norm = 0.0003280 (50 iterations in 0.023s)
[t-SNE] Iteration 1000: error = 0.4085698, gradient norm = 0.0004383 (50 iterations in 0.023s)
[t-SNE] KL divergence after 1000 iterations: 0.408570
[t-SNE] Computed conditional probabilities for sample 115 / 115
[t-SNE] Mean sigma: 0.489315
Beginning preprocessing + Leiden
2024-03-12 03:16:44.160870 MEMORY 16.131182592
Affmat transformed
2024-03-12 03:16:44.162620 MEMORY 16.131182592
sources, targets, weights extracted
2024-03-12 03:16:44.163461 MEMORY 16.131182592
About to launch parallel Leiden runs
2024-03-12 03:16:44.167767 MEMORY 16.131182592
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.0s finished
Parallel Leiden runs finished
2024-03-12 03:16:46.218726 MEMORY 16.131182592
Quality: 0.24570213757782777
Quality: 0.2474519710056202
Quality: 0.24781338067851502
Quality: 0.2499680486431419
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  66 out of  66 | elapsed:    0.0s finished
Got subclusters: Counter({0: 42, 1: 38, 2: 18, 3: 17})
On pattern 32
[t-SNE] Computing 65 nearest neighbors...
[t-SNE] Indexed 66 samples in 0.001s...
[t-SNE] Computed neighbors for 66 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 66 / 66
[t-SNE] Mean sigma: 0.933497
[t-SNE] Computed conditional probabilities in 0.002s
[t-SNE] Iteration 50: error = 43.1271248, gradient norm = 0.5485994 (50 iterations in 0.016s)
[t-SNE] Iteration 100: error = 45.0602074, gradient norm = 0.4649788 (50 iterations in 0.016s)
[t-SNE] Iteration 150: error = 47.6443062, gradient norm = 0.5298436 (50 iterations in 0.016s)
[t-SNE] Iteration 200: error = 47.0085030, gradient norm = 0.4680837 (50 iterations in 0.016s)
[t-SNE] Iteration 250: error = 46.8942947, gradient norm = 0.5963130 (50 iterations in 0.016s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 46.894295
[t-SNE] Iteration 300: error = 0.8157926, gradient norm = 0.0018171 (50 iterations in 0.016s)
[t-SNE] Iteration 350: error = 0.6853051, gradient norm = 0.0015307 (50 iterations in 0.016s)
[t-SNE] Iteration 400: error = 0.6203870, gradient norm = 0.0009865 (50 iterations in 0.015s)
[t-SNE] Iteration 450: error = 0.5605177, gradient norm = 0.0006426 (50 iterations in 0.015s)
[t-SNE] Iteration 500: error = 0.5225203, gradient norm = 0.0005582 (50 iterations in 0.015s)
[t-SNE] Iteration 550: error = 0.4993947, gradient norm = 0.0004444 (50 iterations in 0.015s)
[t-SNE] Iteration 600: error = 0.4787874, gradient norm = 0.0011861 (50 iterations in 0.015s)
[t-SNE] Iteration 650: error = 0.4574478, gradient norm = 0.0003094 (50 iterations in 0.015s)
[t-SNE] Iteration 700: error = 0.4434081, gradient norm = 0.0008793 (50 iterations in 0.018s)
[t-SNE] Iteration 750: error = 0.4023822, gradient norm = 0.0018930 (50 iterations in 0.015s)
[t-SNE] Iteration 800: error = 0.3671285, gradient norm = 0.0011488 (50 iterations in 0.015s)
[t-SNE] Iteration 850: error = 0.5659071, gradient norm = 0.0033119 (50 iterations in 0.016s)
[t-SNE] Iteration 900: error = 0.4816630, gradient norm = 0.0011831 (50 iterations in 0.015s)
[t-SNE] Iteration 950: error = 0.4436889, gradient norm = 0.0015496 (50 iterations in 0.016s)
[t-SNE] Iteration 1000: error = 0.4056116, gradient norm = 0.0008126 (50 iterations in 0.016s)
[t-SNE] KL divergence after 1000 iterations: 0.405612
[t-SNE] Computed conditional probabilities for sample 66 / 66
[t-SNE] Mean sigma: 0.933497
Beginning preprocessing + Leiden
2024-03-12 03:16:46.627062 MEMORY 16.131182592
Affmat transformed
2024-03-12 03:16:46.628266 MEMORY 16.131182592
sources, targets, weights extracted
2024-03-12 03:16:46.628757 MEMORY 16.131182592
About to launch parallel Leiden runs
2024-03-12 03:16:46.633513 MEMORY 16.131182592
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.0s finished
Parallel Leiden runs finished
2024-03-12 03:16:48.591316 MEMORY 16.131182592
Quality: 0.17492634734298926
Quality: 0.17542963784172408
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  55 out of  55 | elapsed:    0.0s finished
Got subclusters: Counter({0: 27, 1: 20, 2: 19})
On pattern 33
[t-SNE] Computing 54 nearest neighbors...
[t-SNE] Indexed 55 samples in 0.001s...
[t-SNE] Computed neighbors for 55 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 55 / 55
[t-SNE] Mean sigma: 0.841070
[t-SNE] Computed conditional probabilities in 0.002s
[t-SNE] Iteration 50: error = 44.5858955, gradient norm = 0.4332725 (50 iterations in 0.015s)
[t-SNE] Iteration 100: error = 45.4911003, gradient norm = 0.4320498 (50 iterations in 0.015s)
[t-SNE] Iteration 150: error = 43.2586594, gradient norm = 0.5458887 (50 iterations in 0.014s)
[t-SNE] Iteration 200: error = 43.6431389, gradient norm = 0.4822881 (50 iterations in 0.015s)
[t-SNE] Iteration 250: error = 43.7354813, gradient norm = 0.3610554 (50 iterations in 0.014s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 43.735481
[t-SNE] Iteration 300: error = 0.7479563, gradient norm = 0.0012952 (50 iterations in 0.014s)
[t-SNE] Iteration 350: error = 0.6889533, gradient norm = 0.0002793 (50 iterations in 0.014s)
[t-SNE] Iteration 400: error = 0.6667936, gradient norm = 0.0003579 (50 iterations in 0.014s)
[t-SNE] Iteration 450: error = 0.6460282, gradient norm = 0.0002633 (50 iterations in 0.014s)
[t-SNE] Iteration 500: error = 0.6319218, gradient norm = 0.0002260 (50 iterations in 0.014s)
[t-SNE] Iteration 550: error = 0.6256061, gradient norm = 0.0002033 (50 iterations in 0.014s)
[t-SNE] Iteration 600: error = 0.6127664, gradient norm = 0.0003239 (50 iterations in 0.014s)
[t-SNE] Iteration 650: error = 0.6002840, gradient norm = 0.0001952 (50 iterations in 0.014s)
[t-SNE] Iteration 700: error = 0.5864779, gradient norm = 0.0003497 (50 iterations in 0.014s)
[t-SNE] Iteration 750: error = 0.5695174, gradient norm = 0.0003113 (50 iterations in 0.014s)
[t-SNE] Iteration 800: error = 0.5621849, gradient norm = 0.0001878 (50 iterations in 0.014s)
[t-SNE] Iteration 850: error = 0.5554473, gradient norm = 0.0003201 (50 iterations in 0.014s)
[t-SNE] Iteration 900: error = 0.5525691, gradient norm = 0.0001157 (50 iterations in 0.014s)
[t-SNE] Iteration 950: error = 0.5496434, gradient norm = 0.0002032 (50 iterations in 0.014s)
[t-SNE] Iteration 1000: error = 0.5436272, gradient norm = 0.0002812 (50 iterations in 0.014s)
[t-SNE] KL divergence after 1000 iterations: 0.543627
[t-SNE] Computed conditional probabilities for sample 55 / 55
[t-SNE] Mean sigma: 0.841069
Beginning preprocessing + Leiden
2024-03-12 03:16:48.941965 MEMORY 16.131182592
Affmat transformed
2024-03-12 03:16:48.942930 MEMORY 16.131182592
sources, targets, weights extracted
2024-03-12 03:16:48.943369 MEMORY 16.131182592
About to launch parallel Leiden runs
2024-03-12 03:16:48.948080 MEMORY 16.131182592
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.9s finished
Parallel Leiden runs finished
2024-03-12 03:16:50.810857 MEMORY 16.131182592
Quality: 0.05369588014018765
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done  42 out of  44 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=24)]: Done  44 out of  44 | elapsed:    0.0s finished
Got subclusters: Counter({0: 23, 1: 18, 2: 14})
On pattern 34
[t-SNE] Computing 43 nearest neighbors...
[t-SNE] Indexed 44 samples in 0.001s...
[t-SNE] Computed neighbors for 44 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 44 / 44
[t-SNE] Mean sigma: 12.316806
[t-SNE] Computed conditional probabilities in 0.001s
[t-SNE] Iteration 50: error = 43.7073174, gradient norm = 0.5699675 (50 iterations in 0.018s)
[t-SNE] Iteration 100: error = 44.5170784, gradient norm = 0.5144794 (50 iterations in 0.013s)
[t-SNE] Iteration 150: error = 42.3043404, gradient norm = 0.4448965 (50 iterations in 0.013s)
[t-SNE] Iteration 200: error = 47.9829865, gradient norm = 0.3641520 (50 iterations in 0.013s)
[t-SNE] Iteration 250: error = 41.6133118, gradient norm = 0.5726822 (50 iterations in 0.013s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 41.613312
[t-SNE] Iteration 300: error = 0.7980957, gradient norm = 0.0013346 (50 iterations in 0.013s)
[t-SNE] Iteration 350: error = 0.6121422, gradient norm = 0.0003992 (50 iterations in 0.013s)
[t-SNE] Iteration 400: error = 0.5916129, gradient norm = 0.0001081 (50 iterations in 0.013s)
[t-SNE] Iteration 450: error = 0.5888833, gradient norm = 0.0000514 (50 iterations in 0.013s)
[t-SNE] Iteration 500: error = 0.5875570, gradient norm = 0.0000314 (50 iterations in 0.013s)
[t-SNE] Iteration 550: error = 0.5873342, gradient norm = 0.0000199 (50 iterations in 0.013s)
[t-SNE] Iteration 600: error = 0.5872230, gradient norm = 0.0000154 (50 iterations in 0.013s)
[t-SNE] Iteration 650: error = 0.5873567, gradient norm = 0.0000213 (50 iterations in 0.013s)
[t-SNE] Iteration 700: error = 0.5866236, gradient norm = 0.0000199 (50 iterations in 0.013s)
[t-SNE] Iteration 750: error = 0.5865657, gradient norm = 0.0000228 (50 iterations in 0.013s)
[t-SNE] Iteration 800: error = 0.5863260, gradient norm = 0.0000181 (50 iterations in 0.013s)
[t-SNE] Iteration 850: error = 0.5862478, gradient norm = 0.0000113 (50 iterations in 0.013s)
[t-SNE] Iteration 900: error = 0.5861285, gradient norm = 0.0000111 (50 iterations in 0.013s)
[t-SNE] Iteration 950: error = 0.5860918, gradient norm = 0.0000112 (50 iterations in 0.013s)
[t-SNE] Iteration 1000: error = 0.5862064, gradient norm = 0.0000121 (50 iterations in 0.013s)
[t-SNE] KL divergence after 1000 iterations: 0.586206
[t-SNE] Computed conditional probabilities for sample 44 / 44
[t-SNE] Mean sigma: 1125899906842624.000000
Beginning preprocessing + Leiden
2024-03-12 03:16:51.131452 MEMORY 16.131182592
Affmat transformed
2024-03-12 03:16:51.132338 MEMORY 16.131182592
sources, targets, weights extracted
2024-03-12 03:16:51.132740 MEMORY 16.131182592
About to launch parallel Leiden runs
2024-03-12 03:16:51.155057 MEMORY 16.131182592
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.8s finished
Parallel Leiden runs finished
2024-03-12 03:16:53.007728 MEMORY 16.131182592
Quality: -1.584288256140165e-13
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done  32 out of  39 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=24)]: Done  39 out of  39 | elapsed:    0.0s finished
Got subclusters: Counter({0: 44})
On pattern 35
[t-SNE] Computing 38 nearest neighbors...
[t-SNE] Indexed 39 samples in 0.000s...
[t-SNE] Computed neighbors for 39 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 39 / 39
[t-SNE] Mean sigma: 10.774647
[t-SNE] Computed conditional probabilities in 0.001s
[t-SNE] Iteration 50: error = 45.9743881, gradient norm = 0.4517495 (50 iterations in 0.014s)
[t-SNE] Iteration 100: error = 48.9474716, gradient norm = 0.5651181 (50 iterations in 0.013s)
[t-SNE] Iteration 150: error = 49.6303978, gradient norm = 0.3770198 (50 iterations in 0.013s)
[t-SNE] Iteration 200: error = 47.9765701, gradient norm = 0.5859947 (50 iterations in 0.013s)
[t-SNE] Iteration 250: error = 46.7104034, gradient norm = 0.3617465 (50 iterations in 0.013s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 46.710403
[t-SNE] Iteration 300: error = 0.6546350, gradient norm = 0.0008610 (50 iterations in 0.013s)
[t-SNE] Iteration 350: error = 0.5958178, gradient norm = 0.0004146 (50 iterations in 0.013s)
[t-SNE] Iteration 400: error = 0.5631747, gradient norm = 0.0000941 (50 iterations in 0.013s)
[t-SNE] Iteration 450: error = 0.5609333, gradient norm = 0.0000599 (50 iterations in 0.013s)
[t-SNE] Iteration 500: error = 0.5596044, gradient norm = 0.0000320 (50 iterations in 0.012s)
[t-SNE] Iteration 550: error = 0.5593073, gradient norm = 0.0000198 (50 iterations in 0.013s)
[t-SNE] Iteration 600: error = 0.5594442, gradient norm = 0.0000133 (50 iterations in 0.013s)
[t-SNE] Iteration 650: error = 0.5594465, gradient norm = 0.0000127 (50 iterations in 0.012s)
[t-SNE] Iteration 700: error = 0.5593506, gradient norm = 0.0000130 (50 iterations in 0.012s)
[t-SNE] Iteration 750: error = 0.5592296, gradient norm = 0.0000166 (50 iterations in 0.012s)
[t-SNE] Iteration 800: error = 0.5591006, gradient norm = 0.0000207 (50 iterations in 0.012s)
[t-SNE] Iteration 850: error = 0.5592024, gradient norm = 0.0000196 (50 iterations in 0.012s)
[t-SNE] Iteration 900: error = 0.5590089, gradient norm = 0.0000220 (50 iterations in 0.012s)
[t-SNE] Iteration 950: error = 0.5586076, gradient norm = 0.0000344 (50 iterations in 0.012s)
[t-SNE] Iteration 1000: error = 0.5577839, gradient norm = 0.0000838 (50 iterations in 0.012s)
[t-SNE] KL divergence after 1000 iterations: 0.557784
[t-SNE] Computed conditional probabilities for sample 39 / 39
[t-SNE] Mean sigma: 1125899906842624.000000
Beginning preprocessing + Leiden
2024-03-12 03:16:53.311731 MEMORY 16.131182592
Affmat transformed
2024-03-12 03:16:53.313176 MEMORY 16.131182592
sources, targets, weights extracted
2024-03-12 03:16:53.313612 MEMORY 16.131182592
About to launch parallel Leiden runs
2024-03-12 03:16:53.318760 MEMORY 16.131182592
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.8s finished
Parallel Leiden runs finished
2024-03-12 03:16:55.171601 MEMORY 16.131182592
Quality: 4.0412118096357004e-14
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done  24 out of  35 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=24)]: Done  35 out of  35 | elapsed:    0.0s finished
Got subclusters: Counter({0: 39})
On pattern 36
[t-SNE] Computing 34 nearest neighbors...
[t-SNE] Indexed 35 samples in 0.001s...
[t-SNE] Computed neighbors for 35 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 35 / 35
[t-SNE] Mean sigma: 12.677440
[t-SNE] Computed conditional probabilities in 0.001s
[t-SNE] Iteration 50: error = 51.2339058, gradient norm = 0.4525244 (50 iterations in 0.029s)
[t-SNE] Iteration 100: error = 42.6021805, gradient norm = 0.3914417 (50 iterations in 0.014s)
[t-SNE] Iteration 150: error = 44.9828835, gradient norm = 0.5181183 (50 iterations in 0.014s)
[t-SNE] Iteration 200: error = 49.1611099, gradient norm = 0.6582443 (50 iterations in 0.014s)
[t-SNE] Iteration 250: error = 43.8779755, gradient norm = 0.5052695 (50 iterations in 0.014s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 43.877975
[t-SNE] Iteration 300: error = 0.6785699, gradient norm = 0.0010045 (50 iterations in 0.014s)
[t-SNE] Iteration 350: error = 0.5685499, gradient norm = 0.0004281 (50 iterations in 0.014s)
[t-SNE] Iteration 400: error = 0.5371358, gradient norm = 0.0000543 (50 iterations in 0.014s)
[t-SNE] Iteration 450: error = 0.5366428, gradient norm = 0.0000344 (50 iterations in 0.014s)
[t-SNE] Iteration 500: error = 0.5358067, gradient norm = 0.0000225 (50 iterations in 0.014s)
[t-SNE] Iteration 550: error = 0.5356065, gradient norm = 0.0000185 (50 iterations in 0.013s)
[t-SNE] Iteration 600: error = 0.5352688, gradient norm = 0.0000301 (50 iterations in 0.013s)
[t-SNE] Iteration 650: error = 0.5341736, gradient norm = 0.0000241 (50 iterations in 0.013s)
[t-SNE] Iteration 700: error = 0.5340595, gradient norm = 0.0000250 (50 iterations in 0.013s)
[t-SNE] Iteration 750: error = 0.5334087, gradient norm = 0.0000367 (50 iterations in 0.015s)
[t-SNE] Iteration 800: error = 0.5328080, gradient norm = 0.0000364 (50 iterations in 0.014s)
[t-SNE] Iteration 850: error = 0.5325953, gradient norm = 0.0000280 (50 iterations in 0.013s)
[t-SNE] Iteration 900: error = 0.5324413, gradient norm = 0.0000683 (50 iterations in 0.014s)
[t-SNE] Iteration 950: error = 0.5322356, gradient norm = 0.0000301 (50 iterations in 0.013s)
[t-SNE] Iteration 1000: error = 0.5315768, gradient norm = 0.0001001 (50 iterations in 0.013s)
[t-SNE] KL divergence after 1000 iterations: 0.531577
[t-SNE] Computed conditional probabilities for sample 35 / 35
[t-SNE] Mean sigma: 1125899906842624.000000
Beginning preprocessing + Leiden
2024-03-12 03:16:55.508489 MEMORY 16.131182592
Affmat transformed
2024-03-12 03:16:55.509468 MEMORY 16.131182592
sources, targets, weights extracted
2024-03-12 03:16:55.509891 MEMORY 16.131182592
About to launch parallel Leiden runs
2024-03-12 03:16:55.514083 MEMORY 16.131182592
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.6s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.8s finished
Parallel Leiden runs finished
2024-03-12 03:16:57.328842 MEMORY 16.131182592
Quality: 2.2204460492503205e-16
Got subclusters: Counter({0: 35})
