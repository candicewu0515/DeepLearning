/ru-auth/local/home/xwu05/.local/lib/python3.9/site-packages/pandas/core/computation/expressions.py:21: UserWarning: Pandas requires version '2.8.0' or newer of 'numexpr' (version '2.7.3' currently installed).
  from pandas.core.computation.check import NUMEXPR_INSTALLED
/ru-auth/local/home/xwu05/.local/lib/python3.9/site-packages/pandas/core/arrays/masked.py:62: UserWarning: Pandas requires version '1.3.4' or newer of 'bottleneck' (version '1.3.2' currently installed).
  from pandas.core import (
[22;0t]0;IPython: detect_peaks_scripts/run_modelMEMORY 11.478880256
On task head
Computing windowed sums on original
Generating null dist
peak(mu)= 9.09848794370012e-06
Computing threshold
Subsampling!
For increasing = True , the minimum IR precision was 0.4454317273684344 occurring at 0.0 implying a frac_neg of 0.8032044914050872
To be conservative, adjusted frac neg is 0.95
For increasing = False , the minimum IR precision was 0.4278625376141122 occurring at -1.2649364133920926e-07 implying a frac_neg of 0.7478317113336184
To be conservative, adjusted frac neg is 0.95
Thresholds from null dist were -0.6900725681793016  and  0.6425454450701324 with frac passing 0.035514
Final raw thresholds are -0.6900725681793016  and  0.6425454450701324
Final transformed thresholds are -0.9674926126387922  and  0.9609439658963048
saving plot to figures/scoredist_0.png
Got 134587 coords
On task testis
Computing windowed sums on original
Generating null dist
peak(mu)= -5.959093489009762e-06
Computing threshold
Subsampling!
For increasing = True , the minimum IR precision was 0.42357985773733453 occurring at 0.0 implying a frac_neg of 0.7348456909826651
To be conservative, adjusted frac neg is 0.95
For increasing = False , the minimum IR precision was 0.4648547209978532 occurring at -3.942190751615726e-08 implying a frac_neg of 0.8686514470699243
To be conservative, adjusted frac neg is 0.95
Thresholds from null dist were -1.0956381603249103  and  0.6911736332464227 with frac passing 0.021429
Passing windows frac was 0.021429 , which is below  0.03 ; adjusting
Final raw thresholds are -0.7489549997684799  and  0.7489549997684799
Final transformed thresholds are -0.9703135574632595  and  0.9703135574632595
saving plot to figures/scoredist_1.png
Got 118992 coords
After resolving overlaps, got 171101 seqlets
Across all tasks, the weakest transformed threshold used was: 0.9608439658963048
MEMORY 12.529119232
171101 identified in total
min_metacluster_size_frac * len(seqlets) = 1711 is more than min_metacluster_size=100.
Using it as a new min_metacluster_size
6 activity patterns with support >= 1711 out of 8 possible patterns
Metacluster sizes:  [86697, 67208, 5871, 5571, 2939, 2815]
Idx to activities:  {0: '-1,-1', 1: '1,1', 2: '-1,0', 3: '0,1', 4: '1,0', 5: '0,-1'}
MEMORY 12.529127424
On metacluster 5
Metacluster size 2815
Relevant tasks:  ('testis',)
Relevant signs:  (-1,)
TfModiscoSeqletsToPatternsFactory: seed=1234
(Round 1) num seqlets: 2815
(Round 1) Computing coarse affmat
2024-03-11 22:36:48.562597 MEMORY 12.527824896
Beginning embedding computation
MEMORY 12.527824896
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
At the beginning of embedding call
2024-03-11 22:36:48.562805 MEMORY 12.527824896
before computing embeddings fwd
2024-03-11 22:36:48.571558 MEMORY 12.52786176
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:   10.7s
[Parallel(n_jobs=24)]: Done 152 tasks      | elapsed:   12.5s
[Parallel(n_jobs=24)]: Done 402 tasks      | elapsed:   15.5s
[Parallel(n_jobs=24)]: Done 752 tasks      | elapsed:   19.5s
[Parallel(n_jobs=24)]: Done 1202 tasks      | elapsed:   24.3s
[Parallel(n_jobs=24)]: Done 1752 tasks      | elapsed:   30.4s
[Parallel(n_jobs=24)]: Done 2402 tasks      | elapsed:   37.4s
[Parallel(n_jobs=24)]: Done 2815 out of 2815 | elapsed:   41.8s finished
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 152 tasks      | elapsed:    1.9s
[Parallel(n_jobs=24)]: Done 402 tasks      | elapsed:    4.6s
[Parallel(n_jobs=24)]: Done 752 tasks      | elapsed:    8.4s
[Parallel(n_jobs=24)]: Done 1202 tasks      | elapsed:   13.3s
[Parallel(n_jobs=24)]: Done 1752 tasks      | elapsed:   19.3s
[Parallel(n_jobs=24)]: Done 2402 tasks      | elapsed:   26.4s
[Parallel(n_jobs=24)]: Done 2815 out of 2815 | elapsed:   30.8s finished
after computing embeddings fwd
2024-03-11 22:37:30.730144 MEMORY 12.626898944
after computing embeddings rev
2024-03-11 22:38:01.532208 MEMORY 12.742176768
before computing sparse embeddings fwd
2024-03-11 22:38:01.532308 MEMORY 12.742176768
Constructing csr matrix...
csr matrix made in 0.35402393341064453 s
after computing sparse embeddings fwd
2024-03-11 22:38:01.998480 MEMORY 12.74230784
before computing sparse embeddings rev
2024-03-11 22:38:01.998560 MEMORY 12.74230784
Constructing csr matrix...
csr matrix made in 0.3575417995452881 s
after computing sparse embeddings rev
2024-03-11 22:38:02.477064 MEMORY 12.742356992
Finished embedding computation in 75.55 s
MEMORY 12.621144064
Starting affinity matrix computations
MEMORY 12.62088192
Batching in slices of size 2815
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:02<00:00,  2.22s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:02<00:00,  2.23s/it]
Finished affinity matrix computations in 2.26 s
MEMORY 12.621041664
(Round 1) Computed coarse affmat
2024-03-11 22:38:07.391357 MEMORY 12.621041664
(Round 1) Computing affinity matrix on nearest neighbors
2024-03-11 22:38:07.391499 MEMORY 12.621041664
Launching nearest neighbors affmat calculation job
MEMORY 12.621041664
Parallel runs completed
MEMORY 12.725915648
Job completed in: 9.18 s
MEMORY 12.724342784
Launching nearest neighbors affmat calculation job
MEMORY 12.724736
Parallel runs completed
MEMORY 12.778565632
Job completed in: 8.86 s
MEMORY 12.778971136
(Round 1) Computed affinity matrix on nearest neighbors in 19.2 s
2024-03-11 22:38:26.590462 MEMORY 12.750987264
Filtered down to 2782 of 2815
(Round 1) Retained 2782 rows out of 2815 after filtering
2024-03-11 22:38:28.013702 MEMORY 12.753154048
(Round 1) Computing density adapted affmat
2024-03-11 22:38:29.189522 MEMORY 12.779548672
Symmetrizing nearest neighbors
Computing betas for density adaptation
Computing normalizing denominators
(Round 1) Computing clustering
2024-03-11 22:38:49.541804 MEMORY 12.706770944
Beginning preprocessing + Leiden
2024-03-11 22:38:49.545398 MEMORY 12.706770944
Affmat transformed
2024-03-11 22:38:49.545515 MEMORY 12.706770944
sources, targets, weights extracted
2024-03-11 22:38:49.691345 MEMORY 12.706791424
About to launch parallel Leiden runs
2024-03-11 22:38:49.774134 MEMORY 12.706791424
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    7.1s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   24.8s finished
Parallel Leiden runs finished
2024-03-11 22:39:14.575758 MEMORY 12.70808576
Quality: 0.40241383472188796
Got 3 clusters after round 1
Counts:
{0: 1154, 1: 1005, 2: 623}
2024-03-11 22:39:14.589207 MEMORY 12.70808576
(Round 1) Aggregating seqlets in each cluster
2024-03-11 22:39:14.589299 MEMORY 12.70808576
Aggregating for cluster 0 with 1154 seqlets
2024-03-11 22:39:14.592124 MEMORY 12.70808576
Skipped 1 seqlets that went over sequence edge during flank expansion
Skipped 1 due to duplicates
Trimming eliminated 0 seqlets out of 1152
Aggregating for cluster 1 with 1005 seqlets
2024-03-11 22:39:17.071354 MEMORY 12.708155392
Trimming eliminated 0 seqlets out of 1005
Aggregating for cluster 2 with 623 seqlets
2024-03-11 22:39:19.141241 MEMORY 12.708159488
Trimming eliminated 0 seqlets out of 623
(Round 2) num seqlets: 2780
(Round 2) Computing coarse affmat
2024-03-11 22:39:21.230088 MEMORY 12.708163584
Beginning embedding computation
MEMORY 12.708163584
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done 2400 tasks      | elapsed:    2.6s
[Parallel(n_jobs=24)]: Done 2780 out of 2780 | elapsed:    3.2s finished
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 368 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done 1368 tasks      | elapsed:    2.1s
[Parallel(n_jobs=24)]: Done 2733 out of 2780 | elapsed:    4.0s remaining:    0.1s
[Parallel(n_jobs=24)]: Done 2780 out of 2780 | elapsed:    4.1s finished
At the beginning of embedding call
2024-03-11 22:39:21.230304 MEMORY 12.708163584
before computing embeddings fwd
2024-03-11 22:39:21.238696 MEMORY 12.708163584
after computing embeddings fwd
2024-03-11 22:39:24.393966 MEMORY 12.802916352
after computing embeddings rev
2024-03-11 22:39:28.446697 MEMORY 12.916228096
before computing sparse embeddings fwd
2024-03-11 22:39:28.446786 MEMORY 12.916228096
Constructing csr matrix...
csr matrix made in 0.3064875602722168 s
after computing sparse embeddings fwd
2024-03-11 22:39:28.876246 MEMORY 12.91630592
before computing sparse embeddings rev
2024-03-11 22:39:28.876315 MEMORY 12.91630592
Constructing csr matrix...
csr matrix made in 0.3054165840148926 s
after computing sparse embeddings rev
2024-03-11 22:39:29.293577 MEMORY 12.91630592
Finished embedding computation in 9.04 s
MEMORY 12.813283328
Starting affinity matrix computations
MEMORY 12.813283328
Batching in slices of size 2780
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:02<00:00,  2.32s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:02<00:00,  2.32s/it]
Finished affinity matrix computations in 2.33 s
MEMORY 12.813283328
(Round 2) Computed coarse affmat
2024-03-11 22:39:33.339400 MEMORY 12.81304576
(Round 2) Computing affinity matrix on nearest neighbors
2024-03-11 22:39:33.339526 MEMORY 12.81304576
Launching nearest neighbors affmat calculation job
MEMORY 12.81304576
Parallel runs completed
MEMORY 12.821512192
Job completed in: 4.82 s
MEMORY 12.821516288
Launching nearest neighbors affmat calculation job
MEMORY 12.821245952
Parallel runs completed
MEMORY 12.84184064
Job completed in: 4.44 s
MEMORY 12.841832448
(Round 2) Computed affinity matrix on nearest neighbors in 10.37 s
2024-03-11 22:39:43.710746 MEMORY 12.841791488
Not applying filtering for rounds above first round
2024-03-11 22:39:43.711144 MEMORY 12.841791488
(Round 2) Computing density adapted affmat
2024-03-11 22:39:44.923102 MEMORY 12.852330496
Symmetrizing nearest neighbors
Computing betas for density adaptation
Computing normalizing denominators
(Round 2) Computing clustering
2024-03-11 22:40:04.601210 MEMORY 12.799188992
Beginning preprocessing + Leiden
2024-03-11 22:40:04.604912 MEMORY 12.799188992
Affmat transformed
2024-03-11 22:40:04.605025 MEMORY 12.799188992
sources, targets, weights extracted
2024-03-11 22:40:04.685127 MEMORY 12.799188992
About to launch parallel Leiden runs
2024-03-11 22:40:04.721341 MEMORY 12.799188992
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    6.4s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   19.0s finished
Parallel Leiden runs finished
2024-03-11 22:40:23.759185 MEMORY 12.799418368
Quality: 0.46786936117666045
Got 3 clusters after round 2
Counts:
{0: 1031, 2: 788, 1: 961}
2024-03-11 22:40:23.770484 MEMORY 12.799418368
(Round 2) Aggregating seqlets in each cluster
2024-03-11 22:40:23.770577 MEMORY 12.799418368
Aggregating for cluster 0 with 1031 seqlets
2024-03-11 22:40:23.771454 MEMORY 12.799418368
Trimming eliminated 0 seqlets out of 1031
Aggregating for cluster 1 with 961 seqlets
2024-03-11 22:40:25.432396 MEMORY 12.79942656
Trimming eliminated 0 seqlets out of 961
Aggregating for cluster 2 with 788 seqlets
2024-03-11 22:40:26.814988 MEMORY 12.79942656
Trimming eliminated 0 seqlets out of 788
Got 3 clusters
Splitting into subclusters...
2024-03-11 22:40:28.069646 MEMORY 12.79942656
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 930 tasks      | elapsed:    0.4s
[Parallel(n_jobs=24)]: Done 1031 out of 1031 | elapsed:    0.5s finished
Inspecting pattern 0 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 1031
[t-SNE] Computed conditional probabilities for sample 1031 / 1031
[t-SNE] Mean sigma: 0.320215
Beginning preprocessing + Leiden
2024-03-11 22:40:29.628729 MEMORY 12.800364544
Affmat transformed
2024-03-11 22:40:29.641546 MEMORY 12.800364544
sources, targets, weights extracted
2024-03-11 22:40:29.649397 MEMORY 12.800364544
About to launch parallel Leiden runs
2024-03-11 22:40:29.657028 MEMORY 12.80043008
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    2.9s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    8.2s finished
Parallel Leiden runs finished
2024-03-11 22:40:37.811738 MEMORY 12.80043008
Quality: 0.4789862287389588
Quality: 0.4798113460871339
Quality: 0.4798249192558749
Quality: 0.4798568630272586
Quality: 0.47987096706531596
Quality: 0.4802460944337493
Got subclusters: Counter({0: 184, 1: 174, 2: 163, 3: 145, 4: 127, 5: 119, 6: 86, 7: 33})
On merging iteration 1
Numbers for each pattern pre-subsample: [184, 174, 163, 145, 127, 119, 86, 33]
Numbers after subsampling: [184, 174, 163, 145, 127, 119, 86, 33]
Computing sims for pattern 0
Computed sims for pattern 0 in 1.2463183403015137 s
Computing sims for pattern 1
Computed sims for pattern 1 in 1.1287786960601807 s
Computing sims for pattern 2
Computed sims for pattern 2 in 1.1013703346252441 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.9030249118804932 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.8792276382446289 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.7803630828857422 s
Computing sims for pattern 6
Computed sims for pattern 6 in 0.6108665466308594 s
Computing sims for pattern 7
Computed sims for pattern 7 in 0.2749168872833252 s
Cluster sizes
[184 174 163 145 127 119  86  33]
Cross-contamination matrix:
[[1.   0.65 0.36 0.17 0.67 0.55 0.43 0.12]
 [0.31 1.   0.48 0.36 0.53 0.74 0.55 0.43]
 [0.21 0.64 1.   0.56 0.7  0.68 0.7  0.49]
 [0.24 0.8  0.89 1.   0.88 0.84 0.74 0.74]
 [0.45 0.69 0.7  0.56 1.   0.72 0.66 0.32]
 [0.28 0.79 0.56 0.43 0.6  1.   0.68 0.44]
 [0.22 0.64 0.62 0.37 0.58 0.73 1.   0.46]
 [0.12 0.68 0.61 0.53 0.4  0.65 0.64 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.69 0.63 0.56 0.81 0.67 0.68 0.54]
 [0.69 1.   0.85 0.79 0.83 0.88 0.81 0.83]
 [0.63 0.85 1.   0.93 0.92 0.87 0.87 0.86]
 [0.56 0.79 0.93 1.   0.86 0.82 0.8  0.87]
 [0.81 0.83 0.92 0.86 1.   0.87 0.87 0.73]
 [0.67 0.88 0.87 0.82 0.87 1.   0.87 0.8 ]
 [0.68 0.81 0.87 0.8  0.87 0.87 1.   0.79]
 [0.54 0.83 0.86 0.87 0.73 0.8  0.79 1.  ]]
Collapsing 2 & 3 with crosscontam 0.5583323663768986 and sim 0.9304101263931295
Collapsing 2 & 4 with crosscontam 0.6953320844146926 and sim 0.9226461553604473
Collapsing 1 & 5 with crosscontam 0.7402440450077645 and sim 0.8803910828758269
Collapsing 2 & 6 with crosscontam 0.6201838847233501 and sim 0.8741858310968488
Collapsing 2 & 5 with crosscontam 0.5604365883196758 and sim 0.8739731237745854
Collapsing 4 & 5 with crosscontam 0.5986122863716503 and sim 0.8717464740416607
Collapsing 5 & 6 with crosscontam 0.6831121877299358 and sim 0.8705084423583016
Collapsing 4 & 6 with crosscontam 0.5783879872311544 and sim 0.8693550884967879
Collapsing 3 & 7 with crosscontam 0.5335375220812668 and sim 0.8691210419774316
Aborting collapse as 4 & 7 have cross-contam 0.3598627577566369 and sim 0.730986348723142
Collapsing 3 & 4 with crosscontam 0.5643785871334979 and sim 0.8608260835390795
Removed 1 duplicate seqlets
Trimming eliminated 0 seqlets out of 307
Trimming eliminated 0 seqlets out of 434
Trimming eliminated 0 seqlets out of 293
Trimming eliminated 0 seqlets out of 520
Trimming eliminated 0 seqlets out of 813
Unmerged patterns remapping: OrderedDict([(0, 1), (7, 2)])
Time spent on merging iteration: 3.2274670600891113
On merging iteration 2
Numbers for each pattern pre-subsample: [813, 184, 33]
Numbers after subsampling: [300, 184, 33]
Computing sims for pattern 0
Computed sims for pattern 0 in 0.5163242816925049 s
Computing sims for pattern 1
Computed sims for pattern 1 in 1.1595404148101807 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.05560159683227539 s
Cluster sizes
[813 184  33]
Cross-contamination matrix:
[[1.   0.55 0.77]
 [0.47 1.   0.12]
 [0.57 0.12 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.7  0.88]
 [0.7  1.   0.54]
 [0.88 0.54 1.  ]]
Collapsing 0 & 2 with crosscontam 0.5696773056552671 and sim 0.8768461306724532
Trimming eliminated 0 seqlets out of 846
Unmerged patterns remapping: OrderedDict([(1, 1)])
Time spent on merging iteration: 1.0248711109161377
On merging iteration 3
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 961 out of 961 | elapsed:    0.5s finished
Numbers for each pattern pre-subsample: [846, 184]
Numbers after subsampling: [300, 184]
Computing sims for pattern 0
Computed sims for pattern 0 in 0.28430795669555664 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.21958327293395996 s
Cluster sizes
[846 184]
Cross-contamination matrix:
[[1.   0.56]
 [0.46 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.69]
 [0.69 1.  ]]
Inspecting pattern 1 for spurious merging
[t-SNE] Computed conditional probabilities for sample 961 / 961
[t-SNE] Mean sigma: 0.330141
Beginning preprocessing + Leiden
2024-03-11 22:40:52.648428 MEMORY 12.800647168
Affmat transformed
2024-03-11 22:40:52.659833 MEMORY 12.800647168
sources, targets, weights extracted
2024-03-11 22:40:52.666879 MEMORY 12.800647168
About to launch parallel Leiden runs
2024-03-11 22:40:52.708058 MEMORY 12.800647168
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    2.4s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    7.9s finished
Parallel Leiden runs finished
2024-03-11 22:41:00.647907 MEMORY 12.800647168
Quality: 0.47894483233084967
Quality: 0.479404825101254
Quality: 0.47943355760517437
Quality: 0.4795932308519444
Got subclusters: Counter({0: 202, 1: 176, 2: 173, 3: 167, 4: 129, 5: 112, 6: 2})
On merging iteration 1
Numbers for each pattern pre-subsample: [202, 176, 173, 167, 129, 112, 2]
Numbers after subsampling: [202, 176, 173, 167, 129, 112, 2]
Computing sims for pattern 0
Computed sims for pattern 0 in 1.2559096813201904 s
Computing sims for pattern 1
Computed sims for pattern 1 in 1.0720984935760498 s
Computing sims for pattern 2
Computed sims for pattern 2 in 1.0108768939971924 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.9696834087371826 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.804154634475708 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.7157402038574219 s
Computing sims for pattern 6
Computed sims for pattern 6 in 0.08951425552368164 s
Cluster sizes
[202 176 173 167 129 112   2]
Cross-contamination matrix:
[[1.   0.58 0.54 0.5  0.68 0.55 0.02]
 [0.63 1.   0.65 0.33 0.66 0.54 0.02]
 [0.57 0.68 1.   0.63 0.7  0.76 0.02]
 [0.71 0.4  0.72 1.   0.6  0.67 0.06]
 [0.67 0.6  0.57 0.4  1.   0.47 0.01]
 [0.66 0.52 0.74 0.52 0.58 1.   0.03]
 [0.   0.   0.   0.   0.   0.   1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.79 0.84 0.85 0.82 0.81 0.22]
 [0.79 1.   0.82 0.63 0.78 0.73 0.19]
 [0.84 0.82 1.   0.89 0.83 0.91 0.2 ]
 [0.85 0.63 0.89 1.   0.81 0.86 0.26]
 [0.82 0.78 0.83 0.81 1.   0.81 0.24]
 [0.81 0.73 0.91 0.86 0.81 1.   0.28]
 [0.22 0.19 0.2  0.26 0.24 0.28 1.  ]]
Collapsing 2 & 5 with crosscontam 0.7413260730980049 and sim 0.9149272792898804
Collapsing 2 & 3 with crosscontam 0.632838601574544 and sim 0.8873066984204556
Collapsing 3 & 5 with crosscontam 0.5166833277231979 and sim 0.8601466003746516
Collapsing 0 & 3 with crosscontam 0.5023915748079131 and sim 0.8526148080567542
Trimming eliminated 0 seqlets out of 285
Trimming eliminated 0 seqlets out of 452
Trimming eliminated 0 seqlets out of 654
Unmerged patterns remapping: OrderedDict([(1, 1), (4, 2), (6, 3)])
Time spent on merging iteration: 2.063333749771118
On merging iteration 2
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 788 out of 788 | elapsed:    0.2s finished
Numbers for each pattern pre-subsample: [654, 176, 129, 2]
Numbers after subsampling: [300, 176, 129, 2]
Computing sims for pattern 0
Computed sims for pattern 0 in 0.8070287704467773 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.21761393547058105 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.16572880744934082 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.026328325271606445 s
Cluster sizes
[654 176 129   2]
Cross-contamination matrix:
[[1.   0.91 0.85 0.11]
 [0.59 1.   0.66 0.02]
 [0.47 0.6  1.   0.01]
 [0.   0.   0.   1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.84 0.85 0.25]
 [0.84 1.   0.78 0.19]
 [0.85 0.78 1.   0.24]
 [0.25 0.19 0.24 1.  ]]
Inspecting pattern 2 for spurious merging
[t-SNE] Computed conditional probabilities for sample 788 / 788
[t-SNE] Mean sigma: 0.318094
Beginning preprocessing + Leiden
2024-03-11 22:41:11.107425 MEMORY 12.800647168
Affmat transformed
2024-03-11 22:41:11.116906 MEMORY 12.800647168
sources, targets, weights extracted
2024-03-11 22:41:11.122801 MEMORY 12.800647168
About to launch parallel Leiden runs
2024-03-11 22:41:11.153082 MEMORY 12.800647168
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    2.1s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    6.6s finished
Parallel Leiden runs finished
2024-03-11 22:41:17.793236 MEMORY 12.800647168
Quality: 0.4499247275844659
Quality: 0.4501168667596767
Quality: 0.4506919343238039
Quality: 0.4507059210694065
Quality: 0.45103364691857417
Quality: 0.45111999071186865
Got subclusters: Counter({0: 222, 1: 194, 2: 160, 3: 96, 4: 67, 5: 45, 6: 4})
On merging iteration 1
Numbers for each pattern pre-subsample: [222, 194, 160, 96, 67, 45, 4]
Numbers after subsampling: [222, 194, 160, 96, 67, 45, 4]
Computing sims for pattern 0
Computed sims for pattern 0 in 1.303117036819458 s
Computing sims for pattern 1
Computed sims for pattern 1 in 1.0782337188720703 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.8302304744720459 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.46151065826416016 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.3956773281097412 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.283144474029541 s
Computing sims for pattern 6
Computed sims for pattern 6 in 0.0841987133026123 s
Cluster sizes
[222 194 160  96  67  45   4]
Cross-contamination matrix:
[[1.   0.5  0.34 0.67 0.71 0.62 0.68]
 [0.86 1.   0.52 0.82 0.78 0.99 0.96]
 [0.49 0.32 1.   0.66 0.45 0.37 0.76]
 [0.81 0.58 0.64 1.   0.68 0.69 0.82]
 [0.74 0.45 0.33 0.59 1.   0.44 0.57]
 [0.7  0.65 0.32 0.63 0.52 1.   0.56]
 [0.05 0.03 0.01 0.04 0.01 0.01 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.89 0.68 0.92 0.93 0.9  0.8 ]
 [0.89 1.   0.71 0.92 0.83 0.9  0.79]
 [0.68 0.71 1.   0.86 0.63 0.68 0.8 ]
 [0.92 0.92 0.86 1.   0.86 0.85 0.84]
 [0.93 0.83 0.63 0.86 1.   0.83 0.71]
 [0.9  0.9  0.68 0.85 0.83 1.   0.73]
 [0.8  0.79 0.8  0.84 0.71 0.73 1.  ]]
Collapsing 0 & 4 with crosscontam 0.7137681165351433 and sim 0.9276705893140735
Collapsing 1 & 3 with crosscontam 0.5788584006747568 and sim 0.9214026968955349
Collapsing 0 & 3 with crosscontam 0.6714242814460432 and sim 0.917347497289515
Collapsing 1 & 5 with crosscontam 0.6514303169148528 and sim 0.9036865614964613
Collapsing 0 & 5 with crosscontam 0.6192086738146312 and sim 0.9021127259362163
Collapsing 0 & 1 with crosscontam 0.5005445020148356 and sim 0.8896130812181073
Collapsing 2 & 3 with crosscontam 0.6382640979908132 and sim 0.8629165799868117
Aborting collapse as 2 & 4 have cross-contam 0.3914377112076203 and sim 0.6337636659102087
Collapsing 3 & 4 with crosscontam 0.5877922705474632 and sim 0.8554020152461685
Trimming eliminated 0 seqlets out of 289
Trimming eliminated 0 seqlets out of 290
Trimming eliminated 0 seqlets out of 579
Trimming eliminated 0 seqlets out of 624
Unmerged patterns remapping: OrderedDict([(2, 1), (6, 2)])
Time spent on merging iteration: 1.9203763008117676
On merging iteration 2
Numbers for each pattern pre-subsample: [624, 160, 4]
Numbers after subsampling: [300, 160, 4]
Computing sims for pattern 0
Computed sims for pattern 0 in 0.5305311679840088 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.18815088272094727 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.028561115264892578 s
Cluster sizes
[624 160   4]
Cross-contamination matrix:
[[1.   0.64 1.  ]
 [0.44 1.   0.76]
 [0.03 0.01 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.74 0.82]
 [0.74 1.   0.8 ]
 [0.82 0.8  1.  ]]
Merging on 9 clusters
2024-03-11 22:41:25.014792 MEMORY 12.800647168
On merging iteration 1
Numbers for each pattern pre-subsample: [846, 184, 654, 176, 129, 2, 624, 160, 4]
Numbers after subsampling: [300, 184, 300, 176, 129, 2, 300, 160, 4]
Computing sims for pattern 0
Computed sims for pattern 0 in 2.3528802394866943 s
Computing sims for pattern 1
Computed sims for pattern 1 in 1.578350305557251 s
Computing sims for pattern 2
Computed sims for pattern 2 in 2.4136545658111572 s
Computing sims for pattern 3
Computed sims for pattern 3 in 1.4690678119659424 s
Computing sims for pattern 4
Computed sims for pattern 4 in 1.1386477947235107 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.1389322280883789 s
Computing sims for pattern 6
Computed sims for pattern 6 in 2.3629448413848877 s
Computing sims for pattern 7
Computed sims for pattern 7 in 1.313689947128296 s
Computing sims for pattern 8
Computed sims for pattern 8 in 0.14814209938049316 s
Cluster sizes
[846 184 654 176 129   2 624 160   4]
Cross-contamination matrix:
[[1.   0.56 0.22 0.18 0.18 0.05 0.42 0.91 0.63]
 [0.46 1.   0.16 0.09 0.08 0.01 0.17 0.22 0.13]
 [0.26 0.26 1.   0.91 0.85 0.11 0.22 0.18 0.13]
 [0.06 0.06 0.59 1.   0.66 0.02 0.15 0.05 0.07]
 [0.06 0.05 0.47 0.6  1.   0.01 0.04 0.04 0.02]
 [0.   0.   0.   0.   0.   1.   0.   0.   0.  ]
 [0.39 0.24 0.18 0.3  0.11 0.04 1.   0.64 1.  ]
 [0.67 0.17 0.07 0.07 0.05 0.01 0.44 1.   0.76]
 [0.   0.   0.   0.   0.   0.   0.03 0.01 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.69 0.47 0.37 0.47 0.24 0.65 0.93 0.73]
 [0.69 1.   0.45 0.37 0.38 0.23 0.51 0.54 0.45]
 [0.47 0.45 1.   0.84 0.85 0.25 0.37 0.35 0.29]
 [0.37 0.37 0.84 1.   0.78 0.19 0.52 0.33 0.38]
 [0.47 0.38 0.85 0.78 1.   0.24 0.35 0.4  0.28]
 [0.24 0.23 0.25 0.19 0.24 1.   0.21 0.23 0.2 ]
 [0.65 0.51 0.37 0.52 0.35 0.21 1.   0.74 0.82]
 [0.93 0.54 0.35 0.33 0.4  0.23 0.74 1.   0.8 ]
 [0.73 0.45 0.29 0.38 0.28 0.2  0.82 0.8  1.  ]]
Collapsing 0 & 7 with crosscontam 0.6713738964843752 and sim 0.9284742281999288
Trimming eliminated 0 seqlets out of 1006
Unmerged patterns remapping: OrderedDict([(1, 3), (2, 1), (3, 4), (4, 5), (5, 7), (6, 2), (8, 6)])
Time spent on merging iteration: 1.102755069732666
On merging iteration 2
Numbers for each pattern pre-subsample: [1006, 654, 624, 184, 176, 129, 4, 2]
Numbers after subsampling: [300, 300, 300, 184, 176, 129, 4, 2]
Computing sims for pattern 0
Computed sims for pattern 0 in 2.030757427215576 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.34188222885131836 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.3373079299926758 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.23311519622802734 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.21236324310302734 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.16475534439086914 s
Computing sims for pattern 6
Computed sims for pattern 6 in 0.02776813507080078 s
Computing sims for pattern 7
Computed sims for pattern 7 in 0.026180505752563477 s
Cluster sizes
[1006  654  624  184  176  129    4    2]
Cross-contamination matrix:
[[1.   0.21 0.47 0.53 0.17 0.18 0.75 0.05]
 [0.25 1.   0.22 0.26 0.91 0.85 0.13 0.11]
 [0.42 0.18 1.   0.24 0.3  0.11 1.   0.04]
 [0.41 0.16 0.17 1.   0.09 0.08 0.13 0.01]
 [0.06 0.59 0.15 0.06 1.   0.66 0.07 0.02]
 [0.06 0.47 0.04 0.05 0.6  1.   0.02 0.01]
 [0.   0.   0.03 0.   0.   0.   1.   0.  ]
 [0.   0.   0.   0.   0.   0.   0.   1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.45 0.68 0.68 0.38 0.47 0.76 0.23]
 [0.45 1.   0.37 0.45 0.84 0.85 0.29 0.25]
 [0.68 0.37 1.   0.51 0.52 0.35 0.82 0.21]
 [0.68 0.45 0.51 1.   0.37 0.38 0.45 0.23]
 [0.38 0.84 0.52 0.37 1.   0.78 0.38 0.19]
 [0.47 0.85 0.35 0.38 0.78 1.   0.28 0.24]
 [0.76 0.29 0.82 0.45 0.38 0.28 1.   0.2 ]
 [0.23 0.25 0.21 0.23 0.19 0.24 0.2  1.  ]]
Got 8 patterns after merging
2024-03-11 22:41:43.631196 MEMORY 12.800647168
Performing filtering
2024-03-11 22:41:43.631375 MEMORY 12.800647168
Got 6 patterns after filtering
2024-03-11 22:41:43.996052 MEMORY 12.800647168
Total time taken is 296.15s
2024-03-11 22:41:43.996183 MEMORY 12.800647168
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 930 tasks      | elapsed:    0.5s
[Parallel(n_jobs=24)]: Done 1006 out of 1006 | elapsed:    0.5s finished
/ru-auth/local/home/lzhao/anaconda3/envs/jupyter-ml-clone/lib/python3.9/site-packages/sklearn/manifold/_t_sne.py:691: FutureWarning: 'square_distances' has been introduced in 0.24 to help phase out legacy squaring behavior. The 'legacy' setting will be removed in 1.1 (renaming of 0.26), and the default setting will be changed to True. In 1.3, 'square_distances' will be removed altogether, and distances will be squared by default. Set 'square_distances'=True to silence this warning.
  warnings.warn(
/ru-auth/local/home/lzhao/anaconda3/envs/jupyter-ml-clone/lib/python3.9/site-packages/sklearn/neighbors/_base.py:175: EfficiencyWarning: Precomputed sparse input was not sorted by data.
  warnings.warn('Precomputed sparse input was not sorted by data.',
Applying subclustering to the final motifs
On pattern 0
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 1006 samples in 0.028s...
[t-SNE] Computed neighbors for 1006 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 1000 / 1006
[t-SNE] Computed conditional probabilities for sample 1006 / 1006
[t-SNE] Mean sigma: 0.313185
[t-SNE] Computed conditional probabilities in 0.068s
[t-SNE] Iteration 50: error = 66.6243439, gradient norm = 0.3109529 (50 iterations in 8.190s)
[t-SNE] Iteration 100: error = 67.2791519, gradient norm = 0.2803778 (50 iterations in 1.760s)
[t-SNE] Iteration 150: error = 67.7325211, gradient norm = 0.2868878 (50 iterations in 2.045s)
[t-SNE] Iteration 200: error = 67.7086411, gradient norm = 0.2927057 (50 iterations in 2.042s)
[t-SNE] Iteration 250: error = 68.0929031, gradient norm = 0.2837585 (50 iterations in 2.042s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 68.092903
[t-SNE] Iteration 300: error = 1.7707790, gradient norm = 0.0023136 (50 iterations in 2.038s)
[t-SNE] Iteration 350: error = 1.7045189, gradient norm = 0.0006998 (50 iterations in 2.042s)
[t-SNE] Iteration 400: error = 1.6798785, gradient norm = 0.0003939 (50 iterations in 2.050s)
[t-SNE] Iteration 450: error = 1.6686488, gradient norm = 0.0001813 (50 iterations in 2.049s)
[t-SNE] Iteration 500: error = 1.6627078, gradient norm = 0.0001884 (50 iterations in 2.041s)
[t-SNE] Iteration 550: error = 1.6595201, gradient norm = 0.0001170 (50 iterations in 2.033s)
[t-SNE] Iteration 600: error = 1.6549097, gradient norm = 0.0001815 (50 iterations in 2.037s)
[t-SNE] Iteration 650: error = 1.6519114, gradient norm = 0.0002100 (50 iterations in 1.803s)
[t-SNE] Iteration 700: error = 1.6487691, gradient norm = 0.0001232 (50 iterations in 1.591s)
[t-SNE] Iteration 750: error = 1.6467563, gradient norm = 0.0001396 (50 iterations in 2.037s)
[t-SNE] Iteration 800: error = 1.6439587, gradient norm = 0.0001593 (50 iterations in 2.038s)
[t-SNE] Iteration 850: error = 1.6435345, gradient norm = 0.0000973 (50 iterations in 2.032s)
[t-SNE] Iteration 900: error = 1.6426733, gradient norm = 0.0001078 (50 iterations in 2.035s)
[t-SNE] Iteration 950: error = 1.6422163, gradient norm = 0.0000672 (50 iterations in 2.043s)
[t-SNE] Iteration 1000: error = 1.6416043, gradient norm = 0.0001264 (50 iterations in 2.041s)
[t-SNE] KL divergence after 1000 iterations: 1.641604
[t-SNE] Computed conditional probabilities for sample 1000 / 1006
[t-SNE] Computed conditional probabilities for sample 1006 / 1006
[t-SNE] Mean sigma: 0.313184
Beginning preprocessing + Leiden
2024-03-11 22:42:31.666957 MEMORY 12.821594112
Affmat transformed
2024-03-11 22:42:31.678822 MEMORY 12.821594112
sources, targets, weights extracted
2024-03-11 22:42:31.686250 MEMORY 12.821594112
About to launch parallel Leiden runs
2024-03-11 22:42:31.732872 MEMORY 12.821594112
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    2.6s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    9.8s finished
Parallel Leiden runs finished
2024-03-11 22:42:41.498926 MEMORY 12.821594112
Quality: 0.45294533451663677
Quality: 0.457045769406209
Quality: 0.4571193512570669
Quality: 0.45724079219882713
Quality: 0.457440858612088
Quality: 0.4575642943757609
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 654 out of 654 | elapsed:    0.2s finished
Got subclusters: Counter({0: 250, 1: 181, 2: 155, 3: 152, 4: 118, 5: 80, 6: 70})
On pattern 1
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 654 samples in 0.004s...
[t-SNE] Computed neighbors for 654 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 654 / 654
[t-SNE] Mean sigma: 0.338107
[t-SNE] Computed conditional probabilities in 0.044s
[t-SNE] Iteration 50: error = 67.5003815, gradient norm = 0.4226903 (50 iterations in 1.555s)
[t-SNE] Iteration 100: error = 66.9611511, gradient norm = 0.4103592 (50 iterations in 1.608s)
[t-SNE] Iteration 150: error = 67.7734146, gradient norm = 0.4086347 (50 iterations in 1.554s)
[t-SNE] Iteration 200: error = 68.7891464, gradient norm = 0.4040852 (50 iterations in 2.043s)
[t-SNE] Iteration 250: error = 69.1712418, gradient norm = 0.4048528 (50 iterations in 2.043s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 69.171242
[t-SNE] Iteration 300: error = 1.6115892, gradient norm = 0.0029725 (50 iterations in 2.029s)
[t-SNE] Iteration 350: error = 1.5025843, gradient norm = 0.0011507 (50 iterations in 2.033s)
[t-SNE] Iteration 400: error = 1.4633025, gradient norm = 0.0007899 (50 iterations in 1.520s)
[t-SNE] Iteration 450: error = 1.4459662, gradient norm = 0.0007667 (50 iterations in 2.027s)
[t-SNE] Iteration 500: error = 1.4341227, gradient norm = 0.0003802 (50 iterations in 2.032s)
[t-SNE] Iteration 550: error = 1.4290199, gradient norm = 0.0001736 (50 iterations in 2.040s)
[t-SNE] Iteration 600: error = 1.4263378, gradient norm = 0.0002769 (50 iterations in 2.030s)
[t-SNE] Iteration 650: error = 1.4235126, gradient norm = 0.0002696 (50 iterations in 2.029s)
[t-SNE] Iteration 700: error = 1.4215750, gradient norm = 0.0001088 (50 iterations in 2.031s)
[t-SNE] Iteration 750: error = 1.4196399, gradient norm = 0.0005814 (50 iterations in 2.044s)
[t-SNE] Iteration 800: error = 1.4189339, gradient norm = 0.0000874 (50 iterations in 2.034s)
[t-SNE] Iteration 850: error = 1.4175799, gradient norm = 0.0001143 (50 iterations in 2.044s)
[t-SNE] Iteration 900: error = 1.4150884, gradient norm = 0.0001724 (50 iterations in 1.851s)
[t-SNE] Iteration 950: error = 1.4147066, gradient norm = 0.0000733 (50 iterations in 1.710s)
[t-SNE] Iteration 1000: error = 1.4137453, gradient norm = 0.0000953 (50 iterations in 2.040s)
[t-SNE] KL divergence after 1000 iterations: 1.413745
[t-SNE] Computed conditional probabilities for sample 654 / 654
[t-SNE] Mean sigma: 0.338107
Beginning preprocessing + Leiden
2024-03-11 22:43:20.907327 MEMORY 12.82162688
Affmat transformed
2024-03-11 22:43:20.915467 MEMORY 12.82162688
sources, targets, weights extracted
2024-03-11 22:43:20.920052 MEMORY 12.82162688
About to launch parallel Leiden runs
2024-03-11 22:43:20.925664 MEMORY 12.82162688
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    5.6s finished
Parallel Leiden runs finished
2024-03-11 22:43:26.531616 MEMORY 12.82162688
Quality: 0.4195941637068373
Quality: 0.4201953319449287
Quality: 0.42035740817063516
Quality: 0.42149983181943745
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 624 out of 624 | elapsed:    0.2s finished
Got subclusters: Counter({0: 135, 1: 109, 2: 107, 3: 105, 4: 102, 5: 56, 6: 40})
On pattern 2
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 624 samples in 0.004s...
[t-SNE] Computed neighbors for 624 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 624 / 624
[t-SNE] Mean sigma: 0.316016
[t-SNE] Computed conditional probabilities in 0.043s
[t-SNE] Iteration 50: error = 68.8151321, gradient norm = 0.4016472 (50 iterations in 2.034s)
[t-SNE] Iteration 100: error = 69.2499008, gradient norm = 0.4170778 (50 iterations in 2.040s)
[t-SNE] Iteration 150: error = 69.1859436, gradient norm = 0.4030765 (50 iterations in 2.039s)
[t-SNE] Iteration 200: error = 70.1571350, gradient norm = 0.4006967 (50 iterations in 2.033s)
[t-SNE] Iteration 250: error = 70.2730789, gradient norm = 0.3868009 (50 iterations in 2.035s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 70.273079
[t-SNE] Iteration 300: error = 1.4858478, gradient norm = 0.0034292 (50 iterations in 2.037s)
[t-SNE] Iteration 350: error = 1.4353397, gradient norm = 0.0006841 (50 iterations in 2.038s)
[t-SNE] Iteration 400: error = 1.4255242, gradient norm = 0.0005153 (50 iterations in 2.037s)
[t-SNE] Iteration 450: error = 1.4173025, gradient norm = 0.0003896 (50 iterations in 2.036s)
[t-SNE] Iteration 500: error = 1.4136760, gradient norm = 0.0002086 (50 iterations in 2.033s)
[t-SNE] Iteration 550: error = 1.4065430, gradient norm = 0.0008273 (50 iterations in 2.028s)
[t-SNE] Iteration 600: error = 1.3972905, gradient norm = 0.0004053 (50 iterations in 1.537s)
[t-SNE] Iteration 650: error = 1.3952073, gradient norm = 0.0002654 (50 iterations in 2.028s)
[t-SNE] Iteration 700: error = 1.3923723, gradient norm = 0.0001962 (50 iterations in 1.558s)
[t-SNE] Iteration 750: error = 1.3913168, gradient norm = 0.0000938 (50 iterations in 2.037s)
[t-SNE] Iteration 800: error = 1.3910897, gradient norm = 0.0000347 (50 iterations in 2.039s)
[t-SNE] Iteration 850: error = 1.3908869, gradient norm = 0.0000409 (50 iterations in 2.036s)
[t-SNE] Iteration 900: error = 1.3907745, gradient norm = 0.0000393 (50 iterations in 2.037s)
[t-SNE] Iteration 950: error = 1.3906991, gradient norm = 0.0001756 (50 iterations in 1.514s)
[t-SNE] Iteration 1000: error = 1.3902787, gradient norm = 0.0001104 (50 iterations in 1.528s)
[t-SNE] KL divergence after 1000 iterations: 1.390279
[t-SNE] Computed conditional probabilities for sample 624 / 624
[t-SNE] Mean sigma: 0.316016
Beginning preprocessing + Leiden
2024-03-11 22:44:06.200707 MEMORY 12.82162688
Affmat transformed
2024-03-11 22:44:06.208421 MEMORY 12.82162688
sources, targets, weights extracted
2024-03-11 22:44:06.213135 MEMORY 12.82162688
About to launch parallel Leiden runs
2024-03-11 22:44:06.245336 MEMORY 12.82162688
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.9s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    5.9s finished
Parallel Leiden runs finished
2024-03-11 22:44:12.187714 MEMORY 12.82162688
Quality: 0.39566489609717453
Quality: 0.39579357059977055
Quality: 0.3966205628553784
Quality: 0.3987709084444564
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 184 out of 184 | elapsed:    0.1s finished
Got subclusters: Counter({0: 152, 1: 150, 2: 131, 3: 98, 4: 85, 5: 8})
On pattern 3
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 184 samples in 0.002s...
[t-SNE] Computed neighbors for 184 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 184 / 184
[t-SNE] Mean sigma: 0.397963
[t-SNE] Computed conditional probabilities in 0.013s
[t-SNE] Iteration 50: error = 57.1174812, gradient norm = 0.4704798 (50 iterations in 2.023s)
[t-SNE] Iteration 100: error = 57.2608299, gradient norm = 0.5378746 (50 iterations in 2.025s)
[t-SNE] Iteration 150: error = 56.0030670, gradient norm = 0.5737484 (50 iterations in 0.915s)
[t-SNE] Iteration 200: error = 55.8802376, gradient norm = 0.5076839 (50 iterations in 2.027s)
[t-SNE] Iteration 250: error = 56.4109154, gradient norm = 0.5414659 (50 iterations in 2.058s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 56.410915
[t-SNE] Iteration 300: error = 0.7646600, gradient norm = 0.0082326 (50 iterations in 2.024s)
[t-SNE] Iteration 350: error = 0.6938222, gradient norm = 0.0031459 (50 iterations in 2.021s)
[t-SNE] Iteration 400: error = 0.6788039, gradient norm = 0.0011429 (50 iterations in 2.054s)
[t-SNE] Iteration 450: error = 0.6783355, gradient norm = 0.0003535 (50 iterations in 2.023s)
[t-SNE] Iteration 500: error = 0.6781275, gradient norm = 0.0002023 (50 iterations in 2.025s)
[t-SNE] Iteration 550: error = 0.6780530, gradient norm = 0.0003254 (50 iterations in 2.026s)
[t-SNE] Iteration 600: error = 0.6779823, gradient norm = 0.0002420 (50 iterations in 2.022s)
[t-SNE] Iteration 650: error = 0.6779957, gradient norm = 0.0003275 (50 iterations in 2.025s)
[t-SNE] Iteration 700: error = 0.6779436, gradient norm = 0.0002655 (50 iterations in 2.023s)
[t-SNE] Iteration 750: error = 0.6777869, gradient norm = 0.0002923 (50 iterations in 2.023s)
[t-SNE] Iteration 800: error = 0.6776837, gradient norm = 0.0002947 (50 iterations in 2.020s)
[t-SNE] Iteration 850: error = 0.6775584, gradient norm = 0.0002076 (50 iterations in 2.024s)
[t-SNE] Iteration 900: error = 0.6776002, gradient norm = 0.0001599 (50 iterations in 2.023s)
[t-SNE] Iteration 950: error = 0.6749712, gradient norm = 0.0003211 (50 iterations in 0.942s)
[t-SNE] Iteration 1000: error = 0.6748133, gradient norm = 0.0001730 (50 iterations in 0.736s)
[t-SNE] KL divergence after 1000 iterations: 0.674813
[t-SNE] Computed conditional probabilities for sample 184 / 184
[t-SNE] Mean sigma: 0.397963
Beginning preprocessing + Leiden
2024-03-11 22:44:49.589525 MEMORY 12.82162688
Affmat transformed
2024-03-11 22:44:49.592384 MEMORY 12.82162688
sources, targets, weights extracted
2024-03-11 22:44:49.593392 MEMORY 12.82162688
About to launch parallel Leiden runs
2024-03-11 22:44:49.647823 MEMORY 12.82162688
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.8s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.2s finished
Parallel Leiden runs finished
2024-03-11 22:44:51.823702 MEMORY 12.82162688
Quality: 0.33166491056748976
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 176 out of 176 | elapsed:    0.1s finished
Got subclusters: Counter({0: 49, 1: 45, 2: 35, 3: 32, 4: 23})
On pattern 4
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 176 samples in 0.001s...
[t-SNE] Computed neighbors for 176 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 176 / 176
[t-SNE] Mean sigma: 0.381932
[t-SNE] Computed conditional probabilities in 0.011s
[t-SNE] Iteration 50: error = 58.1256142, gradient norm = 0.5312250 (50 iterations in 2.024s)
[t-SNE] Iteration 100: error = 60.1568260, gradient norm = 0.4617930 (50 iterations in 2.028s)
[t-SNE] Iteration 150: error = 58.8460503, gradient norm = 0.5613601 (50 iterations in 2.028s)
[t-SNE] Iteration 200: error = 62.5882149, gradient norm = 0.4319409 (50 iterations in 2.025s)
[t-SNE] Iteration 250: error = 63.0401077, gradient norm = 0.4818498 (50 iterations in 2.025s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 63.040108
[t-SNE] Iteration 300: error = 1.1013703, gradient norm = 0.0081455 (50 iterations in 2.026s)
[t-SNE] Iteration 350: error = 0.7648378, gradient norm = 0.0074739 (50 iterations in 2.026s)
[t-SNE] Iteration 400: error = 0.6748280, gradient norm = 0.0016791 (50 iterations in 2.030s)
[t-SNE] Iteration 450: error = 0.6730000, gradient norm = 0.0005077 (50 iterations in 2.023s)
[t-SNE] Iteration 500: error = 0.6728034, gradient norm = 0.0001537 (50 iterations in 2.024s)
[t-SNE] Iteration 550: error = 0.6726904, gradient norm = 0.0002472 (50 iterations in 2.027s)
[t-SNE] Iteration 600: error = 0.6728871, gradient norm = 0.0001710 (50 iterations in 2.022s)
[t-SNE] Iteration 650: error = 0.6728348, gradient norm = 0.0002000 (50 iterations in 2.023s)
[t-SNE] Iteration 700: error = 0.6729207, gradient norm = 0.0001723 (50 iterations in 2.031s)
[t-SNE] Iteration 750: error = 0.6728507, gradient norm = 0.0001419 (50 iterations in 2.025s)
[t-SNE] Iteration 800: error = 0.6727102, gradient norm = 0.0001569 (50 iterations in 2.018s)
[t-SNE] Iteration 850: error = 0.6729648, gradient norm = 0.0002517 (50 iterations in 2.027s)
[t-SNE] Iteration 900: error = 0.6728664, gradient norm = 0.0002014 (50 iterations in 2.019s)
[t-SNE] Iteration 900: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 900 iterations: 0.672866
[t-SNE] Computed conditional probabilities for sample 176 / 176
[t-SNE] Mean sigma: 0.381933
Beginning preprocessing + Leiden
2024-03-11 22:45:28.564556 MEMORY 12.82162688
Affmat transformed
2024-03-11 22:45:28.567246 MEMORY 12.82162688
sources, targets, weights extracted
2024-03-11 22:45:28.568198 MEMORY 12.82162688
About to launch parallel Leiden runs
2024-03-11 22:45:28.589736 MEMORY 12.82162688
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.8s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.2s finished
Parallel Leiden runs finished
2024-03-11 22:45:30.799541 MEMORY 12.82162688
Quality: 0.2905725036494128
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  82 out of 129 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=24)]: Done 129 out of 129 | elapsed:    0.0s finished
Got subclusters: Counter({0: 38, 1: 37, 2: 36, 3: 33, 4: 25, 5: 7})
On pattern 5
[t-SNE] Computing 128 nearest neighbors...
[t-SNE] Indexed 129 samples in 0.001s...
[t-SNE] Computed neighbors for 129 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 129 / 129
[t-SNE] Mean sigma: 0.411147
[t-SNE] Computed conditional probabilities in 0.007s
[t-SNE] Iteration 50: error = 57.4095726, gradient norm = 0.4901024 (50 iterations in 2.021s)
[t-SNE] Iteration 100: error = 54.9228363, gradient norm = 0.5034819 (50 iterations in 2.027s)
[t-SNE] Iteration 150: error = 54.5322037, gradient norm = 0.5090585 (50 iterations in 2.027s)
[t-SNE] Iteration 200: error = 57.5301132, gradient norm = 0.5025389 (50 iterations in 2.027s)
[t-SNE] Iteration 250: error = 57.9187813, gradient norm = 0.4581215 (50 iterations in 2.027s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 57.918781
[t-SNE] Iteration 300: error = 0.8011351, gradient norm = 0.0101701 (50 iterations in 2.023s)
[t-SNE] Iteration 350: error = 0.5156093, gradient norm = 0.0057444 (50 iterations in 2.023s)
[t-SNE] Iteration 400: error = 0.5050571, gradient norm = 0.0005910 (50 iterations in 2.026s)
[t-SNE] Iteration 450: error = 0.5050802, gradient norm = 0.0003584 (50 iterations in 2.022s)
[t-SNE] Iteration 500: error = 0.5050755, gradient norm = 0.0001970 (50 iterations in 2.023s)
[t-SNE] Iteration 550: error = 0.5051709, gradient norm = 0.0003841 (50 iterations in 2.022s)
[t-SNE] Iteration 600: error = 0.5059801, gradient norm = 0.0003131 (50 iterations in 2.021s)
[t-SNE] Iteration 650: error = 0.5059011, gradient norm = 0.0002276 (50 iterations in 2.024s)
[t-SNE] Iteration 700: error = 0.5057049, gradient norm = 0.0002804 (50 iterations in 2.022s)
[t-SNE] Iteration 750: error = 0.5056757, gradient norm = 0.0003221 (50 iterations in 2.020s)
[t-SNE] Iteration 750: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 750 iterations: 0.505676
[t-SNE] Computed conditional probabilities for sample 129 / 129
[t-SNE] Mean sigma: 0.411147
Beginning preprocessing + Leiden
2024-03-11 22:46:01.356667 MEMORY 12.82162688
Affmat transformed
2024-03-11 22:46:01.359237 MEMORY 12.82162688
sources, targets, weights extracted
2024-03-11 22:46:01.359947 MEMORY 12.82162688
About to launch parallel Leiden runs
2024-03-11 22:46:01.381239 MEMORY 12.82162688
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.9s finished
Parallel Leiden runs finished
2024-03-11 22:46:03.331338 MEMORY 12.82162688
Quality: 0.23597035538652775
Quality: 0.24225343928311752
Quality: 0.24243932801174575
Got subclusters: Counter({0: 36, 1: 31, 2: 28, 3: 21, 4: 13})
On metacluster 4
Metacluster size 2939
Relevant tasks:  ('head',)
Relevant signs:  (1,)
TfModiscoSeqletsToPatternsFactory: seed=1234
(Round 1) num seqlets: 2939
(Round 1) Computing coarse affmat
2024-03-11 22:46:04.741957 MEMORY 12.820578304
Beginning embedding computation
MEMORY 12.820578304
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 152 tasks      | elapsed:    2.0s
[Parallel(n_jobs=24)]: Done 402 tasks      | elapsed:    4.8s
[Parallel(n_jobs=24)]: Done 752 tasks      | elapsed:    8.6s
[Parallel(n_jobs=24)]: Done 1202 tasks      | elapsed:   13.6s
[Parallel(n_jobs=24)]: Done 1752 tasks      | elapsed:   19.7s
[Parallel(n_jobs=24)]: Done 2402 tasks      | elapsed:   26.9s
[Parallel(n_jobs=24)]: Done 2939 out of 2939 | elapsed:   32.8s finished
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 152 tasks      | elapsed:    1.9s
[Parallel(n_jobs=24)]: Done 402 tasks      | elapsed:    4.7s
[Parallel(n_jobs=24)]: Done 752 tasks      | elapsed:    8.5s
[Parallel(n_jobs=24)]: Done 1202 tasks      | elapsed:   13.4s
[Parallel(n_jobs=24)]: Done 1752 tasks      | elapsed:   19.5s
[Parallel(n_jobs=24)]: Done 2402 tasks      | elapsed:   26.5s
[Parallel(n_jobs=24)]: Done 2939 out of 2939 | elapsed:   32.3s finished
At the beginning of embedding call
2024-03-11 22:46:04.742171 MEMORY 12.820578304
before computing embeddings fwd
2024-03-11 22:46:04.750606 MEMORY 12.820578304
after computing embeddings fwd
2024-03-11 22:46:37.505955 MEMORY 12.820578304
after computing embeddings rev
2024-03-11 22:47:09.820310 MEMORY 12.897058816
before computing sparse embeddings fwd
2024-03-11 22:47:09.820395 MEMORY 12.897062912
Constructing csr matrix...
csr matrix made in 0.3532125949859619 s
after computing sparse embeddings fwd
2024-03-11 22:47:10.302815 MEMORY 12.897148928
before computing sparse embeddings rev
2024-03-11 22:47:10.302889 MEMORY 12.897148928
Constructing csr matrix...
csr matrix made in 0.3375973701477051 s
after computing sparse embeddings rev
2024-03-11 22:47:10.756811 MEMORY 12.897148928
Finished embedding computation in 67.01 s
MEMORY 12.838690816
Starting affinity matrix computations
MEMORY 12.838690816
Batching in slices of size 2939
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:02<00:00,  2.08s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:02<00:00,  2.08s/it]
Finished affinity matrix computations in 2.1 s
MEMORY 12.838690816
(Round 1) Computed coarse affmat
2024-03-11 22:47:14.731467 MEMORY 12.838596608
(Round 1) Computing affinity matrix on nearest neighbors
2024-03-11 22:47:14.731595 MEMORY 12.838596608
Launching nearest neighbors affmat calculation job
MEMORY 12.838596608
Parallel runs completed
MEMORY 12.948934656
Job completed in: 9.68 s
MEMORY 12.94432256
Launching nearest neighbors affmat calculation job
MEMORY 12.944248832
Parallel runs completed
MEMORY 12.974931968
Job completed in: 9.33 s
MEMORY 12.973469696
(Round 1) Computed affinity matrix on nearest neighbors in 20.2 s
2024-03-11 22:47:34.929558 MEMORY 12.967354368
Filtered down to 2859 of 2939
(Round 1) Retained 2859 rows out of 2939 after filtering
2024-03-11 22:47:36.415383 MEMORY 12.967354368
(Round 1) Computing density adapted affmat
2024-03-11 22:47:37.674492 MEMORY 12.967354368
Symmetrizing nearest neighbors
Computing betas for density adaptation
Computing normalizing denominators
(Round 1) Computing clustering
2024-03-11 22:47:58.318195 MEMORY 12.91327488
Beginning preprocessing + Leiden
2024-03-11 22:47:58.321868 MEMORY 12.91327488
Affmat transformed
2024-03-11 22:47:58.321998 MEMORY 12.91327488
sources, targets, weights extracted
2024-03-11 22:47:58.402791 MEMORY 12.91327488
About to launch parallel Leiden runs
2024-03-11 22:47:58.456040 MEMORY 12.91327488
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    7.1s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   31.3s finished
Parallel Leiden runs finished
2024-03-11 22:48:29.752957 MEMORY 12.91327488
Quality: 0.2760983924473224
Quality: 0.276101228192026
Quality: 0.27610584358105267
Got 4 clusters after round 1
Counts:
{0: 957, 2: 642, 1: 668, 3: 592}
2024-03-11 22:48:29.764719 MEMORY 12.91327488
(Round 1) Aggregating seqlets in each cluster
2024-03-11 22:48:29.764810 MEMORY 12.91327488
Aggregating for cluster 0 with 957 seqlets
2024-03-11 22:48:29.765971 MEMORY 12.91327488
Trimming eliminated 0 seqlets out of 957
Aggregating for cluster 1 with 668 seqlets
2024-03-11 22:48:31.846904 MEMORY 12.91321344
Trimming eliminated 0 seqlets out of 668
Aggregating for cluster 2 with 642 seqlets
2024-03-11 22:48:33.168426 MEMORY 12.91321344
Skipped 2 due to duplicates
Trimming eliminated 0 seqlets out of 640
Aggregating for cluster 3 with 592 seqlets
2024-03-11 22:48:34.468888 MEMORY 12.91321344
Trimming eliminated 0 seqlets out of 592
(Round 2) num seqlets: 2857
(Round 2) Computing coarse affmat
2024-03-11 22:48:36.642508 MEMORY 12.912951296
Beginning embedding computation
MEMORY 12.912951296
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 320 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done 2754 tasks      | elapsed:    2.8s
[Parallel(n_jobs=24)]: Done 2857 out of 2857 | elapsed:    3.1s finished
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 368 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done 1368 tasks      | elapsed:    2.1s
[Parallel(n_jobs=24)]: Done 2857 out of 2857 | elapsed:    4.2s finished
At the beginning of embedding call
2024-03-11 22:48:36.642700 MEMORY 12.912951296
before computing embeddings fwd
2024-03-11 22:48:36.651038 MEMORY 12.912951296
after computing embeddings fwd
2024-03-11 22:48:39.751601 MEMORY 12.946907136
after computing embeddings rev
2024-03-11 22:48:43.949472 MEMORY 13.06353664
before computing sparse embeddings fwd
2024-03-11 22:48:43.949559 MEMORY 13.06353664
Constructing csr matrix...
csr matrix made in 0.3310739994049072 s
after computing sparse embeddings fwd
2024-03-11 22:48:44.389991 MEMORY 13.063622656
before computing sparse embeddings rev
2024-03-11 22:48:44.390066 MEMORY 13.063622656
Constructing csr matrix...
csr matrix made in 0.3106410503387451 s
after computing sparse embeddings rev
2024-03-11 22:48:44.794611 MEMORY 13.063622656
Finished embedding computation in 9.21 s
MEMORY 12.960075776
Starting affinity matrix computations
MEMORY 12.960075776
Batching in slices of size 2857
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:02<00:00,  2.26s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:02<00:00,  2.26s/it]
Finished affinity matrix computations in 2.27 s
MEMORY 12.960075776
(Round 2) Computed coarse affmat
2024-03-11 22:48:48.944638 MEMORY 12.960026624
(Round 2) Computing affinity matrix on nearest neighbors
2024-03-11 22:48:48.944760 MEMORY 12.960026624
Launching nearest neighbors affmat calculation job
MEMORY 12.960026624
Parallel runs completed
MEMORY 12.987998208
Job completed in: 4.53 s
MEMORY 12.985667584
Launching nearest neighbors affmat calculation job
MEMORY 12.985618432
Parallel runs completed
MEMORY 13.01243904
Job completed in: 4.53 s
MEMORY 13.010264064
(Round 2) Computed affinity matrix on nearest neighbors in 10.23 s
2024-03-11 22:48:59.171629 MEMORY 13.008044032
Not applying filtering for rounds above first round
2024-03-11 22:48:59.172067 MEMORY 13.008044032
(Round 2) Computing density adapted affmat
2024-03-11 22:49:00.452267 MEMORY 13.016506368
Symmetrizing nearest neighbors
Computing betas for density adaptation
Computing normalizing denominators
(Round 2) Computing clustering
2024-03-11 22:49:21.081315 MEMORY 12.978536448
Beginning preprocessing + Leiden
2024-03-11 22:49:21.085221 MEMORY 12.978536448
Affmat transformed
2024-03-11 22:49:21.085351 MEMORY 12.978536448
sources, targets, weights extracted
2024-03-11 22:49:21.167996 MEMORY 12.978536448
About to launch parallel Leiden runs
2024-03-11 22:49:21.193237 MEMORY 12.978536448
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    6.9s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   20.4s finished
Parallel Leiden runs finished
2024-03-11 22:49:41.604662 MEMORY 12.979785728
Quality: 0.3990538261120118
Got 4 clusters after round 2
Counts:
{0: 964, 1: 674, 3: 601, 2: 618}
2024-03-11 22:49:41.616574 MEMORY 12.979785728
(Round 2) Aggregating seqlets in each cluster
2024-03-11 22:49:41.616667 MEMORY 12.979785728
Aggregating for cluster 0 with 964 seqlets
2024-03-11 22:49:41.617680 MEMORY 12.979785728
Trimming eliminated 0 seqlets out of 964
Aggregating for cluster 1 with 674 seqlets
2024-03-11 22:49:43.217597 MEMORY 12.957446144
Skipped 1 due to duplicates
Trimming eliminated 0 seqlets out of 673
Aggregating for cluster 2 with 618 seqlets
2024-03-11 22:49:44.131215 MEMORY 12.957446144
Trimming eliminated 0 seqlets out of 618
Aggregating for cluster 3 with 601 seqlets
2024-03-11 22:49:45.042097 MEMORY 12.957446144
Trimming eliminated 0 seqlets out of 601
Got 4 clusters
Splitting into subclusters...
2024-03-11 22:49:45.932890 MEMORY 12.957446144
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 964 out of 964 | elapsed:    0.4s finished
Inspecting pattern 0 for spurious merging
[t-SNE] Computed conditional probabilities for sample 964 / 964
[t-SNE] Mean sigma: 0.325958
Beginning preprocessing + Leiden
2024-03-11 22:49:47.330085 MEMORY 12.957446144
Affmat transformed
2024-03-11 22:49:47.341306 MEMORY 12.957446144
sources, targets, weights extracted
2024-03-11 22:49:47.349511 MEMORY 12.957446144
About to launch parallel Leiden runs
2024-03-11 22:49:47.401253 MEMORY 12.957446144
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    2.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    9.1s finished
Parallel Leiden runs finished
2024-03-11 22:49:56.510966 MEMORY 12.957446144
Quality: 0.37147410447680485
Quality: 0.37214003738519025
Quality: 0.37305582950158855
Quality: 0.3734978064551079
Quality: 0.37439528013811885
Quality: 0.374524880686439
Quality: 0.37485358918042005
Got subclusters: Counter({0: 162, 1: 122, 2: 120, 3: 118, 4: 91, 5: 87, 6: 75, 7: 72, 8: 59, 9: 58})
On merging iteration 1
Numbers for each pattern pre-subsample: [162, 122, 120, 118, 91, 87, 75, 72, 59, 58]
Numbers after subsampling: [162, 122, 120, 118, 91, 87, 75, 72, 59, 58]
Computing sims for pattern 0
Computed sims for pattern 0 in 1.030968189239502 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.8304531574249268 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.8152914047241211 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.8049232959747314 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.7064735889434814 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.674231767654419 s
Computing sims for pattern 6
Computed sims for pattern 6 in 0.5829582214355469 s
Computing sims for pattern 7
Computed sims for pattern 7 in 0.5575203895568848 s
Computing sims for pattern 8
Computed sims for pattern 8 in 0.4702334403991699 s
Computing sims for pattern 9
Computed sims for pattern 9 in 0.4585692882537842 s
Cluster sizes
[162 122 120 118  91  87  75  72  59  58]
Cross-contamination matrix:
[[1.   0.28 0.49 0.79 0.65 0.53 0.48 0.73 0.53 0.55]
 [0.81 1.   0.73 0.85 0.78 0.65 0.77 0.93 0.74 0.77]
 [0.96 0.58 1.   0.93 0.82 0.69 0.63 0.9  0.72 0.78]
 [0.82 0.28 0.45 1.   0.65 0.45 0.5  0.69 0.48 0.49]
 [0.8  0.34 0.5  0.8  1.   0.44 0.46 0.73 0.49 0.66]
 [0.9  0.48 0.64 0.84 0.69 1.   0.68 0.78 0.65 0.59]
 [0.81 0.5  0.51 0.84 0.65 0.61 1.   0.72 0.46 0.67]
 [0.81 0.43 0.52 0.76 0.67 0.5  0.49 1.   0.5  0.61]
 [0.98 0.59 0.71 0.91 0.79 0.69 0.57 0.83 1.   0.67]
 [0.79 0.41 0.55 0.72 0.76 0.43 0.57 0.76 0.46 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.84 0.91 0.93 0.86 0.85 0.83 0.91 0.92 0.84]
 [0.84 1.   0.84 0.85 0.78 0.8  0.85 0.91 0.87 0.84]
 [0.91 0.84 1.   0.89 0.82 0.81 0.77 0.9  0.9  0.86]
 [0.93 0.85 0.89 1.   0.89 0.81 0.83 0.9  0.9  0.82]
 [0.86 0.78 0.82 0.89 1.   0.74 0.77 0.85 0.83 0.85]
 [0.85 0.8  0.81 0.81 0.74 1.   0.74 0.82 0.81 0.75]
 [0.83 0.85 0.77 0.83 0.77 0.74 1.   0.83 0.75 0.81]
 [0.91 0.91 0.9  0.9  0.85 0.82 0.83 1.   0.91 0.87]
 [0.92 0.87 0.9  0.9  0.83 0.81 0.75 0.91 1.   0.82]
 [0.84 0.84 0.86 0.82 0.85 0.75 0.81 0.87 0.82 1.  ]]
Collapsing 0 & 3 with crosscontam 0.7932745631568587 and sim 0.9308603520359642
Collapsing 0 & 8 with crosscontam 0.5293920408723083 and sim 0.9203718188498502
Collapsing 0 & 7 with crosscontam 0.7280371642592707 and sim 0.9116652682803257
Collapsing 0 & 2 with crosscontam 0.4873274110704042 and sim 0.9115642638777718
Collapsing 1 & 7 with crosscontam 0.4250230849018417 and sim 0.909273563614452
Collapsing 7 & 8 with crosscontam 0.49997057438794723 and sim 0.9081128596734102
Collapsing 3 & 7 with crosscontam 0.6868082572003738 and sim 0.904948253983241
Collapsing 2 & 8 with crosscontam 0.7089528789863293 and sim 0.8991542032014938
Collapsing 2 & 7 with crosscontam 0.522362879372428 and sim 0.8976902009306955
Collapsing 3 & 4 with crosscontam 0.6530565388919944 and sim 0.8873546582985756
Collapsing 7 & 9 with crosscontam 0.6057113547135897 and sim 0.8673015565307782
Collapsing 1 & 8 with crosscontam 0.5902969152831323 and sim 0.8664754529975676
Collapsing 2 & 9 with crosscontam 0.5481251793841486 and sim 0.8634714062154917
Collapsing 0 & 4 with crosscontam 0.6491098812391298 and sim 0.8592882399254345
Collapsing 1 & 6 with crosscontam 0.5023417122040073 and sim 0.854872581835318
Collapsing 0 & 5 with crosscontam 0.5290730470464309 and sim 0.8528614734444895
Trimming eliminated 0 seqlets out of 280
Trimming eliminated 0 seqlets out of 339
Trimming eliminated 0 seqlets out of 411
Trimming eliminated 0 seqlets out of 531
Trimming eliminated 0 seqlets out of 653
Trimming eliminated 0 seqlets out of 744
Trimming eliminated 0 seqlets out of 802
Trimming eliminated 0 seqlets out of 877
Trimming eliminated 0 seqlets out of 964
Unmerged patterns remapping: OrderedDict()
Time spent on merging iteration: 6.814629554748535
On merging iteration 2
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 673 out of 673 | elapsed:    0.2s finished
Numbers for each pattern pre-subsample: [964]
Numbers after subsampling: [300]
Computing sims for pattern 0
Computed sims for pattern 0 in 4.0531158447265625e-06 s
Cluster sizes
[964]
Cross-contamination matrix:
[[1.]]
Pattern-to-pattern sim matrix:
[[1.]]
Inspecting pattern 1 for spurious merging
[t-SNE] Computed conditional probabilities for sample 673 / 673
[t-SNE] Mean sigma: 0.345593
Beginning preprocessing + Leiden
2024-03-11 22:50:10.950937 MEMORY 12.957446144
Affmat transformed
2024-03-11 22:50:10.959098 MEMORY 12.957446144
sources, targets, weights extracted
2024-03-11 22:50:10.964660 MEMORY 12.957446144
About to launch parallel Leiden runs
2024-03-11 22:50:10.976890 MEMORY 12.957446144
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    5.5s finished
Parallel Leiden runs finished
2024-03-11 22:50:16.458475 MEMORY 12.957446144
Quality: 0.3741119172017925
Quality: 0.3743849941596323
Quality: 0.37451467130469696
Quality: 0.3753517539136923
Got subclusters: Counter({0: 174, 1: 123, 2: 98, 3: 87, 4: 78, 5: 76, 6: 37})
On merging iteration 1
Numbers for each pattern pre-subsample: [174, 123, 98, 87, 78, 76, 37]
Numbers after subsampling: [174, 123, 98, 87, 78, 76, 37]
Computing sims for pattern 0
Computed sims for pattern 0 in 0.9012634754180908 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.6785101890563965 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.4429290294647217 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.4804823398590088 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.42914772033691406 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.4276719093322754 s
Computing sims for pattern 6
Computed sims for pattern 6 in 0.22606587409973145 s
Cluster sizes
[174 123  98  87  78  76  37]
Cross-contamination matrix:
[[1.   0.59 0.45 0.92 0.63 0.63 0.69]
 [0.84 1.   0.57 0.96 0.65 0.38 0.73]
 [0.75 0.67 1.   0.99 0.54 0.46 0.72]
 [0.72 0.49 0.45 1.   0.52 0.5  0.51]
 [0.74 0.54 0.34 0.85 1.   0.7  0.77]
 [0.64 0.19 0.21 0.72 0.59 1.   0.58]
 [0.6  0.39 0.32 0.64 0.55 0.49 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.82 0.68 0.92 0.73 0.74 0.76]
 [0.82 1.   0.74 0.84 0.72 0.6  0.77]
 [0.68 0.74 1.   0.83 0.7  0.68 0.71]
 [0.92 0.84 0.83 1.   0.79 0.77 0.8 ]
 [0.73 0.72 0.7  0.79 1.   0.75 0.83]
 [0.74 0.6  0.68 0.77 0.75 1.   0.68]
 [0.76 0.77 0.71 0.8  0.83 0.68 1.  ]]
Collapsing 0 & 3 with crosscontam 0.7187752799317839 and sim 0.9193812630783045
Trimming eliminated 0 seqlets out of 261
Unmerged patterns remapping: OrderedDict([(1, 1), (2, 2), (4, 3), (5, 4), (6, 5)])
Time spent on merging iteration: 0.5101370811462402
On merging iteration 2
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 618 out of 618 | elapsed:    0.2s finished
Numbers for each pattern pre-subsample: [261, 123, 98, 78, 76, 37]
Numbers after subsampling: [261, 123, 98, 78, 76, 37]
Computing sims for pattern 0
Computed sims for pattern 0 in 1.0028350353240967 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.1541585922241211 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.11340737342834473 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.10314321517944336 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.09995555877685547 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.05822134017944336 s
Cluster sizes
[261 123  98  78  76  37]
Cross-contamination matrix:
[[1.   0.63 0.52 0.66 0.68 0.7 ]
 [0.87 1.   0.57 0.65 0.38 0.73]
 [0.82 0.67 1.   0.54 0.46 0.72]
 [0.75 0.54 0.34 1.   0.7  0.77]
 [0.67 0.19 0.21 0.59 1.   0.58]
 [0.59 0.39 0.32 0.55 0.49 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.83 0.73 0.74 0.76 0.76]
 [0.83 1.   0.74 0.72 0.6  0.77]
 [0.73 0.74 1.   0.7  0.68 0.71]
 [0.74 0.72 0.7  1.   0.75 0.83]
 [0.76 0.6  0.68 0.75 1.   0.68]
 [0.76 0.77 0.71 0.83 0.68 1.  ]]
Inspecting pattern 2 for spurious merging
[t-SNE] Computed conditional probabilities for sample 618 / 618
[t-SNE] Mean sigma: 0.373627
Beginning preprocessing + Leiden
2024-03-11 22:50:22.885822 MEMORY 12.958134272
Affmat transformed
2024-03-11 22:50:22.893311 MEMORY 12.958134272
sources, targets, weights extracted
2024-03-11 22:50:22.897331 MEMORY 12.958134272
About to launch parallel Leiden runs
2024-03-11 22:50:22.929186 MEMORY 12.958134272
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.6s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    5.0s finished
Parallel Leiden runs finished
2024-03-11 22:50:27.923258 MEMORY 12.958134272
Quality: 0.4178929219002085
Quality: 0.42069074745411034
Quality: 0.42120447877289907
Quality: 0.42135456903397517
Quality: 0.4214713253024187
Got subclusters: Counter({0: 165, 1: 162, 2: 154, 3: 107, 4: 25, 5: 3, 6: 2})
On merging iteration 1
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 601 out of 601 | elapsed:    0.2s finished
Numbers for each pattern pre-subsample: [165, 162, 154, 107, 25, 3, 2]
Numbers after subsampling: [165, 162, 154, 107, 25, 3, 2]
Computing sims for pattern 0
Computed sims for pattern 0 in 0.8559167385101318 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.857947826385498 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.7998285293579102 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.5856916904449463 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.17538046836853027 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.06965184211730957 s
Computing sims for pattern 6
Computed sims for pattern 6 in 0.06527090072631836 s
Cluster sizes
[165 162 154 107  25   3   2]
Cross-contamination matrix:
[[1.   0.55 0.61 0.58 0.5  0.58 0.17]
 [0.52 1.   0.59 0.44 0.44 0.54 0.25]
 [0.62 0.63 1.   0.48 0.49 0.66 0.26]
 [0.85 0.72 0.72 1.   0.65 0.65 0.21]
 [0.47 0.6  0.61 0.54 1.   0.38 0.47]
 [0.   0.   0.   0.   0.   1.   0.  ]
 [0.   0.   0.   0.   0.   0.   1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.68 0.78 0.83 0.65 0.63 0.34]
 [0.68 1.   0.67 0.68 0.63 0.59 0.41]
 [0.78 0.67 1.   0.77 0.62 0.65 0.5 ]
 [0.83 0.68 0.77 1.   0.68 0.6  0.38]
 [0.65 0.63 0.62 0.68 1.   0.48 0.32]
 [0.63 0.59 0.65 0.6  0.48 1.   0.38]
 [0.34 0.41 0.5  0.38 0.32 0.38 1.  ]]
Inspecting pattern 3 for spurious merging
[t-SNE] Computed conditional probabilities for sample 601 / 601
[t-SNE] Mean sigma: 0.402073
Beginning preprocessing + Leiden
2024-03-11 22:50:32.313409 MEMORY 12.958134272
Affmat transformed
2024-03-11 22:50:32.320847 MEMORY 12.958134272
sources, targets, weights extracted
2024-03-11 22:50:32.324733 MEMORY 12.958134272
About to launch parallel Leiden runs
2024-03-11 22:50:32.346955 MEMORY 12.958134272
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.6s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    4.8s finished
Parallel Leiden runs finished
2024-03-11 22:50:37.158923 MEMORY 12.958134272
Quality: 0.39927554957029365
Quality: 0.3996903137354361
Quality: 0.3999037763806196
Quality: 0.400059782898698
Quality: 0.40087887078981566
Got subclusters: Counter({0: 144, 1: 103, 2: 94, 3: 84, 4: 72, 5: 55, 6: 49})
On merging iteration 1
Numbers for each pattern pre-subsample: [144, 103, 94, 84, 72, 55, 49]
Numbers after subsampling: [144, 103, 94, 84, 72, 55, 49]
Computing sims for pattern 0
Computed sims for pattern 0 in 0.6894950866699219 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.5329780578613281 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.5114538669586182 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.4587235450744629 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.3974630832672119 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.3111560344696045 s
Computing sims for pattern 6
Computed sims for pattern 6 in 0.2770364284515381 s
Cluster sizes
[144 103  94  84  72  55  49]
Cross-contamination matrix:
[[1.   0.52 0.43 0.49 0.54 0.69 0.69]
 [0.38 1.   0.52 0.84 0.65 0.42 0.75]
 [0.59 0.76 1.   0.97 0.63 0.44 0.63]
 [0.26 0.57 0.46 1.   0.41 0.36 0.53]
 [0.61 0.83 0.57 0.82 1.   0.58 0.63]
 [0.64 0.44 0.26 0.58 0.44 1.   0.62]
 [0.51 0.6  0.29 0.61 0.37 0.48 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.5  0.63 0.57 0.72 0.69 0.59]
 [0.5  1.   0.66 0.8  0.75 0.52 0.64]
 [0.63 0.66 1.   0.81 0.53 0.39 0.56]
 [0.57 0.8  0.81 1.   0.69 0.51 0.77]
 [0.72 0.75 0.53 0.69 1.   0.52 0.54]
 [0.69 0.52 0.39 0.51 0.52 1.   0.51]
 [0.59 0.64 0.56 0.77 0.54 0.51 1.  ]]
Merging on 21 clusters
2024-03-11 22:50:40.494017 MEMORY 12.958302208
On merging iteration 1
Numbers for each pattern pre-subsample: [964, 261, 123, 98, 78, 76, 37, 165, 162, 154, 107, 25, 3, 2, 144, 103, 94, 84, 72, 55, 49]
Numbers after subsampling: [300, 261, 123, 98, 78, 76, 37, 165, 162, 154, 107, 25, 3, 2, 144, 103, 94, 84, 72, 55, 49]
Computing sims for pattern 0
Computed sims for pattern 0 in 5.279627323150635 s
Computing sims for pattern 1
Computed sims for pattern 1 in 4.2239768505096436 s
Computing sims for pattern 2
Computed sims for pattern 2 in 2.363252878189087 s
Computing sims for pattern 3
Computed sims for pattern 3 in 1.561955213546753 s
Computing sims for pattern 4
Computed sims for pattern 4 in 1.4985129833221436 s
Computing sims for pattern 5
Computed sims for pattern 5 in 1.4384076595306396 s
Computing sims for pattern 6
Computed sims for pattern 6 in 1.7749311923980713 s
Computing sims for pattern 7
Computed sims for pattern 7 in 2.9150922298431396 s
Computing sims for pattern 8
Computed sims for pattern 8 in 2.8966386318206787 s
Computing sims for pattern 9
Computed sims for pattern 9 in 2.7074878215789795 s
Computing sims for pattern 10
Computed sims for pattern 10 in 1.9489610195159912 s
Computing sims for pattern 11
Computed sims for pattern 11 in 0.5764713287353516 s
Computing sims for pattern 12
Computed sims for pattern 12 in 0.24080133438110352 s
Computing sims for pattern 13
Computed sims for pattern 13 in 0.22655606269836426 s
Computing sims for pattern 14
Computed sims for pattern 14 in 2.403280019760132 s
Computing sims for pattern 15
Computed sims for pattern 15 in 1.914750576019287 s
Computing sims for pattern 16
Computed sims for pattern 16 in 1.7969231605529785 s
Computing sims for pattern 17
Computed sims for pattern 17 in 1.6135098934173584 s
Computing sims for pattern 18
Computed sims for pattern 18 in 1.3909344673156738 s
Computing sims for pattern 19
Computed sims for pattern 19 in 1.082230567932129 s
Computing sims for pattern 20
Computed sims for pattern 20 in 0.9630756378173828 s
Cluster sizes
[964 261 123  98  78  76  37 165 162 154 107  25   3   2 144 103  94  84
  72  55  49]
Cross-contamination matrix:
[[1.   0.2  0.36 0.16 0.19 0.32 0.17 0.33 0.38 0.26 0.52 0.29 0.14 0.13
  0.17 0.29 0.33 0.34 0.36 0.21 0.24]
 [0.1  1.   0.63 0.52 0.66 0.68 0.7  0.12 0.12 0.15 0.14 0.1  0.04 0.27
  0.21 0.17 0.18 0.3  0.17 0.36 0.4 ]
 [0.27 0.87 1.   0.57 0.65 0.38 0.73 0.24 0.16 0.3  0.18 0.21 0.06 0.28
  0.17 0.21 0.25 0.38 0.23 0.29 0.36]
 [0.17 0.82 0.67 1.   0.54 0.46 0.72 0.25 0.18 0.6  0.13 0.19 0.09 0.26
  0.31 0.25 0.29 0.38 0.29 0.67 0.41]
 [0.12 0.75 0.54 0.34 1.   0.7  0.77 0.1  0.24 0.35 0.11 0.12 0.1  0.26
  0.4  0.13 0.22 0.21 0.23 0.27 0.4 ]
 [0.12 0.67 0.19 0.21 0.59 1.   0.58 0.08 0.12 0.19 0.07 0.11 0.04 0.21
  0.15 0.25 0.21 0.48 0.22 0.15 0.29]
 [0.08 0.59 0.39 0.32 0.55 0.49 1.   0.01 0.05 0.09 0.01 0.03 0.01 0.16
  0.17 0.14 0.11 0.21 0.09 0.19 0.44]
 [0.25 0.17 0.25 0.18 0.13 0.09 0.05 1.   0.55 0.61 0.58 0.5  0.58 0.17
  0.13 0.16 0.2  0.11 0.16 0.25 0.12]
 [0.28 0.14 0.15 0.12 0.28 0.2  0.19 0.52 1.   0.59 0.44 0.44 0.54 0.25
  0.13 0.25 0.41 0.23 0.17 0.12 0.11]
 [0.22 0.25 0.32 0.49 0.46 0.26 0.28 0.62 0.63 1.   0.48 0.49 0.66 0.26
  0.5  0.19 0.24 0.2  0.16 0.26 0.24]
 [0.66 0.33 0.35 0.18 0.28 0.25 0.14 0.85 0.72 0.72 1.   0.65 0.65 0.21
  0.26 0.18 0.32 0.24 0.24 0.21 0.25]
 [0.3  0.2  0.32 0.24 0.21 0.21 0.13 0.47 0.6  0.61 0.54 1.   0.38 0.47
  0.2  0.14 0.27 0.26 0.12 0.19 0.15]
 [0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   1.   0.
  0.   0.   0.   0.   0.   0.   0.  ]
 [0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   1.
  0.   0.   0.02 0.   0.   0.   0.01]
 [0.27 0.55 0.35 0.44 0.8  0.52 0.69 0.28 0.3  0.75 0.28 0.27 0.53 0.4
  1.   0.52 0.43 0.49 0.54 0.69 0.69]
 [0.38 0.47 0.38 0.33 0.3  0.7  0.65 0.31 0.39 0.31 0.18 0.18 0.18 0.26
  0.38 1.   0.52 0.84 0.65 0.42 0.75]
 [0.64 0.67 0.66 0.57 0.69 0.83 0.76 0.58 0.91 0.6  0.51 0.54 0.43 0.92
  0.59 0.76 1.   0.97 0.63 0.44 0.63]
 [0.25 0.45 0.37 0.29 0.26 0.74 0.39 0.12 0.24 0.19 0.12 0.17 0.1  0.35
  0.26 0.57 0.46 1.   0.41 0.36 0.53]
 [0.62 0.57 0.57 0.55 0.64 0.74 0.58 0.44 0.46 0.37 0.37 0.27 0.24 0.38
  0.61 0.83 0.57 0.82 1.   0.58 0.63]
 [0.3  0.81 0.49 0.85 0.48 0.3  0.76 0.43 0.25 0.41 0.21 0.24 0.08 0.18
  0.64 0.44 0.26 0.58 0.44 1.   0.62]
 [0.25 0.68 0.42 0.4  0.61 0.6  0.91 0.13 0.14 0.17 0.15 0.11 0.19 0.48
  0.51 0.6  0.29 0.61 0.37 0.48 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.31 0.55 0.38 0.33 0.55 0.37 0.41 0.51 0.36 0.7  0.53 0.32 0.33
  0.23 0.44 0.58 0.61 0.51 0.23 0.42]
 [0.31 1.   0.83 0.73 0.74 0.76 0.76 0.35 0.32 0.31 0.29 0.28 0.33 0.57
  0.41 0.38 0.46 0.55 0.37 0.63 0.65]
 [0.55 0.83 1.   0.74 0.72 0.6  0.77 0.52 0.37 0.43 0.51 0.45 0.29 0.49
  0.33 0.43 0.53 0.67 0.47 0.51 0.64]
 [0.38 0.73 0.74 1.   0.7  0.68 0.71 0.46 0.33 0.68 0.38 0.32 0.33 0.43
  0.45 0.37 0.55 0.61 0.43 0.83 0.61]
 [0.33 0.74 0.72 0.7  1.   0.75 0.83 0.25 0.46 0.56 0.28 0.29 0.5  0.48
  0.75 0.4  0.46 0.54 0.61 0.53 0.69]
 [0.55 0.76 0.6  0.68 0.75 1.   0.68 0.38 0.55 0.48 0.44 0.47 0.46 0.56
  0.45 0.64 0.73 0.82 0.56 0.5  0.54]
 [0.37 0.76 0.77 0.71 0.83 0.68 1.   0.21 0.33 0.32 0.25 0.23 0.26 0.61
  0.57 0.5  0.47 0.59 0.44 0.59 0.81]
 [0.41 0.35 0.52 0.46 0.25 0.38 0.21 1.   0.68 0.78 0.83 0.65 0.63 0.34
  0.26 0.22 0.47 0.4  0.24 0.45 0.32]
 [0.51 0.32 0.37 0.33 0.46 0.55 0.33 0.68 1.   0.67 0.68 0.63 0.59 0.41
  0.39 0.45 0.77 0.53 0.44 0.34 0.31]
 [0.36 0.31 0.43 0.68 0.56 0.48 0.32 0.78 0.67 1.   0.77 0.62 0.65 0.5
  0.63 0.33 0.54 0.5  0.29 0.32 0.41]
 [0.7  0.29 0.51 0.38 0.28 0.44 0.25 0.83 0.68 0.77 1.   0.68 0.6  0.38
  0.23 0.19 0.5  0.44 0.16 0.25 0.34]
 [0.53 0.28 0.45 0.32 0.29 0.47 0.23 0.65 0.63 0.62 0.68 1.   0.48 0.32
  0.17 0.18 0.43 0.43 0.07 0.23 0.25]
 [0.32 0.33 0.29 0.33 0.5  0.46 0.26 0.63 0.59 0.65 0.6  0.48 1.   0.38
  0.48 0.28 0.43 0.41 0.22 0.18 0.33]
 [0.33 0.57 0.49 0.43 0.48 0.56 0.61 0.34 0.41 0.5  0.38 0.32 0.38 1.
  0.5  0.34 0.6  0.51 0.31 0.29 0.62]
 [0.23 0.41 0.33 0.45 0.75 0.45 0.57 0.26 0.39 0.63 0.23 0.17 0.48 0.5
  1.   0.5  0.63 0.57 0.72 0.69 0.59]
 [0.44 0.38 0.43 0.37 0.4  0.64 0.5  0.22 0.45 0.33 0.19 0.18 0.28 0.34
  0.5  1.   0.66 0.8  0.75 0.52 0.64]
 [0.58 0.46 0.53 0.55 0.46 0.73 0.47 0.47 0.77 0.54 0.5  0.43 0.43 0.6
  0.63 0.66 1.   0.81 0.53 0.39 0.56]
 [0.61 0.55 0.67 0.61 0.54 0.82 0.59 0.4  0.53 0.5  0.44 0.43 0.41 0.51
  0.57 0.8  0.81 1.   0.69 0.51 0.77]
 [0.51 0.37 0.47 0.43 0.61 0.56 0.44 0.24 0.44 0.29 0.16 0.07 0.22 0.31
  0.72 0.75 0.53 0.69 1.   0.52 0.54]
 [0.23 0.63 0.51 0.83 0.53 0.5  0.59 0.45 0.34 0.32 0.25 0.23 0.18 0.29
  0.69 0.52 0.39 0.51 0.52 1.   0.51]
 [0.42 0.65 0.64 0.61 0.69 0.54 0.81 0.32 0.31 0.41 0.34 0.25 0.33 0.62
  0.59 0.64 0.56 0.77 0.54 0.51 1.  ]]
Got 21 patterns after merging
2024-03-11 22:51:21.649609 MEMORY 12.95847424
Performing filtering
2024-03-11 22:51:21.649862 MEMORY 12.95847424
Got 18 patterns after filtering
2024-03-11 22:51:22.031722 MEMORY 12.95847424
Total time taken is 318.17s
2024-03-11 22:51:22.031859 MEMORY 12.95847424
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 964 out of 964 | elapsed:    0.5s finished
/ru-auth/local/home/lzhao/anaconda3/envs/jupyter-ml-clone/lib/python3.9/site-packages/sklearn/manifold/_t_sne.py:691: FutureWarning: 'square_distances' has been introduced in 0.24 to help phase out legacy squaring behavior. The 'legacy' setting will be removed in 1.1 (renaming of 0.26), and the default setting will be changed to True. In 1.3, 'square_distances' will be removed altogether, and distances will be squared by default. Set 'square_distances'=True to silence this warning.
  warnings.warn(
/ru-auth/local/home/lzhao/anaconda3/envs/jupyter-ml-clone/lib/python3.9/site-packages/sklearn/neighbors/_base.py:175: EfficiencyWarning: Precomputed sparse input was not sorted by data.
  warnings.warn('Precomputed sparse input was not sorted by data.',
Applying subclustering to the final motifs
On pattern 0
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 964 samples in 0.006s...
[t-SNE] Computed neighbors for 964 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 964 / 964
[t-SNE] Mean sigma: 0.327380
[t-SNE] Computed conditional probabilities in 0.065s
[t-SNE] Iteration 50: error = 66.7022934, gradient norm = 0.3223577 (50 iterations in 2.049s)
[t-SNE] Iteration 100: error = 67.7754898, gradient norm = 0.2970653 (50 iterations in 2.040s)
[t-SNE] Iteration 150: error = 68.2115707, gradient norm = 0.2932933 (50 iterations in 2.065s)
[t-SNE] Iteration 200: error = 68.9893875, gradient norm = 0.2805597 (50 iterations in 2.049s)
[t-SNE] Iteration 250: error = 67.6239014, gradient norm = 0.3007439 (50 iterations in 2.043s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 67.623901
[t-SNE] Iteration 300: error = 1.8899335, gradient norm = 0.0018688 (50 iterations in 2.051s)
[t-SNE] Iteration 350: error = 1.8312943, gradient norm = 0.0005315 (50 iterations in 2.037s)
[t-SNE] Iteration 400: error = 1.8032185, gradient norm = 0.0004499 (50 iterations in 2.042s)
[t-SNE] Iteration 450: error = 1.7924354, gradient norm = 0.0003245 (50 iterations in 2.034s)
[t-SNE] Iteration 500: error = 1.7858543, gradient norm = 0.0001998 (50 iterations in 2.037s)
[t-SNE] Iteration 550: error = 1.7817438, gradient norm = 0.0001775 (50 iterations in 2.033s)
[t-SNE] Iteration 600: error = 1.7794117, gradient norm = 0.0001735 (50 iterations in 2.047s)
[t-SNE] Iteration 650: error = 1.7774783, gradient norm = 0.0000946 (50 iterations in 2.054s)
[t-SNE] Iteration 700: error = 1.7767006, gradient norm = 0.0000681 (50 iterations in 2.042s)
[t-SNE] Iteration 750: error = 1.7757970, gradient norm = 0.0000777 (50 iterations in 1.639s)
[t-SNE] Iteration 800: error = 1.7752563, gradient norm = 0.0000827 (50 iterations in 2.035s)
[t-SNE] Iteration 850: error = 1.7727616, gradient norm = 0.0002537 (50 iterations in 2.034s)
[t-SNE] Iteration 900: error = 1.7713126, gradient norm = 0.0000839 (50 iterations in 1.656s)
[t-SNE] Iteration 950: error = 1.7698656, gradient norm = 0.0001431 (50 iterations in 1.682s)
[t-SNE] Iteration 1000: error = 1.7694468, gradient norm = 0.0000471 (50 iterations in 1.331s)
[t-SNE] KL divergence after 1000 iterations: 1.769447
[t-SNE] Computed conditional probabilities for sample 964 / 964
[t-SNE] Mean sigma: 0.327380
Beginning preprocessing + Leiden
2024-03-11 22:52:02.587927 MEMORY 12.95847424
Affmat transformed
2024-03-11 22:52:02.599621 MEMORY 12.95847424
sources, targets, weights extracted
2024-03-11 22:52:02.607793 MEMORY 12.95847424
About to launch parallel Leiden runs
2024-03-11 22:52:02.647486 MEMORY 12.95847424
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    2.6s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    9.0s finished
Parallel Leiden runs finished
2024-03-11 22:52:11.670237 MEMORY 12.95847424
Quality: 0.3783597673471364
Quality: 0.3783919027180649
Quality: 0.37891056426623054
Quality: 0.37896365011661803
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 261 out of 261 | elapsed:    0.1s finished
Got subclusters: Counter({0: 145, 1: 124, 2: 116, 3: 115, 4: 91, 5: 87, 6: 82, 7: 74, 8: 67, 9: 63})
On pattern 1
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 261 samples in 0.002s...
[t-SNE] Computed neighbors for 261 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 261 / 261
[t-SNE] Mean sigma: 0.355112
[t-SNE] Computed conditional probabilities in 0.018s
[t-SNE] Iteration 50: error = 66.8856888, gradient norm = 0.4484041 (50 iterations in 2.030s)
[t-SNE] Iteration 100: error = 65.2659988, gradient norm = 0.4565493 (50 iterations in 2.024s)
[t-SNE] Iteration 150: error = 65.6640701, gradient norm = 0.4607975 (50 iterations in 2.029s)
[t-SNE] Iteration 200: error = 61.9985924, gradient norm = 0.5082940 (50 iterations in 2.024s)
[t-SNE] Iteration 250: error = 65.4789124, gradient norm = 0.5095558 (50 iterations in 2.024s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 65.478912
[t-SNE] Iteration 300: error = 1.1560687, gradient norm = 0.0063279 (50 iterations in 2.019s)
[t-SNE] Iteration 350: error = 0.9243553, gradient norm = 0.0041283 (50 iterations in 2.025s)
[t-SNE] Iteration 400: error = 0.9077331, gradient norm = 0.0008254 (50 iterations in 2.030s)
[t-SNE] Iteration 450: error = 0.9060933, gradient norm = 0.0002653 (50 iterations in 2.030s)
[t-SNE] Iteration 500: error = 0.9059280, gradient norm = 0.0001996 (50 iterations in 2.025s)
[t-SNE] Iteration 550: error = 0.9003842, gradient norm = 0.0006014 (50 iterations in 2.022s)
[t-SNE] Iteration 600: error = 0.8988066, gradient norm = 0.0001825 (50 iterations in 2.019s)
[t-SNE] Iteration 650: error = 0.8993105, gradient norm = 0.0001421 (50 iterations in 2.029s)
[t-SNE] Iteration 700: error = 0.8990885, gradient norm = 0.0001962 (50 iterations in 2.028s)
[t-SNE] Iteration 750: error = 0.8990114, gradient norm = 0.0001576 (50 iterations in 2.028s)
[t-SNE] Iteration 800: error = 0.8989375, gradient norm = 0.0001168 (50 iterations in 2.023s)
[t-SNE] Iteration 850: error = 0.8989810, gradient norm = 0.0001086 (50 iterations in 2.023s)
[t-SNE] Iteration 900: error = 0.8990414, gradient norm = 0.0001269 (50 iterations in 2.024s)
[t-SNE] Iteration 950: error = 0.8989638, gradient norm = 0.0000868 (50 iterations in 2.026s)
[t-SNE] Iteration 950: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 950 iterations: 0.898964
[t-SNE] Computed conditional probabilities for sample 261 / 261
[t-SNE] Mean sigma: 0.355112
Beginning preprocessing + Leiden
2024-03-11 22:52:50.641086 MEMORY 12.95847424
Affmat transformed
2024-03-11 22:52:50.645012 MEMORY 12.95847424
sources, targets, weights extracted
2024-03-11 22:52:50.646678 MEMORY 12.95847424
About to launch parallel Leiden runs
2024-03-11 22:52:50.674498 MEMORY 12.95847424
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.9s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.7s finished
Parallel Leiden runs finished
2024-03-11 22:52:53.338853 MEMORY 12.95847424
Quality: 0.288906941839467
Quality: 0.29167597834450265
Quality: 0.29268544723232326
Quality: 0.2930621549353563
Quality: 0.29325081444704326
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 118 out of 165 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=24)]: Done 165 out of 165 | elapsed:    0.1s finished
Got subclusters: Counter({0: 62, 1: 53, 2: 46, 3: 36, 4: 35, 5: 25, 6: 4})
On pattern 2
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 165 samples in 0.002s...
[t-SNE] Computed neighbors for 165 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 165 / 165
[t-SNE] Mean sigma: 0.422369
[t-SNE] Computed conditional probabilities in 0.011s
[t-SNE] Iteration 50: error = 58.7470131, gradient norm = 0.5249900 (50 iterations in 2.019s)
[t-SNE] Iteration 100: error = 56.8453293, gradient norm = 0.4634639 (50 iterations in 2.023s)
[t-SNE] Iteration 150: error = 57.8996658, gradient norm = 0.5100700 (50 iterations in 2.024s)
[t-SNE] Iteration 200: error = 57.1993599, gradient norm = 0.4913339 (50 iterations in 2.024s)
[t-SNE] Iteration 250: error = 58.5693359, gradient norm = 0.5427830 (50 iterations in 2.025s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 58.569336
[t-SNE] Iteration 300: error = 0.9982125, gradient norm = 0.0109906 (50 iterations in 2.028s)
[t-SNE] Iteration 350: error = 0.7283815, gradient norm = 0.0028333 (50 iterations in 2.021s)
[t-SNE] Iteration 400: error = 0.7170841, gradient norm = 0.0010325 (50 iterations in 0.900s)
[t-SNE] Iteration 450: error = 0.6929457, gradient norm = 0.0011266 (50 iterations in 0.788s)
[t-SNE] Iteration 500: error = 0.6710376, gradient norm = 0.0026778 (50 iterations in 0.575s)
[t-SNE] Iteration 550: error = 0.6700345, gradient norm = 0.0003357 (50 iterations in 1.018s)
[t-SNE] Iteration 600: error = 0.6699584, gradient norm = 0.0001970 (50 iterations in 0.707s)
[t-SNE] Iteration 650: error = 0.6698478, gradient norm = 0.0001805 (50 iterations in 0.847s)
[t-SNE] Iteration 700: error = 0.6699551, gradient norm = 0.0001985 (50 iterations in 2.025s)
[t-SNE] Iteration 750: error = 0.6699749, gradient norm = 0.0001436 (50 iterations in 2.029s)
[t-SNE] Iteration 800: error = 0.6699556, gradient norm = 0.0001663 (50 iterations in 2.022s)
[t-SNE] Iteration 850: error = 0.6699358, gradient norm = 0.0001569 (50 iterations in 2.026s)
[t-SNE] Iteration 900: error = 0.6698610, gradient norm = 0.0001422 (50 iterations in 2.026s)
[t-SNE] Iteration 950: error = 0.6698530, gradient norm = 0.0001653 (50 iterations in 2.024s)
[t-SNE] Iteration 1000: error = 0.6699558, gradient norm = 0.0001652 (50 iterations in 2.026s)
[t-SNE] Iteration 1000: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 1000 iterations: 0.669956
[t-SNE] Computed conditional probabilities for sample 165 / 165
[t-SNE] Mean sigma: 0.422369
Beginning preprocessing + Leiden
2024-03-11 22:53:26.801223 MEMORY 12.95847424
Affmat transformed
2024-03-11 22:53:26.803877 MEMORY 12.95847424
sources, targets, weights extracted
2024-03-11 22:53:26.804765 MEMORY 12.95847424
About to launch parallel Leiden runs
2024-03-11 22:53:26.840889 MEMORY 12.95847424
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.8s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.2s finished
Parallel Leiden runs finished
2024-03-11 22:53:28.993702 MEMORY 12.95847424
Quality: 0.27806422206077236
Quality: 0.27877449126156134
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 162 out of 162 | elapsed:    0.1s finished
Got subclusters: Counter({0: 51, 1: 36, 2: 30, 3: 23, 4: 14, 5: 11})
On pattern 3
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 162 samples in 0.001s...
[t-SNE] Computed neighbors for 162 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 162 / 162
[t-SNE] Mean sigma: 0.425981
[t-SNE] Computed conditional probabilities in 0.011s
[t-SNE] Iteration 50: error = 64.7976761, gradient norm = 0.4531341 (50 iterations in 2.021s)
[t-SNE] Iteration 100: error = 60.9437294, gradient norm = 0.4984978 (50 iterations in 1.809s)
[t-SNE] Iteration 150: error = 60.3273888, gradient norm = 0.5062983 (50 iterations in 1.059s)
[t-SNE] Iteration 200: error = 61.0827980, gradient norm = 0.4371649 (50 iterations in 0.832s)
[t-SNE] Iteration 250: error = 57.1635590, gradient norm = 0.4824057 (50 iterations in 0.810s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 57.163559
[t-SNE] Iteration 300: error = 0.7642741, gradient norm = 0.0095790 (50 iterations in 0.875s)
[t-SNE] Iteration 350: error = 0.5823965, gradient norm = 0.0030560 (50 iterations in 2.023s)
[t-SNE] Iteration 400: error = 0.5637511, gradient norm = 0.0006969 (50 iterations in 1.318s)
[t-SNE] Iteration 450: error = 0.5626932, gradient norm = 0.0003055 (50 iterations in 1.578s)
[t-SNE] Iteration 500: error = 0.5624565, gradient norm = 0.0001505 (50 iterations in 2.023s)
[t-SNE] Iteration 550: error = 0.5625149, gradient norm = 0.0001621 (50 iterations in 2.024s)
[t-SNE] Iteration 600: error = 0.5625164, gradient norm = 0.0001533 (50 iterations in 2.019s)
[t-SNE] Iteration 650: error = 0.5625211, gradient norm = 0.0001888 (50 iterations in 2.022s)
[t-SNE] Iteration 700: error = 0.5624419, gradient norm = 0.0001284 (50 iterations in 2.022s)
[t-SNE] Iteration 750: error = 0.5624449, gradient norm = 0.0001607 (50 iterations in 2.027s)
[t-SNE] Iteration 800: error = 0.5623795, gradient norm = 0.0002596 (50 iterations in 2.024s)
[t-SNE] Iteration 850: error = 0.5624920, gradient norm = 0.0002267 (50 iterations in 2.024s)
[t-SNE] Iteration 900: error = 0.5624216, gradient norm = 0.0001795 (50 iterations in 2.023s)
[t-SNE] Iteration 950: error = 0.5625350, gradient norm = 0.0001230 (50 iterations in 2.024s)
[t-SNE] Iteration 1000: error = 0.5624568, gradient norm = 0.0002616 (50 iterations in 2.026s)
[t-SNE] KL divergence after 1000 iterations: 0.562457
[t-SNE] Computed conditional probabilities for sample 162 / 162
[t-SNE] Mean sigma: 0.425981
Beginning preprocessing + Leiden
2024-03-11 22:54:03.837958 MEMORY 12.95847424
Affmat transformed
2024-03-11 22:54:03.840594 MEMORY 12.95847424
sources, targets, weights extracted
2024-03-11 22:54:03.841520 MEMORY 12.95847424
About to launch parallel Leiden runs
2024-03-11 22:54:03.862870 MEMORY 12.95847424
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.8s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.1s finished
Parallel Leiden runs finished
2024-03-11 22:54:06.000277 MEMORY 12.95847424
Quality: 0.26316856872196565
Quality: 0.2639505304083367
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 154 out of 154 | elapsed:    0.0s finished
Got subclusters: Counter({0: 51, 1: 31, 2: 29, 3: 24, 4: 23, 5: 4})
On pattern 4
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 154 samples in 0.001s...
[t-SNE] Computed neighbors for 154 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 154 / 154
[t-SNE] Mean sigma: 0.432668
[t-SNE] Computed conditional probabilities in 0.010s
[t-SNE] Iteration 50: error = 57.9979553, gradient norm = 0.5480531 (50 iterations in 2.019s)
[t-SNE] Iteration 100: error = 62.9173965, gradient norm = 0.5301133 (50 iterations in 2.024s)
[t-SNE] Iteration 150: error = 58.2896423, gradient norm = 0.5347574 (50 iterations in 2.024s)
[t-SNE] Iteration 200: error = 58.8976135, gradient norm = 0.4949852 (50 iterations in 2.022s)
[t-SNE] Iteration 250: error = 56.4551353, gradient norm = 0.4934064 (50 iterations in 2.023s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 56.455135
[t-SNE] Iteration 300: error = 0.7487820, gradient norm = 0.0100409 (50 iterations in 2.024s)
[t-SNE] Iteration 350: error = 0.6025128, gradient norm = 0.0033896 (50 iterations in 0.785s)
[t-SNE] Iteration 400: error = 0.5971194, gradient norm = 0.0002837 (50 iterations in 0.863s)
[t-SNE] Iteration 450: error = 0.5971448, gradient norm = 0.0002315 (50 iterations in 0.570s)
[t-SNE] Iteration 500: error = 0.5970364, gradient norm = 0.0001718 (50 iterations in 1.443s)
[t-SNE] Iteration 550: error = 0.5970719, gradient norm = 0.0001501 (50 iterations in 0.291s)
[t-SNE] Iteration 600: error = 0.5970261, gradient norm = 0.0002082 (50 iterations in 0.578s)
[t-SNE] Iteration 650: error = 0.5970348, gradient norm = 0.0001882 (50 iterations in 1.148s)
[t-SNE] Iteration 700: error = 0.5970263, gradient norm = 0.0001709 (50 iterations in 0.578s)
[t-SNE] Iteration 750: error = 0.5970339, gradient norm = 0.0002201 (50 iterations in 0.609s)
[t-SNE] Iteration 800: error = 0.5970287, gradient norm = 0.0002168 (50 iterations in 2.021s)
[t-SNE] Iteration 850: error = 0.5970215, gradient norm = 0.0002723 (50 iterations in 2.020s)
[t-SNE] Iteration 900: error = 0.5970650, gradient norm = 0.0002717 (50 iterations in 2.026s)
[t-SNE] Iteration 950: error = 0.5970142, gradient norm = 0.0002432 (50 iterations in 2.024s)
[t-SNE] Iteration 1000: error = 0.5970212, gradient norm = 0.0002337 (50 iterations in 2.023s)
[t-SNE] KL divergence after 1000 iterations: 0.597021
[t-SNE] Computed conditional probabilities for sample 154 / 154
[t-SNE] Mean sigma: 0.432668
Beginning preprocessing + Leiden
2024-03-11 22:54:35.362966 MEMORY 12.958523392
Affmat transformed
2024-03-11 22:54:35.365454 MEMORY 12.958523392
sources, targets, weights extracted
2024-03-11 22:54:35.366305 MEMORY 12.958523392
About to launch parallel Leiden runs
2024-03-11 22:54:35.423764 MEMORY 12.958523392
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.8s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.1s finished
Parallel Leiden runs finished
2024-03-11 22:54:37.492842 MEMORY 12.958523392
Quality: 0.24547009185307453
Quality: 0.2488870419775509
Quality: 0.2492899747515761
Quality: 0.24949404569572808
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 144 out of 144 | elapsed:    0.0s finished
Got subclusters: Counter({0: 42, 1: 38, 2: 38, 3: 28, 4: 8})
On pattern 5
[t-SNE] Computing 143 nearest neighbors...
[t-SNE] Indexed 144 samples in 0.001s...
[t-SNE] Computed neighbors for 144 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 144 / 144
[t-SNE] Mean sigma: 0.481232
[t-SNE] Computed conditional probabilities in 0.009s
[t-SNE] Iteration 50: error = 56.3415070, gradient norm = 0.5378159 (50 iterations in 1.876s)
[t-SNE] Iteration 100: error = 54.9220695, gradient norm = 0.5462649 (50 iterations in 0.858s)
[t-SNE] Iteration 150: error = 54.6125107, gradient norm = 0.6055770 (50 iterations in 2.024s)
[t-SNE] Iteration 200: error = 60.3525314, gradient norm = 0.5067258 (50 iterations in 2.025s)
[t-SNE] Iteration 250: error = 54.4527016, gradient norm = 0.6321543 (50 iterations in 2.024s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 54.452702
[t-SNE] Iteration 300: error = 0.9914615, gradient norm = 0.0065064 (50 iterations in 2.024s)
[t-SNE] Iteration 350: error = 0.5916405, gradient norm = 0.0053988 (50 iterations in 2.025s)
[t-SNE] Iteration 400: error = 0.5854748, gradient norm = 0.0003496 (50 iterations in 2.020s)
[t-SNE] Iteration 450: error = 0.5850937, gradient norm = 0.0001769 (50 iterations in 2.024s)
[t-SNE] Iteration 500: error = 0.5852817, gradient norm = 0.0001798 (50 iterations in 2.023s)
[t-SNE] Iteration 550: error = 0.5854241, gradient norm = 0.0002316 (50 iterations in 2.022s)
[t-SNE] Iteration 600: error = 0.5850829, gradient norm = 0.0001743 (50 iterations in 2.020s)
[t-SNE] Iteration 650: error = 0.5851780, gradient norm = 0.0001736 (50 iterations in 2.021s)
[t-SNE] Iteration 700: error = 0.5851457, gradient norm = 0.0001779 (50 iterations in 2.022s)
[t-SNE] Iteration 750: error = 0.5851451, gradient norm = 0.0001608 (50 iterations in 2.022s)
[t-SNE] Iteration 800: error = 0.5850784, gradient norm = 0.0002306 (50 iterations in 2.022s)
[t-SNE] Iteration 850: error = 0.5850554, gradient norm = 0.0001869 (50 iterations in 1.643s)
[t-SNE] Iteration 900: error = 0.5851730, gradient norm = 0.0002072 (50 iterations in 1.049s)
[t-SNE] Iteration 950: error = 0.5850805, gradient norm = 0.0001998 (50 iterations in 1.830s)
[t-SNE] Iteration 1000: error = 0.5850567, gradient norm = 0.0002251 (50 iterations in 0.578s)
[t-SNE] KL divergence after 1000 iterations: 0.585057
[t-SNE] Computed conditional probabilities for sample 144 / 144
[t-SNE] Mean sigma: 0.481232
Beginning preprocessing + Leiden
2024-03-11 22:55:13.863540 MEMORY 12.958765056
Affmat transformed
2024-03-11 22:55:13.865837 MEMORY 12.958765056
sources, targets, weights extracted
2024-03-11 22:55:13.866598 MEMORY 12.958765056
About to launch parallel Leiden runs
2024-03-11 22:55:13.924425 MEMORY 12.958765056
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.1s finished
Parallel Leiden runs finished
2024-03-11 22:55:15.988914 MEMORY 12.958765056
Quality: 0.24800393230576093
Quality: 0.2513489441109713
Quality: 0.251527081950569
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  76 out of 123 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=24)]: Done 123 out of 123 | elapsed:    0.0s finished
Got subclusters: Counter({0: 43, 1: 33, 2: 31, 3: 24, 4: 13})
On pattern 6
[t-SNE] Computing 122 nearest neighbors...
[t-SNE] Indexed 123 samples in 0.001s...
[t-SNE] Computed neighbors for 123 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 123 / 123
[t-SNE] Mean sigma: 0.471589
[t-SNE] Computed conditional probabilities in 0.007s
[t-SNE] Iteration 50: error = 53.5952530, gradient norm = 0.5717106 (50 iterations in 0.540s)
[t-SNE] Iteration 100: error = 56.4288597, gradient norm = 0.4603898 (50 iterations in 2.018s)
[t-SNE] Iteration 150: error = 54.2735214, gradient norm = 0.5000774 (50 iterations in 2.022s)
[t-SNE] Iteration 200: error = 54.8940926, gradient norm = 0.4881312 (50 iterations in 2.025s)
[t-SNE] Iteration 250: error = 54.3236504, gradient norm = 0.5602466 (50 iterations in 2.027s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 54.323650
[t-SNE] Iteration 300: error = 0.6494906, gradient norm = 0.0099617 (50 iterations in 2.026s)
[t-SNE] Iteration 350: error = 0.4449751, gradient norm = 0.0021427 (50 iterations in 2.026s)
[t-SNE] Iteration 400: error = 0.4443427, gradient norm = 0.0004488 (50 iterations in 2.024s)
[t-SNE] Iteration 450: error = 0.4441684, gradient norm = 0.0003421 (50 iterations in 2.022s)
[t-SNE] Iteration 500: error = 0.4442858, gradient norm = 0.0003980 (50 iterations in 2.027s)
[t-SNE] Iteration 550: error = 0.4442617, gradient norm = 0.0004242 (50 iterations in 2.026s)
[t-SNE] Iteration 600: error = 0.4442736, gradient norm = 0.0004174 (50 iterations in 2.018s)
[t-SNE] Iteration 650: error = 0.4443280, gradient norm = 0.0003313 (50 iterations in 2.023s)
[t-SNE] Iteration 700: error = 0.4444045, gradient norm = 0.0003123 (50 iterations in 2.022s)
[t-SNE] Iteration 750: error = 0.4443297, gradient norm = 0.0004813 (50 iterations in 2.023s)
[t-SNE] Iteration 800: error = 0.4443903, gradient norm = 0.0002849 (50 iterations in 2.029s)
[t-SNE] Iteration 800: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 800 iterations: 0.444390
[t-SNE] Computed conditional probabilities for sample 123 / 123
[t-SNE] Mean sigma: 0.471589
Beginning preprocessing + Leiden
2024-03-11 22:55:47.067292 MEMORY 12.958765056
Affmat transformed
2024-03-11 22:55:47.069148 MEMORY 12.958765056
sources, targets, weights extracted
2024-03-11 22:55:47.069807 MEMORY 12.958765056
About to launch parallel Leiden runs
2024-03-11 22:55:47.083045 MEMORY 12.958765056
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.0s finished
Parallel Leiden runs finished
2024-03-11 22:55:49.044336 MEMORY 12.958765056
Quality: 0.25434823069403567
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  60 out of 107 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=24)]: Done 107 out of 107 | elapsed:    0.0s finished
Got subclusters: Counter({0: 32, 1: 30, 2: 29, 3: 23, 4: 9})
On pattern 7
[t-SNE] Computing 106 nearest neighbors...
[t-SNE] Indexed 107 samples in 0.001s...
[t-SNE] Computed neighbors for 107 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 107 / 107
[t-SNE] Mean sigma: 0.538547
[t-SNE] Computed conditional probabilities in 0.005s
[t-SNE] Iteration 50: error = 52.6452408, gradient norm = 0.6498143 (50 iterations in 2.014s)
[t-SNE] Iteration 100: error = 51.2887192, gradient norm = 0.5225724 (50 iterations in 2.024s)
[t-SNE] Iteration 150: error = 51.6406975, gradient norm = 0.5180439 (50 iterations in 2.022s)
[t-SNE] Iteration 200: error = 52.7053070, gradient norm = 0.5095151 (50 iterations in 2.022s)
[t-SNE] Iteration 250: error = 52.4202042, gradient norm = 0.4731739 (50 iterations in 2.021s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 52.420204
[t-SNE] Iteration 300: error = 0.4770498, gradient norm = 0.0169820 (50 iterations in 2.020s)
[t-SNE] Iteration 350: error = 0.3764387, gradient norm = 0.0019646 (50 iterations in 2.026s)
[t-SNE] Iteration 400: error = 0.3757557, gradient norm = 0.0005540 (50 iterations in 2.025s)
[t-SNE] Iteration 450: error = 0.3762209, gradient norm = 0.0003259 (50 iterations in 2.024s)
[t-SNE] Iteration 500: error = 0.3761635, gradient norm = 0.0002709 (50 iterations in 2.024s)
[t-SNE] Iteration 550: error = 0.3761536, gradient norm = 0.0003490 (50 iterations in 1.420s)
[t-SNE] Iteration 600: error = 0.3761551, gradient norm = 0.0003509 (50 iterations in 1.077s)
[t-SNE] Iteration 650: error = 0.3761546, gradient norm = 0.0003253 (50 iterations in 2.022s)
[t-SNE] Iteration 700: error = 0.3760684, gradient norm = 0.0003515 (50 iterations in 2.020s)
[t-SNE] Iteration 750: error = 0.3761195, gradient norm = 0.0004071 (50 iterations in 2.022s)
[t-SNE] Iteration 750: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 750 iterations: 0.376120
[t-SNE] Computed conditional probabilities for sample 107 / 107
[t-SNE] Mean sigma: 0.538547
Beginning preprocessing + Leiden
2024-03-11 22:56:17.969318 MEMORY 12.958765056
Affmat transformed
2024-03-11 22:56:17.970864 MEMORY 12.958765056
sources, targets, weights extracted
2024-03-11 22:56:17.971465 MEMORY 12.958765056
About to launch parallel Leiden runs
2024-03-11 22:56:17.990704 MEMORY 12.958765056
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.8s finished
Parallel Leiden runs finished
2024-03-11 22:56:19.825121 MEMORY 12.958765056
Quality: 0.24044512978864654
Quality: 0.24065423613231746
Quality: 0.2408100910715303
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  56 out of 103 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=24)]: Done 103 out of 103 | elapsed:    0.0s finished
Got subclusters: Counter({1: 26, 0: 26, 2: 26, 3: 17, 4: 12})
On pattern 8
[t-SNE] Computing 102 nearest neighbors...
[t-SNE] Indexed 103 samples in 0.001s...
[t-SNE] Computed neighbors for 103 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 103 / 103
[t-SNE] Mean sigma: 0.553514
[t-SNE] Computed conditional probabilities in 0.004s
[t-SNE] Iteration 50: error = 52.3004379, gradient norm = 0.5610272 (50 iterations in 2.017s)
[t-SNE] Iteration 100: error = 54.3202858, gradient norm = 0.5435153 (50 iterations in 2.021s)
[t-SNE] Iteration 150: error = 52.4039345, gradient norm = 0.5233850 (50 iterations in 2.022s)
[t-SNE] Iteration 200: error = 51.9403305, gradient norm = 0.5075752 (50 iterations in 2.017s)
[t-SNE] Iteration 250: error = 51.6562767, gradient norm = 0.5765899 (50 iterations in 2.023s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 51.656277
[t-SNE] Iteration 300: error = 0.7594312, gradient norm = 0.0128911 (50 iterations in 1.503s)
[t-SNE] Iteration 350: error = 0.3627106, gradient norm = 0.0074917 (50 iterations in 0.918s)
[t-SNE] Iteration 400: error = 0.3566493, gradient norm = 0.0004540 (50 iterations in 0.816s)
[t-SNE] Iteration 450: error = 0.3564707, gradient norm = 0.0004977 (50 iterations in 1.699s)
[t-SNE] Iteration 500: error = 0.3564070, gradient norm = 0.0004131 (50 iterations in 2.020s)
[t-SNE] Iteration 550: error = 0.3565222, gradient norm = 0.0003901 (50 iterations in 1.174s)
[t-SNE] Iteration 600: error = 0.3563379, gradient norm = 0.0005559 (50 iterations in 1.216s)
[t-SNE] Iteration 650: error = 0.3563345, gradient norm = 0.0006520 (50 iterations in 2.021s)
[t-SNE] Iteration 700: error = 0.3563452, gradient norm = 0.0004722 (50 iterations in 2.026s)
[t-SNE] Iteration 750: error = 0.3565267, gradient norm = 0.0004575 (50 iterations in 2.023s)
[t-SNE] Iteration 800: error = 0.3563536, gradient norm = 0.0004760 (50 iterations in 2.020s)
[t-SNE] Iteration 850: error = 0.3563404, gradient norm = 0.0005996 (50 iterations in 2.024s)
[t-SNE] Iteration 900: error = 0.3564354, gradient norm = 0.0005815 (50 iterations in 2.021s)
[t-SNE] Iteration 950: error = 0.3561899, gradient norm = 0.0005107 (50 iterations in 2.028s)
[t-SNE] Iteration 1000: error = 0.3564613, gradient norm = 0.0005199 (50 iterations in 2.022s)
[t-SNE] KL divergence after 1000 iterations: 0.356461
[t-SNE] Computed conditional probabilities for sample 103 / 103
[t-SNE] Mean sigma: 0.553514
Beginning preprocessing + Leiden
2024-03-11 22:56:55.585565 MEMORY 12.958765056
Affmat transformed
2024-03-11 22:56:55.587097 MEMORY 12.958765056
sources, targets, weights extracted
2024-03-11 22:56:55.587693 MEMORY 12.958765056
About to launch parallel Leiden runs
2024-03-11 22:56:55.626132 MEMORY 12.958765056
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.9s finished
Parallel Leiden runs finished
2024-03-11 22:56:57.535847 MEMORY 12.958765056
Quality: 0.2103165008227609
Quality: 0.21155317461747986
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  98 out of  98 | elapsed:    0.0s finished
Got subclusters: Counter({0: 27, 1: 26, 2: 19, 3: 18, 4: 13})
On pattern 9
[t-SNE] Computing 97 nearest neighbors...
[t-SNE] Indexed 98 samples in 0.001s...
[t-SNE] Computed neighbors for 98 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 98 / 98
[t-SNE] Mean sigma: 0.541870
[t-SNE] Computed conditional probabilities in 0.004s
[t-SNE] Iteration 50: error = 54.3684387, gradient norm = 0.4521142 (50 iterations in 2.018s)
[t-SNE] Iteration 100: error = 50.5907059, gradient norm = 0.5599726 (50 iterations in 2.024s)
[t-SNE] Iteration 150: error = 52.7809486, gradient norm = 0.5116385 (50 iterations in 2.024s)
[t-SNE] Iteration 200: error = 53.3153458, gradient norm = 0.5399914 (50 iterations in 2.026s)
[t-SNE] Iteration 250: error = 52.7113914, gradient norm = 0.5124202 (50 iterations in 2.020s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 52.711391
[t-SNE] Iteration 300: error = 0.8762647, gradient norm = 0.0050548 (50 iterations in 2.023s)
[t-SNE] Iteration 350: error = 0.7294356, gradient norm = 0.0042667 (50 iterations in 2.017s)
[t-SNE] Iteration 400: error = 0.3717088, gradient norm = 0.0166331 (50 iterations in 2.020s)
[t-SNE] Iteration 450: error = 0.3423100, gradient norm = 0.0017438 (50 iterations in 2.025s)
[t-SNE] Iteration 500: error = 0.3423373, gradient norm = 0.0003284 (50 iterations in 2.022s)
[t-SNE] Iteration 550: error = 0.3422981, gradient norm = 0.0002334 (50 iterations in 1.776s)
[t-SNE] Iteration 600: error = 0.3423195, gradient norm = 0.0002773 (50 iterations in 0.591s)
[t-SNE] Iteration 650: error = 0.3423310, gradient norm = 0.0002672 (50 iterations in 2.023s)
[t-SNE] Iteration 700: error = 0.3422306, gradient norm = 0.0002634 (50 iterations in 2.022s)
[t-SNE] Iteration 750: error = 0.3420907, gradient norm = 0.0002861 (50 iterations in 2.020s)
[t-SNE] Iteration 800: error = 0.3421246, gradient norm = 0.0002695 (50 iterations in 2.024s)
[t-SNE] Iteration 850: error = 0.3422593, gradient norm = 0.0003589 (50 iterations in 2.025s)
[t-SNE] Iteration 900: error = 0.3423997, gradient norm = 0.0002821 (50 iterations in 2.022s)
[t-SNE] Iteration 950: error = 0.3423182, gradient norm = 0.0003168 (50 iterations in 2.020s)
[t-SNE] Iteration 1000: error = 0.3422595, gradient norm = 0.0002265 (50 iterations in 1.382s)
[t-SNE] KL divergence after 1000 iterations: 0.342259
[t-SNE] Computed conditional probabilities for sample 98 / 98
[t-SNE] Mean sigma: 0.541869
Beginning preprocessing + Leiden
2024-03-11 22:57:35.776140 MEMORY 12.958765056
Affmat transformed
2024-03-11 22:57:35.777628 MEMORY 12.958765056
sources, targets, weights extracted
2024-03-11 22:57:35.778188 MEMORY 12.958765056
About to launch parallel Leiden runs
2024-03-11 22:57:35.781905 MEMORY 12.958765056
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.8s finished
Parallel Leiden runs finished
2024-03-11 22:57:37.626473 MEMORY 12.958765056
Quality: 0.19447551361501603
Quality: 0.1945322985214107
Quality: 0.19536161193756593
Quality: 0.19632147950051368
Quality: 0.19771827932759942
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  94 out of  94 | elapsed:    0.0s finished
Got subclusters: Counter({0: 26, 1: 18, 2: 16, 3: 14, 5: 12, 4: 12})
On pattern 10
[t-SNE] Computing 93 nearest neighbors...
[t-SNE] Indexed 94 samples in 0.001s...
[t-SNE] Computed neighbors for 94 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 94 / 94
[t-SNE] Mean sigma: 0.615078
[t-SNE] Computed conditional probabilities in 0.004s
[t-SNE] Iteration 50: error = 51.5653915, gradient norm = 0.5201808 (50 iterations in 0.171s)
[t-SNE] Iteration 100: error = 50.9441261, gradient norm = 0.5315670 (50 iterations in 2.028s)
[t-SNE] Iteration 150: error = 51.3921432, gradient norm = 0.5201580 (50 iterations in 0.729s)
[t-SNE] Iteration 200: error = 51.1893196, gradient norm = 0.5697162 (50 iterations in 1.573s)
[t-SNE] Iteration 250: error = 48.2890854, gradient norm = 0.5557155 (50 iterations in 2.022s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 48.289085
[t-SNE] Iteration 300: error = 0.4283728, gradient norm = 0.0240963 (50 iterations in 2.020s)
[t-SNE] Iteration 350: error = 0.3187991, gradient norm = 0.0026796 (50 iterations in 1.580s)
[t-SNE] Iteration 400: error = 0.3135740, gradient norm = 0.0024076 (50 iterations in 0.774s)
[t-SNE] Iteration 450: error = 0.3135498, gradient norm = 0.0007721 (50 iterations in 2.020s)
[t-SNE] Iteration 500: error = 0.3133747, gradient norm = 0.0004666 (50 iterations in 2.020s)
[t-SNE] Iteration 550: error = 0.3134455, gradient norm = 0.0004361 (50 iterations in 2.021s)
[t-SNE] Iteration 600: error = 0.3133028, gradient norm = 0.0003594 (50 iterations in 2.021s)
[t-SNE] Iteration 650: error = 0.3133639, gradient norm = 0.0004086 (50 iterations in 2.022s)
[t-SNE] Iteration 700: error = 0.3134061, gradient norm = 0.0003909 (50 iterations in 2.022s)
[t-SNE] Iteration 750: error = 0.3133543, gradient norm = 0.0002654 (50 iterations in 2.024s)
[t-SNE] Iteration 800: error = 0.3134384, gradient norm = 0.0002959 (50 iterations in 2.034s)
[t-SNE] Iteration 850: error = 0.3133468, gradient norm = 0.0004713 (50 iterations in 2.026s)
[t-SNE] Iteration 900: error = 0.3134379, gradient norm = 0.0002980 (50 iterations in 2.026s)
[t-SNE] Iteration 950: error = 0.3133153, gradient norm = 0.0003662 (50 iterations in 2.025s)
[t-SNE] Iteration 950: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 950 iterations: 0.313315
[t-SNE] Computed conditional probabilities for sample 94 / 94
[t-SNE] Mean sigma: 0.615078
Beginning preprocessing + Leiden
2024-03-11 22:58:10.901938 MEMORY 12.958765056
Affmat transformed
2024-03-11 22:58:10.903356 MEMORY 12.958765056
sources, targets, weights extracted
2024-03-11 22:58:10.903923 MEMORY 12.958765056
About to launch parallel Leiden runs
2024-03-11 22:58:10.920345 MEMORY 12.958765056
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.8s finished
Parallel Leiden runs finished
2024-03-11 22:58:12.760570 MEMORY 12.958765056
Quality: 0.2102162882885527
Quality: 0.21039295170955774
Quality: 0.21040073043054522
Quality: 0.2107894257854633
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  84 out of  84 | elapsed:    0.0s finished
Got subclusters: Counter({0: 32, 1: 29, 2: 20, 3: 13})
On pattern 11
[t-SNE] Computing 83 nearest neighbors...
[t-SNE] Indexed 84 samples in 0.001s...
[t-SNE] Computed neighbors for 84 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 84 / 84
[t-SNE] Mean sigma: 0.552828
[t-SNE] Computed conditional probabilities in 0.003s
[t-SNE] Iteration 50: error = 54.1478195, gradient norm = 0.5774349 (50 iterations in 2.021s)
[t-SNE] Iteration 100: error = 50.7187538, gradient norm = 0.5062537 (50 iterations in 2.022s)
[t-SNE] Iteration 150: error = 50.6712265, gradient norm = 0.3717207 (50 iterations in 2.022s)
[t-SNE] Iteration 200: error = 50.3277245, gradient norm = 0.5344402 (50 iterations in 2.020s)
[t-SNE] Iteration 250: error = 52.4507256, gradient norm = 0.4849885 (50 iterations in 0.326s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 52.450726
[t-SNE] Iteration 300: error = 0.9824252, gradient norm = 0.0028617 (50 iterations in 1.978s)
[t-SNE] Iteration 350: error = 0.8510193, gradient norm = 0.0014185 (50 iterations in 2.020s)
[t-SNE] Iteration 400: error = 0.7840779, gradient norm = 0.0011465 (50 iterations in 0.227s)
[t-SNE] Iteration 450: error = 0.7238030, gradient norm = 0.0015373 (50 iterations in 0.667s)
[t-SNE] Iteration 500: error = 0.6787235, gradient norm = 0.0010016 (50 iterations in 0.574s)
[t-SNE] Iteration 550: error = 0.6464753, gradient norm = 0.0010916 (50 iterations in 1.303s)
[t-SNE] Iteration 600: error = 0.6222922, gradient norm = 0.0006958 (50 iterations in 2.024s)
[t-SNE] Iteration 650: error = 0.5883139, gradient norm = 0.0019165 (50 iterations in 2.021s)
[t-SNE] Iteration 700: error = 0.2664778, gradient norm = 0.0211889 (50 iterations in 0.991s)
[t-SNE] Iteration 750: error = 0.2444758, gradient norm = 0.0026119 (50 iterations in 1.146s)
[t-SNE] Iteration 800: error = 0.2439557, gradient norm = 0.0008739 (50 iterations in 0.413s)
[t-SNE] Iteration 850: error = 0.2438349, gradient norm = 0.0008618 (50 iterations in 1.320s)
[t-SNE] Iteration 900: error = 0.2439917, gradient norm = 0.0008260 (50 iterations in 0.966s)
[t-SNE] Iteration 950: error = 0.2437489, gradient norm = 0.0008079 (50 iterations in 2.021s)
[t-SNE] Iteration 1000: error = 0.2437533, gradient norm = 0.0010587 (50 iterations in 2.017s)
[t-SNE] KL divergence after 1000 iterations: 0.243753
[t-SNE] Computed conditional probabilities for sample 84 / 84
[t-SNE] Mean sigma: 0.552828
Beginning preprocessing + Leiden
2024-03-11 22:58:40.959161 MEMORY 12.958765056
Affmat transformed
2024-03-11 22:58:40.960496 MEMORY 12.958765056
sources, targets, weights extracted
2024-03-11 22:58:40.961010 MEMORY 12.958765056
About to launch parallel Leiden runs
2024-03-11 22:58:40.996159 MEMORY 12.958765056
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.6s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.8s finished
Parallel Leiden runs finished
2024-03-11 22:58:42.798945 MEMORY 12.958765056
Quality: 0.16417207442265644
Quality: 0.164673110045077
Quality: 0.16911366878064998
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  78 out of  78 | elapsed:    0.0s finished
Got subclusters: Counter({0: 26, 1: 25, 2: 18, 3: 15})
On pattern 12
[t-SNE] Computing 77 nearest neighbors...
[t-SNE] Indexed 78 samples in 0.001s...
[t-SNE] Computed neighbors for 78 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 78 / 78
[t-SNE] Mean sigma: 0.579337
[t-SNE] Computed conditional probabilities in 0.003s
[t-SNE] Iteration 50: error = 48.0144730, gradient norm = 0.5517083 (50 iterations in 2.016s)
[t-SNE] Iteration 100: error = 48.9087791, gradient norm = 0.6228641 (50 iterations in 2.020s)
[t-SNE] Iteration 150: error = 53.7873993, gradient norm = 0.6147860 (50 iterations in 2.019s)
[t-SNE] Iteration 200: error = 49.4225922, gradient norm = 0.5443406 (50 iterations in 2.021s)
[t-SNE] Iteration 250: error = 50.2569466, gradient norm = 0.4583451 (50 iterations in 2.027s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 50.256947
[t-SNE] Iteration 300: error = 0.7970331, gradient norm = 0.0033116 (50 iterations in 2.023s)
[t-SNE] Iteration 350: error = 0.6769201, gradient norm = 0.0021223 (50 iterations in 2.025s)
[t-SNE] Iteration 400: error = 0.6359884, gradient norm = 0.0010073 (50 iterations in 2.024s)
[t-SNE] Iteration 450: error = 0.6039174, gradient norm = 0.0037999 (50 iterations in 2.021s)
[t-SNE] Iteration 500: error = 0.2548201, gradient norm = 0.0204041 (50 iterations in 2.021s)
[t-SNE] Iteration 550: error = 0.1801785, gradient norm = 0.0046324 (50 iterations in 2.017s)
[t-SNE] Iteration 600: error = 0.1770113, gradient norm = 0.0009236 (50 iterations in 2.021s)
[t-SNE] Iteration 650: error = 0.1777210, gradient norm = 0.0007920 (50 iterations in 2.020s)
[t-SNE] Iteration 700: error = 0.1775063, gradient norm = 0.0012095 (50 iterations in 1.346s)
[t-SNE] Iteration 750: error = 0.1775199, gradient norm = 0.0009196 (50 iterations in 0.287s)
[t-SNE] Iteration 800: error = 0.1775234, gradient norm = 0.0006880 (50 iterations in 0.330s)
[t-SNE] Iteration 850: error = 0.1774977, gradient norm = 0.0009977 (50 iterations in 0.826s)
[t-SNE] Iteration 900: error = 0.1774994, gradient norm = 0.0011486 (50 iterations in 1.174s)
[t-SNE] Iteration 950: error = 0.1777303, gradient norm = 0.0030505 (50 iterations in 0.556s)
[t-SNE] Iteration 950: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 950 iterations: 0.177730
[t-SNE] Computed conditional probabilities for sample 78 / 78
[t-SNE] Mean sigma: 0.579337
Beginning preprocessing + Leiden
2024-03-11 22:59:13.682764 MEMORY 12.958765056
Affmat transformed
2024-03-11 22:59:13.684023 MEMORY 12.958765056
sources, targets, weights extracted
2024-03-11 22:59:13.684508 MEMORY 12.958765056
About to launch parallel Leiden runs
2024-03-11 22:59:13.688173 MEMORY 12.958765056
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.9s finished
Parallel Leiden runs finished
2024-03-11 22:59:15.543447 MEMORY 12.958765056
Quality: 0.14127834590229368
Quality: 0.1412987437377203
Quality: 0.14179807092639138
Quality: 0.1430938459129154
Quality: 0.14335107881364234
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  76 out of  76 | elapsed:    0.0s finished
Got subclusters: Counter({2: 26, 1: 26, 0: 26})
On pattern 13
[t-SNE] Computing 75 nearest neighbors...
[t-SNE] Indexed 76 samples in 0.001s...
[t-SNE] Computed neighbors for 76 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 76 / 76
[t-SNE] Mean sigma: 0.561276
[t-SNE] Computed conditional probabilities in 0.003s
[t-SNE] Iteration 50: error = 51.3622208, gradient norm = 0.5157742 (50 iterations in 2.019s)
[t-SNE] Iteration 100: error = 50.4144096, gradient norm = 0.4496421 (50 iterations in 2.023s)
[t-SNE] Iteration 150: error = 46.6898460, gradient norm = 0.4395064 (50 iterations in 2.021s)
[t-SNE] Iteration 200: error = 48.1858101, gradient norm = 0.4440022 (50 iterations in 2.021s)
[t-SNE] Iteration 250: error = 49.2109756, gradient norm = 0.5556005 (50 iterations in 1.986s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 49.210976
[t-SNE] Iteration 300: error = 0.8460343, gradient norm = 0.0035234 (50 iterations in 0.189s)
[t-SNE] Iteration 350: error = 0.7262004, gradient norm = 0.0010876 (50 iterations in 2.022s)
[t-SNE] Iteration 400: error = 0.6748197, gradient norm = 0.0009935 (50 iterations in 2.024s)
[t-SNE] Iteration 450: error = 0.6230988, gradient norm = 0.0024329 (50 iterations in 1.529s)
[t-SNE] Iteration 500: error = 0.9238577, gradient norm = 0.0489105 (50 iterations in 0.612s)
[t-SNE] Iteration 550: error = 0.9102910, gradient norm = 0.0014216 (50 iterations in 0.547s)
[t-SNE] Iteration 600: error = 0.7993387, gradient norm = 0.0006686 (50 iterations in 1.649s)
[t-SNE] Iteration 650: error = 0.7175077, gradient norm = 0.0003777 (50 iterations in 2.024s)
[t-SNE] Iteration 700: error = 0.6833035, gradient norm = 0.0003984 (50 iterations in 2.024s)
[t-SNE] Iteration 750: error = 0.6730641, gradient norm = 0.0001558 (50 iterations in 2.026s)
[t-SNE] Iteration 800: error = 0.6665805, gradient norm = 0.0001681 (50 iterations in 2.024s)
[t-SNE] Iteration 800: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 800 iterations: 0.666580
[t-SNE] Computed conditional probabilities for sample 76 / 76
[t-SNE] Mean sigma: 0.561276
Beginning preprocessing + Leiden
2024-03-11 22:59:42.369978 MEMORY 12.958765056
Affmat transformed
2024-03-11 22:59:42.371272 MEMORY 12.958765056
sources, targets, weights extracted
2024-03-11 22:59:42.371755 MEMORY 12.958765056
About to launch parallel Leiden runs
2024-03-11 22:59:42.393080 MEMORY 12.958765056
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.8s finished
Parallel Leiden runs finished
2024-03-11 22:59:44.184917 MEMORY 12.958765056
Quality: 0.14995860966785726
Quality: 0.15091259623336328
Quality: 0.15497788929218084
Quality: 0.15617673661129908
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  72 out of  72 | elapsed:    0.0s finished
Got subclusters: Counter({0: 24, 1: 20, 2: 19, 3: 13})
On pattern 14
[t-SNE] Computing 71 nearest neighbors...
[t-SNE] Indexed 72 samples in 0.001s...
[t-SNE] Computed neighbors for 72 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 72 / 72
[t-SNE] Mean sigma: 0.748353
[t-SNE] Computed conditional probabilities in 0.002s
[t-SNE] Iteration 50: error = 49.2953262, gradient norm = 0.5171709 (50 iterations in 2.023s)
[t-SNE] Iteration 100: error = 49.2911491, gradient norm = 0.6578708 (50 iterations in 2.023s)
[t-SNE] Iteration 150: error = 48.0777054, gradient norm = 0.5370556 (50 iterations in 2.025s)
[t-SNE] Iteration 200: error = 47.3984222, gradient norm = 0.5721338 (50 iterations in 0.143s)
[t-SNE] Iteration 250: error = 48.4841652, gradient norm = 0.5380087 (50 iterations in 1.783s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 48.484165
[t-SNE] Iteration 300: error = 0.8699252, gradient norm = 0.0022201 (50 iterations in 2.020s)
[t-SNE] Iteration 350: error = 0.7557676, gradient norm = 0.0013697 (50 iterations in 1.659s)
[t-SNE] Iteration 400: error = 0.6904407, gradient norm = 0.0009994 (50 iterations in 0.239s)
[t-SNE] Iteration 450: error = 0.6123322, gradient norm = 0.0014338 (50 iterations in 1.777s)
[t-SNE] Iteration 500: error = 0.5719092, gradient norm = 0.0010433 (50 iterations in 0.129s)
[t-SNE] Iteration 550: error = 0.4974635, gradient norm = 0.0020058 (50 iterations in 1.027s)
[t-SNE] Iteration 600: error = 0.4445661, gradient norm = 0.0013313 (50 iterations in 0.885s)
[t-SNE] Iteration 650: error = 0.4318045, gradient norm = 0.0004199 (50 iterations in 2.025s)
[t-SNE] Iteration 700: error = 0.4211447, gradient norm = 0.0005357 (50 iterations in 2.024s)
[t-SNE] Iteration 750: error = 0.9730586, gradient norm = 0.0076136 (50 iterations in 2.024s)
[t-SNE] Iteration 800: error = 0.7260342, gradient norm = 0.0012951 (50 iterations in 2.023s)
[t-SNE] Iteration 850: error = 0.6232920, gradient norm = 0.0006403 (50 iterations in 2.024s)
[t-SNE] Iteration 900: error = 0.5739853, gradient norm = 0.0003657 (50 iterations in 2.018s)
[t-SNE] Iteration 950: error = 0.5536105, gradient norm = 0.0003116 (50 iterations in 1.664s)
[t-SNE] Iteration 1000: error = 0.5326051, gradient norm = 0.0004171 (50 iterations in 0.210s)
[t-SNE] KL divergence after 1000 iterations: 0.532605
[t-SNE] Computed conditional probabilities for sample 72 / 72
[t-SNE] Mean sigma: 0.748353
Beginning preprocessing + Leiden
2024-03-11 23:00:14.008320 MEMORY 12.958765056
Affmat transformed
2024-03-11 23:00:14.009498 MEMORY 12.958765056
sources, targets, weights extracted
2024-03-11 23:00:14.009961 MEMORY 12.958765056
About to launch parallel Leiden runs
2024-03-11 23:00:14.026825 MEMORY 12.958765056
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.8s finished
Parallel Leiden runs finished
2024-03-11 23:00:15.860558 MEMORY 12.958765056
Quality: 0.16948812012034187
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  55 out of  55 | elapsed:    0.0s finished
Got subclusters: Counter({0: 30, 1: 26, 2: 16})
On pattern 15
[t-SNE] Computing 54 nearest neighbors...
[t-SNE] Indexed 55 samples in 0.000s...
[t-SNE] Computed neighbors for 55 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 55 / 55
[t-SNE] Mean sigma: 1.083422
[t-SNE] Computed conditional probabilities in 0.001s
[t-SNE] Iteration 50: error = 46.5632896, gradient norm = 0.5863582 (50 iterations in 2.018s)
[t-SNE] Iteration 100: error = 43.9132118, gradient norm = 0.6118667 (50 iterations in 0.175s)
[t-SNE] Iteration 150: error = 49.5941734, gradient norm = 0.5265002 (50 iterations in 1.570s)
[t-SNE] Iteration 200: error = 42.7449188, gradient norm = 0.4730765 (50 iterations in 2.022s)
[t-SNE] Iteration 250: error = 42.2482071, gradient norm = 0.5300629 (50 iterations in 2.022s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 42.248207
[t-SNE] Iteration 300: error = 0.7043919, gradient norm = 0.0012697 (50 iterations in 2.028s)
[t-SNE] Iteration 350: error = 0.6553862, gradient norm = 0.0003682 (50 iterations in 2.018s)
[t-SNE] Iteration 400: error = 0.6302751, gradient norm = 0.0004073 (50 iterations in 2.022s)
[t-SNE] Iteration 450: error = 0.6183321, gradient norm = 0.0002900 (50 iterations in 2.023s)
[t-SNE] Iteration 500: error = 0.6016593, gradient norm = 0.0003475 (50 iterations in 2.021s)
[t-SNE] Iteration 550: error = 0.5929912, gradient norm = 0.0002913 (50 iterations in 2.022s)
[t-SNE] Iteration 600: error = 0.5825930, gradient norm = 0.0004231 (50 iterations in 2.021s)
[t-SNE] Iteration 650: error = 0.5716920, gradient norm = 0.0003717 (50 iterations in 2.017s)
[t-SNE] Iteration 700: error = 0.5604167, gradient norm = 0.0005345 (50 iterations in 1.534s)
[t-SNE] Iteration 750: error = 0.7364709, gradient norm = 0.0021767 (50 iterations in 0.209s)
[t-SNE] Iteration 800: error = 0.6545678, gradient norm = 0.0003503 (50 iterations in 2.016s)
[t-SNE] Iteration 850: error = 0.6428695, gradient norm = 0.0001282 (50 iterations in 2.032s)
[t-SNE] Iteration 900: error = 0.6347123, gradient norm = 0.0001722 (50 iterations in 2.025s)
[t-SNE] Iteration 950: error = 0.6301097, gradient norm = 0.0001082 (50 iterations in 2.025s)
[t-SNE] Iteration 1000: error = 0.6247768, gradient norm = 0.0001231 (50 iterations in 2.027s)
[t-SNE] KL divergence after 1000 iterations: 0.624777
[t-SNE] Computed conditional probabilities for sample 55 / 55
[t-SNE] Mean sigma: 1.083422
Beginning preprocessing + Leiden
2024-03-11 23:00:51.764826 MEMORY 12.958646272
Affmat transformed
2024-03-11 23:00:51.765944 MEMORY 12.958724096
sources, targets, weights extracted
2024-03-11 23:00:51.766374 MEMORY 12.958736384
About to launch parallel Leiden runs
2024-03-11 23:00:51.806987 MEMORY 12.95874048
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.8s finished
Parallel Leiden runs finished
2024-03-11 23:00:53.577410 MEMORY 12.95874048
Quality: 0.06175104405660508
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  49 out of  49 | elapsed:    0.0s finished
Got subclusters: Counter({0: 15, 1: 14, 2: 14, 3: 12})
On pattern 16
[t-SNE] Computing 48 nearest neighbors...
[t-SNE] Indexed 49 samples in 0.000s...
[t-SNE] Computed neighbors for 49 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 49 / 49
[t-SNE] Mean sigma: 12.701875
[t-SNE] Computed conditional probabilities in 0.001s
[t-SNE] Iteration 50: error = 44.9766045, gradient norm = 0.4198038 (50 iterations in 2.019s)
[t-SNE] Iteration 100: error = 44.3843498, gradient norm = 0.4294248 (50 iterations in 2.022s)
[t-SNE] Iteration 150: error = 43.8653297, gradient norm = 0.4357130 (50 iterations in 2.023s)
[t-SNE] Iteration 200: error = 40.8548126, gradient norm = 0.6587500 (50 iterations in 2.024s)
[t-SNE] Iteration 250: error = 45.5645905, gradient norm = 0.3723434 (50 iterations in 2.022s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 45.564590
[t-SNE] Iteration 300: error = 0.6187320, gradient norm = 0.0006100 (50 iterations in 2.021s)
[t-SNE] Iteration 350: error = 0.6123585, gradient norm = 0.0001130 (50 iterations in 2.023s)
[t-SNE] Iteration 400: error = 0.6096226, gradient norm = 0.0000859 (50 iterations in 2.024s)
[t-SNE] Iteration 450: error = 0.6101010, gradient norm = 0.0000433 (50 iterations in 2.025s)
[t-SNE] Iteration 500: error = 0.6089931, gradient norm = 0.0000665 (50 iterations in 2.025s)
[t-SNE] Iteration 550: error = 0.6059538, gradient norm = 0.0001977 (50 iterations in 2.021s)
[t-SNE] Iteration 600: error = 0.6018378, gradient norm = 0.0003245 (50 iterations in 2.021s)
[t-SNE] Iteration 650: error = 0.8413938, gradient norm = 0.0067045 (50 iterations in 2.022s)
[t-SNE] Iteration 700: error = 0.6464392, gradient norm = 0.0005233 (50 iterations in 2.018s)
[t-SNE] Iteration 750: error = 0.6146218, gradient norm = 0.0000964 (50 iterations in 0.768s)
[t-SNE] Iteration 800: error = 0.6128406, gradient norm = 0.0000667 (50 iterations in 0.281s)
[t-SNE] Iteration 850: error = 0.6104026, gradient norm = 0.0000530 (50 iterations in 0.274s)
[t-SNE] Iteration 900: error = 0.6107522, gradient norm = 0.0000301 (50 iterations in 0.881s)
[t-SNE] Iteration 950: error = 0.6105385, gradient norm = 0.0000304 (50 iterations in 0.730s)
[t-SNE] Iteration 950: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 950 iterations: 0.610538
[t-SNE] Computed conditional probabilities for sample 49 / 49
[t-SNE] Mean sigma: 1125899906842624.000000
Beginning preprocessing + Leiden
2024-03-11 23:01:24.874245 MEMORY 12.958752768
Affmat transformed
2024-03-11 23:01:24.875250 MEMORY 12.958752768
sources, targets, weights extracted
2024-03-11 23:01:24.875666 MEMORY 12.958752768
About to launch parallel Leiden runs
2024-03-11 23:01:24.894483 MEMORY 12.958752768
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.8s finished
Parallel Leiden runs finished
2024-03-11 23:01:26.665207 MEMORY 12.958752768
Quality: 2.4868995751602976e-13
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done  28 out of  37 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=24)]: Done  37 out of  37 | elapsed:    0.0s finished
Got subclusters: Counter({0: 49})
On pattern 17
[t-SNE] Computing 36 nearest neighbors...
[t-SNE] Indexed 37 samples in 0.000s...
[t-SNE] Computed neighbors for 37 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 37 / 37
[t-SNE] Mean sigma: 10.374794
[t-SNE] Computed conditional probabilities in 0.001s
[t-SNE] Iteration 50: error = 47.7254524, gradient norm = 0.4400390 (50 iterations in 0.888s)
[t-SNE] Iteration 100: error = 44.4835739, gradient norm = 0.4929165 (50 iterations in 0.650s)
[t-SNE] Iteration 150: error = 49.4739761, gradient norm = 0.4576752 (50 iterations in 1.077s)
[t-SNE] Iteration 200: error = 42.6907692, gradient norm = 0.3220456 (50 iterations in 0.471s)
[t-SNE] Iteration 250: error = 42.9930267, gradient norm = 0.3591035 (50 iterations in 2.019s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 42.993027
[t-SNE] Iteration 300: error = 0.6536265, gradient norm = 0.0009881 (50 iterations in 2.022s)
[t-SNE] Iteration 350: error = 0.5576275, gradient norm = 0.0002439 (50 iterations in 2.016s)
[t-SNE] Iteration 400: error = 0.5499410, gradient norm = 0.0000436 (50 iterations in 2.019s)
[t-SNE] Iteration 450: error = 0.5492683, gradient norm = 0.0000249 (50 iterations in 2.023s)
[t-SNE] Iteration 500: error = 0.5490634, gradient norm = 0.0000253 (50 iterations in 2.022s)
[t-SNE] Iteration 550: error = 0.5486655, gradient norm = 0.0000216 (50 iterations in 2.015s)
[t-SNE] Iteration 600: error = 0.5479144, gradient norm = 0.0000243 (50 iterations in 0.088s)
[t-SNE] Iteration 650: error = 0.5475265, gradient norm = 0.0000194 (50 iterations in 0.569s)
[t-SNE] Iteration 700: error = 0.5475204, gradient norm = 0.0000163 (50 iterations in 0.328s)
[t-SNE] Iteration 750: error = 0.5476052, gradient norm = 0.0000136 (50 iterations in 0.541s)
[t-SNE] Iteration 800: error = 0.5471866, gradient norm = 0.0000176 (50 iterations in 0.568s)
[t-SNE] Iteration 850: error = 0.5462165, gradient norm = 0.0000422 (50 iterations in 0.010s)
[t-SNE] Iteration 900: error = 0.5470952, gradient norm = 0.0000295 (50 iterations in 0.285s)
[t-SNE] Iteration 950: error = 0.5469962, gradient norm = 0.0000234 (50 iterations in 1.046s)
[t-SNE] Iteration 1000: error = 0.5463905, gradient norm = 0.0000287 (50 iterations in 2.020s)
[t-SNE] KL divergence after 1000 iterations: 0.546390
[t-SNE] Computed conditional probabilities for sample 37 / 37
[t-SNE] Mean sigma: 1125899906842624.000000
Beginning preprocessing + Leiden
2024-03-11 23:01:49.380841 MEMORY 12.958752768
Affmat transformed
2024-03-11 23:01:49.381802 MEMORY 12.958752768
sources, targets, weights extracted
2024-03-11 23:01:49.382194 MEMORY 12.958752768
About to launch parallel Leiden runs
2024-03-11 23:01:49.409728 MEMORY 12.958752768
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.8s finished
Parallel Leiden runs finished
2024-03-11 23:01:51.247311 MEMORY 12.958752768
Quality: 3.463895836830574e-14
Got subclusters: Counter({0: 37})
On metacluster 3
Metacluster size 5571
Relevant tasks:  ('testis',)
Relevant signs:  (1,)
TfModiscoSeqletsToPatternsFactory: seed=1234
(Round 1) num seqlets: 5571
(Round 1) Computing coarse affmat
2024-03-11 23:01:52.772733 MEMORY 12.957704192
Beginning embedding computation
MEMORY 12.957704192
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 152 tasks      | elapsed:    2.0s
[Parallel(n_jobs=24)]: Done 402 tasks      | elapsed:    4.9s
[Parallel(n_jobs=24)]: Done 752 tasks      | elapsed:    8.8s
[Parallel(n_jobs=24)]: Done 1202 tasks      | elapsed:   13.8s
[Parallel(n_jobs=24)]: Done 1752 tasks      | elapsed:   19.8s
[Parallel(n_jobs=24)]: Done 2402 tasks      | elapsed:   26.8s
[Parallel(n_jobs=24)]: Done 3152 tasks      | elapsed:   35.0s
[Parallel(n_jobs=24)]: Done 4002 tasks      | elapsed:   44.3s
[Parallel(n_jobs=24)]: Done 4952 tasks      | elapsed:   54.5s
[Parallel(n_jobs=24)]: Done 5571 out of 5571 | elapsed:  1.0min finished
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 152 tasks      | elapsed:    1.9s
[Parallel(n_jobs=24)]: Done 402 tasks      | elapsed:    4.6s
[Parallel(n_jobs=24)]: Done 752 tasks      | elapsed:    8.4s
[Parallel(n_jobs=24)]: Done 1202 tasks      | elapsed:   13.2s
[Parallel(n_jobs=24)]: Done 1752 tasks      | elapsed:   19.1s
[Parallel(n_jobs=24)]: Done 2402 tasks      | elapsed:   26.2s
[Parallel(n_jobs=24)]: Done 3152 tasks      | elapsed:   34.5s
[Parallel(n_jobs=24)]: Done 4002 tasks      | elapsed:   43.7s
[Parallel(n_jobs=24)]: Done 4952 tasks      | elapsed:   54.2s
[Parallel(n_jobs=24)]: Done 5571 out of 5571 | elapsed:  1.0min finished
At the beginning of embedding call
2024-03-11 23:01:52.772941 MEMORY 12.957704192
before computing embeddings fwd
2024-03-11 23:01:52.781351 MEMORY 12.957704192
after computing embeddings fwd
2024-03-11 23:02:53.850304 MEMORY 13.017038848
after computing embeddings rev
2024-03-11 23:03:54.803078 MEMORY 13.244420096
before computing sparse embeddings fwd
2024-03-11 23:03:54.803171 MEMORY 13.244420096
Constructing csr matrix...
csr matrix made in 0.6525089740753174 s
after computing sparse embeddings fwd
2024-03-11 23:03:55.663306 MEMORY 13.266874368
before computing sparse embeddings rev
2024-03-11 23:03:55.663383 MEMORY 13.266874368
Constructing csr matrix...
csr matrix made in 0.7138874530792236 s
after computing sparse embeddings rev
2024-03-11 23:03:56.606003 MEMORY 13.30030592
Finished embedding computation in 124.99 s
MEMORY 13.101862912
Starting affinity matrix computations
MEMORY 13.101862912
Batching in slices of size 5571
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:04<00:00,  4.49s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:04<00:00,  4.49s/it]
Finished affinity matrix computations in 4.52 s
MEMORY 13.101871104
(Round 1) Computed coarse affmat
2024-03-11 23:04:03.184039 MEMORY 13.046059008
(Round 1) Computing affinity matrix on nearest neighbors
2024-03-11 23:04:03.184172 MEMORY 13.046059008
Launching nearest neighbors affmat calculation job
MEMORY 13.046059008
Parallel runs completed
MEMORY 13.09775872
Job completed in: 16.89 s
MEMORY 13.097586688
Launching nearest neighbors affmat calculation job
MEMORY 13.09538304
Parallel runs completed
MEMORY 13.1806208
Job completed in: 16.68 s
MEMORY 13.180936192
(Round 1) Computed affinity matrix on nearest neighbors in 35.18 s
2024-03-11 23:04:38.366615 MEMORY 13.176889344
Filtered down to 5366 of 5571
(Round 1) Retained 5366 rows out of 5571 after filtering
2024-03-11 23:04:41.212804 MEMORY 13.176889344
(Round 1) Computing density adapted affmat
2024-03-11 23:04:43.027996 MEMORY 13.178667008
Symmetrizing nearest neighbors
Computing betas for density adaptation
Computing normalizing denominators
(Round 1) Computing clustering
2024-03-11 23:05:26.325644 MEMORY 13.212811264
Beginning preprocessing + Leiden
2024-03-11 23:05:26.333153 MEMORY 13.212811264
Affmat transformed
2024-03-11 23:05:26.333302 MEMORY 13.212811264
sources, targets, weights extracted
2024-03-11 23:05:26.525891 MEMORY 13.227921408
About to launch parallel Leiden runs
2024-03-11 23:05:26.951688 MEMORY 13.227921408
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:   22.5s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:  1.3min finished
Parallel Leiden runs finished
2024-03-11 23:06:47.107724 MEMORY 13.227921408
Quality: 0.3508492272255198
Quality: 0.3508564859649406
Quality: 0.3509612003059157
Quality: 0.35096426189083973
Quality: 0.3533185787850189
Got 4 clusters after round 1
Counts:
{3: 745, 1: 1528, 0: 1725, 2: 1368}
2024-03-11 23:06:47.124430 MEMORY 13.152497664
(Round 1) Aggregating seqlets in each cluster
2024-03-11 23:06:47.124527 MEMORY 13.152497664
Aggregating for cluster 0 with 1725 seqlets
2024-03-11 23:06:47.129159 MEMORY 13.152497664
Skipped 1 due to duplicates
Trimming eliminated 0 seqlets out of 1724
Aggregating for cluster 1 with 1528 seqlets
2024-03-11 23:06:52.151885 MEMORY 13.152497664
Skipped 4 due to duplicates
Trimming eliminated 0 seqlets out of 1524
Aggregating for cluster 2 with 1368 seqlets
2024-03-11 23:06:55.301906 MEMORY 13.152497664
Skipped 2 due to duplicates
Trimming eliminated 0 seqlets out of 1366
Aggregating for cluster 3 with 745 seqlets
2024-03-11 23:06:58.309146 MEMORY 13.152497664
Skipped 3 due to duplicates
Trimming eliminated 0 seqlets out of 742
(Round 2) num seqlets: 5356
(Round 2) Computing coarse affmat
2024-03-11 23:07:01.141574 MEMORY 13.152497664
Beginning embedding computation
MEMORY 13.152497664
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done 4080 tasks      | elapsed:    3.9s
[Parallel(n_jobs=24)]: Done 5356 out of 5356 | elapsed:    4.9s finished
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 404 tasks      | elapsed:    0.8s
[Parallel(n_jobs=24)]: Done 2400 tasks      | elapsed:    2.9s
[Parallel(n_jobs=24)]: Done 5309 out of 5356 | elapsed:    5.8s remaining:    0.1s
[Parallel(n_jobs=24)]: Done 5356 out of 5356 | elapsed:    5.8s finished
At the beginning of embedding call
2024-03-11 23:07:01.141817 MEMORY 13.152497664
before computing embeddings fwd
2024-03-11 23:07:01.150297 MEMORY 13.152497664
after computing embeddings fwd
2024-03-11 23:07:06.048711 MEMORY 13.300269056
after computing embeddings rev
2024-03-11 23:07:11.851908 MEMORY 13.51821312
before computing sparse embeddings fwd
2024-03-11 23:07:11.851997 MEMORY 13.51821312
Constructing csr matrix...
csr matrix made in 0.6198523044586182 s
after computing sparse embeddings fwd
2024-03-11 23:07:12.676328 MEMORY 13.657612288
before computing sparse embeddings rev
2024-03-11 23:07:12.676422 MEMORY 13.657612288
Constructing csr matrix...
csr matrix made in 0.5993366241455078 s
after computing sparse embeddings rev
2024-03-11 23:07:13.433275 MEMORY 13.689741312
Finished embedding computation in 14.13 s
MEMORY 13.442801664
Starting affinity matrix computations
MEMORY 13.442801664
Batching in slices of size 5356
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:04<00:00,  4.86s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:04<00:00,  4.86s/it]
Finished affinity matrix computations in 4.89 s
MEMORY 13.442801664
(Round 2) Computed coarse affmat
2024-03-11 23:07:21.425126 MEMORY 13.271371776
(Round 2) Computing affinity matrix on nearest neighbors
2024-03-11 23:07:21.425255 MEMORY 13.271371776
Launching nearest neighbors affmat calculation job
MEMORY 13.271371776
Parallel runs completed
MEMORY 13.290471424
Job completed in: 7.92 s
MEMORY 13.29025024
Launching nearest neighbors affmat calculation job
MEMORY 13.290078208
Parallel runs completed
MEMORY 13.313294336
Job completed in: 8.33 s
MEMORY 13.308940288
(Round 2) Computed affinity matrix on nearest neighbors in 17.84 s
2024-03-11 23:07:39.266828 MEMORY 13.308694528
Not applying filtering for rounds above first round
2024-03-11 23:07:39.267468 MEMORY 13.308694528
(Round 2) Computing density adapted affmat
2024-03-11 23:07:41.133582 MEMORY 13.379612672
Symmetrizing nearest neighbors
Computing betas for density adaptation
Computing normalizing denominators
(Round 2) Computing clustering
2024-03-11 23:08:23.080065 MEMORY 13.454405632
Beginning preprocessing + Leiden
2024-03-11 23:08:23.087405 MEMORY 13.454405632
Affmat transformed
2024-03-11 23:08:23.087529 MEMORY 13.454405632
sources, targets, weights extracted
2024-03-11 23:08:23.271263 MEMORY 13.484392448
About to launch parallel Leiden runs
2024-03-11 23:08:23.344466 MEMORY 13.484392448
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:   19.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:  1.3min finished
Parallel Leiden runs finished
2024-03-11 23:09:40.434397 MEMORY 13.484392448
Quality: 0.4337901576560095
Quality: 0.4337902877611999
Got 4 clusters after round 2
Counts:
{0: 1793, 2: 1388, 1: 1432, 3: 743}
2024-03-11 23:09:40.450662 MEMORY 13.349576704
(Round 2) Aggregating seqlets in each cluster
2024-03-11 23:09:40.450753 MEMORY 13.349576704
Aggregating for cluster 0 with 1793 seqlets
2024-03-11 23:09:40.454365 MEMORY 13.349576704
Skipped 1 due to duplicates
Trimming eliminated 0 seqlets out of 1792
Aggregating for cluster 1 with 1432 seqlets
2024-03-11 23:09:44.372931 MEMORY 13.349576704
Skipped 1 due to duplicates
Trimming eliminated 0 seqlets out of 1431
Aggregating for cluster 2 with 1388 seqlets
2024-03-11 23:09:46.496606 MEMORY 13.349576704
Trimming eliminated 0 seqlets out of 1388
Aggregating for cluster 3 with 743 seqlets
2024-03-11 23:09:48.609601 MEMORY 13.349576704
Skipped 2 due to duplicates
Trimming eliminated 0 seqlets out of 741
Got 4 clusters
Splitting into subclusters...
2024-03-11 23:09:49.775603 MEMORY 13.349576704
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 1650 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 1792 out of 1792 | elapsed:    0.3s finished
Inspecting pattern 0 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 1792
[t-SNE] Computed conditional probabilities for sample 1792 / 1792
[t-SNE] Mean sigma: 0.323516
Beginning preprocessing + Leiden
2024-03-11 23:09:52.146312 MEMORY 13.349617664
Affmat transformed
2024-03-11 23:09:52.167373 MEMORY 13.349617664
sources, targets, weights extracted
2024-03-11 23:09:52.180639 MEMORY 13.349617664
About to launch parallel Leiden runs
2024-03-11 23:09:52.216449 MEMORY 13.349617664
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    5.1s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   17.1s finished
Parallel Leiden runs finished
2024-03-11 23:10:09.359051 MEMORY 13.349617664
Quality: 0.46885800739883776
Quality: 0.46931904698282806
Quality: 0.47328164661546046
Quality: 0.4737376081181816
Quality: 0.4765542443822733
Got subclusters: Counter({0: 369, 1: 270, 2: 234, 3: 205, 4: 200, 5: 192, 6: 164, 7: 136, 8: 22})
On merging iteration 1
Numbers for each pattern pre-subsample: [369, 270, 234, 205, 200, 192, 164, 136, 22]
Numbers after subsampling: [300, 270, 234, 205, 200, 192, 164, 136, 22]
Computing sims for pattern 0
Computed sims for pattern 0 in 2.1993494033813477 s
Computing sims for pattern 1
Computed sims for pattern 1 in 1.9283342361450195 s
Computing sims for pattern 2
Computed sims for pattern 2 in 2.0523781776428223 s
Computing sims for pattern 3
Computed sims for pattern 3 in 1.7528188228607178 s
Computing sims for pattern 4
Computed sims for pattern 4 in 1.6987104415893555 s
Computing sims for pattern 5
Computed sims for pattern 5 in 1.6243743896484375 s
Computing sims for pattern 6
Computed sims for pattern 6 in 1.338791847229004 s
Computing sims for pattern 7
Computed sims for pattern 7 in 1.1941728591918945 s
Computing sims for pattern 8
Computed sims for pattern 8 in 0.2923431396484375 s
Cluster sizes
[369 270 234 205 200 192 164 136  22]
Cross-contamination matrix:
[[1.   0.46 0.59 0.58 0.43 0.52 0.66 0.7  0.34]
 [0.62 1.   0.67 0.69 0.41 0.55 0.5  0.7  0.52]
 [0.54 0.24 1.   0.63 0.28 0.42 0.63 0.41 0.35]
 [0.62 0.57 0.72 1.   0.35 0.41 0.56 0.51 0.38]
 [0.86 0.74 0.66 0.69 1.   0.7  0.49 0.87 0.61]
 [0.73 0.59 0.65 0.55 0.45 1.   0.63 0.74 0.46]
 [0.8  0.5  0.86 0.68 0.26 0.57 1.   0.69 0.33]
 [0.77 0.66 0.63 0.6  0.57 0.61 0.65 1.   0.47]
 [0.34 0.39 0.39 0.35 0.25 0.31 0.24 0.36 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.67 0.69 0.75 0.77 0.89 0.89 0.87 0.68]
 [0.67 1.   0.7  0.76 0.76 0.82 0.64 0.75 0.74]
 [0.69 0.7  1.   0.74 0.71 0.77 0.79 0.75 0.65]
 [0.75 0.76 0.74 1.   0.76 0.81 0.71 0.78 0.71]
 [0.77 0.76 0.71 0.76 1.   0.85 0.61 0.81 0.78]
 [0.89 0.82 0.77 0.81 0.85 1.   0.85 0.88 0.83]
 [0.89 0.64 0.79 0.71 0.61 0.85 1.   0.81 0.6 ]
 [0.87 0.75 0.75 0.78 0.81 0.88 0.81 1.   0.69]
 [0.68 0.74 0.65 0.71 0.78 0.83 0.6  0.69 1.  ]]
Collapsing 0 & 5 with crosscontam 0.5185227044753087 and sim 0.893657533973702
Collapsing 0 & 6 with crosscontam 0.6603138626919602 and sim 0.8873606432570573
Collapsing 5 & 7 with crosscontam 0.6117647920165039 and sim 0.879982747435195
Collapsing 0 & 7 with crosscontam 0.7021383169934641 and sim 0.8704336570196349
Trimming eliminated 0 seqlets out of 561
Trimming eliminated 0 seqlets out of 725
Trimming eliminated 0 seqlets out of 861
Unmerged patterns remapping: OrderedDict([(1, 1), (2, 2), (3, 3), (4, 4), (8, 5)])
Time spent on merging iteration: 4.298096179962158
On merging iteration 2
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 1290 tasks      | elapsed:    0.6s
[Parallel(n_jobs=24)]: Done 1431 out of 1431 | elapsed:    0.7s finished
Numbers for each pattern pre-subsample: [861, 270, 234, 205, 200, 22]
Numbers after subsampling: [300, 270, 234, 205, 200, 22]
Computing sims for pattern 0
Computed sims for pattern 0 in 1.4472880363464355 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.285203218460083 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.2882378101348877 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.24949932098388672 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.24987173080444336 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.04982709884643555 s
Cluster sizes
[861 270 234 205 200  22]
Cross-contamination matrix:
[[1.   0.67 0.84 0.78 0.61 0.55]
 [0.59 1.   0.67 0.69 0.41 0.52]
 [0.52 0.24 1.   0.63 0.28 0.35]
 [0.56 0.57 0.72 1.   0.35 0.38]
 [0.8  0.74 0.66 0.69 1.   0.61]
 [0.33 0.39 0.39 0.35 0.25 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.72 0.82 0.79 0.8  0.73]
 [0.72 1.   0.7  0.76 0.76 0.74]
 [0.82 0.7  1.   0.74 0.71 0.65]
 [0.79 0.76 0.74 1.   0.76 0.71]
 [0.8  0.76 0.71 0.76 1.   0.78]
 [0.73 0.74 0.65 0.71 0.78 1.  ]]
Inspecting pattern 1 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 1431
[t-SNE] Computed conditional probabilities for sample 1431 / 1431
[t-SNE] Mean sigma: 0.354473
Beginning preprocessing + Leiden
2024-03-11 23:10:32.755024 MEMORY 13.350363136
Affmat transformed
2024-03-11 23:10:32.771397 MEMORY 13.350363136
sources, targets, weights extracted
2024-03-11 23:10:32.780499 MEMORY 13.350363136
About to launch parallel Leiden runs
2024-03-11 23:10:32.845950 MEMORY 13.350363136
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    3.6s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   11.6s finished
Parallel Leiden runs finished
2024-03-11 23:10:44.456925 MEMORY 13.350363136
Quality: 0.5437615336517005
Quality: 0.5438596065944047
Quality: 0.5440580044288715
Quality: 0.5441442662708468
Got subclusters: Counter({0: 316, 1: 310, 2: 216, 3: 195, 4: 172, 5: 117, 6: 105})
On merging iteration 1
Numbers for each pattern pre-subsample: [316, 310, 216, 195, 172, 117, 105]
Numbers after subsampling: [300, 300, 216, 195, 172, 117, 105]
Computing sims for pattern 0
Computed sims for pattern 0 in 1.8623664379119873 s
Computing sims for pattern 1
Computed sims for pattern 1 in 1.8120441436767578 s
Computing sims for pattern 2
Computed sims for pattern 2 in 1.5574700832366943 s
Computing sims for pattern 3
Computed sims for pattern 3 in 1.314500093460083 s
Computing sims for pattern 4
Computed sims for pattern 4 in 1.1081717014312744 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.8295338153839111 s
Computing sims for pattern 6
Computed sims for pattern 6 in 0.7459416389465332 s
Cluster sizes
[316 310 216 195 172 117 105]
Cross-contamination matrix:
[[1.   0.51 0.64 0.51 0.68 0.62 0.57]
 [0.25 1.   0.75 0.46 0.6  0.13 0.49]
 [0.32 0.75 1.   0.43 0.71 0.16 0.42]
 [0.42 0.7  0.69 1.   0.58 0.27 0.44]
 [0.4  0.67 0.79 0.4  1.   0.24 0.47]
 [0.51 0.28 0.33 0.3  0.41 1.   0.19]
 [0.6  0.77 0.79 0.56 0.78 0.28 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.57 0.72 0.64 0.74 0.73 0.68]
 [0.57 1.   0.78 0.72 0.8  0.49 0.73]
 [0.72 0.78 1.   0.75 0.86 0.63 0.72]
 [0.64 0.72 0.75 1.   0.72 0.59 0.7 ]
 [0.74 0.8  0.86 0.72 1.   0.7  0.72]
 [0.73 0.49 0.63 0.59 0.7  1.   0.51]
 [0.68 0.73 0.72 0.7  0.72 0.51 1.  ]]
Collapsing 2 & 4 with crosscontam 0.7064510809373632 and sim 0.8600830924568035
Trimming eliminated 0 seqlets out of 388
Unmerged patterns remapping: OrderedDict([(0, 1), (1, 2), (3, 3), (5, 4), (6, 5)])
Time spent on merging iteration: 1.3122692108154297
On merging iteration 2
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 1290 tasks      | elapsed:    0.5s
[Parallel(n_jobs=24)]: Done 1388 out of 1388 | elapsed:    0.7s finished
Numbers for each pattern pre-subsample: [388, 316, 310, 195, 117, 105]
Numbers after subsampling: [300, 300, 300, 195, 117, 105]
Computing sims for pattern 0
Computed sims for pattern 0 in 1.5886256694793701 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.33840465545654297 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.3344748020172119 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.2433490753173828 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.1524519920349121 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.12813806533813477 s
Cluster sizes
[388 316 310 195 117 105]
Cross-contamination matrix:
[[1.   0.51 0.72 0.6  0.31 0.61]
 [0.66 1.   0.51 0.51 0.62 0.57]
 [0.5  0.25 1.   0.46 0.13 0.49]
 [0.65 0.42 0.7  1.   0.27 0.44]
 [0.36 0.51 0.28 0.3  1.   0.19]
 [0.77 0.6  0.77 0.56 0.28 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.77 0.71 0.77 0.69 0.77]
 [0.77 1.   0.57 0.64 0.73 0.68]
 [0.71 0.57 1.   0.72 0.49 0.73]
 [0.77 0.64 0.72 1.   0.59 0.7 ]
 [0.69 0.73 0.49 0.59 1.   0.51]
 [0.77 0.68 0.73 0.7  0.51 1.  ]]
Inspecting pattern 2 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 1388
[t-SNE] Computed conditional probabilities for sample 1388 / 1388
[t-SNE] Mean sigma: 0.321619
Beginning preprocessing + Leiden
2024-03-11 23:10:59.690706 MEMORY 13.350371328
Affmat transformed
2024-03-11 23:10:59.707374 MEMORY 13.350371328
sources, targets, weights extracted
2024-03-11 23:10:59.718610 MEMORY 13.350371328
About to launch parallel Leiden runs
2024-03-11 23:10:59.770624 MEMORY 13.350371328
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    4.0s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   12.8s finished
Parallel Leiden runs finished
2024-03-11 23:11:12.532031 MEMORY 13.350371328
Quality: 0.439205679144536
Quality: 0.4408276308877711
Quality: 0.44163426296685343
Got subclusters: Counter({0: 307, 1: 237, 2: 174, 3: 173, 4: 136, 5: 113, 6: 97, 7: 83, 8: 68})
On merging iteration 1
Numbers for each pattern pre-subsample: [307, 237, 174, 173, 136, 113, 97, 83, 68]
Numbers after subsampling: [300, 237, 174, 173, 136, 113, 97, 83, 68]
Computing sims for pattern 0
Computed sims for pattern 0 in 2.1690170764923096 s
Computing sims for pattern 1
Computed sims for pattern 1 in 2.0441532135009766 s
Computing sims for pattern 2
Computed sims for pattern 2 in 1.392150640487671 s
Computing sims for pattern 3
Computed sims for pattern 3 in 1.3547649383544922 s
Computing sims for pattern 4
Computed sims for pattern 4 in 1.1259264945983887 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.9252407550811768 s
Computing sims for pattern 6
Computed sims for pattern 6 in 0.6996102333068848 s
Computing sims for pattern 7
Computed sims for pattern 7 in 0.7163741588592529 s
Computing sims for pattern 8
Computed sims for pattern 8 in 0.6020591259002686 s
Cluster sizes
[307 237 174 173 136 113  97  83  68]
Cross-contamination matrix:
[[1.   0.71 0.73 0.85 0.49 0.5  0.78 0.61 0.51]
 [0.62 1.   0.59 0.74 0.42 0.66 0.77 0.57 0.5 ]
 [0.75 0.7  1.   0.83 0.5  0.54 0.88 0.76 0.47]
 [0.52 0.53 0.46 1.   0.26 0.47 0.73 0.45 0.36]
 [0.82 0.85 0.81 0.9  1.   0.71 1.   0.81 0.7 ]
 [0.42 0.69 0.44 0.72 0.33 1.   0.65 0.37 0.49]
 [0.47 0.44 0.52 0.73 0.31 0.41 1.   0.45 0.36]
 [0.55 0.52 0.72 0.74 0.4  0.39 0.71 1.   0.35]
 [0.63 0.73 0.56 0.81 0.55 0.68 0.79 0.52 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.83 0.85 0.85 0.78 0.63 0.78 0.77 0.77]
 [0.83 1.   0.81 0.78 0.86 0.79 0.77 0.77 0.79]
 [0.85 0.81 1.   0.86 0.89 0.73 0.93 0.86 0.71]
 [0.85 0.78 0.86 1.   0.84 0.78 0.87 0.91 0.72]
 [0.78 0.86 0.89 0.84 1.   0.65 0.84 0.85 0.78]
 [0.63 0.79 0.73 0.78 0.65 1.   0.71 0.71 0.69]
 [0.78 0.77 0.93 0.87 0.84 0.71 1.   0.86 0.71]
 [0.77 0.77 0.86 0.91 0.85 0.71 0.86 1.   0.7 ]
 [0.77 0.79 0.71 0.72 0.78 0.69 0.71 0.7  1.  ]]
Collapsing 2 & 6 with crosscontam 0.5223008011417667 and sim 0.9269945339077412
Collapsing 3 & 7 with crosscontam 0.44650349234837794 and sim 0.9055203007927597
Collapsing 3 & 6 with crosscontam 0.7314507271276445 and sim 0.8697491507487006
Collapsing 2 & 7 with crosscontam 0.715448757755204 and sim 0.8584125846491982
Collapsing 0 & 2 with crosscontam 0.7328386394210302 and sim 0.8538392505408985
Collapsing 0 & 3 with crosscontam 0.5173358682987115 and sim 0.8535933620750302
Trimming eliminated 0 seqlets out of 271
Trimming eliminated 0 seqlets out of 256
Trimming eliminated 0 seqlets out of 527
Trimming eliminated 0 seqlets out of 834
Unmerged patterns remapping: OrderedDict([(1, 1), (4, 2), (5, 3), (8, 4)])
Time spent on merging iteration: 4.313125133514404
On merging iteration 2
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 741 out of 741 | elapsed:    0.2s finished
Numbers for each pattern pre-subsample: [834, 237, 136, 113, 68]
Numbers after subsampling: [300, 237, 136, 113, 68]
Computing sims for pattern 0
Computed sims for pattern 0 in 1.121293067932129 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.3088374137878418 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.17818737030029297 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.14818310737609863 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.09591436386108398 s
Cluster sizes
[834 237 136 113  68]
Cross-contamination matrix:
[[1.   0.8  0.68 0.78 0.73]
 [0.59 1.   0.42 0.66 0.5 ]
 [0.8  0.85 1.   0.71 0.7 ]
 [0.5  0.69 0.33 1.   0.49]
 [0.64 0.73 0.55 0.68 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.81 0.85 0.76 0.78]
 [0.81 1.   0.86 0.79 0.79]
 [0.85 0.86 1.   0.65 0.78]
 [0.76 0.79 0.65 1.   0.69]
 [0.78 0.79 0.78 0.69 1.  ]]
Inspecting pattern 3 for spurious merging
[t-SNE] Computed conditional probabilities for sample 741 / 741
[t-SNE] Mean sigma: 0.380929
Beginning preprocessing + Leiden
2024-03-11 23:11:30.460634 MEMORY 13.350371328
Affmat transformed
2024-03-11 23:11:30.469649 MEMORY 13.350371328
sources, targets, weights extracted
2024-03-11 23:11:30.474815 MEMORY 13.350371328
About to launch parallel Leiden runs
2024-03-11 23:11:30.779844 MEMORY 13.350371328
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    2.0s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    6.7s finished
Parallel Leiden runs finished
2024-03-11 23:11:37.476877 MEMORY 13.350371328
Quality: 0.42067717246651093
Quality: 0.42801962866893634
Quality: 0.4280801167338765
Got subclusters: Counter({0: 127, 1: 119, 2: 118, 3: 116, 4: 114, 5: 95, 6: 48, 7: 4})
On merging iteration 1
Numbers for each pattern pre-subsample: [127, 119, 118, 116, 114, 95, 48, 4]
Numbers after subsampling: [127, 119, 118, 116, 114, 95, 48, 4]
Computing sims for pattern 0
Computed sims for pattern 0 in 0.869196891784668 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.8120577335357666 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.7869899272918701 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.7642629146575928 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.7896106243133545 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.6578569412231445 s
Computing sims for pattern 6
Computed sims for pattern 6 in 0.3479773998260498 s
Computing sims for pattern 7
Computed sims for pattern 7 in 0.09150314331054688 s
Cluster sizes
[127 119 118 116 114  95  48   4]
Cross-contamination matrix:
[[1.   0.38 0.24 0.2  0.23 0.62 0.38 0.07]
 [0.69 1.   0.52 0.56 0.52 0.87 0.48 0.21]
 [0.66 0.7  1.   0.68 0.67 0.67 0.67 0.33]
 [0.59 0.73 0.63 1.   0.69 0.84 0.69 0.34]
 [0.55 0.59 0.55 0.59 1.   0.86 0.72 0.33]
 [0.69 0.6  0.27 0.42 0.51 1.   0.62 0.16]
 [0.74 0.49 0.53 0.54 0.66 0.9  1.   0.22]
 [0.12 0.13 0.12 0.13 0.17 0.16 0.14 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.69 0.67 0.63 0.79 0.82 0.78 0.39]
 [0.69 1.   0.55 0.64 0.75 0.86 0.61 0.38]
 [0.67 0.55 1.   0.63 0.69 0.66 0.69 0.37]
 [0.63 0.64 0.63 1.   0.72 0.74 0.73 0.37]
 [0.79 0.75 0.69 0.72 1.   0.84 0.8  0.44]
 [0.82 0.86 0.66 0.74 0.84 1.   0.83 0.42]
 [0.78 0.61 0.69 0.73 0.8  0.83 1.   0.37]
 [0.39 0.38 0.37 0.37 0.44 0.42 0.37 1.  ]]
Collapsing 1 & 5 with crosscontam 0.5965567462733745 and sim 0.855102866568092
Trimming eliminated 0 seqlets out of 214
Unmerged patterns remapping: OrderedDict([(0, 1), (2, 2), (3, 3), (4, 4), (6, 5), (7, 6)])
Time spent on merging iteration: 0.36005568504333496
On merging iteration 2
Numbers for each pattern pre-subsample: [214, 127, 118, 116, 114, 48, 4]
Numbers after subsampling: [214, 127, 118, 116, 114, 48, 4]
Computing sims for pattern 0
Computed sims for pattern 0 in 1.304746150970459 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.15752100944519043 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.14344263076782227 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.14647936820983887 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.13883304595947266 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.06621909141540527 s
Computing sims for pattern 6
Computed sims for pattern 6 in 0.02266979217529297 s
Cluster sizes
[214 127 118 116 114  48   4]
Cross-contamination matrix:
[[1.   0.85 0.56 0.61 0.66 0.67 0.27]
 [0.5  1.   0.24 0.2  0.23 0.38 0.07]
 [0.73 0.66 1.   0.68 0.67 0.67 0.33]
 [0.78 0.59 0.63 1.   0.69 0.69 0.34]
 [0.73 0.55 0.55 0.59 1.   0.72 0.33]
 [0.67 0.74 0.53 0.54 0.66 1.   0.22]
 [0.15 0.12 0.12 0.13 0.17 0.14 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.8  0.63 0.72 0.84 0.74 0.43]
 [0.8  1.   0.67 0.63 0.79 0.78 0.39]
 [0.63 0.67 1.   0.63 0.69 0.69 0.37]
 [0.72 0.63 0.63 1.   0.72 0.73 0.37]
 [0.84 0.79 0.69 0.72 1.   0.8  0.44]
 [0.74 0.78 0.69 0.73 0.8  1.   0.37]
 [0.43 0.39 0.37 0.37 0.44 0.37 1.  ]]
Merging on 24 clusters
2024-03-11 23:11:45.000273 MEMORY 13.350371328
On merging iteration 1
Numbers for each pattern pre-subsample: [861, 270, 234, 205, 200, 22, 388, 316, 310, 195, 117, 105, 834, 237, 136, 113, 68, 214, 127, 118, 116, 114, 48, 4]
Numbers after subsampling: [300, 270, 234, 205, 200, 22, 300, 300, 300, 195, 117, 105, 300, 237, 136, 113, 68, 214, 127, 118, 116, 114, 48, 4]
Computing sims for pattern 0
Computed sims for pattern 0 in 6.9070868492126465 s
Computing sims for pattern 1
Computed sims for pattern 1 in 5.7938148975372314 s
Computing sims for pattern 2
Computed sims for pattern 2 in 6.12586522102356 s
Computing sims for pattern 3
Computed sims for pattern 3 in 5.324944496154785 s
Computing sims for pattern 4
Computed sims for pattern 4 in 6.552632093429565 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.7823202610015869 s
Computing sims for pattern 6
Computed sims for pattern 6 in 7.339721918106079 s
Computing sims for pattern 7
Computed sims for pattern 7 in 7.374226093292236 s
Computing sims for pattern 8
Computed sims for pattern 8 in 7.079237461090088 s
Computing sims for pattern 9
Computed sims for pattern 9 in 4.955258846282959 s
Computing sims for pattern 10
Computed sims for pattern 10 in 3.0329384803771973 s
Computing sims for pattern 11
Computed sims for pattern 11 in 2.638857841491699 s
Computing sims for pattern 12
Computed sims for pattern 12 in 6.90473484992981 s
Computing sims for pattern 13
Computed sims for pattern 13 in 6.143809080123901 s
Computing sims for pattern 14
Computed sims for pattern 14 in 3.4696531295776367 s
Computing sims for pattern 15
Computed sims for pattern 15 in 2.8635520935058594 s
Computing sims for pattern 16
Computed sims for pattern 16 in 3.5952258110046387 s
Computing sims for pattern 17
Computed sims for pattern 17 in 5.43994402885437 s
Computing sims for pattern 18
Computed sims for pattern 18 in 3.1135966777801514 s
Computing sims for pattern 19
Computed sims for pattern 19 in 2.9057095050811768 s
Computing sims for pattern 20
Computed sims for pattern 20 in 2.8155477046966553 s
Computing sims for pattern 21
Computed sims for pattern 21 in 2.75719952583313 s
Computing sims for pattern 22
Computed sims for pattern 22 in 1.3618056774139404 s
Computing sims for pattern 23
Computed sims for pattern 23 in 0.4209628105163574 s
Cluster sizes
[861 270 234 205 200  22 388 316 310 195 117 105 834 237 136 113  68 214
 127 118 116 114  48   4]
Cross-contamination matrix:
[[1.   0.67 0.84 0.78 0.61 0.55 0.2  0.15 0.38 0.39 0.12 0.34 0.57 0.74
  0.47 0.48 0.54 0.12 0.03 0.26 0.16 0.13 0.04 0.08]
 [0.59 1.   0.67 0.69 0.41 0.52 0.14 0.11 0.19 0.2  0.12 0.13 0.35 0.49
  0.16 0.75 0.29 0.08 0.02 0.26 0.21 0.1  0.02 0.09]
 [0.52 0.24 1.   0.63 0.28 0.35 0.06 0.09 0.17 0.13 0.02 0.11 0.26 0.24
  0.18 0.22 0.23 0.05 0.01 0.12 0.14 0.04 0.01 0.03]
 [0.56 0.57 0.72 1.   0.35 0.38 0.04 0.05 0.1  0.11 0.02 0.1  0.21 0.29
  0.12 0.27 0.15 0.07 0.02 0.16 0.17 0.05 0.02 0.04]
 [0.8  0.74 0.66 0.69 1.   0.61 0.33 0.35 0.3  0.45 0.2  0.43 0.37 0.45
  0.39 0.52 0.69 0.13 0.04 0.32 0.25 0.17 0.07 0.17]
 [0.33 0.39 0.39 0.35 0.25 1.   0.05 0.06 0.06 0.1  0.01 0.18 0.12 0.21
  0.07 0.16 0.18 0.01 0.   0.09 0.08 0.02 0.01 0.  ]
 [0.24 0.26 0.23 0.2  0.27 0.21 1.   0.51 0.72 0.6  0.31 0.61 0.33 0.36
  0.22 0.34 0.29 0.09 0.02 0.12 0.14 0.07 0.07 0.12]
 [0.24 0.26 0.31 0.18 0.36 0.17 0.66 1.   0.51 0.51 0.62 0.57 0.18 0.31
  0.2  0.25 0.36 0.05 0.   0.1  0.1  0.09 0.03 0.32]
 [0.28 0.18 0.26 0.12 0.13 0.08 0.5  0.25 1.   0.46 0.13 0.49 0.53 0.43
  0.3  0.35 0.33 0.07 0.01 0.09 0.12 0.1  0.02 0.04]
 [0.47 0.32 0.34 0.27 0.38 0.25 0.65 0.42 0.7  1.   0.27 0.44 0.38 0.32
  0.26 0.27 0.33 0.06 0.01 0.16 0.08 0.14 0.05 0.09]
 [0.17 0.25 0.16 0.14 0.19 0.1  0.36 0.51 0.28 0.3  1.   0.19 0.16 0.18
  0.17 0.22 0.17 0.07 0.04 0.12 0.11 0.12 0.07 0.75]
 [0.57 0.41 0.42 0.33 0.47 0.49 0.77 0.6  0.77 0.56 0.28 1.   0.52 0.76
  0.43 0.54 0.59 0.11 0.02 0.15 0.08 0.15 0.05 0.17]
 [0.67 0.49 0.42 0.41 0.36 0.28 0.38 0.18 0.76 0.39 0.13 0.46 1.   0.8
  0.68 0.78 0.73 0.35 0.12 0.25 0.26 0.16 0.13 0.09]
 [0.54 0.36 0.59 0.32 0.21 0.19 0.2  0.1  0.36 0.14 0.05 0.36 0.59 1.
  0.42 0.66 0.5  0.11 0.02 0.1  0.1  0.03 0.02 0.02]
 [0.68 0.48 0.54 0.37 0.4  0.23 0.3  0.2  0.59 0.33 0.17 0.47 0.8  0.85
  1.   0.71 0.7  0.16 0.06 0.27 0.25 0.21 0.09 0.21]
 [0.25 0.63 0.32 0.27 0.23 0.18 0.14 0.13 0.3  0.13 0.08 0.21 0.5  0.69
  0.33 1.   0.49 0.13 0.02 0.15 0.09 0.04 0.01 0.04]
 [0.56 0.38 0.52 0.43 0.56 0.34 0.22 0.22 0.43 0.25 0.07 0.41 0.64 0.73
  0.55 0.68 1.   0.16 0.02 0.14 0.15 0.07 0.03 0.03]
 [0.2  0.21 0.16 0.19 0.13 0.06 0.14 0.08 0.19 0.11 0.08 0.13 0.45 0.34
  0.19 0.33 0.29 1.   0.85 0.56 0.61 0.66 0.67 0.27]
 [0.01 0.02 0.02 0.02 0.01 0.01 0.   0.   0.01 0.   0.01 0.   0.05 0.03
  0.02 0.03 0.02 0.5  1.   0.24 0.2  0.23 0.38 0.07]
 [0.48 0.35 0.42 0.43 0.39 0.37 0.14 0.22 0.29 0.33 0.22 0.23 0.33 0.41
  0.42 0.36 0.2  0.73 0.66 1.   0.68 0.67 0.67 0.33]
 [0.36 0.49 0.54 0.5  0.31 0.31 0.26 0.2  0.33 0.18 0.21 0.15 0.41 0.34
  0.35 0.36 0.3  0.78 0.59 0.63 1.   0.69 0.69 0.34]
 [0.18 0.24 0.2  0.12 0.19 0.08 0.09 0.1  0.23 0.2  0.13 0.16 0.24 0.16
  0.23 0.17 0.18 0.73 0.55 0.55 0.59 1.   0.72 0.33]
 [0.07 0.08 0.09 0.12 0.07 0.07 0.1  0.04 0.03 0.05 0.08 0.06 0.18 0.12
  0.09 0.09 0.09 0.67 0.74 0.53 0.54 0.66 1.   0.22]
 [0.1  0.15 0.11 0.12 0.12 0.03 0.13 0.17 0.12 0.1  0.4  0.1  0.05 0.08
  0.13 0.09 0.08 0.15 0.12 0.12 0.13 0.17 0.14 1.  ]]
Pattern-to-pattern sim matrix:
[[ 1.    0.72  0.82  0.79  0.8   0.73  0.46  0.41  0.63  0.75  0.3   0.72
   0.71  0.78  0.8   0.54  0.69  0.09 -0.07  0.34  0.2   0.15  0.02  0.31]
 [ 0.72  1.    0.7   0.76  0.76  0.74  0.54  0.48  0.51  0.65  0.51  0.6
   0.55  0.62  0.54  0.8   0.55  0.12  0.01  0.48  0.31  0.17  0.04  0.42]
 [ 0.82  0.7   1.    0.74  0.71  0.65  0.4   0.5   0.51  0.55  0.3   0.58
   0.51  0.65  0.57  0.6   0.66  0.09 -0.06  0.43  0.28  0.11  0.03  0.35]
 [ 0.79  0.76  0.74  1.    0.76  0.71  0.38  0.39  0.41  0.57  0.33  0.54
   0.46  0.56  0.53  0.64  0.64  0.21  0.01  0.46  0.32  0.09  0.12  0.38]
 [ 0.8   0.76  0.71  0.76  1.    0.78  0.51  0.52  0.4   0.69  0.37  0.68
   0.46  0.54  0.58  0.62  0.73  0.05 -0.08  0.47  0.26  0.1   0.01  0.39]
 [ 0.73  0.74  0.65  0.71  0.78  1.    0.47  0.39  0.43  0.56  0.4   0.69
   0.45  0.61  0.57  0.65  0.71  0.07  0.01  0.41  0.17  0.08  0.05  0.33]
 [ 0.46  0.54  0.4   0.38  0.51  0.47  1.    0.77  0.71  0.77  0.69  0.77
   0.59  0.61  0.5   0.68  0.5   0.08 -0.14  0.16  0.12  0.06 -0.04  0.36]
 [ 0.41  0.48  0.5   0.39  0.52  0.39  0.77  1.    0.57  0.64  0.73  0.68
   0.28  0.44  0.42  0.56  0.51  0.01 -0.16  0.22  0.13  0.02 -0.02  0.54]
 [ 0.63  0.51  0.51  0.41  0.4   0.43  0.71  0.57  1.    0.72  0.49  0.73
   0.79  0.7   0.78  0.68  0.61  0.15 -0.1   0.16  0.22  0.11  0.03  0.27]
 [ 0.75  0.65  0.55  0.57  0.69  0.56  0.77  0.64  0.72  1.    0.59  0.7
   0.55  0.53  0.64  0.56  0.56  0.02 -0.2   0.29  0.1   0.07 -0.01  0.34]
 [ 0.3   0.51  0.3   0.33  0.37  0.4   0.69  0.73  0.49  0.59  1.    0.51
   0.27  0.4   0.34  0.51  0.34  0.07  0.07  0.2   0.17  0.2   0.11  0.66]
 [ 0.72  0.6   0.58  0.54  0.68  0.69  0.77  0.68  0.73  0.7   0.51  1.
   0.64  0.82  0.77  0.68  0.74  0.12 -0.14  0.22  0.05  0.11 -0.03  0.4 ]
 [ 0.71  0.55  0.51  0.46  0.46  0.45  0.59  0.28  0.79  0.55  0.27  0.64
   1.    0.81  0.85  0.76  0.78  0.44  0.1   0.17  0.27  0.26  0.21  0.13]
 [ 0.78  0.62  0.65  0.56  0.54  0.61  0.61  0.44  0.7   0.53  0.4   0.82
   0.81  1.    0.86  0.79  0.79  0.32  0.08  0.21  0.33  0.17  0.15  0.33]
 [ 0.8   0.54  0.57  0.53  0.58  0.57  0.5   0.42  0.78  0.64  0.34  0.77
   0.85  0.86  1.    0.65  0.78  0.18  0.01  0.28  0.28  0.11  0.06  0.31]
 [ 0.54  0.8   0.6   0.64  0.62  0.65  0.68  0.56  0.68  0.56  0.51  0.68
   0.76  0.79  0.65  1.    0.69  0.31  0.07  0.31  0.27  0.24  0.11  0.3 ]
 [ 0.69  0.55  0.66  0.64  0.73  0.71  0.5   0.51  0.61  0.56  0.34  0.74
   0.78  0.79  0.78  0.69  1.    0.35  0.1   0.22  0.31  0.26  0.19  0.33]
 [ 0.09  0.12  0.09  0.21  0.05  0.07  0.08  0.01  0.15  0.02  0.07  0.12
   0.44  0.32  0.18  0.31  0.35  1.    0.8   0.63  0.72  0.84  0.74  0.43]
 [-0.07  0.01 -0.06  0.01 -0.08  0.01 -0.14 -0.16 -0.1  -0.2   0.07 -0.14
   0.1   0.08  0.01  0.07  0.1   0.8   1.    0.67  0.63  0.79  0.78  0.39]
 [ 0.34  0.48  0.43  0.46  0.47  0.41  0.16  0.22  0.16  0.29  0.2   0.22
   0.17  0.21  0.28  0.31  0.22  0.63  0.67  1.    0.63  0.69  0.69  0.37]
 [ 0.2   0.31  0.28  0.32  0.26  0.17  0.12  0.13  0.22  0.1   0.17  0.05
   0.27  0.33  0.28  0.27  0.31  0.72  0.63  0.63  1.    0.72  0.73  0.37]
 [ 0.15  0.17  0.11  0.09  0.1   0.08  0.06  0.02  0.11  0.07  0.2   0.11
   0.26  0.17  0.11  0.24  0.26  0.84  0.79  0.69  0.72  1.    0.8   0.44]
 [ 0.02  0.04  0.03  0.12  0.01  0.05 -0.04 -0.02  0.03 -0.01  0.11 -0.03
   0.21  0.15  0.06  0.11  0.19  0.74  0.78  0.69  0.73  0.8   1.    0.37]
 [ 0.31  0.42  0.35  0.38  0.39  0.33  0.36  0.54  0.27  0.34  0.66  0.4
   0.13  0.33  0.31  0.3   0.33  0.43  0.39  0.37  0.37  0.44  0.37  1.  ]]
Got 24 patterns after merging
2024-03-11 23:13:31.413960 MEMORY 13.350371328
Performing filtering
2024-03-11 23:13:31.414142 MEMORY 13.350371328
Got 22 patterns after filtering
2024-03-11 23:13:32.154938 MEMORY 13.350371328
Total time taken is 700.35s
2024-03-11 23:13:32.155110 MEMORY 13.350371328
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 861 out of 861 | elapsed:    0.3s finished
/ru-auth/local/home/lzhao/anaconda3/envs/jupyter-ml-clone/lib/python3.9/site-packages/sklearn/manifold/_t_sne.py:691: FutureWarning: 'square_distances' has been introduced in 0.24 to help phase out legacy squaring behavior. The 'legacy' setting will be removed in 1.1 (renaming of 0.26), and the default setting will be changed to True. In 1.3, 'square_distances' will be removed altogether, and distances will be squared by default. Set 'square_distances'=True to silence this warning.
  warnings.warn(
/ru-auth/local/home/lzhao/anaconda3/envs/jupyter-ml-clone/lib/python3.9/site-packages/sklearn/neighbors/_base.py:175: EfficiencyWarning: Precomputed sparse input was not sorted by data.
  warnings.warn('Precomputed sparse input was not sorted by data.',
Applying subclustering to the final motifs
On pattern 0
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 861 samples in 0.006s...
[t-SNE] Computed neighbors for 861 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 861 / 861
[t-SNE] Mean sigma: 0.326374
[t-SNE] Computed conditional probabilities in 0.059s
[t-SNE] Iteration 50: error = 67.4559250, gradient norm = 0.3502193 (50 iterations in 2.036s)
[t-SNE] Iteration 100: error = 66.9715271, gradient norm = 0.3528374 (50 iterations in 1.662s)
[t-SNE] Iteration 150: error = 68.6321487, gradient norm = 0.3224846 (50 iterations in 1.326s)
[t-SNE] Iteration 200: error = 68.7437820, gradient norm = 0.3266603 (50 iterations in 1.386s)
[t-SNE] Iteration 250: error = 69.2108078, gradient norm = 0.3154457 (50 iterations in 2.055s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 69.210808
[t-SNE] Iteration 300: error = 1.7688128, gradient norm = 0.0022551 (50 iterations in 1.940s)
[t-SNE] Iteration 350: error = 1.6615984, gradient norm = 0.0017664 (50 iterations in 1.764s)
[t-SNE] Iteration 400: error = 1.6430142, gradient norm = 0.0002507 (50 iterations in 2.043s)
[t-SNE] Iteration 450: error = 1.6337039, gradient norm = 0.0003330 (50 iterations in 2.039s)
[t-SNE] Iteration 500: error = 1.6257688, gradient norm = 0.0002571 (50 iterations in 2.040s)
[t-SNE] Iteration 550: error = 1.6221554, gradient norm = 0.0001394 (50 iterations in 2.095s)
[t-SNE] Iteration 600: error = 1.6203296, gradient norm = 0.0000982 (50 iterations in 2.035s)
[t-SNE] Iteration 650: error = 1.6184316, gradient norm = 0.0001346 (50 iterations in 2.037s)
[t-SNE] Iteration 700: error = 1.6168505, gradient norm = 0.0001129 (50 iterations in 2.031s)
[t-SNE] Iteration 750: error = 1.6164175, gradient norm = 0.0000524 (50 iterations in 2.070s)
[t-SNE] Iteration 800: error = 1.6151507, gradient norm = 0.0001368 (50 iterations in 2.031s)
[t-SNE] Iteration 850: error = 1.6130977, gradient norm = 0.0003950 (50 iterations in 2.032s)
[t-SNE] Iteration 900: error = 1.6113371, gradient norm = 0.0001309 (50 iterations in 2.035s)
[t-SNE] Iteration 950: error = 1.6102968, gradient norm = 0.0001264 (50 iterations in 1.618s)
[t-SNE] Iteration 1000: error = 1.6089978, gradient norm = 0.0001006 (50 iterations in 2.032s)
[t-SNE] KL divergence after 1000 iterations: 1.608998
[t-SNE] Computed conditional probabilities for sample 861 / 861
[t-SNE] Mean sigma: 0.326374
Beginning preprocessing + Leiden
2024-03-11 23:14:11.737530 MEMORY 13.350371328
Affmat transformed
2024-03-11 23:14:11.748625 MEMORY 13.350371328
sources, targets, weights extracted
2024-03-11 23:14:11.755382 MEMORY 13.350371328
About to launch parallel Leiden runs
2024-03-11 23:14:11.799496 MEMORY 13.350371328
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    2.6s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    7.4s finished
Parallel Leiden runs finished
2024-03-11 23:14:19.209971 MEMORY 13.350371328
Quality: 0.4169713682253669
Quality: 0.4210616155936553
Quality: 0.4212785636851817
Quality: 0.4215657903219237
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 834 out of 834 | elapsed:    0.3s finished
Got subclusters: Counter({0: 174, 1: 137, 2: 133, 3: 117, 4: 96, 5: 84, 6: 73, 7: 47})
On pattern 1
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 834 samples in 0.006s...
[t-SNE] Computed neighbors for 834 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 834 / 834
[t-SNE] Mean sigma: 0.329259
[t-SNE] Computed conditional probabilities in 0.057s
[t-SNE] Iteration 50: error = 68.1988525, gradient norm = 0.3553509 (50 iterations in 2.039s)
[t-SNE] Iteration 100: error = 69.4104919, gradient norm = 0.3331901 (50 iterations in 2.040s)
[t-SNE] Iteration 150: error = 69.9359589, gradient norm = 0.3257129 (50 iterations in 2.040s)
[t-SNE] Iteration 200: error = 70.6676331, gradient norm = 0.3238674 (50 iterations in 2.042s)
[t-SNE] Iteration 250: error = 71.6014099, gradient norm = 0.3078685 (50 iterations in 2.050s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 71.601410
[t-SNE] Iteration 300: error = 1.6884586, gradient norm = 0.0027893 (50 iterations in 2.017s)
[t-SNE] Iteration 350: error = 1.6374444, gradient norm = 0.0007149 (50 iterations in 1.253s)
[t-SNE] Iteration 400: error = 1.6159469, gradient norm = 0.0004765 (50 iterations in 1.600s)
[t-SNE] Iteration 450: error = 1.6081780, gradient norm = 0.0002388 (50 iterations in 2.034s)
[t-SNE] Iteration 500: error = 1.6026939, gradient norm = 0.0002311 (50 iterations in 2.034s)
[t-SNE] Iteration 550: error = 1.6009524, gradient norm = 0.0000986 (50 iterations in 2.035s)
[t-SNE] Iteration 600: error = 1.5994492, gradient norm = 0.0001249 (50 iterations in 2.031s)
[t-SNE] Iteration 650: error = 1.5978733, gradient norm = 0.0001425 (50 iterations in 2.030s)
[t-SNE] Iteration 700: error = 1.5965675, gradient norm = 0.0000784 (50 iterations in 2.034s)
[t-SNE] Iteration 750: error = 1.5955683, gradient norm = 0.0001419 (50 iterations in 2.039s)
[t-SNE] Iteration 800: error = 1.5949472, gradient norm = 0.0001046 (50 iterations in 2.039s)
[t-SNE] Iteration 850: error = 1.5944914, gradient norm = 0.0000841 (50 iterations in 2.041s)
[t-SNE] Iteration 900: error = 1.5939522, gradient norm = 0.0001297 (50 iterations in 2.041s)
[t-SNE] Iteration 950: error = 1.5925975, gradient norm = 0.0001071 (50 iterations in 2.034s)
[t-SNE] Iteration 1000: error = 1.5910978, gradient norm = 0.0001267 (50 iterations in 2.035s)
[t-SNE] KL divergence after 1000 iterations: 1.591098
[t-SNE] Computed conditional probabilities for sample 834 / 834
[t-SNE] Mean sigma: 0.329259
Beginning preprocessing + Leiden
2024-03-11 23:15:00.105106 MEMORY 13.350371328
Affmat transformed
2024-03-11 23:15:00.116602 MEMORY 13.350371328
sources, targets, weights extracted
2024-03-11 23:15:00.124049 MEMORY 13.350371328
About to launch parallel Leiden runs
2024-03-11 23:15:00.196630 MEMORY 13.350371328
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    2.4s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    7.9s finished
Parallel Leiden runs finished
2024-03-11 23:15:08.146836 MEMORY 13.350371328
Quality: 0.4281720744674728
Quality: 0.42930984736381755
Quality: 0.42940517569434805
Quality: 0.43029789410247987
Quality: 0.430681448341953
Quality: 0.4307188125604384
Quality: 0.4309089582747299
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 388 out of 388 | elapsed:    0.1s finished
Got subclusters: Counter({0: 164, 1: 161, 2: 126, 3: 124, 4: 107, 5: 104, 6: 48})
On pattern 2
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 388 samples in 0.003s...
[t-SNE] Computed neighbors for 388 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 388 / 388
[t-SNE] Mean sigma: 0.372567
[t-SNE] Computed conditional probabilities in 0.026s
[t-SNE] Iteration 50: error = 64.4361191, gradient norm = 0.4995205 (50 iterations in 2.027s)
[t-SNE] Iteration 100: error = 66.3588562, gradient norm = 0.4838324 (50 iterations in 2.025s)
[t-SNE] Iteration 150: error = 67.3143692, gradient norm = 0.4748280 (50 iterations in 2.032s)
[t-SNE] Iteration 200: error = 66.4323883, gradient norm = 0.4703289 (50 iterations in 2.026s)
[t-SNE] Iteration 250: error = 66.7163849, gradient norm = 0.5118457 (50 iterations in 2.029s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 66.716385
[t-SNE] Iteration 300: error = 1.2887498, gradient norm = 0.0033557 (50 iterations in 2.029s)
[t-SNE] Iteration 350: error = 1.2179874, gradient norm = 0.0015938 (50 iterations in 2.034s)
[t-SNE] Iteration 400: error = 1.1871132, gradient norm = 0.0014289 (50 iterations in 2.015s)
[t-SNE] Iteration 450: error = 1.1541728, gradient norm = 0.0016536 (50 iterations in 0.875s)
[t-SNE] Iteration 500: error = 1.1445199, gradient norm = 0.0009161 (50 iterations in 1.105s)
[t-SNE] Iteration 550: error = 1.1381952, gradient norm = 0.0004388 (50 iterations in 1.311s)
[t-SNE] Iteration 600: error = 1.1299392, gradient norm = 0.0006732 (50 iterations in 2.025s)
[t-SNE] Iteration 650: error = 1.1292536, gradient norm = 0.0000762 (50 iterations in 2.027s)
[t-SNE] Iteration 700: error = 1.1292235, gradient norm = 0.0000431 (50 iterations in 2.033s)
[t-SNE] Iteration 750: error = 1.1291496, gradient norm = 0.0000241 (50 iterations in 2.036s)
[t-SNE] Iteration 800: error = 1.1291051, gradient norm = 0.0000214 (50 iterations in 2.026s)
[t-SNE] Iteration 850: error = 1.1290659, gradient norm = 0.0000432 (50 iterations in 2.024s)
[t-SNE] Iteration 900: error = 1.1290877, gradient norm = 0.0000542 (50 iterations in 2.029s)
[t-SNE] Iteration 950: error = 1.1290932, gradient norm = 0.0000534 (50 iterations in 2.032s)
[t-SNE] Iteration 1000: error = 1.1290948, gradient norm = 0.0000376 (50 iterations in 2.033s)
[t-SNE] KL divergence after 1000 iterations: 1.129095
[t-SNE] Computed conditional probabilities for sample 388 / 388
[t-SNE] Mean sigma: 0.372567
Beginning preprocessing + Leiden
2024-03-11 23:15:46.618345 MEMORY 13.350371328
Affmat transformed
2024-03-11 23:15:46.623635 MEMORY 13.350371328
sources, targets, weights extracted
2024-03-11 23:15:46.626103 MEMORY 13.350371328
About to launch parallel Leiden runs
2024-03-11 23:15:46.647992 MEMORY 13.350371328
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.1s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    3.6s finished
Parallel Leiden runs finished
2024-03-11 23:15:50.239702 MEMORY 13.350371328
Quality: 0.381121721982651
Quality: 0.3868587971712017
Quality: 0.3878332414086358
Quality: 0.38987392352126893
Quality: 0.3900850952534727
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 316 out of 316 | elapsed:    0.1s finished
Got subclusters: Counter({0: 84, 1: 79, 2: 74, 3: 59, 4: 48, 5: 44})
On pattern 3
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 316 samples in 0.002s...
[t-SNE] Computed neighbors for 316 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 316 / 316
[t-SNE] Mean sigma: 0.399502
[t-SNE] Computed conditional probabilities in 0.021s
[t-SNE] Iteration 50: error = 61.9727859, gradient norm = 0.5260312 (50 iterations in 2.026s)
[t-SNE] Iteration 100: error = 62.3702431, gradient norm = 0.5077624 (50 iterations in 2.038s)
[t-SNE] Iteration 150: error = 63.1026306, gradient norm = 0.5071614 (50 iterations in 2.026s)
[t-SNE] Iteration 200: error = 62.3942451, gradient norm = 0.5159199 (50 iterations in 2.092s)
[t-SNE] Iteration 250: error = 62.4727364, gradient norm = 0.5226778 (50 iterations in 0.996s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 62.472736
[t-SNE] Iteration 300: error = 1.0839640, gradient norm = 0.0048569 (50 iterations in 1.592s)
[t-SNE] Iteration 350: error = 0.9548751, gradient norm = 0.0024752 (50 iterations in 2.020s)
[t-SNE] Iteration 400: error = 0.9090955, gradient norm = 0.0012693 (50 iterations in 2.059s)
[t-SNE] Iteration 450: error = 0.8928786, gradient norm = 0.0008043 (50 iterations in 2.064s)
[t-SNE] Iteration 500: error = 0.8794539, gradient norm = 0.0009171 (50 iterations in 2.027s)
[t-SNE] Iteration 550: error = 0.8749647, gradient norm = 0.0001981 (50 iterations in 2.027s)
[t-SNE] Iteration 600: error = 0.8698933, gradient norm = 0.0011576 (50 iterations in 2.029s)
[t-SNE] Iteration 650: error = 0.8680834, gradient norm = 0.0003721 (50 iterations in 2.029s)
[t-SNE] Iteration 700: error = 0.8672975, gradient norm = 0.0002428 (50 iterations in 2.025s)
[t-SNE] Iteration 750: error = 0.8646173, gradient norm = 0.0001792 (50 iterations in 2.031s)
[t-SNE] Iteration 800: error = 0.8644778, gradient norm = 0.0001030 (50 iterations in 2.028s)
[t-SNE] Iteration 850: error = 0.8645592, gradient norm = 0.0001318 (50 iterations in 2.026s)
[t-SNE] Iteration 900: error = 0.8645967, gradient norm = 0.0000889 (50 iterations in 2.031s)
[t-SNE] Iteration 950: error = 0.8645501, gradient norm = 0.0001090 (50 iterations in 2.027s)
[t-SNE] Iteration 1000: error = 0.8645887, gradient norm = 0.0000722 (50 iterations in 2.029s)
[t-SNE] KL divergence after 1000 iterations: 0.864589
[t-SNE] Computed conditional probabilities for sample 316 / 316
[t-SNE] Mean sigma: 0.399502
Beginning preprocessing + Leiden
2024-03-11 23:16:30.004373 MEMORY 13.350371328
Affmat transformed
2024-03-11 23:16:30.008981 MEMORY 13.350371328
sources, targets, weights extracted
2024-03-11 23:16:30.010902 MEMORY 13.350371328
About to launch parallel Leiden runs
2024-03-11 23:16:30.076865 MEMORY 13.350371328
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.0s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    3.0s finished
Parallel Leiden runs finished
2024-03-11 23:16:33.073901 MEMORY 13.350371328
Quality: 0.4004492288498289
Quality: 0.40075927567593117
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 310 out of 310 | elapsed:    0.1s finished
Got subclusters: Counter({0: 83, 1: 82, 2: 65, 3: 49, 4: 32, 5: 5})
On pattern 4
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 310 samples in 0.003s...
[t-SNE] Computed neighbors for 310 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 310 / 310
[t-SNE] Mean sigma: 0.356539
[t-SNE] Computed conditional probabilities in 0.021s
[t-SNE] Iteration 50: error = 62.4955521, gradient norm = 0.5405186 (50 iterations in 2.018s)
[t-SNE] Iteration 100: error = 65.1568832, gradient norm = 0.4755664 (50 iterations in 2.027s)
[t-SNE] Iteration 150: error = 66.6722412, gradient norm = 0.4669352 (50 iterations in 2.025s)
[t-SNE] Iteration 200: error = 64.1734390, gradient norm = 0.4884044 (50 iterations in 2.025s)
[t-SNE] Iteration 250: error = 62.9076958, gradient norm = 0.5154887 (50 iterations in 2.028s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 62.907696
[t-SNE] Iteration 300: error = 1.1729844, gradient norm = 0.0046945 (50 iterations in 2.025s)
[t-SNE] Iteration 350: error = 1.0634820, gradient norm = 0.0029853 (50 iterations in 2.024s)
[t-SNE] Iteration 400: error = 1.0098584, gradient norm = 0.0008249 (50 iterations in 1.734s)
[t-SNE] Iteration 450: error = 0.9990714, gradient norm = 0.0008836 (50 iterations in 1.506s)
[t-SNE] Iteration 500: error = 0.9955371, gradient norm = 0.0005061 (50 iterations in 2.030s)
[t-SNE] Iteration 550: error = 0.9846203, gradient norm = 0.0003549 (50 iterations in 2.032s)
[t-SNE] Iteration 600: error = 0.9825667, gradient norm = 0.0006224 (50 iterations in 2.029s)
[t-SNE] Iteration 650: error = 0.9817562, gradient norm = 0.0001849 (50 iterations in 2.025s)
[t-SNE] Iteration 700: error = 0.9748545, gradient norm = 0.0010833 (50 iterations in 2.024s)
[t-SNE] Iteration 750: error = 0.9738786, gradient norm = 0.0001056 (50 iterations in 2.023s)
[t-SNE] Iteration 800: error = 0.9740360, gradient norm = 0.0000992 (50 iterations in 2.020s)
[t-SNE] Iteration 850: error = 0.9739689, gradient norm = 0.0000760 (50 iterations in 2.025s)
[t-SNE] Iteration 900: error = 0.9740227, gradient norm = 0.0000762 (50 iterations in 2.024s)
[t-SNE] Iteration 950: error = 0.9737161, gradient norm = 0.0001392 (50 iterations in 2.029s)
[t-SNE] Iteration 1000: error = 0.9737601, gradient norm = 0.0000875 (50 iterations in 2.021s)
[t-SNE] KL divergence after 1000 iterations: 0.973760
[t-SNE] Computed conditional probabilities for sample 310 / 310
[t-SNE] Mean sigma: 0.356538
Beginning preprocessing + Leiden
2024-03-11 23:17:13.275809 MEMORY 13.350371328
Affmat transformed
2024-03-11 23:17:13.280284 MEMORY 13.350371328
sources, targets, weights extracted
2024-03-11 23:17:13.282384 MEMORY 13.350371328
About to launch parallel Leiden runs
2024-03-11 23:17:13.383452 MEMORY 13.350371328
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.0s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    3.0s finished
Parallel Leiden runs finished
2024-03-11 23:17:16.428513 MEMORY 13.350371328
Quality: 0.34397759017803187
Quality: 0.34543191186605426
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 270 out of 270 | elapsed:    0.1s finished
Got subclusters: Counter({0: 97, 1: 84, 2: 69, 3: 60})
On pattern 5
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 270 samples in 0.002s...
[t-SNE] Computed neighbors for 270 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 270 / 270
[t-SNE] Mean sigma: 0.370701
[t-SNE] Computed conditional probabilities in 0.018s
[t-SNE] Iteration 50: error = 64.1219025, gradient norm = 0.4938540 (50 iterations in 2.025s)
[t-SNE] Iteration 100: error = 65.1535187, gradient norm = 0.4864328 (50 iterations in 2.026s)
[t-SNE] Iteration 150: error = 65.2655487, gradient norm = 0.4787287 (50 iterations in 2.023s)
[t-SNE] Iteration 200: error = 66.5323944, gradient norm = 0.4910496 (50 iterations in 2.024s)
[t-SNE] Iteration 250: error = 65.4042664, gradient norm = 0.4782497 (50 iterations in 2.024s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 65.404266
[t-SNE] Iteration 300: error = 1.1101691, gradient norm = 0.0054543 (50 iterations in 1.328s)
[t-SNE] Iteration 350: error = 1.0117900, gradient norm = 0.0022394 (50 iterations in 1.940s)
[t-SNE] Iteration 400: error = 0.9715183, gradient norm = 0.0018191 (50 iterations in 2.023s)
[t-SNE] Iteration 450: error = 0.9381861, gradient norm = 0.0015698 (50 iterations in 2.023s)
[t-SNE] Iteration 500: error = 0.9168704, gradient norm = 0.0010054 (50 iterations in 1.783s)
[t-SNE] Iteration 550: error = 0.9050426, gradient norm = 0.0006624 (50 iterations in 0.699s)
[t-SNE] Iteration 600: error = 0.8988137, gradient norm = 0.0002523 (50 iterations in 1.233s)
[t-SNE] Iteration 650: error = 0.8985583, gradient norm = 0.0001808 (50 iterations in 1.812s)
[t-SNE] Iteration 700: error = 0.8985319, gradient norm = 0.0001668 (50 iterations in 1.427s)
[t-SNE] Iteration 750: error = 0.8985835, gradient norm = 0.0002034 (50 iterations in 2.032s)
[t-SNE] Iteration 800: error = 0.8985606, gradient norm = 0.0000931 (50 iterations in 1.237s)
[t-SNE] Iteration 850: error = 0.8984789, gradient norm = 0.0001699 (50 iterations in 1.233s)
[t-SNE] Iteration 900: error = 0.8984077, gradient norm = 0.0001146 (50 iterations in 2.019s)
[t-SNE] Iteration 950: error = 0.8983896, gradient norm = 0.0001294 (50 iterations in 0.985s)
[t-SNE] Iteration 1000: error = 0.8985549, gradient norm = 0.0001191 (50 iterations in 1.741s)
[t-SNE] KL divergence after 1000 iterations: 0.898555
[t-SNE] Computed conditional probabilities for sample 270 / 270
[t-SNE] Mean sigma: 0.370701
Beginning preprocessing + Leiden
2024-03-11 23:17:50.526359 MEMORY 13.350371328
Affmat transformed
2024-03-11 23:17:50.530873 MEMORY 13.350371328
sources, targets, weights extracted
2024-03-11 23:17:50.532603 MEMORY 13.350371328
About to launch parallel Leiden runs
2024-03-11 23:17:50.582537 MEMORY 13.350371328
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.9s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.7s finished
Parallel Leiden runs finished
2024-03-11 23:17:53.246959 MEMORY 13.350371328
Quality: 0.33686783950235655
Quality: 0.3382461792015053
Quality: 0.340282978809332
Quality: 0.3403553748820318
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 237 out of 237 | elapsed:    0.1s finished
Got subclusters: Counter({0: 64, 1: 62, 2: 58, 3: 49, 4: 31, 5: 6})
On pattern 6
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 237 samples in 0.002s...
[t-SNE] Computed neighbors for 237 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 237 / 237
[t-SNE] Mean sigma: 0.370647
[t-SNE] Computed conditional probabilities in 0.015s
[t-SNE] Iteration 50: error = 59.7186241, gradient norm = 0.5368179 (50 iterations in 2.025s)
[t-SNE] Iteration 100: error = 64.2882614, gradient norm = 0.4894779 (50 iterations in 2.029s)
[t-SNE] Iteration 150: error = 60.9129906, gradient norm = 0.4957342 (50 iterations in 2.026s)
[t-SNE] Iteration 200: error = 60.4170761, gradient norm = 0.4939291 (50 iterations in 2.028s)
[t-SNE] Iteration 250: error = 62.1800728, gradient norm = 0.5179533 (50 iterations in 2.028s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 62.180073
[t-SNE] Iteration 300: error = 1.0194839, gradient norm = 0.0055318 (50 iterations in 2.034s)
[t-SNE] Iteration 350: error = 0.8870623, gradient norm = 0.0034848 (50 iterations in 2.026s)
[t-SNE] Iteration 400: error = 0.8589591, gradient norm = 0.0014444 (50 iterations in 2.029s)
[t-SNE] Iteration 450: error = 0.8447093, gradient norm = 0.0034428 (50 iterations in 2.028s)
[t-SNE] Iteration 500: error = 0.8239151, gradient norm = 0.0009640 (50 iterations in 2.025s)
[t-SNE] Iteration 550: error = 0.8225560, gradient norm = 0.0006756 (50 iterations in 2.027s)
[t-SNE] Iteration 600: error = 0.8194692, gradient norm = 0.0011016 (50 iterations in 2.023s)
[t-SNE] Iteration 650: error = 0.8180140, gradient norm = 0.0001631 (50 iterations in 2.028s)
[t-SNE] Iteration 700: error = 0.8172356, gradient norm = 0.0001109 (50 iterations in 2.030s)
[t-SNE] Iteration 750: error = 0.8172383, gradient norm = 0.0002029 (50 iterations in 2.027s)
[t-SNE] Iteration 800: error = 0.8174392, gradient norm = 0.0001783 (50 iterations in 2.027s)
[t-SNE] Iteration 850: error = 0.8173006, gradient norm = 0.0000751 (50 iterations in 2.024s)
[t-SNE] Iteration 900: error = 0.8173124, gradient norm = 0.0000528 (50 iterations in 2.026s)
[t-SNE] Iteration 950: error = 0.8172967, gradient norm = 0.0000531 (50 iterations in 1.492s)
[t-SNE] Iteration 1000: error = 0.8172834, gradient norm = 0.0000512 (50 iterations in 0.867s)
[t-SNE] KL divergence after 1000 iterations: 0.817283
[t-SNE] Computed conditional probabilities for sample 237 / 237
[t-SNE] Mean sigma: 0.370647
Beginning preprocessing + Leiden
2024-03-11 23:18:32.522746 MEMORY 13.350371328
Affmat transformed
2024-03-11 23:18:32.526321 MEMORY 13.350371328
sources, targets, weights extracted
2024-03-11 23:18:32.527745 MEMORY 13.350371328
About to launch parallel Leiden runs
2024-03-11 23:18:32.561533 MEMORY 13.350371328
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.8s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.5s finished
Parallel Leiden runs finished
2024-03-11 23:18:35.021727 MEMORY 13.350371328
Quality: 0.32147937540866783
Quality: 0.321507096613861
Quality: 0.3220796377035222
Quality: 0.32233455846735537
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 234 out of 234 | elapsed:    0.1s finished
Got subclusters: Counter({0: 47, 1: 45, 2: 44, 3: 36, 4: 33, 5: 32})
On pattern 7
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 234 samples in 0.002s...
[t-SNE] Computed neighbors for 234 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 234 / 234
[t-SNE] Mean sigma: 0.360610
[t-SNE] Computed conditional probabilities in 0.016s
[t-SNE] Iteration 50: error = 61.5600586, gradient norm = 0.4642791 (50 iterations in 2.022s)
[t-SNE] Iteration 100: error = 61.8515930, gradient norm = 0.5246534 (50 iterations in 2.029s)
[t-SNE] Iteration 150: error = 63.6152191, gradient norm = 0.4613061 (50 iterations in 2.026s)
[t-SNE] Iteration 200: error = 60.4046059, gradient norm = 0.5693647 (50 iterations in 2.027s)
[t-SNE] Iteration 250: error = 61.0884132, gradient norm = 0.5273485 (50 iterations in 2.028s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 61.088413
[t-SNE] Iteration 300: error = 1.0682559, gradient norm = 0.0056005 (50 iterations in 2.025s)
[t-SNE] Iteration 350: error = 0.9187878, gradient norm = 0.0054234 (50 iterations in 2.026s)
[t-SNE] Iteration 400: error = 0.8737549, gradient norm = 0.0006675 (50 iterations in 2.027s)
[t-SNE] Iteration 450: error = 0.8632253, gradient norm = 0.0014562 (50 iterations in 2.025s)
[t-SNE] Iteration 500: error = 0.8613744, gradient norm = 0.0004701 (50 iterations in 2.022s)
[t-SNE] Iteration 550: error = 0.8614937, gradient norm = 0.0001074 (50 iterations in 2.024s)
[t-SNE] Iteration 600: error = 0.8611920, gradient norm = 0.0000694 (50 iterations in 2.028s)
[t-SNE] Iteration 650: error = 0.8613116, gradient norm = 0.0001167 (50 iterations in 1.103s)
[t-SNE] Iteration 700: error = 0.8612128, gradient norm = 0.0000780 (50 iterations in 1.071s)
[t-SNE] Iteration 750: error = 0.8613296, gradient norm = 0.0000877 (50 iterations in 2.020s)
[t-SNE] Iteration 800: error = 0.8612198, gradient norm = 0.0001106 (50 iterations in 1.069s)
[t-SNE] Iteration 850: error = 0.8612787, gradient norm = 0.0001127 (50 iterations in 1.052s)
[t-SNE] Iteration 900: error = 0.8613070, gradient norm = 0.0001243 (50 iterations in 1.072s)
[t-SNE] Iteration 950: error = 0.8612499, gradient norm = 0.0001283 (50 iterations in 1.800s)
[t-SNE] Iteration 950: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 950 iterations: 0.861250
[t-SNE] Computed conditional probabilities for sample 234 / 234
[t-SNE] Mean sigma: 0.360609
Beginning preprocessing + Leiden
2024-03-11 23:19:08.937822 MEMORY 13.350371328
Affmat transformed
2024-03-11 23:19:08.941294 MEMORY 13.350371328
sources, targets, weights extracted
2024-03-11 23:19:08.942674 MEMORY 13.350371328
About to launch parallel Leiden runs
2024-03-11 23:19:09.044940 MEMORY 13.350371328
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.9s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.5s finished
Parallel Leiden runs finished
2024-03-11 23:19:11.549618 MEMORY 13.350371328
Quality: 0.32456916966958843
Quality: 0.326265622043643
Quality: 0.32647608417824386
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 214 out of 214 | elapsed:    0.1s finished
Got subclusters: Counter({0: 61, 1: 53, 2: 42, 3: 38, 4: 35, 5: 5})
On pattern 8
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 214 samples in 0.002s...
[t-SNE] Computed neighbors for 214 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 214 / 214
[t-SNE] Mean sigma: 0.411661
[t-SNE] Computed conditional probabilities in 0.014s
[t-SNE] Iteration 50: error = 63.6791954, gradient norm = 0.4988492 (50 iterations in 2.022s)
[t-SNE] Iteration 100: error = 60.6767616, gradient norm = 0.5186635 (50 iterations in 2.025s)
[t-SNE] Iteration 150: error = 59.6281586, gradient norm = 0.5164306 (50 iterations in 2.030s)
[t-SNE] Iteration 200: error = 58.6543922, gradient norm = 0.5485336 (50 iterations in 2.022s)
[t-SNE] Iteration 250: error = 61.9152031, gradient norm = 0.5209350 (50 iterations in 2.025s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 61.915203
[t-SNE] Iteration 300: error = 1.0749807, gradient norm = 0.0062679 (50 iterations in 2.024s)
[t-SNE] Iteration 350: error = 0.8481385, gradient norm = 0.0048806 (50 iterations in 2.028s)
[t-SNE] Iteration 400: error = 0.7786300, gradient norm = 0.0040113 (50 iterations in 2.022s)
[t-SNE] Iteration 450: error = 0.7655272, gradient norm = 0.0005661 (50 iterations in 2.019s)
[t-SNE] Iteration 500: error = 0.7582418, gradient norm = 0.0003756 (50 iterations in 2.029s)
[t-SNE] Iteration 550: error = 0.7578800, gradient norm = 0.0001982 (50 iterations in 2.027s)
[t-SNE] Iteration 600: error = 0.7578133, gradient norm = 0.0002527 (50 iterations in 2.021s)
[t-SNE] Iteration 650: error = 0.7573481, gradient norm = 0.0001683 (50 iterations in 2.023s)
[t-SNE] Iteration 700: error = 0.7573550, gradient norm = 0.0000885 (50 iterations in 2.018s)
[t-SNE] Iteration 750: error = 0.7573192, gradient norm = 0.0000971 (50 iterations in 0.721s)
[t-SNE] Iteration 800: error = 0.7573160, gradient norm = 0.0000939 (50 iterations in 0.572s)
[t-SNE] Iteration 850: error = 0.7573241, gradient norm = 0.0000781 (50 iterations in 1.021s)
[t-SNE] Iteration 900: error = 0.7573518, gradient norm = 0.0000698 (50 iterations in 1.006s)
[t-SNE] Iteration 950: error = 0.7573571, gradient norm = 0.0000928 (50 iterations in 0.859s)
[t-SNE] Iteration 1000: error = 0.7573003, gradient norm = 0.0000949 (50 iterations in 0.864s)
[t-SNE] KL divergence after 1000 iterations: 0.757300
[t-SNE] Computed conditional probabilities for sample 214 / 214
[t-SNE] Mean sigma: 0.411661
Beginning preprocessing + Leiden
2024-03-11 23:19:45.311220 MEMORY 13.350371328
Affmat transformed
2024-03-11 23:19:45.314420 MEMORY 13.350371328
sources, targets, weights extracted
2024-03-11 23:19:45.315662 MEMORY 13.350371328
About to launch parallel Leiden runs
2024-03-11 23:19:45.413214 MEMORY 13.350371328
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.8s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.4s finished
Parallel Leiden runs finished
2024-03-11 23:19:47.770671 MEMORY 13.350371328
Quality: 0.31396589942335357
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 205 out of 205 | elapsed:    0.1s finished
Got subclusters: Counter({0: 71, 1: 56, 2: 46, 3: 41})
On pattern 9
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 205 samples in 0.002s...
[t-SNE] Computed neighbors for 205 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 205 / 205
[t-SNE] Mean sigma: 0.379803
[t-SNE] Computed conditional probabilities in 0.014s
[t-SNE] Iteration 50: error = 61.3753586, gradient norm = 0.5010198 (50 iterations in 2.023s)
[t-SNE] Iteration 100: error = 64.2298737, gradient norm = 0.4444613 (50 iterations in 2.026s)
[t-SNE] Iteration 150: error = 57.8818588, gradient norm = 0.5351900 (50 iterations in 2.026s)
[t-SNE] Iteration 200: error = 60.3875961, gradient norm = 0.4956026 (50 iterations in 2.026s)
[t-SNE] Iteration 250: error = 60.5908127, gradient norm = 0.4706386 (50 iterations in 2.028s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 60.590813
[t-SNE] Iteration 300: error = 0.9883404, gradient norm = 0.0074213 (50 iterations in 2.025s)
[t-SNE] Iteration 350: error = 0.8285232, gradient norm = 0.0053016 (50 iterations in 2.027s)
[t-SNE] Iteration 400: error = 0.7488739, gradient norm = 0.0028495 (50 iterations in 2.025s)
[t-SNE] Iteration 450: error = 0.7213858, gradient norm = 0.0017002 (50 iterations in 2.024s)
[t-SNE] Iteration 500: error = 0.7183560, gradient norm = 0.0002347 (50 iterations in 2.022s)
[t-SNE] Iteration 550: error = 0.7141741, gradient norm = 0.0005531 (50 iterations in 2.020s)
[t-SNE] Iteration 600: error = 0.7141985, gradient norm = 0.0001068 (50 iterations in 0.999s)
[t-SNE] Iteration 650: error = 0.7140440, gradient norm = 0.0000905 (50 iterations in 1.242s)
[t-SNE] Iteration 700: error = 0.7140898, gradient norm = 0.0001268 (50 iterations in 0.694s)
[t-SNE] Iteration 750: error = 0.7141052, gradient norm = 0.0001960 (50 iterations in 2.021s)
[t-SNE] Iteration 800: error = 0.7141884, gradient norm = 0.0001694 (50 iterations in 2.023s)
[t-SNE] Iteration 850: error = 0.7140495, gradient norm = 0.0001472 (50 iterations in 2.029s)
[t-SNE] Iteration 900: error = 0.7140662, gradient norm = 0.0001293 (50 iterations in 2.022s)
[t-SNE] Iteration 950: error = 0.7140210, gradient norm = 0.0001509 (50 iterations in 2.028s)
[t-SNE] Iteration 1000: error = 0.7141832, gradient norm = 0.0001299 (50 iterations in 2.031s)
[t-SNE] KL divergence after 1000 iterations: 0.714183
[t-SNE] Computed conditional probabilities for sample 205 / 205
[t-SNE] Mean sigma: 0.379803
Beginning preprocessing + Leiden
2024-03-11 23:20:25.508684 MEMORY 13.350371328
Affmat transformed
2024-03-11 23:20:25.511932 MEMORY 13.350371328
sources, targets, weights extracted
2024-03-11 23:20:25.513143 MEMORY 13.350371328
About to launch parallel Leiden runs
2024-03-11 23:20:25.517326 MEMORY 13.350371328
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.8s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.3s finished
Parallel Leiden runs finished
2024-03-11 23:20:27.868756 MEMORY 13.350371328
Quality: 0.3158527653816206
Quality: 0.3175369416250801
Quality: 0.3178037427832411
Quality: 0.3182688059672621
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 200 out of 200 | elapsed:    0.1s finished
Got subclusters: Counter({0: 59, 1: 57, 2: 48, 3: 26, 4: 8, 5: 7})
On pattern 10
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 200 samples in 0.002s...
[t-SNE] Computed neighbors for 200 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 200 / 200
[t-SNE] Mean sigma: 0.421429
[t-SNE] Computed conditional probabilities in 0.013s
[t-SNE] Iteration 50: error = 57.2564468, gradient norm = 0.5643913 (50 iterations in 2.027s)
[t-SNE] Iteration 100: error = 58.7660446, gradient norm = 0.5318632 (50 iterations in 2.020s)
[t-SNE] Iteration 150: error = 57.9149895, gradient norm = 0.5536580 (50 iterations in 2.024s)
[t-SNE] Iteration 200: error = 57.5504913, gradient norm = 0.5453940 (50 iterations in 2.023s)
[t-SNE] Iteration 250: error = 57.6899910, gradient norm = 0.5431659 (50 iterations in 2.022s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 57.689991
[t-SNE] Iteration 300: error = 0.9115918, gradient norm = 0.0075832 (50 iterations in 2.027s)
[t-SNE] Iteration 350: error = 0.7331614, gradient norm = 0.0037817 (50 iterations in 1.003s)
[t-SNE] Iteration 400: error = 0.7174627, gradient norm = 0.0012068 (50 iterations in 2.025s)
[t-SNE] Iteration 450: error = 0.7027322, gradient norm = 0.0004490 (50 iterations in 2.076s)
[t-SNE] Iteration 500: error = 0.7027885, gradient norm = 0.0000892 (50 iterations in 2.031s)
[t-SNE] Iteration 550: error = 0.7027285, gradient norm = 0.0001080 (50 iterations in 2.024s)
[t-SNE] Iteration 600: error = 0.7027115, gradient norm = 0.0001361 (50 iterations in 2.022s)
[t-SNE] Iteration 650: error = 0.7027596, gradient norm = 0.0000975 (50 iterations in 1.005s)
[t-SNE] Iteration 700: error = 0.7027459, gradient norm = 0.0001186 (50 iterations in 2.055s)
[t-SNE] Iteration 750: error = 0.7026889, gradient norm = 0.0001576 (50 iterations in 2.026s)
[t-SNE] Iteration 800: error = 0.7026811, gradient norm = 0.0001177 (50 iterations in 2.026s)
[t-SNE] Iteration 850: error = 0.7026570, gradient norm = 0.0001041 (50 iterations in 2.025s)
[t-SNE] Iteration 900: error = 0.7028007, gradient norm = 0.0001130 (50 iterations in 2.024s)
[t-SNE] Iteration 950: error = 0.7028050, gradient norm = 0.0001153 (50 iterations in 2.025s)
[t-SNE] Iteration 1000: error = 0.7027385, gradient norm = 0.0001003 (50 iterations in 2.026s)
[t-SNE] KL divergence after 1000 iterations: 0.702739
[t-SNE] Computed conditional probabilities for sample 200 / 200
[t-SNE] Mean sigma: 0.421429
Beginning preprocessing + Leiden
2024-03-11 23:21:06.737002 MEMORY 13.350371328
Affmat transformed
2024-03-11 23:21:06.740148 MEMORY 13.350371328
sources, targets, weights extracted
2024-03-11 23:21:06.741296 MEMORY 13.350371328
About to launch parallel Leiden runs
2024-03-11 23:21:06.766507 MEMORY 13.350371328
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.8s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.3s finished
Parallel Leiden runs finished
2024-03-11 23:21:09.046791 MEMORY 13.350371328
Quality: 0.33103113272904344
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 195 out of 195 | elapsed:    0.1s finished
Got subclusters: Counter({0: 42, 1: 42, 2: 32, 3: 29, 4: 27, 5: 16, 6: 12})
On pattern 11
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 195 samples in 0.002s...
[t-SNE] Computed neighbors for 195 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 195 / 195
[t-SNE] Mean sigma: 0.417499
[t-SNE] Computed conditional probabilities in 0.013s
[t-SNE] Iteration 50: error = 57.7739754, gradient norm = 0.4998129 (50 iterations in 2.026s)
[t-SNE] Iteration 100: error = 60.5986862, gradient norm = 0.4580071 (50 iterations in 2.027s)
[t-SNE] Iteration 150: error = 58.8682251, gradient norm = 0.5274453 (50 iterations in 2.025s)
[t-SNE] Iteration 200: error = 58.1395302, gradient norm = 0.4787927 (50 iterations in 2.025s)
[t-SNE] Iteration 250: error = 61.1462212, gradient norm = 0.5258730 (50 iterations in 0.999s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 61.146221
[t-SNE] Iteration 300: error = 0.9688368, gradient norm = 0.0067234 (50 iterations in 1.330s)
[t-SNE] Iteration 350: error = 0.6936244, gradient norm = 0.0038279 (50 iterations in 1.700s)
[t-SNE] Iteration 400: error = 0.6737959, gradient norm = 0.0019464 (50 iterations in 1.180s)
[t-SNE] Iteration 450: error = 0.6563756, gradient norm = 0.0010314 (50 iterations in 0.778s)
[t-SNE] Iteration 500: error = 0.6560465, gradient norm = 0.0002344 (50 iterations in 0.968s)
[t-SNE] Iteration 550: error = 0.6543282, gradient norm = 0.0001222 (50 iterations in 0.967s)
[t-SNE] Iteration 600: error = 0.6543287, gradient norm = 0.0000951 (50 iterations in 0.945s)
[t-SNE] Iteration 650: error = 0.6544837, gradient norm = 0.0001458 (50 iterations in 1.522s)
[t-SNE] Iteration 700: error = 0.6544793, gradient norm = 0.0000752 (50 iterations in 0.581s)
[t-SNE] Iteration 750: error = 0.6545803, gradient norm = 0.0000891 (50 iterations in 1.863s)
[t-SNE] Iteration 800: error = 0.6545184, gradient norm = 0.0000808 (50 iterations in 1.872s)
[t-SNE] Iteration 850: error = 0.6544839, gradient norm = 0.0000952 (50 iterations in 1.221s)
[t-SNE] Iteration 900: error = 0.6546029, gradient norm = 0.0001419 (50 iterations in 2.022s)
[t-SNE] Iteration 900: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 900 iterations: 0.654603
[t-SNE] Computed conditional probabilities for sample 195 / 195
[t-SNE] Mean sigma: 0.417499
Beginning preprocessing + Leiden
2024-03-11 23:21:35.431279 MEMORY 13.350371328
Affmat transformed
2024-03-11 23:21:35.434331 MEMORY 13.350371328
sources, targets, weights extracted
2024-03-11 23:21:35.435451 MEMORY 13.350371328
About to launch parallel Leiden runs
2024-03-11 23:21:35.477546 MEMORY 13.350371328
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.8s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.2s finished
Parallel Leiden runs finished
2024-03-11 23:21:37.729222 MEMORY 13.350371328
Quality: 0.33093849330603353
Quality: 0.33170102786070355
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 136 out of 136 | elapsed:    0.1s finished
Got subclusters: Counter({0: 63, 1: 43, 2: 33, 3: 27, 4: 16, 5: 13})
On pattern 12
[t-SNE] Computing 135 nearest neighbors...
[t-SNE] Indexed 136 samples in 0.001s...
[t-SNE] Computed neighbors for 136 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 136 / 136
[t-SNE] Mean sigma: 0.482972
[t-SNE] Computed conditional probabilities in 0.008s
[t-SNE] Iteration 50: error = 55.1403580, gradient norm = 0.4709963 (50 iterations in 1.916s)
[t-SNE] Iteration 100: error = 52.9332581, gradient norm = 0.5467666 (50 iterations in 0.806s)
[t-SNE] Iteration 150: error = 53.9011040, gradient norm = 0.6074866 (50 iterations in 2.023s)
[t-SNE] Iteration 200: error = 54.6943436, gradient norm = 0.5578685 (50 iterations in 2.025s)
[t-SNE] Iteration 250: error = 53.9879150, gradient norm = 0.4755574 (50 iterations in 2.025s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 53.987915
[t-SNE] Iteration 300: error = 0.7134396, gradient norm = 0.0096584 (50 iterations in 2.019s)
[t-SNE] Iteration 350: error = 0.4721586, gradient norm = 0.0031029 (50 iterations in 0.838s)
[t-SNE] Iteration 400: error = 0.4711814, gradient norm = 0.0002089 (50 iterations in 2.021s)
[t-SNE] Iteration 450: error = 0.4716384, gradient norm = 0.0004703 (50 iterations in 2.022s)
[t-SNE] Iteration 500: error = 0.4713472, gradient norm = 0.0002359 (50 iterations in 2.020s)
[t-SNE] Iteration 550: error = 0.4714010, gradient norm = 0.0003550 (50 iterations in 2.024s)
[t-SNE] Iteration 600: error = 0.4715917, gradient norm = 0.0003326 (50 iterations in 2.016s)
[t-SNE] Iteration 650: error = 0.4713866, gradient norm = 0.0002580 (50 iterations in 2.025s)
[t-SNE] Iteration 700: error = 0.4714825, gradient norm = 0.0002603 (50 iterations in 2.025s)
[t-SNE] Iteration 750: error = 0.4715569, gradient norm = 0.0002756 (50 iterations in 2.027s)
[t-SNE] Iteration 750: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 750 iterations: 0.471557
[t-SNE] Computed conditional probabilities for sample 136 / 136
[t-SNE] Mean sigma: 0.482973
Beginning preprocessing + Leiden
2024-03-11 23:22:05.811877 MEMORY 13.350371328
Affmat transformed
2024-03-11 23:22:05.814004 MEMORY 13.350371328
sources, targets, weights extracted
2024-03-11 23:22:05.814725 MEMORY 13.350371328
About to launch parallel Leiden runs
2024-03-11 23:22:05.849590 MEMORY 13.350371328
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.9s finished
Parallel Leiden runs finished
2024-03-11 23:22:07.799038 MEMORY 13.350371328
Quality: 0.281094289176158
Quality: 0.2818027828183391
Quality: 0.28201067346553654
Quality: 0.2832103934086556
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  80 out of 127 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=24)]: Done 127 out of 127 | elapsed:    0.0s finished
Got subclusters: Counter({0: 44, 1: 40, 2: 31, 3: 17, 4: 4})
On pattern 13
[t-SNE] Computing 126 nearest neighbors...
[t-SNE] Indexed 127 samples in 0.001s...
[t-SNE] Computed neighbors for 127 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 127 / 127
[t-SNE] Mean sigma: 0.442661
[t-SNE] Computed conditional probabilities in 0.007s
[t-SNE] Iteration 50: error = 58.2207565, gradient norm = 0.4651273 (50 iterations in 2.020s)
[t-SNE] Iteration 100: error = 59.1795235, gradient norm = 0.4461923 (50 iterations in 2.023s)
[t-SNE] Iteration 150: error = 54.6764832, gradient norm = 0.5451168 (50 iterations in 1.525s)
[t-SNE] Iteration 200: error = 55.1328468, gradient norm = 0.5539252 (50 iterations in 1.137s)
[t-SNE] Iteration 250: error = 57.1522942, gradient norm = 0.5242848 (50 iterations in 1.743s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 57.152294
[t-SNE] Iteration 300: error = 0.8920755, gradient norm = 0.0082686 (50 iterations in 0.376s)
[t-SNE] Iteration 350: error = 0.4394018, gradient norm = 0.0060465 (50 iterations in 1.928s)
[t-SNE] Iteration 400: error = 0.4350672, gradient norm = 0.0005135 (50 iterations in 0.746s)
[t-SNE] Iteration 450: error = 0.4349534, gradient norm = 0.0001541 (50 iterations in 0.610s)
[t-SNE] Iteration 500: error = 0.4349809, gradient norm = 0.0001901 (50 iterations in 1.240s)
[t-SNE] Iteration 550: error = 0.4349136, gradient norm = 0.0001669 (50 iterations in 0.864s)
[t-SNE] Iteration 600: error = 0.4350031, gradient norm = 0.0002099 (50 iterations in 1.177s)
[t-SNE] Iteration 650: error = 0.4349364, gradient norm = 0.0002102 (50 iterations in 1.417s)
[t-SNE] Iteration 700: error = 0.4350269, gradient norm = 0.0001307 (50 iterations in 1.144s)
[t-SNE] Iteration 750: error = 0.4349764, gradient norm = 0.0002052 (50 iterations in 0.736s)
[t-SNE] Iteration 800: error = 0.4349395, gradient norm = 0.0001754 (50 iterations in 0.614s)
[t-SNE] Iteration 850: error = 0.4350249, gradient norm = 0.0002354 (50 iterations in 0.624s)
[t-SNE] Iteration 900: error = 0.4349510, gradient norm = 0.0002450 (50 iterations in 0.615s)
[t-SNE] Iteration 900: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 900 iterations: 0.434951
[t-SNE] Computed conditional probabilities for sample 127 / 127
[t-SNE] Mean sigma: 0.442661
Beginning preprocessing + Leiden
2024-03-11 23:22:28.550971 MEMORY 13.350371328
Affmat transformed
2024-03-11 23:22:28.552961 MEMORY 13.350371328
sources, targets, weights extracted
2024-03-11 23:22:28.553657 MEMORY 13.350371328
About to launch parallel Leiden runs
2024-03-11 23:22:28.764359 MEMORY 13.350371328
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.0s finished
Parallel Leiden runs finished
2024-03-11 23:22:30.764190 MEMORY 13.350371328
Quality: 0.27827820950796955
Quality: 0.27845240195631654
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 118 out of 118 | elapsed:    0.0s finished
Got subclusters: Counter({0: 31, 1: 27, 2: 25, 3: 23, 4: 21})
On pattern 14
[t-SNE] Computing 117 nearest neighbors...
[t-SNE] Indexed 118 samples in 0.001s...
[t-SNE] Computed neighbors for 118 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 118 / 118
[t-SNE] Mean sigma: 0.547391
[t-SNE] Computed conditional probabilities in 0.006s
[t-SNE] Iteration 50: error = 52.6170120, gradient norm = 0.5680177 (50 iterations in 2.017s)
[t-SNE] Iteration 100: error = 54.8709679, gradient norm = 0.5174732 (50 iterations in 2.021s)
[t-SNE] Iteration 150: error = 53.1076164, gradient norm = 0.4651256 (50 iterations in 2.022s)
[t-SNE] Iteration 200: error = 53.7781677, gradient norm = 0.5212428 (50 iterations in 2.029s)
[t-SNE] Iteration 250: error = 53.2715225, gradient norm = 0.4438908 (50 iterations in 2.022s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 53.271523
[t-SNE] Iteration 300: error = 0.6176584, gradient norm = 0.0157006 (50 iterations in 2.021s)
[t-SNE] Iteration 350: error = 0.4213702, gradient norm = 0.0025826 (50 iterations in 2.021s)
[t-SNE] Iteration 400: error = 0.4208828, gradient norm = 0.0004501 (50 iterations in 2.023s)
[t-SNE] Iteration 450: error = 0.4203719, gradient norm = 0.0006036 (50 iterations in 2.020s)
[t-SNE] Iteration 500: error = 0.4202906, gradient norm = 0.0004245 (50 iterations in 2.022s)
[t-SNE] Iteration 550: error = 0.4201694, gradient norm = 0.0004998 (50 iterations in 2.019s)
[t-SNE] Iteration 600: error = 0.4201400, gradient norm = 0.0005485 (50 iterations in 2.021s)
[t-SNE] Iteration 650: error = 0.4201058, gradient norm = 0.0006463 (50 iterations in 2.026s)
[t-SNE] Iteration 700: error = 0.4201561, gradient norm = 0.0006067 (50 iterations in 2.020s)
[t-SNE] Iteration 750: error = 0.4200363, gradient norm = 0.0004908 (50 iterations in 2.023s)
[t-SNE] Iteration 800: error = 0.4199943, gradient norm = 0.0006462 (50 iterations in 2.023s)
[t-SNE] Iteration 850: error = 0.4201082, gradient norm = 0.0005374 (50 iterations in 2.020s)
[t-SNE] Iteration 900: error = 0.4202660, gradient norm = 0.0006075 (50 iterations in 2.022s)
[t-SNE] Iteration 950: error = 0.4201885, gradient norm = 0.0006507 (50 iterations in 2.025s)
[t-SNE] Iteration 1000: error = 0.4202278, gradient norm = 0.0006068 (50 iterations in 0.954s)
[t-SNE] KL divergence after 1000 iterations: 0.420228
[t-SNE] Computed conditional probabilities for sample 118 / 118
[t-SNE] Mean sigma: 0.547391
Beginning preprocessing + Leiden
2024-03-11 23:23:10.307122 MEMORY 13.350371328
Affmat transformed
2024-03-11 23:23:10.308984 MEMORY 13.350371328
sources, targets, weights extracted
2024-03-11 23:23:10.309639 MEMORY 13.350371328
About to launch parallel Leiden runs
2024-03-11 23:23:10.341694 MEMORY 13.350371328
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.9s finished
Parallel Leiden runs finished
2024-03-11 23:23:12.267519 MEMORY 13.350371328
Quality: 0.2774914657262179
Quality: 0.2778849275606694
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  70 out of 117 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=24)]: Done 117 out of 117 | elapsed:    0.0s finished
Got subclusters: Counter({0: 31, 1: 29, 2: 25, 3: 17, 4: 16})
On pattern 15
[t-SNE] Computing 116 nearest neighbors...
[t-SNE] Indexed 117 samples in 0.001s...
[t-SNE] Computed neighbors for 117 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 117 / 117
[t-SNE] Mean sigma: 0.499208
[t-SNE] Computed conditional probabilities in 0.006s
[t-SNE] Iteration 50: error = 55.5065765, gradient norm = 0.5301431 (50 iterations in 2.018s)
[t-SNE] Iteration 100: error = 52.5220337, gradient norm = 0.4837293 (50 iterations in 2.024s)
[t-SNE] Iteration 150: error = 53.8869514, gradient norm = 0.5194833 (50 iterations in 2.023s)
[t-SNE] Iteration 200: error = 51.8285561, gradient norm = 0.5479268 (50 iterations in 2.017s)
[t-SNE] Iteration 250: error = 52.8938904, gradient norm = 0.4188490 (50 iterations in 2.022s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 52.893890
[t-SNE] Iteration 300: error = 0.5608649, gradient norm = 0.0157665 (50 iterations in 2.019s)
[t-SNE] Iteration 350: error = 0.3279082, gradient norm = 0.0020211 (50 iterations in 2.027s)
[t-SNE] Iteration 400: error = 0.3280114, gradient norm = 0.0003148 (50 iterations in 2.017s)
[t-SNE] Iteration 450: error = 0.3278764, gradient norm = 0.0007194 (50 iterations in 2.022s)
[t-SNE] Iteration 500: error = 0.3276692, gradient norm = 0.0007231 (50 iterations in 2.026s)
[t-SNE] Iteration 550: error = 0.3277432, gradient norm = 0.0005972 (50 iterations in 2.024s)
[t-SNE] Iteration 600: error = 0.3278639, gradient norm = 0.0006177 (50 iterations in 2.022s)
[t-SNE] Iteration 650: error = 0.3277456, gradient norm = 0.0005780 (50 iterations in 2.024s)
[t-SNE] Iteration 700: error = 0.3277686, gradient norm = 0.0006415 (50 iterations in 2.014s)
[t-SNE] Iteration 750: error = 0.3276208, gradient norm = 0.0006090 (50 iterations in 2.020s)
[t-SNE] Iteration 800: error = 0.3276488, gradient norm = 0.0006777 (50 iterations in 2.021s)
[t-SNE] Iteration 850: error = 0.3276621, gradient norm = 0.0005783 (50 iterations in 2.024s)
[t-SNE] Iteration 900: error = 0.3277390, gradient norm = 0.0005643 (50 iterations in 2.027s)
[t-SNE] Iteration 950: error = 0.3277178, gradient norm = 0.0009604 (50 iterations in 2.026s)
[t-SNE] Iteration 1000: error = 0.3277129, gradient norm = 0.0005175 (50 iterations in 2.021s)
[t-SNE] KL divergence after 1000 iterations: 0.327713
[t-SNE] Computed conditional probabilities for sample 117 / 117
[t-SNE] Mean sigma: 0.499208
Beginning preprocessing + Leiden
2024-03-11 23:23:52.870479 MEMORY 13.350371328
Affmat transformed
2024-03-11 23:23:52.872359 MEMORY 13.350371328
sources, targets, weights extracted
2024-03-11 23:23:52.873034 MEMORY 13.350371328
About to launch parallel Leiden runs
2024-03-11 23:23:52.896231 MEMORY 13.350371328
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.9s finished
Parallel Leiden runs finished
2024-03-11 23:23:54.790749 MEMORY 13.350371328
Quality: 0.28421814368055165
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 116 out of 116 | elapsed:    0.0s finished
Got subclusters: Counter({0: 29, 1: 29, 2: 27, 3: 24, 4: 8})
On pattern 16
[t-SNE] Computing 115 nearest neighbors...
[t-SNE] Indexed 116 samples in 0.001s...
[t-SNE] Computed neighbors for 116 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 116 / 116
[t-SNE] Mean sigma: 0.542252
[t-SNE] Computed conditional probabilities in 0.006s
[t-SNE] Iteration 50: error = 54.2139053, gradient norm = 0.5124535 (50 iterations in 2.022s)
[t-SNE] Iteration 100: error = 52.5079498, gradient norm = 0.5334697 (50 iterations in 2.027s)
[t-SNE] Iteration 150: error = 55.7686615, gradient norm = 0.4573222 (50 iterations in 2.022s)
[t-SNE] Iteration 200: error = 54.9988976, gradient norm = 0.5393660 (50 iterations in 2.023s)
[t-SNE] Iteration 250: error = 55.0841446, gradient norm = 0.4988261 (50 iterations in 1.962s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 55.084145
[t-SNE] Iteration 300: error = 0.8142843, gradient norm = 0.0097294 (50 iterations in 0.615s)
[t-SNE] Iteration 350: error = 0.4006261, gradient norm = 0.0042494 (50 iterations in 2.025s)
[t-SNE] Iteration 400: error = 0.3976797, gradient norm = 0.0006552 (50 iterations in 2.026s)
[t-SNE] Iteration 450: error = 0.3948578, gradient norm = 0.0005973 (50 iterations in 2.019s)
[t-SNE] Iteration 500: error = 0.3951374, gradient norm = 0.0002326 (50 iterations in 2.021s)
[t-SNE] Iteration 550: error = 0.3949979, gradient norm = 0.0002026 (50 iterations in 2.022s)
[t-SNE] Iteration 600: error = 0.3950015, gradient norm = 0.0002282 (50 iterations in 2.019s)
[t-SNE] Iteration 650: error = 0.3950813, gradient norm = 0.0002607 (50 iterations in 2.020s)
[t-SNE] Iteration 700: error = 0.3950493, gradient norm = 0.0002655 (50 iterations in 0.547s)
[t-SNE] Iteration 750: error = 0.3950707, gradient norm = 0.0002472 (50 iterations in 0.919s)
[t-SNE] Iteration 800: error = 0.3950518, gradient norm = 0.0002040 (50 iterations in 0.017s)
[t-SNE] Iteration 800: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 800 iterations: 0.395052
[t-SNE] Computed conditional probabilities for sample 116 / 116
[t-SNE] Mean sigma: 0.542252
Beginning preprocessing + Leiden
2024-03-11 23:24:21.265302 MEMORY 13.350371328
Affmat transformed
2024-03-11 23:24:21.267131 MEMORY 13.350371328
sources, targets, weights extracted
2024-03-11 23:24:21.267779 MEMORY 13.350371328
About to launch parallel Leiden runs
2024-03-11 23:24:21.299839 MEMORY 13.350371328
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.9s finished
Parallel Leiden runs finished
2024-03-11 23:24:23.228053 MEMORY 13.350371328
Quality: 0.24860523327650824
Quality: 0.24957734860006905
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 114 out of 114 | elapsed:    0.0s finished
Got subclusters: Counter({0: 32, 1: 28, 2: 26, 3: 25, 4: 5})
On pattern 17
[t-SNE] Computing 113 nearest neighbors...
[t-SNE] Indexed 114 samples in 0.001s...
[t-SNE] Computed neighbors for 114 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 114 / 114
[t-SNE] Mean sigma: 0.520876
[t-SNE] Computed conditional probabilities in 0.006s
[t-SNE] Iteration 50: error = 52.4909821, gradient norm = 0.5865818 (50 iterations in 0.639s)
[t-SNE] Iteration 100: error = 54.1420822, gradient norm = 0.5692880 (50 iterations in 2.010s)
[t-SNE] Iteration 150: error = 53.0425644, gradient norm = 0.5260950 (50 iterations in 0.018s)
[t-SNE] Iteration 200: error = 54.0445862, gradient norm = 0.5467679 (50 iterations in 0.018s)
[t-SNE] Iteration 250: error = 55.8215446, gradient norm = 0.4795691 (50 iterations in 0.018s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 55.821545
[t-SNE] Iteration 300: error = 0.8215611, gradient norm = 0.0068938 (50 iterations in 0.017s)
[t-SNE] Iteration 350: error = 0.5037510, gradient norm = 0.0202701 (50 iterations in 0.017s)
[t-SNE] Iteration 400: error = 0.4204191, gradient norm = 0.0036751 (50 iterations in 0.019s)
[t-SNE] Iteration 450: error = 0.4200657, gradient norm = 0.0004879 (50 iterations in 0.017s)
[t-SNE] Iteration 500: error = 0.4199367, gradient norm = 0.0004375 (50 iterations in 0.017s)
[t-SNE] Iteration 550: error = 0.4199074, gradient norm = 0.0004069 (50 iterations in 0.017s)
[t-SNE] Iteration 600: error = 0.4198489, gradient norm = 0.0002074 (50 iterations in 0.017s)
[t-SNE] Iteration 650: error = 0.4197512, gradient norm = 0.0001599 (50 iterations in 0.017s)
[t-SNE] Iteration 700: error = 0.4197468, gradient norm = 0.0001316 (50 iterations in 0.017s)
[t-SNE] Iteration 750: error = 0.4197585, gradient norm = 0.0001165 (50 iterations in 0.017s)
[t-SNE] Iteration 800: error = 0.4197879, gradient norm = 0.0001402 (50 iterations in 0.017s)
[t-SNE] Iteration 850: error = 0.4197821, gradient norm = 0.0001349 (50 iterations in 0.017s)
[t-SNE] Iteration 900: error = 0.4197606, gradient norm = 0.0001105 (50 iterations in 0.017s)
[t-SNE] Iteration 950: error = 0.4197597, gradient norm = 0.0001472 (50 iterations in 0.017s)
[t-SNE] Iteration 1000: error = 0.4197454, gradient norm = 0.0001332 (50 iterations in 0.017s)
[t-SNE] KL divergence after 1000 iterations: 0.419745
[t-SNE] Computed conditional probabilities for sample 114 / 114
[t-SNE] Mean sigma: 0.520876
Beginning preprocessing + Leiden
2024-03-11 23:24:26.350708 MEMORY 13.350371328
Affmat transformed
2024-03-11 23:24:26.352298 MEMORY 13.350371328
sources, targets, weights extracted
2024-03-11 23:24:26.352881 MEMORY 13.350371328
About to launch parallel Leiden runs
2024-03-11 23:24:26.381550 MEMORY 13.350371328
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.0s finished
Parallel Leiden runs finished
2024-03-11 23:24:28.344547 MEMORY 13.350342656
Quality: 0.23317242232066898
Quality: 0.23331997348763847
Quality: 0.2335150341829205
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  66 out of 113 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=24)]: Done 113 out of 113 | elapsed:    0.0s finished
Got subclusters: Counter({0: 39, 1: 25, 2: 19, 3: 16, 4: 15})
On pattern 18
[t-SNE] Computing 112 nearest neighbors...
[t-SNE] Indexed 113 samples in 0.001s...
[t-SNE] Computed neighbors for 113 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 113 / 113
[t-SNE] Mean sigma: 0.453685
[t-SNE] Computed conditional probabilities in 0.006s
[t-SNE] Iteration 50: error = 52.2830009, gradient norm = 0.5563327 (50 iterations in 0.018s)
[t-SNE] Iteration 100: error = 50.0767097, gradient norm = 0.5859737 (50 iterations in 0.018s)
[t-SNE] Iteration 150: error = 52.0211143, gradient norm = 0.4996947 (50 iterations in 0.017s)
[t-SNE] Iteration 200: error = 51.3603554, gradient norm = 0.5654591 (50 iterations in 0.017s)
[t-SNE] Iteration 250: error = 51.6773033, gradient norm = 0.5454911 (50 iterations in 0.017s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 51.677303
[t-SNE] Iteration 300: error = 0.5013537, gradient norm = 0.0123629 (50 iterations in 0.018s)
[t-SNE] Iteration 350: error = 0.3391099, gradient norm = 0.0036496 (50 iterations in 0.017s)
[t-SNE] Iteration 400: error = 0.3317744, gradient norm = 0.0004266 (50 iterations in 0.018s)
[t-SNE] Iteration 450: error = 0.3318476, gradient norm = 0.0003344 (50 iterations in 0.017s)
[t-SNE] Iteration 500: error = 0.3323308, gradient norm = 0.0004948 (50 iterations in 0.017s)
[t-SNE] Iteration 550: error = 0.3322649, gradient norm = 0.0005299 (50 iterations in 0.017s)
[t-SNE] Iteration 600: error = 0.3323995, gradient norm = 0.0004952 (50 iterations in 0.017s)
[t-SNE] Iteration 650: error = 0.3320873, gradient norm = 0.0004278 (50 iterations in 0.017s)
[t-SNE] Iteration 700: error = 0.3323589, gradient norm = 0.0005328 (50 iterations in 0.017s)
[t-SNE] Iteration 750: error = 0.3324567, gradient norm = 0.0004960 (50 iterations in 0.017s)
[t-SNE] Iteration 750: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 750 iterations: 0.332457
[t-SNE] Computed conditional probabilities for sample 113 / 113
[t-SNE] Mean sigma: 0.453685
Beginning preprocessing + Leiden
2024-03-11 23:24:28.767574 MEMORY 13.350371328
Affmat transformed
2024-03-11 23:24:28.768967 MEMORY 13.350371328
sources, targets, weights extracted
2024-03-11 23:24:28.769519 MEMORY 13.350371328
About to launch parallel Leiden runs
2024-03-11 23:24:28.805134 MEMORY 13.350371328
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.8s finished
Parallel Leiden runs finished
2024-03-11 23:24:30.653315 MEMORY 13.350371328
Quality: 0.24880859044638992
Quality: 0.25185841964283195
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  58 out of 105 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=24)]: Done 105 out of 105 | elapsed:    0.0s finished
Got subclusters: Counter({0: 37, 1: 33, 2: 18, 3: 14, 4: 11})
On pattern 19
[t-SNE] Computing 104 nearest neighbors...
[t-SNE] Indexed 105 samples in 0.001s...
[t-SNE] Computed neighbors for 105 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 105 / 105
[t-SNE] Mean sigma: 0.542752
[t-SNE] Computed conditional probabilities in 0.005s
[t-SNE] Iteration 50: error = 51.5967560, gradient norm = 0.5607296 (50 iterations in 0.016s)
[t-SNE] Iteration 100: error = 51.2797470, gradient norm = 0.5678114 (50 iterations in 0.017s)
[t-SNE] Iteration 150: error = 49.0615311, gradient norm = 0.5636986 (50 iterations in 0.017s)
[t-SNE] Iteration 200: error = 52.1326561, gradient norm = 0.4929224 (50 iterations in 0.016s)
[t-SNE] Iteration 250: error = 51.0211678, gradient norm = 0.4999621 (50 iterations in 0.016s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 51.021168
[t-SNE] Iteration 300: error = 0.4621654, gradient norm = 0.0183566 (50 iterations in 0.016s)
[t-SNE] Iteration 350: error = 0.3403569, gradient norm = 0.0017681 (50 iterations in 0.016s)
[t-SNE] Iteration 400: error = 0.3397736, gradient norm = 0.0006747 (50 iterations in 0.016s)
[t-SNE] Iteration 450: error = 0.3401615, gradient norm = 0.0007049 (50 iterations in 0.016s)
[t-SNE] Iteration 500: error = 0.3398716, gradient norm = 0.0003308 (50 iterations in 0.016s)
[t-SNE] Iteration 550: error = 0.3400066, gradient norm = 0.0002329 (50 iterations in 0.016s)
[t-SNE] Iteration 600: error = 0.3400602, gradient norm = 0.0002753 (50 iterations in 0.016s)
[t-SNE] Iteration 650: error = 0.3399898, gradient norm = 0.0004894 (50 iterations in 0.016s)
[t-SNE] Iteration 700: error = 0.3400247, gradient norm = 0.0003156 (50 iterations in 0.015s)
[t-SNE] Iteration 750: error = 0.3399453, gradient norm = 0.0003258 (50 iterations in 0.016s)
[t-SNE] Iteration 750: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 750 iterations: 0.339945
[t-SNE] Computed conditional probabilities for sample 105 / 105
[t-SNE] Mean sigma: 0.542752
Beginning preprocessing + Leiden
2024-03-11 23:24:31.031891 MEMORY 13.350371328
Affmat transformed
2024-03-11 23:24:31.033174 MEMORY 13.350371328
sources, targets, weights extracted
2024-03-11 23:24:31.033684 MEMORY 13.350371328
About to launch parallel Leiden runs
2024-03-11 23:24:31.091068 MEMORY 13.350371328
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.6s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.8s finished
Parallel Leiden runs finished
2024-03-11 23:24:32.926974 MEMORY 13.350371328
Quality: 0.25390021537554397
Quality: 0.25404647651315004
Quality: 0.254177234583922
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  68 out of  68 | elapsed:    0.0s finished
Got subclusters: Counter({0: 31, 1: 22, 2: 20, 3: 19, 4: 13})
On pattern 20
[t-SNE] Computing 67 nearest neighbors...
[t-SNE] Indexed 68 samples in 0.001s...
[t-SNE] Computed neighbors for 68 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 68 / 68
[t-SNE] Mean sigma: 0.663298
[t-SNE] Computed conditional probabilities in 0.002s
[t-SNE] Iteration 50: error = 47.8489380, gradient norm = 0.5646931 (50 iterations in 0.012s)
[t-SNE] Iteration 100: error = 44.2433167, gradient norm = 0.6066419 (50 iterations in 0.012s)
[t-SNE] Iteration 150: error = 48.9593735, gradient norm = 0.5212327 (50 iterations in 0.012s)
[t-SNE] Iteration 200: error = 48.3928185, gradient norm = 0.5095926 (50 iterations in 0.012s)
[t-SNE] Iteration 250: error = 48.3572197, gradient norm = 0.4722588 (50 iterations in 0.012s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 48.357220
[t-SNE] Iteration 300: error = 0.7961744, gradient norm = 0.0026747 (50 iterations in 0.013s)
[t-SNE] Iteration 350: error = 0.6771098, gradient norm = 0.0018882 (50 iterations in 0.012s)
[t-SNE] Iteration 400: error = 0.6165341, gradient norm = 0.0024386 (50 iterations in 0.013s)
[t-SNE] Iteration 450: error = 0.5509027, gradient norm = 0.0011920 (50 iterations in 0.012s)
[t-SNE] Iteration 500: error = 0.3616324, gradient norm = 0.0266811 (50 iterations in 0.012s)
[t-SNE] Iteration 550: error = 0.1062719, gradient norm = 0.0148544 (50 iterations in 0.012s)
[t-SNE] Iteration 600: error = 0.0973122, gradient norm = 0.0050752 (50 iterations in 0.012s)
[t-SNE] Iteration 650: error = 0.0965243, gradient norm = 0.0016695 (50 iterations in 0.012s)
[t-SNE] Iteration 700: error = 0.0965264, gradient norm = 0.0010009 (50 iterations in 0.012s)
[t-SNE] Iteration 750: error = 0.0963326, gradient norm = 0.0011957 (50 iterations in 0.012s)
[t-SNE] Iteration 800: error = 0.0964725, gradient norm = 0.0011873 (50 iterations in 0.012s)
[t-SNE] Iteration 850: error = 0.0963046, gradient norm = 0.0010509 (50 iterations in 0.012s)
[t-SNE] Iteration 900: error = 0.0963917, gradient norm = 0.0012191 (50 iterations in 0.012s)
[t-SNE] Iteration 950: error = 0.0963232, gradient norm = 0.0012834 (50 iterations in 0.012s)
[t-SNE] Iteration 1000: error = 0.0966874, gradient norm = 0.0010927 (50 iterations in 0.013s)
[t-SNE] KL divergence after 1000 iterations: 0.096687
[t-SNE] Computed conditional probabilities for sample 68 / 68
[t-SNE] Mean sigma: 0.663299
Beginning preprocessing + Leiden
2024-03-11 23:24:33.254812 MEMORY 13.350371328
Affmat transformed
2024-03-11 23:24:33.255694 MEMORY 13.350371328
sources, targets, weights extracted
2024-03-11 23:24:33.256065 MEMORY 13.350371328
About to launch parallel Leiden runs
2024-03-11 23:24:33.281910 MEMORY 13.350371328
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.6s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.7s finished
Parallel Leiden runs finished
2024-03-11 23:24:35.002955 MEMORY 13.350371328
Quality: 0.16145819983773607
Quality: 0.16395273999132076
Quality: 0.16505313510419492
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done  48 out of  48 | elapsed:    0.0s finished
Got subclusters: Counter({0: 30, 1: 29, 2: 6, 3: 3})
On pattern 21
[t-SNE] Computing 47 nearest neighbors...
[t-SNE] Indexed 48 samples in 0.000s...
[t-SNE] Computed neighbors for 48 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 48 / 48
[t-SNE] Mean sigma: 12.393547
[t-SNE] Computed conditional probabilities in 0.001s
[t-SNE] Iteration 50: error = 47.3283005, gradient norm = 0.5350716 (50 iterations in 0.011s)
[t-SNE] Iteration 100: error = 43.4438324, gradient norm = 0.6078629 (50 iterations in 0.011s)
[t-SNE] Iteration 150: error = 45.4756126, gradient norm = 0.6634589 (50 iterations in 0.011s)
[t-SNE] Iteration 200: error = 41.8046379, gradient norm = 0.6216816 (50 iterations in 0.011s)
[t-SNE] Iteration 250: error = 43.1021080, gradient norm = 0.5412807 (50 iterations in 0.011s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 43.102108
[t-SNE] Iteration 300: error = 0.8033160, gradient norm = 0.0011164 (50 iterations in 0.011s)
[t-SNE] Iteration 350: error = 0.6824646, gradient norm = 0.0005730 (50 iterations in 0.011s)
[t-SNE] Iteration 400: error = 0.6114027, gradient norm = 0.0001122 (50 iterations in 0.011s)
[t-SNE] Iteration 450: error = 0.6087974, gradient norm = 0.0000490 (50 iterations in 0.011s)
[t-SNE] Iteration 500: error = 0.6085659, gradient norm = 0.0000386 (50 iterations in 0.010s)
[t-SNE] Iteration 550: error = 0.6073612, gradient norm = 0.0000358 (50 iterations in 0.010s)
[t-SNE] Iteration 600: error = 0.6063760, gradient norm = 0.0000276 (50 iterations in 0.011s)
[t-SNE] Iteration 650: error = 0.6067048, gradient norm = 0.0000320 (50 iterations in 0.012s)
[t-SNE] Iteration 700: error = 0.6060117, gradient norm = 0.0000282 (50 iterations in 0.010s)
[t-SNE] Iteration 750: error = 0.6057839, gradient norm = 0.0000205 (50 iterations in 0.012s)
[t-SNE] Iteration 800: error = 0.6058654, gradient norm = 0.0000208 (50 iterations in 0.011s)
[t-SNE] Iteration 850: error = 0.6058946, gradient norm = 0.0000147 (50 iterations in 0.010s)
[t-SNE] Iteration 900: error = 0.6059104, gradient norm = 0.0000137 (50 iterations in 0.010s)
[t-SNE] Iteration 950: error = 0.6057616, gradient norm = 0.0000151 (50 iterations in 0.010s)
[t-SNE] Iteration 1000: error = 0.6060330, gradient norm = 0.0000221 (50 iterations in 0.011s)
[t-SNE] KL divergence after 1000 iterations: 0.606033
[t-SNE] Computed conditional probabilities for sample 48 / 48
[t-SNE] Mean sigma: 1125899906842624.000000
Beginning preprocessing + Leiden
2024-03-11 23:24:35.270764 MEMORY 13.350371328
Affmat transformed
2024-03-11 23:24:35.271538 MEMORY 13.350371328
sources, targets, weights extracted
2024-03-11 23:24:35.271875 MEMORY 13.350371328
About to launch parallel Leiden runs
2024-03-11 23:24:35.340114 MEMORY 13.350371328
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.6s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.7s finished
Parallel Leiden runs finished
2024-03-11 23:24:37.025346 MEMORY 13.350371328
Quality: 8.88178419700137e-16
Got subclusters: Counter({0: 48})
On metacluster 2
Metacluster size 5871
Relevant tasks:  ('head',)
Relevant signs:  (-1,)
TfModiscoSeqletsToPatternsFactory: seed=1234
(Round 1) num seqlets: 5871
(Round 1) Computing coarse affmat
2024-03-11 23:24:39.277901 MEMORY 13.330972672
Beginning embedding computation
MEMORY 13.330972672
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 152 tasks      | elapsed:    2.0s
[Parallel(n_jobs=24)]: Done 402 tasks      | elapsed:    4.8s
[Parallel(n_jobs=24)]: Done 752 tasks      | elapsed:    8.7s
[Parallel(n_jobs=24)]: Done 1202 tasks      | elapsed:   13.7s
[Parallel(n_jobs=24)]: Done 1752 tasks      | elapsed:   19.8s
[Parallel(n_jobs=24)]: Done 2402 tasks      | elapsed:   27.1s
[Parallel(n_jobs=24)]: Done 3152 tasks      | elapsed:   35.5s
[Parallel(n_jobs=24)]: Done 4002 tasks      | elapsed:   44.8s
[Parallel(n_jobs=24)]: Done 4952 tasks      | elapsed:   55.3s
[Parallel(n_jobs=24)]: Done 5871 out of 5871 | elapsed:  1.1min finished
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 152 tasks      | elapsed:    1.9s
[Parallel(n_jobs=24)]: Done 402 tasks      | elapsed:    4.7s
[Parallel(n_jobs=24)]: Done 752 tasks      | elapsed:    8.5s
[Parallel(n_jobs=24)]: Done 1202 tasks      | elapsed:   13.4s
[Parallel(n_jobs=24)]: Done 1752 tasks      | elapsed:   19.4s
[Parallel(n_jobs=24)]: Done 2402 tasks      | elapsed:   26.5s
[Parallel(n_jobs=24)]: Done 3152 tasks      | elapsed:   34.8s
[Parallel(n_jobs=24)]: Done 4002 tasks      | elapsed:   44.1s
[Parallel(n_jobs=24)]: Done 4952 tasks      | elapsed:   54.5s
[Parallel(n_jobs=24)]: Done 5871 out of 5871 | elapsed:  1.1min finished
At the beginning of embedding call
2024-03-11 23:24:39.278166 MEMORY 13.330972672
before computing embeddings fwd
2024-03-11 23:24:39.286865 MEMORY 13.330972672
after computing embeddings fwd
2024-03-11 23:25:44.735599 MEMORY 13.31849216
after computing embeddings rev
2024-03-11 23:26:49.264540 MEMORY 13.512409088
before computing sparse embeddings fwd
2024-03-11 23:26:49.264647 MEMORY 13.512409088
Constructing csr matrix...
csr matrix made in 0.7597057819366455 s
after computing sparse embeddings fwd
2024-03-11 23:26:50.372831 MEMORY 13.71109376
before computing sparse embeddings rev
2024-03-11 23:26:50.372996 MEMORY 13.71109376
Constructing csr matrix...
csr matrix made in 0.6691644191741943 s
after computing sparse embeddings rev
2024-03-11 23:26:51.302934 MEMORY 13.746888704
Finished embedding computation in 133.76 s
MEMORY 13.58432256
Starting affinity matrix computations
MEMORY 13.58432256
Batching in slices of size 5871
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:05<00:00,  5.13s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:05<00:00,  5.13s/it]
Finished affinity matrix computations in 5.18 s
MEMORY 13.584621568
(Round 1) Computed coarse affmat
2024-03-11 23:26:59.373563 MEMORY 13.350432768
(Round 1) Computing affinity matrix on nearest neighbors
2024-03-11 23:26:59.373723 MEMORY 13.350432768
Launching nearest neighbors affmat calculation job
MEMORY 13.377507328
Parallel runs completed
MEMORY 13.423443968
Job completed in: 18.87 s
MEMORY 13.421248512
Launching nearest neighbors affmat calculation job
MEMORY 13.4168576
Parallel runs completed
MEMORY 13.467193344
Job completed in: 18.61 s
MEMORY 13.4654976
(Round 1) Computed affinity matrix on nearest neighbors in 40.1 s
2024-03-11 23:27:39.474171 MEMORY 13.461639168
Filtered down to 5773 of 5871
(Round 1) Retained 5773 rows out of 5871 after filtering
2024-03-11 23:27:42.624997 MEMORY 13.461966848
(Round 1) Computing density adapted affmat
2024-03-11 23:27:45.296216 MEMORY 13.461970944
Symmetrizing nearest neighbors
Computing betas for density adaptation
Computing normalizing denominators
(Round 1) Computing clustering
2024-03-11 23:28:35.072865 MEMORY 13.522169856
Beginning preprocessing + Leiden
2024-03-11 23:28:35.081284 MEMORY 13.522169856
Affmat transformed
2024-03-11 23:28:35.081409 MEMORY 13.522169856
sources, targets, weights extracted
2024-03-11 23:28:35.297328 MEMORY 13.555290112
About to launch parallel Leiden runs
2024-03-11 23:28:35.397254 MEMORY 13.489168384
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:   31.5s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:  1.9min finished
Parallel Leiden runs finished
2024-03-11 23:30:30.405595 MEMORY 13.489143808
Quality: 0.33307617687157276
Quality: 0.3330762417829046
Got 4 clusters after round 1
Counts:
{0: 2006, 1: 1615, 2: 1112, 3: 1040}
2024-03-11 23:30:30.422352 MEMORY 13.406294016
(Round 1) Aggregating seqlets in each cluster
2024-03-11 23:30:30.422447 MEMORY 13.406294016
Aggregating for cluster 0 with 2006 seqlets
2024-03-11 23:30:30.427398 MEMORY 13.406302208
Skipped 5 due to duplicates
Trimming eliminated 0 seqlets out of 2001
Aggregating for cluster 1 with 1615 seqlets
2024-03-11 23:30:34.822378 MEMORY 13.406388224
Skipped 3 due to duplicates
Trimming eliminated 0 seqlets out of 1612
Aggregating for cluster 2 with 1112 seqlets
2024-03-11 23:30:38.136223 MEMORY 13.406388224
Trimming eliminated 0 seqlets out of 1112
Aggregating for cluster 3 with 1040 seqlets
2024-03-11 23:30:40.711858 MEMORY 13.406388224
Skipped 1 due to duplicates
Trimming eliminated 0 seqlets out of 1039
(Round 2) num seqlets: 5762
(Round 2) Computing coarse affmat
2024-03-11 23:30:44.183686 MEMORY 13.4064128
Beginning embedding computation
MEMORY 13.4064128
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 368 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done 1368 tasks      | elapsed:    2.0s
[Parallel(n_jobs=24)]: Done 2768 tasks      | elapsed:    4.0s
[Parallel(n_jobs=24)]: Done 4568 tasks      | elapsed:    6.4s
[Parallel(n_jobs=24)]: Done 5762 out of 5762 | elapsed:    8.1s finished
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 368 tasks      | elapsed:    0.8s
[Parallel(n_jobs=24)]: Done 1368 tasks      | elapsed:    2.2s
[Parallel(n_jobs=24)]: Done 2768 tasks      | elapsed:    4.0s
[Parallel(n_jobs=24)]: Done 4568 tasks      | elapsed:    6.5s
[Parallel(n_jobs=24)]: Done 5715 out of 5762 | elapsed:    8.1s remaining:    0.1s
[Parallel(n_jobs=24)]: Done 5762 out of 5762 | elapsed:    8.2s finished
At the beginning of embedding call
2024-03-11 23:30:44.183914 MEMORY 13.4064128
before computing embeddings fwd
2024-03-11 23:30:44.192583 MEMORY 13.406416896
after computing embeddings fwd
2024-03-11 23:30:52.255122 MEMORY 13.528788992
after computing embeddings rev
2024-03-11 23:31:00.448666 MEMORY 13.763383296
before computing sparse embeddings fwd
2024-03-11 23:31:00.448757 MEMORY 13.763383296
Constructing csr matrix...
csr matrix made in 0.6582677364349365 s
after computing sparse embeddings fwd
2024-03-11 23:31:01.394732 MEMORY 13.959954432
before computing sparse embeddings rev
2024-03-11 23:31:01.394815 MEMORY 13.959954432
Constructing csr matrix...
csr matrix made in 0.6352243423461914 s
after computing sparse embeddings rev
2024-03-11 23:31:02.238849 MEMORY 13.994737664
Finished embedding computation in 19.51 s
MEMORY 13.802467328
Starting affinity matrix computations
MEMORY 13.802467328
Batching in slices of size 5762
  0%|          | 0/1 [00:00<?, ?it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:05<00:00,  5.59s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:05<00:00,  5.59s/it]
Finished affinity matrix computations in 5.62 s
MEMORY 13.802467328
(Round 2) Computed coarse affmat
2024-03-11 23:31:10.450331 MEMORY 13.570674688
(Round 2) Computing affinity matrix on nearest neighbors
2024-03-11 23:31:10.450482 MEMORY 13.570674688
Launching nearest neighbors affmat calculation job
MEMORY 13.570674688
Parallel runs completed
MEMORY 13.587984384
Job completed in: 9.1 s
MEMORY 13.587787776
Launching nearest neighbors affmat calculation job
MEMORY 13.58764032
Parallel runs completed
MEMORY 13.593796608
Job completed in: 9.16 s
MEMORY 13.591576576
(Round 2) Computed affinity matrix on nearest neighbors in 20.08 s
2024-03-11 23:31:30.533351 MEMORY 13.612244992
Not applying filtering for rounds above first round
2024-03-11 23:31:30.534157 MEMORY 13.612244992
(Round 2) Computing density adapted affmat
2024-03-11 23:31:32.620568 MEMORY 13.616631808
Symmetrizing nearest neighbors
Computing betas for density adaptation
Computing normalizing denominators
(Round 2) Computing clustering
2024-03-11 23:32:18.174516 MEMORY 13.860401152
Beginning preprocessing + Leiden
2024-03-11 23:32:18.182408 MEMORY 13.860401152
Affmat transformed
2024-03-11 23:32:18.182554 MEMORY 13.860401152
sources, targets, weights extracted
2024-03-11 23:32:18.374986 MEMORY 13.860401152
About to launch parallel Leiden runs
2024-03-11 23:32:18.465094 MEMORY 13.860401152
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:   20.6s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:  1.3min finished
Parallel Leiden runs finished
2024-03-11 23:33:36.350801 MEMORY 13.860429824
Quality: 0.4558574685960757
Quality: 0.4558602098703158
Got 4 clusters after round 2
Counts:
{1: 1825, 0: 1910, 3: 874, 2: 1153}
2024-03-11 23:33:36.366612 MEMORY 13.860429824
(Round 2) Aggregating seqlets in each cluster
2024-03-11 23:33:36.366709 MEMORY 13.860429824
Aggregating for cluster 0 with 1910 seqlets
2024-03-11 23:33:36.370986 MEMORY 13.860429824
Trimming eliminated 0 seqlets out of 1910
Aggregating for cluster 1 with 1825 seqlets
2024-03-11 23:33:40.358762 MEMORY 13.86016768
Skipped 2 due to duplicates
Trimming eliminated 0 seqlets out of 1823
Aggregating for cluster 2 with 1153 seqlets
2024-03-11 23:33:43.126110 MEMORY 13.86016768
Skipped 1 due to duplicates
Trimming eliminated 0 seqlets out of 1152
Aggregating for cluster 3 with 874 seqlets
2024-03-11 23:33:44.858424 MEMORY 13.86016768
Skipped 1 due to duplicates
Trimming eliminated 0 seqlets out of 873
Got 4 clusters
Splitting into subclusters...
2024-03-11 23:33:46.615837 MEMORY 13.86016768
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 1650 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 1910 out of 1910 | elapsed:    0.4s finished
Inspecting pattern 0 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 1910
[t-SNE] Computed conditional probabilities for sample 1910 / 1910
[t-SNE] Mean sigma: 0.286225
Beginning preprocessing + Leiden
2024-03-11 23:33:49.095670 MEMORY 13.860220928
Affmat transformed
2024-03-11 23:33:49.118044 MEMORY 13.860220928
sources, targets, weights extracted
2024-03-11 23:33:49.134792 MEMORY 13.860220928
About to launch parallel Leiden runs
2024-03-11 23:33:49.158319 MEMORY 13.860220928
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    6.1s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   20.0s finished
Parallel Leiden runs finished
2024-03-11 23:34:09.161844 MEMORY 13.860225024
Quality: 0.49156688074804544
Quality: 0.49255633577402086
Quality: 0.49257957081630094
Got subclusters: Counter({0: 372, 1: 332, 2: 323, 3: 308, 4: 290, 5: 176, 6: 86, 7: 23})
On merging iteration 1
Numbers for each pattern pre-subsample: [372, 332, 323, 308, 290, 176, 86, 23]
Numbers after subsampling: [300, 300, 300, 300, 290, 176, 86, 23]
Computing sims for pattern 0
Computed sims for pattern 0 in 2.091707706451416 s
Computing sims for pattern 1
Computed sims for pattern 1 in 2.085707664489746 s
Computing sims for pattern 2
Computed sims for pattern 2 in 2.112175464630127 s
Computing sims for pattern 3
Computed sims for pattern 3 in 2.1444413661956787 s
Computing sims for pattern 4
Computed sims for pattern 4 in 2.039555549621582 s
Computing sims for pattern 5
Computed sims for pattern 5 in 1.3776531219482422 s
Computing sims for pattern 6
Computed sims for pattern 6 in 0.7722373008728027 s
Computing sims for pattern 7
Computed sims for pattern 7 in 0.2994577884674072 s
Cluster sizes
[372 332 323 308 290 176  86  23]
Cross-contamination matrix:
[[1.   0.18 0.29 0.88 0.16 0.67 0.41 0.57]
 [1.   1.   0.85 1.   0.71 0.85 0.51 0.81]
 [0.81 0.45 1.   1.   0.67 0.57 0.36 0.7 ]
 [0.71 0.12 0.31 1.   0.15 0.48 0.34 0.49]
 [0.66 0.42 0.78 0.85 1.   0.52 0.29 0.61]
 [0.87 0.24 0.32 0.82 0.23 1.   0.53 0.62]
 [0.83 0.16 0.26 0.89 0.16 0.7  1.   0.6 ]
 [0.52 0.1  0.2  0.58 0.12 0.39 0.25 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.76 0.76 0.96 0.68 0.92 0.91 0.81]
 [0.76 1.   0.75 0.74 0.67 0.73 0.6  0.63]
 [0.76 0.75 1.   0.87 0.89 0.67 0.61 0.73]
 [0.96 0.74 0.87 1.   0.79 0.9  0.9  0.84]
 [0.68 0.67 0.89 0.79 1.   0.67 0.56 0.69]
 [0.92 0.73 0.67 0.9  0.67 1.   0.89 0.77]
 [0.91 0.6  0.61 0.9  0.56 0.89 1.   0.77]
 [0.81 0.63 0.73 0.84 0.69 0.77 0.77 1.  ]]
Collapsing 0 & 3 with crosscontam 0.7137399871604937 and sim 0.9550420199586837
Collapsing 0 & 5 with crosscontam 0.6682983914141416 and sim 0.9188198073307715
Collapsing 0 & 6 with crosscontam 0.4143036279069767 and sim 0.9104994275270794
Collapsing 3 & 6 with crosscontam 0.3402054521963822 and sim 0.901765011200461
Collapsing 5 & 6 with crosscontam 0.5302144424299573 and sim 0.8948399865131726
Collapsing 2 & 4 with crosscontam 0.6709881833971902 and sim 0.8924671980594842
Trimming eliminated 0 seqlets out of 680
Trimming eliminated 0 seqlets out of 856
Trimming eliminated 0 seqlets out of 942
Trimming eliminated 0 seqlets out of 613
Unmerged patterns remapping: OrderedDict([(1, 2), (7, 3)])
Time spent on merging iteration: 5.169199705123901
On merging iteration 2
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 1650 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 1823 out of 1823 | elapsed:    0.3s finished
Numbers for each pattern pre-subsample: [942, 613, 332, 23]
Numbers after subsampling: [300, 300, 300, 23]
Computing sims for pattern 0
Computed sims for pattern 0 in 0.927177906036377 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.9190940856933594 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.7073245048522949 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.09995865821838379 s
Cluster sizes
[942 613 332  23]
Cross-contamination matrix:
[[1.   0.34 0.26 0.73]
 [0.84 1.   0.53 0.79]
 [0.96 0.76 1.   0.81]
 [0.5  0.16 0.1  1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.78 0.76 0.83]
 [0.78 1.   0.73 0.73]
 [0.76 0.73 1.   0.63]
 [0.83 0.73 0.63 1.  ]]
Inspecting pattern 1 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 1823
[t-SNE] Computed conditional probabilities for sample 1823 / 1823
[t-SNE] Mean sigma: 0.287422
Beginning preprocessing + Leiden
2024-03-11 23:34:32.528215 MEMORY 13.860581376
Affmat transformed
2024-03-11 23:34:32.549583 MEMORY 13.860581376
sources, targets, weights extracted
2024-03-11 23:34:32.564591 MEMORY 13.860581376
About to launch parallel Leiden runs
2024-03-11 23:34:32.608750 MEMORY 13.860581376
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    6.3s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   19.0s finished
Parallel Leiden runs finished
2024-03-11 23:34:51.591042 MEMORY 13.860581376
Quality: 0.45473127812250197
Got subclusters: Counter({0: 287, 1: 208, 2: 207, 3: 199, 4: 189, 5: 187, 6: 163, 7: 146, 8: 125, 9: 112})
On merging iteration 1
Numbers for each pattern pre-subsample: [287, 208, 207, 199, 189, 187, 163, 146, 125, 112]
Numbers after subsampling: [287, 208, 207, 199, 189, 187, 163, 146, 125, 112]
Computing sims for pattern 0
Computed sims for pattern 0 in 2.504192352294922 s
Computing sims for pattern 1
Computed sims for pattern 1 in 2.148221731185913 s
Computing sims for pattern 2
Computed sims for pattern 2 in 2.160630941390991 s
Computing sims for pattern 3
Computed sims for pattern 3 in 2.135044574737549 s
Computing sims for pattern 4
Computed sims for pattern 4 in 1.9634666442871094 s
Computing sims for pattern 5
Computed sims for pattern 5 in 1.9265694618225098 s
Computing sims for pattern 6
Computed sims for pattern 6 in 1.567500114440918 s
Computing sims for pattern 7
Computed sims for pattern 7 in 1.421234369277954 s
Computing sims for pattern 8
Computed sims for pattern 8 in 1.3528733253479004 s
Computing sims for pattern 9
Computed sims for pattern 9 in 1.1659748554229736 s
Cluster sizes
[287 208 207 199 189 187 163 146 125 112]
Cross-contamination matrix:
[[1.   0.62 0.91 0.67 0.71 0.51 0.73 0.5  0.55 0.69]
 [0.74 1.   0.76 0.76 0.61 0.41 0.54 0.65 0.59 0.58]
 [0.76 0.5  1.   0.65 0.56 0.44 0.63 0.4  0.48 0.59]
 [0.77 0.74 0.91 1.   0.62 0.48 0.7  0.59 0.65 0.72]
 [0.87 0.61 0.86 0.65 1.   0.6  0.8  0.42 0.61 0.76]
 [0.95 0.66 1.   0.81 0.92 1.   0.9  0.62 0.75 0.9 ]
 [0.72 0.41 0.77 0.59 0.64 0.45 1.   0.32 0.44 0.68]
 [0.84 0.89 0.89 0.85 0.6  0.52 0.61 1.   0.7  0.57]
 [0.83 0.74 0.91 0.84 0.77 0.61 0.72 0.65 1.   0.75]
 [0.55 0.33 0.61 0.48 0.48 0.32 0.56 0.2  0.35 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.83 0.98 0.93 0.95 0.95 0.93 0.84 0.91 0.93]
 [0.83 1.   0.84 0.88 0.73 0.75 0.72 0.9  0.81 0.74]
 [0.98 0.84 1.   0.93 0.93 0.93 0.91 0.85 0.88 0.9 ]
 [0.93 0.88 0.93 1.   0.86 0.87 0.88 0.88 0.88 0.89]
 [0.95 0.73 0.93 0.86 1.   0.94 0.94 0.76 0.87 0.87]
 [0.95 0.75 0.93 0.87 0.94 1.   0.91 0.81 0.87 0.88]
 [0.93 0.72 0.91 0.88 0.94 0.91 1.   0.76 0.82 0.89]
 [0.84 0.9  0.85 0.88 0.76 0.81 0.76 1.   0.81 0.74]
 [0.91 0.81 0.88 0.88 0.87 0.87 0.82 0.81 1.   0.84]
 [0.93 0.74 0.9  0.89 0.87 0.88 0.89 0.74 0.84 1.  ]]
Collapsing 0 & 2 with crosscontam 0.7623265191133735 and sim 0.9774239895662755
Collapsing 0 & 4 with crosscontam 0.7104351543898526 and sim 0.9471157008204966
Collapsing 0 & 5 with crosscontam 0.5137937284997875 and sim 0.9465579203354397
Collapsing 4 & 5 with crosscontam 0.5975133296053432 and sim 0.9415899554513985
Collapsing 4 & 6 with crosscontam 0.6376384426258963 and sim 0.9382932460878467
Collapsing 2 & 5 with crosscontam 0.4398105498044922 and sim 0.9333334270214189
Collapsing 0 & 9 with crosscontam 0.5538793342903361 and sim 0.9314452540821552
Collapsing 0 & 6 with crosscontam 0.7244511476071775 and sim 0.9302191191586644
Collapsing 2 & 3 with crosscontam 0.6504549161907502 and sim 0.9296523017558658
Collapsing 0 & 3 with crosscontam 0.672860990280441 and sim 0.9274346376728356
Collapsing 2 & 4 with crosscontam 0.5565829022991196 and sim 0.9250874576810021
Collapsing 2 & 6 with crosscontam 0.6344716682362508 and sim 0.910487953134429
Collapsing 5 & 6 with crosscontam 0.44608043308145295 and sim 0.9056164630159755
Collapsing 0 & 8 with crosscontam 0.5458125786725945 and sim 0.9053879865260581
Collapsing 2 & 9 with crosscontam 0.5923539240571651 and sim 0.9014011187808733
Collapsing 1 & 7 with crosscontam 0.6528047281015597 and sim 0.8977908088910106
Collapsing 6 & 9 with crosscontam 0.5611876344260316 and sim 0.8947923089800004
Collapsing 1 & 3 with crosscontam 0.7414307153359982 and sim 0.8825476580949771
Aborting collapse as 7 & 9 have cross-contam 0.38379415759740887 and sim 0.7440484790090507
Collapsing 3 & 8 with crosscontam 0.6515305143682606 and sim 0.8790893537880513
Collapsing 3 & 7 with crosscontam 0.5919401019316508 and sim 0.8773389639109505
Aborting collapse as 7 & 9 have cross-contam 0.38379415759740887 and sim 0.7440484790090507
Collapsing 3 & 6 with crosscontam 0.587241594549242 and sim 0.8753038823925007
Collapsing 5 & 8 with crosscontam 0.6093583058823531 and sim 0.873338706339603
Collapsing 4 & 8 with crosscontam 0.609980754729222 and sim 0.8722553576100679
Collapsing 3 & 4 with crosscontam 0.6184222838576143 and sim 0.8605569457252301
Trimming eliminated 0 seqlets out of 494
Trimming eliminated 0 seqlets out of 683
Trimming eliminated 0 seqlets out of 870
Trimming eliminated 0 seqlets out of 1033
Trimming eliminated 0 seqlets out of 1145
Trimming eliminated 0 seqlets out of 1344
Trimming eliminated 0 seqlets out of 1469
Trimming eliminated 0 seqlets out of 354
Unmerged patterns remapping: OrderedDict()
Time spent on merging iteration: 9.817822217941284
On merging iteration 2
Numbers for each pattern pre-subsample: [1469, 354]
Numbers after subsampling: [300, 300]
Computing sims for pattern 0
Computed sims for pattern 0 in 0.3496978282928467 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.3543386459350586 s
Cluster sizes
[1469  354]
Cross-contamination matrix:
[[1.   0.76]
 [0.79 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.85]
 [0.85 1.  ]]
Collapsing 0 & 1 with crosscontam 0.7601865288888889 and sim 0.8514627246055885
Trimming eliminated 0 seqlets out of 1823
Unmerged patterns remapping: OrderedDict()
Time spent on merging iteration: 3.0881457328796387
On merging iteration 3
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 1152 out of 1152 | elapsed:    0.4s finished
Numbers for each pattern pre-subsample: [1823]
Numbers after subsampling: [300]
Computing sims for pattern 0
Computed sims for pattern 0 in 0.0001983642578125 s
Cluster sizes
[1823]
Cross-contamination matrix:
[[1.]]
Pattern-to-pattern sim matrix:
[[1.]]
Inspecting pattern 2 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 1152
[t-SNE] Computed conditional probabilities for sample 1152 / 1152
[t-SNE] Mean sigma: 0.324733
Beginning preprocessing + Leiden
2024-03-11 23:35:24.078461 MEMORY 13.860581376
Affmat transformed
2024-03-11 23:35:24.092160 MEMORY 13.860581376
sources, targets, weights extracted
2024-03-11 23:35:24.101406 MEMORY 13.860581376
About to launch parallel Leiden runs
2024-03-11 23:35:24.143207 MEMORY 13.860581376
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    3.1s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   12.3s finished
Parallel Leiden runs finished
2024-03-11 23:35:36.424241 MEMORY 13.860581376
Quality: 0.4442483258623781
Quality: 0.4451405512817052
Quality: 0.4454875486835756
Quality: 0.44584566857060803
Got subclusters: Counter({0: 246, 1: 193, 2: 182, 3: 166, 4: 137, 5: 133, 6: 95})
On merging iteration 1
Numbers for each pattern pre-subsample: [246, 193, 182, 166, 137, 133, 95]
Numbers after subsampling: [246, 193, 182, 166, 137, 133, 95]
Computing sims for pattern 0
Computed sims for pattern 0 in 1.2443556785583496 s
Computing sims for pattern 1
Computed sims for pattern 1 in 1.239389419555664 s
Computing sims for pattern 2
Computed sims for pattern 2 in 1.1463825702667236 s
Computing sims for pattern 3
Computed sims for pattern 3 in 2.285573959350586 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.9143755435943604 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.8847014904022217 s
Computing sims for pattern 6
Computed sims for pattern 6 in 0.6718060970306396 s
Cluster sizes
[246 193 182 166 137 133  95]
Cross-contamination matrix:
[[1.   0.59 0.57 0.38 0.63 0.68 0.58]
 [0.61 1.   0.5  0.32 0.64 0.7  0.53]
 [0.82 0.72 1.   0.52 0.65 0.61 0.67]
 [0.92 0.8  0.84 1.   0.76 0.85 0.82]
 [0.76 0.75 0.55 0.38 1.   0.72 0.5 ]
 [0.68 0.68 0.42 0.36 0.6  1.   0.62]
 [0.72 0.64 0.58 0.43 0.5  0.76 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.8  0.85 0.85 0.88 0.84 0.8 ]
 [0.8  1.   0.8  0.71 0.82 0.82 0.73]
 [0.85 0.8  1.   0.79 0.83 0.69 0.75]
 [0.85 0.71 0.79 1.   0.73 0.74 0.73]
 [0.88 0.82 0.83 0.73 1.   0.81 0.73]
 [0.84 0.82 0.69 0.74 0.81 1.   0.84]
 [0.8  0.73 0.75 0.73 0.73 0.84 1.  ]]
Collapsing 0 & 4 with crosscontam 0.630639064133903 and sim 0.8822825187218925
Collapsing 0 & 2 with crosscontam 0.5723800318009629 and sim 0.850771384130441
Trimming eliminated 0 seqlets out of 383
Trimming eliminated 0 seqlets out of 565
Unmerged patterns remapping: OrderedDict([(1, 1), (3, 2), (5, 3), (6, 4)])
Time spent on merging iteration: 2.0228285789489746
On merging iteration 2
Numbers for each pattern pre-subsample: [565, 193, 166, 133, 95]
Numbers after subsampling: [300, 193, 166, 133, 95]
Computing sims for pattern 0
Computed sims for pattern 0 in 1.1367266178131104 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.23220229148864746 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.19700884819030762 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.1806173324584961 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.1350235939025879 s
Cluster sizes
[565 193 166 133  95]
Cross-contamination matrix:
[[1.   0.86 0.63 0.87 0.8 ]
 [0.59 1.   0.32 0.7  0.53]
 [0.87 0.8  1.   0.85 0.82]
 [0.58 0.68 0.36 1.   0.62]
 [0.63 0.64 0.43 0.76 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.85 0.84 0.87 0.87]
 [0.85 1.   0.71 0.82 0.73]
 [0.84 0.71 1.   0.74 0.73]
 [0.87 0.82 0.74 1.   0.84]
 [0.87 0.73 0.73 0.84 1.  ]]
Collapsing 0 & 4 with crosscontam 0.6270662584438935 and sim 0.8746502363511567
Collapsing 0 & 3 with crosscontam 0.5820274299293375 and sim 0.8683726804713666
Collapsing 0 & 1 with crosscontam 0.5864449741693059 and sim 0.8525162110257827
Trimming eliminated 0 seqlets out of 660
Trimming eliminated 0 seqlets out of 793
Trimming eliminated 0 seqlets out of 986
Unmerged patterns remapping: OrderedDict([(2, 1)])
Time spent on merging iteration: 3.358858585357666
On merging iteration 3
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 873 out of 873 | elapsed:    0.3s finished
Numbers for each pattern pre-subsample: [986, 166]
Numbers after subsampling: [300, 166]
Computing sims for pattern 0
Computed sims for pattern 0 in 0.3014540672302246 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.2035689353942871 s
Cluster sizes
[986 166]
Cross-contamination matrix:
[[1.   0.68]
 [0.85 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.85]
 [0.85 1.  ]]
Inspecting pattern 3 for spurious merging
[t-SNE] Computed conditional probabilities for sample 873 / 873
[t-SNE] Mean sigma: 0.359828
Beginning preprocessing + Leiden
2024-03-11 23:35:53.356078 MEMORY 13.860581376
Affmat transformed
2024-03-11 23:35:53.366493 MEMORY 13.860581376
sources, targets, weights extracted
2024-03-11 23:35:53.372890 MEMORY 13.860581376
About to launch parallel Leiden runs
2024-03-11 23:35:53.421881 MEMORY 13.860581376
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    2.3s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    7.5s finished
Parallel Leiden runs finished
2024-03-11 23:36:00.889904 MEMORY 13.860581376
Quality: 0.5086255417935042
Quality: 0.5090446307458861
Quality: 0.509061240858891
Got subclusters: Counter({0: 191, 1: 156, 2: 138, 3: 135, 4: 102, 5: 96, 6: 55})
On merging iteration 1
Numbers for each pattern pre-subsample: [191, 156, 138, 135, 102, 96, 55]
Numbers after subsampling: [191, 156, 138, 135, 102, 96, 55]
Computing sims for pattern 0
Computed sims for pattern 0 in 1.156402587890625 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.8633894920349121 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.8671398162841797 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.8587539196014404 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.607501745223999 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.5141196250915527 s
Computing sims for pattern 6
Computed sims for pattern 6 in 0.3746984004974365 s
Cluster sizes
[191 156 138 135 102  96  55]
Cross-contamination matrix:
[[1.   0.84 0.99 0.68 0.85 0.89 0.89]
 [0.44 1.   0.58 0.62 0.76 0.56 0.69]
 [0.25 0.25 1.   0.24 0.27 0.99 0.5 ]
 [0.46 0.75 0.68 1.   0.55 0.59 0.57]
 [0.5  0.83 0.63 0.43 1.   0.6  0.64]
 [0.2  0.24 0.68 0.21 0.22 1.   0.26]
 [0.25 0.42 0.69 0.23 0.28 0.5  1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.6  0.66 0.55 0.62 0.51 0.64]
 [0.6  1.   0.55 0.77 0.81 0.6  0.57]
 [0.66 0.55 1.   0.55 0.63 0.92 0.78]
 [0.55 0.77 0.55 1.   0.5  0.52 0.53]
 [0.62 0.81 0.63 0.5  1.   0.64 0.57]
 [0.51 0.6  0.92 0.52 0.64 1.   0.61]
 [0.64 0.57 0.78 0.53 0.57 0.61 1.  ]]
Collapsing 2 & 5 with crosscontam 0.6828010137274387 and sim 0.921993136032226
Trimming eliminated 0 seqlets out of 234
Unmerged patterns remapping: OrderedDict([(0, 1), (1, 2), (3, 3), (4, 4), (6, 5)])
Time spent on merging iteration: 0.7688953876495361
On merging iteration 2
Numbers for each pattern pre-subsample: [234, 191, 156, 135, 102, 55]
Numbers after subsampling: [234, 191, 156, 135, 102, 55]
Computing sims for pattern 0
Computed sims for pattern 0 in 1.2523365020751953 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.22736454010009766 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.17046046257019043 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.18287324905395508 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.13066911697387695 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.08488321304321289 s
Cluster sizes
[234 191 156 135 102  55]
Cross-contamination matrix:
[[1.   0.25 0.27 0.24 0.28 0.45]
 [0.96 1.   0.84 0.68 0.85 0.89]
 [0.59 0.44 1.   0.62 0.76 0.69]
 [0.62 0.46 0.75 1.   0.55 0.57]
 [0.63 0.5  0.83 0.43 1.   0.64]
 [0.63 0.25 0.42 0.23 0.28 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.55 0.56 0.52 0.61 0.66]
 [0.55 1.   0.6  0.55 0.62 0.64]
 [0.56 0.6  1.   0.77 0.81 0.57]
 [0.52 0.55 0.77 1.   0.5  0.53]
 [0.61 0.62 0.81 0.5  1.   0.57]
 [0.66 0.64 0.57 0.53 0.57 1.  ]]
Merging on 13 clusters
2024-03-11 23:36:08.765986 MEMORY 13.860581376
On merging iteration 1
Numbers for each pattern pre-subsample: [942, 613, 332, 23, 1823, 986, 166, 234, 191, 156, 135, 102, 55]
Numbers after subsampling: [300, 300, 300, 23, 300, 300, 166, 234, 191, 156, 135, 102, 55]
Computing sims for pattern 0
Computed sims for pattern 0 in 3.698399066925049 s
Computing sims for pattern 1
Computed sims for pattern 1 in 3.686946153640747 s
Computing sims for pattern 2
Computed sims for pattern 2 in 4.964961528778076 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.46859097480773926 s
Computing sims for pattern 4
Computed sims for pattern 4 in 3.683037042617798 s
Computing sims for pattern 5
Computed sims for pattern 5 in 3.7861220836639404 s
Computing sims for pattern 6
Computed sims for pattern 6 in 2.1981489658355713 s
Computing sims for pattern 7
Computed sims for pattern 7 in 3.403841018676758 s
Computing sims for pattern 8
Computed sims for pattern 8 in 2.607943296432495 s
Computing sims for pattern 9
Computed sims for pattern 9 in 2.023763656616211 s
Computing sims for pattern 10
Computed sims for pattern 10 in 1.9610280990600586 s
Computing sims for pattern 11
Computed sims for pattern 11 in 1.4079101085662842 s
Computing sims for pattern 12
Computed sims for pattern 12 in 0.8786180019378662 s
Cluster sizes
[ 942  613  332   23 1823  986  166  234  191  156  135  102   55]
Cross-contamination matrix:
[[1.   0.34 0.26 0.73 0.54 0.42 0.14 0.03 0.01 0.06 0.05 0.1  0.01]
 [0.84 1.   0.53 0.79 0.34 0.47 0.41 0.04 0.03 0.34 0.13 0.38 0.04]
 [0.96 0.76 1.   0.81 0.46 0.49 0.32 0.13 0.07 0.45 0.37 0.46 0.1 ]
 [0.5  0.16 0.1  1.   0.22 0.14 0.04 0.   0.   0.01 0.01 0.01 0.  ]
 [1.   0.3  0.26 0.78 1.   0.63 0.28 0.11 0.08 0.11 0.08 0.12 0.11]
 [1.   0.62 0.44 0.96 0.88 1.   0.68 0.3  0.12 0.17 0.18 0.29 0.54]
 [0.71 0.7  0.42 0.67 0.61 0.85 1.   0.38 0.24 0.38 0.17 0.19 0.76]
 [0.13 0.06 0.09 0.12 0.13 0.16 0.17 1.   0.25 0.27 0.24 0.28 0.45]
 [0.3  0.34 0.33 0.43 0.43 0.4  0.5  0.96 1.   0.84 0.68 0.85 0.89]
 [0.22 0.37 0.34 0.2  0.23 0.17 0.29 0.59 0.44 1.   0.62 0.76 0.69]
 [0.31 0.2  0.35 0.29 0.25 0.25 0.23 0.62 0.46 0.75 1.   0.55 0.57]
 [0.43 0.52 0.46 0.28 0.28 0.32 0.29 0.63 0.5  0.83 0.43 1.   0.64]
 [0.05 0.04 0.06 0.05 0.12 0.32 0.34 0.63 0.25 0.42 0.23 0.28 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.78 0.76 0.83 0.92 0.89 0.7  0.19 0.08 0.33 0.32 0.41 0.16]
 [0.78 1.   0.73 0.73 0.55 0.78 0.81 0.05 0.09 0.59 0.16 0.55 0.16]
 [0.76 0.73 1.   0.63 0.54 0.66 0.58 0.13 0.09 0.58 0.46 0.57 0.14]
 [0.83 0.73 0.63 1.   0.74 0.82 0.68 0.13 0.23 0.32 0.25 0.29 0.11]
 [0.92 0.55 0.54 0.74 1.   0.83 0.63 0.24 0.23 0.3  0.33 0.25 0.31]
 [0.89 0.78 0.66 0.82 0.83 1.   0.85 0.2  0.19 0.25 0.26 0.27 0.66]
 [0.7  0.81 0.58 0.68 0.63 0.85 1.   0.32 0.43 0.45 0.32 0.37 0.66]
 [0.19 0.05 0.13 0.13 0.24 0.2  0.32 1.   0.55 0.56 0.52 0.61 0.66]
 [0.08 0.09 0.09 0.23 0.23 0.19 0.43 0.55 1.   0.6  0.55 0.62 0.64]
 [0.33 0.59 0.58 0.32 0.3  0.25 0.45 0.56 0.6  1.   0.77 0.81 0.57]
 [0.32 0.16 0.46 0.25 0.33 0.26 0.32 0.52 0.55 0.77 1.   0.5  0.53]
 [0.41 0.55 0.57 0.29 0.25 0.27 0.37 0.61 0.62 0.81 0.5  1.   0.57]
 [0.16 0.16 0.14 0.11 0.31 0.66 0.66 0.66 0.64 0.57 0.53 0.57 1.  ]]
Collapsing 0 & 4 with crosscontam 0.5445673728395062 and sim 0.9197017905753516
Removed 1 duplicate seqlets
Skipped 1 due to duplicates
Trimming eliminated 0 seqlets out of 2763
Unmerged patterns remapping: OrderedDict([(1, 2), (2, 3), (3, 11), (5, 1), (6, 6), (7, 4), (8, 5), (9, 7), (10, 8), (11, 9), (12, 10)])
Time spent on merging iteration: 6.730332374572754
On merging iteration 2
Numbers for each pattern pre-subsample: [2763, 986, 613, 332, 234, 191, 166, 156, 135, 102, 55, 23]
Numbers after subsampling: [300, 300, 300, 300, 234, 191, 166, 156, 135, 102, 55, 23]
Computing sims for pattern 0
Computed sims for pattern 0 in 3.374239683151245 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.34218358993530273 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.34700894355773926 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.3532583713531494 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.31136536598205566 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.2455153465270996 s
Computing sims for pattern 6
Computed sims for pattern 6 in 0.2124171257019043 s
Computing sims for pattern 7
Computed sims for pattern 7 in 0.19363689422607422 s
Computing sims for pattern 8
Computed sims for pattern 8 in 0.18737483024597168 s
Computing sims for pattern 9
Computed sims for pattern 9 in 0.1433548927307129 s
Computing sims for pattern 10
Computed sims for pattern 10 in 0.08715486526489258 s
Computing sims for pattern 11
Computed sims for pattern 11 in 0.04931330680847168 s
Cluster sizes
[2763  986  613  332  234  191  166  156  135  102   55   23]
Cross-contamination matrix:
[[1.   0.7  0.47 0.41 0.16 0.1  0.36 0.13 0.11 0.21 0.12 0.89]
 [0.91 1.   0.62 0.44 0.3  0.12 0.68 0.17 0.18 0.29 0.54 0.96]
 [0.5  0.47 1.   0.53 0.04 0.03 0.41 0.34 0.13 0.38 0.04 0.79]
 [0.62 0.49 0.76 1.   0.13 0.07 0.32 0.45 0.37 0.46 0.1  0.81]
 [0.13 0.16 0.06 0.09 1.   0.25 0.17 0.27 0.24 0.28 0.45 0.12]
 [0.4  0.4  0.34 0.33 0.96 1.   0.5  0.84 0.68 0.85 0.89 0.43]
 [0.65 0.85 0.7  0.42 0.38 0.24 1.   0.38 0.17 0.19 0.76 0.67]
 [0.18 0.17 0.37 0.34 0.59 0.44 0.29 1.   0.62 0.76 0.69 0.2 ]
 [0.31 0.25 0.2  0.35 0.62 0.46 0.23 0.75 1.   0.55 0.57 0.29]
 [0.28 0.32 0.52 0.46 0.63 0.5  0.29 0.83 0.43 1.   0.64 0.28]
 [0.09 0.32 0.04 0.06 0.63 0.25 0.34 0.42 0.23 0.28 1.   0.05]
 [0.29 0.14 0.16 0.1  0.   0.   0.04 0.01 0.01 0.01 0.   1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.86 0.65 0.63 0.23 0.17 0.67 0.28 0.32 0.29 0.26 0.79]
 [0.86 1.   0.78 0.66 0.2  0.19 0.85 0.25 0.26 0.27 0.66 0.82]
 [0.65 0.78 1.   0.73 0.05 0.09 0.81 0.59 0.16 0.55 0.16 0.73]
 [0.63 0.66 0.73 1.   0.13 0.09 0.58 0.58 0.46 0.57 0.14 0.63]
 [0.23 0.2  0.05 0.13 1.   0.55 0.32 0.56 0.52 0.61 0.66 0.13]
 [0.17 0.19 0.09 0.09 0.55 1.   0.43 0.6  0.55 0.62 0.64 0.23]
 [0.67 0.85 0.81 0.58 0.32 0.43 1.   0.45 0.32 0.37 0.66 0.68]
 [0.28 0.25 0.59 0.58 0.56 0.6  0.45 1.   0.77 0.81 0.57 0.32]
 [0.32 0.26 0.16 0.46 0.52 0.55 0.32 0.77 1.   0.5  0.53 0.25]
 [0.29 0.27 0.55 0.57 0.61 0.62 0.37 0.81 0.5  1.   0.57 0.29]
 [0.26 0.66 0.16 0.14 0.66 0.64 0.66 0.57 0.53 0.57 1.   0.11]
 [0.79 0.82 0.73 0.63 0.13 0.23 0.68 0.32 0.25 0.29 0.11 1.  ]]
Collapsing 0 & 1 with crosscontam 0.7022615518518518 and sim 0.8640804703273147
Skipped 4 due to duplicates
Trimming eliminated 0 seqlets out of 3745
Unmerged patterns remapping: OrderedDict([(2, 1), (3, 2), (4, 3), (5, 4), (6, 5), (7, 6), (8, 7), (9, 8), (10, 9), (11, 10)])
Time spent on merging iteration: 6.314094543457031
On merging iteration 3
Numbers for each pattern pre-subsample: [3745, 613, 332, 234, 191, 166, 156, 135, 102, 55, 23]
Numbers after subsampling: [300, 300, 300, 234, 191, 166, 156, 135, 102, 55, 23]
Computing sims for pattern 0
Computed sims for pattern 0 in 3.0413811206817627 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.3486294746398926 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.35935306549072266 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.309314489364624 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.25139331817626953 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.20795845985412598 s
Computing sims for pattern 6
Computed sims for pattern 6 in 1.4874680042266846 s
Computing sims for pattern 7
Computed sims for pattern 7 in 0.1772749423980713 s
Computing sims for pattern 8
Computed sims for pattern 8 in 0.13846039772033691 s
Computing sims for pattern 9
Computed sims for pattern 9 in 0.08494997024536133 s
Computing sims for pattern 10
Computed sims for pattern 10 in 0.0510859489440918 s
Cluster sizes
[3745  613  332  234  191  166  156  135  102   55   23]
Cross-contamination matrix:
[[1.   0.54 0.46 0.19 0.1  0.44 0.15 0.18 0.24 0.12 0.94]
 [0.51 1.   0.53 0.04 0.03 0.41 0.34 0.13 0.38 0.04 0.79]
 [0.61 0.76 1.   0.13 0.07 0.32 0.45 0.37 0.46 0.1  0.81]
 [0.15 0.06 0.09 1.   0.25 0.17 0.27 0.24 0.28 0.45 0.12]
 [0.39 0.34 0.33 0.96 1.   0.5  0.84 0.68 0.85 0.89 0.43]
 [0.7  0.7  0.42 0.38 0.24 1.   0.38 0.17 0.19 0.76 0.67]
 [0.18 0.37 0.34 0.59 0.44 0.29 1.   0.62 0.76 0.69 0.2 ]
 [0.31 0.2  0.35 0.62 0.46 0.23 0.75 1.   0.55 0.57 0.29]
 [0.27 0.52 0.46 0.63 0.5  0.29 0.83 0.43 1.   0.64 0.28]
 [0.08 0.04 0.06 0.63 0.25 0.34 0.42 0.23 0.28 1.   0.05]
 [0.28 0.16 0.1  0.   0.   0.04 0.01 0.01 0.01 0.   1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.68 0.65 0.22 0.13 0.72 0.29 0.32 0.32 0.21 0.79]
 [0.68 1.   0.73 0.05 0.09 0.81 0.59 0.16 0.55 0.16 0.73]
 [0.65 0.73 1.   0.13 0.09 0.58 0.58 0.46 0.57 0.14 0.63]
 [0.22 0.05 0.13 1.   0.55 0.32 0.56 0.52 0.61 0.66 0.13]
 [0.13 0.09 0.09 0.55 1.   0.43 0.6  0.55 0.62 0.64 0.23]
 [0.72 0.81 0.58 0.32 0.43 1.   0.45 0.32 0.37 0.66 0.68]
 [0.29 0.59 0.58 0.56 0.6  0.45 1.   0.77 0.81 0.57 0.32]
 [0.32 0.16 0.46 0.52 0.55 0.32 0.77 1.   0.5  0.53 0.25]
 [0.32 0.55 0.57 0.61 0.62 0.37 0.81 0.5  1.   0.57 0.29]
 [0.21 0.16 0.14 0.66 0.64 0.66 0.57 0.53 0.57 1.   0.11]
 [0.79 0.73 0.63 0.13 0.23 0.68 0.32 0.25 0.29 0.11 1.  ]]
Got 11 patterns after merging
2024-03-11 23:37:08.958947 MEMORY 13.860581376
Performing filtering
2024-03-11 23:37:08.959108 MEMORY 13.860581376
Got 10 patterns after filtering
2024-03-11 23:37:09.759320 MEMORY 13.860581376
Total time taken is 752.02s
2024-03-11 23:37:09.759488 MEMORY 13.860581376
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 3366 tasks      | elapsed:    1.0s
[Parallel(n_jobs=24)]: Done 3745 out of 3745 | elapsed:    1.2s finished
/ru-auth/local/home/lzhao/anaconda3/envs/jupyter-ml-clone/lib/python3.9/site-packages/sklearn/manifold/_t_sne.py:691: FutureWarning: 'square_distances' has been introduced in 0.24 to help phase out legacy squaring behavior. The 'legacy' setting will be removed in 1.1 (renaming of 0.26), and the default setting will be changed to True. In 1.3, 'square_distances' will be removed altogether, and distances will be squared by default. Set 'square_distances'=True to silence this warning.
  warnings.warn(
/ru-auth/local/home/lzhao/anaconda3/envs/jupyter-ml-clone/lib/python3.9/site-packages/sklearn/neighbors/_base.py:175: EfficiencyWarning: Precomputed sparse input was not sorted by data.
  warnings.warn('Precomputed sparse input was not sorted by data.',
Applying subclustering to the final motifs
On pattern 0
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 3745 samples in 0.024s...
[t-SNE] Computed neighbors for 3745 samples in 0.002s...
[t-SNE] Computed conditional probabilities for sample 1000 / 3745
[t-SNE] Computed conditional probabilities for sample 2000 / 3745
[t-SNE] Computed conditional probabilities for sample 3000 / 3745
[t-SNE] Computed conditional probabilities for sample 3745 / 3745
[t-SNE] Mean sigma: 0.279905
[t-SNE] Computed conditional probabilities in 0.257s
[t-SNE] Iteration 50: error = 77.6051025, gradient norm = 0.0048043 (50 iterations in 2.307s)
[t-SNE] Iteration 100: error = 77.6049118, gradient norm = 0.0000130 (50 iterations in 2.336s)
[t-SNE] Iteration 150: error = 77.6047516, gradient norm = 0.0000000 (50 iterations in 2.184s)
[t-SNE] Iteration 150: gradient norm 0.000000. Finished.
[t-SNE] KL divergence after 150 iterations with early exaggeration: 77.604752
[t-SNE] Iteration 200: error = 2.5985906, gradient norm = 0.0018905 (50 iterations in 2.239s)
[t-SNE] Iteration 250: error = 2.3820415, gradient norm = 0.0005400 (50 iterations in 2.141s)
[t-SNE] Iteration 300: error = 2.2965415, gradient norm = 0.0002865 (50 iterations in 2.216s)
[t-SNE] Iteration 350: error = 2.2506011, gradient norm = 0.0001718 (50 iterations in 2.140s)
[t-SNE] Iteration 400: error = 2.2236042, gradient norm = 0.0001114 (50 iterations in 2.142s)
[t-SNE] Iteration 450: error = 2.2064261, gradient norm = 0.0000895 (50 iterations in 2.136s)
[t-SNE] Iteration 500: error = 2.1956885, gradient norm = 0.0000748 (50 iterations in 2.131s)
[t-SNE] Iteration 550: error = 2.1885958, gradient norm = 0.0000615 (50 iterations in 2.148s)
[t-SNE] Iteration 600: error = 2.1835968, gradient norm = 0.0000507 (50 iterations in 2.134s)
[t-SNE] Iteration 650: error = 2.1794074, gradient norm = 0.0000442 (50 iterations in 2.135s)
[t-SNE] Iteration 700: error = 2.1761186, gradient norm = 0.0000422 (50 iterations in 2.197s)
[t-SNE] Iteration 750: error = 2.1735606, gradient norm = 0.0000448 (50 iterations in 2.143s)
[t-SNE] Iteration 800: error = 2.1717503, gradient norm = 0.0000408 (50 iterations in 2.128s)
[t-SNE] Iteration 850: error = 2.1705863, gradient norm = 0.0000382 (50 iterations in 2.189s)
[t-SNE] Iteration 900: error = 2.1696374, gradient norm = 0.0000386 (50 iterations in 2.149s)
[t-SNE] Iteration 950: error = 2.1689041, gradient norm = 0.0000345 (50 iterations in 2.138s)
[t-SNE] Iteration 1000: error = 2.1683283, gradient norm = 0.0000310 (50 iterations in 2.154s)
[t-SNE] KL divergence after 1000 iterations: 2.168328
[t-SNE] Computed conditional probabilities for sample 1000 / 3745
[t-SNE] Computed conditional probabilities for sample 2000 / 3745
[t-SNE] Computed conditional probabilities for sample 3000 / 3745
[t-SNE] Computed conditional probabilities for sample 3745 / 3745
[t-SNE] Mean sigma: 0.279905
Beginning preprocessing + Leiden
2024-03-11 23:37:58.695092 MEMORY 13.86135552
Affmat transformed
2024-03-11 23:37:58.743636 MEMORY 13.86135552
sources, targets, weights extracted
2024-03-11 23:37:58.775250 MEMORY 13.86135552
About to launch parallel Leiden runs
2024-03-11 23:37:58.815632 MEMORY 13.86135552
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:   13.6s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   47.6s finished
Parallel Leiden runs finished
2024-03-11 23:38:46.412078 MEMORY 13.86135552
Quality: 0.53546324257735
Quality: 0.5358296213202709
Quality: 0.5361288957348197
Quality: 0.5364247201502599
Quality: 0.5365008492239439
Quality: 0.5383524264954893
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 613 out of 613 | elapsed:    0.2s finished
Got subclusters: Counter({0: 741, 1: 657, 2: 499, 3: 481, 4: 298, 5: 295, 6: 291, 7: 261, 8: 222})
On pattern 1
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 613 samples in 0.004s...
[t-SNE] Computed neighbors for 613 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 613 / 613
[t-SNE] Mean sigma: 0.332464
[t-SNE] Computed conditional probabilities in 0.042s
[t-SNE] Iteration 50: error = 68.3965378, gradient norm = 0.4323348 (50 iterations in 2.034s)
[t-SNE] Iteration 100: error = 69.5346756, gradient norm = 0.4135621 (50 iterations in 2.039s)
[t-SNE] Iteration 150: error = 69.9353104, gradient norm = 0.4049543 (50 iterations in 2.041s)
[t-SNE] Iteration 200: error = 70.5547638, gradient norm = 0.4013616 (50 iterations in 2.042s)
[t-SNE] Iteration 250: error = 69.4136887, gradient norm = 0.4214324 (50 iterations in 2.032s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 69.413689
[t-SNE] Iteration 300: error = 1.5080074, gradient norm = 0.0034338 (50 iterations in 2.024s)
[t-SNE] Iteration 350: error = 1.4442936, gradient norm = 0.0009612 (50 iterations in 2.030s)
[t-SNE] Iteration 400: error = 1.4140873, gradient norm = 0.0007036 (50 iterations in 2.035s)
[t-SNE] Iteration 450: error = 1.4059613, gradient norm = 0.0003041 (50 iterations in 2.036s)
[t-SNE] Iteration 500: error = 1.4012280, gradient norm = 0.0002647 (50 iterations in 2.030s)
[t-SNE] Iteration 550: error = 1.3934945, gradient norm = 0.0004356 (50 iterations in 2.028s)
[t-SNE] Iteration 600: error = 1.3870490, gradient norm = 0.0003386 (50 iterations in 2.028s)
[t-SNE] Iteration 650: error = 1.3805144, gradient norm = 0.0002170 (50 iterations in 2.026s)
[t-SNE] Iteration 700: error = 1.3795602, gradient norm = 0.0003192 (50 iterations in 2.026s)
[t-SNE] Iteration 750: error = 1.3766812, gradient norm = 0.0001064 (50 iterations in 2.030s)
[t-SNE] Iteration 800: error = 1.3765562, gradient norm = 0.0000714 (50 iterations in 2.029s)
[t-SNE] Iteration 850: error = 1.3765738, gradient norm = 0.0000505 (50 iterations in 2.033s)
[t-SNE] Iteration 900: error = 1.3764846, gradient norm = 0.0000689 (50 iterations in 2.030s)
[t-SNE] Iteration 950: error = 1.3765380, gradient norm = 0.0000876 (50 iterations in 2.027s)
[t-SNE] Iteration 1000: error = 1.3764182, gradient norm = 0.0000553 (50 iterations in 2.027s)
[t-SNE] KL divergence after 1000 iterations: 1.376418
[t-SNE] Computed conditional probabilities for sample 613 / 613
[t-SNE] Mean sigma: 0.332464
Beginning preprocessing + Leiden
2024-03-11 23:39:28.333045 MEMORY 13.86135552
Affmat transformed
2024-03-11 23:39:28.341002 MEMORY 13.86135552
sources, targets, weights extracted
2024-03-11 23:39:28.345134 MEMORY 13.86135552
About to launch parallel Leiden runs
2024-03-11 23:39:28.383494 MEMORY 13.86135552
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    5.0s finished
Parallel Leiden runs finished
2024-03-11 23:39:33.391742 MEMORY 13.86135552
Quality: 0.4326361140509002
Quality: 0.4329736460773479
Quality: 0.4332024112704976
Quality: 0.43322620752739754
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 272 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 332 out of 332 | elapsed:    0.1s finished
Got subclusters: Counter({0: 146, 1: 125, 2: 107, 3: 93, 4: 78, 5: 59, 6: 5})
On pattern 2
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 332 samples in 0.003s...
[t-SNE] Computed neighbors for 332 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 332 / 332
[t-SNE] Mean sigma: 0.381177
[t-SNE] Computed conditional probabilities in 0.022s
[t-SNE] Iteration 50: error = 62.9879494, gradient norm = 0.5288122 (50 iterations in 2.035s)
[t-SNE] Iteration 100: error = 63.2250252, gradient norm = 0.5008147 (50 iterations in 2.038s)
[t-SNE] Iteration 150: error = 65.7887192, gradient norm = 0.4851257 (50 iterations in 2.031s)
[t-SNE] Iteration 200: error = 64.2503967, gradient norm = 0.4719799 (50 iterations in 2.024s)
[t-SNE] Iteration 250: error = 65.2484741, gradient norm = 0.5055049 (50 iterations in 2.025s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 65.248474
[t-SNE] Iteration 300: error = 1.3016298, gradient norm = 0.0047589 (50 iterations in 2.027s)
[t-SNE] Iteration 350: error = 1.1829642, gradient norm = 0.0022381 (50 iterations in 2.028s)
[t-SNE] Iteration 400: error = 1.1149919, gradient norm = 0.0009970 (50 iterations in 2.036s)
[t-SNE] Iteration 450: error = 1.0910331, gradient norm = 0.0012662 (50 iterations in 2.031s)
[t-SNE] Iteration 500: error = 1.0638160, gradient norm = 0.0006712 (50 iterations in 2.034s)
[t-SNE] Iteration 550: error = 1.0621361, gradient norm = 0.0001553 (50 iterations in 2.026s)
[t-SNE] Iteration 600: error = 1.0616270, gradient norm = 0.0001491 (50 iterations in 2.029s)
[t-SNE] Iteration 650: error = 1.0603201, gradient norm = 0.0002306 (50 iterations in 2.047s)
[t-SNE] Iteration 700: error = 1.0595855, gradient norm = 0.0002777 (50 iterations in 2.028s)
[t-SNE] Iteration 750: error = 1.0567826, gradient norm = 0.0001730 (50 iterations in 2.025s)
[t-SNE] Iteration 800: error = 1.0567083, gradient norm = 0.0000902 (50 iterations in 2.031s)
[t-SNE] Iteration 850: error = 1.0565934, gradient norm = 0.0000933 (50 iterations in 2.035s)
[t-SNE] Iteration 900: error = 1.0566334, gradient norm = 0.0003644 (50 iterations in 2.026s)
[t-SNE] Iteration 950: error = 1.0558387, gradient norm = 0.0006313 (50 iterations in 2.021s)
[t-SNE] Iteration 1000: error = 1.0554590, gradient norm = 0.0000664 (50 iterations in 2.037s)
[t-SNE] KL divergence after 1000 iterations: 1.055459
[t-SNE] Computed conditional probabilities for sample 332 / 332
[t-SNE] Mean sigma: 0.381177
Beginning preprocessing + Leiden
2024-03-11 23:40:14.583773 MEMORY 13.86135552
Affmat transformed
2024-03-11 23:40:14.588483 MEMORY 13.86135552
sources, targets, weights extracted
2024-03-11 23:40:14.590570 MEMORY 13.86135552
About to launch parallel Leiden runs
2024-03-11 23:40:14.606303 MEMORY 13.86135552
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.1s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    3.0s finished
Parallel Leiden runs finished
2024-03-11 23:40:17.581783 MEMORY 13.86135552
Quality: 0.3717874551989602
Quality: 0.3721226478182543
Quality: 0.37242974984472277
Quality: 0.3728508293344119
Quality: 0.37285702973772356
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 234 out of 234 | elapsed:    0.1s finished
Got subclusters: Counter({0: 60, 1: 55, 2: 53, 3: 52, 4: 45, 5: 41, 6: 26})
On pattern 3
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 234 samples in 0.002s...
[t-SNE] Computed neighbors for 234 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 234 / 234
[t-SNE] Mean sigma: 0.289796
[t-SNE] Computed conditional probabilities in 0.016s
[t-SNE] Iteration 50: error = 57.3748093, gradient norm = 0.5217712 (50 iterations in 2.021s)
[t-SNE] Iteration 100: error = 56.7009544, gradient norm = 0.4640734 (50 iterations in 2.026s)
[t-SNE] Iteration 150: error = 55.8305779, gradient norm = 0.5691369 (50 iterations in 2.025s)
[t-SNE] Iteration 200: error = 55.3442345, gradient norm = 0.5804633 (50 iterations in 2.027s)
[t-SNE] Iteration 250: error = 57.4283562, gradient norm = 0.4926601 (50 iterations in 2.033s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 57.428356
[t-SNE] Iteration 300: error = 0.8663628, gradient norm = 0.0065947 (50 iterations in 2.029s)
[t-SNE] Iteration 350: error = 0.6583332, gradient norm = 0.0034999 (50 iterations in 2.031s)
[t-SNE] Iteration 400: error = 0.6466579, gradient norm = 0.0005261 (50 iterations in 2.029s)
[t-SNE] Iteration 450: error = 0.6466997, gradient norm = 0.0001538 (50 iterations in 2.037s)
[t-SNE] Iteration 500: error = 0.6445897, gradient norm = 0.0004196 (50 iterations in 2.031s)
[t-SNE] Iteration 550: error = 0.6363334, gradient norm = 0.0026287 (50 iterations in 2.022s)
[t-SNE] Iteration 600: error = 0.6289072, gradient norm = 0.0004571 (50 iterations in 2.023s)
[t-SNE] Iteration 650: error = 0.6063751, gradient norm = 0.0007559 (50 iterations in 2.031s)
[t-SNE] Iteration 700: error = 0.6030665, gradient norm = 0.0002325 (50 iterations in 2.034s)
[t-SNE] Iteration 750: error = 0.6030330, gradient norm = 0.0000856 (50 iterations in 2.033s)
[t-SNE] Iteration 800: error = 0.6035438, gradient norm = 0.0001610 (50 iterations in 2.031s)
[t-SNE] Iteration 850: error = 0.6032918, gradient norm = 0.0001458 (50 iterations in 2.038s)
[t-SNE] Iteration 900: error = 0.6031949, gradient norm = 0.0001175 (50 iterations in 2.034s)
[t-SNE] Iteration 950: error = 0.6031082, gradient norm = 0.0002001 (50 iterations in 2.036s)
[t-SNE] Iteration 1000: error = 0.6032805, gradient norm = 0.0001796 (50 iterations in 2.037s)
[t-SNE] KL divergence after 1000 iterations: 0.603280
[t-SNE] Computed conditional probabilities for sample 234 / 234
[t-SNE] Mean sigma: 0.289796
Beginning preprocessing + Leiden
2024-03-11 23:40:58.592561 MEMORY 13.86135552
Affmat transformed
2024-03-11 23:40:58.596125 MEMORY 13.86135552
sources, targets, weights extracted
2024-03-11 23:40:58.597657 MEMORY 13.86135552
About to launch parallel Leiden runs
2024-03-11 23:40:58.641929 MEMORY 13.86135552
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.8s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.4s finished
Parallel Leiden runs finished
2024-03-11 23:41:01.070609 MEMORY 13.86135552
Quality: 0.31094098382044
Quality: 0.31112745373113254
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 191 out of 191 | elapsed:    0.1s finished
Got subclusters: Counter({0: 63, 1: 49, 2: 42, 3: 40, 4: 35, 5: 5})
On pattern 4
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 191 samples in 0.002s...
[t-SNE] Computed neighbors for 191 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 191 / 191
[t-SNE] Mean sigma: 0.470426
[t-SNE] Computed conditional probabilities in 0.012s
[t-SNE] Iteration 50: error = 58.8966827, gradient norm = 0.5051102 (50 iterations in 2.022s)
[t-SNE] Iteration 100: error = 56.6875687, gradient norm = 0.5261565 (50 iterations in 2.022s)
[t-SNE] Iteration 150: error = 56.0814514, gradient norm = 0.5525001 (50 iterations in 2.020s)
[t-SNE] Iteration 200: error = 56.4007225, gradient norm = 0.5220702 (50 iterations in 2.029s)
[t-SNE] Iteration 250: error = 56.5491791, gradient norm = 0.5484827 (50 iterations in 2.025s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 56.549179
[t-SNE] Iteration 300: error = 0.8956524, gradient norm = 0.0078042 (50 iterations in 2.022s)
[t-SNE] Iteration 350: error = 0.7413158, gradient norm = 0.0029191 (50 iterations in 2.021s)
[t-SNE] Iteration 400: error = 0.7057232, gradient norm = 0.0032610 (50 iterations in 2.020s)
[t-SNE] Iteration 450: error = 0.6871353, gradient norm = 0.0014892 (50 iterations in 2.019s)
[t-SNE] Iteration 500: error = 0.6820487, gradient norm = 0.0004047 (50 iterations in 2.023s)
[t-SNE] Iteration 550: error = 0.6822547, gradient norm = 0.0003252 (50 iterations in 2.019s)
[t-SNE] Iteration 600: error = 0.6820264, gradient norm = 0.0001530 (50 iterations in 2.027s)
[t-SNE] Iteration 650: error = 0.6819218, gradient norm = 0.0002512 (50 iterations in 2.036s)
[t-SNE] Iteration 700: error = 0.6820629, gradient norm = 0.0001861 (50 iterations in 2.029s)
[t-SNE] Iteration 750: error = 0.6820260, gradient norm = 0.0001198 (50 iterations in 2.036s)
[t-SNE] Iteration 800: error = 0.6820552, gradient norm = 0.0001419 (50 iterations in 2.029s)
[t-SNE] Iteration 850: error = 0.6820115, gradient norm = 0.0001451 (50 iterations in 2.028s)
[t-SNE] Iteration 900: error = 0.6819798, gradient norm = 0.0001388 (50 iterations in 2.027s)
[t-SNE] Iteration 950: error = 0.6819649, gradient norm = 0.0001149 (50 iterations in 2.033s)
[t-SNE] Iteration 1000: error = 0.6820269, gradient norm = 0.0001446 (50 iterations in 2.021s)
[t-SNE] Iteration 1000: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 1000 iterations: 0.682027
[t-SNE] Computed conditional probabilities for sample 191 / 191
[t-SNE] Mean sigma: 0.470426
Beginning preprocessing + Leiden
2024-03-11 23:41:41.906134 MEMORY 13.86135552
Affmat transformed
2024-03-11 23:41:41.909177 MEMORY 13.86135552
sources, targets, weights extracted
2024-03-11 23:41:41.910324 MEMORY 13.86135552
About to launch parallel Leiden runs
2024-03-11 23:41:41.938695 MEMORY 13.86135552
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.8s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.3s finished
Parallel Leiden runs finished
2024-03-11 23:41:44.240818 MEMORY 13.86135552
Quality: 0.29882981777364837
Quality: 0.2988298177736484
Quality: 0.30015743455300603
Quality: 0.30029961371148683
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 166 out of 166 | elapsed:    0.1s finished
Got subclusters: Counter({0: 43, 1: 34, 2: 32, 4: 27, 3: 27, 5: 26, 6: 2})
On pattern 5
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 166 samples in 0.002s...
[t-SNE] Computed neighbors for 166 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 166 / 166
[t-SNE] Mean sigma: 0.458897
[t-SNE] Computed conditional probabilities in 0.011s
[t-SNE] Iteration 50: error = 54.8036957, gradient norm = 0.5110438 (50 iterations in 2.021s)
[t-SNE] Iteration 100: error = 54.3943939, gradient norm = 0.5848046 (50 iterations in 2.019s)
[t-SNE] Iteration 150: error = 57.1764908, gradient norm = 0.5230923 (50 iterations in 2.021s)
[t-SNE] Iteration 200: error = 56.6127090, gradient norm = 0.4646114 (50 iterations in 2.020s)
[t-SNE] Iteration 250: error = 56.7035065, gradient norm = 0.5231915 (50 iterations in 2.021s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 56.703506
[t-SNE] Iteration 300: error = 0.8023990, gradient norm = 0.0071425 (50 iterations in 2.025s)
[t-SNE] Iteration 350: error = 0.6015512, gradient norm = 0.0082471 (50 iterations in 2.023s)
[t-SNE] Iteration 400: error = 0.5247954, gradient norm = 0.0023116 (50 iterations in 2.023s)
[t-SNE] Iteration 450: error = 0.5234752, gradient norm = 0.0002356 (50 iterations in 2.026s)
[t-SNE] Iteration 500: error = 0.5237033, gradient norm = 0.0001275 (50 iterations in 2.031s)
[t-SNE] Iteration 550: error = 0.5237151, gradient norm = 0.0001337 (50 iterations in 2.027s)
[t-SNE] Iteration 600: error = 0.5236628, gradient norm = 0.0001434 (50 iterations in 2.022s)
[t-SNE] Iteration 650: error = 0.5236577, gradient norm = 0.0001494 (50 iterations in 2.025s)
[t-SNE] Iteration 700: error = 0.5236854, gradient norm = 0.0001481 (50 iterations in 2.034s)
[t-SNE] Iteration 750: error = 0.5236962, gradient norm = 0.0001857 (50 iterations in 2.026s)
[t-SNE] Iteration 800: error = 0.5236924, gradient norm = 0.0001774 (50 iterations in 2.029s)
[t-SNE] Iteration 800: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 800 iterations: 0.523692
[t-SNE] Computed conditional probabilities for sample 166 / 166
[t-SNE] Mean sigma: 0.458897
Beginning preprocessing + Leiden
2024-03-11 23:42:16.906574 MEMORY 13.86135552
Affmat transformed
2024-03-11 23:42:16.909390 MEMORY 13.86135552
sources, targets, weights extracted
2024-03-11 23:42:16.910363 MEMORY 13.86135552
About to launch parallel Leiden runs
2024-03-11 23:42:17.183614 MEMORY 13.861310464
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.8s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.1s finished
Parallel Leiden runs finished
2024-03-11 23:42:19.303044 MEMORY 13.861310464
Quality: 0.322149311506327
Quality: 0.32260378789738753
Quality: 0.32341829423618773
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 156 out of 156 | elapsed:    0.0s finished
Got subclusters: Counter({0: 50, 2: 32, 1: 32, 3: 30, 4: 22})
On pattern 6
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 156 samples in 0.001s...
[t-SNE] Computed neighbors for 156 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 156 / 156
[t-SNE] Mean sigma: 0.435850
[t-SNE] Computed conditional probabilities in 0.010s
[t-SNE] Iteration 50: error = 55.8178062, gradient norm = 0.5212014 (50 iterations in 2.021s)
[t-SNE] Iteration 100: error = 58.9959526, gradient norm = 0.4428064 (50 iterations in 2.026s)
[t-SNE] Iteration 150: error = 59.7638550, gradient norm = 0.5247241 (50 iterations in 2.023s)
[t-SNE] Iteration 200: error = 59.8783302, gradient norm = 0.4803039 (50 iterations in 2.019s)
[t-SNE] Iteration 250: error = 61.0257225, gradient norm = 0.4705805 (50 iterations in 2.018s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 61.025723
[t-SNE] Iteration 300: error = 0.9255880, gradient norm = 0.0089259 (50 iterations in 2.036s)
[t-SNE] Iteration 350: error = 0.6091138, gradient norm = 0.0052694 (50 iterations in 2.032s)
[t-SNE] Iteration 400: error = 0.6038601, gradient norm = 0.0003453 (50 iterations in 2.039s)
[t-SNE] Iteration 450: error = 0.6034200, gradient norm = 0.0003282 (50 iterations in 2.034s)
[t-SNE] Iteration 500: error = 0.6037279, gradient norm = 0.0003371 (50 iterations in 2.031s)
[t-SNE] Iteration 550: error = 0.6035788, gradient norm = 0.0003080 (50 iterations in 2.028s)
[t-SNE] Iteration 600: error = 0.6036571, gradient norm = 0.0003285 (50 iterations in 2.019s)
[t-SNE] Iteration 650: error = 0.6034698, gradient norm = 0.0003248 (50 iterations in 2.020s)
[t-SNE] Iteration 700: error = 0.6038271, gradient norm = 0.0002868 (50 iterations in 2.025s)
[t-SNE] Iteration 750: error = 0.6035147, gradient norm = 0.0003123 (50 iterations in 2.028s)
[t-SNE] Iteration 800: error = 0.6037611, gradient norm = 0.0002533 (50 iterations in 2.025s)
[t-SNE] Iteration 800: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 800 iterations: 0.603761
[t-SNE] Computed conditional probabilities for sample 156 / 156
[t-SNE] Mean sigma: 0.435850
Beginning preprocessing + Leiden
2024-03-11 23:42:51.987187 MEMORY 13.86129408
Affmat transformed
2024-03-11 23:42:51.989776 MEMORY 13.86129408
sources, targets, weights extracted
2024-03-11 23:42:51.990725 MEMORY 13.86129408
About to launch parallel Leiden runs
2024-03-11 23:42:52.002521 MEMORY 13.86129408
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.8s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.1s finished
Parallel Leiden runs finished
2024-03-11 23:42:54.089996 MEMORY 13.86129408
Quality: 0.2623394930437067
Quality: 0.2647857768434259
Quality: 0.26503970603372606
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  88 out of 135 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=24)]: Done 135 out of 135 | elapsed:    0.0s finished
Got subclusters: Counter({0: 34, 1: 33, 2: 31, 3: 23, 4: 19, 5: 16})
On pattern 7
[t-SNE] Computing 134 nearest neighbors...
[t-SNE] Indexed 135 samples in 0.001s...
[t-SNE] Computed neighbors for 135 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 135 / 135
[t-SNE] Mean sigma: 0.486309
[t-SNE] Computed conditional probabilities in 0.008s
[t-SNE] Iteration 50: error = 57.5090904, gradient norm = 0.5167365 (50 iterations in 2.017s)
[t-SNE] Iteration 100: error = 56.6535187, gradient norm = 0.5090882 (50 iterations in 2.024s)
[t-SNE] Iteration 150: error = 55.9389114, gradient norm = 0.4954585 (50 iterations in 2.030s)
[t-SNE] Iteration 200: error = 56.4104195, gradient norm = 0.5096266 (50 iterations in 2.030s)
[t-SNE] Iteration 250: error = 57.5894279, gradient norm = 0.5042483 (50 iterations in 2.028s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 57.589428
[t-SNE] Iteration 300: error = 0.7085448, gradient norm = 0.0124089 (50 iterations in 2.029s)
[t-SNE] Iteration 350: error = 0.5053769, gradient norm = 0.0026421 (50 iterations in 2.034s)
[t-SNE] Iteration 400: error = 0.5011254, gradient norm = 0.0016628 (50 iterations in 2.022s)
[t-SNE] Iteration 450: error = 0.4938409, gradient norm = 0.0016834 (50 iterations in 2.025s)
[t-SNE] Iteration 500: error = 0.4928904, gradient norm = 0.0003664 (50 iterations in 2.028s)
[t-SNE] Iteration 550: error = 0.4930382, gradient norm = 0.0001445 (50 iterations in 2.030s)
[t-SNE] Iteration 600: error = 0.4930429, gradient norm = 0.0001596 (50 iterations in 2.029s)
[t-SNE] Iteration 650: error = 0.4930250, gradient norm = 0.0001538 (50 iterations in 2.033s)
[t-SNE] Iteration 700: error = 0.4928031, gradient norm = 0.0000772 (50 iterations in 2.028s)
[t-SNE] Iteration 750: error = 0.4929972, gradient norm = 0.0001077 (50 iterations in 2.021s)
[t-SNE] Iteration 800: error = 0.4930103, gradient norm = 0.0000765 (50 iterations in 1.805s)
[t-SNE] Iteration 850: error = 0.4930089, gradient norm = 0.0001136 (50 iterations in 1.150s)
[t-SNE] Iteration 900: error = 0.4928260, gradient norm = 0.0001350 (50 iterations in 0.579s)
[t-SNE] Iteration 950: error = 0.4930180, gradient norm = 0.0001852 (50 iterations in 1.140s)
[t-SNE] Iteration 1000: error = 0.4929987, gradient norm = 0.0001122 (50 iterations in 2.021s)
[t-SNE] KL divergence after 1000 iterations: 0.492999
[t-SNE] Computed conditional probabilities for sample 135 / 135
[t-SNE] Mean sigma: 0.486309
Beginning preprocessing + Leiden
2024-03-11 23:43:31.405211 MEMORY 13.861224448
Affmat transformed
2024-03-11 23:43:31.407280 MEMORY 13.861224448
sources, targets, weights extracted
2024-03-11 23:43:31.408018 MEMORY 13.861224448
About to launch parallel Leiden runs
2024-03-11 23:43:31.508901 MEMORY 13.861122048
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.0s finished
Parallel Leiden runs finished
2024-03-11 23:43:33.555436 MEMORY 13.861122048
Quality: 0.2642787166393307
Quality: 0.26754418624722914
Quality: 0.269077576633101
Quality: 0.2703056842116414
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 102 out of 102 | elapsed:    0.0s finished
Got subclusters: Counter({0: 44, 1: 39, 2: 32, 3: 20})
On pattern 8
[t-SNE] Computing 101 nearest neighbors...
[t-SNE] Indexed 102 samples in 0.001s...
[t-SNE] Computed neighbors for 102 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 102 / 102
[t-SNE] Mean sigma: 0.519801
[t-SNE] Computed conditional probabilities in 0.005s
[t-SNE] Iteration 50: error = 53.7186203, gradient norm = 0.4702924 (50 iterations in 2.022s)
[t-SNE] Iteration 100: error = 53.0710449, gradient norm = 0.4893236 (50 iterations in 2.023s)
[t-SNE] Iteration 150: error = 51.8266411, gradient norm = 0.5631086 (50 iterations in 0.455s)
[t-SNE] Iteration 200: error = 54.5734100, gradient norm = 0.4635163 (50 iterations in 2.024s)
[t-SNE] Iteration 250: error = 51.4949989, gradient norm = 0.5270311 (50 iterations in 2.028s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 51.494999
[t-SNE] Iteration 300: error = 0.7582648, gradient norm = 0.0063325 (50 iterations in 2.025s)
[t-SNE] Iteration 350: error = 0.3301823, gradient norm = 0.0109673 (50 iterations in 2.026s)
[t-SNE] Iteration 400: error = 0.3145976, gradient norm = 0.0010629 (50 iterations in 2.022s)
[t-SNE] Iteration 450: error = 0.3143538, gradient norm = 0.0008180 (50 iterations in 2.025s)
[t-SNE] Iteration 500: error = 0.3146391, gradient norm = 0.0009251 (50 iterations in 2.020s)
[t-SNE] Iteration 550: error = 0.3144162, gradient norm = 0.0009321 (50 iterations in 2.023s)
[t-SNE] Iteration 600: error = 0.3146049, gradient norm = 0.0006948 (50 iterations in 2.023s)
[t-SNE] Iteration 650: error = 0.3143248, gradient norm = 0.0008324 (50 iterations in 2.032s)
[t-SNE] Iteration 700: error = 0.3142309, gradient norm = 0.0008857 (50 iterations in 2.028s)
[t-SNE] Iteration 750: error = 0.3145042, gradient norm = 0.0008741 (50 iterations in 2.021s)
[t-SNE] Iteration 800: error = 0.3144848, gradient norm = 0.0009022 (50 iterations in 2.029s)
[t-SNE] Iteration 850: error = 0.3145099, gradient norm = 0.0007572 (50 iterations in 2.044s)
[t-SNE] Iteration 900: error = 0.3144707, gradient norm = 0.0008892 (50 iterations in 2.032s)
[t-SNE] Iteration 950: error = 0.3145922, gradient norm = 0.0007587 (50 iterations in 2.025s)
[t-SNE] Iteration 1000: error = 0.3143300, gradient norm = 0.0007786 (50 iterations in 2.034s)
[t-SNE] KL divergence after 1000 iterations: 0.314330
[t-SNE] Computed conditional probabilities for sample 102 / 102
[t-SNE] Mean sigma: 0.519801
Beginning preprocessing + Leiden
2024-03-11 23:44:12.655664 MEMORY 13.85904128
Affmat transformed
2024-03-11 23:44:12.657503 MEMORY 13.859192832
sources, targets, weights extracted
2024-03-11 23:44:12.658222 MEMORY 13.859221504
About to launch parallel Leiden runs
2024-03-11 23:44:12.912612 MEMORY 13.859315712
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.8s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.0s finished
Parallel Leiden runs finished
2024-03-11 23:44:14.943427 MEMORY 13.85971712
Quality: 0.2016065217930761
Quality: 0.20419324573878306
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  55 out of  55 | elapsed:    0.0s finished
Got subclusters: Counter({0: 29, 1: 26, 2: 24, 3: 23})
On pattern 9
[t-SNE] Computing 54 nearest neighbors...
[t-SNE] Indexed 55 samples in 0.001s...
[t-SNE] Computed neighbors for 55 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 55 / 55
[t-SNE] Mean sigma: 0.925025
[t-SNE] Computed conditional probabilities in 0.001s
[t-SNE] Iteration 50: error = 42.5719528, gradient norm = 0.7194722 (50 iterations in 2.024s)
[t-SNE] Iteration 100: error = 46.4941635, gradient norm = 0.5565039 (50 iterations in 2.027s)
[t-SNE] Iteration 150: error = 42.5755806, gradient norm = 0.6214265 (50 iterations in 1.902s)
[t-SNE] Iteration 200: error = 44.9461136, gradient norm = 0.5397129 (50 iterations in 0.170s)
[t-SNE] Iteration 250: error = 47.3291817, gradient norm = 0.6603343 (50 iterations in 1.560s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 47.329182
[t-SNE] Iteration 300: error = 0.6682939, gradient norm = 0.0010149 (50 iterations in 0.290s)
[t-SNE] Iteration 350: error = 0.6471061, gradient norm = 0.0003810 (50 iterations in 0.868s)
[t-SNE] Iteration 400: error = 0.6300201, gradient norm = 0.0006168 (50 iterations in 1.292s)
[t-SNE] Iteration 450: error = 0.6124968, gradient norm = 0.0006642 (50 iterations in 1.297s)
[t-SNE] Iteration 500: error = 0.5906389, gradient norm = 0.0005978 (50 iterations in 0.890s)
[t-SNE] Iteration 550: error = 0.5683022, gradient norm = 0.0011671 (50 iterations in 2.020s)
[t-SNE] Iteration 600: error = 0.9899907, gradient norm = 0.0355222 (50 iterations in 2.057s)
[t-SNE] Iteration 650: error = 0.6881853, gradient norm = 0.0006935 (50 iterations in 2.021s)
[t-SNE] Iteration 700: error = 0.6431112, gradient norm = 0.0002525 (50 iterations in 2.026s)
[t-SNE] Iteration 750: error = 0.6297667, gradient norm = 0.0002319 (50 iterations in 2.029s)
[t-SNE] Iteration 800: error = 0.6136332, gradient norm = 0.0002502 (50 iterations in 2.020s)
[t-SNE] Iteration 850: error = 0.5908617, gradient norm = 0.0002611 (50 iterations in 2.019s)
[t-SNE] Iteration 900: error = 0.5823950, gradient norm = 0.0001582 (50 iterations in 2.021s)
[t-SNE] Iteration 900: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 900 iterations: 0.582395
[t-SNE] Computed conditional probabilities for sample 55 / 55
[t-SNE] Mean sigma: 0.925026
Beginning preprocessing + Leiden
2024-03-11 23:44:43.543364 MEMORY 13.860114432
Affmat transformed
2024-03-11 23:44:43.545118 MEMORY 13.860114432
sources, targets, weights extracted
2024-03-11 23:44:43.545568 MEMORY 13.860114432
About to launch parallel Leiden runs
2024-03-11 23:44:43.562312 MEMORY 13.860114432
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.8s finished
Parallel Leiden runs finished
2024-03-11 23:44:45.376665 MEMORY 13.860118528
Quality: 0.05932394866509506
Quality: 0.061036360118937455
Got subclusters: Counter({0: 21, 1: 20, 2: 14})
On metacluster 1
Metacluster size 67208 limited to 20000
Relevant tasks:  ('head', 'testis')
Relevant signs:  (1, 1)
TfModiscoSeqletsToPatternsFactory: seed=1234
(Round 1) num seqlets: 20000
(Round 1) Computing coarse affmat
2024-03-11 23:44:47.535978 MEMORY 13.858230272
Beginning embedding computation
MEMORY 13.858230272
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 152 tasks      | elapsed:    1.9s
[Parallel(n_jobs=24)]: Done 402 tasks      | elapsed:    4.7s
[Parallel(n_jobs=24)]: Done 752 tasks      | elapsed:    8.5s
[Parallel(n_jobs=24)]: Done 1202 tasks      | elapsed:   13.5s
[Parallel(n_jobs=24)]: Done 1752 tasks      | elapsed:   19.4s
[Parallel(n_jobs=24)]: Done 2402 tasks      | elapsed:   26.6s
[Parallel(n_jobs=24)]: Done 3152 tasks      | elapsed:   34.8s
[Parallel(n_jobs=24)]: Done 4002 tasks      | elapsed:   44.1s
[Parallel(n_jobs=24)]: Done 4952 tasks      | elapsed:   54.6s
[Parallel(n_jobs=24)]: Done 6002 tasks      | elapsed:  1.1min
[Parallel(n_jobs=24)]: Done 7152 tasks      | elapsed:  1.3min
[Parallel(n_jobs=24)]: Done 8402 tasks      | elapsed:  1.5min
[Parallel(n_jobs=24)]: Done 9752 tasks      | elapsed:  1.8min
[Parallel(n_jobs=24)]: Done 11202 tasks      | elapsed:  2.1min
[Parallel(n_jobs=24)]: Done 12752 tasks      | elapsed:  2.3min
[Parallel(n_jobs=24)]: Done 14402 tasks      | elapsed:  2.8min
[Parallel(n_jobs=24)]: Done 16152 tasks      | elapsed:  3.4min
[Parallel(n_jobs=24)]: Done 18002 tasks      | elapsed:  3.9min
[Parallel(n_jobs=24)]: Done 19952 tasks      | elapsed:  4.3min
[Parallel(n_jobs=24)]: Done 20000 out of 20000 | elapsed:  4.3min finished
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 152 tasks      | elapsed:    1.9s
[Parallel(n_jobs=24)]: Done 402 tasks      | elapsed:    4.6s
[Parallel(n_jobs=24)]: Done 752 tasks      | elapsed:    8.5s
[Parallel(n_jobs=24)]: Done 1202 tasks      | elapsed:   13.5s
[Parallel(n_jobs=24)]: Done 1752 tasks      | elapsed:   19.5s
[Parallel(n_jobs=24)]: Done 2402 tasks      | elapsed:   26.6s
[Parallel(n_jobs=24)]: Done 3152 tasks      | elapsed:   34.8s
[Parallel(n_jobs=24)]: Done 4002 tasks      | elapsed:   44.1s
[Parallel(n_jobs=24)]: Done 4952 tasks      | elapsed:   54.5s
[Parallel(n_jobs=24)]: Done 6002 tasks      | elapsed:  1.1min
[Parallel(n_jobs=24)]: Done 7152 tasks      | elapsed:  1.3min
[Parallel(n_jobs=24)]: Done 8402 tasks      | elapsed:  1.5min
[Parallel(n_jobs=24)]: Done 9752 tasks      | elapsed:  1.8min
[Parallel(n_jobs=24)]: Done 11202 tasks      | elapsed:  2.1min
[Parallel(n_jobs=24)]: Done 12752 tasks      | elapsed:  2.3min
[Parallel(n_jobs=24)]: Done 14402 tasks      | elapsed:  2.6min
[Parallel(n_jobs=24)]: Done 16152 tasks      | elapsed:  3.0min
[Parallel(n_jobs=24)]: Done 18002 tasks      | elapsed:  3.3min
[Parallel(n_jobs=24)]: Done 19952 tasks      | elapsed:  3.7min
[Parallel(n_jobs=24)]: Done 20000 out of 20000 | elapsed:  3.7min finished
At the beginning of embedding call
2024-03-11 23:44:47.536179 MEMORY 13.858230272
before computing embeddings fwd
2024-03-11 23:44:47.545199 MEMORY 13.858234368
after computing embeddings fwd
2024-03-11 23:49:07.076010 MEMORY 14.321463296
after computing embeddings rev
2024-03-11 23:52:46.760404 MEMORY 15.143337984
before computing sparse embeddings fwd
2024-03-11 23:52:46.760515 MEMORY 15.143337984
Constructing csr matrix...
csr matrix made in 2.416344165802002 s
after computing sparse embeddings fwd
2024-03-11 23:52:50.050984 MEMORY 15.223463936
before computing sparse embeddings rev
2024-03-11 23:52:50.051101 MEMORY 15.223463936
Constructing csr matrix...
csr matrix made in 2.2833757400512695 s
after computing sparse embeddings rev
2024-03-11 23:52:53.450560 MEMORY 15.343730688
Finished embedding computation in 488.13 s
MEMORY 14.5455104
Starting affinity matrix computations
MEMORY 14.543937536
Batching in slices of size 3355
  0%|          | 0/6 [00:00<?, ?it/s] 17%|â–ˆâ–‹        | 1/6 [00:07<00:38,  7.72s/it] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 2/6 [00:15<00:30,  7.68s/it] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 3/6 [00:22<00:22,  7.64s/it] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 4/6 [00:30<00:15,  7.59s/it] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 5/6 [00:38<00:07,  7.59s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:45<00:00,  7.50s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:45<00:00,  7.56s/it]
Finished affinity matrix computations in 45.51 s
MEMORY 14.544109568
(Round 1) Computed coarse affmat
2024-03-11 23:53:42.457905 MEMORY 14.343315456
(Round 1) Computing affinity matrix on nearest neighbors
2024-03-11 23:53:42.458051 MEMORY 14.343315456
Launching nearest neighbors affmat calculation job
MEMORY 14.424850432
Parallel runs completed
MEMORY 14.56314368
Job completed in: 68.86 s
MEMORY 14.561558528
Launching nearest neighbors affmat calculation job
MEMORY 14.561759232
Parallel runs completed
MEMORY 14.732742656
Job completed in: 72.61 s
MEMORY 14.732816384
(Round 1) Computed affinity matrix on nearest neighbors in 146.92 s
2024-03-11 23:56:09.383650 MEMORY 14.58219008
Filtered down to 18684 of 20000
(Round 1) Retained 18684 rows out of 20000 after filtering
2024-03-11 23:56:21.027999 MEMORY 14.58243584
(Round 1) Computing density adapted affmat
2024-03-11 23:56:25.944214 MEMORY 14.643142656
Symmetrizing nearest neighbors
Computing betas for density adaptation
Computing normalizing denominators
(Round 1) Computing clustering
2024-03-11 23:59:30.931389 MEMORY 15.712735232
Beginning preprocessing + Leiden
2024-03-11 23:59:30.961277 MEMORY 15.712796672
Affmat transformed
2024-03-11 23:59:30.961399 MEMORY 15.712796672
sources, targets, weights extracted
2024-03-11 23:59:31.620812 MEMORY 15.712833536
About to launch parallel Leiden runs
2024-03-11 23:59:31.818022 MEMORY 15.712874496
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:  2.3min
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:  7.5min finished
Parallel Leiden runs finished
2024-03-12 00:06:59.775860 MEMORY 15.7188096
Quality: 0.4287427481295295
Quality: 0.4313243773420381
Quality: 0.43133728652107767
Quality: 0.4313374753421106
Quality: 0.4313379429767096
Quality: 0.43133899478566623
Got 7 clusters after round 1
Counts:
{4: 2711, 1: 3356, 3: 2940, 5: 2579, 0: 3828, 6: 226, 2: 3044}
2024-03-12 00:06:59.829004 MEMORY 15.7188096
(Round 1) Aggregating seqlets in each cluster
2024-03-12 00:06:59.829121 MEMORY 15.7188096
Aggregating for cluster 0 with 3828 seqlets
2024-03-12 00:06:59.835465 MEMORY 15.718821888
Skipped 10 due to duplicates
Trimming eliminated 0 seqlets out of 3818
Aggregating for cluster 1 with 3356 seqlets
2024-03-12 00:07:08.269039 MEMORY 15.71893248
Skipped 16 due to duplicates
Trimming eliminated 0 seqlets out of 3340
Aggregating for cluster 2 with 3044 seqlets
2024-03-12 00:07:17.206446 MEMORY 15.71897344
Skipped 6 due to duplicates
Trimming eliminated 0 seqlets out of 3038
Aggregating for cluster 3 with 2940 seqlets
2024-03-12 00:07:23.989243 MEMORY 15.71897344
Skipped 24 due to duplicates
Trimming eliminated 0 seqlets out of 2916
Removed 9 duplicate seqlets
Aggregating for cluster 4 with 2711 seqlets
2024-03-12 00:07:30.614766 MEMORY 15.71897344
Skipped 43 due to duplicates
Trimming eliminated 0 seqlets out of 2668
Aggregating for cluster 5 with 2579 seqlets
2024-03-12 00:07:38.202319 MEMORY 15.718981632
Removed 1 duplicate seqlets
Skipped 1 seqlets that went over sequence edge during flank expansion
Skipped 20 due to duplicates
Trimming eliminated 0 seqlets out of 2557
Aggregating for cluster 6 with 226 seqlets
2024-03-12 00:07:43.960884 MEMORY 15.718981632
Trimming eliminated 0 seqlets out of 226
Dropping cluster 6 with 226 seqlets due to sign disagreement
(Round 2) num seqlets: 18319
(Round 2) Computing coarse affmat
2024-03-12 00:07:45.881852 MEMORY 15.718981632
Beginning embedding computation
MEMORY 15.718981632
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 320 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done 2256 tasks      | elapsed:    2.7s
[Parallel(n_jobs=24)]: Done 5056 tasks      | elapsed:    5.5s
[Parallel(n_jobs=24)]: Done 8656 tasks      | elapsed:    9.1s
[Parallel(n_jobs=24)]: Done 13056 tasks      | elapsed:   13.3s
[Parallel(n_jobs=24)]: Done 18221 tasks      | elapsed:   18.0s
[Parallel(n_jobs=24)]: Done 18319 out of 18319 | elapsed:   18.2s finished
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 368 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done 1368 tasks      | elapsed:    2.0s
[Parallel(n_jobs=24)]: Done 2768 tasks      | elapsed:    3.7s
[Parallel(n_jobs=24)]: Done 4568 tasks      | elapsed:    5.9s
[Parallel(n_jobs=24)]: Done 6768 tasks      | elapsed:    8.6s
[Parallel(n_jobs=24)]: Done 9368 tasks      | elapsed:   11.9s
[Parallel(n_jobs=24)]: Done 12368 tasks      | elapsed:   15.6s
[Parallel(n_jobs=24)]: Done 15768 tasks      | elapsed:   19.9s
[Parallel(n_jobs=24)]: Done 18272 out of 18319 | elapsed:   23.0s remaining:    0.1s
[Parallel(n_jobs=24)]: Done 18319 out of 18319 | elapsed:   23.1s finished
At the beginning of embedding call
2024-03-12 00:07:45.882101 MEMORY 15.718981632
before computing embeddings fwd
2024-03-12 00:07:45.890663 MEMORY 15.718981632
after computing embeddings fwd
2024-03-12 00:08:04.060322 MEMORY 16.435167232
after computing embeddings rev
2024-03-12 00:08:27.143439 MEMORY 17.189593088
before computing sparse embeddings fwd
2024-03-12 00:08:27.143544 MEMORY 17.189593088
Constructing csr matrix...
csr matrix made in 2.122828245162964 s
after computing sparse embeddings fwd
2024-03-12 00:08:30.576680 MEMORY 17.189654528
before computing sparse embeddings rev
2024-03-12 00:08:30.576761 MEMORY 17.189654528
Constructing csr matrix...
csr matrix made in 2.1834914684295654 s
after computing sparse embeddings rev
2024-03-12 00:08:33.354146 MEMORY 17.189916672
Finished embedding computation in 50.88 s
MEMORY 16.48789504
Starting affinity matrix computations
MEMORY 16.487370752
Batching in slices of size 3663
  0%|          | 0/6 [00:00<?, ?it/s] 17%|â–ˆâ–‹        | 1/6 [00:09<00:46,  9.34s/it] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 2/6 [00:18<00:37,  9.47s/it] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 3/6 [00:27<00:27,  9.29s/it] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 4/6 [00:38<00:19,  9.62s/it] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 5/6 [00:47<00:09,  9.42s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:48<00:00,  6.82s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:48<00:00,  8.16s/it]
Finished affinity matrix computations in 49.09 s
MEMORY 16.48719872
(Round 2) Computed coarse affmat
2024-03-12 00:09:27.656565 MEMORY 16.486674432
(Round 2) Computing affinity matrix on nearest neighbors
2024-03-12 00:09:27.656731 MEMORY 16.486674432
Launching nearest neighbors affmat calculation job
MEMORY 16.486674432
Parallel runs completed
MEMORY 16.531902464
Job completed in: 33.22 s
MEMORY 16.531705856
Launching nearest neighbors affmat calculation job
MEMORY 16.531533824
Parallel runs completed
MEMORY 16.559357952
Job completed in: 33.09 s
MEMORY 16.559161344
(Round 2) Computed affinity matrix on nearest neighbors in 71.98 s
2024-03-12 00:10:39.645077 MEMORY 16.55894016
Not applying filtering for rounds above first round
2024-03-12 00:10:39.647301 MEMORY 16.55894016
(Round 2) Computing density adapted affmat
2024-03-12 00:10:45.448333 MEMORY 16.65533952
Symmetrizing nearest neighbors
Computing betas for density adaptation
Computing normalizing denominators
(Round 2) Computing clustering
2024-03-12 00:13:27.815537 MEMORY 16.315449344
Beginning preprocessing + Leiden
2024-03-12 00:13:27.843264 MEMORY 16.315449344
Affmat transformed
2024-03-12 00:13:27.843389 MEMORY 16.315449344
sources, targets, weights extracted
2024-03-12 00:13:28.462759 MEMORY 16.315449344
About to launch parallel Leiden runs
2024-03-12 00:13:28.647037 MEMORY 16.315449344
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:  1.4min
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:  4.8min finished
Parallel Leiden runs finished
2024-03-12 00:18:17.407468 MEMORY 16.313073664
Quality: 0.5653886393694358
Quality: 0.5653887737767035
Got 6 clusters after round 2
Counts:
{1: 3466, 0: 3643, 2: 3089, 4: 2665, 3: 2995, 5: 2461}
2024-03-12 00:18:17.455712 MEMORY 16.313462784
(Round 2) Aggregating seqlets in each cluster
2024-03-12 00:18:17.455823 MEMORY 16.313462784
Aggregating for cluster 0 with 3643 seqlets
2024-03-12 00:18:17.464458 MEMORY 16.313495552
Skipped 12 due to duplicates
Trimming eliminated 0 seqlets out of 3631
Aggregating for cluster 1 with 3466 seqlets
2024-03-12 00:18:23.526833 MEMORY 16.314036224
Skipped 7 due to duplicates
Trimming eliminated 0 seqlets out of 3459
Aggregating for cluster 2 with 3089 seqlets
2024-03-12 00:18:29.877423 MEMORY 16.31404032
Skipped 5 due to duplicates
Trimming eliminated 0 seqlets out of 3084
Aggregating for cluster 3 with 2995 seqlets
2024-03-12 00:18:37.690732 MEMORY 16.314372096
Skipped 11 due to duplicates
Trimming eliminated 0 seqlets out of 2984
Aggregating for cluster 4 with 2665 seqlets
2024-03-12 00:18:43.248336 MEMORY 16.314372096
Skipped 24 due to duplicates
Trimming eliminated 0 seqlets out of 2641
Aggregating for cluster 5 with 2461 seqlets
2024-03-12 00:18:48.318147 MEMORY 16.314372096
Skipped 8 due to duplicates
Trimming eliminated 0 seqlets out of 2453
Removed 1 duplicate seqlets
Got 6 clusters
Splitting into subclusters...
2024-03-12 00:18:55.008358 MEMORY 16.314134528
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 3375 tasks      | elapsed:    2.0s
[Parallel(n_jobs=24)]: Done 3631 out of 3631 | elapsed:    2.1s finished
Inspecting pattern 0 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 3631
[t-SNE] Computed conditional probabilities for sample 2000 / 3631
[t-SNE] Computed conditional probabilities for sample 3000 / 3631
[t-SNE] Computed conditional probabilities for sample 3631 / 3631
[t-SNE] Mean sigma: 0.301420
Beginning preprocessing + Leiden
2024-03-12 00:19:01.177316 MEMORY 16.315039744
Affmat transformed
2024-03-12 00:19:01.262502 MEMORY 16.315068416
sources, targets, weights extracted
2024-03-12 00:19:01.297648 MEMORY 16.3150848
About to launch parallel Leiden runs
2024-03-12 00:19:01.346666 MEMORY 16.315113472
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:   12.5s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   54.6s finished
Parallel Leiden runs finished
2024-03-12 00:19:55.983530 MEMORY 16.315113472
Quality: 0.4988753732289603
Quality: 0.5013956246765641
Quality: 0.5014064498921008
Quality: 0.5024951745653305
Quality: 0.502579684839375
Quality: 0.5029480082775054
Quality: 0.5033622407992939
Quality: 0.5036840523198097
Quality: 0.5039444375037002
Got subclusters: Counter({0: 777, 1: 749, 2: 734, 3: 425, 4: 417, 5: 312, 6: 207, 7: 10})
On merging iteration 1
Numbers for each pattern pre-subsample: [777, 749, 734, 425, 417, 312, 207, 10]
Numbers after subsampling: [300, 300, 300, 300, 300, 300, 207, 10]
Computing sims for pattern 0
Computed sims for pattern 0 in 2.792616605758667 s
Computing sims for pattern 1
Computed sims for pattern 1 in 2.883777379989624 s
Computing sims for pattern 2
Computed sims for pattern 2 in 2.8878839015960693 s
Computing sims for pattern 3
Computed sims for pattern 3 in 2.8246970176696777 s
Computing sims for pattern 4
Computed sims for pattern 4 in 2.849466562271118 s
Computing sims for pattern 5
Computed sims for pattern 5 in 2.883594512939453 s
Computing sims for pattern 6
Computed sims for pattern 6 in 2.2515575885772705 s
Computing sims for pattern 7
Computed sims for pattern 7 in 0.3818027973175049 s
Cluster sizes
[777 749 734 425 417 312 207  10]
Cross-contamination matrix:
[[1.   0.59 0.51 0.55 0.92 0.72 0.54 0.55]
 [0.47 1.   0.54 0.48 0.69 0.52 0.48 0.51]
 [0.66 0.82 1.   0.6  0.95 0.77 0.52 0.8 ]
 [0.65 0.7  0.55 1.   0.84 0.47 0.37 0.42]
 [0.65 0.6  0.54 0.49 1.   0.52 0.54 0.36]
 [0.79 0.71 0.67 0.46 0.85 1.   0.47 0.66]
 [0.61 0.66 0.45 0.35 0.86 0.49 1.   0.32]
 [0.21 0.28 0.29 0.11 0.27 0.24 0.08 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.69 0.74 0.71 0.87 0.87 0.67 0.66]
 [0.69 1.   0.81 0.71 0.75 0.75 0.6  0.64]
 [0.74 0.81 1.   0.68 0.87 0.83 0.59 0.75]
 [0.71 0.71 0.68 1.   0.73 0.71 0.7  0.59]
 [0.87 0.75 0.87 0.73 1.   0.81 0.76 0.72]
 [0.87 0.75 0.83 0.71 0.81 1.   0.58 0.67]
 [0.67 0.6  0.59 0.7  0.76 0.58 1.   0.51]
 [0.66 0.64 0.75 0.59 0.72 0.67 0.51 1.  ]]
Collapsing 0 & 4 with crosscontam 0.6463523372839508 and sim 0.874268454801123
Collapsing 0 & 5 with crosscontam 0.7249190400000001 and sim 0.8736502294126842
Collapsing 2 & 4 with crosscontam 0.5445019427160491 and sim 0.8685883831198471
Trimming eliminated 0 seqlets out of 1194
Trimming eliminated 0 seqlets out of 1506
Skipped 1 due to duplicates
Trimming eliminated 0 seqlets out of 2239
Unmerged patterns remapping: OrderedDict([(1, 1), (3, 2), (6, 3), (7, 4)])
Time spent on merging iteration: 9.57571029663086
On merging iteration 2
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 3459 out of 3459 | elapsed:    1.8s finished
Numbers for each pattern pre-subsample: [2239, 749, 425, 207, 10]
Numbers after subsampling: [300, 300, 300, 207, 10]
Computing sims for pattern 0
Computed sims for pattern 0 in 1.503697395324707 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.4246494770050049 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.41452503204345703 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.34098196029663086 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.059674978256225586 s
Cluster sizes
[2239  749  425  207   10]
Cross-contamination matrix:
[[1.   0.83 0.57 0.74 0.74]
 [0.53 1.   0.48 0.48 0.51]
 [0.44 0.7  1.   0.37 0.42]
 [0.58 0.66 0.35 1.   0.32]
 [0.21 0.28 0.11 0.08 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.78 0.69 0.68 0.68]
 [0.78 1.   0.71 0.6  0.64]
 [0.69 0.71 1.   0.7  0.59]
 [0.68 0.6  0.7  1.   0.51]
 [0.68 0.64 0.59 0.51 1.  ]]
Inspecting pattern 1 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 3459
[t-SNE] Computed conditional probabilities for sample 2000 / 3459
[t-SNE] Computed conditional probabilities for sample 3000 / 3459
[t-SNE] Computed conditional probabilities for sample 3459 / 3459
[t-SNE] Mean sigma: 0.287280
Beginning preprocessing + Leiden
2024-03-12 00:20:34.423442 MEMORY 16.315568128
Affmat transformed
2024-03-12 00:20:34.463247 MEMORY 16.315568128
sources, targets, weights extracted
2024-03-12 00:20:34.494973 MEMORY 16.315568128
About to launch parallel Leiden runs
2024-03-12 00:20:34.530882 MEMORY 16.315568128
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:   13.1s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   49.6s finished
Parallel Leiden runs finished
2024-03-12 00:21:24.119186 MEMORY 16.315568128
Quality: 0.4984814034594709
Quality: 0.4998517484009732
Quality: 0.5018270756436476
Quality: 0.5019608101819022
Quality: 0.5043870802927534
Quality: 0.5047907049956332
Quality: 0.5048028713487435
Got subclusters: Counter({0: 612, 1: 601, 2: 566, 3: 496, 4: 441, 5: 404, 6: 324, 7: 11, 8: 4})
On merging iteration 1
Numbers for each pattern pre-subsample: [612, 601, 566, 496, 441, 404, 324, 11, 4]
Numbers after subsampling: [300, 300, 300, 300, 300, 300, 300, 11, 4]
Computing sims for pattern 0
Computed sims for pattern 0 in 3.165024757385254 s
Computing sims for pattern 1
Computed sims for pattern 1 in 3.230673313140869 s
Computing sims for pattern 2
Computed sims for pattern 2 in 3.2281222343444824 s
Computing sims for pattern 3
Computed sims for pattern 3 in 3.298839569091797 s
Computing sims for pattern 4
Computed sims for pattern 4 in 3.410458564758301 s
Computing sims for pattern 5
Computed sims for pattern 5 in 3.2731165885925293 s
Computing sims for pattern 6
Computed sims for pattern 6 in 3.2770063877105713 s
Computing sims for pattern 7
Computed sims for pattern 7 in 0.4114339351654053 s
Computing sims for pattern 8
Computed sims for pattern 8 in 0.31407952308654785 s
Cluster sizes
[612 601 566 496 441 404 324  11   4]
Cross-contamination matrix:
[[1.   0.75 0.5  0.44 0.76 0.53 0.51 0.37 0.47]
 [0.57 1.   0.36 0.44 0.7  0.51 0.51 0.34 0.36]
 [0.86 0.82 1.   0.56 0.8  0.65 0.63 0.43 0.44]
 [0.84 1.   0.66 1.   1.   0.79 0.82 0.55 0.61]
 [0.71 0.84 0.45 0.52 1.   0.5  0.65 0.45 0.36]
 [0.71 0.9  0.52 0.56 0.73 1.   0.61 0.37 0.5 ]
 [0.83 1.   0.64 0.72 1.   0.74 1.   0.53 0.65]
 [0.58 0.7  0.49 0.57 0.63 0.56 0.52 1.   0.41]
 [0.   0.   0.   0.   0.   0.   0.   0.   1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.82 0.78 0.78 0.85 0.79 0.83 0.65 0.65]
 [0.82 1.   0.75 0.88 0.91 0.86 0.9  0.7  0.61]
 [0.78 0.75 1.   0.77 0.79 0.74 0.79 0.58 0.53]
 [0.78 0.88 0.77 1.   0.9  0.81 0.87 0.67 0.58]
 [0.85 0.91 0.79 0.9  1.   0.81 0.94 0.74 0.57]
 [0.79 0.86 0.74 0.81 0.81 1.   0.84 0.62 0.58]
 [0.83 0.9  0.79 0.87 0.94 0.84 1.   0.69 0.61]
 [0.65 0.7  0.58 0.67 0.74 0.62 0.69 1.   0.43]
 [0.65 0.61 0.53 0.58 0.57 0.58 0.61 0.43 1.  ]]
Collapsing 4 & 6 with crosscontam 0.6461818750617285 and sim 0.9389966252530024
Collapsing 1 & 4 with crosscontam 0.6991991575308643 and sim 0.910035898127129
Collapsing 1 & 6 with crosscontam 0.5128186780246913 and sim 0.9041735731400204
Collapsing 3 & 4 with crosscontam 0.5236808301234566 and sim 0.900166223979835
Collapsing 3 & 6 with crosscontam 0.7219179535802469 and sim 0.874033748153503
Collapsing 1 & 5 with crosscontam 0.5145968755555557 and sim 0.8574138357189935
Skipped 1 due to duplicates
Trimming eliminated 0 seqlets out of 764
Skipped 1 due to duplicates
Trimming eliminated 0 seqlets out of 1364
Skipped 2 due to duplicates
Trimming eliminated 0 seqlets out of 1858
Skipped 1 due to duplicates
Trimming eliminated 0 seqlets out of 2261
Unmerged patterns remapping: OrderedDict([(0, 1), (2, 2), (7, 3), (8, 4)])
Time spent on merging iteration: 12.207120656967163
On merging iteration 2
Numbers for each pattern pre-subsample: [2261, 612, 566, 11, 4]
Numbers after subsampling: [300, 300, 300, 11, 4]
Computing sims for pattern 0
Computed sims for pattern 0 in 1.311403512954712 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.43046092987060547 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.4143662452697754 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.06157112121582031 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.04320645332336426 s
Cluster sizes
[2261  612  566   11    4]
Cross-contamination matrix:
[[1.   0.97 0.76 0.59 0.77]
 [0.59 1.   0.5  0.37 0.47]
 [0.69 0.86 1.   0.43 0.44]
 [0.55 0.58 0.49 1.   0.41]
 [0.   0.   0.   0.   1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.87 0.81 0.72 0.63]
 [0.87 1.   0.78 0.65 0.65]
 [0.81 0.78 1.   0.58 0.53]
 [0.72 0.65 0.58 1.   0.43]
 [0.63 0.65 0.53 0.43 1.  ]]
Collapsing 0 & 1 with crosscontam 0.5879272933333333 and sim 0.8693843578728198
Skipped 1 due to duplicates
Trimming eliminated 0 seqlets out of 2872
Unmerged patterns remapping: OrderedDict([(2, 1), (3, 2), (4, 3)])
Time spent on merging iteration: 6.471496820449829
On merging iteration 3
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 3084 out of 3084 | elapsed:    1.4s finished
Numbers for each pattern pre-subsample: [2872, 566, 11, 4]
Numbers after subsampling: [300, 300, 11, 4]
Computing sims for pattern 0
Computed sims for pattern 0 in 0.9749398231506348 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.43858957290649414 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.0585474967956543 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.04821658134460449 s
Cluster sizes
[2872  566   11    4]
Cross-contamination matrix:
[[1.   0.75 0.59 0.79]
 [0.7  1.   0.43 0.44]
 [0.56 0.49 1.   0.41]
 [0.   0.   0.   1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.82 0.72 0.64]
 [0.82 1.   0.58 0.53]
 [0.72 0.58 1.   0.43]
 [0.64 0.53 0.43 1.  ]]
Inspecting pattern 2 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 3084
[t-SNE] Computed conditional probabilities for sample 2000 / 3084
[t-SNE] Computed conditional probabilities for sample 3000 / 3084
[t-SNE] Computed conditional probabilities for sample 3084 / 3084
[t-SNE] Mean sigma: 0.306214
Beginning preprocessing + Leiden
2024-03-12 00:22:15.780314 MEMORY 16.31557632
Affmat transformed
2024-03-12 00:22:15.816797 MEMORY 16.31557632
sources, targets, weights extracted
2024-03-12 00:22:15.845110 MEMORY 16.31557632
About to launch parallel Leiden runs
2024-03-12 00:22:15.907430 MEMORY 16.31557632
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:   10.9s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   36.5s finished
Parallel Leiden runs finished
2024-03-12 00:22:52.447905 MEMORY 16.31557632
Quality: 0.5342459307379768
Quality: 0.5349130765767987
Quality: 0.5349755193001885
Quality: 0.53499578697728
Got subclusters: Counter({0: 536, 1: 483, 2: 408, 3: 358, 4: 297, 5: 281, 6: 277, 7: 219, 8: 217, 9: 8})
On merging iteration 1
Numbers for each pattern pre-subsample: [536, 483, 408, 358, 297, 281, 277, 219, 217, 8]
Numbers after subsampling: [300, 300, 300, 300, 297, 281, 277, 219, 217, 8]
Computing sims for pattern 0
Computed sims for pattern 0 in 3.496580123901367 s
Computing sims for pattern 1
Computed sims for pattern 1 in 3.8496909141540527 s
Computing sims for pattern 2
Computed sims for pattern 2 in 3.9170353412628174 s
Computing sims for pattern 3
Computed sims for pattern 3 in 3.9571664333343506 s
Computing sims for pattern 4
Computed sims for pattern 4 in 3.7779581546783447 s
Computing sims for pattern 5
Computed sims for pattern 5 in 3.503765821456909 s
Computing sims for pattern 6
Computed sims for pattern 6 in 3.4245262145996094 s
Computing sims for pattern 7
Computed sims for pattern 7 in 3.1412036418914795 s
Computing sims for pattern 8
Computed sims for pattern 8 in 3.0862247943878174 s
Computing sims for pattern 9
Computed sims for pattern 9 in 0.4375419616699219 s
Cluster sizes
[536 483 408 358 297 281 277 219 217   8]
Cross-contamination matrix:
[[1.   0.36 0.48 1.   0.49 0.6  0.64 0.83 0.41 0.23]
 [0.45 1.   0.71 0.62 0.43 0.1  0.27 0.54 0.57 0.18]
 [0.59 0.7  1.   0.9  0.57 0.23 0.47 0.75 0.44 0.18]
 [0.65 0.24 0.45 1.   0.39 0.37 0.54 0.62 0.24 0.11]
 [0.78 0.56 0.71 0.96 1.   0.44 0.77 0.86 0.62 0.29]
 [0.77 0.12 0.28 0.85 0.33 1.   0.66 0.51 0.45 0.19]
 [0.72 0.23 0.43 1.   0.57 0.61 1.   0.73 0.37 0.2 ]
 [0.76 0.38 0.57 0.92 0.54 0.38 0.59 1.   0.31 0.22]
 [0.61 0.66 0.52 0.71 0.56 0.52 0.5  0.49 1.   0.2 ]
 [0.3  0.2  0.2  0.33 0.18 0.21 0.25 0.3  0.17 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.61 0.68 0.93 0.75 0.8  0.82 0.91 0.67 0.65]
 [0.61 1.   0.87 0.67 0.68 0.43 0.45 0.67 0.75 0.54]
 [0.68 0.87 1.   0.8  0.77 0.63 0.59 0.81 0.68 0.54]
 [0.93 0.67 0.8  1.   0.77 0.73 0.87 0.9  0.65 0.6 ]
 [0.75 0.68 0.77 0.77 1.   0.69 0.7  0.82 0.77 0.55]
 [0.8  0.43 0.63 0.73 0.69 1.   0.78 0.66 0.67 0.46]
 [0.82 0.45 0.59 0.87 0.7  0.78 1.   0.81 0.51 0.61]
 [0.91 0.67 0.81 0.9  0.82 0.66 0.81 1.   0.66 0.71]
 [0.67 0.75 0.68 0.65 0.77 0.67 0.51 0.66 1.   0.43]
 [0.65 0.54 0.54 0.6  0.55 0.46 0.61 0.71 0.43 1.  ]]
Collapsing 0 & 3 with crosscontam 0.6463319896296296 and sim 0.927032875172391
Collapsing 0 & 7 with crosscontam 0.7639062039784545 and sim 0.9122974820783094
Collapsing 3 & 7 with crosscontam 0.6182574050397429 and sim 0.9002813882550335
Collapsing 1 & 2 with crosscontam 0.7022288577777778 and sim 0.8698696796931478
Collapsing 3 & 6 with crosscontam 0.5366341419975931 and sim 0.8662528988037559
Trimming eliminated 0 seqlets out of 894
Trimming eliminated 0 seqlets out of 1113
Trimming eliminated 0 seqlets out of 891
Trimming eliminated 0 seqlets out of 1390
Unmerged patterns remapping: OrderedDict([(4, 2), (5, 3), (8, 4), (9, 5)])
Time spent on merging iteration: 9.459059953689575
On merging iteration 2
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 2612 tasks      | elapsed:    1.0s
[Parallel(n_jobs=24)]: Done 2937 out of 2984 | elapsed:    1.1s remaining:    0.0s
[Parallel(n_jobs=24)]: Done 2984 out of 2984 | elapsed:    1.1s finished
Numbers for each pattern pre-subsample: [1390, 891, 297, 281, 217, 8]
Numbers after subsampling: [300, 300, 297, 281, 217, 8]
Computing sims for pattern 0
Computed sims for pattern 0 in 1.980109691619873 s
Computing sims for pattern 1
Computed sims for pattern 1 in 1.9482686519622803 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.8538026809692383 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.8117704391479492 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.7469253540039062 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.11067676544189453 s
Cluster sizes
[1390  891  297  281  217    8]
Cross-contamination matrix:
[[1.   0.51 0.63 0.74 0.55 0.36]
 [0.59 1.   0.6  0.23 0.7  0.26]
 [0.7  0.59 1.   0.44 0.62 0.29]
 [0.71 0.18 0.33 1.   0.45 0.19]
 [0.59 0.63 0.56 0.52 1.   0.2 ]
 [0.29 0.19 0.18 0.21 0.17 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.69 0.74 0.79 0.66 0.68]
 [0.69 1.   0.72 0.54 0.76 0.52]
 [0.74 0.72 1.   0.69 0.77 0.55]
 [0.79 0.54 0.69 1.   0.67 0.46]
 [0.66 0.76 0.77 0.67 1.   0.43]
 [0.68 0.52 0.55 0.46 0.43 1.  ]]
Inspecting pattern 3 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 2984
[t-SNE] Computed conditional probabilities for sample 2000 / 2984
[t-SNE] Computed conditional probabilities for sample 2984 / 2984
[t-SNE] Mean sigma: 0.331035
Beginning preprocessing + Leiden
2024-03-12 00:23:45.799230 MEMORY 16.31557632
Affmat transformed
2024-03-12 00:23:45.836752 MEMORY 16.31557632
sources, targets, weights extracted
2024-03-12 00:23:45.860375 MEMORY 16.31557632
About to launch parallel Leiden runs
2024-03-12 00:23:45.893854 MEMORY 16.31557632
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:   10.0s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   29.6s finished
Parallel Leiden runs finished
2024-03-12 00:24:15.517503 MEMORY 16.31557632
Quality: 0.5402932452609517
Quality: 0.5406894481778496
Quality: 0.5412290969591926
Quality: 0.5417220286466012
Quality: 0.5422949540459421
Got subclusters: Counter({0: 589, 1: 544, 2: 435, 3: 417, 4: 413, 5: 360, 6: 226})
On merging iteration 1
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 2301 tasks      | elapsed:    0.8s
[Parallel(n_jobs=24)]: Done 2594 out of 2641 | elapsed:    0.9s remaining:    0.0s
[Parallel(n_jobs=24)]: Done 2641 out of 2641 | elapsed:    1.0s finished
Numbers for each pattern pre-subsample: [589, 544, 435, 417, 413, 360, 226]
Numbers after subsampling: [300, 300, 300, 300, 300, 300, 226]
Computing sims for pattern 0
Computed sims for pattern 0 in 2.4107253551483154 s
Computing sims for pattern 1
Computed sims for pattern 1 in 2.5690245628356934 s
Computing sims for pattern 2
Computed sims for pattern 2 in 2.498849868774414 s
Computing sims for pattern 3
Computed sims for pattern 3 in 2.6067955493927 s
Computing sims for pattern 4
Computed sims for pattern 4 in 2.6143085956573486 s
Computing sims for pattern 5
Computed sims for pattern 5 in 2.637295722961426 s
Computing sims for pattern 6
Computed sims for pattern 6 in 2.2536609172821045 s
Cluster sizes
[589 544 435 417 413 360 226]
Cross-contamination matrix:
[[1.   0.54 0.62 0.57 0.72 0.79 0.38]
 [0.56 1.   0.54 0.63 0.55 0.6  0.69]
 [0.51 0.44 1.   0.53 0.37 0.41 0.24]
 [0.64 0.69 0.72 1.   0.58 0.85 0.36]
 [0.82 0.62 0.52 0.58 1.   0.72 0.51]
 [0.64 0.3  0.4  0.63 0.5  1.   0.15]
 [0.3  0.56 0.24 0.25 0.37 0.17 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.72 0.73 0.64 0.85 0.75 0.56]
 [0.72 1.   0.61 0.68 0.75 0.58 0.77]
 [0.73 0.61 1.   0.73 0.55 0.59 0.39]
 [0.64 0.68 0.73 1.   0.62 0.82 0.43]
 [0.85 0.75 0.55 0.62 1.   0.7  0.59]
 [0.75 0.58 0.59 0.82 0.7  1.   0.43]
 [0.56 0.77 0.39 0.43 0.59 0.43 1.  ]]
Inspecting pattern 4 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 2641
[t-SNE] Computed conditional probabilities for sample 2000 / 2641
[t-SNE] Computed conditional probabilities for sample 2641 / 2641
[t-SNE] Mean sigma: 0.288145
Beginning preprocessing + Leiden
2024-03-12 00:24:37.851070 MEMORY 16.31557632
Affmat transformed
2024-03-12 00:24:37.883219 MEMORY 16.31557632
sources, targets, weights extracted
2024-03-12 00:24:37.909331 MEMORY 16.31557632
About to launch parallel Leiden runs
2024-03-12 00:24:37.952066 MEMORY 16.31557632
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:   11.3s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   35.5s finished
Parallel Leiden runs finished
2024-03-12 00:25:13.473640 MEMORY 16.31557632
Quality: 0.4452018012677991
Quality: 0.4456729517613951
Quality: 0.4467396610655992
Quality: 0.44759966705753274
Quality: 0.4477658644048241
Quality: 0.4478831110642317
Quality: 0.44799972797493803
Got subclusters: Counter({0: 471, 1: 434, 2: 398, 3: 320, 4: 309, 5: 222, 6: 203, 7: 190, 8: 71, 9: 23})
On merging iteration 1
Numbers for each pattern pre-subsample: [471, 434, 398, 320, 309, 222, 203, 190, 71, 23]
Numbers after subsampling: [300, 300, 300, 300, 300, 222, 203, 190, 71, 23]
Computing sims for pattern 0
Computed sims for pattern 0 in 3.5135185718536377 s
Computing sims for pattern 1
Computed sims for pattern 1 in 3.546907901763916 s
Computing sims for pattern 2
Computed sims for pattern 2 in 3.5535335540771484 s
Computing sims for pattern 3
Computed sims for pattern 3 in 3.518411159515381 s
Computing sims for pattern 4
Computed sims for pattern 4 in 3.538283109664917 s
Computing sims for pattern 5
Computed sims for pattern 5 in 3.0712356567382812 s
Computing sims for pattern 6
Computed sims for pattern 6 in 2.6999447345733643 s
Computing sims for pattern 7
Computed sims for pattern 7 in 2.503558874130249 s
Computing sims for pattern 8
Computed sims for pattern 8 in 1.1700339317321777 s
Computing sims for pattern 9
Computed sims for pattern 9 in 0.5445308685302734 s
Cluster sizes
[471 434 398 320 309 222 203 190  71  23]
Cross-contamination matrix:
[[1.   0.71 0.76 0.52 0.62 0.8  0.66 0.72 0.56 0.78]
 [0.47 1.   0.54 0.45 0.42 0.69 0.45 0.72 0.39 0.49]
 [0.63 0.87 1.   0.64 0.57 0.87 0.59 0.76 0.52 0.77]
 [0.48 0.87 0.73 1.   0.58 0.92 0.64 0.8  0.54 0.65]
 [0.78 1.   0.87 0.78 1.   1.   0.77 0.9  0.65 0.94]
 [0.47 0.84 0.65 0.59 0.52 1.   0.53 0.74 0.44 0.67]
 [0.68 0.93 0.75 0.71 0.64 0.9  1.   0.91 0.59 0.71]
 [0.56 1.   0.71 0.66 0.58 0.89 0.7  1.   0.6  0.67]
 [0.65 0.89 0.73 0.67 0.6  0.84 0.65 0.83 1.   0.65]
 [0.15 0.24 0.22 0.09 0.12 0.27 0.1  0.18 0.05 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.83 0.81 0.78 0.8  0.8  0.79 0.77 0.79 0.75]
 [0.83 1.   0.86 0.88 0.86 0.92 0.87 0.94 0.79 0.79]
 [0.81 0.86 1.   0.88 0.86 0.9  0.83 0.87 0.8  0.84]
 [0.78 0.88 0.88 1.   0.86 0.94 0.87 0.91 0.85 0.81]
 [0.8  0.86 0.86 0.86 1.   0.91 0.83 0.86 0.77 0.85]
 [0.8  0.92 0.9  0.94 0.91 1.   0.88 0.93 0.82 0.85]
 [0.79 0.87 0.83 0.87 0.83 0.88 1.   0.91 0.82 0.75]
 [0.77 0.94 0.87 0.91 0.86 0.93 0.91 1.   0.82 0.8 ]
 [0.79 0.79 0.8  0.85 0.77 0.82 0.82 0.82 1.   0.74]
 [0.75 0.79 0.84 0.81 0.85 0.85 0.75 0.8  0.74 1.  ]]
Collapsing 3 & 5 with crosscontam 0.5922320384665163 and sim 0.9374871906561775
Collapsing 1 & 7 with crosscontam 0.7157480725146199 and sim 0.9355282948793692
Collapsing 5 & 7 with crosscontam 0.7419396213714005 and sim 0.9283535627564031
Collapsing 1 & 5 with crosscontam 0.690740138138138 and sim 0.9183353216525165
Collapsing 4 & 5 with crosscontam 0.5165091241716515 and sim 0.9110618230828915
Collapsing 3 & 7 with crosscontam 0.6596688730135587 and sim 0.9110349982736925
Collapsing 6 & 7 with crosscontam 0.6994268535030383 and sim 0.9061235540177268
Collapsing 2 & 5 with crosscontam 0.6509809419841073 and sim 0.901171581543003
Collapsing 2 & 3 with crosscontam 0.6379656444444444 and sim 0.8829168107735661
Collapsing 5 & 6 with crosscontam 0.530462387455914 and sim 0.8751010902181925
Collapsing 2 & 7 with crosscontam 0.7123580327550179 and sim 0.8742431086808855
Collapsing 3 & 6 with crosscontam 0.6434493625250866 and sim 0.8707117462959476
Collapsing 2 & 4 with crosscontam 0.5717512572839505 and sim 0.864697463336298
Collapsing 4 & 7 with crosscontam 0.577622096515527 and sim 0.8646167814548178
Collapsing 1 & 2 with crosscontam 0.5350887619753086 and sim 0.8624602103533072
Collapsing 3 & 4 with crosscontam 0.5818676785185186 and sim 0.86219098869881
Trimming eliminated 0 seqlets out of 542
Removed 1 duplicate seqlets
Trimming eliminated 0 seqlets out of 623
Trimming eliminated 0 seqlets out of 1165
Trimming eliminated 0 seqlets out of 1474
Trimming eliminated 0 seqlets out of 1677
Trimming eliminated 0 seqlets out of 2075
Unmerged patterns remapping: OrderedDict([(0, 1), (8, 2), (9, 3)])
Time spent on merging iteration: 13.215319871902466
On merging iteration 2
Numbers for each pattern pre-subsample: [2075, 471, 71, 23]
Numbers after subsampling: [300, 300, 71, 23]
Computing sims for pattern 0
Computed sims for pattern 0 in 1.0614655017852783 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.435009241104126 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.15242600440979004 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.07321310043334961 s
Cluster sizes
[2075  471   71   23]
Cross-contamination matrix:
[[1.   0.8  0.76 0.95]
 [0.72 1.   0.56 0.78]
 [0.77 0.65 1.   0.65]
 [0.18 0.15 0.05 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.9  0.85 0.85]
 [0.9  1.   0.79 0.75]
 [0.85 0.79 1.   0.74]
 [0.85 0.75 0.74 1.  ]]
Collapsing 0 & 1 with crosscontam 0.7164758829629629 and sim 0.8966591192727569
Removed 2 duplicate seqlets
Trimming eliminated 0 seqlets out of 2544
Unmerged patterns remapping: OrderedDict([(2, 1), (3, 2)])
Time spent on merging iteration: 5.5616607666015625
On merging iteration 3
Numbers for each pattern pre-subsample: [2544, 71, 23]
Numbers after subsampling: [300, 71, 23]
Computing sims for pattern 0
Computed sims for pattern 0 in 0.6151139736175537 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.14733552932739258 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.07289838790893555 s
Cluster sizes
[2544   71   23]
Cross-contamination matrix:
[[1.   0.82 1.  ]
 [0.71 1.   0.65]
 [0.17 0.05 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.85 0.86]
 [0.85 1.   0.74]
 [0.86 0.74 1.  ]]
Collapsing 0 & 1 with crosscontam 0.7091119673140343 and sim 0.850150515236261
Trimming eliminated 0 seqlets out of 2615
Unmerged patterns remapping: OrderedDict([(2, 1)])
Time spent on merging iteration: 2.4432644844055176
On merging iteration 4
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 2332 tasks      | elapsed:    0.8s
[Parallel(n_jobs=24)]: Done 2452 out of 2452 | elapsed:    0.9s finished
Numbers for each pattern pre-subsample: [2615, 23]
Numbers after subsampling: [300, 23]
Computing sims for pattern 0
Computed sims for pattern 0 in 0.29712820053100586 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.07414841651916504 s
Cluster sizes
[2615   23]
Cross-contamination matrix:
[[1.   1.  ]
 [0.17 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.86]
 [0.86 1.  ]]
Inspecting pattern 5 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 2452
[t-SNE] Computed conditional probabilities for sample 2000 / 2452
[t-SNE] Computed conditional probabilities for sample 2452 / 2452
[t-SNE] Mean sigma: 0.337134
Beginning preprocessing + Leiden
2024-03-12 00:26:09.006808 MEMORY 16.31557632
Affmat transformed
2024-03-12 00:26:09.036170 MEMORY 16.31557632
sources, targets, weights extracted
2024-03-12 00:26:09.053100 MEMORY 16.31557632
About to launch parallel Leiden runs
2024-03-12 00:26:09.084765 MEMORY 16.31557632
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    8.2s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   32.1s finished
Parallel Leiden runs finished
2024-03-12 00:26:41.170731 MEMORY 16.31557632
Quality: 0.5230486582340403
Quality: 0.5245347130516727
Quality: 0.5309105436740553
Quality: 0.5321315460664029
Quality: 0.5328150642248454
Quality: 0.5331359352353653
Got subclusters: Counter({0: 493, 1: 487, 2: 425, 3: 401, 4: 343, 5: 301, 6: 2})
On merging iteration 1
Numbers for each pattern pre-subsample: [493, 487, 425, 401, 343, 301, 2]
Numbers after subsampling: [300, 300, 300, 300, 300, 300, 2]
Computing sims for pattern 0
Computed sims for pattern 0 in 2.3869833946228027 s
Computing sims for pattern 1
Computed sims for pattern 1 in 2.4544501304626465 s
Computing sims for pattern 2
Computed sims for pattern 2 in 2.547670602798462 s
Computing sims for pattern 3
Computed sims for pattern 3 in 2.5605218410491943 s
Computing sims for pattern 4
Computed sims for pattern 4 in 2.663733720779419 s
Computing sims for pattern 5
Computed sims for pattern 5 in 2.556891441345215 s
Computing sims for pattern 6
Computed sims for pattern 6 in 0.2835986614227295 s
Cluster sizes
[493 487 425 401 343 301   2]
Cross-contamination matrix:
[[1.   0.61 0.76 0.59 0.51 0.34 0.35]
 [0.4  1.   0.61 0.57 0.58 0.25 0.09]
 [0.66 0.77 1.   0.6  0.75 0.42 0.3 ]
 [0.51 0.74 0.61 1.   0.47 0.33 0.43]
 [0.46 0.76 0.77 0.49 1.   0.42 0.14]
 [0.49 0.56 0.64 0.55 0.6  1.   0.51]
 [0.   0.   0.   0.   0.   0.   1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.7  0.79 0.68 0.66 0.58 0.25]
 [0.7  1.   0.78 0.81 0.77 0.57 0.35]
 [0.79 0.78 1.   0.77 0.87 0.76 0.32]
 [0.68 0.81 0.77 1.   0.76 0.66 0.5 ]
 [0.66 0.77 0.87 0.76 1.   0.64 0.26]
 [0.58 0.57 0.76 0.66 0.64 1.   0.42]
 [0.25 0.35 0.32 0.5  0.26 0.42 1.  ]]
Collapsing 2 & 4 with crosscontam 0.7484876864197532 and sim 0.8733781067733088
Skipped 1 due to duplicates
Trimming eliminated 0 seqlets out of 767
Unmerged patterns remapping: OrderedDict([(0, 1), (1, 2), (3, 3), (5, 4), (6, 5)])
Time spent on merging iteration: 1.6815547943115234
On merging iteration 2
Numbers for each pattern pre-subsample: [767, 493, 487, 401, 301, 2]
Numbers after subsampling: [300, 300, 300, 300, 300, 2]
Computing sims for pattern 0
Computed sims for pattern 0 in 5.128824949264526 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.44783782958984375 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.4717721939086914 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.4353177547454834 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.4332098960876465 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.0473322868347168 s
Cluster sizes
[767 493 487 401 301   2]
Cross-contamination matrix:
[[1.   0.67 0.81 0.64 0.51 0.25]
 [0.69 1.   0.61 0.59 0.34 0.35]
 [0.59 0.4  1.   0.57 0.25 0.09]
 [0.59 0.51 0.74 1.   0.33 0.43]
 [0.64 0.49 0.56 0.55 1.   0.51]
 [0.   0.   0.   0.   0.   1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.75 0.77 0.79 0.78 0.28]
 [0.75 1.   0.7  0.68 0.58 0.25]
 [0.77 0.7  1.   0.81 0.57 0.35]
 [0.79 0.68 0.81 1.   0.66 0.5 ]
 [0.78 0.58 0.57 0.66 1.   0.42]
 [0.28 0.25 0.35 0.5  0.42 1.  ]]
Merging on 30 clusters
2024-03-12 00:27:05.830350 MEMORY 16.31557632
On merging iteration 1
Numbers for each pattern pre-subsample: [2239, 749, 425, 207, 10, 2872, 566, 11, 4, 1390, 891, 297, 281, 217, 8, 589, 544, 435, 417, 413, 360, 226, 2615, 23, 767, 493, 487, 401, 301, 2]
Numbers after subsampling: [300, 300, 300, 207, 10, 300, 300, 11, 4, 300, 300, 297, 281, 217, 8, 300, 300, 300, 300, 300, 300, 226, 300, 23, 300, 300, 300, 300, 300, 2]
Computing sims for pattern 0
Computed sims for pattern 0 in 11.68706727027893 s
Computing sims for pattern 1
Computed sims for pattern 1 in 12.113336563110352 s
Computing sims for pattern 2
Computed sims for pattern 2 in 11.88920545578003 s
Computing sims for pattern 3
Computed sims for pattern 3 in 9.106752157211304 s
Computing sims for pattern 4
Computed sims for pattern 4 in 1.3089406490325928 s
Computing sims for pattern 5
Computed sims for pattern 5 in 11.683439493179321 s
Computing sims for pattern 6
Computed sims for pattern 6 in 11.455366134643555 s
Computing sims for pattern 7
Computed sims for pattern 7 in 3.8325815200805664 s
Computing sims for pattern 8
Computed sims for pattern 8 in 1.0543172359466553 s
Computing sims for pattern 9
Computed sims for pattern 9 in 11.628270626068115 s
Computing sims for pattern 10
Computed sims for pattern 10 in 11.716283321380615 s
Computing sims for pattern 11
Computed sims for pattern 11 in 11.482893705368042 s
Computing sims for pattern 12
Computed sims for pattern 12 in 10.489485263824463 s
Computing sims for pattern 13
Computed sims for pattern 13 in 9.615157842636108 s
Computing sims for pattern 14
Computed sims for pattern 14 in 1.2369685173034668 s
Computing sims for pattern 15
Computed sims for pattern 15 in 11.694406032562256 s
Computing sims for pattern 16
Computed sims for pattern 16 in 14.402023315429688 s
Computing sims for pattern 17
Computed sims for pattern 17 in 11.582437753677368 s
Computing sims for pattern 18
Computed sims for pattern 18 in 11.736084461212158 s
Computing sims for pattern 19
Computed sims for pattern 19 in 11.699114561080933 s
Computing sims for pattern 20
Computed sims for pattern 20 in 11.72234559059143 s
Computing sims for pattern 21
Computed sims for pattern 21 in 10.169630289077759 s
Computing sims for pattern 22
Computed sims for pattern 22 in 11.518805503845215 s
Computing sims for pattern 23
Computed sims for pattern 23 in 1.7699856758117676 s
Computing sims for pattern 24
Computed sims for pattern 24 in 13.7452974319458 s
Computing sims for pattern 25
Computed sims for pattern 25 in 11.737725973129272 s
Computing sims for pattern 26
Computed sims for pattern 26 in 11.495327711105347 s
Computing sims for pattern 27
Computed sims for pattern 27 in 11.855797052383423 s
Computing sims for pattern 28
Computed sims for pattern 28 in 11.639298677444458 s
Computing sims for pattern 29
Computed sims for pattern 29 in 1.0152196884155273 s
Cluster sizes
[2239  749  425  207   10 2872  566   11    4 1390  891  297  281  217
    8  589  544  435  417  413  360  226 2615   23  767  493  487  401
  301    2]
Cross-contamination matrix:
[[1.   0.83 0.57 0.74 0.74 0.65 0.49 0.46 0.51 0.29 0.6  0.39 0.27 0.49
  0.3  0.29 0.46 0.06 0.25 0.58 0.36 0.49 0.22 0.2  0.3  0.45 0.33 0.37
  0.18 0.7 ]
 [0.53 1.   0.48 0.48 0.51 0.26 0.26 0.19 0.15 0.13 0.28 0.16 0.07 0.11
  0.1  0.13 0.09 0.03 0.07 0.2  0.15 0.15 0.15 0.1  0.15 0.16 0.46 0.12
  0.07 0.27]
 [0.44 0.7  1.   0.37 0.42 0.3  0.25 0.14 0.14 0.36 0.35 0.49 0.28 0.25
  0.12 0.36 0.28 0.08 0.32 0.39 0.39 0.28 0.17 0.13 0.29 0.26 0.33 0.24
  0.11 0.59]
 [0.58 0.66 0.35 1.   0.32 0.24 0.16 0.17 0.1  0.13 0.24 0.18 0.17 0.38
  0.08 0.16 0.37 0.04 0.17 0.13 0.14 0.35 0.17 0.05 0.12 0.11 0.23 0.17
  0.09 0.51]
 [0.21 0.28 0.11 0.08 1.   0.34 0.15 0.09 0.19 0.01 0.09 0.03 0.02 0.01
  0.   0.03 0.02 0.   0.01 0.08 0.   0.16 0.05 0.08 0.02 0.04 0.05 0.07
  0.   0.02]
 [0.47 0.51 0.27 0.16 0.71 1.   0.75 0.59 0.79 0.18 0.27 0.1  0.19 0.16
  0.15 0.1  0.1  0.04 0.16 0.2  0.06 0.19 0.17 0.15 0.14 0.33 0.14 0.23
  0.14 0.3 ]
 [0.29 0.31 0.2  0.14 0.4  0.7  1.   0.43 0.44 0.21 0.16 0.11 0.27 0.12
  0.07 0.14 0.1  0.03 0.27 0.12 0.18 0.11 0.24 0.17 0.23 0.56 0.21 0.42
  0.11 0.24]
 [0.38 0.36 0.2  0.18 0.37 0.56 0.49 1.   0.41 0.19 0.2  0.18 0.23 0.09
  0.49 0.07 0.13 0.06 0.23 0.07 0.07 0.07 0.23 0.32 0.18 0.25 0.18 0.22
  0.32 0.12]
 [0.   0.   0.   0.   0.   0.   0.   0.   1.   0.   0.   0.   0.   0.
  0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.
  0.   0.  ]
 [0.19 0.21 0.3  0.16 0.09 0.15 0.23 0.13 0.23 1.   0.51 0.63 0.74 0.55
  0.36 0.25 0.2  0.12 0.41 0.25 0.47 0.07 0.15 0.1  0.21 0.27 0.14 0.14
  0.12 0.11]
 [0.49 0.43 0.31 0.26 0.32 0.29 0.19 0.11 0.2  0.59 1.   0.6  0.23 0.7
  0.26 0.32 0.34 0.13 0.21 0.51 0.33 0.38 0.11 0.11 0.14 0.18 0.15 0.24
  0.1  0.06]
 [0.33 0.29 0.51 0.41 0.24 0.12 0.17 0.17 0.08 0.7  0.59 1.   0.44 0.62
  0.29 0.42 0.19 0.2  0.21 0.4  0.3  0.18 0.23 0.19 0.21 0.21 0.15 0.17
  0.12 0.12]
 [0.14 0.08 0.22 0.15 0.11 0.15 0.4  0.11 0.28 0.71 0.18 0.33 1.   0.45
  0.19 0.19 0.13 0.07 0.35 0.14 0.3  0.1  0.2  0.14 0.14 0.37 0.11 0.15
  0.11 0.14]
 [0.32 0.18 0.21 0.37 0.07 0.11 0.15 0.06 0.03 0.59 0.63 0.56 0.52 1.
  0.2  0.2  0.5  0.13 0.35 0.31 0.44 0.32 0.24 0.16 0.07 0.17 0.16 0.11
  0.08 0.29]
 [0.18 0.14 0.14 0.09 0.1  0.12 0.1  0.41 0.22 0.29 0.19 0.18 0.21 0.17
  1.   0.1  0.09 0.03 0.1  0.11 0.17 0.1  0.08 0.15 0.2  0.15 0.14 0.14
  0.49 0.16]
 [0.26 0.27 0.44 0.23 0.29 0.12 0.25 0.07 0.21 0.37 0.39 0.49 0.3  0.24
  0.1  1.   0.54 0.62 0.57 0.72 0.79 0.38 0.19 0.1  0.15 0.21 0.18 0.26
  0.11 0.34]
 [0.44 0.2  0.38 0.49 0.14 0.13 0.19 0.15 0.35 0.28 0.4  0.21 0.24 0.61
  0.13 0.56 1.   0.54 0.63 0.55 0.6  0.69 0.2  0.15 0.13 0.15 0.21 0.27
  0.12 0.54]
 [0.04 0.06 0.1  0.05 0.05 0.03 0.05 0.05 0.02 0.14 0.12 0.16 0.11 0.14
  0.03 0.51 0.44 1.   0.53 0.37 0.41 0.24 0.09 0.13 0.02 0.04 0.03 0.04
  0.04 0.02]
 [0.26 0.19 0.46 0.21 0.11 0.23 0.44 0.29 0.09 0.6  0.28 0.52 0.56 0.49
  0.18 0.64 0.69 0.72 1.   0.58 0.85 0.36 0.31 0.26 0.16 0.32 0.16 0.23
  0.14 0.12]
 [0.62 0.45 0.55 0.23 0.51 0.28 0.21 0.08 0.42 0.38 0.61 0.48 0.28 0.21
  0.19 0.82 0.62 0.52 0.58 1.   0.72 0.51 0.19 0.13 0.21 0.33 0.15 0.36
  0.13 0.38]
 [0.26 0.22 0.37 0.13 0.14 0.04 0.2  0.03 0.22 0.51 0.31 0.39 0.34 0.44
  0.17 0.64 0.3  0.4  0.63 0.5  1.   0.15 0.13 0.11 0.21 0.18 0.14 0.15
  0.11 0.19]
 [0.38 0.24 0.32 0.36 0.45 0.18 0.14 0.07 0.33 0.08 0.33 0.13 0.15 0.32
  0.1  0.3  0.56 0.24 0.25 0.37 0.17 1.   0.1  0.09 0.16 0.14 0.18 0.39
  0.12 0.45]
 [0.21 0.31 0.23 0.25 0.34 0.23 0.39 0.27 0.14 0.22 0.16 0.25 0.26 0.3
  0.12 0.21 0.19 0.12 0.28 0.18 0.19 0.12 1.   1.   0.4  0.33 0.51 0.39
  0.2  0.13]
 [0.   0.   0.   0.   0.01 0.   0.   0.   0.   0.   0.   0.   0.   0.
  0.   0.   0.   0.   0.   0.   0.   0.   0.17 1.   0.01 0.   0.03 0.01
  0.   0.  ]
 [0.33 0.33 0.46 0.19 0.25 0.22 0.38 0.23 0.21 0.35 0.24 0.27 0.31 0.13
  0.38 0.2  0.17 0.04 0.19 0.24 0.36 0.21 0.47 0.47 1.   0.67 0.81 0.64
  0.51 0.25]
 [0.5  0.38 0.43 0.13 0.35 0.49 0.87 0.31 0.74 0.42 0.3  0.27 0.6  0.29
  0.27 0.27 0.18 0.06 0.36 0.34 0.34 0.22 0.4  0.34 0.69 1.   0.61 0.59
  0.34 0.35]
 [0.23 0.6  0.3  0.1  0.21 0.12 0.25 0.12 0.04 0.14 0.14 0.11 0.12 0.1
  0.16 0.09 0.14 0.02 0.1  0.1  0.17 0.15 0.37 0.54 0.59 0.4  1.   0.57
  0.25 0.09]
 [0.34 0.25 0.32 0.22 0.39 0.31 0.64 0.17 0.19 0.2  0.31 0.18 0.24 0.18
  0.17 0.26 0.25 0.04 0.18 0.31 0.19 0.5  0.41 0.46 0.59 0.51 0.74 1.
  0.33 0.43]
 [0.33 0.32 0.34 0.26 0.28 0.38 0.4  0.53 0.56 0.37 0.3  0.29 0.39 0.29
  0.86 0.24 0.27 0.15 0.24 0.25 0.32 0.31 0.36 0.47 0.64 0.49 0.56 0.55
  1.   0.51]
 [0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.
  0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.
  0.   1.  ]]
Pattern-to-pattern sim matrix:
[[ 1.    0.78  0.69  0.68  0.68  0.76  0.62  0.59  0.49  0.35  0.65  0.47
   0.43  0.58  0.52  0.46  0.53  0.09  0.27  0.72  0.41  0.56  0.35  0.36
   0.46  0.52  0.42  0.52  0.45  0.5 ]
 [ 0.78  1.    0.71  0.6   0.64  0.64  0.5   0.38  0.42  0.34  0.67  0.4
   0.3   0.38  0.36  0.42  0.38  0.16  0.2   0.57  0.38  0.38  0.36  0.32
   0.4   0.4   0.67  0.38  0.31  0.38]
 [ 0.69  0.71  1.    0.7   0.59  0.51  0.47  0.41  0.34  0.48  0.61  0.64
   0.59  0.5   0.35  0.59  0.61  0.13  0.4   0.68  0.52  0.62  0.43  0.43
   0.58  0.51  0.48  0.54  0.47  0.5 ]
 [ 0.68  0.6   0.7   1.    0.51  0.34  0.39  0.25  0.23  0.36  0.4   0.54
   0.47  0.57  0.32  0.52  0.64  0.16  0.32  0.51  0.39  0.65  0.38  0.33
   0.43  0.29  0.4   0.49  0.35  0.56]
 [ 0.68  0.64  0.59  0.51  1.    0.8   0.59  0.57  0.61  0.32  0.58  0.45
   0.45  0.3   0.42  0.43  0.33  0.11  0.26  0.54  0.33  0.5   0.43  0.48
   0.41  0.41  0.4   0.46  0.43  0.22]
 [ 0.76  0.64  0.51  0.34  0.8   1.    0.82  0.72  0.64  0.34  0.44  0.28
   0.47  0.29  0.44  0.26  0.18 -0.02  0.22  0.47  0.15  0.33  0.35  0.34
   0.4   0.51  0.28  0.48  0.48  0.29]
 [ 0.62  0.5   0.47  0.39  0.59  0.82  1.    0.58  0.53  0.46  0.37  0.27
   0.62  0.23  0.33  0.25  0.17  0.02  0.46  0.35  0.25  0.27  0.54  0.41
   0.56  0.84  0.5   0.61  0.45  0.27]
 [ 0.59  0.38  0.41  0.25  0.57  0.72  0.58  1.    0.43  0.34  0.33  0.29
   0.45  0.21  0.5   0.16  0.25  0.2   0.3   0.17  0.2   0.15  0.36  0.37
   0.35  0.39  0.3   0.37  0.5   0.31]
 [ 0.49  0.42  0.34  0.23  0.61  0.64  0.53  0.43  1.    0.33  0.33  0.25
   0.49  0.24  0.37  0.26  0.14  0.01  0.14  0.42  0.16  0.34  0.26  0.21
   0.29  0.43  0.22  0.32  0.35  0.21]
 [ 0.35  0.34  0.48  0.36  0.32  0.34  0.46  0.34  0.33  1.    0.69  0.74
   0.79  0.66  0.68  0.41  0.24  0.21  0.65  0.45  0.65  0.21  0.32  0.28
   0.5   0.54  0.29  0.33  0.49  0.2 ]
 [ 0.65  0.67  0.61  0.4   0.58  0.44  0.37  0.33  0.33  0.69  1.    0.72
   0.54  0.76  0.52  0.56  0.47  0.26  0.42  0.76  0.54  0.46  0.32  0.36
   0.34  0.34  0.34  0.44  0.37  0.33]
 [ 0.47  0.4   0.64  0.54  0.45  0.28  0.27  0.29  0.25  0.74  0.72  1.
   0.69  0.77  0.55  0.62  0.33  0.32  0.47  0.63  0.55  0.34  0.42  0.38
   0.38  0.36  0.29  0.39  0.37  0.21]
 [ 0.43  0.3   0.59  0.47  0.45  0.47  0.62  0.45  0.49  0.79  0.54  0.69
   1.    0.67  0.46  0.45  0.3   0.16  0.64  0.43  0.52  0.35  0.53  0.37
   0.53  0.73  0.41  0.48  0.55  0.27]
 [ 0.58  0.38  0.5   0.57  0.3   0.29  0.23  0.21  0.24  0.66  0.76  0.77
   0.67  1.    0.43  0.46  0.71  0.26  0.6   0.43  0.58  0.56  0.42  0.33
   0.28  0.31  0.35  0.38  0.35  0.42]
 [ 0.52  0.36  0.35  0.32  0.42  0.44  0.33  0.5   0.37  0.68  0.52  0.55
   0.46  0.43  1.    0.25  0.27  0.01  0.32  0.44  0.5   0.39  0.25  0.38
   0.59  0.42  0.39  0.41  0.74  0.25]
 [ 0.46  0.42  0.59  0.52  0.43  0.26  0.25  0.16  0.26  0.41  0.56  0.62
   0.45  0.46  0.25  1.    0.72  0.73  0.64  0.85  0.75  0.56  0.39  0.28
   0.3   0.32  0.27  0.42  0.31  0.47]
 [ 0.53  0.38  0.61  0.64  0.33  0.18  0.17  0.25  0.14  0.24  0.47  0.33
   0.3   0.71  0.27  0.72  1.    0.61  0.68  0.75  0.58  0.77  0.26  0.31
   0.34  0.24  0.32  0.4   0.31  0.66]
 [ 0.09  0.16  0.13  0.16  0.11 -0.02  0.02  0.2   0.01  0.21  0.26  0.32
   0.16  0.26  0.01  0.73  0.61  1.    0.73  0.55  0.59  0.39  0.15  0.25
  -0.11 -0.04 -0.01 -0.04  0.04  0.28]
 [ 0.27  0.2   0.4   0.32  0.26  0.22  0.46  0.3   0.14  0.65  0.42  0.47
   0.64  0.6   0.32  0.64  0.68  0.73  1.    0.62  0.82  0.43  0.45  0.32
   0.24  0.55  0.34  0.37  0.44  0.31]
 [ 0.72  0.57  0.68  0.51  0.54  0.47  0.35  0.17  0.42  0.45  0.76  0.63
   0.43  0.43  0.44  0.85  0.75  0.55  0.62  1.    0.7   0.59  0.33  0.34
   0.4   0.44  0.31  0.46  0.41  0.5 ]
 [ 0.41  0.38  0.52  0.39  0.33  0.15  0.25  0.2   0.16  0.65  0.54  0.55
   0.52  0.58  0.5   0.75  0.58  0.59  0.82  0.7   1.    0.43  0.28  0.29
   0.44  0.39  0.31  0.34  0.46  0.29]
 [ 0.56  0.38  0.62  0.65  0.5   0.33  0.27  0.15  0.34  0.21  0.46  0.34
   0.35  0.56  0.39  0.56  0.77  0.39  0.43  0.59  0.43  1.    0.31  0.38
   0.47  0.34  0.4   0.6   0.42  0.69]
 [ 0.35  0.36  0.43  0.38  0.43  0.35  0.54  0.36  0.26  0.32  0.32  0.42
   0.53  0.42  0.25  0.39  0.26  0.15  0.45  0.33  0.28  0.31  1.    0.86
   0.62  0.59  0.7   0.71  0.45  0.21]
 [ 0.36  0.32  0.43  0.33  0.48  0.34  0.41  0.37  0.21  0.28  0.36  0.38
   0.37  0.33  0.38  0.28  0.31  0.25  0.32  0.34  0.29  0.38  0.86  1.
   0.58  0.45  0.71  0.69  0.52  0.15]
 [ 0.46  0.4   0.58  0.43  0.41  0.4   0.56  0.35  0.29  0.5   0.34  0.38
   0.53  0.28  0.59  0.3   0.34 -0.11  0.24  0.4   0.44  0.47  0.62  0.58
   1.    0.75  0.77  0.79  0.78  0.28]
 [ 0.52  0.4   0.51  0.29  0.41  0.51  0.84  0.39  0.43  0.54  0.34  0.36
   0.73  0.31  0.42  0.32  0.24 -0.04  0.55  0.44  0.39  0.34  0.59  0.45
   0.75  1.    0.7   0.68  0.58  0.25]
 [ 0.42  0.67  0.48  0.4   0.4   0.28  0.5   0.3   0.22  0.29  0.34  0.29
   0.41  0.35  0.39  0.27  0.32 -0.01  0.34  0.31  0.31  0.4   0.7   0.71
   0.77  0.7   1.    0.81  0.57  0.35]
 [ 0.52  0.38  0.54  0.49  0.46  0.48  0.61  0.37  0.32  0.33  0.44  0.39
   0.48  0.38  0.41  0.42  0.4  -0.04  0.37  0.46  0.34  0.6   0.71  0.69
   0.79  0.68  0.81  1.    0.66  0.5 ]
 [ 0.45  0.31  0.47  0.35  0.43  0.48  0.45  0.5   0.35  0.49  0.37  0.37
   0.55  0.35  0.74  0.31  0.31  0.04  0.44  0.41  0.46  0.42  0.45  0.52
   0.78  0.58  0.57  0.66  1.    0.42]
 [ 0.5   0.38  0.5   0.56  0.22  0.29  0.27  0.31  0.21  0.2   0.33  0.21
   0.27  0.42  0.25  0.47  0.66  0.28  0.31  0.5   0.29  0.69  0.21  0.15
   0.28  0.25  0.35  0.5   0.42  1.  ]]
Got 30 patterns after merging
2024-03-12 00:31:56.591436 MEMORY 16.31557632
Performing filtering
2024-03-12 00:31:56.591633 MEMORY 16.31557632
Got 24 patterns after filtering
2024-03-12 00:32:00.962604 MEMORY 16.31557632
Total time taken is 2834.71s
2024-03-12 00:32:00.962784 MEMORY 16.31557632
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 2532 tasks      | elapsed:    1.0s
[Parallel(n_jobs=24)]: Done 2872 out of 2872 | elapsed:    1.2s finished
/ru-auth/local/home/lzhao/anaconda3/envs/jupyter-ml-clone/lib/python3.9/site-packages/sklearn/manifold/_t_sne.py:691: FutureWarning: 'square_distances' has been introduced in 0.24 to help phase out legacy squaring behavior. The 'legacy' setting will be removed in 1.1 (renaming of 0.26), and the default setting will be changed to True. In 1.3, 'square_distances' will be removed altogether, and distances will be squared by default. Set 'square_distances'=True to silence this warning.
  warnings.warn(
/ru-auth/local/home/lzhao/anaconda3/envs/jupyter-ml-clone/lib/python3.9/site-packages/sklearn/neighbors/_base.py:175: EfficiencyWarning: Precomputed sparse input was not sorted by data.
  warnings.warn('Precomputed sparse input was not sorted by data.',
Applying subclustering to the final motifs
On pattern 0
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 2872 samples in 0.022s...
[t-SNE] Computed neighbors for 2872 samples in 0.002s...
[t-SNE] Computed conditional probabilities for sample 1000 / 2872
[t-SNE] Computed conditional probabilities for sample 2000 / 2872
[t-SNE] Computed conditional probabilities for sample 2872 / 2872
[t-SNE] Mean sigma: 0.286379
[t-SNE] Computed conditional probabilities in 0.203s
[t-SNE] Iteration 50: error = 73.8964081, gradient norm = 0.0421501 (50 iterations in 2.838s)
[t-SNE] Iteration 100: error = 73.8863754, gradient norm = 0.0290742 (50 iterations in 2.154s)
[t-SNE] Iteration 150: error = 73.8839417, gradient norm = 0.0232962 (50 iterations in 2.136s)
[t-SNE] Iteration 200: error = 73.8828430, gradient norm = 0.0205797 (50 iterations in 2.125s)
[t-SNE] Iteration 250: error = 73.8831024, gradient norm = 0.0211072 (50 iterations in 2.155s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 73.883102
[t-SNE] Iteration 300: error = 2.5431483, gradient norm = 0.0012572 (50 iterations in 2.118s)
[t-SNE] Iteration 350: error = 2.4116874, gradient norm = 0.0004443 (50 iterations in 2.096s)
[t-SNE] Iteration 400: error = 2.3541367, gradient norm = 0.0002331 (50 iterations in 2.074s)
[t-SNE] Iteration 450: error = 2.3255453, gradient norm = 0.0001761 (50 iterations in 2.103s)
[t-SNE] Iteration 500: error = 2.3080187, gradient norm = 0.0001373 (50 iterations in 2.127s)
[t-SNE] Iteration 550: error = 2.2971327, gradient norm = 0.0001263 (50 iterations in 2.090s)
[t-SNE] Iteration 600: error = 2.2902322, gradient norm = 0.0000909 (50 iterations in 2.080s)
[t-SNE] Iteration 650: error = 2.2848487, gradient norm = 0.0000906 (50 iterations in 2.095s)
[t-SNE] Iteration 700: error = 2.2815108, gradient norm = 0.0000802 (50 iterations in 2.091s)
[t-SNE] Iteration 750: error = 2.2797692, gradient norm = 0.0000673 (50 iterations in 2.107s)
[t-SNE] Iteration 800: error = 2.2776928, gradient norm = 0.0000485 (50 iterations in 2.099s)
[t-SNE] Iteration 850: error = 2.2754614, gradient norm = 0.0000480 (50 iterations in 2.091s)
[t-SNE] Iteration 900: error = 2.2737889, gradient norm = 0.0000506 (50 iterations in 2.095s)
[t-SNE] Iteration 950: error = 2.2723491, gradient norm = 0.0000552 (50 iterations in 2.096s)
[t-SNE] Iteration 1000: error = 2.2713943, gradient norm = 0.0000518 (50 iterations in 2.087s)
[t-SNE] KL divergence after 1000 iterations: 2.271394
[t-SNE] Computed conditional probabilities for sample 1000 / 2872
[t-SNE] Computed conditional probabilities for sample 2000 / 2872
[t-SNE] Computed conditional probabilities for sample 2872 / 2872
[t-SNE] Mean sigma: 0.286379
Beginning preprocessing + Leiden
2024-03-12 00:32:48.492293 MEMORY 16.315850752
Affmat transformed
2024-03-12 00:32:48.529975 MEMORY 16.315850752
sources, targets, weights extracted
2024-03-12 00:32:48.556789 MEMORY 16.315850752
About to launch parallel Leiden runs
2024-03-12 00:32:48.712988 MEMORY 16.31582208
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:   10.5s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   35.9s finished
Parallel Leiden runs finished
2024-03-12 00:33:24.610403 MEMORY 16.31582208
Quality: 0.48758302482447796
Quality: 0.4895962732790335
Quality: 0.4900881118088481
Quality: 0.49027945774120646
Quality: 0.49030685661513435
Quality: 0.4904526717605624
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 2239 tasks      | elapsed:    0.9s
[Parallel(n_jobs=24)]: Done 2615 out of 2615 | elapsed:    1.0s finished
Got subclusters: Counter({0: 505, 1: 470, 2: 434, 3: 385, 4: 364, 5: 281, 6: 227, 7: 206})
On pattern 1
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 2615 samples in 0.020s...
[t-SNE] Computed neighbors for 2615 samples in 0.002s...
[t-SNE] Computed conditional probabilities for sample 1000 / 2615
[t-SNE] Computed conditional probabilities for sample 2000 / 2615
[t-SNE] Computed conditional probabilities for sample 2615 / 2615
[t-SNE] Mean sigma: 0.290146
[t-SNE] Computed conditional probabilities in 0.182s
[t-SNE] Iteration 50: error = 72.4974899, gradient norm = 0.0354080 (50 iterations in 2.146s)
[t-SNE] Iteration 100: error = 72.4991608, gradient norm = 0.0388027 (50 iterations in 2.143s)
[t-SNE] Iteration 150: error = 72.4957733, gradient norm = 0.0312572 (50 iterations in 2.106s)
[t-SNE] Iteration 200: error = 72.4967041, gradient norm = 0.0328379 (50 iterations in 2.134s)
[t-SNE] Iteration 250: error = 72.5013199, gradient norm = 0.0412844 (50 iterations in 2.120s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 72.501320
[t-SNE] Iteration 300: error = 2.5385716, gradient norm = 0.0012357 (50 iterations in 2.087s)
[t-SNE] Iteration 350: error = 2.4188874, gradient norm = 0.0004726 (50 iterations in 2.083s)
[t-SNE] Iteration 400: error = 2.3639796, gradient norm = 0.0002464 (50 iterations in 2.072s)
[t-SNE] Iteration 450: error = 2.3360672, gradient norm = 0.0001730 (50 iterations in 2.079s)
[t-SNE] Iteration 500: error = 2.3212428, gradient norm = 0.0001944 (50 iterations in 2.075s)
[t-SNE] Iteration 550: error = 2.3118360, gradient norm = 0.0001202 (50 iterations in 2.091s)
[t-SNE] Iteration 600: error = 2.3068023, gradient norm = 0.0001038 (50 iterations in 2.063s)
[t-SNE] Iteration 650: error = 2.3033648, gradient norm = 0.0000855 (50 iterations in 2.073s)
[t-SNE] Iteration 700: error = 2.2999992, gradient norm = 0.0000700 (50 iterations in 2.104s)
[t-SNE] Iteration 750: error = 2.2970929, gradient norm = 0.0000631 (50 iterations in 2.117s)
[t-SNE] Iteration 800: error = 2.2945173, gradient norm = 0.0000673 (50 iterations in 2.102s)
[t-SNE] Iteration 850: error = 2.2927608, gradient norm = 0.0000662 (50 iterations in 1.927s)
[t-SNE] Iteration 900: error = 2.2916811, gradient norm = 0.0000441 (50 iterations in 2.071s)
[t-SNE] Iteration 950: error = 2.2905743, gradient norm = 0.0000388 (50 iterations in 2.071s)
[t-SNE] Iteration 1000: error = 2.2894425, gradient norm = 0.0000443 (50 iterations in 2.134s)
[t-SNE] KL divergence after 1000 iterations: 2.289443
[t-SNE] Computed conditional probabilities for sample 1000 / 2615
[t-SNE] Computed conditional probabilities for sample 2000 / 2615
[t-SNE] Computed conditional probabilities for sample 2615 / 2615
[t-SNE] Mean sigma: 0.290146
Beginning preprocessing + Leiden
2024-03-12 00:34:10.941566 MEMORY 16.31377408
Affmat transformed
2024-03-12 00:34:10.976949 MEMORY 16.314134528
sources, targets, weights extracted
2024-03-12 00:34:11.004622 MEMORY 16.314175488
About to launch parallel Leiden runs
2024-03-12 00:34:11.040807 MEMORY 16.314302464
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    9.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   36.3s finished
Parallel Leiden runs finished
2024-03-12 00:34:47.319750 MEMORY 16.314753024
Quality: 0.4426435988211998
Quality: 0.4468961396894369
Quality: 0.45082536439194215
Quality: 0.45190493715804536
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 1974 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done 2239 out of 2239 | elapsed:    0.8s finished
Got subclusters: Counter({0: 422, 1: 405, 2: 389, 3: 348, 4: 299, 5: 241, 6: 191, 7: 167, 8: 101, 9: 52})
On pattern 2
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 2239 samples in 0.016s...
[t-SNE] Computed neighbors for 2239 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 1000 / 2239
[t-SNE] Computed conditional probabilities for sample 2000 / 2239
[t-SNE] Computed conditional probabilities for sample 2239 / 2239
[t-SNE] Mean sigma: 0.311143
[t-SNE] Computed conditional probabilities in 0.151s
[t-SNE] Iteration 50: error = 71.9336395, gradient norm = 0.0700716 (50 iterations in 2.113s)
[t-SNE] Iteration 100: error = 71.9041061, gradient norm = 0.0376476 (50 iterations in 2.102s)
[t-SNE] Iteration 150: error = 71.9342117, gradient norm = 0.0700014 (50 iterations in 2.109s)
[t-SNE] Iteration 200: error = 71.9378281, gradient norm = 0.0642986 (50 iterations in 2.136s)
[t-SNE] Iteration 250: error = 72.1056137, gradient norm = 0.0529281 (50 iterations in 2.177s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 72.105614
[t-SNE] Iteration 300: error = 2.3774421, gradient norm = 0.0012244 (50 iterations in 2.094s)
[t-SNE] Iteration 350: error = 2.2678318, gradient norm = 0.0004018 (50 iterations in 2.074s)
[t-SNE] Iteration 400: error = 2.2213793, gradient norm = 0.0002149 (50 iterations in 2.066s)
[t-SNE] Iteration 450: error = 2.1979320, gradient norm = 0.0001436 (50 iterations in 2.076s)
[t-SNE] Iteration 500: error = 2.1858602, gradient norm = 0.0000972 (50 iterations in 2.077s)
[t-SNE] Iteration 550: error = 2.1786139, gradient norm = 0.0000881 (50 iterations in 1.924s)
[t-SNE] Iteration 600: error = 2.1738617, gradient norm = 0.0000677 (50 iterations in 2.075s)
[t-SNE] Iteration 650: error = 2.1705339, gradient norm = 0.0000618 (50 iterations in 2.063s)
[t-SNE] Iteration 700: error = 2.1682575, gradient norm = 0.0000514 (50 iterations in 2.086s)
[t-SNE] Iteration 750: error = 2.1662464, gradient norm = 0.0000490 (50 iterations in 2.094s)
[t-SNE] Iteration 800: error = 2.1646297, gradient norm = 0.0001626 (50 iterations in 2.069s)
[t-SNE] Iteration 850: error = 2.1638017, gradient norm = 0.0000378 (50 iterations in 2.086s)
[t-SNE] Iteration 900: error = 2.1630116, gradient norm = 0.0000324 (50 iterations in 2.062s)
[t-SNE] Iteration 950: error = 2.1622005, gradient norm = 0.0000326 (50 iterations in 1.986s)
[t-SNE] Iteration 1000: error = 2.1615498, gradient norm = 0.0000305 (50 iterations in 2.073s)
[t-SNE] KL divergence after 1000 iterations: 2.161550
[t-SNE] Computed conditional probabilities for sample 1000 / 2239
[t-SNE] Computed conditional probabilities for sample 2000 / 2239
[t-SNE] Computed conditional probabilities for sample 2239 / 2239
[t-SNE] Mean sigma: 0.311143
Beginning preprocessing + Leiden
2024-03-12 00:35:32.625187 MEMORY 16.314720256
Affmat transformed
2024-03-12 00:35:32.653532 MEMORY 16.314929152
sources, targets, weights extracted
2024-03-12 00:35:32.670761 MEMORY 16.314933248
About to launch parallel Leiden runs
2024-03-12 00:35:32.691735 MEMORY 16.314990592
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    8.6s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   29.7s finished
Parallel Leiden runs finished
2024-03-12 00:36:02.397089 MEMORY 16.313409536
Quality: 0.4643813862058289
Quality: 0.46795265743554737
Quality: 0.47044203714459193
Quality: 0.47186176473266006
Quality: 0.47216342379164244
Quality: 0.473443512045196
Quality: 0.4738978861753913
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 1290 tasks      | elapsed:    0.4s
[Parallel(n_jobs=24)]: Done 1390 out of 1390 | elapsed:    0.4s finished
Got subclusters: Counter({0: 450, 1: 362, 2: 331, 3: 325, 4: 279, 5: 256, 6: 181, 7: 55})
On pattern 3
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 1390 samples in 0.010s...
[t-SNE] Computed neighbors for 1390 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 1000 / 1390
[t-SNE] Computed conditional probabilities for sample 1390 / 1390
[t-SNE] Mean sigma: 0.294164
[t-SNE] Computed conditional probabilities in 0.094s
[t-SNE] Iteration 50: error = 68.2509384, gradient norm = 0.2249315 (50 iterations in 2.063s)
[t-SNE] Iteration 100: error = 68.7915649, gradient norm = 0.2221981 (50 iterations in 2.073s)
[t-SNE] Iteration 150: error = 69.5686188, gradient norm = 0.1984414 (50 iterations in 2.065s)
[t-SNE] Iteration 200: error = 69.7193222, gradient norm = 0.2048663 (50 iterations in 2.111s)
[t-SNE] Iteration 250: error = 68.6598434, gradient norm = 0.2249247 (50 iterations in 2.083s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 68.659843
[t-SNE] Iteration 300: error = 1.9471488, gradient norm = 0.0015780 (50 iterations in 2.096s)
[t-SNE] Iteration 350: error = 1.8814950, gradient norm = 0.0004746 (50 iterations in 2.106s)
[t-SNE] Iteration 400: error = 1.8486245, gradient norm = 0.0004204 (50 iterations in 2.081s)
[t-SNE] Iteration 450: error = 1.8339835, gradient norm = 0.0002721 (50 iterations in 2.053s)
[t-SNE] Iteration 500: error = 1.8270565, gradient norm = 0.0001299 (50 iterations in 2.064s)
[t-SNE] Iteration 550: error = 1.8220117, gradient norm = 0.0001690 (50 iterations in 2.107s)
[t-SNE] Iteration 600: error = 1.8181202, gradient norm = 0.0001391 (50 iterations in 2.066s)
[t-SNE] Iteration 650: error = 1.8160679, gradient norm = 0.0000822 (50 iterations in 2.054s)
[t-SNE] Iteration 700: error = 1.8137021, gradient norm = 0.0000747 (50 iterations in 2.052s)
[t-SNE] Iteration 750: error = 1.8126285, gradient norm = 0.0000526 (50 iterations in 2.094s)
[t-SNE] Iteration 800: error = 1.8115885, gradient norm = 0.0000584 (50 iterations in 2.082s)
[t-SNE] Iteration 850: error = 1.8110085, gradient norm = 0.0000422 (50 iterations in 2.059s)
[t-SNE] Iteration 900: error = 1.8105383, gradient norm = 0.0000447 (50 iterations in 2.045s)
[t-SNE] Iteration 950: error = 1.8102373, gradient norm = 0.0000367 (50 iterations in 2.067s)
[t-SNE] Iteration 1000: error = 1.8099955, gradient norm = 0.0000323 (50 iterations in 2.055s)
[t-SNE] KL divergence after 1000 iterations: 1.809996
[t-SNE] Computed conditional probabilities for sample 1000 / 1390
[t-SNE] Computed conditional probabilities for sample 1390 / 1390
[t-SNE] Mean sigma: 0.294164
Beginning preprocessing + Leiden
2024-03-12 00:36:46.241853 MEMORY 16.315383808
Affmat transformed
2024-03-12 00:36:46.258956 MEMORY 16.315383808
sources, targets, weights extracted
2024-03-12 00:36:46.272988 MEMORY 16.315392
About to launch parallel Leiden runs
2024-03-12 00:36:46.297879 MEMORY 16.315404288
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    3.9s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   14.4s finished
Parallel Leiden runs finished
2024-03-12 00:37:00.681985 MEMORY 16.315408384
Quality: 0.43320543014617247
Quality: 0.4359983474048161
Quality: 0.43656020209458435
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 891 out of 891 | elapsed:    0.2s finished
Got subclusters: Counter({0: 248, 1: 202, 2: 200, 3: 185, 4: 149, 5: 137, 6: 128, 7: 77, 8: 64})
On pattern 4
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 891 samples in 0.007s...
[t-SNE] Computed neighbors for 891 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 891 / 891
[t-SNE] Mean sigma: 0.341010
[t-SNE] Computed conditional probabilities in 0.062s
[t-SNE] Iteration 50: error = 69.1920090, gradient norm = 0.3313958 (50 iterations in 2.056s)
[t-SNE] Iteration 100: error = 68.1572571, gradient norm = 0.3376114 (50 iterations in 2.042s)
[t-SNE] Iteration 150: error = 68.9728851, gradient norm = 0.3251981 (50 iterations in 2.049s)
[t-SNE] Iteration 200: error = 70.2332993, gradient norm = 0.3021312 (50 iterations in 2.043s)
[t-SNE] Iteration 250: error = 70.3630905, gradient norm = 0.2998749 (50 iterations in 2.042s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 70.363091
[t-SNE] Iteration 300: error = 1.6967733, gradient norm = 0.0038352 (50 iterations in 2.051s)
[t-SNE] Iteration 350: error = 1.6382064, gradient norm = 0.0006413 (50 iterations in 2.032s)
[t-SNE] Iteration 400: error = 1.5978570, gradient norm = 0.0007228 (50 iterations in 2.040s)
[t-SNE] Iteration 450: error = 1.5705898, gradient norm = 0.0005975 (50 iterations in 2.033s)
[t-SNE] Iteration 500: error = 1.5572299, gradient norm = 0.0003883 (50 iterations in 2.035s)
[t-SNE] Iteration 550: error = 1.5465651, gradient norm = 0.0004151 (50 iterations in 2.056s)
[t-SNE] Iteration 600: error = 1.5403615, gradient norm = 0.0001799 (50 iterations in 2.046s)
[t-SNE] Iteration 650: error = 1.5359658, gradient norm = 0.0004462 (50 iterations in 2.056s)
[t-SNE] Iteration 700: error = 1.5301554, gradient norm = 0.0002910 (50 iterations in 2.040s)
[t-SNE] Iteration 750: error = 1.5266378, gradient norm = 0.0001657 (50 iterations in 2.041s)
[t-SNE] Iteration 800: error = 1.5240420, gradient norm = 0.0001542 (50 iterations in 2.059s)
[t-SNE] Iteration 850: error = 1.5220460, gradient norm = 0.0001159 (50 iterations in 2.046s)
[t-SNE] Iteration 900: error = 1.5216042, gradient norm = 0.0000723 (50 iterations in 2.052s)
[t-SNE] Iteration 950: error = 1.5209488, gradient norm = 0.0001057 (50 iterations in 2.048s)
[t-SNE] Iteration 1000: error = 1.5207367, gradient norm = 0.0000465 (50 iterations in 2.055s)
[t-SNE] KL divergence after 1000 iterations: 1.520737
[t-SNE] Computed conditional probabilities for sample 891 / 891
[t-SNE] Mean sigma: 0.341010
Beginning preprocessing + Leiden
2024-03-12 00:37:43.089976 MEMORY 16.315408384
Affmat transformed
2024-03-12 00:37:43.101613 MEMORY 16.315408384
sources, targets, weights extracted
2024-03-12 00:37:43.108538 MEMORY 16.315408384
About to launch parallel Leiden runs
2024-03-12 00:37:43.144653 MEMORY 16.315408384
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    2.1s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    6.6s finished
Parallel Leiden runs finished
2024-03-12 00:37:49.768275 MEMORY 16.315408384
Quality: 0.45610885922191585
Quality: 0.4601580975348193
Quality: 0.4614295801736189
Quality: 0.4619522778984524
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 720 out of 767 | elapsed:    0.3s remaining:    0.0s
[Parallel(n_jobs=24)]: Done 767 out of 767 | elapsed:    0.4s finished
Got subclusters: Counter({0: 168, 1: 163, 2: 126, 3: 113, 4: 95, 5: 85, 6: 76, 7: 65})
On pattern 5
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 767 samples in 0.006s...
[t-SNE] Computed neighbors for 767 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 767 / 767
[t-SNE] Mean sigma: 0.346406
[t-SNE] Computed conditional probabilities in 0.054s
[t-SNE] Iteration 50: error = 68.1176453, gradient norm = 0.3757283 (50 iterations in 2.035s)
[t-SNE] Iteration 100: error = 70.4849625, gradient norm = 0.3375842 (50 iterations in 2.042s)
[t-SNE] Iteration 150: error = 69.4410782, gradient norm = 0.3589554 (50 iterations in 2.058s)
[t-SNE] Iteration 200: error = 69.9770660, gradient norm = 0.3532838 (50 iterations in 2.051s)
[t-SNE] Iteration 250: error = 68.1780548, gradient norm = 0.3754625 (50 iterations in 2.052s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 68.178055
[t-SNE] Iteration 300: error = 1.8387696, gradient norm = 0.0023083 (50 iterations in 2.061s)
[t-SNE] Iteration 350: error = 1.7571315, gradient norm = 0.0009801 (50 iterations in 2.032s)
[t-SNE] Iteration 400: error = 1.7267970, gradient norm = 0.0006977 (50 iterations in 2.051s)
[t-SNE] Iteration 450: error = 1.7108010, gradient norm = 0.0002304 (50 iterations in 2.039s)
[t-SNE] Iteration 500: error = 1.7058113, gradient norm = 0.0002566 (50 iterations in 2.052s)
[t-SNE] Iteration 550: error = 1.7033300, gradient norm = 0.0001318 (50 iterations in 2.043s)
[t-SNE] Iteration 600: error = 1.6986556, gradient norm = 0.0002789 (50 iterations in 2.046s)
[t-SNE] Iteration 650: error = 1.6958396, gradient norm = 0.0001315 (50 iterations in 2.035s)
[t-SNE] Iteration 700: error = 1.6945764, gradient norm = 0.0001563 (50 iterations in 2.043s)
[t-SNE] Iteration 750: error = 1.6924561, gradient norm = 0.0001480 (50 iterations in 2.045s)
[t-SNE] Iteration 800: error = 1.6907563, gradient norm = 0.0001459 (50 iterations in 2.045s)
[t-SNE] Iteration 850: error = 1.6847849, gradient norm = 0.0002842 (50 iterations in 2.030s)
[t-SNE] Iteration 900: error = 1.6797282, gradient norm = 0.0001322 (50 iterations in 2.035s)
[t-SNE] Iteration 950: error = 1.6780571, gradient norm = 0.0001391 (50 iterations in 2.042s)
[t-SNE] Iteration 1000: error = 1.6773311, gradient norm = 0.0001043 (50 iterations in 2.039s)
[t-SNE] KL divergence after 1000 iterations: 1.677331
[t-SNE] Computed conditional probabilities for sample 767 / 767
[t-SNE] Mean sigma: 0.346406
Beginning preprocessing + Leiden
2024-03-12 00:38:31.993968 MEMORY 16.31541248
Affmat transformed
2024-03-12 00:38:32.003885 MEMORY 16.31541248
sources, targets, weights extracted
2024-03-12 00:38:32.009434 MEMORY 16.31541248
About to launch parallel Leiden runs
2024-03-12 00:38:32.026127 MEMORY 16.31541248
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    2.2s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    6.7s finished
Parallel Leiden runs finished
2024-03-12 00:38:38.722815 MEMORY 16.31541248
Quality: 0.3898649288975525
Quality: 0.39025626043210065
Quality: 0.3909876441158132
Quality: 0.3910219545903809
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 749 out of 749 | elapsed:    0.3s finished
Got subclusters: Counter({0: 165, 1: 159, 2: 126, 3: 125, 4: 93, 5: 62, 6: 37})
On pattern 6
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 749 samples in 0.006s...
[t-SNE] Computed neighbors for 749 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 749 / 749
[t-SNE] Mean sigma: 0.307115
[t-SNE] Computed conditional probabilities in 0.052s
[t-SNE] Iteration 50: error = 70.7714539, gradient norm = 0.3606825 (50 iterations in 2.049s)
[t-SNE] Iteration 100: error = 74.3931122, gradient norm = 0.3133245 (50 iterations in 2.056s)
[t-SNE] Iteration 150: error = 73.5587311, gradient norm = 0.3209590 (50 iterations in 2.061s)
[t-SNE] Iteration 200: error = 73.2485428, gradient norm = 0.3426062 (50 iterations in 2.058s)
[t-SNE] Iteration 250: error = 72.7151184, gradient norm = 0.3557311 (50 iterations in 2.036s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 72.715118
[t-SNE] Iteration 300: error = 1.6701022, gradient norm = 0.0035818 (50 iterations in 2.048s)
[t-SNE] Iteration 350: error = 1.6088245, gradient norm = 0.0010850 (50 iterations in 2.047s)
[t-SNE] Iteration 400: error = 1.5733689, gradient norm = 0.0005484 (50 iterations in 2.052s)
[t-SNE] Iteration 450: error = 1.5554142, gradient norm = 0.0005402 (50 iterations in 2.057s)
[t-SNE] Iteration 500: error = 1.5404116, gradient norm = 0.0005118 (50 iterations in 2.058s)
[t-SNE] Iteration 550: error = 1.5283905, gradient norm = 0.0007024 (50 iterations in 2.058s)
[t-SNE] Iteration 600: error = 1.5185908, gradient norm = 0.0003438 (50 iterations in 2.046s)
[t-SNE] Iteration 650: error = 1.5130022, gradient norm = 0.0003430 (50 iterations in 2.061s)
[t-SNE] Iteration 700: error = 1.5110207, gradient norm = 0.0001522 (50 iterations in 2.051s)
[t-SNE] Iteration 750: error = 1.5096401, gradient norm = 0.0001371 (50 iterations in 2.058s)
[t-SNE] Iteration 800: error = 1.5074295, gradient norm = 0.0004402 (50 iterations in 2.040s)
[t-SNE] Iteration 850: error = 1.5070834, gradient norm = 0.0000524 (50 iterations in 2.051s)
[t-SNE] Iteration 900: error = 1.5068181, gradient norm = 0.0001028 (50 iterations in 2.043s)
[t-SNE] Iteration 950: error = 1.5063519, gradient norm = 0.0000825 (50 iterations in 2.044s)
[t-SNE] Iteration 1000: error = 1.5054512, gradient norm = 0.0001693 (50 iterations in 2.038s)
[t-SNE] KL divergence after 1000 iterations: 1.505451
[t-SNE] Computed conditional probabilities for sample 749 / 749
[t-SNE] Mean sigma: 0.307115
Beginning preprocessing + Leiden
2024-03-12 00:39:21.009962 MEMORY 16.31541248
Affmat transformed
2024-03-12 00:39:21.019530 MEMORY 16.31541248
sources, targets, weights extracted
2024-03-12 00:39:21.026724 MEMORY 16.31541248
About to launch parallel Leiden runs
2024-03-12 00:39:21.084934 MEMORY 16.31541248
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.9s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    5.7s finished
Parallel Leiden runs finished
2024-03-12 00:39:26.820725 MEMORY 16.31541248
Quality: 0.37562377904226535
Quality: 0.3760750520471273
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 589 out of 589 | elapsed:    0.2s finished
Got subclusters: Counter({0: 140, 1: 127, 2: 123, 3: 94, 4: 79, 5: 76, 6: 74, 7: 23, 8: 13})
On pattern 7
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 589 samples in 0.005s...
[t-SNE] Computed neighbors for 589 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 589 / 589
[t-SNE] Mean sigma: 0.354683
[t-SNE] Computed conditional probabilities in 0.040s
[t-SNE] Iteration 50: error = 69.3149261, gradient norm = 0.4190226 (50 iterations in 2.033s)
[t-SNE] Iteration 100: error = 71.8667450, gradient norm = 0.3962484 (50 iterations in 2.035s)
[t-SNE] Iteration 150: error = 73.8390656, gradient norm = 0.3847919 (50 iterations in 2.033s)
[t-SNE] Iteration 200: error = 71.3149185, gradient norm = 0.4063810 (50 iterations in 2.041s)
[t-SNE] Iteration 250: error = 70.9456482, gradient norm = 0.4056868 (50 iterations in 2.037s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 70.945648
[t-SNE] Iteration 300: error = 1.5335997, gradient norm = 0.0034508 (50 iterations in 2.028s)
[t-SNE] Iteration 350: error = 1.4854752, gradient norm = 0.0006894 (50 iterations in 2.037s)
[t-SNE] Iteration 400: error = 1.4683836, gradient norm = 0.0007269 (50 iterations in 2.031s)
[t-SNE] Iteration 450: error = 1.4609665, gradient norm = 0.0003032 (50 iterations in 2.041s)
[t-SNE] Iteration 500: error = 1.4524387, gradient norm = 0.0004135 (50 iterations in 2.034s)
[t-SNE] Iteration 550: error = 1.4493580, gradient norm = 0.0001751 (50 iterations in 2.045s)
[t-SNE] Iteration 600: error = 1.4479640, gradient norm = 0.0001185 (50 iterations in 2.034s)
[t-SNE] Iteration 650: error = 1.4472332, gradient norm = 0.0001615 (50 iterations in 2.040s)
[t-SNE] Iteration 700: error = 1.4439237, gradient norm = 0.0001374 (50 iterations in 2.043s)
[t-SNE] Iteration 750: error = 1.4426483, gradient norm = 0.0002126 (50 iterations in 2.031s)
[t-SNE] Iteration 800: error = 1.4416397, gradient norm = 0.0001284 (50 iterations in 2.046s)
[t-SNE] Iteration 850: error = 1.4399873, gradient norm = 0.0001605 (50 iterations in 2.038s)
[t-SNE] Iteration 900: error = 1.4386554, gradient norm = 0.0001989 (50 iterations in 2.030s)
[t-SNE] Iteration 950: error = 1.4382999, gradient norm = 0.0004516 (50 iterations in 2.040s)
[t-SNE] Iteration 1000: error = 1.4355236, gradient norm = 0.0001069 (50 iterations in 2.041s)
[t-SNE] KL divergence after 1000 iterations: 1.435524
[t-SNE] Computed conditional probabilities for sample 589 / 589
[t-SNE] Mean sigma: 0.354683
Beginning preprocessing + Leiden
2024-03-12 00:40:08.562617 MEMORY 16.31541248
Affmat transformed
2024-03-12 00:40:08.570856 MEMORY 16.31541248
sources, targets, weights extracted
2024-03-12 00:40:08.575327 MEMORY 16.31541248
About to launch parallel Leiden runs
2024-03-12 00:40:08.609714 MEMORY 16.31541248
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.6s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    4.9s finished
Parallel Leiden runs finished
2024-03-12 00:40:13.486393 MEMORY 16.31541248
Quality: 0.3899508849033605
Quality: 0.39305343439232804
Quality: 0.3939918209949344
Quality: 0.3939979233533208
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 566 out of 566 | elapsed:    0.2s finished
Got subclusters: Counter({0: 131, 1: 102, 2: 94, 3: 93, 4: 92, 5: 64, 6: 13})
On pattern 8
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 566 samples in 0.006s...
[t-SNE] Computed neighbors for 566 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 566 / 566
[t-SNE] Mean sigma: 0.336577
[t-SNE] Computed conditional probabilities in 0.040s
[t-SNE] Iteration 50: error = 69.1508026, gradient norm = 0.4302884 (50 iterations in 2.034s)
[t-SNE] Iteration 100: error = 71.2662354, gradient norm = 0.4252646 (50 iterations in 2.036s)
[t-SNE] Iteration 150: error = 72.2894516, gradient norm = 0.4046645 (50 iterations in 2.034s)
[t-SNE] Iteration 200: error = 74.3925934, gradient norm = 0.3807195 (50 iterations in 2.036s)
[t-SNE] Iteration 250: error = 75.8846817, gradient norm = 0.3564385 (50 iterations in 2.049s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 75.884682
[t-SNE] Iteration 300: error = 1.6145338, gradient norm = 0.0040963 (50 iterations in 2.043s)
[t-SNE] Iteration 350: error = 1.5100821, gradient norm = 0.0014702 (50 iterations in 2.109s)
[t-SNE] Iteration 400: error = 1.4627520, gradient norm = 0.0011091 (50 iterations in 2.044s)
[t-SNE] Iteration 450: error = 1.4440475, gradient norm = 0.0006285 (50 iterations in 2.061s)
[t-SNE] Iteration 500: error = 1.4326599, gradient norm = 0.0005665 (50 iterations in 2.040s)
[t-SNE] Iteration 550: error = 1.4191948, gradient norm = 0.0003006 (50 iterations in 2.039s)
[t-SNE] Iteration 600: error = 1.4160918, gradient norm = 0.0002786 (50 iterations in 2.052s)
[t-SNE] Iteration 650: error = 1.4077827, gradient norm = 0.0003181 (50 iterations in 2.039s)
[t-SNE] Iteration 700: error = 1.3954188, gradient norm = 0.0007021 (50 iterations in 2.031s)
[t-SNE] Iteration 750: error = 1.3917323, gradient norm = 0.0002038 (50 iterations in 2.029s)
[t-SNE] Iteration 800: error = 1.3897845, gradient norm = 0.0003717 (50 iterations in 2.042s)
[t-SNE] Iteration 850: error = 1.3881992, gradient norm = 0.0001581 (50 iterations in 2.032s)
[t-SNE] Iteration 900: error = 1.3877088, gradient norm = 0.0001038 (50 iterations in 2.043s)
[t-SNE] Iteration 950: error = 1.3859526, gradient norm = 0.0001953 (50 iterations in 2.034s)
[t-SNE] Iteration 1000: error = 1.3829490, gradient norm = 0.0002924 (50 iterations in 2.040s)
[t-SNE] KL divergence after 1000 iterations: 1.382949
[t-SNE] Computed conditional probabilities for sample 566 / 566
[t-SNE] Mean sigma: 0.336577
Beginning preprocessing + Leiden
2024-03-12 00:40:55.334692 MEMORY 16.31541248
Affmat transformed
2024-03-12 00:40:55.343302 MEMORY 16.31541248
sources, targets, weights extracted
2024-03-12 00:40:55.348331 MEMORY 16.31541248
About to launch parallel Leiden runs
2024-03-12 00:40:55.361127 MEMORY 16.31541248
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.5s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    5.1s finished
Parallel Leiden runs finished
2024-03-12 00:41:00.510411 MEMORY 16.31541248
Quality: 0.38681961161737927
Quality: 0.38787469431351707
Quality: 0.38879295019835547
Quality: 0.3889314454786883
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 544 out of 544 | elapsed:    0.2s finished
Got subclusters: Counter({0: 111, 1: 108, 2: 100, 3: 93, 4: 74, 5: 59, 6: 21})
On pattern 9
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 544 samples in 0.005s...
[t-SNE] Computed neighbors for 544 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 544 / 544
[t-SNE] Mean sigma: 0.358329
[t-SNE] Computed conditional probabilities in 0.038s
[t-SNE] Iteration 50: error = 67.0975113, gradient norm = 0.4637960 (50 iterations in 2.040s)
[t-SNE] Iteration 100: error = 66.7142105, gradient norm = 0.4607117 (50 iterations in 2.047s)
[t-SNE] Iteration 150: error = 68.2340622, gradient norm = 0.4428507 (50 iterations in 2.040s)
[t-SNE] Iteration 200: error = 69.7947998, gradient norm = 0.4352088 (50 iterations in 2.030s)
[t-SNE] Iteration 250: error = 69.4310989, gradient norm = 0.4566215 (50 iterations in 2.043s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 69.431099
[t-SNE] Iteration 300: error = 1.4191357, gradient norm = 0.0038631 (50 iterations in 2.076s)
[t-SNE] Iteration 350: error = 1.3699020, gradient norm = 0.0010511 (50 iterations in 2.044s)
[t-SNE] Iteration 400: error = 1.3526053, gradient norm = 0.0005072 (50 iterations in 2.038s)
[t-SNE] Iteration 450: error = 1.3387083, gradient norm = 0.0006235 (50 iterations in 2.038s)
[t-SNE] Iteration 500: error = 1.3344829, gradient norm = 0.0006352 (50 iterations in 2.043s)
[t-SNE] Iteration 550: error = 1.3270245, gradient norm = 0.0002594 (50 iterations in 2.048s)
[t-SNE] Iteration 600: error = 1.3245225, gradient norm = 0.0001998 (50 iterations in 2.091s)
[t-SNE] Iteration 650: error = 1.3196480, gradient norm = 0.0005459 (50 iterations in 2.052s)
[t-SNE] Iteration 700: error = 1.3177727, gradient norm = 0.0003893 (50 iterations in 2.050s)
[t-SNE] Iteration 750: error = 1.3165411, gradient norm = 0.0003715 (50 iterations in 2.039s)
[t-SNE] Iteration 800: error = 1.3164563, gradient norm = 0.0000660 (50 iterations in 2.047s)
[t-SNE] Iteration 850: error = 1.3162796, gradient norm = 0.0000542 (50 iterations in 2.042s)
[t-SNE] Iteration 900: error = 1.3137852, gradient norm = 0.0001464 (50 iterations in 2.060s)
[t-SNE] Iteration 950: error = 1.3134726, gradient norm = 0.0000810 (50 iterations in 2.036s)
[t-SNE] Iteration 1000: error = 1.3130782, gradient norm = 0.0001205 (50 iterations in 2.048s)
[t-SNE] KL divergence after 1000 iterations: 1.313078
[t-SNE] Computed conditional probabilities for sample 544 / 544
[t-SNE] Mean sigma: 0.358329
Beginning preprocessing + Leiden
2024-03-12 00:41:42.464770 MEMORY 16.31541248
Affmat transformed
2024-03-12 00:41:42.473051 MEMORY 16.31541248
sources, targets, weights extracted
2024-03-12 00:41:42.477566 MEMORY 16.31541248
About to launch parallel Leiden runs
2024-03-12 00:41:42.546405 MEMORY 16.31541248
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.5s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    4.3s finished
Parallel Leiden runs finished
2024-03-12 00:41:46.836496 MEMORY 16.31541248
Quality: 0.38588693599629326
Quality: 0.3889770496242127
Quality: 0.38961965202427234
Quality: 0.389970118211584
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 344 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 493 out of 493 | elapsed:    0.3s finished
Got subclusters: Counter({0: 105, 1: 100, 2: 96, 3: 90, 4: 84, 5: 69})
On pattern 10
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 493 samples in 0.004s...
[t-SNE] Computed neighbors for 493 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 493 / 493
[t-SNE] Mean sigma: 0.371596
[t-SNE] Computed conditional probabilities in 0.033s
[t-SNE] Iteration 50: error = 66.1034317, gradient norm = 0.4921237 (50 iterations in 2.042s)
[t-SNE] Iteration 100: error = 68.7261047, gradient norm = 0.4522263 (50 iterations in 2.046s)
[t-SNE] Iteration 150: error = 70.4013367, gradient norm = 0.4376940 (50 iterations in 2.032s)
[t-SNE] Iteration 200: error = 68.4759674, gradient norm = 0.4525918 (50 iterations in 2.032s)
[t-SNE] Iteration 250: error = 70.3079910, gradient norm = 0.4452859 (50 iterations in 2.033s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 70.307991
[t-SNE] Iteration 300: error = 1.4628373, gradient norm = 0.0037480 (50 iterations in 2.045s)
[t-SNE] Iteration 350: error = 1.3951969, gradient norm = 0.0008979 (50 iterations in 2.033s)
[t-SNE] Iteration 400: error = 1.3778987, gradient norm = 0.0007189 (50 iterations in 2.049s)
[t-SNE] Iteration 450: error = 1.3639023, gradient norm = 0.0004659 (50 iterations in 2.030s)
[t-SNE] Iteration 500: error = 1.3600472, gradient norm = 0.0002839 (50 iterations in 2.045s)
[t-SNE] Iteration 550: error = 1.3591242, gradient norm = 0.0001095 (50 iterations in 2.032s)
[t-SNE] Iteration 600: error = 1.3581326, gradient norm = 0.0001639 (50 iterations in 2.039s)
[t-SNE] Iteration 650: error = 1.3499813, gradient norm = 0.0004158 (50 iterations in 2.029s)
[t-SNE] Iteration 700: error = 1.3467922, gradient norm = 0.0002179 (50 iterations in 2.043s)
[t-SNE] Iteration 750: error = 1.3461394, gradient norm = 0.0001495 (50 iterations in 2.029s)
[t-SNE] Iteration 800: error = 1.3448745, gradient norm = 0.0001991 (50 iterations in 2.038s)
[t-SNE] Iteration 850: error = 1.3434323, gradient norm = 0.0003782 (50 iterations in 2.030s)
[t-SNE] Iteration 900: error = 1.3417417, gradient norm = 0.0002344 (50 iterations in 2.042s)
[t-SNE] Iteration 950: error = 1.3370963, gradient norm = 0.0005968 (50 iterations in 2.032s)
[t-SNE] Iteration 1000: error = 1.3341237, gradient norm = 0.0002561 (50 iterations in 2.041s)
[t-SNE] KL divergence after 1000 iterations: 1.334124
[t-SNE] Computed conditional probabilities for sample 493 / 493
[t-SNE] Mean sigma: 0.371596
Beginning preprocessing + Leiden
2024-03-12 00:42:28.523152 MEMORY 16.31541248
Affmat transformed
2024-03-12 00:42:28.531321 MEMORY 16.31541248
sources, targets, weights extracted
2024-03-12 00:42:28.535200 MEMORY 16.31541248
About to launch parallel Leiden runs
2024-03-12 00:42:28.565502 MEMORY 16.31541248
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.3s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    3.9s finished
Parallel Leiden runs finished
2024-03-12 00:42:32.478957 MEMORY 16.31541248
Quality: 0.37985044546998814
Quality: 0.38185859042274267
Quality: 0.38608150771724786
Quality: 0.3864607100739013
Quality: 0.38649712310883827
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 344 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 487 out of 487 | elapsed:    0.3s finished
Got subclusters: Counter({0: 105, 1: 100, 3: 81, 2: 81, 4: 71, 5: 55})
On pattern 11
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 487 samples in 0.004s...
[t-SNE] Computed neighbors for 487 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 487 / 487
[t-SNE] Mean sigma: 0.347091
[t-SNE] Computed conditional probabilities in 0.034s
[t-SNE] Iteration 50: error = 70.9403839, gradient norm = 0.4459924 (50 iterations in 2.038s)
[t-SNE] Iteration 100: error = 74.0385590, gradient norm = 0.4053184 (50 iterations in 2.044s)
[t-SNE] Iteration 150: error = 75.4100800, gradient norm = 0.4157958 (50 iterations in 2.045s)
[t-SNE] Iteration 200: error = 75.4416733, gradient norm = 0.4059978 (50 iterations in 2.052s)
[t-SNE] Iteration 250: error = 72.1760406, gradient norm = 0.4322739 (50 iterations in 2.031s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 72.176041
[t-SNE] Iteration 300: error = 1.4723023, gradient norm = 0.0038670 (50 iterations in 2.028s)
[t-SNE] Iteration 350: error = 1.4013246, gradient norm = 0.0014469 (50 iterations in 2.036s)
[t-SNE] Iteration 400: error = 1.3749682, gradient norm = 0.0008339 (50 iterations in 2.029s)
[t-SNE] Iteration 450: error = 1.3483359, gradient norm = 0.0011363 (50 iterations in 2.030s)
[t-SNE] Iteration 500: error = 1.3301039, gradient norm = 0.0011914 (50 iterations in 2.044s)
[t-SNE] Iteration 550: error = 1.3131729, gradient norm = 0.0005882 (50 iterations in 2.043s)
[t-SNE] Iteration 600: error = 1.3030123, gradient norm = 0.0005542 (50 iterations in 2.033s)
[t-SNE] Iteration 650: error = 1.2990927, gradient norm = 0.0003547 (50 iterations in 2.039s)
[t-SNE] Iteration 700: error = 1.2982643, gradient norm = 0.0001261 (50 iterations in 2.034s)
[t-SNE] Iteration 750: error = 1.2972749, gradient norm = 0.0002338 (50 iterations in 2.042s)
[t-SNE] Iteration 800: error = 1.2962686, gradient norm = 0.0002800 (50 iterations in 2.046s)
[t-SNE] Iteration 850: error = 1.2959932, gradient norm = 0.0000701 (50 iterations in 2.052s)
[t-SNE] Iteration 900: error = 1.2961810, gradient norm = 0.0000793 (50 iterations in 2.037s)
[t-SNE] Iteration 950: error = 1.2962508, gradient norm = 0.0000650 (50 iterations in 2.055s)
[t-SNE] Iteration 1000: error = 1.2963667, gradient norm = 0.0000588 (50 iterations in 2.033s)
[t-SNE] KL divergence after 1000 iterations: 1.296367
[t-SNE] Computed conditional probabilities for sample 487 / 487
[t-SNE] Mean sigma: 0.347091
Beginning preprocessing + Leiden
2024-03-12 00:43:14.218930 MEMORY 16.31541248
Affmat transformed
2024-03-12 00:43:14.226489 MEMORY 16.31541248
sources, targets, weights extracted
2024-03-12 00:43:14.230855 MEMORY 16.31541248
About to launch parallel Leiden runs
2024-03-12 00:43:14.276239 MEMORY 16.31541248
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.5s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    4.3s finished
Parallel Leiden runs finished
2024-03-12 00:43:18.615367 MEMORY 16.31541248
Quality: 0.3516291463377522
Quality: 0.3517756882278632
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 344 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 435 out of 435 | elapsed:    0.2s finished
Got subclusters: Counter({0: 101, 1: 85, 2: 83, 3: 75, 4: 62, 5: 50, 6: 31})
On pattern 12
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 435 samples in 0.004s...
[t-SNE] Computed neighbors for 435 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 435 / 435
[t-SNE] Mean sigma: 0.360840
[t-SNE] Computed conditional probabilities in 0.030s
[t-SNE] Iteration 50: error = 67.9740906, gradient norm = 0.4728995 (50 iterations in 2.031s)
[t-SNE] Iteration 100: error = 68.6009674, gradient norm = 0.4643674 (50 iterations in 2.033s)
[t-SNE] Iteration 150: error = 70.5261688, gradient norm = 0.4455520 (50 iterations in 2.035s)
[t-SNE] Iteration 200: error = 68.2870178, gradient norm = 0.4638076 (50 iterations in 2.045s)
[t-SNE] Iteration 250: error = 71.3794403, gradient norm = 0.4367684 (50 iterations in 2.047s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 71.379440
[t-SNE] Iteration 300: error = 1.3142534, gradient norm = 0.0034504 (50 iterations in 2.048s)
[t-SNE] Iteration 350: error = 1.2634965, gradient norm = 0.0009244 (50 iterations in 2.037s)
[t-SNE] Iteration 400: error = 1.2246020, gradient norm = 0.0013459 (50 iterations in 2.041s)
[t-SNE] Iteration 450: error = 1.1791577, gradient norm = 0.0010655 (50 iterations in 2.035s)
[t-SNE] Iteration 500: error = 1.1559092, gradient norm = 0.0012118 (50 iterations in 2.040s)
[t-SNE] Iteration 550: error = 1.1288720, gradient norm = 0.0015624 (50 iterations in 2.055s)
[t-SNE] Iteration 600: error = 1.1217847, gradient norm = 0.0003336 (50 iterations in 2.033s)
[t-SNE] Iteration 650: error = 1.1148667, gradient norm = 0.0008483 (50 iterations in 2.042s)
[t-SNE] Iteration 700: error = 1.1123487, gradient norm = 0.0002068 (50 iterations in 2.031s)
[t-SNE] Iteration 750: error = 1.1113156, gradient norm = 0.0001831 (50 iterations in 2.052s)
[t-SNE] Iteration 800: error = 1.1104361, gradient norm = 0.0001715 (50 iterations in 2.040s)
[t-SNE] Iteration 850: error = 1.1078130, gradient norm = 0.0004524 (50 iterations in 2.042s)
[t-SNE] Iteration 900: error = 1.1071881, gradient norm = 0.0001158 (50 iterations in 2.040s)
[t-SNE] Iteration 950: error = 1.1070225, gradient norm = 0.0000857 (50 iterations in 2.037s)
[t-SNE] Iteration 1000: error = 1.1066953, gradient norm = 0.0002300 (50 iterations in 2.030s)
[t-SNE] KL divergence after 1000 iterations: 1.106695
[t-SNE] Computed conditional probabilities for sample 435 / 435
[t-SNE] Mean sigma: 0.360840
Beginning preprocessing + Leiden
2024-03-12 00:44:00.218570 MEMORY 16.31541248
Affmat transformed
2024-03-12 00:44:00.224954 MEMORY 16.31541248
sources, targets, weights extracted
2024-03-12 00:44:00.228521 MEMORY 16.31541248
About to launch parallel Leiden runs
2024-03-12 00:44:00.263324 MEMORY 16.31541248
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.5s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    3.8s finished
Parallel Leiden runs finished
2024-03-12 00:44:04.114551 MEMORY 16.31541248
Quality: 0.38087670448084804
Quality: 0.38257931001769846
Quality: 0.3828370867579672
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 344 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 425 out of 425 | elapsed:    0.2s finished
Got subclusters: Counter({0: 81, 1: 75, 2: 70, 3: 56, 5: 50, 4: 50, 6: 49, 7: 2, 8: 2})
On pattern 13
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 425 samples in 0.004s...
[t-SNE] Computed neighbors for 425 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 425 / 425
[t-SNE] Mean sigma: 0.357306
[t-SNE] Computed conditional probabilities in 0.030s
[t-SNE] Iteration 50: error = 67.9535522, gradient norm = 0.4866466 (50 iterations in 2.034s)
[t-SNE] Iteration 100: error = 68.5712738, gradient norm = 0.4780309 (50 iterations in 2.040s)
[t-SNE] Iteration 150: error = 70.2551651, gradient norm = 0.4596646 (50 iterations in 2.031s)
[t-SNE] Iteration 200: error = 71.5626068, gradient norm = 0.4551880 (50 iterations in 2.030s)
[t-SNE] Iteration 250: error = 71.4182892, gradient norm = 0.4552049 (50 iterations in 2.038s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 71.418289
[t-SNE] Iteration 300: error = 1.4447391, gradient norm = 0.0055691 (50 iterations in 2.047s)
[t-SNE] Iteration 350: error = 1.3168186, gradient norm = 0.0029230 (50 iterations in 2.029s)
[t-SNE] Iteration 400: error = 1.2677202, gradient norm = 0.0013207 (50 iterations in 2.041s)
[t-SNE] Iteration 450: error = 1.2226720, gradient norm = 0.0010815 (50 iterations in 2.033s)
[t-SNE] Iteration 500: error = 1.2139552, gradient norm = 0.0004518 (50 iterations in 2.025s)
[t-SNE] Iteration 550: error = 1.2089397, gradient norm = 0.0004028 (50 iterations in 2.031s)
[t-SNE] Iteration 600: error = 1.2026774, gradient norm = 0.0004050 (50 iterations in 1.562s)
[t-SNE] Iteration 650: error = 1.2016411, gradient norm = 0.0001836 (50 iterations in 1.978s)
[t-SNE] Iteration 700: error = 1.2006384, gradient norm = 0.0002861 (50 iterations in 0.961s)
[t-SNE] Iteration 750: error = 1.2002076, gradient norm = 0.0001009 (50 iterations in 0.334s)
[t-SNE] Iteration 800: error = 1.2003591, gradient norm = 0.0000908 (50 iterations in 1.502s)
[t-SNE] Iteration 850: error = 1.2005004, gradient norm = 0.0000574 (50 iterations in 1.435s)
[t-SNE] Iteration 900: error = 1.2004622, gradient norm = 0.0000468 (50 iterations in 1.479s)
[t-SNE] Iteration 950: error = 1.2002524, gradient norm = 0.0000470 (50 iterations in 2.029s)
[t-SNE] Iteration 1000: error = 1.2002891, gradient norm = 0.0000415 (50 iterations in 2.043s)
[t-SNE] KL divergence after 1000 iterations: 1.200289
[t-SNE] Computed conditional probabilities for sample 425 / 425
[t-SNE] Mean sigma: 0.357306
Beginning preprocessing + Leiden
2024-03-12 00:44:40.597564 MEMORY 16.31541248
Affmat transformed
2024-03-12 00:44:40.604492 MEMORY 16.31541248
sources, targets, weights extracted
2024-03-12 00:44:40.607752 MEMORY 16.31541248
About to launch parallel Leiden runs
2024-03-12 00:44:40.621580 MEMORY 16.31541248
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.2s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    3.7s finished
Parallel Leiden runs finished
2024-03-12 00:44:44.322421 MEMORY 16.31541248
Quality: 0.3707795983595502
Quality: 0.3714998859274897
Quality: 0.3715338289490209
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 344 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 417 out of 417 | elapsed:    0.2s finished
Got subclusters: Counter({0: 95, 1: 92, 2: 78, 3: 77, 4: 61, 5: 22})
On pattern 14
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 417 samples in 0.004s...
[t-SNE] Computed neighbors for 417 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 417 / 417
[t-SNE] Mean sigma: 0.373841
[t-SNE] Computed conditional probabilities in 0.029s
[t-SNE] Iteration 50: error = 68.1995468, gradient norm = 0.4676243 (50 iterations in 2.027s)
[t-SNE] Iteration 100: error = 70.0279083, gradient norm = 0.4578210 (50 iterations in 2.025s)
[t-SNE] Iteration 150: error = 68.9697647, gradient norm = 0.4757785 (50 iterations in 2.037s)
[t-SNE] Iteration 200: error = 71.2851181, gradient norm = 0.4594404 (50 iterations in 2.033s)
[t-SNE] Iteration 250: error = 70.1114426, gradient norm = 0.4540035 (50 iterations in 2.034s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 70.111443
[t-SNE] Iteration 300: error = 1.3904999, gradient norm = 0.0042986 (50 iterations in 2.029s)
[t-SNE] Iteration 350: error = 1.3022667, gradient norm = 0.0015388 (50 iterations in 2.033s)
[t-SNE] Iteration 400: error = 1.2747488, gradient norm = 0.0011313 (50 iterations in 2.034s)
[t-SNE] Iteration 450: error = 1.1987395, gradient norm = 0.0012802 (50 iterations in 2.042s)
[t-SNE] Iteration 500: error = 1.1930465, gradient norm = 0.0004780 (50 iterations in 2.031s)
[t-SNE] Iteration 550: error = 1.1826311, gradient norm = 0.0012993 (50 iterations in 2.055s)
[t-SNE] Iteration 600: error = 1.1776836, gradient norm = 0.0003550 (50 iterations in 2.032s)
[t-SNE] Iteration 650: error = 1.1748478, gradient norm = 0.0002357 (50 iterations in 2.042s)
[t-SNE] Iteration 700: error = 1.1716810, gradient norm = 0.0003352 (50 iterations in 2.029s)
[t-SNE] Iteration 750: error = 1.1702645, gradient norm = 0.0002040 (50 iterations in 2.046s)
[t-SNE] Iteration 800: error = 1.1691073, gradient norm = 0.0002143 (50 iterations in 2.033s)
[t-SNE] Iteration 850: error = 1.1676531, gradient norm = 0.0005969 (50 iterations in 2.040s)
[t-SNE] Iteration 900: error = 1.1666741, gradient norm = 0.0000879 (50 iterations in 2.027s)
[t-SNE] Iteration 950: error = 1.1667364, gradient norm = 0.0000548 (50 iterations in 2.033s)
[t-SNE] Iteration 1000: error = 1.1667348, gradient norm = 0.0000335 (50 iterations in 2.029s)
[t-SNE] KL divergence after 1000 iterations: 1.166735
[t-SNE] Computed conditional probabilities for sample 417 / 417
[t-SNE] Mean sigma: 0.373841
Beginning preprocessing + Leiden
2024-03-12 00:45:25.764027 MEMORY 16.314249216
Affmat transformed
2024-03-12 00:45:25.770262 MEMORY 16.31444992
sources, targets, weights extracted
2024-03-12 00:45:25.773472 MEMORY 16.314482688
About to launch parallel Leiden runs
2024-03-12 00:45:25.804621 MEMORY 16.314576896
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.3s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    3.5s finished
Parallel Leiden runs finished
2024-03-12 00:45:29.292153 MEMORY 16.31496192
Quality: 0.37661577220475534
Quality: 0.37865682090359404
Quality: 0.37924488636507897
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 344 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 413 out of 413 | elapsed:    0.2s finished
Got subclusters: Counter({0: 108, 1: 105, 2: 72, 3: 49, 4: 46, 5: 37})
On pattern 15
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 413 samples in 0.004s...
[t-SNE] Computed neighbors for 413 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 413 / 413
[t-SNE] Mean sigma: 0.387857
[t-SNE] Computed conditional probabilities in 0.028s
[t-SNE] Iteration 50: error = 66.6038055, gradient norm = 0.4742268 (50 iterations in 2.026s)
[t-SNE] Iteration 100: error = 69.7854614, gradient norm = 0.4693134 (50 iterations in 1.518s)
[t-SNE] Iteration 150: error = 70.3981476, gradient norm = 0.4531079 (50 iterations in 2.031s)
[t-SNE] Iteration 200: error = 71.4326096, gradient norm = 0.4535087 (50 iterations in 1.466s)
[t-SNE] Iteration 250: error = 69.9176941, gradient norm = 0.4625778 (50 iterations in 1.852s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 69.917694
[t-SNE] Iteration 300: error = 1.2852155, gradient norm = 0.0047240 (50 iterations in 1.745s)
[t-SNE] Iteration 350: error = 1.1694862, gradient norm = 0.0028846 (50 iterations in 2.046s)
[t-SNE] Iteration 400: error = 1.1194546, gradient norm = 0.0012960 (50 iterations in 2.032s)
[t-SNE] Iteration 450: error = 1.0954939, gradient norm = 0.0008655 (50 iterations in 2.037s)
[t-SNE] Iteration 500: error = 1.0822864, gradient norm = 0.0012589 (50 iterations in 2.032s)
[t-SNE] Iteration 550: error = 1.0747088, gradient norm = 0.0004263 (50 iterations in 2.030s)
[t-SNE] Iteration 600: error = 1.0724615, gradient norm = 0.0001349 (50 iterations in 2.042s)
[t-SNE] Iteration 650: error = 1.0713600, gradient norm = 0.0003231 (50 iterations in 1.139s)
[t-SNE] Iteration 700: error = 1.0654824, gradient norm = 0.0004175 (50 iterations in 0.059s)
[t-SNE] Iteration 750: error = 1.0618333, gradient norm = 0.0001952 (50 iterations in 0.237s)
[t-SNE] Iteration 800: error = 1.0589393, gradient norm = 0.0006035 (50 iterations in 0.298s)
[t-SNE] Iteration 850: error = 1.0555798, gradient norm = 0.0002764 (50 iterations in 0.045s)
[t-SNE] Iteration 900: error = 1.0514829, gradient norm = 0.0004314 (50 iterations in 0.048s)
[t-SNE] Iteration 950: error = 1.0473907, gradient norm = 0.0002141 (50 iterations in 0.752s)
[t-SNE] Iteration 1000: error = 1.0467230, gradient norm = 0.0001352 (50 iterations in 0.950s)
[t-SNE] KL divergence after 1000 iterations: 1.046723
[t-SNE] Computed conditional probabilities for sample 413 / 413
[t-SNE] Mean sigma: 0.387857
Beginning preprocessing + Leiden
2024-03-12 00:45:56.407999 MEMORY 16.315383808
Affmat transformed
2024-03-12 00:45:56.415299 MEMORY 16.315383808
sources, targets, weights extracted
2024-03-12 00:45:56.418379 MEMORY 16.315383808
About to launch parallel Leiden runs
2024-03-12 00:45:56.487296 MEMORY 16.315383808
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.1s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    3.3s finished
Parallel Leiden runs finished
2024-03-12 00:45:59.805983 MEMORY 16.315387904
Quality: 0.409721033220166
Quality: 0.4108153633669818
Quality: 0.4109623167976523
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 344 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 401 out of 401 | elapsed:    0.2s finished
Got subclusters: Counter({0: 87, 1: 84, 2: 79, 3: 78, 4: 54, 5: 31})
On pattern 16
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 401 samples in 0.004s...
[t-SNE] Computed neighbors for 401 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 401 / 401
[t-SNE] Mean sigma: 0.376391
[t-SNE] Computed conditional probabilities in 0.027s
[t-SNE] Iteration 50: error = 66.0155869, gradient norm = 0.5012785 (50 iterations in 0.048s)
[t-SNE] Iteration 100: error = 68.2215118, gradient norm = 0.4577133 (50 iterations in 0.045s)
[t-SNE] Iteration 150: error = 69.0377045, gradient norm = 0.4765983 (50 iterations in 0.046s)
[t-SNE] Iteration 200: error = 65.9490433, gradient norm = 0.4923381 (50 iterations in 0.052s)
[t-SNE] Iteration 250: error = 67.4567490, gradient norm = 0.4700870 (50 iterations in 0.045s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 67.456749
[t-SNE] Iteration 300: error = 1.3445213, gradient norm = 0.0034216 (50 iterations in 0.045s)
[t-SNE] Iteration 350: error = 1.2595056, gradient norm = 0.0013389 (50 iterations in 0.045s)
[t-SNE] Iteration 400: error = 1.2296822, gradient norm = 0.0007873 (50 iterations in 0.043s)
[t-SNE] Iteration 450: error = 1.2175440, gradient norm = 0.0004672 (50 iterations in 0.043s)
[t-SNE] Iteration 500: error = 1.2120762, gradient norm = 0.0006848 (50 iterations in 0.043s)
[t-SNE] Iteration 550: error = 1.2046670, gradient norm = 0.0004349 (50 iterations in 0.043s)
[t-SNE] Iteration 600: error = 1.2020626, gradient norm = 0.0004965 (50 iterations in 0.043s)
[t-SNE] Iteration 650: error = 1.2001947, gradient norm = 0.0002982 (50 iterations in 0.044s)
[t-SNE] Iteration 700: error = 1.1927199, gradient norm = 0.0006942 (50 iterations in 0.044s)
[t-SNE] Iteration 750: error = 1.1909013, gradient norm = 0.0004596 (50 iterations in 0.043s)
[t-SNE] Iteration 800: error = 1.1886647, gradient norm = 0.0001550 (50 iterations in 0.043s)
[t-SNE] Iteration 850: error = 1.1875374, gradient norm = 0.0003129 (50 iterations in 0.043s)
[t-SNE] Iteration 900: error = 1.1830851, gradient norm = 0.0003776 (50 iterations in 0.043s)
[t-SNE] Iteration 950: error = 1.1801349, gradient norm = 0.0001074 (50 iterations in 0.045s)
[t-SNE] Iteration 1000: error = 1.1803871, gradient norm = 0.0000410 (50 iterations in 0.046s)
[t-SNE] KL divergence after 1000 iterations: 1.180387
[t-SNE] Computed conditional probabilities for sample 401 / 401
[t-SNE] Mean sigma: 0.376391
Beginning preprocessing + Leiden
2024-03-12 00:46:01.388019 MEMORY 16.315387904
Affmat transformed
2024-03-12 00:46:01.393509 MEMORY 16.315387904
sources, targets, weights extracted
2024-03-12 00:46:01.396399 MEMORY 16.315387904
About to launch parallel Leiden runs
2024-03-12 00:46:01.427636 MEMORY 16.315387904
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.2s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    3.5s finished
Parallel Leiden runs finished
2024-03-12 00:46:04.889807 MEMORY 16.315387904
Quality: 0.371861038390642
Quality: 0.37196555354915384
Quality: 0.37293466260372565
Quality: 0.3729950828629957
Quality: 0.37323042306225046
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 360 out of 360 | elapsed:    0.1s finished
Got subclusters: Counter({0: 81, 1: 78, 2: 64, 3: 51, 4: 47, 5: 32, 6: 30, 7: 18})
On pattern 17
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 360 samples in 0.003s...
[t-SNE] Computed neighbors for 360 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 360 / 360
[t-SNE] Mean sigma: 0.364964
[t-SNE] Computed conditional probabilities in 0.025s
[t-SNE] Iteration 50: error = 66.2779617, gradient norm = 0.4704962 (50 iterations in 0.050s)
[t-SNE] Iteration 100: error = 68.6090546, gradient norm = 0.4599690 (50 iterations in 0.043s)
[t-SNE] Iteration 150: error = 66.6869965, gradient norm = 0.4986165 (50 iterations in 0.045s)
[t-SNE] Iteration 200: error = 68.3277206, gradient norm = 0.4480412 (50 iterations in 0.048s)
[t-SNE] Iteration 250: error = 68.3744583, gradient norm = 0.4702486 (50 iterations in 0.048s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 68.374458
[t-SNE] Iteration 300: error = 1.3061563, gradient norm = 0.0040890 (50 iterations in 0.043s)
[t-SNE] Iteration 350: error = 1.2064677, gradient norm = 0.0021490 (50 iterations in 0.044s)
[t-SNE] Iteration 400: error = 1.1799501, gradient norm = 0.0014898 (50 iterations in 0.046s)
[t-SNE] Iteration 450: error = 1.1720501, gradient norm = 0.0005006 (50 iterations in 0.044s)
[t-SNE] Iteration 500: error = 1.1656144, gradient norm = 0.0004441 (50 iterations in 0.042s)
[t-SNE] Iteration 550: error = 1.1608851, gradient norm = 0.0008483 (50 iterations in 0.042s)
[t-SNE] Iteration 600: error = 1.1538103, gradient norm = 0.0006776 (50 iterations in 0.042s)
[t-SNE] Iteration 650: error = 1.1518886, gradient norm = 0.0003710 (50 iterations in 0.044s)
[t-SNE] Iteration 700: error = 1.1465415, gradient norm = 0.0004094 (50 iterations in 0.044s)
[t-SNE] Iteration 750: error = 1.1437186, gradient norm = 0.0003035 (50 iterations in 0.043s)
[t-SNE] Iteration 800: error = 1.1415156, gradient norm = 0.0001589 (50 iterations in 0.043s)
[t-SNE] Iteration 850: error = 1.1415541, gradient norm = 0.0002087 (50 iterations in 0.042s)
[t-SNE] Iteration 900: error = 1.1408485, gradient norm = 0.0002755 (50 iterations in 0.043s)
[t-SNE] Iteration 950: error = 1.1402187, gradient norm = 0.0001635 (50 iterations in 0.043s)
[t-SNE] Iteration 1000: error = 1.1387269, gradient norm = 0.0002072 (50 iterations in 0.043s)
[t-SNE] KL divergence after 1000 iterations: 1.138727
[t-SNE] Computed conditional probabilities for sample 360 / 360
[t-SNE] Mean sigma: 0.364964
Beginning preprocessing + Leiden
2024-03-12 00:46:06.339652 MEMORY 16.315392
Affmat transformed
2024-03-12 00:46:06.344680 MEMORY 16.315392
sources, targets, weights extracted
2024-03-12 00:46:06.347541 MEMORY 16.315392
About to launch parallel Leiden runs
2024-03-12 00:46:06.380697 MEMORY 16.315392
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.1s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    3.2s finished
Parallel Leiden runs finished
2024-03-12 00:46:09.599451 MEMORY 16.315392
Quality: 0.35959211826150483
Quality: 0.3605995130174238
Quality: 0.3619204665732277
Quality: 0.3632046727693889
Quality: 0.3639258545006759
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 301 out of 301 | elapsed:    0.1s finished
Got subclusters: Counter({0: 71, 1: 63, 2: 51, 3: 46, 5: 38, 4: 38, 6: 28, 7: 25})
On pattern 18
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 301 samples in 0.003s...
[t-SNE] Computed neighbors for 301 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 301 / 301
[t-SNE] Mean sigma: 0.419839
[t-SNE] Computed conditional probabilities in 0.020s
[t-SNE] Iteration 50: error = 61.2132568, gradient norm = 0.5225165 (50 iterations in 0.039s)
[t-SNE] Iteration 100: error = 61.3766708, gradient norm = 0.5049874 (50 iterations in 0.043s)
[t-SNE] Iteration 150: error = 63.2943153, gradient norm = 0.4810139 (50 iterations in 0.040s)
[t-SNE] Iteration 200: error = 62.8797188, gradient norm = 0.4983274 (50 iterations in 0.040s)
[t-SNE] Iteration 250: error = 63.4516296, gradient norm = 0.5026506 (50 iterations in 0.046s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 63.451630
[t-SNE] Iteration 300: error = 0.9424818, gradient norm = 0.0047458 (50 iterations in 0.039s)
[t-SNE] Iteration 350: error = 0.7895846, gradient norm = 0.0029435 (50 iterations in 0.038s)
[t-SNE] Iteration 400: error = 0.7435893, gradient norm = 0.0015152 (50 iterations in 0.039s)
[t-SNE] Iteration 450: error = 0.7228838, gradient norm = 0.0016473 (50 iterations in 0.039s)
[t-SNE] Iteration 500: error = 0.7154378, gradient norm = 0.0001721 (50 iterations in 0.043s)
[t-SNE] Iteration 550: error = 0.7148071, gradient norm = 0.0001283 (50 iterations in 0.040s)
[t-SNE] Iteration 600: error = 0.7148418, gradient norm = 0.0000498 (50 iterations in 0.038s)
[t-SNE] Iteration 650: error = 0.7148430, gradient norm = 0.0000583 (50 iterations in 0.038s)
[t-SNE] Iteration 700: error = 0.7148560, gradient norm = 0.0000269 (50 iterations in 0.040s)
[t-SNE] Iteration 750: error = 0.7148551, gradient norm = 0.0000560 (50 iterations in 0.037s)
[t-SNE] Iteration 800: error = 0.7148489, gradient norm = 0.0000401 (50 iterations in 0.037s)
[t-SNE] Iteration 850: error = 0.7148309, gradient norm = 0.0000369 (50 iterations in 0.037s)
[t-SNE] Iteration 900: error = 0.7148552, gradient norm = 0.0000327 (50 iterations in 0.037s)
[t-SNE] Iteration 900: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 900 iterations: 0.714855
[t-SNE] Computed conditional probabilities for sample 301 / 301
[t-SNE] Mean sigma: 0.419839
Beginning preprocessing + Leiden
2024-03-12 00:46:10.823132 MEMORY 16.315392
Affmat transformed
2024-03-12 00:46:10.827316 MEMORY 16.315392
sources, targets, weights extracted
2024-03-12 00:46:10.829240 MEMORY 16.315392
About to launch parallel Leiden runs
2024-03-12 00:46:10.850278 MEMORY 16.315392
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.9s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.7s finished
Parallel Leiden runs finished
2024-03-12 00:46:13.531620 MEMORY 16.315392
Quality: 0.46226574495604955
Quality: 0.46228409787563907
Quality: 0.46361651393896186
Quality: 0.46366945755621825
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 297 out of 297 | elapsed:    0.1s finished
Got subclusters: Counter({0: 74, 1: 72, 2: 68, 3: 59, 4: 28})
On pattern 19
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 297 samples in 0.003s...
[t-SNE] Computed neighbors for 297 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 297 / 297
[t-SNE] Mean sigma: 0.392357
[t-SNE] Computed conditional probabilities in 0.021s
[t-SNE] Iteration 50: error = 64.8545837, gradient norm = 0.4918805 (50 iterations in 0.570s)
[t-SNE] Iteration 100: error = 66.0958481, gradient norm = 0.5019130 (50 iterations in 0.042s)
[t-SNE] Iteration 150: error = 67.4678726, gradient norm = 0.4871952 (50 iterations in 0.041s)
[t-SNE] Iteration 200: error = 65.4658966, gradient norm = 0.4973574 (50 iterations in 0.042s)
[t-SNE] Iteration 250: error = 64.4378510, gradient norm = 0.4801767 (50 iterations in 0.041s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 64.437851
[t-SNE] Iteration 300: error = 1.0732075, gradient norm = 0.0036313 (50 iterations in 0.039s)
[t-SNE] Iteration 350: error = 0.9504896, gradient norm = 0.0027897 (50 iterations in 0.039s)
[t-SNE] Iteration 400: error = 0.8703001, gradient norm = 0.0023562 (50 iterations in 0.039s)
[t-SNE] Iteration 450: error = 0.8456259, gradient norm = 0.0014101 (50 iterations in 0.039s)
[t-SNE] Iteration 500: error = 0.8365684, gradient norm = 0.0013595 (50 iterations in 0.039s)
[t-SNE] Iteration 550: error = 0.8141590, gradient norm = 0.0003586 (50 iterations in 0.040s)
[t-SNE] Iteration 600: error = 0.8139093, gradient norm = 0.0001478 (50 iterations in 0.039s)
[t-SNE] Iteration 650: error = 0.8139203, gradient norm = 0.0001529 (50 iterations in 0.274s)
[t-SNE] Iteration 700: error = 0.8138394, gradient norm = 0.0001319 (50 iterations in 0.039s)
[t-SNE] Iteration 750: error = 0.8136894, gradient norm = 0.0001029 (50 iterations in 0.039s)
[t-SNE] Iteration 800: error = 0.8137207, gradient norm = 0.0000831 (50 iterations in 0.039s)
[t-SNE] Iteration 850: error = 0.8137792, gradient norm = 0.0000919 (50 iterations in 0.040s)
[t-SNE] Iteration 900: error = 0.8138140, gradient norm = 0.0000717 (50 iterations in 0.039s)
[t-SNE] Iteration 950: error = 0.8138050, gradient norm = 0.0000903 (50 iterations in 0.039s)
[t-SNE] Iteration 1000: error = 0.8138856, gradient norm = 0.0000660 (50 iterations in 0.039s)
[t-SNE] KL divergence after 1000 iterations: 0.813886
[t-SNE] Computed conditional probabilities for sample 297 / 297
[t-SNE] Mean sigma: 0.392357
Beginning preprocessing + Leiden
2024-03-12 00:46:15.600353 MEMORY 16.315392
Affmat transformed
2024-03-12 00:46:15.605328 MEMORY 16.315392
sources, targets, weights extracted
2024-03-12 00:46:15.607635 MEMORY 16.315392
About to launch parallel Leiden runs
2024-03-12 00:46:15.623317 MEMORY 16.315392
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.0s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.8s finished
Parallel Leiden runs finished
2024-03-12 00:46:18.451223 MEMORY 16.315363328
Quality: 0.37613616304503944
Quality: 0.37658126217696525
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 281 out of 281 | elapsed:    0.1s finished
Got subclusters: Counter({0: 76, 1: 53, 2: 49, 3: 42, 4: 42, 5: 22, 6: 13})
On pattern 20
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 281 samples in 0.003s...
[t-SNE] Computed neighbors for 281 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 281 / 281
[t-SNE] Mean sigma: 0.383472
[t-SNE] Computed conditional probabilities in 0.020s
[t-SNE] Iteration 50: error = 62.7567482, gradient norm = 0.5290037 (50 iterations in 0.262s)
[t-SNE] Iteration 100: error = 63.3669968, gradient norm = 0.4967663 (50 iterations in 0.039s)
[t-SNE] Iteration 150: error = 64.9171295, gradient norm = 0.4838929 (50 iterations in 0.038s)
[t-SNE] Iteration 200: error = 65.1904373, gradient norm = 0.4867971 (50 iterations in 0.038s)
[t-SNE] Iteration 250: error = 63.9911804, gradient norm = 0.4991737 (50 iterations in 0.471s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 63.991180
[t-SNE] Iteration 300: error = 1.0339099, gradient norm = 0.0041227 (50 iterations in 0.252s)
[t-SNE] Iteration 350: error = 0.9575059, gradient norm = 0.0015790 (50 iterations in 0.038s)
[t-SNE] Iteration 400: error = 0.9116886, gradient norm = 0.0015897 (50 iterations in 0.038s)
[t-SNE] Iteration 450: error = 0.8880733, gradient norm = 0.0010272 (50 iterations in 0.038s)
[t-SNE] Iteration 500: error = 0.8802119, gradient norm = 0.0003634 (50 iterations in 0.038s)
[t-SNE] Iteration 550: error = 0.8640710, gradient norm = 0.0004085 (50 iterations in 0.039s)
[t-SNE] Iteration 600: error = 0.8555644, gradient norm = 0.0002486 (50 iterations in 0.553s)
[t-SNE] Iteration 650: error = 0.8548852, gradient norm = 0.0002516 (50 iterations in 0.132s)
[t-SNE] Iteration 700: error = 0.8548991, gradient norm = 0.0001009 (50 iterations in 0.705s)
[t-SNE] Iteration 750: error = 0.8545522, gradient norm = 0.0003612 (50 iterations in 0.038s)
[t-SNE] Iteration 800: error = 0.8546082, gradient norm = 0.0001983 (50 iterations in 0.038s)
[t-SNE] Iteration 850: error = 0.8545353, gradient norm = 0.0001856 (50 iterations in 0.039s)
[t-SNE] Iteration 900: error = 0.8542594, gradient norm = 0.0001368 (50 iterations in 0.039s)
[t-SNE] Iteration 950: error = 0.8545714, gradient norm = 0.0001603 (50 iterations in 0.039s)
[t-SNE] Iteration 1000: error = 0.8542952, gradient norm = 0.0001093 (50 iterations in 0.037s)
[t-SNE] KL divergence after 1000 iterations: 0.854295
[t-SNE] Computed conditional probabilities for sample 281 / 281
[t-SNE] Mean sigma: 0.383472
Beginning preprocessing + Leiden
2024-03-12 00:46:21.836786 MEMORY 16.315392
Affmat transformed
2024-03-12 00:46:21.841339 MEMORY 16.315392
sources, targets, weights extracted
2024-03-12 00:46:21.843262 MEMORY 16.315392
About to launch parallel Leiden runs
2024-03-12 00:46:21.876825 MEMORY 16.315392
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.9s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.7s finished
Parallel Leiden runs finished
2024-03-12 00:46:24.548133 MEMORY 16.315392
Quality: 0.379803200045604
Quality: 0.37992465902632044
Quality: 0.38067840112272805
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 226 out of 226 | elapsed:    0.1s finished
Got subclusters: Counter({0: 70, 1: 65, 2: 48, 3: 28, 4: 27, 5: 23, 6: 20})
On pattern 21
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 226 samples in 0.002s...
[t-SNE] Computed neighbors for 226 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 226 / 226
[t-SNE] Mean sigma: 0.392498
[t-SNE] Computed conditional probabilities in 0.016s
[t-SNE] Iteration 50: error = 60.3600273, gradient norm = 0.5511571 (50 iterations in 0.050s)
[t-SNE] Iteration 100: error = 65.8866425, gradient norm = 0.4652956 (50 iterations in 0.033s)
[t-SNE] Iteration 150: error = 62.4616966, gradient norm = 0.4813801 (50 iterations in 0.034s)
[t-SNE] Iteration 200: error = 60.9211655, gradient norm = 0.4868348 (50 iterations in 0.033s)
[t-SNE] Iteration 250: error = 66.5064316, gradient norm = 0.4706263 (50 iterations in 0.036s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 66.506432
[t-SNE] Iteration 300: error = 1.1828694, gradient norm = 0.0055418 (50 iterations in 0.032s)
[t-SNE] Iteration 350: error = 0.8448957, gradient norm = 0.0075268 (50 iterations in 0.033s)
[t-SNE] Iteration 400: error = 0.7330045, gradient norm = 0.0026524 (50 iterations in 0.033s)
[t-SNE] Iteration 450: error = 0.7090353, gradient norm = 0.0003485 (50 iterations in 0.036s)
[t-SNE] Iteration 500: error = 0.7087615, gradient norm = 0.0002373 (50 iterations in 0.033s)
[t-SNE] Iteration 550: error = 0.7087880, gradient norm = 0.0001594 (50 iterations in 0.033s)
[t-SNE] Iteration 600: error = 0.7087745, gradient norm = 0.0001226 (50 iterations in 0.033s)
[t-SNE] Iteration 650: error = 0.7087358, gradient norm = 0.0001094 (50 iterations in 0.034s)
[t-SNE] Iteration 700: error = 0.7085868, gradient norm = 0.0001928 (50 iterations in 0.033s)
[t-SNE] Iteration 750: error = 0.7085506, gradient norm = 0.0001347 (50 iterations in 0.033s)
[t-SNE] Iteration 800: error = 0.7085029, gradient norm = 0.0001613 (50 iterations in 0.034s)
[t-SNE] Iteration 850: error = 0.7085120, gradient norm = 0.0001208 (50 iterations in 0.033s)
[t-SNE] Iteration 900: error = 0.7085521, gradient norm = 0.0001178 (50 iterations in 0.036s)
[t-SNE] Iteration 950: error = 0.7085596, gradient norm = 0.0001379 (50 iterations in 0.033s)
[t-SNE] Iteration 1000: error = 0.7085404, gradient norm = 0.0001633 (50 iterations in 0.034s)
[t-SNE] KL divergence after 1000 iterations: 0.708540
[t-SNE] Computed conditional probabilities for sample 226 / 226
[t-SNE] Mean sigma: 0.392498
Beginning preprocessing + Leiden
2024-03-12 00:46:25.648014 MEMORY 16.315392
Affmat transformed
2024-03-12 00:46:25.651815 MEMORY 16.315392
sources, targets, weights extracted
2024-03-12 00:46:25.653686 MEMORY 16.315392
About to launch parallel Leiden runs
2024-03-12 00:46:25.670268 MEMORY 16.315392
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.9s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.8s finished
Parallel Leiden runs finished
2024-03-12 00:46:28.480910 MEMORY 16.313266176
Quality: 0.31135140313023135
Quality: 0.31186429890870915
Quality: 0.31302466861350237
Quality: 0.31340503857994667
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 217 out of 217 | elapsed:    0.1s finished
Got subclusters: Counter({0: 49, 1: 42, 2: 35, 3: 34, 4: 33, 5: 33})
On pattern 22
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 217 samples in 0.002s...
[t-SNE] Computed neighbors for 217 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 217 / 217
[t-SNE] Mean sigma: 0.407874
[t-SNE] Computed conditional probabilities in 0.015s
[t-SNE] Iteration 50: error = 64.4741669, gradient norm = 0.4462030 (50 iterations in 0.599s)
[t-SNE] Iteration 100: error = 64.0572128, gradient norm = 0.4759576 (50 iterations in 0.032s)
[t-SNE] Iteration 150: error = 62.7514038, gradient norm = 0.5178311 (50 iterations in 0.032s)
[t-SNE] Iteration 200: error = 61.5292778, gradient norm = 0.5200521 (50 iterations in 0.032s)
[t-SNE] Iteration 250: error = 62.2234535, gradient norm = 0.4755625 (50 iterations in 0.032s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 62.223454
[t-SNE] Iteration 300: error = 1.0294620, gradient norm = 0.0078447 (50 iterations in 0.031s)
[t-SNE] Iteration 350: error = 0.8603676, gradient norm = 0.0063663 (50 iterations in 0.034s)
[t-SNE] Iteration 400: error = 0.7970413, gradient norm = 0.0009535 (50 iterations in 0.032s)
[t-SNE] Iteration 450: error = 0.7913486, gradient norm = 0.0005452 (50 iterations in 0.031s)
[t-SNE] Iteration 500: error = 0.7836036, gradient norm = 0.0003117 (50 iterations in 0.032s)
[t-SNE] Iteration 550: error = 0.7833677, gradient norm = 0.0001723 (50 iterations in 0.034s)
[t-SNE] Iteration 600: error = 0.7835010, gradient norm = 0.0001250 (50 iterations in 0.033s)
[t-SNE] Iteration 650: error = 0.7835031, gradient norm = 0.0000706 (50 iterations in 0.034s)
[t-SNE] Iteration 700: error = 0.7834693, gradient norm = 0.0000961 (50 iterations in 0.036s)
[t-SNE] Iteration 750: error = 0.7834777, gradient norm = 0.0000710 (50 iterations in 0.033s)
[t-SNE] Iteration 800: error = 0.7834541, gradient norm = 0.0000866 (50 iterations in 0.032s)
[t-SNE] Iteration 850: error = 0.7834559, gradient norm = 0.0000936 (50 iterations in 0.032s)
[t-SNE] Iteration 900: error = 0.7834814, gradient norm = 0.0000855 (50 iterations in 0.032s)
[t-SNE] Iteration 900: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 900 iterations: 0.783481
[t-SNE] Computed conditional probabilities for sample 217 / 217
[t-SNE] Mean sigma: 0.407874
Beginning preprocessing + Leiden
2024-03-12 00:46:30.041121 MEMORY 16.315232256
Affmat transformed
2024-03-12 00:46:30.044514 MEMORY 16.315240448
sources, targets, weights extracted
2024-03-12 00:46:30.045945 MEMORY 16.31524864
About to launch parallel Leiden runs
2024-03-12 00:46:30.078383 MEMORY 16.315265024
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.8s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.4s finished
Parallel Leiden runs finished
2024-03-12 00:46:32.473620 MEMORY 16.315265024
Quality: 0.326171290312884
Quality: 0.3262256314670882
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 207 out of 207 | elapsed:    0.1s finished
Got subclusters: Counter({0: 40, 2: 39, 1: 39, 3: 26, 4: 24, 5: 18, 6: 17, 7: 14})
On pattern 23
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 207 samples in 0.002s...
[t-SNE] Computed neighbors for 207 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 207 / 207
[t-SNE] Mean sigma: 0.416533
[t-SNE] Computed conditional probabilities in 0.015s
[t-SNE] Iteration 50: error = 61.2916336, gradient norm = 0.4601331 (50 iterations in 0.032s)
[t-SNE] Iteration 100: error = 63.0656586, gradient norm = 0.4535414 (50 iterations in 0.030s)
[t-SNE] Iteration 150: error = 60.4528999, gradient norm = 0.5134609 (50 iterations in 0.030s)
[t-SNE] Iteration 200: error = 61.1381836, gradient norm = 0.4726141 (50 iterations in 0.035s)
[t-SNE] Iteration 250: error = 62.0677605, gradient norm = 0.5250195 (50 iterations in 0.032s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 62.067760
[t-SNE] Iteration 300: error = 0.9691275, gradient norm = 0.0055807 (50 iterations in 0.034s)
[t-SNE] Iteration 350: error = 0.7288951, gradient norm = 0.0050088 (50 iterations in 0.035s)
[t-SNE] Iteration 400: error = 0.7117246, gradient norm = 0.0011040 (50 iterations in 0.033s)
[t-SNE] Iteration 450: error = 0.6919193, gradient norm = 0.0005813 (50 iterations in 0.032s)
[t-SNE] Iteration 500: error = 0.6918597, gradient norm = 0.0002451 (50 iterations in 0.032s)
[t-SNE] Iteration 550: error = 0.6918402, gradient norm = 0.0002052 (50 iterations in 0.031s)
[t-SNE] Iteration 600: error = 0.6912540, gradient norm = 0.0002148 (50 iterations in 0.031s)
[t-SNE] Iteration 650: error = 0.6914055, gradient norm = 0.0001946 (50 iterations in 0.031s)
[t-SNE] Iteration 700: error = 0.6917183, gradient norm = 0.0001964 (50 iterations in 0.031s)
[t-SNE] Iteration 750: error = 0.6917419, gradient norm = 0.0001200 (50 iterations in 0.030s)
[t-SNE] Iteration 800: error = 0.6918138, gradient norm = 0.0002179 (50 iterations in 0.032s)
[t-SNE] Iteration 850: error = 0.6918420, gradient norm = 0.0002227 (50 iterations in 0.030s)
[t-SNE] Iteration 900: error = 0.6923488, gradient norm = 0.0001567 (50 iterations in 0.030s)
[t-SNE] Iteration 950: error = 0.6923559, gradient norm = 0.0001459 (50 iterations in 0.030s)
[t-SNE] Iteration 950: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 950 iterations: 0.692356
[t-SNE] Computed conditional probabilities for sample 207 / 207
[t-SNE] Mean sigma: 0.416533
Beginning preprocessing + Leiden
2024-03-12 00:46:33.439644 MEMORY 16.31535104
Affmat transformed
2024-03-12 00:46:33.442987 MEMORY 16.31535104
sources, targets, weights extracted
2024-03-12 00:46:33.444246 MEMORY 16.31535104
About to launch parallel Leiden runs
2024-03-12 00:46:33.458639 MEMORY 16.31535104
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.8s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.4s finished
Parallel Leiden runs finished
2024-03-12 00:46:35.834353 MEMORY 16.31535104
Quality: 0.3352966167536322
Quality: 0.33735710719163325
Quality: 0.3376072311465405
Got subclusters: Counter({0: 63, 1: 49, 2: 43, 3: 24, 4: 17, 5: 11})
On metacluster 0
Metacluster size 86697 limited to 20000
Relevant tasks:  ('head', 'testis')
Relevant signs:  (-1, -1)
TfModiscoSeqletsToPatternsFactory: seed=1234
(Round 1) num seqlets: 20000
(Round 1) Computing coarse affmat
2024-03-12 00:46:39.651097 MEMORY 16.313798656
Beginning embedding computation
MEMORY 16.313798656
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 152 tasks      | elapsed:    2.0s
[Parallel(n_jobs=24)]: Done 402 tasks      | elapsed:    4.9s
[Parallel(n_jobs=24)]: Done 752 tasks      | elapsed:    8.8s
[Parallel(n_jobs=24)]: Done 1202 tasks      | elapsed:   13.8s
[Parallel(n_jobs=24)]: Done 1752 tasks      | elapsed:   20.0s
[Parallel(n_jobs=24)]: Done 2402 tasks      | elapsed:   27.2s
[Parallel(n_jobs=24)]: Done 3152 tasks      | elapsed:   35.4s
[Parallel(n_jobs=24)]: Done 4002 tasks      | elapsed:   45.0s
[Parallel(n_jobs=24)]: Done 4952 tasks      | elapsed:   55.4s
[Parallel(n_jobs=24)]: Done 6002 tasks      | elapsed:  1.1min
[Parallel(n_jobs=24)]: Done 7152 tasks      | elapsed:  1.3min
[Parallel(n_jobs=24)]: Done 8402 tasks      | elapsed:  1.6min
[Parallel(n_jobs=24)]: Done 9752 tasks      | elapsed:  1.8min
[Parallel(n_jobs=24)]: Done 11202 tasks      | elapsed:  2.1min
[Parallel(n_jobs=24)]: Done 12752 tasks      | elapsed:  2.3min
[Parallel(n_jobs=24)]: Done 14402 tasks      | elapsed:  2.6min
[Parallel(n_jobs=24)]: Done 16152 tasks      | elapsed:  3.0min
[Parallel(n_jobs=24)]: Done 18002 tasks      | elapsed:  3.3min
[Parallel(n_jobs=24)]: Done 19952 tasks      | elapsed:  3.7min
[Parallel(n_jobs=24)]: Done 20000 out of 20000 | elapsed:  3.7min finished
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 152 tasks      | elapsed:    1.9s
[Parallel(n_jobs=24)]: Done 402 tasks      | elapsed:    4.6s
[Parallel(n_jobs=24)]: Done 752 tasks      | elapsed:    8.5s
[Parallel(n_jobs=24)]: Done 1202 tasks      | elapsed:   13.5s
[Parallel(n_jobs=24)]: Done 1752 tasks      | elapsed:   19.6s
[Parallel(n_jobs=24)]: Done 2402 tasks      | elapsed:   26.8s
[Parallel(n_jobs=24)]: Done 3152 tasks      | elapsed:   35.1s
[Parallel(n_jobs=24)]: Done 4002 tasks      | elapsed:   44.3s
[Parallel(n_jobs=24)]: Done 4952 tasks      | elapsed:   54.6s
[Parallel(n_jobs=24)]: Done 6002 tasks      | elapsed:  1.1min
[Parallel(n_jobs=24)]: Done 7152 tasks      | elapsed:  1.3min
[Parallel(n_jobs=24)]: Done 8402 tasks      | elapsed:  1.5min
[Parallel(n_jobs=24)]: Done 9752 tasks      | elapsed:  1.8min
[Parallel(n_jobs=24)]: Done 11202 tasks      | elapsed:  2.1min
[Parallel(n_jobs=24)]: Done 12752 tasks      | elapsed:  2.3min
[Parallel(n_jobs=24)]: Done 14402 tasks      | elapsed:  2.6min
[Parallel(n_jobs=24)]: Done 16152 tasks      | elapsed:  3.0min
[Parallel(n_jobs=24)]: Done 18002 tasks      | elapsed:  3.3min
[Parallel(n_jobs=24)]: Done 19952 tasks      | elapsed:  3.7min
[Parallel(n_jobs=24)]: Done 20000 out of 20000 | elapsed:  3.7min finished
At the beginning of embedding call
2024-03-12 00:46:39.651390 MEMORY 16.313798656
before computing embeddings fwd
2024-03-12 00:46:39.661907 MEMORY 16.313802752
after computing embeddings fwd
2024-03-12 00:50:19.739354 MEMORY 16.3113984
after computing embeddings rev
2024-03-12 00:53:59.431592 MEMORY 16.959451136
before computing sparse embeddings fwd
2024-03-12 00:53:59.432362 MEMORY 16.959451136
Constructing csr matrix...
csr matrix made in 2.5778870582580566 s
after computing sparse embeddings fwd
2024-03-12 00:54:02.940726 MEMORY 17.080266752
before computing sparse embeddings rev
2024-03-12 00:54:02.941451 MEMORY 17.080266752
Constructing csr matrix...
csr matrix made in 2.599972724914551 s
after computing sparse embeddings rev
2024-03-12 00:54:06.527180 MEMORY 17.200533504
Finished embedding computation in 449.68 s
MEMORY 16.666816512
Starting affinity matrix computations
MEMORY 16.666816512
Batching in slices of size 3355
  0%|          | 0/6 [00:00<?, ?it/s] 17%|â–ˆâ–‹        | 1/6 [00:09<00:46,  9.26s/it] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 2/6 [00:18<00:36,  9.16s/it] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 3/6 [00:27<00:27,  9.11s/it] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 4/6 [00:36<00:18,  9.08s/it] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 5/6 [00:45<00:09,  9.06s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:54<00:00,  8.99s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:54<00:00,  9.05s/it]
Finished affinity matrix computations in 54.44 s
MEMORY 16.667144192
(Round 1) Computed coarse affmat
2024-03-12 00:55:05.428390 MEMORY 16.426610688
(Round 1) Computing affinity matrix on nearest neighbors
2024-03-12 00:55:05.428557 MEMORY 16.426610688
Launching nearest neighbors affmat calculation job
MEMORY 16.426713088
Parallel runs completed
MEMORY 16.450789376
Job completed in: 71.16 s
MEMORY 16.450666496
Launching nearest neighbors affmat calculation job
MEMORY 16.448249856
Parallel runs completed
MEMORY 16.500404224
Job completed in: 71.29 s
MEMORY 16.500228096
(Round 1) Computed affinity matrix on nearest neighbors in 149.35 s
2024-03-12 00:57:34.786147 MEMORY 16.498266112
Filtered down to 18875 of 20000
(Round 1) Retained 18875 rows out of 20000 after filtering
2024-03-12 00:57:45.799277 MEMORY 16.498589696
(Round 1) Computing density adapted affmat
2024-03-12 00:57:52.233700 MEMORY 16.498597888
Symmetrizing nearest neighbors
Computing betas for density adaptation
Computing normalizing denominators
(Round 1) Computing clustering
2024-03-12 01:00:57.405093 MEMORY 16.371367936
Beginning preprocessing + Leiden
2024-03-12 01:00:57.431427 MEMORY 16.371367936
Affmat transformed
2024-03-12 01:00:57.431563 MEMORY 16.371367936
sources, targets, weights extracted
2024-03-12 01:00:58.137993 MEMORY 16.42590208
About to launch parallel Leiden runs
2024-03-12 01:00:58.355449 MEMORY 16.371388416
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:  1.8min
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:  6.2min finished
Parallel Leiden runs finished
2024-03-12 01:07:10.345923 MEMORY 16.371388416
Quality: 0.4505257634446511
Quality: 0.4525677481211547
Quality: 0.45334607530380544
Quality: 0.45334756503652335
Quality: 0.4542684016892651
Quality: 0.45426855209207834
Quality: 0.4542686382859818
Quality: 0.45430546431845475
Quality: 0.45430664099509566
Got 5 clusters after round 1
Counts:
{0: 7042, 1: 4750, 2: 4487, 3: 1795, 4: 801}
2024-03-12 01:07:10.410201 MEMORY 16.371388416
(Round 1) Aggregating seqlets in each cluster
2024-03-12 01:07:10.410305 MEMORY 16.371388416
Aggregating for cluster 0 with 7042 seqlets
2024-03-12 01:07:10.422989 MEMORY 16.371396608
Skipped 16 due to duplicates
Trimming eliminated 0 seqlets out of 7026
Aggregating for cluster 1 with 4750 seqlets
2024-03-12 01:07:28.431078 MEMORY 16.371412992
Skipped 4 due to duplicates
Trimming eliminated 0 seqlets out of 4746
Aggregating for cluster 2 with 4487 seqlets
2024-03-12 01:07:39.003974 MEMORY 16.371412992
Skipped 14 due to duplicates
Trimming eliminated 0 seqlets out of 4473
Aggregating for cluster 3 with 1795 seqlets
2024-03-12 01:07:50.700126 MEMORY 16.371412992
Skipped 1 due to duplicates
Trimming eliminated 0 seqlets out of 1794
Aggregating for cluster 4 with 801 seqlets
2024-03-12 01:07:54.731930 MEMORY 16.371412992
Skipped 1 due to duplicates
Trimming eliminated 0 seqlets out of 800
(Round 2) num seqlets: 18824
(Round 2) Computing coarse affmat
2024-03-12 01:07:58.320164 MEMORY 16.371412992
Beginning embedding computation
MEMORY 16.371412992
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 320 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done 3744 tasks      | elapsed:    3.7s
[Parallel(n_jobs=24)]: Done 9344 tasks      | elapsed:    8.5s
[Parallel(n_jobs=24)]: Done 16544 tasks      | elapsed:   14.9s
[Parallel(n_jobs=24)]: Done 18824 out of 18824 | elapsed:   16.7s finished
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 368 tasks      | elapsed:    0.8s
[Parallel(n_jobs=24)]: Done 1368 tasks      | elapsed:    2.2s
[Parallel(n_jobs=24)]: Done 2768 tasks      | elapsed:    4.2s
[Parallel(n_jobs=24)]: Done 4568 tasks      | elapsed:    6.7s
[Parallel(n_jobs=24)]: Done 6768 tasks      | elapsed:    9.7s
[Parallel(n_jobs=24)]: Done 9368 tasks      | elapsed:   13.4s
[Parallel(n_jobs=24)]: Done 12368 tasks      | elapsed:   17.6s
[Parallel(n_jobs=24)]: Done 15768 tasks      | elapsed:   22.2s
[Parallel(n_jobs=24)]: Done 18824 out of 18824 | elapsed:   26.3s finished
At the beginning of embedding call
2024-03-12 01:07:58.320368 MEMORY 16.371412992
before computing embeddings fwd
2024-03-12 01:07:58.328918 MEMORY 16.371412992
after computing embeddings fwd
2024-03-12 01:08:15.082572 MEMORY 16.7231488
after computing embeddings rev
2024-03-12 01:08:41.412951 MEMORY 17.494122496
before computing sparse embeddings fwd
2024-03-12 01:08:41.413047 MEMORY 17.494122496
Constructing csr matrix...
csr matrix made in 2.1931684017181396 s
after computing sparse embeddings fwd
2024-03-12 01:08:44.315092 MEMORY 17.606807552
before computing sparse embeddings rev
2024-03-12 01:08:44.315175 MEMORY 17.606807552
Constructing csr matrix...
csr matrix made in 2.121596097946167 s
after computing sparse embeddings rev
2024-03-12 01:08:47.127678 MEMORY 17.719513088
Finished embedding computation in 51.7 s
MEMORY 16.927318016
Starting affinity matrix computations
MEMORY 16.926793728
Batching in slices of size 3565
  0%|          | 0/6 [00:00<?, ?it/s] 17%|â–ˆâ–‹        | 1/6 [00:10<00:54, 10.95s/it] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 2/6 [00:21<00:43, 10.82s/it] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 3/6 [00:32<00:32, 10.96s/it] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 4/6 [00:43<00:21, 10.77s/it] 83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž | 5/6 [00:52<00:10, 10.31s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:56<00:00,  8.09s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 6/6 [00:56<00:00,  9.43s/it]
Finished affinity matrix computations in 56.65 s
MEMORY 16.926912512
(Round 2) Computed coarse affmat
2024-03-12 01:09:48.562742 MEMORY 16.701595648
(Round 2) Computing affinity matrix on nearest neighbors
2024-03-12 01:09:48.562910 MEMORY 16.701595648
Launching nearest neighbors affmat calculation job
MEMORY 16.701333504
Parallel runs completed
MEMORY 16.73207808
Job completed in: 34.3 s
MEMORY 16.731930624
Launching nearest neighbors affmat calculation job
MEMORY 16.731836416
Parallel runs completed
MEMORY 16.771047424
Job completed in: 33.33 s
MEMORY 16.770875392
(Round 2) Computed affinity matrix on nearest neighbors in 73.15 s
2024-03-12 01:11:01.724287 MEMORY 16.770727936
Not applying filtering for rounds above first round
2024-03-12 01:11:01.726888 MEMORY 16.770727936
(Round 2) Computing density adapted affmat
2024-03-12 01:11:07.175026 MEMORY 16.947126272
Symmetrizing nearest neighbors
Computing betas for density adaptation
Computing normalizing denominators
(Round 2) Computing clustering
2024-03-12 01:13:52.200235 MEMORY 16.96772096
Beginning preprocessing + Leiden
2024-03-12 01:13:52.227076 MEMORY 16.96772096
Affmat transformed
2024-03-12 01:13:52.227224 MEMORY 16.96772096
sources, targets, weights extracted
2024-03-12 01:13:53.002610 MEMORY 17.18726656
About to launch parallel Leiden runs
2024-03-12 01:13:53.316464 MEMORY 16.967540736
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:  1.7min
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:  5.4min finished
Parallel Leiden runs finished
2024-03-12 01:19:20.010954 MEMORY 16.967544832
Quality: 0.5610668453919884
Quality: 0.5615856562682248
Quality: 0.5628142386109064
Quality: 0.5628147710549013
Got 7 clusters after round 2
Counts:
{3: 2467, 4: 2200, 1: 4093, 5: 1884, 2: 3093, 0: 4343, 6: 744}
2024-03-12 01:19:20.061685 MEMORY 16.802840576
(Round 2) Aggregating seqlets in each cluster
2024-03-12 01:19:20.061789 MEMORY 16.802840576
Aggregating for cluster 0 with 4343 seqlets
2024-03-12 01:19:20.069275 MEMORY 16.802840576
Skipped 8 due to duplicates
Trimming eliminated 0 seqlets out of 4335
Aggregating for cluster 1 with 4093 seqlets
2024-03-12 01:19:27.401801 MEMORY 16.803024896
Skipped 1 due to duplicates
Trimming eliminated 0 seqlets out of 4092
Aggregating for cluster 2 with 3093 seqlets
2024-03-12 01:19:36.348611 MEMORY 16.803090432
Skipped 3 due to duplicates
Trimming eliminated 0 seqlets out of 3090
Aggregating for cluster 3 with 2467 seqlets
2024-03-12 01:19:41.582581 MEMORY 16.803090432
Skipped 3 due to duplicates
Trimming eliminated 0 seqlets out of 2464
Aggregating for cluster 4 with 2200 seqlets
2024-03-12 01:19:45.703537 MEMORY 16.803090432
Skipped 1 due to duplicates
Trimming eliminated 0 seqlets out of 2199
Aggregating for cluster 5 with 1884 seqlets
2024-03-12 01:19:49.463359 MEMORY 16.803090432
Skipped 1 due to duplicates
Trimming eliminated 0 seqlets out of 1883
Aggregating for cluster 6 with 744 seqlets
2024-03-12 01:19:54.325630 MEMORY 16.803090432
Skipped 2 due to duplicates
Trimming eliminated 0 seqlets out of 742
Got 7 clusters
Splitting into subclusters...
2024-03-12 01:19:55.579003 MEMORY 16.803090432
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.4s
[Parallel(n_jobs=24)]: Done 3915 tasks      | elapsed:    2.8s
[Parallel(n_jobs=24)]: Done 4335 out of 4335 | elapsed:    3.0s finished
Inspecting pattern 0 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 4335
[t-SNE] Computed conditional probabilities for sample 2000 / 4335
[t-SNE] Computed conditional probabilities for sample 3000 / 4335
[t-SNE] Computed conditional probabilities for sample 4000 / 4335
[t-SNE] Computed conditional probabilities for sample 4335 / 4335
[t-SNE] Mean sigma: 0.310918
Beginning preprocessing + Leiden
2024-03-12 01:20:03.107878 MEMORY 16.823734272
Affmat transformed
2024-03-12 01:20:03.160283 MEMORY 16.832991232
sources, targets, weights extracted
2024-03-12 01:20:03.193438 MEMORY 16.832999424
About to launch parallel Leiden runs
2024-03-12 01:20:04.871403 MEMORY 16.831967232
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:   15.5s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   55.3s finished
Parallel Leiden runs finished
2024-03-12 01:21:00.526744 MEMORY 16.832499712
Quality: 0.5559064366612638
Quality: 0.5574845355199152
Got subclusters: Counter({0: 865, 1: 694, 2: 601, 3: 588, 4: 522, 5: 442, 6: 325, 7: 298})
On merging iteration 1
Numbers for each pattern pre-subsample: [865, 694, 601, 588, 522, 442, 325, 298]
Numbers after subsampling: [300, 300, 300, 300, 300, 300, 300, 298]
Computing sims for pattern 0
Computed sims for pattern 0 in 2.818323850631714 s
Computing sims for pattern 1
Computed sims for pattern 1 in 2.9938530921936035 s
Computing sims for pattern 2
Computed sims for pattern 2 in 2.958487033843994 s
Computing sims for pattern 3
Computed sims for pattern 3 in 3.02422833442688 s
Computing sims for pattern 4
Computed sims for pattern 4 in 2.9492523670196533 s
Computing sims for pattern 5
Computed sims for pattern 5 in 2.935098886489868 s
Computing sims for pattern 6
Computed sims for pattern 6 in 2.954355478286743 s
Computing sims for pattern 7
Computed sims for pattern 7 in 2.908997058868408 s
Cluster sizes
[865 694 601 588 522 442 325 298]
Cross-contamination matrix:
[[1.   0.5  0.73 0.69 0.58 0.74 0.55 0.65]
 [0.44 1.   0.61 0.47 0.65 0.7  0.51 0.49]
 [0.58 0.52 1.   0.53 0.5  0.39 0.55 0.51]
 [0.6  0.45 0.59 1.   0.53 0.59 0.46 0.44]
 [0.52 0.65 0.59 0.56 1.   0.63 0.49 0.61]
 [0.64 0.67 0.43 0.58 0.6  1.   0.54 0.47]
 [0.49 0.51 0.64 0.48 0.49 0.57 1.   0.48]
 [0.76 0.65 0.76 0.62 0.78 0.68 0.64 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.66 0.85 0.84 0.73 0.8  0.71 0.89]
 [0.66 1.   0.8  0.69 0.79 0.81 0.69 0.76]
 [0.85 0.8  1.   0.87 0.83 0.73 0.81 0.91]
 [0.84 0.69 0.87 1.   0.77 0.77 0.75 0.79]
 [0.73 0.79 0.83 0.77 1.   0.76 0.71 0.83]
 [0.8  0.81 0.73 0.77 0.76 1.   0.71 0.76]
 [0.71 0.69 0.81 0.75 0.71 0.71 1.   0.73]
 [0.89 0.76 0.91 0.79 0.83 0.76 0.73 1.  ]]
Collapsing 2 & 7 with crosscontam 0.5122793035048472 and sim 0.910112419522179
Collapsing 0 & 7 with crosscontam 0.6539268347004723 and sim 0.8938001466172485
Collapsing 2 & 3 with crosscontam 0.5276282691358025 and sim 0.8714203258173565
Trimming eliminated 0 seqlets out of 899
Skipped 1 due to duplicates
Trimming eliminated 0 seqlets out of 1763
Removed 1 duplicate seqlets
Trimming eliminated 0 seqlets out of 2350
Unmerged patterns remapping: OrderedDict([(1, 1), (4, 2), (5, 3), (6, 4)])
Time spent on merging iteration: 13.47989273071289
On merging iteration 2
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.4s
[Parallel(n_jobs=24)]: Done 3705 tasks      | elapsed:    2.1s
[Parallel(n_jobs=24)]: Done 4092 out of 4092 | elapsed:    2.4s finished
Numbers for each pattern pre-subsample: [2350, 694, 522, 442, 325]
Numbers after subsampling: [300, 300, 300, 300, 300]
Computing sims for pattern 0
Computed sims for pattern 0 in 1.7048609256744385 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.42361927032470703 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.4365849494934082 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.4302098751068115 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.4265861511230469 s
Cluster sizes
[2350  694  522  442  325]
Cross-contamination matrix:
[[1.   0.83 0.91 0.85 0.85]
 [0.49 1.   0.65 0.7  0.51]
 [0.56 0.65 1.   0.63 0.49]
 [0.49 0.67 0.6  1.   0.54]
 [0.5  0.51 0.49 0.57 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.78 0.84 0.75 0.79]
 [0.78 1.   0.79 0.81 0.69]
 [0.84 0.79 1.   0.76 0.71]
 [0.75 0.81 0.76 1.   0.71]
 [0.79 0.69 0.71 0.71 1.  ]]
Inspecting pattern 1 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 4092
[t-SNE] Computed conditional probabilities for sample 2000 / 4092
[t-SNE] Computed conditional probabilities for sample 3000 / 4092
[t-SNE] Computed conditional probabilities for sample 4000 / 4092
[t-SNE] Computed conditional probabilities for sample 4092 / 4092
[t-SNE] Mean sigma: 0.269445
Beginning preprocessing + Leiden
2024-03-12 01:21:45.957346 MEMORY 16.833191936
Affmat transformed
2024-03-12 01:21:46.003953 MEMORY 16.833196032
sources, targets, weights extracted
2024-03-12 01:21:46.037796 MEMORY 16.833200128
About to launch parallel Leiden runs
2024-03-12 01:21:46.077933 MEMORY 16.833200128
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:   14.0s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   53.8s finished
Parallel Leiden runs finished
2024-03-12 01:22:39.890447 MEMORY 16.833200128
Quality: 0.5261297900088984
Quality: 0.5276345534327559
Quality: 0.5276410676752262
Quality: 0.5277770494569284
Quality: 0.5279142389965583
Got subclusters: Counter({0: 1038, 1: 524, 2: 488, 3: 430, 4: 309, 5: 283, 6: 256, 7: 248, 8: 180, 9: 123, 10: 120, 11: 93})
On merging iteration 1
Numbers for each pattern pre-subsample: [1038, 524, 488, 430, 309, 283, 256, 248, 180, 123, 120, 93]
Numbers after subsampling: [300, 300, 300, 300, 300, 283, 256, 248, 180, 123, 120, 93]
Computing sims for pattern 0
Computed sims for pattern 0 in 4.337414979934692 s
Computing sims for pattern 1
Computed sims for pattern 1 in 4.318096160888672 s
Computing sims for pattern 2
Computed sims for pattern 2 in 4.3134236335754395 s
Computing sims for pattern 3
Computed sims for pattern 3 in 4.222207069396973 s
Computing sims for pattern 4
Computed sims for pattern 4 in 4.289575815200806 s
Computing sims for pattern 5
Computed sims for pattern 5 in 3.8549251556396484 s
Computing sims for pattern 6
Computed sims for pattern 6 in 3.3246564865112305 s
Computing sims for pattern 7
Computed sims for pattern 7 in 3.1398234367370605 s
Computing sims for pattern 8
Computed sims for pattern 8 in 2.913196325302124 s
Computing sims for pattern 9
Computed sims for pattern 9 in 2.1743991374969482 s
Computing sims for pattern 10
Computed sims for pattern 10 in 2.1275858879089355 s
Computing sims for pattern 11
Computed sims for pattern 11 in 1.8797500133514404 s
Cluster sizes
[1038  524  488  430  309  283  256  248  180  123  120   93]
Cross-contamination matrix:
[[1.   0.72 0.34 0.68 0.62 0.62 0.54 0.74 0.5  0.84 0.59 0.61]
 [0.55 1.   0.52 0.68 0.55 0.46 0.39 0.65 0.41 0.57 0.52 0.48]
 [0.53 0.92 1.   0.72 0.47 0.59 0.41 0.56 0.51 0.47 0.41 0.59]
 [0.58 0.76 0.4  1.   0.64 0.56 0.44 0.65 0.46 0.63 0.53 0.57]
 [0.64 0.76 0.29 0.77 1.   0.56 0.54 0.73 0.51 0.72 0.55 0.6 ]
 [0.63 0.62 0.42 0.67 0.56 1.   0.46 0.62 0.47 0.69 0.41 0.54]
 [0.7  0.69 0.36 0.7  0.68 0.59 1.   0.65 0.47 0.76 0.5  0.62]
 [0.65 0.76 0.3  0.67 0.62 0.54 0.43 1.   0.48 0.67 0.5  0.55]
 [0.75 0.78 0.55 0.8  0.74 0.69 0.55 0.79 1.   0.63 0.48 0.61]
 [0.55 0.47 0.16 0.46 0.43 0.43 0.36 0.48 0.23 1.   0.33 0.38]
 [0.45 0.55 0.18 0.49 0.41 0.29 0.27 0.45 0.2  0.43 1.   0.31]
 [0.52 0.55 0.3  0.59 0.49 0.44 0.39 0.54 0.3  0.54 0.33 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.92 0.83 0.94 0.91 0.87 0.91 0.92 0.87 0.92 0.85 0.88]
 [0.92 1.   0.87 0.92 0.92 0.82 0.9  0.92 0.84 0.89 0.86 0.83]
 [0.83 0.87 1.   0.83 0.73 0.76 0.76 0.78 0.79 0.71 0.64 0.78]
 [0.94 0.92 0.83 1.   0.92 0.88 0.89 0.93 0.89 0.91 0.87 0.87]
 [0.91 0.92 0.73 0.92 1.   0.85 0.86 0.94 0.85 0.91 0.87 0.84]
 [0.87 0.82 0.76 0.88 0.85 1.   0.81 0.86 0.82 0.86 0.75 0.81]
 [0.91 0.9  0.76 0.89 0.86 0.81 1.   0.88 0.8  0.88 0.81 0.82]
 [0.92 0.92 0.78 0.93 0.94 0.86 0.88 1.   0.89 0.89 0.82 0.86]
 [0.87 0.84 0.79 0.89 0.85 0.82 0.8  0.89 1.   0.8  0.72 0.8 ]
 [0.92 0.89 0.71 0.91 0.91 0.86 0.88 0.89 0.8  1.   0.87 0.84]
 [0.85 0.86 0.64 0.87 0.87 0.75 0.81 0.82 0.72 0.87 1.   0.75]
 [0.88 0.83 0.78 0.87 0.84 0.81 0.82 0.86 0.8  0.84 0.75 1.  ]]
Collapsing 4 & 7 with crosscontam 0.6247107330373827 and sim 0.937102568285485
Collapsing 0 & 3 with crosscontam 0.5760462720987654 and sim 0.936582831656875
Collapsing 3 & 7 with crosscontam 0.6451972962962964 and sim 0.9281248687739978
Collapsing 0 & 1 with crosscontam 0.548110117037037 and sim 0.9240451107128462
Collapsing 0 & 9 with crosscontam 0.5543692124871542 and sim 0.9233514350422832
Collapsing 0 & 7 with crosscontam 0.654191089415987 and sim 0.9231711387175987
Collapsing 1 & 3 with crosscontam 0.676359428148148 and sim 0.9224942345563832
Collapsing 1 & 7 with crosscontam 0.6541140244922343 and sim 0.9171173039250586
Collapsing 3 & 4 with crosscontam 0.638562381234568 and sim 0.9169733935792419
Collapsing 1 & 4 with crosscontam 0.554001002962963 and sim 0.9165308600046685
Collapsing 0 & 6 with crosscontam 0.5424535271990742 and sim 0.9142481759268493
Collapsing 3 & 9 with crosscontam 0.4574670838915409 and sim 0.9101653306620877
Collapsing 4 & 9 with crosscontam 0.4254948687896556 and sim 0.9081988735129004
Collapsing 0 & 4 with crosscontam 0.6194655343209876 and sim 0.9058437467431932
Collapsing 0 & 11 with crosscontam 0.5171910316770623 and sim 0.8811177454906362
Collapsing 3 & 5 with crosscontam 0.5593206810626883 and sim 0.8788174423777563
Collapsing 0 & 8 with crosscontam 0.5026207555555557 and sim 0.8686648637537158
Collapsing 3 & 11 with crosscontam 0.5673370593389087 and sim 0.8683846169750732
Collapsing 1 & 2 with crosscontam 0.5203570814814813 and sim 0.8681052727316845
Aborting collapse as 2 & 4 have cross-contam 0.37834267975308655 and sim 0.7280963238190444
Collapsing 0 & 5 with crosscontam 0.6214969627012172 and sim 0.8653642359567563
Collapsing 1 & 10 with crosscontam 0.5174329913580247 and sim 0.8612747654913706
Aborting collapse as 5 & 10 have cross-contam 0.3518675642871705 and sim 0.7470108145188386
Aborting collapse as 8 & 10 have cross-contam 0.33787025534407866 and sim 0.7207383457951229
Collapsing 5 & 7 with crosscontam 0.5433461403608864 and sim 0.8598142162014275
Collapsing 7 & 11 with crosscontam 0.5413087720999508 and sim 0.859674991466833
Collapsing 4 & 6 with crosscontam 0.5364134849537039 and sim 0.8580500892360607
Trimming eliminated 0 seqlets out of 557
Trimming eliminated 0 seqlets out of 1468
Trimming eliminated 0 seqlets out of 2025
Removed 1 duplicate seqlets
Trimming eliminated 0 seqlets out of 2548
Trimming eliminated 0 seqlets out of 2671
Trimming eliminated 0 seqlets out of 2927
Trimming eliminated 0 seqlets out of 3020
Trimming eliminated 0 seqlets out of 3303
Skipped 1 due to duplicates
Trimming eliminated 0 seqlets out of 3482
Unmerged patterns remapping: OrderedDict([(2, 1), (10, 2)])
Time spent on merging iteration: 27.335796117782593
On merging iteration 2
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 3090 out of 3090 | elapsed:    1.7s finished
Numbers for each pattern pre-subsample: [3482, 488, 120]
Numbers after subsampling: [300, 300, 120]
Computing sims for pattern 0
Computed sims for pattern 0 in 0.7495076656341553 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.420520544052124 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.21368861198425293 s
Cluster sizes
[3482  488  120]
Cross-contamination matrix:
[[1.   0.65 0.85]
 [0.57 1.   0.41]
 [0.42 0.18 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.84 0.88]
 [0.84 1.   0.64]
 [0.88 0.64 1.  ]]
Inspecting pattern 2 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 3090
[t-SNE] Computed conditional probabilities for sample 2000 / 3090
[t-SNE] Computed conditional probabilities for sample 3000 / 3090
[t-SNE] Computed conditional probabilities for sample 3090 / 3090
[t-SNE] Mean sigma: 0.283280
Beginning preprocessing + Leiden
2024-03-12 01:23:53.625378 MEMORY 16.833204224
Affmat transformed
2024-03-12 01:23:53.660568 MEMORY 16.833204224
sources, targets, weights extracted
2024-03-12 01:23:53.686586 MEMORY 16.833204224
About to launch parallel Leiden runs
2024-03-12 01:23:54.294097 MEMORY 16.833093632
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:   10.8s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   35.6s finished
Parallel Leiden runs finished
2024-03-12 01:24:29.898367 MEMORY 16.833101824
Quality: 0.5057070041057737
Quality: 0.5079832749350339
Quality: 0.5084103249004345
Quality: 0.5087473810835685
Got subclusters: Counter({0: 540, 1: 455, 2: 452, 3: 450, 4: 449, 5: 381, 6: 289, 7: 62, 8: 12})
On merging iteration 1
Numbers for each pattern pre-subsample: [540, 455, 452, 450, 449, 381, 289, 62, 12]
Numbers after subsampling: [300, 300, 300, 300, 300, 300, 289, 62, 12]
Computing sims for pattern 0
Computed sims for pattern 0 in 2.6611955165863037 s
Computing sims for pattern 1
Computed sims for pattern 1 in 2.6651742458343506 s
Computing sims for pattern 2
Computed sims for pattern 2 in 2.6618058681488037 s
Computing sims for pattern 3
Computed sims for pattern 3 in 4.862101078033447 s
Computing sims for pattern 4
Computed sims for pattern 4 in 2.761641502380371 s
Computing sims for pattern 5
Computed sims for pattern 5 in 2.8483824729919434 s
Computing sims for pattern 6
Computed sims for pattern 6 in 2.750635862350464 s
Computing sims for pattern 7
Computed sims for pattern 7 in 0.9666628837585449 s
Computing sims for pattern 8
Computed sims for pattern 8 in 0.40256428718566895 s
Cluster sizes
[540 455 452 450 449 381 289  62  12]
Cross-contamination matrix:
[[1.   0.56 0.32 0.38 0.33 0.45 0.48 0.52 0.72]
 [0.95 1.   0.34 0.53 0.44 0.63 0.6  0.68 0.8 ]
 [0.96 0.6  1.   0.64 0.75 0.55 0.67 0.71 1.  ]
 [0.87 0.72 0.55 1.   0.75 0.48 0.54 0.68 0.87]
 [0.9  0.52 0.66 0.77 1.   0.51 0.64 0.65 1.  ]
 [0.97 0.78 0.54 0.42 0.42 1.   0.68 0.8  0.91]
 [1.   0.79 0.55 0.52 0.61 0.73 1.   0.78 0.97]
 [0.76 0.62 0.3  0.39 0.32 0.51 0.46 1.   0.73]
 [0.   0.   0.   0.   0.   0.   0.   0.   1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.93 0.87 0.86 0.88 0.91 0.91 0.93 0.85]
 [0.93 1.   0.8  0.77 0.79 0.91 0.89 0.9  0.79]
 [0.87 0.8  1.   0.79 0.9  0.81 0.82 0.8  0.88]
 [0.86 0.77 0.79 1.   0.91 0.74 0.79 0.8  0.82]
 [0.88 0.79 0.9  0.91 1.   0.76 0.84 0.85 0.89]
 [0.91 0.91 0.81 0.74 0.76 1.   0.87 0.91 0.8 ]
 [0.91 0.89 0.82 0.79 0.84 0.87 1.   0.89 0.83]
 [0.93 0.9  0.8  0.8  0.85 0.91 0.89 1.   0.86]
 [0.85 0.79 0.88 0.82 0.89 0.8  0.83 0.86 1.  ]]
Collapsing 0 & 7 with crosscontam 0.5216043751493429 and sim 0.9346159505309111
Collapsing 0 & 1 with crosscontam 0.5612858083950616 and sim 0.9279328293347957
Collapsing 1 & 5 with crosscontam 0.6291865777777776 and sim 0.9129410165181193
Collapsing 3 & 4 with crosscontam 0.7482494385185183 and sim 0.9129073466552227
Collapsing 5 & 7 with crosscontam 0.5068169357635977 and sim 0.9098171959151171
Collapsing 0 & 6 with crosscontam 0.4831725982314494 and sim 0.9073343169287704
Collapsing 0 & 5 with crosscontam 0.4547069604938272 and sim 0.9068147270027672
Collapsing 1 & 7 with crosscontam 0.6154572410011971 and sim 0.9031439511767062
Collapsing 2 & 4 with crosscontam 0.6557868108641975 and sim 0.9014044903733672
Collapsing 1 & 6 with crosscontam 0.6041102252979624 and sim 0.8912458403685242
Collapsing 5 & 6 with crosscontam 0.682711564782776 and sim 0.8661309896375795
Trimming eliminated 0 seqlets out of 602
Trimming eliminated 0 seqlets out of 1057
Trimming eliminated 0 seqlets out of 1438
Trimming eliminated 0 seqlets out of 899
Trimming eliminated 0 seqlets out of 1727
Trimming eliminated 0 seqlets out of 1351
Unmerged patterns remapping: OrderedDict([(8, 2)])
Time spent on merging iteration: 9.97608208656311
On merging iteration 2
Numbers for each pattern pre-subsample: [1727, 1351, 12]
Numbers after subsampling: [300, 300, 12]
Computing sims for pattern 0
Computed sims for pattern 0 in 0.6627025604248047 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.6627302169799805 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.11222457885742188 s
Cluster sizes
[1727 1351   12]
Cross-contamination matrix:
[[1.   0.62 1.  ]
 [0.96 1.   1.  ]
 [0.   0.   1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.88 0.85]
 [0.88 1.   0.92]
 [0.85 0.92 1.  ]]
Collapsing 0 & 1 with crosscontam 0.6172208814814815 and sim 0.8794922287156262
Trimming eliminated 0 seqlets out of 3078
Unmerged patterns remapping: OrderedDict([(2, 1)])
Time spent on merging iteration: 6.838633060455322
On merging iteration 3
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.3s
[Parallel(n_jobs=24)]: Done 2370 tasks      | elapsed:    1.1s
[Parallel(n_jobs=24)]: Done 2464 out of 2464 | elapsed:    1.1s finished
Numbers for each pattern pre-subsample: [3078, 12]
Numbers after subsampling: [300, 12]
Computing sims for pattern 0
Computed sims for pattern 0 in 0.2637484073638916 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.055434465408325195 s
Cluster sizes
[3078   12]
Cross-contamination matrix:
[[1. 1.]
 [0. 1.]]
Pattern-to-pattern sim matrix:
[[1.  0.9]
 [0.9 1. ]]
Inspecting pattern 3 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 2464
[t-SNE] Computed conditional probabilities for sample 2000 / 2464
[t-SNE] Computed conditional probabilities for sample 2464 / 2464
[t-SNE] Mean sigma: 0.269964
Beginning preprocessing + Leiden
2024-03-12 01:25:15.171281 MEMORY 16.833196032
Affmat transformed
2024-03-12 01:25:15.199415 MEMORY 16.833196032
sources, targets, weights extracted
2024-03-12 01:25:15.220429 MEMORY 16.833196032
About to launch parallel Leiden runs
2024-03-12 01:25:15.309654 MEMORY 16.833196032
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    7.9s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   25.9s finished
Parallel Leiden runs finished
2024-03-12 01:25:41.259775 MEMORY 16.833196032
Quality: 0.5302777502568322
Quality: 0.5303678477116354
Quality: 0.530468489112645
Quality: 0.5305484399323782
Quality: 0.5305624622343853
Got subclusters: Counter({0: 525, 1: 405, 2: 379, 3: 259, 4: 258, 5: 183, 6: 164, 7: 156, 8: 69, 9: 66})
On merging iteration 1
Numbers for each pattern pre-subsample: [525, 405, 379, 259, 258, 183, 164, 156, 69, 66]
Numbers after subsampling: [300, 300, 300, 259, 258, 183, 164, 156, 69, 66]
Computing sims for pattern 0
Computed sims for pattern 0 in 3.429377317428589 s
Computing sims for pattern 1
Computed sims for pattern 1 in 3.5710368156433105 s
Computing sims for pattern 2
Computed sims for pattern 2 in 3.5468292236328125 s
Computing sims for pattern 3
Computed sims for pattern 3 in 2.826647996902466 s
Computing sims for pattern 4
Computed sims for pattern 4 in 2.7739927768707275 s
Computing sims for pattern 5
Computed sims for pattern 5 in 2.337908983230591 s
Computing sims for pattern 6
Computed sims for pattern 6 in 2.083775281906128 s
Computing sims for pattern 7
Computed sims for pattern 7 in 1.9852073192596436 s
Computing sims for pattern 8
Computed sims for pattern 8 in 1.167041540145874 s
Computing sims for pattern 9
Computed sims for pattern 9 in 1.102297306060791 s
Cluster sizes
[525 405 379 259 258 183 164 156  69  66]
Cross-contamination matrix:
[[1.   0.45 0.47 0.5  0.6  0.47 0.36 0.71 0.17 0.05]
 [0.73 1.   0.61 0.76 0.74 0.58 0.42 0.66 0.21 0.42]
 [0.78 0.61 1.   0.77 0.73 0.68 0.29 0.62 0.26 0.18]
 [0.7  0.66 0.65 1.   0.66 0.56 0.3  0.59 0.21 0.21]
 [0.88 0.7  0.69 0.72 1.   0.61 0.37 0.77 0.26 0.09]
 [0.81 0.61 0.71 0.69 0.68 1.   0.29 0.77 0.25 0.35]
 [0.98 0.7  0.54 0.65 0.68 0.5  1.   0.78 0.27 0.3 ]
 [0.8  0.44 0.4  0.47 0.58 0.51 0.27 1.   0.15 0.1 ]
 [0.9  0.66 0.83 0.8  0.84 0.74 0.55 0.83 1.   0.48]
 [0.1  0.51 0.23 0.32 0.1  0.42 0.18 0.26 0.13 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.9  0.91 0.93 0.95 0.96 0.86 0.94 0.74 0.63]
 [0.9  1.   0.86 0.9  0.92 0.88 0.87 0.86 0.67 0.76]
 [0.91 0.86 1.   0.92 0.94 0.9  0.74 0.87 0.81 0.61]
 [0.93 0.9  0.92 1.   0.94 0.9  0.83 0.88 0.78 0.68]
 [0.95 0.92 0.94 0.94 1.   0.95 0.8  0.91 0.81 0.65]
 [0.96 0.88 0.9  0.9  0.95 1.   0.76 0.87 0.74 0.76]
 [0.86 0.87 0.74 0.83 0.8  0.76 1.   0.79 0.62 0.7 ]
 [0.94 0.86 0.87 0.88 0.91 0.87 0.79 1.   0.71 0.59]
 [0.74 0.67 0.81 0.78 0.81 0.74 0.62 0.71 1.   0.6 ]
 [0.63 0.76 0.61 0.68 0.65 0.76 0.7  0.59 0.6  1.  ]]
Collapsing 0 & 5 with crosscontam 0.46997031370167974 and sim 0.9557111369576224
Collapsing 4 & 5 with crosscontam 0.6095727399862836 and sim 0.9481087481748118
Collapsing 0 & 4 with crosscontam 0.6024704209015215 and sim 0.9478449874077448
Collapsing 2 & 4 with crosscontam 0.6868902334401179 and sim 0.9440551245636607
Collapsing 0 & 7 with crosscontam 0.7114386467236467 and sim 0.9405649608962497
Collapsing 3 & 4 with crosscontam 0.6563294560242365 and sim 0.937647372884797
Collapsing 0 & 3 with crosscontam 0.5016697343057341 and sim 0.9278460312960415
Collapsing 1 & 4 with crosscontam 0.6962358629188174 and sim 0.9186773666697433
Collapsing 2 & 3 with crosscontam 0.653549162610745 and sim 0.9156170008043316
Collapsing 0 & 2 with crosscontam 0.4678333204938272 and sim 0.9133873780104392
Collapsing 4 & 7 with crosscontam 0.575341797685383 and sim 0.9125106429309103
Collapsing 1 & 3 with crosscontam 0.6586668442502435 and sim 0.9048680380026142
Collapsing 0 & 1 with crosscontam 0.4520839501234568 and sim 0.9046046730784311
Collapsing 3 & 5 with crosscontam 0.5616107525377481 and sim 0.9035925495817461
Collapsing 2 & 5 with crosscontam 0.6793443780611212 and sim 0.8974536772581955
Collapsing 1 & 5 with crosscontam 0.5831291754705525 and sim 0.8784506007295214
Collapsing 5 & 7 with crosscontam 0.509498178874856 and sim 0.8745209730033091
Collapsing 1 & 2 with crosscontam 0.6058853792592593 and sim 0.8610395712063045
Trimming eliminated 0 seqlets out of 708
Trimming eliminated 0 seqlets out of 966
Trimming eliminated 0 seqlets out of 1345
Trimming eliminated 0 seqlets out of 1501
Trimming eliminated 0 seqlets out of 1760
Trimming eliminated 0 seqlets out of 2165
Unmerged patterns remapping: OrderedDict([(6, 1), (8, 2), (9, 3)])
Time spent on merging iteration: 11.425179243087769
On merging iteration 2
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 1812 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done 2152 out of 2199 | elapsed:    0.9s remaining:    0.0s
[Parallel(n_jobs=24)]: Done 2199 out of 2199 | elapsed:    0.9s finished
Numbers for each pattern pre-subsample: [2165, 164, 69, 66]
Numbers after subsampling: [300, 164, 69, 66]
Computing sims for pattern 0
Computed sims for pattern 0 in 1.0110177993774414 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.2548708915710449 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.15107989311218262 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.14229559898376465 s
Cluster sizes
[2165  164   69   66]
Cross-contamination matrix:
[[1.   0.57 0.38 0.35]
 [0.73 1.   0.27 0.3 ]
 [0.82 0.55 1.   0.48]
 [0.31 0.18 0.13 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.85 0.78 0.66]
 [0.85 1.   0.62 0.7 ]
 [0.78 0.62 1.   0.6 ]
 [0.66 0.7  0.6  1.  ]]
Inspecting pattern 4 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 2199
[t-SNE] Computed conditional probabilities for sample 2000 / 2199
[t-SNE] Computed conditional probabilities for sample 2199 / 2199
[t-SNE] Mean sigma: 0.251263
Beginning preprocessing + Leiden
2024-03-12 01:26:21.893656 MEMORY 16.833196032
Affmat transformed
2024-03-12 01:26:21.918405 MEMORY 16.833196032
sources, targets, weights extracted
2024-03-12 01:26:21.937848 MEMORY 16.833196032
About to launch parallel Leiden runs
2024-03-12 01:26:21.950726 MEMORY 16.833196032
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    6.5s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   26.3s finished
Parallel Leiden runs finished
2024-03-12 01:26:48.221534 MEMORY 16.833196032
Quality: 0.5171040705118332
Quality: 0.519022644755003
Quality: 0.5203081577408235
Quality: 0.520453176379086
Got subclusters: Counter({0: 520, 1: 342, 2: 276, 3: 269, 4: 232, 5: 142, 6: 119, 7: 107, 8: 86, 9: 76, 10: 30})
On merging iteration 1
Numbers for each pattern pre-subsample: [520, 342, 276, 269, 232, 142, 119, 107, 86, 76, 30]
Numbers after subsampling: [300, 300, 276, 269, 232, 142, 119, 107, 86, 76, 30]
Computing sims for pattern 0
Computed sims for pattern 0 in 3.6008694171905518 s
Computing sims for pattern 1
Computed sims for pattern 1 in 3.5658416748046875 s
Computing sims for pattern 2
Computed sims for pattern 2 in 3.1738152503967285 s
Computing sims for pattern 3
Computed sims for pattern 3 in 3.053271770477295 s
Computing sims for pattern 4
Computed sims for pattern 4 in 3.1930243968963623 s
Computing sims for pattern 5
Computed sims for pattern 5 in 2.0004351139068604 s
Computing sims for pattern 6
Computed sims for pattern 6 in 1.6179945468902588 s
Computing sims for pattern 7
Computed sims for pattern 7 in 1.4700682163238525 s
Computing sims for pattern 8
Computed sims for pattern 8 in 1.401237964630127 s
Computing sims for pattern 9
Computed sims for pattern 9 in 1.2431385517120361 s
Computing sims for pattern 10
Computed sims for pattern 10 in 0.6177263259887695 s
Cluster sizes
[520 342 276 269 232 142 119 107  86  76  30]
Cross-contamination matrix:
[[1.   0.95 0.3  0.97 0.32 0.96 0.43 0.64 0.23 0.74 0.21]
 [0.62 1.   0.38 0.95 0.48 0.81 0.43 0.53 0.37 0.49 0.3 ]
 [0.48 0.75 1.   0.82 0.8  0.72 0.44 0.56 0.67 0.53 0.28]
 [0.35 0.73 0.19 1.   0.25 0.63 0.21 0.39 0.16 0.29 0.11]
 [0.38 0.77 0.66 0.79 1.   0.59 0.39 0.49 0.6  0.38 0.23]
 [0.57 0.76 0.32 0.81 0.33 1.   0.29 0.47 0.26 0.49 0.25]
 [0.63 0.85 0.42 0.86 0.49 0.67 1.   0.54 0.36 0.49 0.22]
 [0.52 0.65 0.3  0.76 0.34 0.63 0.29 1.   0.29 0.46 0.12]
 [0.3  0.59 0.54 0.65 0.61 0.46 0.29 0.43 1.   0.32 0.18]
 [0.6  0.6  0.28 0.69 0.26 0.69 0.26 0.47 0.2  1.   0.18]
 [0.43 0.7  0.35 0.73 0.37 0.67 0.3  0.22 0.3  0.4  1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.94 0.73 0.91 0.73 0.94 0.85 0.88 0.63 0.93 0.61]
 [0.94 1.   0.82 0.98 0.86 0.95 0.89 0.88 0.79 0.88 0.75]
 [0.73 0.82 1.   0.85 0.93 0.8  0.85 0.78 0.85 0.75 0.65]
 [0.91 0.98 0.85 1.   0.88 0.94 0.86 0.9  0.81 0.87 0.68]
 [0.73 0.86 0.93 0.88 1.   0.81 0.82 0.79 0.92 0.74 0.73]
 [0.94 0.95 0.8  0.94 0.81 1.   0.81 0.86 0.72 0.89 0.73]
 [0.85 0.89 0.85 0.86 0.82 0.81 1.   0.81 0.74 0.79 0.63]
 [0.88 0.88 0.78 0.9  0.79 0.86 0.81 1.   0.72 0.84 0.58]
 [0.63 0.79 0.85 0.81 0.92 0.72 0.74 0.72 1.   0.65 0.67]
 [0.93 0.88 0.75 0.87 0.74 0.89 0.79 0.84 0.65 1.   0.59]
 [0.61 0.75 0.65 0.68 0.73 0.73 0.63 0.58 0.67 0.59 1.  ]]
Collapsing 1 & 3 with crosscontam 0.7322200702806239 and sim 0.9798387028016131
Collapsing 1 & 5 with crosscontam 0.7626626032728807 and sim 0.9503498496461606
Collapsing 3 & 5 with crosscontam 0.6271748022229899 and sim 0.9398157763439645
Collapsing 0 & 1 with crosscontam 0.6172412666666665 and sim 0.9361462889131771
Collapsing 0 & 5 with crosscontam 0.5676247307291478 and sim 0.935418082597856
Collapsing 2 & 4 with crosscontam 0.6556861481287446 and sim 0.9317024460915588
Collapsing 0 & 9 with crosscontam 0.6047670032074646 and sim 0.9251249824575765
Collapsing 4 & 8 with crosscontam 0.6036470101072537 and sim 0.9191224601559452
Collapsing 0 & 3 with crosscontam 0.3507588057516997 and sim 0.9075556984649431
Collapsing 1 & 7 with crosscontam 0.5336980228452752 and sim 0.8809856836132223
Collapsing 0 & 7 with crosscontam 0.5199040033696776 and sim 0.8779453273030129
Collapsing 2 & 8 with crosscontam 0.5380675167968987 and sim 0.8547765624723158
Trimming eliminated 0 seqlets out of 611
Trimming eliminated 0 seqlets out of 753
Trimming eliminated 0 seqlets out of 1273
Trimming eliminated 0 seqlets out of 508
Trimming eliminated 0 seqlets out of 1349
Trimming eliminated 0 seqlets out of 594
Trimming eliminated 0 seqlets out of 1456
Unmerged patterns remapping: OrderedDict([(6, 2), (10, 3)])
Time spent on merging iteration: 9.028795719146729
On merging iteration 2
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 1650 tasks      | elapsed:    0.4s
[Parallel(n_jobs=24)]: Done 1883 out of 1883 | elapsed:    0.5s finished
Numbers for each pattern pre-subsample: [1456, 594, 119, 30]
Numbers after subsampling: [300, 300, 119, 30]
Computing sims for pattern 0
Computed sims for pattern 0 in 1.0914306640625 s
Computing sims for pattern 1
Computed sims for pattern 1 in 1.070216417312622 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.4063420295715332 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.16412043571472168 s
Cluster sizes
[1456  594  119   30]
Cross-contamination matrix:
[[1.   0.44 0.49 0.3 ]
 [0.8  1.   0.57 0.4 ]
 [0.74 0.43 1.   0.22]
 [0.59 0.35 0.3  1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.83 0.88 0.69]
 [0.83 1.   0.85 0.7 ]
 [0.88 0.85 1.   0.63]
 [0.69 0.7  0.63 1.  ]]
Inspecting pattern 5 for spurious merging
[t-SNE] Computed conditional probabilities for sample 1000 / 1883
[t-SNE] Computed conditional probabilities for sample 1883 / 1883
[t-SNE] Mean sigma: 0.294893
Beginning preprocessing + Leiden
2024-03-12 01:27:27.403709 MEMORY 16.833196032
Affmat transformed
2024-03-12 01:27:27.425036 MEMORY 16.833196032
sources, targets, weights extracted
2024-03-12 01:27:27.439665 MEMORY 16.833196032
About to launch parallel Leiden runs
2024-03-12 01:27:27.469312 MEMORY 16.833196032
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    5.8s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   19.0s finished
Parallel Leiden runs finished
2024-03-12 01:27:46.467023 MEMORY 16.833196032
Quality: 0.5050385851024725
Quality: 0.5051366781887152
Quality: 0.5055745891921909
Quality: 0.5058213529142261
Quality: 0.5059312187058079
Got subclusters: Counter({0: 345, 1: 332, 2: 305, 3: 233, 4: 215, 5: 170, 6: 142, 7: 141})
On merging iteration 1
Numbers for each pattern pre-subsample: [345, 332, 305, 233, 215, 170, 142, 141]
Numbers after subsampling: [300, 300, 300, 233, 215, 170, 142, 141]
Computing sims for pattern 0
Computed sims for pattern 0 in 2.740405321121216 s
Computing sims for pattern 1
Computed sims for pattern 1 in 2.809182643890381 s
Computing sims for pattern 2
Computed sims for pattern 2 in 2.779014825820923 s
Computing sims for pattern 3
Computed sims for pattern 3 in 2.515129327774048 s
Computing sims for pattern 4
Computed sims for pattern 4 in 2.2533042430877686 s
Computing sims for pattern 5
Computed sims for pattern 5 in 1.6759121417999268 s
Computing sims for pattern 6
Computed sims for pattern 6 in 1.5561211109161377 s
Computing sims for pattern 7
Computed sims for pattern 7 in 1.5492899417877197 s
Cluster sizes
[345 332 305 233 215 170 142 141]
Cross-contamination matrix:
[[1.   0.34 0.44 0.51 0.41 0.43 0.62 0.57]
 [0.12 1.   0.43 0.37 0.81 0.41 0.2  0.48]
 [0.54 0.93 1.   0.75 1.   0.65 0.58 0.77]
 [0.45 0.68 0.58 1.   0.79 0.6  0.46 0.68]
 [0.16 0.74 0.45 0.43 1.   0.43 0.28 0.45]
 [0.5  0.91 0.62 0.74 0.95 1.   0.62 0.75]
 [0.7  0.58 0.56 0.59 0.73 0.62 1.   0.59]
 [0.56 0.9  0.66 0.75 0.9  0.67 0.51 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.59 0.7  0.75 0.66 0.76 0.88 0.82]
 [0.59 1.   0.87 0.83 0.96 0.85 0.66 0.89]
 [0.7  0.87 1.   0.84 0.9  0.81 0.74 0.86]
 [0.75 0.83 0.84 1.   0.84 0.86 0.74 0.87]
 [0.66 0.96 0.9  0.84 1.   0.88 0.76 0.89]
 [0.76 0.85 0.81 0.86 0.88 1.   0.8  0.88]
 [0.88 0.66 0.74 0.74 0.76 0.8  1.   0.78]
 [0.82 0.89 0.86 0.87 0.89 0.88 0.78 1.  ]]
Collapsing 1 & 4 with crosscontam 0.7446125776765986 and sim 0.9551014935480635
Collapsing 2 & 4 with crosscontam 0.45148675915328207 and sim 0.9019454056416171
Collapsing 5 & 7 with crosscontam 0.6735227293258466 and sim 0.8815762453817327
Collapsing 0 & 6 with crosscontam 0.6241385007824727 and sim 0.8798799413529279
Collapsing 3 & 7 with crosscontam 0.6782114681931324 and sim 0.8733163475671679
Collapsing 2 & 7 with crosscontam 0.6612809859324922 and sim 0.8630769325084795
Collapsing 3 & 5 with crosscontam 0.6012129396467927 and sim 0.8567168453269414
Trimming eliminated 0 seqlets out of 547
Trimming eliminated 0 seqlets out of 852
Trimming eliminated 0 seqlets out of 311
Trimming eliminated 0 seqlets out of 487
Trimming eliminated 0 seqlets out of 544
Trimming eliminated 0 seqlets out of 1396
Unmerged patterns remapping: OrderedDict()
Time spent on merging iteration: 6.817355632781982
On merging iteration 2
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 742 out of 742 | elapsed:    0.3s finished
Numbers for each pattern pre-subsample: [1396, 487]
Numbers after subsampling: [300, 300]
Computing sims for pattern 0
Computed sims for pattern 0 in 0.4295079708099365 s
Computing sims for pattern 1
Computed sims for pattern 1 in 0.41908764839172363 s
Cluster sizes
[1396  487]
Cross-contamination matrix:
[[1.   0.61]
 [0.59 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.75]
 [0.75 1.  ]]
Inspecting pattern 6 for spurious merging
[t-SNE] Computed conditional probabilities for sample 742 / 742
[t-SNE] Mean sigma: 0.257066
Beginning preprocessing + Leiden
2024-03-12 01:28:12.111839 MEMORY 16.833196032
Affmat transformed
2024-03-12 01:28:12.121083 MEMORY 16.833196032
sources, targets, weights extracted
2024-03-12 01:28:12.128206 MEMORY 16.833196032
About to launch parallel Leiden runs
2024-03-12 01:28:12.149208 MEMORY 16.833196032
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    2.1s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    7.0s finished
Parallel Leiden runs finished
2024-03-12 01:28:19.131600 MEMORY 16.833196032
Quality: 0.4363975931847476
Quality: 0.4366600666864437
Quality: 0.43698767960282925
Quality: 0.43700730168793994
Got subclusters: Counter({0: 173, 1: 156, 2: 155, 3: 73, 4: 59, 5: 51, 6: 48, 7: 21, 8: 6})
On merging iteration 1
Numbers for each pattern pre-subsample: [173, 156, 155, 73, 59, 51, 48, 21, 6]
Numbers after subsampling: [173, 156, 155, 73, 59, 51, 48, 21, 6]
Computing sims for pattern 0
Computed sims for pattern 0 in 1.4925992488861084 s
Computing sims for pattern 1
Computed sims for pattern 1 in 1.2973361015319824 s
Computing sims for pattern 2
Computed sims for pattern 2 in 1.2829279899597168 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.796560525894165 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.6437520980834961 s
Computing sims for pattern 5
Computed sims for pattern 5 in 0.5779175758361816 s
Computing sims for pattern 6
Computed sims for pattern 6 in 0.48131704330444336 s
Computing sims for pattern 7
Computed sims for pattern 7 in 0.2764425277709961 s
Computing sims for pattern 8
Computed sims for pattern 8 in 0.15663647651672363 s
Cluster sizes
[173 156 155  73  59  51  48  21   6]
Cross-contamination matrix:
[[1.   0.25 0.89 0.42 0.15 0.16 0.23 0.71 0.1 ]
 [1.   1.   1.   0.89 0.78 0.55 0.65 1.   0.54]
 [0.6  0.09 1.   0.19 0.04 0.03 0.09 0.35 0.01]
 [1.   0.74 1.   1.   0.57 0.41 0.55 1.   0.45]
 [1.   0.95 1.   0.91 1.   0.57 0.63 1.   0.61]
 [1.   0.66 0.94 0.7  0.33 1.   0.52 1.   0.71]
 [1.   0.74 1.   0.8  0.57 0.51 1.   1.   0.63]
 [0.62 0.22 0.61 0.25 0.16 0.11 0.15 1.   0.06]
 [0.09 0.06 0.07 0.1  0.05 0.12 0.02 0.08 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.81 0.99 0.89 0.77 0.74 0.79 0.93 0.62]
 [0.81 1.   0.85 0.88 0.88 0.76 0.76 0.87 0.65]
 [0.99 0.85 1.   0.9  0.81 0.73 0.8  0.94 0.6 ]
 [0.89 0.88 0.9  1.   0.82 0.69 0.79 0.88 0.63]
 [0.77 0.88 0.81 0.82 1.   0.68 0.71 0.88 0.56]
 [0.74 0.76 0.73 0.69 0.68 1.   0.71 0.74 0.74]
 [0.79 0.76 0.8  0.79 0.71 0.71 1.   0.77 0.61]
 [0.93 0.87 0.94 0.88 0.88 0.74 0.77 1.   0.58]
 [0.62 0.65 0.6  0.63 0.56 0.74 0.61 0.58 1.  ]]
Collapsing 0 & 2 with crosscontam 0.6046289698774292 and sim 0.9904089773652882
Collapsing 2 & 7 with crosscontam 0.3490208196467133 and sim 0.9410222626699745
Collapsing 0 & 7 with crosscontam 0.6215211655815642 and sim 0.9314939412953886
Collapsing 1 & 4 with crosscontam 0.7794058789006639 and sim 0.881849102516395
Collapsing 1 & 3 with crosscontam 0.740842846298392 and sim 0.8778640677664256
Trimming eliminated 0 seqlets out of 328
Trimming eliminated 0 seqlets out of 349
Trimming eliminated 0 seqlets out of 215
Trimming eliminated 0 seqlets out of 288
Unmerged patterns remapping: OrderedDict([(5, 2), (6, 3), (8, 4)])
Time spent on merging iteration: 3.8291921615600586
On merging iteration 2
Numbers for each pattern pre-subsample: [349, 288, 51, 48, 6]
Numbers after subsampling: [300, 288, 51, 48, 6]
Computing sims for pattern 0
Computed sims for pattern 0 in 1.3114376068115234 s
Computing sims for pattern 1
Computed sims for pattern 1 in 1.2416038513183594 s
Computing sims for pattern 2
Computed sims for pattern 2 in 0.23746848106384277 s
Computing sims for pattern 3
Computed sims for pattern 3 in 0.21143364906311035 s
Computing sims for pattern 4
Computed sims for pattern 4 in 0.09521365165710449 s
Cluster sizes
[349 288  51  48   6]
Cross-contamination matrix:
[[1.   0.23 0.13 0.22 0.07]
 [1.   1.   0.64 0.74 0.67]
 [1.   0.6  1.   0.52 0.71]
 [1.   0.7  0.51 1.   0.63]
 [0.06 0.06 0.12 0.02 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.85 0.74 0.79 0.61]
 [0.85 1.   0.75 0.77 0.65]
 [0.74 0.75 1.   0.71 0.74]
 [0.79 0.77 0.71 1.   0.61]
 [0.61 0.65 0.74 0.61 1.  ]]
Merging on 25 clusters
2024-03-12 01:28:33.094255 MEMORY 16.833196032
On merging iteration 1
Numbers for each pattern pre-subsample: [2350, 694, 522, 442, 325, 3482, 488, 120, 3078, 12, 2165, 164, 69, 66, 1456, 594, 119, 30, 1396, 487, 349, 288, 51, 48, 6]
Numbers after subsampling: [300, 300, 300, 300, 300, 300, 300, 120, 300, 12, 300, 164, 69, 66, 300, 300, 119, 30, 300, 300, 300, 288, 51, 48, 6]
Computing sims for pattern 0
Computed sims for pattern 0 in 8.915923595428467 s
Computing sims for pattern 1
Computed sims for pattern 1 in 9.043500900268555 s
Computing sims for pattern 2
Computed sims for pattern 2 in 9.22955322265625 s
Computing sims for pattern 3
Computed sims for pattern 3 in 9.6558256149292 s
Computing sims for pattern 4
Computed sims for pattern 4 in 9.356956243515015 s
Computing sims for pattern 5
Computed sims for pattern 5 in 9.335803031921387 s
Computing sims for pattern 6
Computed sims for pattern 6 in 9.208261489868164 s
Computing sims for pattern 7
Computed sims for pattern 7 in 4.176847457885742 s
Computing sims for pattern 8
Computed sims for pattern 8 in 9.064616680145264 s
Computing sims for pattern 9
Computed sims for pattern 9 in 3.277499198913574 s
Computing sims for pattern 10
Computed sims for pattern 10 in 9.056395530700684 s
Computing sims for pattern 11
Computed sims for pattern 11 in 5.3406922817230225 s
Computing sims for pattern 12
Computed sims for pattern 12 in 2.9157097339630127 s
Computing sims for pattern 13
Computed sims for pattern 13 in 2.8541033267974854 s
Computing sims for pattern 14
Computed sims for pattern 14 in 9.192497968673706 s
Computing sims for pattern 15
Computed sims for pattern 15 in 9.342053413391113 s
Computing sims for pattern 16
Computed sims for pattern 16 in 4.19127893447876 s
Computing sims for pattern 17
Computed sims for pattern 17 in 1.5441968441009521 s
Computing sims for pattern 18
Computed sims for pattern 18 in 9.126145124435425 s
Computing sims for pattern 19
Computed sims for pattern 19 in 9.155667066574097 s
Computing sims for pattern 20
Computed sims for pattern 20 in 9.131267786026001 s
Computing sims for pattern 21
Computed sims for pattern 21 in 8.5019850730896 s
Computing sims for pattern 22
Computed sims for pattern 22 in 2.3447158336639404 s
Computing sims for pattern 23
Computed sims for pattern 23 in 2.046496868133545 s
Computing sims for pattern 24
Computed sims for pattern 24 in 3.0921597480773926 s
Cluster sizes
[2350  694  522  442  325 3482  488  120 3078   12 2165  164   69   66
 1456  594  119   30 1396  487  349  288   51   48    6]
Cross-contamination matrix:
[[1.   0.83 0.91 0.85 0.85 0.27 0.44 0.25 0.25 0.31 0.26 0.26 0.44 0.46
  0.22 0.23 0.16 0.26 0.16 0.26 0.79 0.82 0.76 0.57 0.91]
 [0.49 1.   0.65 0.7  0.51 0.06 0.15 0.09 0.15 0.18 0.11 0.13 0.17 0.22
  0.13 0.07 0.09 0.18 0.03 0.06 0.44 0.42 0.77 0.29 0.91]
 [0.56 0.65 1.   0.63 0.49 0.15 0.18 0.13 0.27 0.32 0.13 0.17 0.13 0.16
  0.23 0.11 0.15 0.09 0.04 0.05 0.32 0.37 0.44 0.22 0.41]
 [0.49 0.67 0.6  1.   0.54 0.13 0.15 0.14 0.21 0.25 0.12 0.17 0.17 0.24
  0.18 0.11 0.15 0.11 0.05 0.08 0.46 0.51 0.63 0.3  0.46]
 [0.5  0.51 0.49 0.57 1.   0.43 0.5  0.47 0.38 0.48 0.49 0.37 0.14 0.27
  0.41 0.38 0.33 0.16 0.27 0.05 0.26 0.36 0.4  0.2  0.45]
 [0.07 0.04 0.11 0.09 0.32 1.   0.65 0.85 0.47 0.8  1.   0.56 0.32 0.33
  0.96 1.   0.89 0.48 0.67 0.17 0.06 0.08 0.06 0.23 0.19]
 [0.11 0.08 0.09 0.07 0.3  0.57 1.   0.41 0.16 0.27 0.62 0.44 0.11 0.36
  0.48 0.58 0.42 0.14 0.38 0.12 0.02 0.04 0.04 0.01 0.14]
 [0.02 0.01 0.02 0.02 0.12 0.42 0.18 1.   0.16 0.36 0.45 0.17 0.09 0.07
  0.35 0.44 0.32 0.12 0.22 0.04 0.02 0.02 0.03 0.07 0.03]
 [0.15 0.25 0.34 0.29 0.44 0.66 0.35 0.57 1.   1.   0.62 0.56 0.26 0.48
  1.   0.76 0.9  0.71 0.41 0.27 0.18 0.2  0.28 0.36 0.61]
 [0.   0.   0.   0.   0.   0.   0.   0.   0.   1.   0.   0.   0.   0.
  0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.  ]
 [0.03 0.04 0.05 0.04 0.25 0.74 0.47 0.63 0.28 0.46 1.   0.57 0.38 0.35
  0.69 0.81 0.68 0.41 0.53 0.13 0.08 0.08 0.05 0.17 0.08]
 [0.04 0.06 0.06 0.09 0.21 0.47 0.42 0.38 0.28 0.27 0.73 1.   0.27 0.3
  0.71 0.5  0.8  0.33 0.37 0.1  0.09 0.06 0.08 0.12 0.14]
 [0.22 0.19 0.15 0.18 0.16 0.48 0.23 0.46 0.2  0.02 0.82 0.55 1.   0.48
  0.43 0.53 0.47 0.8  0.42 0.29 0.28 0.3  0.25 0.39 0.26]
 [0.08 0.06 0.03 0.06 0.08 0.14 0.22 0.08 0.13 0.35 0.31 0.18 0.13 1.
  0.09 0.11 0.05 0.03 0.06 0.03 0.07 0.1  0.08 0.32 0.02]
 [0.01 0.02 0.02 0.02 0.05 0.31 0.11 0.19 0.35 0.48 0.31 0.2  0.05 0.04
  1.   0.44 0.49 0.3  0.16 0.03 0.   0.01 0.02 0.03 0.08]
 [0.02 0.02 0.03 0.02 0.13 0.64 0.35 0.52 0.28 0.47 0.71 0.31 0.17 0.12
  0.8  1.   0.57 0.4  0.45 0.08 0.02 0.02 0.02 0.09 0.08]
 [0.   0.01 0.01 0.   0.05 0.42 0.14 0.28 0.26 0.35 0.46 0.39 0.08 0.03
  0.74 0.43 1.   0.22 0.24 0.03 0.   0.01 0.03 0.03 0.14]
 [0.01 0.03 0.01 0.01 0.03 0.19 0.05 0.14 0.19 0.05 0.29 0.16 0.26 0.03
  0.59 0.35 0.3  1.   0.12 0.07 0.01 0.02 0.02 0.03 0.04]
 [0.07 0.05 0.07 0.06 0.29 0.77 0.56 0.64 0.35 0.52 0.83 0.58 0.37 0.26
  0.73 0.83 0.73 0.43 1.   0.61 0.09 0.09 0.09 0.3  0.08]
 [0.14 0.07 0.05 0.07 0.05 0.21 0.21 0.19 0.19 0.04 0.27 0.22 0.24 0.13
  0.26 0.24 0.22 0.3  0.59 1.   0.06 0.1  0.07 0.07 0.22]
 [0.02 0.03 0.02 0.03 0.02 0.   0.   0.01 0.01 0.02 0.01 0.01 0.01 0.02
  0.   0.   0.   0.01 0.01 0.01 1.   0.23 0.13 0.22 0.07]
 [0.42 0.4  0.35 0.48 0.38 0.15 0.13 0.17 0.17 0.3  0.24 0.19 0.27 0.37
  0.13 0.14 0.1  0.17 0.1  0.12 1.   1.   0.64 0.74 0.67]
 [0.29 0.63 0.29 0.54 0.32 0.05 0.05 0.11 0.16 0.09 0.09 0.09 0.17 0.21
  0.1  0.04 0.16 0.13 0.06 0.07 1.   0.6  1.   0.52 0.71]
 [0.12 0.21 0.16 0.23 0.25 0.24 0.02 0.26 0.22 0.45 0.3  0.18 0.26 0.6
  0.16 0.21 0.03 0.12 0.23 0.06 1.   0.7  0.51 1.   0.63]
 [0.02 0.11 0.02 0.02 0.01 0.01 0.01 0.   0.03 0.05 0.   0.   0.   0.
  0.03 0.   0.02 0.   0.   0.   0.06 0.06 0.12 0.02 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.78 0.84 0.75 0.79 0.32 0.44 0.31 0.34 0.4  0.27 0.31 0.57 0.4
  0.28 0.23 0.25 0.3  0.15 0.26 0.55 0.77 0.74 0.56 0.59]
 [0.78 1.   0.79 0.81 0.69 0.25 0.39 0.34 0.4  0.41 0.26 0.36 0.51 0.42
  0.32 0.2  0.27 0.39 0.11 0.14 0.44 0.6  0.87 0.5  0.75]
 [0.84 0.79 1.   0.76 0.71 0.39 0.48 0.38 0.61 0.62 0.31 0.43 0.49 0.33
  0.5  0.28 0.43 0.31 0.16 0.14 0.35 0.58 0.63 0.46 0.54]
 [0.75 0.81 0.76 1.   0.71 0.38 0.42 0.44 0.42 0.47 0.31 0.3  0.51 0.38
  0.31 0.3  0.26 0.3  0.16 0.12 0.47 0.65 0.75 0.54 0.58]
 [0.79 0.69 0.71 0.71 1.   0.57 0.58 0.61 0.54 0.53 0.55 0.46 0.45 0.47
  0.47 0.5  0.43 0.24 0.39 0.17 0.45 0.62 0.67 0.44 0.49]
 [0.32 0.25 0.39 0.38 0.57 1.   0.84 0.88 0.71 0.75 0.96 0.8  0.61 0.68
  0.84 0.96 0.89 0.6  0.85 0.42 0.19 0.31 0.32 0.51 0.34]
 [0.44 0.39 0.48 0.42 0.58 0.84 1.   0.64 0.51 0.56 0.8  0.81 0.37 0.61
  0.7  0.79 0.79 0.36 0.72 0.41 0.09 0.26 0.28 0.29 0.38]
 [0.31 0.34 0.38 0.44 0.61 0.88 0.64 1.   0.63 0.75 0.88 0.63 0.59 0.63
  0.68 0.84 0.72 0.53 0.69 0.31 0.33 0.38 0.47 0.62 0.37]
 [0.34 0.4  0.61 0.42 0.54 0.71 0.51 0.63 1.   0.9  0.62 0.61 0.32 0.59
  0.91 0.64 0.76 0.54 0.52 0.35 0.21 0.31 0.45 0.46 0.55]
 [0.4  0.41 0.62 0.47 0.53 0.75 0.56 0.75 0.9  1.   0.65 0.58 0.31 0.59
  0.82 0.66 0.72 0.4  0.54 0.21 0.36 0.41 0.47 0.57 0.47]
 [0.27 0.26 0.31 0.31 0.55 0.96 0.8  0.88 0.62 0.65 1.   0.85 0.78 0.66
  0.78 0.95 0.86 0.66 0.83 0.47 0.25 0.33 0.34 0.5  0.25]
 [0.31 0.36 0.43 0.3  0.46 0.8  0.81 0.63 0.61 0.58 0.85 1.   0.62 0.7
  0.79 0.78 0.87 0.53 0.71 0.43 0.23 0.28 0.37 0.39 0.32]
 [0.57 0.51 0.49 0.51 0.45 0.61 0.37 0.59 0.32 0.31 0.78 0.62 1.   0.6
  0.46 0.66 0.55 0.76 0.6  0.46 0.32 0.49 0.51 0.54 0.41]
 [0.4  0.42 0.33 0.38 0.47 0.68 0.61 0.63 0.59 0.59 0.66 0.7  0.6  1.
  0.54 0.62 0.5  0.42 0.59 0.34 0.33 0.44 0.46 0.66 0.32]
 [0.28 0.32 0.5  0.31 0.47 0.84 0.7  0.68 0.91 0.82 0.78 0.79 0.46 0.54
  1.   0.83 0.88 0.69 0.68 0.41 0.12 0.24 0.38 0.37 0.45]
 [0.23 0.2  0.28 0.3  0.5  0.96 0.79 0.84 0.64 0.66 0.95 0.78 0.66 0.62
  0.83 1.   0.85 0.7  0.84 0.46 0.17 0.26 0.27 0.46 0.27]
 [0.25 0.27 0.43 0.26 0.43 0.89 0.79 0.72 0.76 0.72 0.86 0.87 0.55 0.5
  0.88 0.85 1.   0.63 0.73 0.38 0.13 0.24 0.44 0.33 0.43]
 [0.3  0.39 0.31 0.3  0.24 0.6  0.36 0.53 0.54 0.4  0.66 0.53 0.76 0.42
  0.69 0.7  0.63 1.   0.56 0.51 0.13 0.23 0.33 0.28 0.31]
 [0.15 0.11 0.16 0.16 0.39 0.85 0.72 0.69 0.52 0.54 0.83 0.71 0.6  0.59
  0.68 0.84 0.73 0.56 1.   0.75 0.26 0.2  0.22 0.44 0.21]
 [0.26 0.14 0.14 0.12 0.17 0.42 0.41 0.31 0.35 0.21 0.47 0.43 0.46 0.34
  0.41 0.46 0.38 0.51 0.75 1.   0.11 0.12 0.15 0.2  0.19]
 [0.55 0.44 0.35 0.47 0.45 0.19 0.09 0.33 0.21 0.36 0.25 0.23 0.32 0.33
  0.12 0.17 0.13 0.13 0.26 0.11 1.   0.85 0.74 0.79 0.61]
 [0.77 0.6  0.58 0.65 0.62 0.31 0.26 0.38 0.31 0.41 0.33 0.28 0.49 0.44
  0.24 0.26 0.24 0.23 0.2  0.12 0.85 1.   0.75 0.77 0.65]
 [0.74 0.87 0.63 0.75 0.67 0.32 0.28 0.47 0.45 0.47 0.34 0.37 0.51 0.46
  0.38 0.27 0.44 0.33 0.22 0.15 0.74 0.75 1.   0.71 0.74]
 [0.56 0.5  0.46 0.54 0.44 0.51 0.29 0.62 0.46 0.57 0.5  0.39 0.54 0.66
  0.37 0.46 0.33 0.28 0.44 0.2  0.79 0.77 0.71 1.   0.61]
 [0.59 0.75 0.54 0.58 0.49 0.34 0.38 0.37 0.55 0.47 0.25 0.32 0.41 0.32
  0.45 0.27 0.43 0.31 0.21 0.19 0.61 0.65 0.74 0.61 1.  ]]
Collapsing 5 & 15 with crosscontam 0.641338465185185 and sim 0.9604038194964957
Collapsing 5 & 10 with crosscontam 0.7393427081481481 and sim 0.9575489059146164
Collapsing 10 & 15 with crosscontam 0.7063332172839507 and sim 0.9492636560716639
Collapsing 8 & 14 with crosscontam 0.34933185975308634 and sim 0.9119003759271587
Collapsing 1 & 22 with crosscontam 0.6282456470990292 and sim 0.8691977024220838
Collapsing 5 & 18 with crosscontam 0.6747571461728397 and sim 0.8533222261548137
Trimming eliminated 0 seqlets out of 4076
Trimming eliminated 0 seqlets out of 6241
Removed 1 duplicate seqlets
Skipped 1 due to duplicates
Trimming eliminated 0 seqlets out of 4532
Trimming eliminated 0 seqlets out of 745
Skipped 2 due to duplicates
Trimming eliminated 0 seqlets out of 7635
Unmerged patterns remapping: OrderedDict([(0, 2), (2, 4), (3, 7), (4, 9), (6, 5), (7, 12), (9, 18), (11, 11), (12, 14), (13, 15), (16, 13), (17, 17), (19, 6), (20, 8), (21, 10), (23, 16), (24, 19)])
Time spent on merging iteration: 38.09579348564148
On merging iteration 2
Numbers for each pattern pre-subsample: [7635, 4532, 2350, 745, 522, 488, 487, 442, 349, 325, 288, 164, 120, 119, 69, 66, 48, 30, 12, 6]
Numbers after subsampling: [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 288, 164, 120, 119, 69, 66, 48, 30, 12, 6]
Computing sims for pattern 0
Computed sims for pattern 0 in 6.986271381378174 s
Computing sims for pattern 1
Computed sims for pattern 1 in 7.236936092376709 s
Computing sims for pattern 2
Computed sims for pattern 2 in 1.2850072383880615 s
Computing sims for pattern 3
Computed sims for pattern 3 in 7.153724431991577 s
Computing sims for pattern 4
Computed sims for pattern 4 in 1.2658042907714844 s
Computing sims for pattern 5
Computed sims for pattern 5 in 1.2750201225280762 s
Computing sims for pattern 6
Computed sims for pattern 6 in 1.2686853408813477 s
Computing sims for pattern 7
Computed sims for pattern 7 in 3.4970643520355225 s
Computing sims for pattern 8
Computed sims for pattern 8 in 1.225391149520874 s
Computing sims for pattern 9
Computed sims for pattern 9 in 1.2969224452972412 s
Computing sims for pattern 10
Computed sims for pattern 10 in 1.2180500030517578 s
Computing sims for pattern 11
Computed sims for pattern 11 in 0.7411205768585205 s
Computing sims for pattern 12
Computed sims for pattern 12 in 0.6028609275817871 s
Computing sims for pattern 13
Computed sims for pattern 13 in 0.5905284881591797 s
Computing sims for pattern 14
Computed sims for pattern 14 in 0.4134786128997803 s
Computing sims for pattern 15
Computed sims for pattern 15 in 0.3963737487792969 s
Computing sims for pattern 16
Computed sims for pattern 16 in 0.30330324172973633 s
Computing sims for pattern 17
Computed sims for pattern 17 in 0.23350191116333008 s
Computing sims for pattern 18
Computed sims for pattern 18 in 0.16199636459350586 s
Computing sims for pattern 19
Computed sims for pattern 19 in 0.1376042366027832 s
Cluster sizes
[7635 4532 2350  745  522  488  487  442  349  325  288  164  120  119
   69   66   48   30   12    6]
Cross-contamination matrix:
[[1.   0.63 0.09 0.07 0.12 0.75 0.31 0.1  0.1  0.39 0.11 0.71 0.88 0.94
  0.44 0.36 0.28 0.6  0.8  0.22]
 [0.62 1.   0.11 0.2  0.26 0.38 0.25 0.22 0.13 0.36 0.15 0.55 0.58 0.88
  0.26 0.4  0.28 0.7  1.   0.52]
 [0.25 0.22 1.   0.81 0.91 0.44 0.26 0.85 0.79 0.85 0.82 0.26 0.25 0.16
  0.44 0.46 0.57 0.26 0.31 0.91]
 [0.08 0.16 0.49 1.   0.64 0.16 0.08 0.72 0.47 0.51 0.46 0.16 0.11 0.12
  0.19 0.25 0.33 0.22 0.2  0.97]
 [0.12 0.25 0.56 0.63 1.   0.18 0.05 0.63 0.32 0.49 0.37 0.17 0.13 0.15
  0.13 0.16 0.22 0.09 0.32 0.41]
 [0.57 0.23 0.11 0.07 0.09 1.   0.12 0.07 0.02 0.3  0.04 0.44 0.41 0.42
  0.11 0.36 0.01 0.14 0.27 0.14]
 [0.3  0.23 0.14 0.08 0.05 0.21 1.   0.07 0.06 0.05 0.1  0.22 0.19 0.22
  0.24 0.13 0.07 0.3  0.04 0.22]
 [0.12 0.2  0.49 0.64 0.6  0.15 0.08 1.   0.46 0.54 0.51 0.17 0.14 0.15
  0.17 0.24 0.3  0.11 0.25 0.46]
 [0.01 0.   0.02 0.04 0.02 0.   0.01 0.03 1.   0.02 0.23 0.01 0.01 0.
  0.01 0.02 0.22 0.01 0.02 0.07]
 [0.41 0.36 0.5  0.48 0.49 0.5  0.05 0.57 0.26 1.   0.36 0.37 0.47 0.33
  0.14 0.27 0.2  0.16 0.48 0.45]
 [0.16 0.15 0.42 0.41 0.35 0.13 0.12 0.48 1.   0.38 1.   0.19 0.17 0.1
  0.27 0.37 0.74 0.17 0.3  0.67]
 [0.51 0.38 0.04 0.06 0.06 0.42 0.1  0.09 0.09 0.21 0.06 1.   0.38 0.8
  0.27 0.3  0.12 0.33 0.27 0.14]
 [0.38 0.21 0.02 0.01 0.02 0.18 0.04 0.02 0.02 0.12 0.02 0.17 1.   0.32
  0.09 0.07 0.07 0.12 0.36 0.03]
 [0.39 0.39 0.   0.01 0.01 0.14 0.03 0.   0.   0.05 0.01 0.39 0.28 1.
  0.08 0.03 0.03 0.22 0.35 0.14]
 [0.53 0.27 0.22 0.2  0.15 0.23 0.29 0.18 0.28 0.16 0.3  0.55 0.46 0.47
  1.   0.48 0.39 0.8  0.02 0.26]
 [0.11 0.12 0.08 0.06 0.03 0.22 0.03 0.06 0.07 0.08 0.1  0.18 0.08 0.05
  0.13 1.   0.32 0.03 0.35 0.02]
 [0.24 0.2  0.12 0.23 0.16 0.02 0.06 0.23 1.   0.25 0.7  0.18 0.26 0.03
  0.26 0.6  1.   0.12 0.45 0.63]
 [0.2  0.31 0.01 0.03 0.01 0.05 0.07 0.01 0.01 0.03 0.02 0.16 0.14 0.3
  0.26 0.03 0.03 1.   0.05 0.04]
 [0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.   0.
  0.   0.   0.   0.   1.   0.  ]
 [0.   0.05 0.02 0.1  0.02 0.01 0.   0.02 0.06 0.01 0.06 0.   0.   0.02
  0.   0.   0.02 0.   0.05 1.  ]]
Pattern-to-pattern sim matrix:
[[1.   0.74 0.27 0.23 0.33 0.83 0.5  0.33 0.2  0.55 0.29 0.82 0.87 0.88
  0.69 0.66 0.51 0.64 0.7  0.29]
 [0.74 1.   0.31 0.38 0.57 0.6  0.38 0.38 0.18 0.51 0.3  0.69 0.66 0.82
  0.39 0.57 0.44 0.61 0.88 0.52]
 [0.27 0.31 1.   0.77 0.84 0.44 0.26 0.75 0.55 0.79 0.77 0.31 0.31 0.25
  0.57 0.4  0.56 0.3  0.4  0.59]
 [0.23 0.38 0.77 1.   0.78 0.4  0.1  0.82 0.43 0.7  0.61 0.36 0.35 0.29
  0.51 0.43 0.51 0.42 0.41 0.76]
 [0.33 0.57 0.84 0.78 1.   0.48 0.14 0.76 0.35 0.71 0.58 0.43 0.38 0.43
  0.49 0.33 0.46 0.31 0.62 0.54]
 [0.83 0.6  0.44 0.4  0.48 1.   0.41 0.42 0.09 0.58 0.26 0.81 0.64 0.79
  0.37 0.61 0.29 0.36 0.56 0.38]
 [0.5  0.38 0.26 0.1  0.14 0.41 1.   0.12 0.11 0.17 0.12 0.43 0.31 0.38
  0.46 0.34 0.2  0.51 0.21 0.19]
 [0.33 0.38 0.75 0.82 0.76 0.42 0.12 1.   0.47 0.71 0.65 0.3  0.44 0.26
  0.51 0.38 0.54 0.3  0.47 0.58]
 [0.2  0.18 0.55 0.43 0.35 0.09 0.11 0.47 1.   0.45 0.85 0.23 0.33 0.13
  0.32 0.33 0.79 0.13 0.36 0.61]
 [0.55 0.51 0.79 0.7  0.71 0.58 0.17 0.71 0.45 1.   0.62 0.46 0.61 0.43
  0.45 0.47 0.44 0.24 0.53 0.49]
 [0.29 0.3  0.77 0.61 0.58 0.26 0.12 0.65 0.85 0.62 1.   0.28 0.38 0.24
  0.49 0.44 0.77 0.23 0.41 0.65]
 [0.82 0.69 0.31 0.36 0.43 0.81 0.43 0.3  0.23 0.46 0.28 1.   0.63 0.87
  0.62 0.7  0.39 0.53 0.58 0.32]
 [0.87 0.66 0.31 0.35 0.38 0.64 0.31 0.44 0.33 0.61 0.38 0.63 1.   0.72
  0.59 0.63 0.62 0.53 0.75 0.37]
 [0.88 0.82 0.25 0.29 0.43 0.79 0.38 0.26 0.13 0.43 0.24 0.87 0.72 1.
  0.55 0.5  0.33 0.63 0.72 0.43]
 [0.69 0.39 0.57 0.51 0.49 0.37 0.46 0.51 0.32 0.45 0.49 0.62 0.59 0.55
  1.   0.6  0.54 0.76 0.31 0.41]
 [0.66 0.57 0.4  0.43 0.33 0.61 0.34 0.38 0.33 0.47 0.44 0.7  0.63 0.5
  0.6  1.   0.66 0.42 0.59 0.32]
 [0.51 0.44 0.56 0.51 0.46 0.29 0.2  0.54 0.79 0.44 0.77 0.39 0.62 0.33
  0.54 0.66 1.   0.28 0.57 0.61]
 [0.64 0.61 0.3  0.42 0.31 0.36 0.51 0.3  0.13 0.24 0.23 0.53 0.53 0.63
  0.76 0.42 0.28 1.   0.4  0.31]
 [0.7  0.88 0.4  0.41 0.62 0.56 0.21 0.47 0.36 0.53 0.41 0.58 0.75 0.72
  0.31 0.59 0.57 0.4  1.   0.47]
 [0.29 0.52 0.59 0.76 0.54 0.38 0.19 0.58 0.61 0.49 0.65 0.32 0.37 0.43
  0.41 0.32 0.61 0.31 0.47 1.  ]]
Got 20 patterns after merging
2024-03-12 01:32:37.150808 MEMORY 16.833196032
Performing filtering
2024-03-12 01:32:37.151228 MEMORY 16.833196032
Got 18 patterns after filtering
2024-03-12 01:32:39.687791 MEMORY 16.833196032
Total time taken is 2762.54s
2024-03-12 01:32:39.687993 MEMORY 16.833196032
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done 2400 tasks      | elapsed:    3.2s
[Parallel(n_jobs=24)]: Done 5200 tasks      | elapsed:    6.8s
[Parallel(n_jobs=24)]: Done 7635 out of 7635 | elapsed:    9.9s finished
/ru-auth/local/home/lzhao/anaconda3/envs/jupyter-ml-clone/lib/python3.9/site-packages/sklearn/manifold/_t_sne.py:691: FutureWarning: 'square_distances' has been introduced in 0.24 to help phase out legacy squaring behavior. The 'legacy' setting will be removed in 1.1 (renaming of 0.26), and the default setting will be changed to True. In 1.3, 'square_distances' will be removed altogether, and distances will be squared by default. Set 'square_distances'=True to silence this warning.
  warnings.warn(
/ru-auth/local/home/lzhao/anaconda3/envs/jupyter-ml-clone/lib/python3.9/site-packages/sklearn/neighbors/_base.py:175: EfficiencyWarning: Precomputed sparse input was not sorted by data.
  warnings.warn('Precomputed sparse input was not sorted by data.',
Applying subclustering to the final motifs
On pattern 0
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 7635 samples in 0.052s...
[t-SNE] Computed neighbors for 7635 samples in 0.005s...
[t-SNE] Computed conditional probabilities for sample 1000 / 7635
[t-SNE] Computed conditional probabilities for sample 2000 / 7635
[t-SNE] Computed conditional probabilities for sample 3000 / 7635
[t-SNE] Computed conditional probabilities for sample 4000 / 7635
[t-SNE] Computed conditional probabilities for sample 5000 / 7635
[t-SNE] Computed conditional probabilities for sample 6000 / 7635
[t-SNE] Computed conditional probabilities for sample 7000 / 7635
[t-SNE] Computed conditional probabilities for sample 7635 / 7635
[t-SNE] Mean sigma: 0.259989
[t-SNE] Computed conditional probabilities in 0.545s
[t-SNE] Iteration 50: error = 86.0776520, gradient norm = 0.0000000 (50 iterations in 2.575s)
[t-SNE] Iteration 50: gradient norm 0.000000. Finished.
[t-SNE] KL divergence after 50 iterations with early exaggeration: 86.077652
[t-SNE] Iteration 100: error = 3.4823108, gradient norm = 0.0024816 (50 iterations in 2.476s)
[t-SNE] Iteration 150: error = 3.0442376, gradient norm = 0.0005381 (50 iterations in 2.435s)
[t-SNE] Iteration 200: error = 2.9254677, gradient norm = 0.0002890 (50 iterations in 2.456s)
[t-SNE] Iteration 250: error = 2.8572836, gradient norm = 0.0001869 (50 iterations in 2.447s)
[t-SNE] Iteration 300: error = 2.8130138, gradient norm = 0.0001410 (50 iterations in 2.486s)
[t-SNE] Iteration 350: error = 2.7825599, gradient norm = 0.0001037 (50 iterations in 2.510s)
[t-SNE] Iteration 400: error = 2.7601385, gradient norm = 0.0000830 (50 iterations in 2.497s)
[t-SNE] Iteration 450: error = 2.7430241, gradient norm = 0.0000707 (50 iterations in 2.477s)
[t-SNE] Iteration 500: error = 2.7302861, gradient norm = 0.0000635 (50 iterations in 2.452s)
[t-SNE] Iteration 550: error = 2.7206330, gradient norm = 0.0000563 (50 iterations in 2.530s)
[t-SNE] Iteration 600: error = 2.7129345, gradient norm = 0.0000576 (50 iterations in 2.487s)
[t-SNE] Iteration 650: error = 2.7080061, gradient norm = 0.0000541 (50 iterations in 2.450s)
[t-SNE] Iteration 700: error = 2.7031863, gradient norm = 0.0000472 (50 iterations in 2.512s)
[t-SNE] Iteration 750: error = 2.6986842, gradient norm = 0.0000405 (50 iterations in 2.434s)
[t-SNE] Iteration 800: error = 2.6946301, gradient norm = 0.0000369 (50 iterations in 2.496s)
[t-SNE] Iteration 850: error = 2.6909010, gradient norm = 0.0000393 (50 iterations in 2.442s)
[t-SNE] Iteration 900: error = 2.6875629, gradient norm = 0.0000326 (50 iterations in 2.496s)
[t-SNE] Iteration 950: error = 2.6847262, gradient norm = 0.0000304 (50 iterations in 2.460s)
[t-SNE] Iteration 1000: error = 2.6823072, gradient norm = 0.0000288 (50 iterations in 2.453s)
[t-SNE] KL divergence after 1000 iterations: 2.682307
[t-SNE] Computed conditional probabilities for sample 1000 / 7635
[t-SNE] Computed conditional probabilities for sample 2000 / 7635
[t-SNE] Computed conditional probabilities for sample 3000 / 7635
[t-SNE] Computed conditional probabilities for sample 4000 / 7635
[t-SNE] Computed conditional probabilities for sample 5000 / 7635
[t-SNE] Computed conditional probabilities for sample 6000 / 7635
[t-SNE] Computed conditional probabilities for sample 7000 / 7635
[t-SNE] Computed conditional probabilities for sample 7635 / 7635
[t-SNE] Mean sigma: 0.259989
Beginning preprocessing + Leiden
2024-03-12 01:33:47.844721 MEMORY 16.902193152
Affmat transformed
2024-03-12 01:33:47.934940 MEMORY 16.924131328
sources, targets, weights extracted
2024-03-12 01:33:47.999278 MEMORY 16.924233728
About to launch parallel Leiden runs
2024-03-12 01:33:48.052957 MEMORY 16.924233728
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:   27.8s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:  1.8min finished
Parallel Leiden runs finished
2024-03-12 01:35:36.207498 MEMORY 16.924233728
Quality: 0.5887220275646599
Quality: 0.5889499914890615
Quality: 0.589155231053298
Quality: 0.5892654796467054
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.4s
[Parallel(n_jobs=24)]: Done 2400 tasks      | elapsed:    2.0s
[Parallel(n_jobs=24)]: Done 4472 tasks      | elapsed:    3.5s
[Parallel(n_jobs=24)]: Done 4532 out of 4532 | elapsed:    3.6s finished
Got subclusters: Counter({0: 1764, 1: 1443, 2: 1080, 3: 923, 4: 844, 5: 641, 6: 499, 7: 251, 8: 190})
On pattern 1
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 4532 samples in 0.030s...
[t-SNE] Computed neighbors for 4532 samples in 0.003s...
[t-SNE] Computed conditional probabilities for sample 1000 / 4532
[t-SNE] Computed conditional probabilities for sample 2000 / 4532
[t-SNE] Computed conditional probabilities for sample 3000 / 4532
[t-SNE] Computed conditional probabilities for sample 4000 / 4532
[t-SNE] Computed conditional probabilities for sample 4532 / 4532
[t-SNE] Mean sigma: 0.263932
[t-SNE] Computed conditional probabilities in 0.318s
[t-SNE] Iteration 50: error = 79.7018280, gradient norm = 0.0055726 (50 iterations in 2.275s)
[t-SNE] Iteration 100: error = 79.7018280, gradient norm = 0.0055581 (50 iterations in 2.333s)
[t-SNE] Iteration 150: error = 79.7017212, gradient norm = 0.0041971 (50 iterations in 2.315s)
[t-SNE] Iteration 200: error = 79.7017288, gradient norm = 0.0042954 (50 iterations in 2.298s)
[t-SNE] Iteration 250: error = 79.7016830, gradient norm = 0.0038272 (50 iterations in 2.378s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 79.701683
[t-SNE] Iteration 300: error = 2.6895018, gradient norm = 0.0011750 (50 iterations in 2.210s)
[t-SNE] Iteration 350: error = 2.4985425, gradient norm = 0.0004136 (50 iterations in 2.188s)
[t-SNE] Iteration 400: error = 2.4176569, gradient norm = 0.0002397 (50 iterations in 2.304s)
[t-SNE] Iteration 450: error = 2.3736942, gradient norm = 0.0001547 (50 iterations in 2.199s)
[t-SNE] Iteration 500: error = 2.3463297, gradient norm = 0.0001155 (50 iterations in 2.208s)
[t-SNE] Iteration 550: error = 2.3279345, gradient norm = 0.0000916 (50 iterations in 2.247s)
[t-SNE] Iteration 600: error = 2.3155406, gradient norm = 0.0000800 (50 iterations in 2.200s)
[t-SNE] Iteration 650: error = 2.3071265, gradient norm = 0.0000698 (50 iterations in 2.203s)
[t-SNE] Iteration 700: error = 2.3007424, gradient norm = 0.0000592 (50 iterations in 2.205s)
[t-SNE] Iteration 750: error = 2.2958233, gradient norm = 0.0000562 (50 iterations in 2.234s)
[t-SNE] Iteration 800: error = 2.2917504, gradient norm = 0.0000481 (50 iterations in 2.214s)
[t-SNE] Iteration 850: error = 2.2885273, gradient norm = 0.0000565 (50 iterations in 2.208s)
[t-SNE] Iteration 900: error = 2.2870770, gradient norm = 0.0000558 (50 iterations in 2.201s)
[t-SNE] Iteration 950: error = 2.2860498, gradient norm = 0.0000422 (50 iterations in 2.214s)
[t-SNE] Iteration 1000: error = 2.2847791, gradient norm = 0.0000410 (50 iterations in 2.201s)
[t-SNE] KL divergence after 1000 iterations: 2.284779
[t-SNE] Computed conditional probabilities for sample 1000 / 4532
[t-SNE] Computed conditional probabilities for sample 2000 / 4532
[t-SNE] Computed conditional probabilities for sample 3000 / 4532
[t-SNE] Computed conditional probabilities for sample 4000 / 4532
[t-SNE] Computed conditional probabilities for sample 4532 / 4532
[t-SNE] Mean sigma: 0.263932
Beginning preprocessing + Leiden
2024-03-12 01:36:30.517824 MEMORY 16.83253248
Affmat transformed
2024-03-12 01:36:30.573269 MEMORY 16.84713472
sources, targets, weights extracted
2024-03-12 01:36:30.613334 MEMORY 16.847364096
About to launch parallel Leiden runs
2024-03-12 01:36:30.638994 MEMORY 16.847364096
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:   16.8s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   55.5s finished
Parallel Leiden runs finished
2024-03-12 01:37:26.147935 MEMORY 16.847364096
Quality: 0.5537720257583733
Quality: 0.5578508084314046
Quality: 0.5581643711993306
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 2350 out of 2350 | elapsed:    0.9s finished
Got subclusters: Counter({0: 736, 1: 723, 2: 721, 3: 604, 4: 511, 5: 430, 6: 422, 7: 200, 8: 185})
On pattern 2
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 2350 samples in 0.015s...
[t-SNE] Computed neighbors for 2350 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 1000 / 2350
[t-SNE] Computed conditional probabilities for sample 2000 / 2350
[t-SNE] Computed conditional probabilities for sample 2350 / 2350
[t-SNE] Mean sigma: 0.320236
[t-SNE] Computed conditional probabilities in 0.158s
[t-SNE] Iteration 50: error = 72.8701935, gradient norm = 0.0350022 (50 iterations in 2.159s)
[t-SNE] Iteration 100: error = 72.8655396, gradient norm = 0.0244850 (50 iterations in 2.113s)
[t-SNE] Iteration 150: error = 72.8690186, gradient norm = 0.0322712 (50 iterations in 2.116s)
[t-SNE] Iteration 200: error = 72.8649826, gradient norm = 0.0218791 (50 iterations in 2.168s)
[t-SNE] Iteration 250: error = 72.8629761, gradient norm = 0.0141266 (50 iterations in 2.109s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 72.862976
[t-SNE] Iteration 300: error = 2.2743082, gradient norm = 0.0013292 (50 iterations in 2.086s)
[t-SNE] Iteration 350: error = 2.1342275, gradient norm = 0.0004527 (50 iterations in 2.070s)
[t-SNE] Iteration 400: error = 2.0778117, gradient norm = 0.0002295 (50 iterations in 2.078s)
[t-SNE] Iteration 450: error = 2.0485668, gradient norm = 0.0001737 (50 iterations in 2.057s)
[t-SNE] Iteration 500: error = 2.0295660, gradient norm = 0.0001524 (50 iterations in 2.085s)
[t-SNE] Iteration 550: error = 2.0158651, gradient norm = 0.0001360 (50 iterations in 2.071s)
[t-SNE] Iteration 600: error = 2.0035474, gradient norm = 0.0001430 (50 iterations in 2.085s)
[t-SNE] Iteration 650: error = 1.9929752, gradient norm = 0.0001166 (50 iterations in 2.069s)
[t-SNE] Iteration 700: error = 1.9865615, gradient norm = 0.0001147 (50 iterations in 2.069s)
[t-SNE] Iteration 750: error = 1.9831887, gradient norm = 0.0000990 (50 iterations in 2.078s)
[t-SNE] Iteration 800: error = 1.9809737, gradient norm = 0.0000731 (50 iterations in 2.076s)
[t-SNE] Iteration 850: error = 1.9795258, gradient norm = 0.0000687 (50 iterations in 2.069s)
[t-SNE] Iteration 900: error = 1.9784187, gradient norm = 0.0000620 (50 iterations in 2.065s)
[t-SNE] Iteration 950: error = 1.9773550, gradient norm = 0.0000736 (50 iterations in 2.106s)
[t-SNE] Iteration 1000: error = 1.9763938, gradient norm = 0.0000520 (50 iterations in 2.146s)
[t-SNE] KL divergence after 1000 iterations: 1.976394
[t-SNE] Computed conditional probabilities for sample 1000 / 2350
[t-SNE] Computed conditional probabilities for sample 2000 / 2350
[t-SNE] Computed conditional probabilities for sample 2350 / 2350
[t-SNE] Mean sigma: 0.320236
Beginning preprocessing + Leiden
2024-03-12 01:38:12.193745 MEMORY 16.847368192
Affmat transformed
2024-03-12 01:38:12.224671 MEMORY 16.847368192
sources, targets, weights extracted
2024-03-12 01:38:12.242513 MEMORY 16.847368192
About to launch parallel Leiden runs
2024-03-12 01:38:12.265803 MEMORY 16.84736
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    7.0s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:   24.2s finished
Parallel Leiden runs finished
2024-03-12 01:38:36.462320 MEMORY 16.84736
Quality: 0.5413367241639276
Quality: 0.5413576304886091
Quality: 0.5433385583107264
Quality: 0.5438009063363338
Quality: 0.5442577458269038
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 400 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 698 out of 745 | elapsed:    0.3s remaining:    0.0s
[Parallel(n_jobs=24)]: Done 745 out of 745 | elapsed:    0.3s finished
Got subclusters: Counter({0: 446, 1: 342, 2: 336, 3: 317, 4: 314, 5: 251, 6: 178, 7: 166})
On pattern 3
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 745 samples in 0.005s...
[t-SNE] Computed neighbors for 745 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 745 / 745
[t-SNE] Mean sigma: 0.328091
[t-SNE] Computed conditional probabilities in 0.051s
[t-SNE] Iteration 50: error = 68.0883026, gradient norm = 0.3717327 (50 iterations in 2.038s)
[t-SNE] Iteration 100: error = 69.8500977, gradient norm = 0.3778266 (50 iterations in 2.042s)
[t-SNE] Iteration 150: error = 70.4261627, gradient norm = 0.3672235 (50 iterations in 2.059s)
[t-SNE] Iteration 200: error = 70.5257645, gradient norm = 0.3579605 (50 iterations in 2.049s)
[t-SNE] Iteration 250: error = 70.0573959, gradient norm = 0.3573134 (50 iterations in 2.047s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 70.057396
[t-SNE] Iteration 300: error = 1.6813650, gradient norm = 0.0028139 (50 iterations in 2.057s)
[t-SNE] Iteration 350: error = 1.6157005, gradient norm = 0.0007814 (50 iterations in 2.178s)
[t-SNE] Iteration 400: error = 1.5807742, gradient norm = 0.0006585 (50 iterations in 2.047s)
[t-SNE] Iteration 450: error = 1.5613672, gradient norm = 0.0004917 (50 iterations in 2.058s)
[t-SNE] Iteration 500: error = 1.5461217, gradient norm = 0.0002698 (50 iterations in 2.042s)
[t-SNE] Iteration 550: error = 1.5407498, gradient norm = 0.0002074 (50 iterations in 2.062s)
[t-SNE] Iteration 600: error = 1.5352347, gradient norm = 0.0002240 (50 iterations in 2.041s)
[t-SNE] Iteration 650: error = 1.5321141, gradient norm = 0.0001216 (50 iterations in 2.034s)
[t-SNE] Iteration 700: error = 1.5291305, gradient norm = 0.0002190 (50 iterations in 2.053s)
[t-SNE] Iteration 750: error = 1.5271822, gradient norm = 0.0000916 (50 iterations in 2.036s)
[t-SNE] Iteration 800: error = 1.5253856, gradient norm = 0.0002358 (50 iterations in 2.033s)
[t-SNE] Iteration 850: error = 1.5247588, gradient norm = 0.0000655 (50 iterations in 2.047s)
[t-SNE] Iteration 900: error = 1.5241694, gradient norm = 0.0001370 (50 iterations in 2.033s)
[t-SNE] Iteration 950: error = 1.5226135, gradient norm = 0.0001231 (50 iterations in 2.029s)
[t-SNE] Iteration 1000: error = 1.5220741, gradient norm = 0.0000760 (50 iterations in 2.040s)
[t-SNE] KL divergence after 1000 iterations: 1.522074
[t-SNE] Computed conditional probabilities for sample 745 / 745
[t-SNE] Mean sigma: 0.328092
Beginning preprocessing + Leiden
2024-03-12 01:39:18.919207 MEMORY 16.847368192
Affmat transformed
2024-03-12 01:39:18.930204 MEMORY 16.847368192
sources, targets, weights extracted
2024-03-12 01:39:18.936010 MEMORY 16.847368192
About to launch parallel Leiden runs
2024-03-12 01:39:18.955369 MEMORY 16.847368192
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.8s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    6.0s finished
Parallel Leiden runs finished
2024-03-12 01:39:24.948733 MEMORY 16.847368192
Quality: 0.4148509333828752
Quality: 0.4164846907995854
Quality: 0.4174189301003138
Quality: 0.4174288404197013
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 344 tasks      | elapsed:    0.2s
[Parallel(n_jobs=24)]: Done 522 out of 522 | elapsed:    0.3s finished
Got subclusters: Counter({0: 134, 1: 128, 2: 115, 3: 105, 4: 100, 5: 64, 6: 54, 7: 45})
On pattern 4
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 522 samples in 0.004s...
[t-SNE] Computed neighbors for 522 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 522 / 522
[t-SNE] Mean sigma: 0.344353
[t-SNE] Computed conditional probabilities in 0.036s
[t-SNE] Iteration 50: error = 68.1162643, gradient norm = 0.4537880 (50 iterations in 2.031s)
[t-SNE] Iteration 100: error = 69.0752029, gradient norm = 0.4581813 (50 iterations in 2.039s)
[t-SNE] Iteration 150: error = 68.8827972, gradient norm = 0.4555045 (50 iterations in 2.045s)
[t-SNE] Iteration 200: error = 69.7377777, gradient norm = 0.4428491 (50 iterations in 2.036s)
[t-SNE] Iteration 250: error = 70.2300034, gradient norm = 0.4354289 (50 iterations in 2.055s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 70.230003
[t-SNE] Iteration 300: error = 1.4541607, gradient norm = 0.0033278 (50 iterations in 2.029s)
[t-SNE] Iteration 350: error = 1.3812094, gradient norm = 0.0012990 (50 iterations in 2.030s)
[t-SNE] Iteration 400: error = 1.3546292, gradient norm = 0.0007058 (50 iterations in 2.043s)
[t-SNE] Iteration 450: error = 1.3250749, gradient norm = 0.0006563 (50 iterations in 2.027s)
[t-SNE] Iteration 500: error = 1.3097404, gradient norm = 0.0005842 (50 iterations in 2.034s)
[t-SNE] Iteration 550: error = 1.3023763, gradient norm = 0.0003334 (50 iterations in 2.026s)
[t-SNE] Iteration 600: error = 1.3000191, gradient norm = 0.0001246 (50 iterations in 2.026s)
[t-SNE] Iteration 650: error = 1.2991885, gradient norm = 0.0000735 (50 iterations in 2.033s)
[t-SNE] Iteration 700: error = 1.2942625, gradient norm = 0.0008544 (50 iterations in 2.032s)
[t-SNE] Iteration 750: error = 1.2899866, gradient norm = 0.0001883 (50 iterations in 2.040s)
[t-SNE] Iteration 800: error = 1.2880042, gradient norm = 0.0001111 (50 iterations in 2.034s)
[t-SNE] Iteration 850: error = 1.2873349, gradient norm = 0.0000779 (50 iterations in 2.035s)
[t-SNE] Iteration 900: error = 1.2871861, gradient norm = 0.0000516 (50 iterations in 2.027s)
[t-SNE] Iteration 950: error = 1.2870749, gradient norm = 0.0000539 (50 iterations in 2.046s)
[t-SNE] Iteration 1000: error = 1.2868897, gradient norm = 0.0001004 (50 iterations in 2.031s)
[t-SNE] KL divergence after 1000 iterations: 1.286890
[t-SNE] Computed conditional probabilities for sample 522 / 522
[t-SNE] Mean sigma: 0.344352
Beginning preprocessing + Leiden
2024-03-12 01:40:06.672866 MEMORY 16.847368192
Affmat transformed
2024-03-12 01:40:06.679937 MEMORY 16.847368192
sources, targets, weights extracted
2024-03-12 01:40:06.683792 MEMORY 16.847368192
About to launch parallel Leiden runs
2024-03-12 01:40:06.689019 MEMORY 16.847364096
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.4s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    4.3s finished
Parallel Leiden runs finished
2024-03-12 01:40:11.032926 MEMORY 16.847364096
Quality: 0.399957623708297
Quality: 0.40069666516963703
Quality: 0.40306021903465183
Quality: 0.40322676751546654
Quality: 0.40368579182330167
Quality: 0.4037272693641767
Quality: 0.4037784830097445
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 344 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 488 out of 488 | elapsed:    0.3s finished
Got subclusters: Counter({0: 112, 1: 104, 2: 96, 3: 84, 4: 70, 5: 56})
On pattern 5
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 488 samples in 0.004s...
[t-SNE] Computed neighbors for 488 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 488 / 488
[t-SNE] Mean sigma: 0.316527
[t-SNE] Computed conditional probabilities in 0.034s
[t-SNE] Iteration 50: error = 69.4471436, gradient norm = 0.4702954 (50 iterations in 2.035s)
[t-SNE] Iteration 100: error = 69.8384933, gradient norm = 0.4630314 (50 iterations in 2.027s)
[t-SNE] Iteration 150: error = 71.7370071, gradient norm = 0.4275809 (50 iterations in 2.028s)
[t-SNE] Iteration 200: error = 73.5985336, gradient norm = 0.4194630 (50 iterations in 2.037s)
[t-SNE] Iteration 250: error = 72.7336960, gradient norm = 0.4253263 (50 iterations in 2.037s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 72.733696
[t-SNE] Iteration 300: error = 1.4850633, gradient norm = 0.0037077 (50 iterations in 2.035s)
[t-SNE] Iteration 350: error = 1.4319532, gradient norm = 0.0009879 (50 iterations in 2.029s)
[t-SNE] Iteration 400: error = 1.3757645, gradient norm = 0.0017691 (50 iterations in 2.025s)
[t-SNE] Iteration 450: error = 1.3312075, gradient norm = 0.0009745 (50 iterations in 2.032s)
[t-SNE] Iteration 500: error = 1.3183299, gradient norm = 0.0004693 (50 iterations in 2.038s)
[t-SNE] Iteration 550: error = 1.3116271, gradient norm = 0.0003060 (50 iterations in 2.044s)
[t-SNE] Iteration 600: error = 1.3014642, gradient norm = 0.0006707 (50 iterations in 2.028s)
[t-SNE] Iteration 650: error = 1.2914389, gradient norm = 0.0002704 (50 iterations in 2.036s)
[t-SNE] Iteration 700: error = 1.2891577, gradient norm = 0.0001577 (50 iterations in 2.139s)
[t-SNE] Iteration 750: error = 1.2889103, gradient norm = 0.0001012 (50 iterations in 2.031s)
[t-SNE] Iteration 800: error = 1.2867392, gradient norm = 0.0001703 (50 iterations in 2.162s)
[t-SNE] Iteration 850: error = 1.2865489, gradient norm = 0.0001113 (50 iterations in 2.053s)
[t-SNE] Iteration 900: error = 1.2865726, gradient norm = 0.0000521 (50 iterations in 2.026s)
[t-SNE] Iteration 950: error = 1.2865933, gradient norm = 0.0000447 (50 iterations in 2.043s)
[t-SNE] Iteration 1000: error = 1.2866002, gradient norm = 0.0000407 (50 iterations in 2.031s)
[t-SNE] KL divergence after 1000 iterations: 1.286600
[t-SNE] Computed conditional probabilities for sample 488 / 488
[t-SNE] Mean sigma: 0.316527
Beginning preprocessing + Leiden
2024-03-12 01:40:52.901811 MEMORY 16.847368192
Affmat transformed
2024-03-12 01:40:52.908539 MEMORY 16.847368192
sources, targets, weights extracted
2024-03-12 01:40:52.912439 MEMORY 16.847368192
About to launch parallel Leiden runs
2024-03-12 01:40:53.042617 MEMORY 16.847368192
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.3s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    3.8s finished
Parallel Leiden runs finished
2024-03-12 01:40:56.840347 MEMORY 16.847368192
Quality: 0.37810391241010655
Quality: 0.38020488174438916
Quality: 0.3802410239761098
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 344 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 487 out of 487 | elapsed:    0.3s finished
Got subclusters: Counter({0: 90, 1: 83, 2: 80, 3: 64, 4: 61, 5: 52, 6: 49, 7: 9})
On pattern 6
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 487 samples in 0.004s...
[t-SNE] Computed neighbors for 487 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 487 / 487
[t-SNE] Mean sigma: 0.334133
[t-SNE] Computed conditional probabilities in 0.034s
[t-SNE] Iteration 50: error = 67.9672089, gradient norm = 0.4608560 (50 iterations in 2.030s)
[t-SNE] Iteration 100: error = 72.1785431, gradient norm = 0.4208218 (50 iterations in 2.049s)
[t-SNE] Iteration 150: error = 70.0907593, gradient norm = 0.4527713 (50 iterations in 2.080s)
[t-SNE] Iteration 200: error = 70.8178635, gradient norm = 0.4374486 (50 iterations in 2.033s)
[t-SNE] Iteration 250: error = 72.3531494, gradient norm = 0.4278320 (50 iterations in 2.056s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 72.353149
[t-SNE] Iteration 300: error = 1.3922169, gradient norm = 0.0041507 (50 iterations in 2.031s)
[t-SNE] Iteration 350: error = 1.2877979, gradient norm = 0.0017875 (50 iterations in 2.042s)
[t-SNE] Iteration 400: error = 1.2527430, gradient norm = 0.0008156 (50 iterations in 2.042s)
[t-SNE] Iteration 450: error = 1.2432281, gradient norm = 0.0005894 (50 iterations in 2.029s)
[t-SNE] Iteration 500: error = 1.2406718, gradient norm = 0.0001724 (50 iterations in 2.037s)
[t-SNE] Iteration 550: error = 1.2389994, gradient norm = 0.0001560 (50 iterations in 2.029s)
[t-SNE] Iteration 600: error = 1.2375016, gradient norm = 0.0001755 (50 iterations in 2.045s)
[t-SNE] Iteration 650: error = 1.2370884, gradient norm = 0.0000673 (50 iterations in 2.032s)
[t-SNE] Iteration 700: error = 1.2370458, gradient norm = 0.0000603 (50 iterations in 2.028s)
[t-SNE] Iteration 750: error = 1.2370684, gradient norm = 0.0000511 (50 iterations in 2.030s)
[t-SNE] Iteration 800: error = 1.2371634, gradient norm = 0.0000809 (50 iterations in 2.033s)
[t-SNE] Iteration 850: error = 1.2371211, gradient norm = 0.0000697 (50 iterations in 2.045s)
[t-SNE] Iteration 900: error = 1.2371362, gradient norm = 0.0000590 (50 iterations in 2.027s)
[t-SNE] Iteration 950: error = 1.2370704, gradient norm = 0.0000754 (50 iterations in 2.029s)
[t-SNE] Iteration 1000: error = 1.2370735, gradient norm = 0.0000706 (50 iterations in 2.036s)
[t-SNE] KL divergence after 1000 iterations: 1.237074
[t-SNE] Computed conditional probabilities for sample 487 / 487
[t-SNE] Mean sigma: 0.334133
Beginning preprocessing + Leiden
2024-03-12 01:41:38.547376 MEMORY 16.847368192
Affmat transformed
2024-03-12 01:41:38.555930 MEMORY 16.847368192
sources, targets, weights extracted
2024-03-12 01:41:38.560177 MEMORY 16.847368192
About to launch parallel Leiden runs
2024-03-12 01:41:42.596740 MEMORY 16.847335424
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.3s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    3.8s finished
Parallel Leiden runs finished
2024-03-12 01:41:46.402764 MEMORY 16.847269888
Quality: 0.39985524227411917
Quality: 0.40097466337448245
Quality: 0.401414682212196
Quality: 0.4017006671012161
Quality: 0.40194661124573416
Quality: 0.40195530545554187
Quality: 0.40201284747711047
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 344 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 442 out of 442 | elapsed:    0.2s finished
Got subclusters: Counter({0: 99, 1: 83, 2: 82, 3: 66, 4: 63, 5: 52, 6: 27, 7: 15})
On pattern 7
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 442 samples in 0.003s...
[t-SNE] Computed neighbors for 442 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 442 / 442
[t-SNE] Mean sigma: 0.348932
[t-SNE] Computed conditional probabilities in 0.030s
[t-SNE] Iteration 50: error = 66.5029602, gradient norm = 0.4883530 (50 iterations in 2.037s)
[t-SNE] Iteration 100: error = 69.1397705, gradient norm = 0.4517704 (50 iterations in 2.043s)
[t-SNE] Iteration 150: error = 72.5499420, gradient norm = 0.4328686 (50 iterations in 2.036s)
[t-SNE] Iteration 200: error = 68.8327408, gradient norm = 0.4698246 (50 iterations in 2.045s)
[t-SNE] Iteration 250: error = 69.1705093, gradient norm = 0.4600390 (50 iterations in 2.032s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 69.170509
[t-SNE] Iteration 300: error = 1.2646794, gradient norm = 0.0028277 (50 iterations in 2.041s)
[t-SNE] Iteration 350: error = 1.2188191, gradient norm = 0.0010290 (50 iterations in 2.036s)
[t-SNE] Iteration 400: error = 1.1740876, gradient norm = 0.0012933 (50 iterations in 2.038s)
[t-SNE] Iteration 450: error = 1.1542269, gradient norm = 0.0012740 (50 iterations in 2.024s)
[t-SNE] Iteration 500: error = 1.1416458, gradient norm = 0.0003415 (50 iterations in 2.031s)
[t-SNE] Iteration 550: error = 1.1387906, gradient norm = 0.0002086 (50 iterations in 2.029s)
[t-SNE] Iteration 600: error = 1.1388582, gradient norm = 0.0002272 (50 iterations in 2.029s)
[t-SNE] Iteration 650: error = 1.1385959, gradient norm = 0.0000949 (50 iterations in 2.034s)
[t-SNE] Iteration 700: error = 1.1382018, gradient norm = 0.0000827 (50 iterations in 2.027s)
[t-SNE] Iteration 750: error = 1.1380602, gradient norm = 0.0000902 (50 iterations in 2.025s)
[t-SNE] Iteration 800: error = 1.1382372, gradient norm = 0.0000880 (50 iterations in 2.034s)
[t-SNE] Iteration 850: error = 1.1379287, gradient norm = 0.0000859 (50 iterations in 2.029s)
[t-SNE] Iteration 900: error = 1.1380794, gradient norm = 0.0001033 (50 iterations in 2.039s)
[t-SNE] Iteration 950: error = 1.1379509, gradient norm = 0.0000904 (50 iterations in 2.038s)
[t-SNE] Iteration 1000: error = 1.1381044, gradient norm = 0.0000926 (50 iterations in 2.036s)
[t-SNE] KL divergence after 1000 iterations: 1.138104
[t-SNE] Computed conditional probabilities for sample 442 / 442
[t-SNE] Mean sigma: 0.348932
Beginning preprocessing + Leiden
2024-03-12 01:42:27.875355 MEMORY 16.847343616
Affmat transformed
2024-03-12 01:42:27.881428 MEMORY 16.847343616
sources, targets, weights extracted
2024-03-12 01:42:27.884806 MEMORY 16.847343616
About to launch parallel Leiden runs
2024-03-12 01:42:27.931728 MEMORY 16.847343616
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.2s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    3.6s finished
Parallel Leiden runs finished
2024-03-12 01:42:31.603921 MEMORY 16.847347712
Quality: 0.3896926743264855
Quality: 0.3919498350013768
Quality: 0.3925207050247756
Quality: 0.39374980083571876
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 349 out of 349 | elapsed:    0.1s finished
Got subclusters: Counter({0: 98, 1: 68, 2: 64, 3: 55, 4: 54, 5: 49, 6: 28, 7: 26})
On pattern 8
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 349 samples in 0.003s...
[t-SNE] Computed neighbors for 349 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 349 / 349
[t-SNE] Mean sigma: 0.228005
[t-SNE] Computed conditional probabilities in 0.026s
[t-SNE] Iteration 50: error = 63.7264938, gradient norm = 0.5011193 (50 iterations in 2.033s)
[t-SNE] Iteration 100: error = 66.5310516, gradient norm = 0.4587086 (50 iterations in 2.030s)
[t-SNE] Iteration 150: error = 65.9945068, gradient norm = 0.4842203 (50 iterations in 2.034s)
[t-SNE] Iteration 200: error = 66.5426712, gradient norm = 0.4673224 (50 iterations in 2.031s)
[t-SNE] Iteration 250: error = 67.6827240, gradient norm = 0.4771076 (50 iterations in 2.041s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 67.682724
[t-SNE] Iteration 300: error = 1.0527105, gradient norm = 0.0047701 (50 iterations in 2.038s)
[t-SNE] Iteration 350: error = 0.8756092, gradient norm = 0.0036262 (50 iterations in 2.039s)
[t-SNE] Iteration 400: error = 0.8265252, gradient norm = 0.0007732 (50 iterations in 2.025s)
[t-SNE] Iteration 450: error = 0.8251408, gradient norm = 0.0001208 (50 iterations in 2.033s)
[t-SNE] Iteration 500: error = 0.8250373, gradient norm = 0.0001234 (50 iterations in 2.028s)
[t-SNE] Iteration 550: error = 0.8248752, gradient norm = 0.0000883 (50 iterations in 2.032s)
[t-SNE] Iteration 600: error = 0.8248499, gradient norm = 0.0000817 (50 iterations in 2.033s)
[t-SNE] Iteration 650: error = 0.8250701, gradient norm = 0.0000860 (50 iterations in 2.031s)
[t-SNE] Iteration 700: error = 0.8249025, gradient norm = 0.0000860 (50 iterations in 2.031s)
[t-SNE] Iteration 750: error = 0.8248906, gradient norm = 0.0000670 (50 iterations in 2.028s)
[t-SNE] Iteration 800: error = 0.8248954, gradient norm = 0.0000896 (50 iterations in 2.035s)
[t-SNE] Iteration 850: error = 0.8248489, gradient norm = 0.0000629 (50 iterations in 2.030s)
[t-SNE] Iteration 900: error = 0.8246874, gradient norm = 0.0000780 (50 iterations in 2.028s)
[t-SNE] Iteration 950: error = 0.8248971, gradient norm = 0.0000570 (50 iterations in 2.034s)
[t-SNE] Iteration 1000: error = 0.8248576, gradient norm = 0.0000564 (50 iterations in 2.035s)
[t-SNE] KL divergence after 1000 iterations: 0.824858
[t-SNE] Computed conditional probabilities for sample 349 / 349
[t-SNE] Mean sigma: 0.228005
Beginning preprocessing + Leiden
2024-03-12 01:43:12.859805 MEMORY 16.847347712
Affmat transformed
2024-03-12 01:43:12.864837 MEMORY 16.847347712
sources, targets, weights extracted
2024-03-12 01:43:12.867550 MEMORY 16.847347712
About to launch parallel Leiden runs
2024-03-12 01:43:12.885669 MEMORY 16.847347712
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.0s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    3.2s finished
Parallel Leiden runs finished
2024-03-12 01:43:16.087865 MEMORY 16.847347712
Quality: 0.3770577002858562
Quality: 0.377674973686506
Quality: 0.37825545664641197
Quality: 0.3786489613629466
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 272 tasks      | elapsed:    0.1s
[Parallel(n_jobs=24)]: Done 325 out of 325 | elapsed:    0.1s finished
Got subclusters: Counter({0: 106, 1: 87, 2: 64, 3: 41, 4: 38, 5: 13})
On pattern 9
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 325 samples in 0.003s...
[t-SNE] Computed neighbors for 325 samples in 0.001s...
[t-SNE] Computed conditional probabilities for sample 325 / 325
[t-SNE] Mean sigma: 0.377682
[t-SNE] Computed conditional probabilities in 0.022s
[t-SNE] Iteration 50: error = 62.1810532, gradient norm = 0.5238699 (50 iterations in 2.031s)
[t-SNE] Iteration 100: error = 64.9898758, gradient norm = 0.4841348 (50 iterations in 2.030s)
[t-SNE] Iteration 150: error = 63.7068176, gradient norm = 0.4945721 (50 iterations in 2.035s)
[t-SNE] Iteration 200: error = 63.0147133, gradient norm = 0.5497897 (50 iterations in 2.035s)
[t-SNE] Iteration 250: error = 63.5712738, gradient norm = 0.5042895 (50 iterations in 2.038s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 63.571274
[t-SNE] Iteration 300: error = 1.0248083, gradient norm = 0.0052715 (50 iterations in 2.088s)
[t-SNE] Iteration 350: error = 0.8860606, gradient norm = 0.0018101 (50 iterations in 2.026s)
[t-SNE] Iteration 400: error = 0.8649333, gradient norm = 0.0011661 (50 iterations in 2.033s)
[t-SNE] Iteration 450: error = 0.8597158, gradient norm = 0.0008096 (50 iterations in 2.028s)
[t-SNE] Iteration 500: error = 0.8562412, gradient norm = 0.0003195 (50 iterations in 2.026s)
[t-SNE] Iteration 550: error = 0.8202819, gradient norm = 0.0007634 (50 iterations in 2.049s)
[t-SNE] Iteration 600: error = 0.8141048, gradient norm = 0.0005316 (50 iterations in 2.086s)
[t-SNE] Iteration 650: error = 0.8116053, gradient norm = 0.0001757 (50 iterations in 2.040s)
[t-SNE] Iteration 700: error = 0.8114793, gradient norm = 0.0001044 (50 iterations in 2.034s)
[t-SNE] Iteration 750: error = 0.8113670, gradient norm = 0.0001571 (50 iterations in 2.032s)
[t-SNE] Iteration 800: error = 0.8088765, gradient norm = 0.0002773 (50 iterations in 2.034s)
[t-SNE] Iteration 850: error = 0.8084235, gradient norm = 0.0000909 (50 iterations in 2.026s)
[t-SNE] Iteration 900: error = 0.8085229, gradient norm = 0.0000915 (50 iterations in 2.037s)
[t-SNE] Iteration 950: error = 0.8087389, gradient norm = 0.0000923 (50 iterations in 2.031s)
[t-SNE] Iteration 1000: error = 0.8085362, gradient norm = 0.0001347 (50 iterations in 2.027s)
[t-SNE] KL divergence after 1000 iterations: 0.808536
[t-SNE] Computed conditional probabilities for sample 325 / 325
[t-SNE] Mean sigma: 0.377682
Beginning preprocessing + Leiden
2024-03-12 01:43:57.431569 MEMORY 16.847347712
Affmat transformed
2024-03-12 01:43:57.436243 MEMORY 16.847347712
sources, targets, weights extracted
2024-03-12 01:43:57.438326 MEMORY 16.847347712
About to launch parallel Leiden runs
2024-03-12 01:43:57.442529 MEMORY 16.847347712
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.0s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.8s finished
Parallel Leiden runs finished
2024-03-12 01:44:00.205163 MEMORY 16.847347712
Quality: 0.4497458890744795
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 288 out of 288 | elapsed:    0.1s finished
Got subclusters: Counter({0: 97, 1: 65, 2: 58, 3: 53, 4: 38, 5: 14})
On pattern 10
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 288 samples in 0.003s...
[t-SNE] Computed neighbors for 288 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 288 / 288
[t-SNE] Mean sigma: 0.345412
[t-SNE] Computed conditional probabilities in 0.020s
[t-SNE] Iteration 50: error = 60.6969757, gradient norm = 0.5402690 (50 iterations in 2.034s)
[t-SNE] Iteration 100: error = 64.9674377, gradient norm = 0.4315338 (50 iterations in 2.039s)
[t-SNE] Iteration 150: error = 65.6405640, gradient norm = 0.4757811 (50 iterations in 2.027s)
[t-SNE] Iteration 200: error = 62.4372292, gradient norm = 0.4892938 (50 iterations in 2.032s)
[t-SNE] Iteration 250: error = 65.6074295, gradient norm = 0.4963012 (50 iterations in 2.035s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 65.607430
[t-SNE] Iteration 300: error = 1.0580963, gradient norm = 0.0062980 (50 iterations in 2.042s)
[t-SNE] Iteration 350: error = 0.9326540, gradient norm = 0.0029203 (50 iterations in 2.030s)
[t-SNE] Iteration 400: error = 0.8624393, gradient norm = 0.0013288 (50 iterations in 2.029s)
[t-SNE] Iteration 450: error = 0.8556236, gradient norm = 0.0003316 (50 iterations in 2.043s)
[t-SNE] Iteration 500: error = 0.8533843, gradient norm = 0.0003165 (50 iterations in 2.026s)
[t-SNE] Iteration 550: error = 0.8525173, gradient norm = 0.0001994 (50 iterations in 2.041s)
[t-SNE] Iteration 600: error = 0.8523720, gradient norm = 0.0000977 (50 iterations in 2.033s)
[t-SNE] Iteration 650: error = 0.8521359, gradient norm = 0.0001111 (50 iterations in 2.026s)
[t-SNE] Iteration 700: error = 0.8522907, gradient norm = 0.0000942 (50 iterations in 2.031s)
[t-SNE] Iteration 750: error = 0.8525339, gradient norm = 0.0000914 (50 iterations in 2.031s)
[t-SNE] Iteration 800: error = 0.8526560, gradient norm = 0.0001447 (50 iterations in 2.032s)
[t-SNE] Iteration 850: error = 0.8527897, gradient norm = 0.0001910 (50 iterations in 2.039s)
[t-SNE] Iteration 900: error = 0.8528055, gradient norm = 0.0001232 (50 iterations in 2.061s)
[t-SNE] Iteration 950: error = 0.8527656, gradient norm = 0.0001068 (50 iterations in 2.029s)
[t-SNE] Iteration 1000: error = 0.8528476, gradient norm = 0.0001365 (50 iterations in 2.033s)
[t-SNE] Iteration 1000: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 1000 iterations: 0.852848
[t-SNE] Computed conditional probabilities for sample 288 / 288
[t-SNE] Mean sigma: 0.345412
Beginning preprocessing + Leiden
2024-03-12 01:44:41.421921 MEMORY 16.847347712
Affmat transformed
2024-03-12 01:44:41.426251 MEMORY 16.847347712
sources, targets, weights extracted
2024-03-12 01:44:41.428305 MEMORY 16.847347712
About to launch parallel Leiden runs
2024-03-12 01:44:41.432617 MEMORY 16.847347712
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    1.0s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.9s finished
Parallel Leiden runs finished
2024-03-12 01:44:44.346828 MEMORY 16.847347712
Quality: 0.3373195165879933
Quality: 0.34329493096767805
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 164 out of 164 | elapsed:    0.1s finished
Got subclusters: Counter({0: 68, 1: 50, 2: 45, 3: 43, 4: 43, 5: 16, 6: 15, 7: 8})
On pattern 11
[t-SNE] Computing 151 nearest neighbors...
[t-SNE] Indexed 164 samples in 0.002s...
[t-SNE] Computed neighbors for 164 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 164 / 164
[t-SNE] Mean sigma: 0.393097
[t-SNE] Computed conditional probabilities in 0.011s
[t-SNE] Iteration 50: error = 62.3546715, gradient norm = 0.4228172 (50 iterations in 2.020s)
[t-SNE] Iteration 100: error = 60.2112961, gradient norm = 0.5167672 (50 iterations in 2.034s)
[t-SNE] Iteration 150: error = 55.2710381, gradient norm = 0.5795301 (50 iterations in 2.049s)
[t-SNE] Iteration 200: error = 55.3405800, gradient norm = 0.5361560 (50 iterations in 2.020s)
[t-SNE] Iteration 250: error = 56.3427200, gradient norm = 0.5599570 (50 iterations in 2.033s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 56.342720
[t-SNE] Iteration 300: error = 0.8665023, gradient norm = 0.0061715 (50 iterations in 2.027s)
[t-SNE] Iteration 350: error = 0.6297495, gradient norm = 0.0052691 (50 iterations in 2.035s)
[t-SNE] Iteration 400: error = 0.5870862, gradient norm = 0.0018118 (50 iterations in 2.033s)
[t-SNE] Iteration 450: error = 0.5844342, gradient norm = 0.0011917 (50 iterations in 2.029s)
[t-SNE] Iteration 500: error = 0.5835511, gradient norm = 0.0001610 (50 iterations in 2.022s)
[t-SNE] Iteration 550: error = 0.5836092, gradient norm = 0.0002080 (50 iterations in 2.022s)
[t-SNE] Iteration 600: error = 0.5835252, gradient norm = 0.0001867 (50 iterations in 2.023s)
[t-SNE] Iteration 650: error = 0.5836073, gradient norm = 0.0001698 (50 iterations in 2.029s)
[t-SNE] Iteration 700: error = 0.5834080, gradient norm = 0.0002520 (50 iterations in 2.027s)
[t-SNE] Iteration 750: error = 0.5836529, gradient norm = 0.0002441 (50 iterations in 2.031s)
[t-SNE] Iteration 800: error = 0.5835634, gradient norm = 0.0001797 (50 iterations in 2.029s)
[t-SNE] Iteration 850: error = 0.5835350, gradient norm = 0.0002621 (50 iterations in 2.025s)
[t-SNE] Iteration 900: error = 0.5835074, gradient norm = 0.0001930 (50 iterations in 2.037s)
[t-SNE] Iteration 950: error = 0.5836824, gradient norm = 0.0002058 (50 iterations in 2.028s)
[t-SNE] Iteration 1000: error = 0.5835090, gradient norm = 0.0002876 (50 iterations in 2.030s)
[t-SNE] KL divergence after 1000 iterations: 0.583509
[t-SNE] Computed conditional probabilities for sample 164 / 164
[t-SNE] Mean sigma: 0.393097
Beginning preprocessing + Leiden
2024-03-12 01:45:25.227722 MEMORY 16.847347712
Affmat transformed
2024-03-12 01:45:25.230545 MEMORY 16.847347712
sources, targets, weights extracted
2024-03-12 01:45:25.231496 MEMORY 16.847347712
About to launch parallel Leiden runs
2024-03-12 01:45:25.262516 MEMORY 16.847347712
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.8s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.2s finished
Parallel Leiden runs finished
2024-03-12 01:45:27.461770 MEMORY 16.847347712
Quality: 0.31950377884964487
Quality: 0.3216265241150387
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done 120 out of 120 | elapsed:    0.1s finished
Got subclusters: Counter({0: 38, 1: 35, 2: 33, 3: 30, 4: 28})
On pattern 12
[t-SNE] Computing 119 nearest neighbors...
[t-SNE] Indexed 120 samples in 0.002s...
[t-SNE] Computed neighbors for 120 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 120 / 120
[t-SNE] Mean sigma: 0.384788
[t-SNE] Computed conditional probabilities in 0.007s
[t-SNE] Iteration 50: error = 53.8050232, gradient norm = 0.5136899 (50 iterations in 2.021s)
[t-SNE] Iteration 100: error = 55.0458145, gradient norm = 0.4844609 (50 iterations in 2.040s)
[t-SNE] Iteration 150: error = 53.6249657, gradient norm = 0.5642151 (50 iterations in 2.027s)
[t-SNE] Iteration 200: error = 56.3872566, gradient norm = 0.5264234 (50 iterations in 2.031s)
[t-SNE] Iteration 250: error = 56.2198677, gradient norm = 0.5197246 (50 iterations in 2.027s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 56.219868
[t-SNE] Iteration 300: error = 0.8684576, gradient norm = 0.0089645 (50 iterations in 2.035s)
[t-SNE] Iteration 350: error = 0.4683868, gradient norm = 0.0172415 (50 iterations in 2.031s)
[t-SNE] Iteration 400: error = 0.4241290, gradient norm = 0.0018534 (50 iterations in 2.028s)
[t-SNE] Iteration 450: error = 0.4243767, gradient norm = 0.0004314 (50 iterations in 2.022s)
[t-SNE] Iteration 500: error = 0.4243411, gradient norm = 0.0004976 (50 iterations in 2.028s)
[t-SNE] Iteration 550: error = 0.4242858, gradient norm = 0.0002770 (50 iterations in 2.028s)
[t-SNE] Iteration 600: error = 0.4242541, gradient norm = 0.0004265 (50 iterations in 2.022s)
[t-SNE] Iteration 650: error = 0.4243984, gradient norm = 0.0003739 (50 iterations in 2.024s)
[t-SNE] Iteration 700: error = 0.4242638, gradient norm = 0.0003430 (50 iterations in 2.029s)
[t-SNE] Iteration 750: error = 0.4242407, gradient norm = 0.0004216 (50 iterations in 2.019s)
[t-SNE] Iteration 750: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 750 iterations: 0.424241
[t-SNE] Computed conditional probabilities for sample 120 / 120
[t-SNE] Mean sigma: 0.384788
Beginning preprocessing + Leiden
2024-03-12 01:45:58.091931 MEMORY 16.847347712
Affmat transformed
2024-03-12 01:45:58.094089 MEMORY 16.847347712
sources, targets, weights extracted
2024-03-12 01:45:58.094843 MEMORY 16.847347712
About to launch parallel Leiden runs
2024-03-12 01:45:58.118081 MEMORY 16.847347712
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.9s finished
Parallel Leiden runs finished
2024-03-12 01:46:00.054403 MEMORY 16.847347712
Quality: 0.2465969531346033
Quality: 0.24690483648703998
Quality: 0.24784830004886393
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  72 out of 119 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=24)]: Done 119 out of 119 | elapsed:    0.0s finished
Got subclusters: Counter({0: 32, 1: 30, 2: 25, 3: 16, 4: 13, 5: 4})
On pattern 13
[t-SNE] Computing 118 nearest neighbors...
[t-SNE] Indexed 119 samples in 0.001s...
[t-SNE] Computed neighbors for 119 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 119 / 119
[t-SNE] Mean sigma: 0.376977
[t-SNE] Computed conditional probabilities in 0.006s
[t-SNE] Iteration 50: error = 53.9189453, gradient norm = 0.5111754 (50 iterations in 2.021s)
[t-SNE] Iteration 100: error = 53.6224442, gradient norm = 0.5066215 (50 iterations in 2.026s)
[t-SNE] Iteration 150: error = 52.0303497, gradient norm = 0.5921752 (50 iterations in 2.024s)
[t-SNE] Iteration 200: error = 51.1601257, gradient norm = 0.5588650 (50 iterations in 2.027s)
[t-SNE] Iteration 250: error = 54.5328331, gradient norm = 0.5036478 (50 iterations in 2.033s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 54.532833
[t-SNE] Iteration 300: error = 0.7424839, gradient norm = 0.0053421 (50 iterations in 2.021s)
[t-SNE] Iteration 350: error = 0.4396641, gradient norm = 0.0084255 (50 iterations in 2.031s)
[t-SNE] Iteration 400: error = 0.4158512, gradient norm = 0.0008380 (50 iterations in 2.023s)
[t-SNE] Iteration 450: error = 0.4160045, gradient norm = 0.0002701 (50 iterations in 2.033s)
[t-SNE] Iteration 500: error = 0.4159653, gradient norm = 0.0002092 (50 iterations in 2.021s)
[t-SNE] Iteration 550: error = 0.4156291, gradient norm = 0.0002696 (50 iterations in 2.033s)
[t-SNE] Iteration 600: error = 0.4158981, gradient norm = 0.0004588 (50 iterations in 2.022s)
[t-SNE] Iteration 650: error = 0.4156723, gradient norm = 0.0003327 (50 iterations in 2.034s)
[t-SNE] Iteration 700: error = 0.4156803, gradient norm = 0.0003805 (50 iterations in 2.027s)
[t-SNE] Iteration 750: error = 0.4158820, gradient norm = 0.0003251 (50 iterations in 2.035s)
[t-SNE] Iteration 800: error = 0.4160385, gradient norm = 0.0002797 (50 iterations in 2.025s)
[t-SNE] Iteration 850: error = 0.4160378, gradient norm = 0.0002299 (50 iterations in 2.033s)
[t-SNE] Iteration 900: error = 0.4156476, gradient norm = 0.0002880 (50 iterations in 2.026s)
[t-SNE] Iteration 900: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 900 iterations: 0.415648
[t-SNE] Computed conditional probabilities for sample 119 / 119
[t-SNE] Mean sigma: 0.376977
Beginning preprocessing + Leiden
2024-03-12 01:46:36.736957 MEMORY 16.847347712
Affmat transformed
2024-03-12 01:46:36.739025 MEMORY 16.847347712
sources, targets, weights extracted
2024-03-12 01:46:36.739796 MEMORY 16.847347712
About to launch parallel Leiden runs
2024-03-12 01:46:36.756184 MEMORY 16.847347712
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    2.0s finished
Parallel Leiden runs finished
2024-03-12 01:46:38.748888 MEMORY 16.847347712
Quality: 0.23862783488297218
Quality: 0.23974273311898683
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  69 out of  69 | elapsed:    0.0s finished
Got subclusters: Counter({0: 41, 1: 33, 2: 27, 4: 9, 3: 9})
On pattern 14
[t-SNE] Computing 68 nearest neighbors...
[t-SNE] Indexed 69 samples in 0.001s...
[t-SNE] Computed neighbors for 69 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 69 / 69
[t-SNE] Mean sigma: 0.641236
[t-SNE] Computed conditional probabilities in 0.002s
[t-SNE] Iteration 50: error = 47.3301773, gradient norm = 0.4999313 (50 iterations in 2.020s)
[t-SNE] Iteration 100: error = 44.9614983, gradient norm = 0.5055289 (50 iterations in 2.024s)
[t-SNE] Iteration 150: error = 48.2944450, gradient norm = 0.4467438 (50 iterations in 2.019s)
[t-SNE] Iteration 200: error = 46.7553520, gradient norm = 0.6535374 (50 iterations in 2.027s)
[t-SNE] Iteration 250: error = 42.7115250, gradient norm = 0.7193450 (50 iterations in 2.026s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 42.711525
[t-SNE] Iteration 300: error = 0.8074731, gradient norm = 0.0041328 (50 iterations in 2.019s)
[t-SNE] Iteration 350: error = 0.6634759, gradient norm = 0.0035469 (50 iterations in 2.027s)
[t-SNE] Iteration 400: error = 0.5348637, gradient norm = 0.0103482 (50 iterations in 2.023s)
[t-SNE] Iteration 450: error = 0.1719381, gradient norm = 0.0266044 (50 iterations in 2.027s)
[t-SNE] Iteration 500: error = 0.1278398, gradient norm = 0.0047662 (50 iterations in 2.019s)
[t-SNE] Iteration 550: error = 0.1275882, gradient norm = 0.0011307 (50 iterations in 2.022s)
[t-SNE] Iteration 600: error = 0.1274590, gradient norm = 0.0007079 (50 iterations in 2.029s)
[t-SNE] Iteration 650: error = 0.1275307, gradient norm = 0.0008487 (50 iterations in 2.023s)
[t-SNE] Iteration 700: error = 0.1273730, gradient norm = 0.0008449 (50 iterations in 2.028s)
[t-SNE] Iteration 750: error = 0.1274852, gradient norm = 0.0007000 (50 iterations in 2.029s)
[t-SNE] Iteration 800: error = 0.1275072, gradient norm = 0.0007420 (50 iterations in 2.024s)
[t-SNE] Iteration 850: error = 0.1274862, gradient norm = 0.0007737 (50 iterations in 2.024s)
[t-SNE] Iteration 900: error = 0.1274481, gradient norm = 0.0006301 (50 iterations in 2.032s)
[t-SNE] Iteration 950: error = 0.1274759, gradient norm = 0.0006576 (50 iterations in 2.026s)
[t-SNE] Iteration 1000: error = 0.1274944, gradient norm = 0.0006897 (50 iterations in 2.024s)
[t-SNE] KL divergence after 1000 iterations: 0.127494
[t-SNE] Computed conditional probabilities for sample 69 / 69
[t-SNE] Mean sigma: 0.641236
Beginning preprocessing + Leiden
2024-03-12 01:47:19.350316 MEMORY 16.847347712
Affmat transformed
2024-03-12 01:47:19.351766 MEMORY 16.847347712
sources, targets, weights extracted
2024-03-12 01:47:19.352257 MEMORY 16.847347712
About to launch parallel Leiden runs
2024-03-12 01:47:19.372693 MEMORY 16.847347712
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.8s finished
Parallel Leiden runs finished
2024-03-12 01:47:21.212028 MEMORY 16.847347712
Quality: 0.1656617646134989
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.0s
[Parallel(n_jobs=24)]: Done  66 out of  66 | elapsed:    0.0s finished
Got subclusters: Counter({0: 18, 2: 18, 1: 18, 3: 15})
On pattern 15
[t-SNE] Computing 65 nearest neighbors...
[t-SNE] Indexed 66 samples in 0.001s...
[t-SNE] Computed neighbors for 66 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 66 / 66
[t-SNE] Mean sigma: 0.570751
[t-SNE] Computed conditional probabilities in 0.002s
[t-SNE] Iteration 50: error = 50.0443573, gradient norm = 0.5076057 (50 iterations in 2.015s)
[t-SNE] Iteration 100: error = 46.3380280, gradient norm = 0.4385963 (50 iterations in 2.028s)
[t-SNE] Iteration 150: error = 45.5169678, gradient norm = 0.4699512 (50 iterations in 2.023s)
[t-SNE] Iteration 200: error = 51.3857269, gradient norm = 0.4818102 (50 iterations in 2.029s)
[t-SNE] Iteration 250: error = 49.1506653, gradient norm = 0.4855252 (50 iterations in 2.024s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 49.150665
[t-SNE] Iteration 300: error = 0.8538966, gradient norm = 0.0022185 (50 iterations in 2.025s)
[t-SNE] Iteration 350: error = 0.6859507, gradient norm = 0.0010028 (50 iterations in 2.026s)
[t-SNE] Iteration 400: error = 0.6301760, gradient norm = 0.0007101 (50 iterations in 2.034s)
[t-SNE] Iteration 450: error = 0.5844604, gradient norm = 0.0009399 (50 iterations in 2.030s)
[t-SNE] Iteration 500: error = 0.5643169, gradient norm = 0.0004815 (50 iterations in 2.027s)
[t-SNE] Iteration 550: error = 0.5451542, gradient norm = 0.0003147 (50 iterations in 2.024s)
[t-SNE] Iteration 600: error = 0.5285784, gradient norm = 0.0005471 (50 iterations in 2.024s)
[t-SNE] Iteration 650: error = 0.5081267, gradient norm = 0.0004915 (50 iterations in 2.030s)
[t-SNE] Iteration 700: error = 0.4906679, gradient norm = 0.0006765 (50 iterations in 2.028s)
[t-SNE] Iteration 750: error = 0.4755392, gradient norm = 0.0010064 (50 iterations in 2.023s)
[t-SNE] Iteration 800: error = 0.7126984, gradient norm = 0.0458116 (50 iterations in 2.033s)
[t-SNE] Iteration 850: error = 0.7457548, gradient norm = 0.0019653 (50 iterations in 2.024s)
[t-SNE] Iteration 900: error = 0.6668749, gradient norm = 0.0007162 (50 iterations in 2.031s)
[t-SNE] Iteration 950: error = 0.6170145, gradient norm = 0.0004962 (50 iterations in 2.029s)
[t-SNE] Iteration 1000: error = 0.5903961, gradient norm = 0.0005318 (50 iterations in 2.031s)
[t-SNE] KL divergence after 1000 iterations: 0.590396
[t-SNE] Computed conditional probabilities for sample 66 / 66
[t-SNE] Mean sigma: 0.570751
Beginning preprocessing + Leiden
2024-03-12 01:48:01.832155 MEMORY 16.847347712
Affmat transformed
2024-03-12 01:48:01.833519 MEMORY 16.847347712
sources, targets, weights extracted
2024-03-12 01:48:01.834032 MEMORY 16.847347712
About to launch parallel Leiden runs
2024-03-12 01:48:01.869660 MEMORY 16.847347712
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.8s finished
Parallel Leiden runs finished
2024-03-12 01:48:03.676885 MEMORY 16.847347712
Quality: 0.11715513151949952
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done  48 out of  48 | elapsed:    0.0s finished
Got subclusters: Counter({0: 24, 1: 22, 2: 14, 3: 6})
On pattern 16
[t-SNE] Computing 47 nearest neighbors...
[t-SNE] Indexed 48 samples in 0.000s...
[t-SNE] Computed neighbors for 48 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 48 / 48
[t-SNE] Mean sigma: 10.119289
[t-SNE] Computed conditional probabilities in 0.001s
[t-SNE] Iteration 50: error = 42.6200981, gradient norm = 0.5415751 (50 iterations in 2.019s)
[t-SNE] Iteration 100: error = 43.5351028, gradient norm = 0.4771955 (50 iterations in 2.025s)
[t-SNE] Iteration 150: error = 51.2908897, gradient norm = 0.5415205 (50 iterations in 2.023s)
[t-SNE] Iteration 200: error = 43.5841370, gradient norm = 0.5674228 (50 iterations in 2.022s)
[t-SNE] Iteration 250: error = 42.4123001, gradient norm = 0.4383995 (50 iterations in 2.029s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 42.412300
[t-SNE] Iteration 300: error = 0.6086442, gradient norm = 0.0007323 (50 iterations in 2.024s)
[t-SNE] Iteration 350: error = 0.6039987, gradient norm = 0.0001249 (50 iterations in 2.021s)
[t-SNE] Iteration 400: error = 0.6014906, gradient norm = 0.0001268 (50 iterations in 2.027s)
[t-SNE] Iteration 450: error = 0.5916692, gradient norm = 0.0014027 (50 iterations in 2.024s)
[t-SNE] Iteration 500: error = 0.7503303, gradient norm = 0.0012676 (50 iterations in 2.026s)
[t-SNE] Iteration 550: error = 0.6658900, gradient norm = 0.0004532 (50 iterations in 2.024s)
[t-SNE] Iteration 600: error = 0.6114680, gradient norm = 0.0001510 (50 iterations in 2.032s)
[t-SNE] Iteration 650: error = 0.6080662, gradient norm = 0.0000445 (50 iterations in 2.019s)
[t-SNE] Iteration 700: error = 0.6068835, gradient norm = 0.0000363 (50 iterations in 2.031s)
[t-SNE] Iteration 750: error = 0.6055102, gradient norm = 0.0000567 (50 iterations in 2.023s)
[t-SNE] Iteration 800: error = 0.6043419, gradient norm = 0.0000564 (50 iterations in 2.025s)
[t-SNE] Iteration 800: did not make any progress during the last 300 episodes. Finished.
[t-SNE] KL divergence after 800 iterations: 0.604342
[t-SNE] Computed conditional probabilities for sample 48 / 48
[t-SNE] Mean sigma: 1125899906842624.000000
Beginning preprocessing + Leiden
2024-03-12 01:48:36.130388 MEMORY 16.847347712
Affmat transformed
2024-03-12 01:48:36.131664 MEMORY 16.847347712
sources, targets, weights extracted
2024-03-12 01:48:36.132106 MEMORY 16.847347712
About to launch parallel Leiden runs
2024-03-12 01:48:36.150978 MEMORY 16.847347712
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.7s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.8s finished
Parallel Leiden runs finished
2024-03-12 01:48:37.987200 MEMORY 16.847347712
Quality: 8.88178419700137e-16
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done  14 out of  30 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=24)]: Done  30 out of  30 | elapsed:    0.0s finished
Got subclusters: Counter({0: 48})
On pattern 17
[t-SNE] Computing 29 nearest neighbors...
[t-SNE] Indexed 30 samples in 0.000s...
[t-SNE] Computed neighbors for 30 samples in 0.000s...
[t-SNE] Computed conditional probabilities for sample 30 / 30
[t-SNE] Mean sigma: 8.677218
[t-SNE] Computed conditional probabilities in 0.001s
[t-SNE] Iteration 50: error = 47.0644569, gradient norm = 0.5148456 (50 iterations in 2.021s)
[t-SNE] Iteration 100: error = 46.0323181, gradient norm = 0.4478337 (50 iterations in 2.024s)
[t-SNE] Iteration 150: error = 44.7612953, gradient norm = 0.4066411 (50 iterations in 2.022s)
[t-SNE] Iteration 200: error = 43.7325249, gradient norm = 0.4495650 (50 iterations in 2.031s)
[t-SNE] Iteration 250: error = 46.9495735, gradient norm = 0.4753332 (50 iterations in 2.030s)
[t-SNE] KL divergence after 250 iterations with early exaggeration: 46.949574
[t-SNE] Iteration 300: error = 0.5722491, gradient norm = 0.0009428 (50 iterations in 2.031s)
[t-SNE] Iteration 350: error = 0.5052679, gradient norm = 0.0001705 (50 iterations in 2.021s)
[t-SNE] Iteration 400: error = 0.5009190, gradient norm = 0.0000861 (50 iterations in 2.017s)
[t-SNE] Iteration 450: error = 0.5002155, gradient norm = 0.0000293 (50 iterations in 2.029s)
[t-SNE] Iteration 500: error = 0.5001554, gradient norm = 0.0000199 (50 iterations in 2.024s)
[t-SNE] Iteration 550: error = 0.5000159, gradient norm = 0.0000220 (50 iterations in 2.023s)
[t-SNE] Iteration 600: error = 0.4991125, gradient norm = 0.0000286 (50 iterations in 2.031s)
[t-SNE] Iteration 650: error = 0.4988145, gradient norm = 0.0000324 (50 iterations in 2.025s)
[t-SNE] Iteration 700: error = 0.4987842, gradient norm = 0.0000330 (50 iterations in 2.030s)
[t-SNE] Iteration 750: error = 0.4988352, gradient norm = 0.0000421 (50 iterations in 2.028s)
[t-SNE] Iteration 800: error = 0.4978464, gradient norm = 0.0001284 (50 iterations in 2.024s)
[t-SNE] Iteration 850: error = 0.4935180, gradient norm = 0.0045422 (50 iterations in 2.032s)
[t-SNE] Iteration 900: error = 0.9124006, gradient norm = 0.1330694 (50 iterations in 2.024s)
[t-SNE] Iteration 950: error = 0.5298967, gradient norm = 0.0006133 (50 iterations in 2.023s)
[t-SNE] Iteration 1000: error = 0.5080799, gradient norm = 0.0001959 (50 iterations in 2.019s)
[t-SNE] KL divergence after 1000 iterations: 0.508080
[t-SNE] Computed conditional probabilities for sample 30 / 30
[t-SNE] Mean sigma: 1125899906842624.000000
Beginning preprocessing + Leiden
2024-03-12 01:49:18.532214 MEMORY 16.847347712
Affmat transformed
2024-03-12 01:49:18.533246 MEMORY 16.847347712
sources, targets, weights extracted
2024-03-12 01:49:18.533643 MEMORY 16.847347712
About to launch parallel Leiden runs
2024-03-12 01:49:18.556428 MEMORY 16.847347712
[Parallel(n_jobs=24)]: Using backend LokyBackend with 24 concurrent workers.
[Parallel(n_jobs=24)]: Done   2 tasks      | elapsed:    0.6s
[Parallel(n_jobs=24)]: Done  50 out of  50 | elapsed:    1.7s finished
Parallel Leiden runs finished
2024-03-12 01:49:20.307466 MEMORY 16.847347712
Quality: 1.9095836023552904e-14
Got subclusters: Counter({0: 30})
